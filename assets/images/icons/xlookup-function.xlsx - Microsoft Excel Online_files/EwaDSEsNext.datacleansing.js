'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1124:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e,k,l){this.vna=b;this.confidence=d;this.headerRowCount=f;this.headerColumnCount=e;this.orientation=k;this.fields=l}}Object(t.a)(c,"TableInterpretation",null,[])},1151:function(t,D,a){var c=a(10);t=a(0);var b=a(15),d=a(220),f=a(50),e=a(37),k=a(7),l=a(171),m=a(720),v=a(694);class n extends m.a{constructor(){super();this.tableName=
this.interpretations=this.range=null;this.H_=Object.assign(new v.a,{T_:n.getTypeName(),B_:n.Od()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static Od(){return["AugLoop_Core_Annotation"]}}Object(t.a)(n,"ExcelRecognizedTableNew",m.a,[]);class w extends n{constructor(){super();this.requestId=null;this.H_=Object.assign(new v.a,{T_:w.getTypeName(),B_:w.Od()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static Od(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(t.a)(w,"ExcelRangeMetadata",n,[]);m=a(1280);class r extends m.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new v.a,{T_:r.getTypeName(),B_:r.Od()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static Od(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(t.a)(r,"ExtendedExcelCell",m.a,[]);m=a(864);class u extends m.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=
null;this.H_=Object.assign(new v.a,{T_:u.getTypeName(),B_:u.Od()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static Od(){return["AugLoop_Signals_Signal"]}}Object(t.a)(u,"RangeDataSignal",m.a,[]);m=a(715);class x extends m.a{constructor(){super();this.worksheetId=null;this.bottom=this.right=this.top=this.left=0;this.H_=Object.assign(new v.a,{T_:x.getTypeName(),B_:x.Od()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRangeAddressNew"}static Od(){return[]}}Object(t.a)(x,
"ExcelRangeAddressNew",m.a,[]);var z=a(99);m=a(38);var B=a(1),y=a(22),A=a(21);class K extends Sys.EventArgs{constructor(V){super();this.yGb=V}}Object(t.a)(K,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var G=a(184),T=a(24),W=a(338);class P{constructor(V,wa,ma,ab){this.nE=V;this.interpretations=wa;this.tableName=ma;this.id=ab}}Object(t.a)(P,"RecognizedTable",null,[]);class E{constructor(V,wa,ma){this.classification=V;this.aggregations=wa;this.headerReferences=ma}}Object(t.a)(E,"TableField",null,
[]);var H=a(1124);const F=V=>{var wa=new W.a(N(V.range),V.range.worksheetId);var ma=V.interpretations;var ab=new G.a;if(ma&&ma.length)for(const ha of ma){b:switch(ha.orientation.toLowerCase()){case "columnmajor":ma=2;break b;case "rowmajor":ma=1;break b;default:b.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),ma=0}const Da=ma;if(0===Da)b.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{ma=H.a;var ba=N(ha.location),
Ca=ha.confidence,Na=ha.headerRowCount,za=ha.headerColumnCount;var la=ha.fields;var aa=new G.a;if(la)for(const nb of la){la=aa;var sa=la.add;c:switch(nb.classification.toLowerCase()){case "dimension":var ea=1;break c;case "measure":ea=2;break c;default:b.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),ea=0}var Z=nb.aggregations;var ua=new G.a;if(Z)for(const qa of Z)switch(qa.toLowerCase()){case "sum":ua.add(0);break;case "count":ua.add(1);break;case "average":ua.add(2);
break;case "min":ua.add(3);break;case "max":ua.add(4);break;case "distinctcount":ua.add(5);break;case "stddev":ua.add(6);break;case "variance":ua.add(7);break;default:b.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}Z=ua;var ya=nb.headerReferences;ua=new G.a;if(ya)for(const qa of ya)ya=new T.Range(qa.top,qa.left,qa.top,qa.left,!1,!1),ua.add(ya);sa.call(la,new E(ea,Z,ua))}ma=new ma(ba,Ca,Na,za,Da,aa);ab.add(ma)}}return new P(wa,ab,V.tableName,V.id)},N=V=>new T.Range(V.top,V.left,
V.bottom,V.right,!1,!1);class J{constructor(V){this.py=new Map;this.ykd=!1;this.tableIntelligenceManager=V;this.tableIntelligenceManager.DXa("Valid",this.TSi.bind(this));this.tableIntelligenceManager.DXa("Invalid",this.xMi.bind(this))}hac(V,wa){return this.py?this.py.has(V.sheetId)?this.py.get(V.sheetId).filter(ma=>ma.table.nE.range.Ed(V.range)&&(ma.UBb&wa)==ma.UBb):[]:(b.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[])}TSi(V,wa){if(this.py){if(!this.ykd){for(const [ma,ab]of this.py)ab.every(ba=>
4===ba.UBb)?this.py.delete(ma):this.py.set(ma,ab.filter(ba=>4!==ba.UBb));this.ykd=!0}V=wa.yGb;this.py.has(V.nE.sheetId)||this.py.set(V.nE.sheetId,[]);this.py.get(V.nE.sheetId).push({table:V,UBb:2})}else b.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}xMi(V,wa){this.ykd=!1;V=wa.yGb;if(this.py)if(this.py.has(V.nE.sheetId))for(const ma of this.py.get(V.nE.sheetId))ma.table.id===wa.yGb.id&&(ma.UBb=4);else b.ULS.debugAssertTag(522981602,306,!1,"No recognized tables for sheet");else b.ULS.sendTraceTag(521025314,
306,10,"Recognized table is null")}}Object(t.a)(J,"TableIntelligenceQueryManager",null,[268]);class R{}Object(t.a)(R,"RecognizedTableLog",null,[]);class M{}Object(t.a)(M,"Interpretation",null,[]);class L{constructor(V){this.py=new Map;this.MYb=void 0;this.Qmb=new Set;this.aDb=void 0;this.tableIntelligenceManager=V}eig(){this.aDb?b.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.aDb=this.Okc.bind(this),this.tableIntelligenceManager.DXa("Valid",this.aDb))}Uui(V){V=
this.q6(V);b.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(V)}`)}Okc(V,wa){V=wa.yGb;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Qmb&&this.py?(this.Qmb.has(V.id)||(this.HCg(V),this.Qmb.add(V.id)),this.MYb||(this.MYb=window.setTimeout(this.G5.bind(this),2E3))):b.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Qmb}, recognizedTableStore = ${!!this.py}`))}G5(){for(const [,V]of this.py)b.ULS.sendTraceTag(521233110,
306,15,JSON.stringify(V));window.clearTimeout(this.MYb);this.Qmb=this.MYb=void 0;this.py.clear();this.py=void 0;this.tableIntelligenceManager.f$i(this.aDb);this.aDb=void 0}HCg(V){const wa=V.nE.sheetId;this.py.has(wa)||this.py.set(wa,[]);this.py.get(wa).push(this.q6(V))}q6(V){const wa=[],ma=B.EwaSettings.isChangeGateEnabled("OfficeVSO:6670393_logRecognizedTableDimensions");for(const ab of V.interpretations)if(ma){let ba=0,Ca=0;for(const Na of ab.fields)1===Na.classification?ba++:2===Na.classification&&
Ca++;wa.push({confidence:ab.confidence,headerRowCount:ab.headerRowCount,headerColumnCount:ab.headerColumnCount,orientation:ab.orientation,measureCount:Ca,dimensionCount:ba})}else wa.push({confidence:ab.confidence,headerRowCount:ab.headerRowCount,headerColumnCount:ab.headerColumnCount,orientation:ab.orientation});return{interpretations:wa,range:{top:V.nE.range.top,bottom:V.nE.range.bottom,left:V.nE.range.left,right:V.nE.range.right},isTable:!!V.tableName,annotationId:ma?V.id:null}}}Object(t.a)(L,"RecognizedTableLogger",
null,[]);class U extends m.a{constructor(V,wa){super();this.Dec=this.Qbf=!1;this.voe={};this.instantaneousSupportInformationManager=null;this.KFd=void 0;this.Ulf=!1;this.Mvh=(ma,ab)=>{var ba;1===ab.operationType&&((ab=ab.kJ)?(b.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${ab.requestId}`),ma=F(ab),B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(ba=this.KFd)||void 0===ba?void 0:ba.Uui(ma)),
({value:ba}=this.rRd.Cc(ab.requestId)).returnValue?(this.rRd.remove(ab.requestId),ba(ma)):b.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${ab.requestId}`)):b.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null."))};this.szg=(ma,ab)=>{this.$.isChangeGateEnabled("OfficeVSO:6137444_UseCommonFunctionForExcelRecognizedTableAnnotation")?this.jIf("RecognizedTableUpdate",
ab):1===ab.operationType&&((ma=ab.kJ)?(ma=F(ma),this.raiseEvent("RecognizedTableUpdate",new K(ma))):b.ULS.sendTraceTag(537151249,306,10,"TableIntelligenceManager::GetRange ExcelRecognizedTable is null."))};this.augmentationLoopManager=V;this.$=wa;this.rRd=new z.a;B.EwaSettings.isChangeGateEnabled("OfficeVSO:6102923_registerTableIntelligenceService")&&this.$.da.Ga(20,this);B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.KFd=new L(this))}J3a(){this.d7f||
(this.d7f=new J(this));return this.d7f}RQh(V,wa){if(!B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OnDemandMetadataEnabled",!1))return 1;if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<V.range.TG)return b.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${V.range.TG} exceeds limit of ${1E4}`),4;this.Nyg();if(this.bki(V.range))return this.bUh(V,wa);b.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");
return 2}RFg(V){this.Oyg();this.addHandler("RecognizedTableUpdate",V);this.A9e()}Gbj(V){this.removeHandler("RecognizedTableUpdate",V)}DXa(V,wa){var ma,ab;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(ab=null===(ma=this.$)||void 0===ma?void 0:ma.xa)||void 0===ab?0:ab.count)&&this.$.xa.count>B.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.xa.count}`):
(this.voe[V]||(this.Dec||(this.augmentationLoopManager.activateAnnotation(n.getTypeName()),this.Dec=!0),this.augmentationLoopManager.L1.$O(V,n.getTypeName(),(ba,Ca)=>this.jIf(this.cud(V),Ca)),this.voe[V]=!0),this.LBg(V,wa),this.A9e())}f$i(V){this.removeHandler(this.cud("Valid"),V)}LBg(V,wa){this.addHandler(this.cud(V),wa)}h7i(){B.EwaSettings.ma(291)&&B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&(this.augmentationLoopManager.activateAnnotation(n.getTypeName()),
this.augmentationLoopManager.$O(n.getTypeName(),this.szg))}g7i(){this.augmentationLoopManager.activateAnnotation(w.getTypeName());this.augmentationLoopManager.$O(w.getTypeName(),this.Mvh)}Oyg(){var V,wa;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(wa=null===(V=this.$)||void 0===V?void 0:V.xa)||void 0===wa?0:wa.count)&&this.$.xa.count>B.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",
100)?b.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.xa.count}`):this.Dec||(this.h7i(),this.Dec=!0)}Nyg(){this.Qbf||(this.Qbf=!0,this.g7i())}jIf(V,wa){1===wa.operationType&&((wa=wa.kJ)?(wa=F(wa),this.raiseEvent(V,new K(wa))):b.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}cud(V){return`${"RecognizedTableUpdate"}_${V}`}bUh(V,
wa){b.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const ma=V.range,ab=A.g(this.$).kk("TableIntelligence",ma,1),ba=[],Ca=[];let Na=0;const za=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1),la=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceNumberFormatEnabled",!1);for(la&&!this.instantaneousSupportInformationManager&&this.$.da.Za(268,aa=>{this.instantaneousSupportInformationManager=aa});ab.$$mn();){const aa=
ab.$$cu();if(!aa)continue;if(0===aa.Cy.type&&y.a.yq(aa.Cy.value))continue;B.EwaSettings.isChangeGateEnabled("OfficeVSO:5857908_OnDemandMergeCells")&&aa.GH&&aa.range&&Ca.push(Object(k.a)(new x,{worksheetId:V.sheetId,left:aa.range.left-1,top:aa.range.top-1,right:aa.range.right-1,bottom:aa.range.bottom-1}));const sa=aa.range.top-1,ea=aa.range.left-1;let Z=null,ua=null;la&&({category:ua}=this.instantaneousSupportInformationManager.PAa(aa.cell.Ek,!0),aa.text!=aa.Cy.value&&(Z=aa.text,za&&Na++));ba.push(Object.assign(new r,
{row:sa,column:ea,value:aa.Cy.value,type:aa.Cy.type,displayText:Z,mZj:ua}))}za&&b.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${Na}, number of values: ${ba.length}, range size: ${ma.height} rows by ${ma.width} columns`);if(0<ba.length)return this.n8g(ba,V,Ca,wa),Ca.length?5:0;b.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}n8g(V,wa,ma,ab){var ba=wa.range;ba=Object(k.a)(new x,{top:ba.top,left:ba.left,
bottom:ba.bottom,right:ba.right,worksheetId:wa.sheetId});wa=l.a.create().toString();V=Object(k.a)(new u,{cells:V,range:ba,mergeCellAddresses:ma,requestId:wa});this.augmentationLoopManager.WSd(V);this.rRd.add(wa,ab)}bki(V){const wa=A.g(this.$);if(B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const ma=wa.$tb();b.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${ma.width}, viewportHeight: ${ma.height}`)}return wa.Ea.lK(4,this.$.oa)&&!!wa.Xb(V.topLeft)&&
!!wa.Xb(V.bottomLeft)&&!!wa.Xb(V.topRight)&&!!wa.Xb(V.bottomRight)}A9e(){var V;!this.Ulf&&B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Ulf=!0,null===(V=this.KFd)||void 0===V?void 0:V.eig())}}Object(t.a)(U,"TableIntelligenceManager",m.a,[3,237]);class X extends d.a{constructor(V){super();this.$=V;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ta(this.$.da,328,327,1),V=>{if(V=V.result){let wa=this.$.da.za(20);wa||(wa=new U(V,this.$),
B.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&this.$.da.Ga(20,wa));this.qb(wa)}else b.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),this.qb(null)},this.$.la,3)}static ka(V){V.da.Ga(404,new X(V))}}Object(t.a)(X,"TableIntelligenceManagerFactory",d.a,[]);class da{constructor(V,wa){this.woe=!1;this.tableIntelligenceManager=V;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",
!1)&&void f.GetServiceTaskFactory.Qia(wa.da,510,511,1);this.tableIntelligenceManager.DXa("Valid",()=>{B.EwaSettings.isChangeGateEnabled("OfficeVSO:6280730_avoidLoggingForEveryAnnotation")&&!this.woe&&(b.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.woe=!0)})}}Object(t.a)(da,"TableIntelligenceDarkActivationManager",null,[309]);var fa=a(695);class S extends d.a{constructor(V){super();this.$=V;this.Fb()}static ka(V){V.da.Ga(481,new S(V))}create(){const V=f.GetServiceTaskFactory.Ta(this.$.da,
20,404,1);e.TaskExtensions.Aa(V,()=>{const wa=V.result,ma=Object(fa.b)(this.$.da,480,()=>new da(wa,this.$));this.qb(ma)},this.$.la,3)}}Object(t.a)(S,"TableIntelligenceDarkActivationManagerFactory",d.a,[]);a.d(D,"a",function(){return ka});const ka=()=>{c.a.Fa(V=>{X.ka(V);S.ka(V)})}},1248:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(15),f=a(38),e=a(1);class k extends f.a{constructor(){super()}KVd(n,w){d.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${n}, TriggerType: ${w}`);
if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(w){case 0:this.raiseEvent("pssort",void 0,n);break;case 1:this.raiseEvent("psfilter",void 0,n);break;case 2:this.raiseEvent("pscrttbl",void 0,n)}}}Object(t.a)(k,"ProactiveSuggestionManager",f.a,[450]);var l=a(695);class m extends b.a{constructor(n){super();this.$=n;this.Fb()}create(){let n=Object(l.a)(this.$.da,476,()=>new k);this.qb(n)}static ka(n){n.da.Ga(475,new m(n))}}Object(t.a)(m,
"ProactiveSuggestionManagerFactory",b.a,[]);a.d(D,"a",function(){return v});const v=()=>{c.a.Fa(n=>{m.ka(n)})}},1419:function(t,D,a){function c(sb,$b=wa.a.Eb){return V.b(sb.xd(-1502853784,$b,12,null))}function b(sb,$b){sb.xd(2105621672,wa.a.Eb,12,{onClose:$b})}function d(sb,$b="DataCleansingTaskPane"){sb.xd(802602464,wa.a.Eb,12,{[ma.a.sU]:$b})}function f(sb){sb={otelEvent:Object.assign(Object.assign({},sb),{telemetryProperties:{ariaTenantToken:"19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873",
nexusTenantToken:1777}}),additionalDataFields:void 0};la.a.sendOtelEvent(sb)}function e(sb){aa.add(sb)}function k(sb){if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanDataSurvey",!1)){const $b=aa.has(0),xc=aa.has(1);$b&&!xc&&sb.xd(2063144036,-1,0,null)}}function l(sb,$b){return Object(sa.a)(this,void 0,void 0,function*(){if(ab.m(sb.oa)){const xc=sb.oa;return $b.map(ad=>Ca(ad,!0)).filter(ad=>xc.X_.Cfc(ad))}return[]})}function m(sb,$b,xc){return Object(sa.a)(this,void 0,void 0,function*(){try{switch(null===
$b||void 0===$b?void 0:$b.type){case 0:return v(sb,$b,xc);case 2:return w(sb,$b,xc);case 1:return n(sb,$b,xc);default:J.ULS.sendTraceTag(520987281,0,10,`applySuggestion: Unknown suggestion type ${null===$b||void 0===$b?void 0:$b.type}`)}}catch(ad){J.ULS.sendTraceTag(520987280,0,10,`applySuggestion: ${ad}`)}return null})}function v(sb,$b,xc){return Object(sa.a)(this,void 0,void 0,function*(){const ad=$b.variations.filter(Ze=>Ze.isSelected&&Ze.value!==$b.replacementValue).map(Ze=>Ze.value),Dd={["SheetName"]:sb.oa.sheetName,
["MatchCase"]:!1,["MatchEntireCell"]:!1,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:ad},ie=$b.variations.every(Ze=>Ze.value!==$b.replacementValue),$d=new qa(!ie&&!0),{Dzd:ne,Bzd:ye,SAd:te}=r(0);Object(tb.a)(sb.userOperationManager,(Ze,re,tc)=>ta.w(sb.pa.va,Dd,Object(pa.u)(sb.oa.sheetName,null,xc),$b.replacementValue,Object(Ba.b)(Ze,ne),Object(Ba.a)(re,ye),tc,$d),Ze=>new cc.a(258,0,Ze),null);yield te;return{result:ad.length,rna:!0}})}function n(sb,$b,xc){return Object(sa.a)(this,
void 0,void 0,function*(){if(null===xc||void 0===xc||!xc.length)return J.ULS.sendTraceTag(520987279,0,10,"applyNumberFormatInconsistencySuggestion: empty changeRanges."),Promise.resolve({result:0,rna:!1});const ad=Object(pa.u)(sb.oa.sheetName,null,xc),Dd=new qa(!0),ie={},$d=$b.formats.find(({key:tc})=>tc===$b.replacementFormat).format;ie.NumberFormatOptions=Object(P.a)(new Qa.a,{NumberFormatCategory:-1,CustomFormatString:$d});ie.ValidMembers=32;ie.NumberFormat=15;const ne=Object(pa.o)(ob.g(sb).ha.sa.activeCell,
sb),ye=sb.pa.va.Qb({MZ:!0,bZ:1}),{Dzd:te,Bzd:Ze,SAd:re}=r(1);Object(tb.a)(sb.userOperationManager,(tc,$c,Ed)=>Oa.l(sb.pa.va,ad,ne,ie,!1,null,null,!0,Object(Ba.b)(tc,te),Object(Ba.a)($c,Ze),Ed,Dd,ye,null),tc=>new cc.a(11,0,tc),null);yield re;return{result:-1,rna:!0}})}function w(sb,$b,xc){return Object(sa.a)(this,void 0,void 0,function*(){const {Dzd:ad,Bzd:Dd,SAd:ie}=r(2),$d=new qa(!0);Object(tb.a)(sb.userOperationManager,(ne,ye,te)=>{var Ze=sb.pa.va,re=Object(pa.u)(sb.activeItemName,null,xc);a:{var tc=
$b.extraSpacesType;switch(tc){case 0:tc=1;break a;case 2:tc=2;break a;case 1:tc=4;break a;default:throw J.ULS.sendTraceTag(520987278,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${tc}`),Error.argument("illegal ExtraSpacesPaddingType");}}return Aa(Ze,re,tc,Object(Ba.b)(ne,ad),Object(Ba.a)(ye,Dd),te,$d)},ne=>new cc.a(253,0,ne),null);return{result:(yield ie).Result,rna:!0}})}function r(sb){const $b=new Pa.a;return{Dzd(xc){xc&&eb.a.rg(xc.Errors)?(J.ULS.sendTraceTag(520987277,
0,10,`DataCleansing onOperationSuccess: Ewa result contains error messages after applying type [${sb}]`),$b.setResult(null)):(J.ULS.sendTraceTag(520987276,0,50,`DataCleansing onOperationSuccess: Suggestion of type [${sb}] applied successfully.`),$b.setResult(xc))},Bzd(xc){J.ULS.sendTraceTag(520987275,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages for type [${sb}], HttpStatus [${xc.data.httpStatus}]`);$b.setResult(null)},SAd:V.d($b.task)}}function u(sb,$b,xc,ad=ic){const {Px:Dd,
success:ie}=sb.lTe(xc,$b,ad.width,ad.font);return ie?Dd:(J.ULS.sendTraceTag(512508562,0,50,"formatValue: Failed to acquire friendly format string"),"")}a.r(D);var x=a(505),z=a(10),B=a(36),y=a(0),A=a(690),K=a(1),G=a(181),T=a(55);class W{constructor(sb,$b){this.$=sb;this.hVi=$b}Qc(){return!1}executeCommand(sb,$b){sb=!0;switch($b.command){case -1190551534:this.hVi.$Ce();break;default:sb=!1}return sb?T.Task.Ua(!0):G.a($b.command)}Ec(sb,$b){return-1190551534===$b.command&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)}Vc(){return!1}}Object(y.a)(W,"DataCleansingCommandHandler",null,[188]);var P=a(7),E=a(86),H=a(50),F=a(413),N=a(37),J=a(15),R=a(38);class M{constructor(sb,$b){this.Bwg=sb;this.ELc=$b}get STd(){return this.Bwg}get messageType(){return this.ELc}toString(){return"TaskPaneViewState: "+this.STd+", MessageType: "+this.messageType}}Object(y.a)(M,"DataCleansingTaskPaneState",null,[]);class L extends R.a{constructor(sb){super();this.uvc=this.pPd=this.HPa=this.H5a=this.isInViewMode=this.zLa=this.H5e=!1;
this.WQ=()=>{if(this.isInViewMode=!this.$.ea.isEditMode)this.HPa=!1;J.ULS.sendTraceTag(537163355,0,50,`DataCleansingPaneStateManager.OnApplicationModeChanged: view mode has changed to ${this.isInViewMode}.`);this.UAa()};this.xB=($b,xc)=>{$b=xc.nYd;J.ULS.sendTraceTag(537163354,0,50,`DataCleansingPaneStateManager.OnUserListChanged: the number of coauth users has changed to ${$b}.`);if(this.zLa&&1>=$b||!this.zLa&&1<$b)this.zLa=1<xc.nYd,J.ULS.sendTraceTag(537163353,0,50,`DataCleansingPaneStateManager.OnUserListChanged: coauthoring mode has changed to ${this.zLa}.`),
this.zLa&&(this.HPa=!1),this.UAa()};this.$Q=()=>{if(this.H5a=this.$.oa.Fd.mv)this.HPa=!1;J.ULS.sendTraceTag(537163352,0,50,`DataCleansingPaneStateManager.OnNamedSheetViewModeChanged: named sheet view mode has changed to ${this.H5a}.`);this.UAa()};this.Eh=($b,xc)=>{J.ULS.sendTraceTag(537163351,0,50,"DataCleansingPaneStateManager.OnActiveSheetChanged: active sheet was changed.");xc.uD.Fd.xPa(this.$Q);xc.oa.Fd.bra(this.$Q);this.H5a=xc.oa.Fd.mv;this.HPa=!1;this.UAa()};this.vEb=()=>{J.ULS.sendTraceTag(523257922,
0,50,"DataCleansingPaneStateManager.onUnrecoverableErrorOccurred: Received augmentation loop permanent session close.");this.UAa()};this.$=sb;this.pPd&&this.$.ea.V8(this.xB);this.$.ea.CX(this.WQ);this.$.oa.Fd.bra(this.$Q);this.$.Gn.Pf(this.Eh);this.Smc=this.Smc.bind(this);this.$.da.Za(411,$b=>{$b.xGg(this.Smc);this.uvc&&$b.EGg(this.vEb);2===$b.status&&(this.H5e=!0);this.UAa()});this.sqe()&&(this.isInViewMode=!this.$.ea.isEditMode,this.zLa=1<this.$.ea.Jm.length,this.H5a=this.$.oa.Fd.mv);this.Bgb=this.Qze()}get currentState(){return this.Bgb}get dataCleansingManager(){return this.$.da.za(411,
void 0)}xmb(sb){this.addHandler("scev",sb)}lrc(sb){this.removeHandler("scev",sb)}dispose(){this.$.da.Za(411,sb=>{sb.icj(this.Smc);sb.ocj(this.vEb)});this.$.ea.j6(this.xB);this.pPd&&this.$.ea.j6(this.xB);this.$.ea.x_(this.WQ);this.$.oa.Fd.xPa(this.$Q);this.$.Gn.Ag(this.Eh)}Tzd(){this.HPa=!1;J.ULS.sendTraceTag(537163356,0,50,"DataCleansingPaneStateManager.OnRefreshRequested: refresh pane was triggerd.");this.UAa()}Smc(sb,{sheetId:$b,xda:xc}){J.ULS.sendTraceTag(537163350,0,50,`DataCleansingPaneStateManager.OnSuggestionsStatusChanged: suggestion status of sheet id ${$b} has changed to ${xc}.`);
sb=this.$.xa.oa.sheetId;sb===$b&&2===xc&&(this.HPa=!0);sb!==$b||4!==xc&&2!==xc&&5!==xc||this.UAa()}sqe(){return this.$&&this.$.ea&&this.$.ea.Jm&&this.$.oa&&this.$.oa.Fd?!0:(J.ULS.sendTraceTag(537163349,0,50,"DataCleansingPaneStateManager.AreDependenciesValid: at least one of the dependencies is null."),!1)}UAa(){this.Bgb=this.Qze();this.raiseEvent("scev")}Qze(){let sb;sb=this.y4h()?new M(4,5):this.isInViewMode?new M(5,2):this.pPd&&this.zLa?new M(5,1):this.H5a?new M(5,3):this.HPa?new M(2,0):this.ddi()?
new M(1,0):new M(0,0);J.ULS.sendTraceTag(537163348,0,50,`DataCleansingPaneStateManager.ConcludeState: the new state of the data cleansing task pane is: ${sb}`);return sb}ddi(){const sb=this.mGh();return 4===sb||6===sb}mGh(){return this.dataCleansingManager?this.dataCleansingManager.k9b():0}y4h(){return this.H5e||!this.Hkd()||!this.sqe()}Hkd(){const sb=this.dataCleansingManager;return this.uvc&&K.EwaSettings.isChangeGateEnabled("OfficeVSO:6245313_disableTaskPaneWhenALSessionClose")&&sb?sb.Hkd:!0}}
Object(y.a)(L,"DataCleansingPaneStateManager",R.a,[]);var U=a(197),X=a(1309),da;(function(sb){sb[sb.textInconsistency=0]="textInconsistency";sb[sb.numberFormatInconsistency=1]="numberFormatInconsistency";sb[sb.extraSpaces=2]="extraSpaces"})(da||(da={}));Object(y.b)("SuggestionType",da);var fa=a(736),S=a(14);class ka{constructor(){this.availableTables=this.selectedTable=this.suggestions=this.callbacks=this.isLoading=this.type=null;this.viewState=0;this.applyConfirmationMessage=this.messageType=null}}
Object(y.a)(ka,"DataCleansingTaskPaneProps",null,[]);var V=a(195),wa=a(77),ma=a(5),ab=a(64),ba=a(24);const Ca=(sb,$b)=>{sb=new ba.Range(sb.top,sb.left,sb.bottom,sb.right,!1,$b);if($b&&(1>sb.top||sb.top>sb.maxRows||1>sb.bottom||sb.bottom>sb.maxRows||sb.top>sb.bottom||1>sb.left||sb.left>sb.maxColumns||1>sb.right||sb.right>sb.maxColumns||sb.left>sb.right))throw J.ULS.sendTraceTag(537163357,0,10,"DataCleansingOouiAdapter.ValidateRange: range is invalid"),Error.argument("DataCleansingOouiAdapter.ValidateRange: range is invalid");
return sb};class Na{constructor(sb,$b){this.onKeyDown=xc=>{switch(this.$.shortcutKeyManager.$s(new Sys.UI.DomEvent(xc))){case -1502853784:switch(xc.stopPropagation(),xc=this.$.ea.aNb,xc){case 1:J.ULS.sendTraceTag(523805083,0,50,"DataCleansingReactTaskPane.onKeyDown: Undo command triggered");void c(this.$,1);break;default:J.ULS.sendTraceTag(523621314,0,50,`DataCleansingReactTaskPane.onKeyDown: Undo command skipped, state is ${xc}`)}}};this.Y3b=sb;this.$=$b}sI(sb,$b,xc,ad,Dd,ie){void U.UISurfaces.Lj().then($d=>
{var ne,ye;$d.showTaskPane("DataCleansingTaskPane",this.dw(sb,$b,xc.STd,ad,Dd,ie,xc.messageType));$d=null!==(ne=null===$b||void 0===$b?void 0:$b.length)&&void 0!==ne?ne:0;ne=null!==(ye=null===ad||void 0===ad?void 0:ad.length)&&void 0!==ye?ye:0;ye=this.E1e($b);J.ULS.sendTraceTag(537163409,0,50,`DataCleansingReactTaskPane.ShowReactTaskPane: Suggestions count: [${$d}], tableNames count: [${ne}], taskPaneState: [${xc}], ${ye}`);return null})}yu(sb,$b,xc,ad,Dd,ie,$d=null){void U.UISurfaces.Lj().then(ne=>
{ne.updateTaskPane("DataCleansingTaskPane",this.dw(sb,$b,xc.STd,ad,Dd,ie,xc.messageType,$d));ne=this.E1e($b);J.ULS.sendTraceTag(537163408,0,50,`DataCleansingReactTaskPane.UpdateReactTaskPane: Suggestions count: [${$b.length}], tableNames count: [${ad.length}], taskPaneState: [${xc}], ${ne}`);return null})}OM(){void U.UISurfaces.Lj().then(sb=>{sb.hideTaskPane("DataCleansingTaskPane",2);return null})}Wca(){void U.UISurfaces.Lj().then(sb=>{sb.setSelectedTaskPane("DataCleansingTaskPane");return null})}E1e(sb){if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6807973_DataCleansingLogSuggestionCountPerType")){const $b=
JSON.stringify(this.xXh(sb));sb=this.yXh(sb);return`suggestionsCountPerType: [${$b}], suggestionsGroupIdentifier: [${sb}]`}return""}xXh(sb){var $b;return null!==($b=null===sb||void 0===sb?void 0:sb.reduce((xc,ad)=>{ad=da[ad.type];ad in xc?xc[ad]++:xc[ad]=1;return xc},{}))&&void 0!==$b?$b:{}}yXh(sb){var $b;if(null===($b=null===sb||void 0===sb?void 0:sb[0])||void 0===$b||!$b.tableRange)return"";$b=ab.d(this.$.oa);sb=Ca(sb[0].tableRange,!1).toString();return`${$b} ${sb}`}dw(sb,$b,xc,ad,Dd,ie,$d,ne=null){$b=
Object(P.a)(new ka,{type:"DataCleansingTaskPaneProps",suggestions:$b,callbacks:ie,availableTables:ad,selectedTable:Dd,isLoading:0===xc,viewState:xc,messageType:$d,applyConfirmationMessage:ne});return B.a.zd(this.$)?Object(P.a)(new X.a,{width:320,contentProps:$b,title:S.a.instance.ga(1301),onOpen:ye=>{ye.addEventListener("keydown",this.onKeyDown);this.Y3b.hy()},onClose:ye=>{ye.removeEventListener("keydown",this.onKeyDown);this.Y3b.wB()},onHide:()=>{this.Y3b.wB()},onShow:()=>{this.Y3b.hy()}}):Object(P.a)(new X.a,
{contentProps:Object(P.a)(new fa.a,{container:sb,paneProps:$b})})}}Object(y.a)(Na,"DataCleansingReactTaskPane",null,[]);class za{constructor(){this.containsHiddenCells=this.onPaneLifecycleEvent=this.sendOtelEvent=this.onFeedback=this.onCustomNumberFormatOptionChosen=this.canApplySuggestion=this.onUndo=this.onForceRefresh=this.onTableSelected=this.onSuggestionRejected=this.onSuggestionApplied=this.onSuggestionValuesChanged=this.onCancelSuggestionPreview=this.onSuggestionPreview=this.onSuggestionDeselected=
this.onSuggestionSelected=null}}Object(y.a)(za,"DataCleansingTaskPaneCallbacks",null,[]);var la=a(146);const aa=new Set;var sa=a(186);class ea{constructor(sb){this.UT=this.u7a=null;this.Yxf=()=>{this.hideTaskPane()};this.Zxf=()=>{this.wB()};this.$xf=()=>{this.hy()};this.qCf=()=>{this.updateTaskPane()};this.onSuggestionApplied=$b=>{$b&&this.myj();e(1)};this.Sba=()=>{this.updateTaskPane()};this.Eh=()=>{this.Df&&this.$.da.Za(411,$b=>{$b.VVf()})};this.Tzd=()=>{this.$.da.Za(411,$b=>{$b.nJj()});this.mya.Tzd()};
this.$=sb;this.Osa=new Na(this,this.$);this.Df=this.X5a=!1;this.mya=new L(sb);this.mya.xmb(this.Sba);this.$.da.Za(411,$b=>{$b.BFg(this.qCf);$b.AFg(this.onSuggestionApplied);this.$.Gn.Pf(this.Eh)})}$Ce(){const sb=this.$.da.za(411),$b=null===sb||void 0===sb?void 0:sb.NUe();this.K3g($b,this.KBe(sb))}K3g(sb=null,$b=null){let xc=null,ad=null,Dd=null;sb&&(xc=sb.g7f,ad=sb.DR,Dd=sb.suggestions);if(B.a.zd(this.$))this.Df?this.Osa.Wca():this.Osa.sI(this.u7a,Dd,this.mya.currentState,xc,ad,$b);else if(this.UT)this.w2f(Dd,
xc,ad,$b);else if(!this.X5a){this.X5a=!0;const ie=H.GetServiceTaskFactory.Ta(this.$.da,415,416,0),$d=F.a(this.$);sb=H.GetServiceTaskFactory.create(this.$.da,203,this.$.la,0);N.TaskExtensions.Aa(N.TaskExtensions.Xd([ie,$d,sb],this.$.la),()=>{this.UT=ie.result;$d.result.tQ(this.UT);this.NRi();this.w2f(Dd,xc,ad,$b)},this.$.la,3);return}T.Task.Ua(!0)}hy(){this.Df=!0;aa.clear();this.$.da.Za(411,sb=>{sb.VVf()})}wB(){this.Df=!1;k(this.$);this.$.da.Za(411,sb=>{sb.onSuggestionDeselected(null);sb.Vch();sb.P0b()})}dispose(){this.mya.lrc(this.Sba);
E.a.Ia(this.mya);this.$.da.Za(411,sb=>{sb.tbj(this.qCf);sb.sbj(this.onSuggestionApplied)});this.hideTaskPane();this.UT&&(this.UT.ON(this.Yxf),this.UT.fId(this.Zxf),this.UT.gId(this.$xf),this.$.Gn.Ag(this.Eh),this.UT=null);this.u7a=this.Osa=this.$=null;this.X5a=!1}KBe(sb){return sb?Object(P.a)(new za,{onSuggestionSelected:sb.onSuggestionSelected,onSuggestionDeselected:sb.onSuggestionDeselected,onSuggestionPreview:sb.onSuggestionPreview,onCancelSuggestionPreview:sb.onCancelSuggestionPreview,onSuggestionValuesChanged:sb.onSuggestionValuesChanged,
onSuggestionApplied:sb.qFi,onSuggestionRejected:sb.onSuggestionRejected,onTableSelected:sb.onTableSelected,onForceRefresh:this.Tzd,onUndo:sb.BSi,canApplySuggestion:sb.canApplySuggestion,onCustomNumberFormatOptionChosen:sb.onCustomNumberFormatOptionChosen,onFeedback:()=>{d(this.$)},sendOtelEvent:f,onPaneLifecycleEvent:e,containsHiddenCells:$b=>l(this.$,$b)}):null}NRi(){this.u7a=this.UT.qM();this.UT.$L(this.Yxf);this.UT.HTc(this.Zxf);this.UT.ITc(this.$xf)}w2f(sb,$b,xc,ad){this.UT.hg(!0);this.Df?(this.Osa.yu(this.u7a,
sb,this.mya.currentState,$b,xc,ad),this.Osa.Wca()):(this.Osa.sI(this.u7a,sb,this.mya.currentState,$b,xc,ad),this.hy())}hideTaskPane(){this.Osa.OM();this.wB()}updateTaskPane(){this.$.da.Za(411,sb=>{if(this.Df){const $b=sb.NUe();this.Osa.yu(this.u7a,$b.suggestions,this.mya.currentState,$b.g7f,$b.DR,this.KBe(sb))}})}myj(){this.Df&&this.updateTaskPane()}}Object(y.a)(ea,"DataCleansingPaneManager",null,[]);class Z{constructor(sb,$b){this.type="DataCleansingStatefulTaskPaneProps";this.annotations=[];this.callbacks=
sb;this.hostAppCallbacks=$b}}Object(y.a)(Z,"TaskpaneProps",null,[721]);class ua{constructor(sb,$b,xc){this.Hc=sb;this.Myb=!1;this.LB=Object(P.a)(new X.a,{width:330,title:S.a.instance.ga(1301),onOpen:()=>{this.Myb=!0;aa.clear()},onClose:()=>{this.Myb=!1;k(this.Hc)},onHide:()=>{this.Myb=!1;k(this.Hc)},onShow:()=>{this.Myb=!0;aa.clear()}});this.LB.contentProps=new Z($b,xc)}Kuc(sb){Object.assign(this.LB.contentProps,sb);void this.render()}render(){return Object(sa.a)(this,void 0,void 0,function*(){if(this.Myb){const sb=
yield U.UISurfaces.Lj();sb.updateTaskPane("DataCleansingStatefulTaskPane",this.LB);sb.setSelectedTaskPane("DataCleansingStatefulTaskPane")}})}show(){return Object(sa.a)(this,void 0,void 0,function*(){(yield U.UISurfaces.Lj()).showTaskPane("DataCleansingStatefulTaskPane",this.LB)})}hide(){return Object(sa.a)(this,void 0,void 0,function*(){(yield U.UISurfaces.Lj()).hideTaskPane("DataCleansingStatefulTaskPane",this.LB.location)})}}Object(y.a)(ua,"DataCleansingTaskpane",null,[]);class ya{constructor(sb){this.$=
sb;this.fxf=($b,xc)=>{var ad;null===(ad=this.Z3b)||void 0===ad?void 0:ad.Kuc(xc)}}$Ce(){B.a.zd?this.qvb().then(sb=>sb.show()):J.ULS.sendTraceTag(522782367,0,10,"DataCleansingPaneManager.createOrShowDataCleansingTaskPane: Stateful taskpane is only supported in the new WacTaskPaneInfra")}dispose(){var sb;null===(sb=this.dataCleansingHostManager)||void 0===sb?void 0:sb.lrc(this.fxf)}qvb(){return Object(sa.a)(this,void 0,void 0,function*(){this.Z3b||(this.dataCleansingHostManager=yield H.GetServiceTaskFactory.Qia(this.$.da,
494,495,4),this.Z3b=new ua(this.$,this.dataCleansingHostManager.callbacks,this.dataCleansingHostManager.TIg),this.Z3b.Kuc(this.dataCleansingHostManager.state),this.dataCleansingHostManager.xmb(this.fxf));return this.Z3b})}}Object(y.a)(ya,"DataCleansingPaneManager",null,[]);class ha extends A.a{constructor(sb){super(sb)}Dd(){K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingStatefulTaskPane",!1)?this.ld([new W(this.$,new ya(this.$))]):this.ld([new W(this.$,new ea(this.$))])}static ka(sb){A.a.Rd(417,
new ha(sb))}}Object(y.a)(ha,"DataCleansingCommandHandlerFactory",A.a,[]);var Da=a(220),nb=a(82);class qa{constructor(sb){this.D1f=sb}}Object(y.a)(qa,"DataCleansingApplyContext",null,[]);var pa=a(42);class Ja{constructor(sb,$b,xc){this.suggestions=sb;this.g7f=$b;this.DR=xc}}Object(y.a)(Ja,"DataCleansingSuggestionsResponse",null,[]);var $a=a(262),rb=a(567),Pa=a(156),eb=a(31);class Ob{constructor(sb,$b=null){this.zYa=new Pa.a;this.YPc=this.LMc=null;this.Ezd=xc=>{xc&&eb.a.rg(xc.Errors)?(J.ULS.sendTraceTag(537163360,
0,10,`DataCleansingEwaSuggestion.OnOperationSuccessCallback: Ewa result contains error messages after applying type [${this.type}]`),this.zYa.setResult(null)):(J.ULS.sendTraceTag(537163359,0,50,`DataCleansingEwaSuggestion.OnOperationSuccessCallback: Suggestion of type [${this.type}] applied successfuly.`),this.zYa.setResult(xc))};this.Czd=xc=>{J.ULS.sendTraceTag(537163358,0,10,`DataCleansingEwaSuggestion.OnOperationFailedCallback: Ewa result contains error messages for type [${this.type}], HttpStatus [${xc.data.httpStatus}]`);
this.zYa.setResult(null)};this.jb=sb;$b&&(this.LMc=$b,this.YPc=Ca($b.suggestionRange,!0))}get id(){return this.CN.id}get type(){return this.CN.type}get CN(){return this.LMc}get suggestionRange(){return this.YPc}get $(){return this.jb}fYi(sb,$b){this.LMc=sb=this.e1c(sb,$b);this.YPc=Ca(sb.suggestionRange,!0)}}Object(y.a)(Ob,"DataCleansingEwaSuggestion",null,[]);var tb=a(368),cc=a(170);class Ib{constructor(){this.bottom=this.top=this.right=this.left=0}}Object(y.a)(Ib,"RangeAddress",null,[]);const Mb=
sb=>Object(P.a)(new Ib,{left:sb.left,right:sb.right,top:sb.top,bottom:sb.bottom});var Oa=a(62);const Aa=(sb,$b,xc,ad,Dd,ie,$d,ne=null)=>{ne=sb.Na(9,ne);ne.ranges=$b;ne.trimWhitespaceType=xc;return Oa.g(sb,"TrimWhitespace",ne,ad,Dd,ie,$d,0)};var Ba=a(280),ob=a(21),xb=a(338);class Va{constructor(){this.id=null;this.type=0;this.columnName=this.columnIdentifier=this.suggestionRange=this.suggestionRangeStringRef=this.tableIdentifier=this.tableRange=this.tableName=null}}Object(y.a)(Va,"DataCleansingSuggestion",
null,[]);class bb extends Va{constructor(){super();this.extraSpacesType=0;this.ranges=null}}Object(y.a)(bb,"ExtraSpacesSuggestion",Va,[]);class ra extends Ob{constructor(sb,$b=null){super(sb,$b)}Shd(sb){const $b=this.tua();$b&&ob.g(this.$).ob.yv(xb.a.Y6(ab.d(this.$.oa),Object(pa.W)($b)),sb,!0,void 0,!0)}tua(){const sb=this.CN;sb||J.ULS.sendTraceTag(537163405,0,10,"ExtraSpacesEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const $b=[];for(const xc of sb.ranges)$b.push(Ca(xc,
!1));if(0<$b.length)return $b}XXc(){return!0}apply(){const sb=this.CN,$b=new qa(!0);tb.a(this.$.userOperationManager,(xc,ad,Dd)=>Aa(this.$.pa.va,Object(pa.u)(this.$.activeItemName,null,$a.a.map(sb.ranges,ie=>Ca(ie,!1))),ra.T1g(sb.extraSpacesType),Ba.b(xc,this.Ezd),Ba.a(ad,this.Czd),Dd,$b),xc=>new cc.a(253,0,xc),null);return V.d(this.zYa.task).then(xc=>({result:xc.Result,rna:!0}))}e1c(sb,$b){if(!sb)return J.ULS.sendTraceTag(537163404,0,10,"ExtraSpacesEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),
null;$b=Object(P.a)(new bb,{id:rb.a.create().toString(),type:2,tableRange:$b.tableRange,tableName:$b.tableName,columnName:$b.O_c,extraSpacesType:this.ZVi(sb.extraSpacesType),ranges:[]});var xc=Mb(sb.suggestionRange);$b.suggestionRange=xc;xc=Ca(xc,!0);$b.suggestionRangeStringRef=xc.jz(!1);for(const ad of sb.ranges)$b.ranges.push(Mb(ad));return $b}ZVi(sb){switch(sb){case "Leading":return 0;case "Trailing":return 1;case "InBetween":return 2;default:throw J.ULS.sendTraceTag(537163403,0,10,"ExtraSpacesEwaSuggestion.ParseStringToExtraSpacesType: received illegal extra spaces type."),
Error.argument("illegal extra spaces type");}}static T1g(sb){switch(sb){case 0:return 1;case 2:return 2;case 1:return 4;default:throw J.ULS.sendTraceTag(537163402,0,10,"ExtraSpacesEwaSuggestion.ConvertExtraSpacesTypeToTrimWhitespaceType: received illegal ExtraSpacesPaddingType."),Error.argument("illegal ExtraSpacesPaddingType");}}}Object(y.a)(ra,"ExtraSpacesEwaSuggestion",Ob,[]);var Qa=a(769);class qb extends Va{constructor(){super();this.isMixedNumberText=this.variationsType=this.formats=this.replacementFormat=
this.suggestedFormat=null}}Object(y.a)(qb,"NumberFormatInconsistencySuggestion",Va,[]);class Wa extends Ob{constructor(sb,$b,xc=null){super(sb,xc);this.$pe=!1;this.ug=$b}Shd(sb){const $b=this.tua();$b&&ob.g(this.$).ob.yv(xb.a.Y6(ab.d(this.$.oa),Object(pa.W)($b)),sb,!0,void 0,!1);ob.g(this.$).ob.update(!1)}tua(){const sb=this.CN;sb||J.ULS.sendTraceTag(537163401,0,10,"NumberFormattingEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const $b=[];for(const xc of sb.formats)if(xc.ranges&&
0<xc.ranges.length)for(const ad of xc.ranges)(xc.format!==sb.replacementFormat||K.EwaSettings.isChangeGateEnabled("OfficeVSO:6401137_DataClensingStringTypeAsNonTextFix")&&!xc.isApplicable)&&$b.push(Ca(ad,!1));if(0<$b.length)return $b}XXc(){return!this.$pe}apply(){const sb=this.CN;var $b=this.tua();if(!$b)return J.ULS.sendTraceTag(524940618,0,10,"NumberFormattingEwaSuggestion.apply: empty bad ranges."),Promise.resolve({result:0,rna:!1});const xc=new qa(!0),ad={},Dd=sb.formats.find(({key:ye})=>ye===
sb.replacementFormat).format;ad.NumberFormatOptions=Wa.u2g(Dd);ad.ValidMembers=32;ad.NumberFormat=15;const ie=Object(pa.u)(this.$.oa.sheetName,null,$b);$b=ob.g(this.$);const $d=Object(pa.o)($b.ha.sa.activeCell,this.$),ne=this.$.pa.va.Qb({MZ:!0,bZ:1});tb.a(this.$.userOperationManager,(ye,te,Ze)=>Oa.l(this.$.pa.va,ie,$d,ad,!1,null,null,!0,Ba.b(ye,this.Ezd),Ba.a(te,this.Czd),Ze,xc,ne,null),ye=>new cc.a(11,0,ye),null);return V.d(this.zYa.task).then(()=>({result:-1,rna:!0}))}e1c(sb,$b){if(!sb)return J.ULS.sendTraceTag(537163400,
0,10,"NumberFormattingEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;var xc=sb.suggestedFormat.value;const ad=this.mUe(xc);$b=Object(P.a)(new qb,{id:rb.a.create().toString(),type:1,tableRange:$b.tableRange,tableName:$b.tableName,columnName:$b.O_c,replacementFormat:xc,suggestedFormat:xc,formats:[],variationsType:this.$Vi(sb.variationsType)});xc=Mb(sb.suggestionRange);$b.suggestionRange=xc;xc=Ca(xc,!0);$b.suggestionRangeStringRef=xc.jz(!1);this.npe(ad,sb.suggestedFormat,
$b);for(var Dd of sb.otherFormats)sb=this.mUe(Dd.value),this.npe(sb,Dd,$b);Dd=this.yzh($b);$b.suggestedFormat=Dd;$b.replacementFormat=Dd;Dd||(this.$pe=!0);return $b}yzh(sb){if(sb=sb.formats.find($b=>$b.isApplicable))return sb.format}npe(sb,$b,xc){sb={value:sb,ranges:[],isApplicable:sb?$b.isApplicable:!1,format:$b.value,key:$b.value};this.Vuc(sb,$b.ranges);xc.formats.push(sb)}mUe(sb){if(!Wa.vtb.has(sb)){const $b=this.ug.lTe("1234.56",sb,244,"12px sans-serif");$b.success?(Array.from(Wa.vtb.values()).find(xc=>
xc==$b.Px)&&J.ULS.sendTraceTag(524170578,0,50,"Duplicated friendly format string for different formats."),Wa.vtb.set(sb,$b.Px)):(J.ULS.sendTraceTag(537163399,0,50,"NumberFormattingEwaSuggestion.GenerateFriendlyFormatString: Failed to acquire friendly format string"),Wa.vtb.set(sb,""))}return Wa.vtb.get(sb)}Vuc(sb,$b){for(const xc of $b)$b=Mb(xc),sb.ranges.push($b)}static u2g(sb){return Object(P.a)(new Qa.a,{NumberFormatCategory:-1,CustomFormatString:sb})}$Vi(sb){switch(sb){case "AllNumber":return 0;
case "AllText":return 1;case "MixedNumberAndText":return 2;default:throw J.ULS.sendTraceTag(529105823,0,10,"NumberFormattingEwaSuggestion.ParseStringToNumberFormatVariationsType: received illegal variations type."),Error.argument("illegal variations type");}}}Wa.vtb=new Map;Object(y.a)(Wa,"NumberFormattingEwaSuggestion",Ob,[]);var ta=a(247),ib=a(79);class Bb extends Ob{constructor(sb,$b=null){super(sb,$b)}Shd(sb){const $b=this.tua();$b&&ob.g(this.$).ob.yv(xb.a.Y6(ab.d(this.$.oa),Object(pa.W)($b)),
sb,!0,void 0,!1);ob.g(this.$).ob.update(!1)}tua(){const sb=this.CN;sb||J.ULS.sendTraceTag(537163392,0,10,"TextInconsistencyEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const $b=this.t2e(xc=>xc.isSelected&&xc.value!==sb.replacementValue,!1);if(0<$b.length)return $b}XXc(){const sb=this.CN;return $a.a.any(sb.variations,$b=>$b.isSelected&&$b.value!==sb.replacementValue)&&!!sb.replacementValue}apply(){const sb=this.CN,$b=this.WJ(),xc=this.t2e($d=>$d.isSelected&&$d.value!==
sb.replacementValue),ad=sb.variations.every($d=>$d.value!==sb.replacementValue),Dd=new qa(!ad&&!0);tb.a(this.$.userOperationManager,($d,ne,ye)=>ta.w(this.$.pa.va,$b,Object(pa.u)(this.$.oa.sheetName,null,xc),sb.replacementValue,Ba.b($d,this.Ezd),Ba.a(ne,this.Czd),ye,Dd),$d=>new cc.a(258,0,$d),null);const ie=sb.variations.filter($d=>$d.isSelected&&$d.value!==sb.replacementValue).length;return V.d(this.zYa.task).then(()=>({result:ie,rna:!0}))}e1c(sb,$b){if(!sb)return J.ULS.sendTraceTag(537163361,0,10,
"TextInconsistencyEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;$b={id:rb.a.create().toString(),type:0,tableRange:$b.tableRange,tableName:$b.tableName,columnName:$b.O_c,normalizedValue:sb.normalizedValue,suggestedValue:sb.suggestedValue.value,replacementValue:sb.suggestedValue.value,variations:[],tableIdentifier:null,suggestionRange:null,suggestionRangeStringRef:null,columnIdentifier:null};var xc=Mb(sb.suggestionRange);$b.suggestionRange=xc;xc=Ca(xc,!0);
$b.suggestionRangeStringRef=xc.jz(!1);xc={value:sb.suggestedValue.value,ranges:[],isSelected:!1};this.Vuc(xc,sb.suggestedValue.ranges);$b.variations.push(xc);for(const ad of sb.variations)sb={value:ad.value,ranges:[],isSelected:!0},this.Vuc(sb,ad.ranges),$b.variations.push(sb);return $b}Vuc(sb,$b){for(const xc of $b)$b=Mb(xc),sb.ranges.push($b)}WJ(){const sb=this.CN,$b=ib.select(ib.where(ib.asEnumerable(sb.variations),ad=>ad.isSelected&&ad.value!==sb.replacementValue),ad=>ad.value),xc={ExcludeFormulaResult:!0,
MatchCase:!0,MatchEntireCell:!0,SearchAllSheets:!1};xc.SearchStrings=ib.toArray($b);xc.SearchUp=!1;xc.SheetName=this.$.oa.sheetName;return xc}t2e(sb,$b=!0){const xc=[],ad=this.CN;for(const Dd of ad.variations)Dd.ranges&&sb(Dd)&&xc.push(...$a.a.map(Dd.ranges,ie=>Ca(ie,$b)));return xc}}Object(y.a)(Bb,"TextInconsistencyEwaSuggestion",Ob,[]);const Ub=(sb,$b,xc,ad)=>{try{switch(xc.type){case "TextInconsistency":return Ta(xc,ad,()=>new Bb(sb));case "ExtraSpaces":return Ta(xc,ad,()=>new ra(sb));case "NumberFormattingInconsistency":return Ta(xc,
ad,()=>new Wa(sb,$b));default:return J.ULS.sendTraceTag(537163424,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: suggestion type is not supported - "+xc.type),null}}catch(Dd){return J.ULS.sendTraceTag(537163423,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: exception thrown"),null}},Ta=(sb,$b,xc)=>{xc=xc();xc.fYi(sb,$b);return xc};class mb extends R.a{constructor(sb){super();this.Jz=new Map;this.Fka=new Map;this.YYb=new Map;this.rKc=null;this.xda=new Map;
this.$=sb}get $hf(){return this.rKc}get Xie(){var sb=this.$.xa.oa.sheetId;const $b=[];if(!this.Jz.has(sb))return $b;sb=this.Jz.get(sb);for(let xc of sb.keys())this.MUe(xc).length&&$b.push(xc);return $b}get $yg(){const sb=this.$.xa.oa.sheetId;return this.xda.has(sb)?this.xda.get(sb):0}get RFj(){return this.xda.keys()}P0b(){this.Fka=new Map}UWg(){this.YYb=new Map;this.rKc=null}applySuggestion(sb){sb&&this.YYb.set(sb.id,sb)}kxe(sb){const $b=this.xda.get(sb);if(2===$b||5===$b)K.EwaSettings.isChangeGateEnabled("OfficeVSO:6443391_InfiniteLoadingOnSwitchingSheets")?
J.ULS.sendTraceTag(537163407,0,50,`DataCleansingSuggestionsCollection.clearAllSuggestions: Clearing all suggestions for sheet ${sb}. Suggestions status=${$b}.`):J.ULS.sendTraceTag(521213260,0,50,"DataCleansingSuggestionsCollection.clearAllSuggestions: Clearing all suggestions."),this.P0b(),this.uXg(),this.UWg()}fAi(sb,$b){this.Fka.set(sb,$b)}onSuggestionApplied(sb){this.rKc=sb}ASi(sb){this.YYb.delete(sb)}Fm(sb,$b){if(this.Jz.has(sb)&&(sb=this.Jz.get(sb),sb.has($b))){$b=sb.get($b);for(let xc of $b.values())return Ca(xc.CN.tableRange,
!0)}return null}tmi(sb,$b){return this.Jz.has(sb)?this.Jz.get(sb).has($b):!1}MUe(sb){const $b=[];if(!sb)return $b;var xc=this.$.xa.oa.sheetId;if(!this.Jz.has(xc))return $b;xc=this.Jz.get(xc);if(xc.has(sb)){sb=xc.get(sb);for(let ad of sb.keys())this.YYb.has(ad)||(this.Fka.has(ad)?$b.push(this.Fka.get(ad).CN):$b.push(sb.get(ad).CN))}return $b}H3a(sb){return this.Fka.has(void 0)?this.Fka.get(void 0):this.Jz.has(sb)&&(sb=this.Jz.get(sb),sb.has(void 0)&&(sb=sb.get(void 0),sb.has(void 0)))?sb.get(void 0):
null}uXh(sb){if(this.Fka.has(sb))return this.Fka.get(sb);for(const $b of this.Jz.values())for(const xc of $b.values())if(xc.has(sb))return xc.get(sb);return null}aOd(sb,$b,xc){if(xc){this.kxe(sb);this.xda.set(sb,1);for(const ad of xc)this.oCg(sb,$b,ad)}}CHd(sb,$b,xc){this.j$i(sb,$b,xc);this.Fka.delete(xc.id)}TZf(sb,$b){this.xda.set($b,sb);J.ULS.sendTraceTag(537163406,0,50,`DataCleansingSuggestionsCollection.setAllSheetsSuggestionsStatus: Setting the suggestions status of sheet id ${$b} to ${sb}.`)}Ped(sb){return this.xda.get(sb)}vWh(sb){let $b=
0;if(this.Jz.has(sb)){sb=this.Jz.get(sb);for(const [,xc]of sb)$b+=xc.size}return $b}uXg(){this.Jz=new Map;this.xda=new Map}j$i(sb,$b,xc){if(this.Jz.has(sb)){const ad=this.Jz.get(sb);if(ad.has($b)){const Dd=ad.get($b);Dd.has(xc.id)&&(Dd.delete(xc.id),Dd.size||ad.delete($b),ad.size||this.Jz.delete(sb))}}}oCg(sb,$b,xc){this.Jz.has(sb)||this.Jz.set(sb,new Map);const ad=this.Jz.get(sb);ad.has($b)||this.Jz.get(sb).set($b,new Map);ad.get($b).set(xc.id,xc)}}Object(y.a)(mb,"DataCleansingSuggestionsCollection",
R.a,[]);var Qb=a(720),Lb=a(694);class Jb extends Qb.a{constructor(){super();this.columnIdentifier=this.tableIdentifier=this.tableRange=this.tableName=this.worksheetName=this.worksheetId=null;this.H_=Object.assign(new Lb.a,{T_:Jb.getTypeName(),B_:Jb.Od()})}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static Od(){return["AugLoop_Core_Annotation"]}}Object(y.a)(Jb,"TableLintAnnotationBase",Qb.a,[]);class Ab extends Jb{constructor(){super();this.investigationTelemetry=this.suggestions=
this.columnName=this.columnTitle=null;this.H_=Object.assign(new Lb.a,{T_:Ab.getTypeName(),B_:Ab.Od()})}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static Od(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(y.a)(Ab,"TableLintColumnAnnotation",Jb,[]);class pb extends Qb.a{constructor(){super();this.worksheetId=null;this.errorCount=this.suggestionsCount=0;this.unsupportedFeaturesSet=null;this.H_=Object.assign(new Lb.a,{T_:pb.getTypeName(),
B_:pb.Od()})}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static Od(){return["AugLoop_Core_Annotation"]}}Object(y.a)(pb,"TableLintWorksheetAggregateAnnotation",Qb.a,[]);class va extends Jb{constructor(){super();this.errorCategory=this.errorType=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Lb.a,{T_:va.getTypeName(),B_:va.Od()})}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static Od(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}}Object(y.a)(va,"TableLintErrorAnnotation",Jb,[]);class db extends Jb{constructor(){super();this.unsupportedFeatures=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Lb.a,{T_:db.getTypeName(),B_:db.Od()})}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static Od(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(y.a)(db,"TableLintUnsupportedFeatureAnnotation",
Jb,[]);class Ya extends R.a{constructor(sb){super();this.mga=!1;this.e7f=($b,xc)=>{if($b=xc.kJ)switch(xc.operationType){case 1:case 2:this.raiseEvent("carek",$b);break;case 3:this.raiseEvent("caiek",$b);break;default:J.ULS.sendTraceTag(537163396,306,15,`TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:${xc.operationType}`)}else J.ULS.sendTraceTag(537163397,306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotation is null.")};this.f7f=($b,
xc)=>{if(xc.kJ)switch(xc.operationType){case 1:case 2:this.raiseEvent("aarek",xc.kJ);break;case 3:break;default:J.ULS.sendTraceTag(537163394,306,15,`TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:${xc.operationType}`)}else J.ULS.sendTraceTag(537163395,306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};this.UGj=($b,xc)=>{J.ULS.sendTraceTag(537163393,306,50,`TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: ${$b}->${xc}`)};
this.augmentationLoopManager=sb}BWb(){this.mga?J.ULS.sendTraceTag(537163398,0,50,"TableLintManager.ActivateEvents: Events are already registered"):(this.q8i(),this.mga=!0)}dispose(){this.mga&&(this.OOj(),this.mga=!1)}zle(sb){this.addHandler("carek",sb)}SOf(sb){this.removeHandler("carek",sb)}sle(sb){this.addHandler("aarek",sb)}GOf(sb){this.removeHandler("aarek",sb)}ule(sb){this.addHandler("caiek",sb)}HOf(sb){this.removeHandler("caiek",sb)}q8i(){J.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations");
this.augmentationLoopManager.activateAnnotation(Ab.getTypeName(),this.UGj);this.augmentationLoopManager.activateAnnotation(pb.getTypeName());this.augmentationLoopManager.L1.$O("Valid",Ab.getTypeName(),this.e7f);this.augmentationLoopManager.L1.$O("Valid",pb.getTypeName(),this.f7f);this.augmentationLoopManager.activateAnnotation(va.getTypeName());this.augmentationLoopManager.activateAnnotation(db.getTypeName())}OOj(){this.augmentationLoopManager.L1.pPa("Valid",Ab.getTypeName(),this.e7f);this.augmentationLoopManager.L1.pPa("Valid",
pb.getTypeName(),this.f7f)}}Object(y.a)(Ya,"TableLintManager",R.a,[3]);class gb{constructor(sb,$b,xc,ad){this.tableName=sb;this.columnName=$b;this.columnTitle=xc;this.tableRange=ad}get O_c(){const sb=String.format(S.a.instance.mb(178),this.columnTitle);return this.columnName?`${sb} (${this.columnName})`:sb}}Object(y.a)(gb,"ColumnMetadata",null,[]);class Ka{constructor(sb,$b,xc,ad){this.Plf=[];this.mDb=(Dd,ie)=>{this.dataCleansingManager.aOd(ie.worksheetId,ie.tableName,this.FDe(ie))};this.ZCb=(Dd,
ie)=>{this.Esi(ie);this.dataCleansingManager.Dsj(ie.worksheetId)};this.$Cb=(Dd,ie)=>{this.dataCleansingManager.CHd(ie.worksheetId,ie.tableName,this.FDe(ie)[0])};this.dataCleansingManager=sb;this.$=ad;this.ug=xc;this.$z=$b;this.$z.zle(this.mDb);this.$z.sle(this.ZCb);this.$z.ule(this.$Cb)}dispose(){this.$z.SOf(this.mDb);this.$z.GOf(this.ZCb);this.$z.HOf(this.$Cb)}Esi(sb){this.Plf.includes(sb.worksheetId)||(this.Plf.push(sb.worksheetId),J.ULS.sendTraceTag(521200220,0,50,`AnnotationsHandler.logAggregateAnnotationStatus aggregated information:
        ${JSON.stringify({["suggestionCount"]:sb.suggestionsCount,["errorsCount"]:sb.errorCount,["unsupportedFeaturesCount"]:sb.unsupportedFeaturesSet.length,["unsupportedFeatures"]:sb.unsupportedFeaturesSet.join(",")})}`))}FDe(sb){const $b=[],xc=new gb(sb.tableName,sb.columnName,sb.columnTitle,Mb(sb.tableRange));for(const ad of sb.suggestions)(sb=Ub(this.$,this.ug,ad,xc))&&$b.push(sb);return $b}}Object(y.a)(Ka,"AnnotationsHandler",null,[3]);var ub=a(97);class ac extends Sys.EventArgs{constructor(sb,
$b){super();this.sheetId=sb;this.xda=$b}}Object(y.a)(ac,"DataCleansingSuggestionStatusChangedEventArgs",Sys.EventArgs,[]);var Ra=a(90);class na extends R.a{constructor(sb,$b,xc){var ad,Dd,ie;super();this.gWc=[45];this.$z=this.Boe=this.DR=null;this.Fhc=0;this.r3f=this.uvc=!1;this.timestamps={zbb:0,o8b:0,wAb:0,mdb:0};this.onSuggestionSelected=$d=>{($d=this.H3a($d))?(this.b7e($d),this.JAi($d)):J.ULS.sendTraceTag(537163416,0,10,"DataCleansingManager.OnSuggestionSelected: Attempted to highlight missing suggestion")};
this.onSuggestionDeselected=()=>{this.ywb()};this.onSuggestionPreview=$d=>{($d=this.H3a($d))?this.b7e($d):J.ULS.sendTraceTag(537163415,0,10,"DataCleansingManager.OnSuggestionPreview: Attempted to highlight missing suggestion")};this.onCancelSuggestionPreview=()=>{this.ywb()};this.onSuggestionValuesChanged=$d=>{J.ULS.sendTraceTag(537163414,0,50,`DataCleansingManager.OnSuggestionValuesChanged: Change in suggestion of type [${$d.type}]`);a:{var ne=this.$,ye=this.ug;switch($d.type){case 0:$d=new Bb(ne,
$d);break a;case 2:$d=new ra(ne,$d);break a;case 1:$d=new Wa(ne,ye,$d);break a;default:J.ULS.sendTraceTag(537163422,0,10,"DataCleansingEwaSuggestionFactory.CreateFromPaneSuggestion: suggestion type is not supported"),$d=null}}this.suggestions.fAi($d.id,$d);this.onSuggestionSelected($d.id);this.raiseEvent("oscek")};this.qFi=$d=>{const ne=this.H3a($d);if(!ne)return J.ULS.sendTraceTag(537163413,0,10,"DataCleansingManager.OnSuggestionApplied: Attempted to apply non-existant suggestion"),Promise.reject();
K.EwaSettings.isChangeGateEnabled("OfficeVSO:6808053_DCHiddenCellsTelemetry")&&void l(this.$,[ne.suggestionRange]).then(ye=>{ye.length&&J.ULS.sendTraceTag(512501985,0,50,"DataCleansingManager.OnSuggestionApplied: suggestion with hidden cells applied")});$d=(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingNewApply",!1)?m(this.$,ne.CN,ne.tua()):ne.apply()).then(ye=>{ye.rna&&(this.ywb(),this.suggestions.applySuggestion(ne),ne.id===this.suggestions.$hf?this.raiseEvent("osaek",
void 0,ne):this.raiseEvent("oscek"));return ye.result});this.suggestions.onSuggestionApplied(ne.id);return $d};this.onCustomNumberFormatOptionChosen=$d=>this.H3a($d)?new Promise(ne=>{b(this.$,ye=>{ne(ye);J.ULS.sendTraceTag(523548835,0,50,`DataCleansingManager.onCustomNumberFormatOptionChosen: user closed the NumberFormatDialog while clicking on ${ye?"OK":"Cancel"} button.`)})}):(J.ULS.sendTraceTag(523548864,0,10,`DataCleansingManager.onCustomNumberFormatOptionChosen: Attempted to choose non-existant suggestion. suggestionId: ${$d}`),
Promise.reject(`Couldn't find the suggestion with the requested id. id: ${$d}`));this.BSi=()=>{const $d=this.suggestions.$hf;return c(this.$).then(ne=>{ne&&(this.suggestions.ASi($d),this.raiseEvent("oscek"))})};this.canApplySuggestion=$d=>{$d=this.H3a($d);return $d?$d.XXc():(J.ULS.sendTraceTag(537163412,0,10,"DataCleansingManager.CanApplySuggestion: Did not find suggestion in collection"),!1)};this.onSuggestionRejected=()=>{};this.onTableSelected=$d=>{if(!this.F6a||this.DR!==$d){this.ywb();this.DR=
$d;this.F6a=!0;$d=this.suggestions.Fm(this.$.oa.sheetId,$d);if(!$d)throw Error.argument("Table does not exist in suggestion collection");ob.g(this.$).vg(pa.v($d,this.$),$d.topLeft,null,null,0,ub.a.dataCleansing);this.GFj();this.raiseEvent("oscek")}};this.Uc=()=>{this.S4c()};this.sTi=$d=>{$d instanceof qa?(J.ULS.sendTraceTag(526410371,0,50,`DataCleansingManager.OnWorkbookChangedEventHandler: Suggestion applied with shouldSkipRefresh=${$d.D1f}`),$d=$d.D1f?6:5):(this.oJj(),J.ULS.sendTraceTag(526410370,
0,50,"DataCleansingManager.OnWorkbookChangedEventHandler: Invalidating all existing suggestions since the workbook changed"),$d=2);for(let ne of this.suggestions.RFj)this.suggestions.TZf($d,ne),this.raiseEvent("osscek",new ac(ne,this.suggestions.Ped(ne)))};this.I_d=($d,ne)=>{J.ULS.sendTraceTag(524817559,0,50,`DataCleansingManager.WorkbookCoauthVersionChangedEventHandler: Workbook changed, revision record is now ${ne.coauthVersion}`);this.sTi(ne.userContext)};this.I8a=()=>{J.ULS.sendTraceTag(523257923,
0,50,"DataCleansingManager.onAugmentationLoopSessionClose: Received augmentation loop session close.");this.uvc&&(this.Lgf=!0,this.raiseEvent("ueek"))};this.Eh=()=>{this.showCallout()};this.$=xc;this.augmentationLoopManager=sb;this.ug=$b;this.suggestions=new mb(xc);this.F6a=!1;this.Nsa=this.augmentationLoopManager?0:2;this.Lgf=!1;null===(Dd=null===(ad=this.augmentationLoopManager)||void 0===ad?void 0:ad.L1)||void 0===Dd?void 0:Dd.Lje(this.I_d);null===(ie=this.augmentationLoopManager)||void 0===ie?
void 0:ie.fXb(this.I8a);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.$.Gn.Pf(this.Eh)}get status(){return this.Nsa}get Hkd(){return!this.Lgf}BFg(sb){this.addHandler("oscek",sb)}tbj(sb){this.removeHandler("oscek",sb)}AFg(sb){this.addHandler("osaek",sb)}sbj(sb){this.removeHandler("osaek",sb)}xGg(sb){this.addHandler("osscek",sb)}icj(sb){this.removeHandler("osscek",sb)}EGg(sb){this.addHandler("ueek",sb)}ocj(sb){this.removeHandler("ueek",sb)}initialize(){2===
this.Nsa?J.ULS.sendTraceTag(537163421,0,50,"DataCleansingManager.Initialize: skipping initialization since manager status is Error"):K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintExperiment",!1)||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)?(J.ULS.sendTraceTag(574408774,0,50,"DataCleansingManager.Initialize: activate tablelint events"),this.Nsa=1,this.Mie()):K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintProdExperiment",
!1)&&(J.ULS.sendTraceTag(537163420,0,50,"DataCleansingManager.Initialize: Check license for activating tablelint events"),nb.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(sb=>{sb.isFeatureEnabled("ExcelIntelligence",!1).then($b=>{$b&&(J.ULS.sendTraceTag(537163419,0,50,"DataCleansingManager.Initialize: LicenseEnabled - activate tablelint events"),this.Nsa=1,this.Mie());return $b})}))}k9b(){return 2===this.Nsa?3:this.suggestions.$yg}NUe(){this.rli||this.SYf();
return new Ja(this.suggestions.MUe(this.DR),this.suggestions.Xie,this.DR)}VVf(){this.SYf();if(this.DR)this.onTableSelected(this.DR)}aOd(sb,$b,xc){if(0===this.Nsa||1===this.Nsa)J.ULS.sendTraceTag(537163418,0,50,"DataCleansingManager.SetSuggestions: Setting data cleansing manager status to Ready"),this.Nsa=3;6!==this.k9b()&&(this.suggestions.aOd(sb,$b,xc),this.raiseEvent("osscek",new ac(sb,this.suggestions.Ped(sb))))}CHd(sb,$b,xc){this.suggestions.CHd(sb,$b,xc);this.raiseEvent("oscek")}Dsj(sb){this.Cvi();
J.ULS.sendTraceTag(537163417,0,50,`DataCleansingManager.SetSuggestionsReady: the suggestions of sheet id ${sb} are ready.`);K.EwaSettings.isChangeGateEnabled("OfficeVSO:6443391_InfiniteLoadingOnSwitchingSheets")&&this.suggestions.kxe(sb);6!==this.k9b()&&(this.suggestions.TZf(4,sb),this.raiseEvent("osscek",new ac(sb,this.suggestions.Ped(sb))));sb===this.$.oa.sheetId&&this.showCallout()}Vch(){this.F6a&&this.S4c();this.DR=null}P0b(){this.suggestions.P0b()}dispose(){this.augmentationLoopManager.L1.NNf(this.I_d);
this.F6a&&this.$&&this.Xag();E.a.Ia(this.Boe);E.a.Ia(this.$z);super.dispose()}nJj(){this.timestamps.mdb?(J.ULS.sendTraceTag(523903316,0,50,'DataCleansingManager.timestampSeeNewChangesClicked "see new changes" clicked after suggestions were loaded'),this.timestamps.zbb=0):this.timestamps.zbb=performance.now()}oJj(){var sb;this.timestamps.zbb=0;this.timestamps.mdb=0;(sb=this.timestamps).o8b||(sb.o8b=performance.now());this.timestamps.wAb=performance.now()}Cvi(){var sb;this.timestamps.mdb=performance.now();
if(this.timestamps.wAb){const $b=this.timestamps.mdb-(null!==(sb=this.timestamps.o8b)&&void 0!==sb?sb:this.timestamps.wAb);sb=JSON.stringify({["timeElapsedSinceFirstManualChange"]:$b,["timeElapsedSinceLastManualChange"]:this.timestamps.mdb-this.timestamps.wAb,["timeElapsedSinceSeeNewChangesClick"]:this.timestamps.zbb?this.timestamps.mdb-this.timestamps.zbb:0});J.ULS.sendTraceTag(523903315,0,50,`DataCleansingManager.logTimeElapsedTillSuggestionsReady suggestion appears timers:
        ${sb}`)}this.timestamps.wAb=0;this.timestamps.o8b=0;this.timestamps.zbb=0}Mie(){this.$z=new Ya(this.augmentationLoopManager);this.Boe=new Ka(this,this.$z,this.ug,this.$);this.$z.BWb()}GFj(){ob.g(this.$).ha.lE(this.Uc);ob.g(this.$).iC(this.Uc)}Xag(){ob.g(this.$).ha.fI(this.Uc);ob.g(this.$).BD(this.Uc)}Seh(){if(this.F6a){const sb=this.suggestions.Fm(this.$.oa.sheetId,this.DR).topLeft;ob.g(this.$).ha.Qw([sb],0,sb,0);this.S4c()}}S4c(){this.F6a=!1;this.Xag()}JAi(sb){sb=sb.tua();if(null===sb||void 0===
sb?0:sb.length)[{topLeft:sb}]=sb.sort(($b,xc)=>$b.top<xc.top?-1:$b.top>xc.top?1:0),ob.g(this.$).kK(sb)||(J.ULS.sendTraceTag(523547680,0,50,"DataCleansingManager.moveViewportToSuggestionIfNeeded moving viewport"),ob.g(this.$).Sr(sb,0,ub.a.dataCleansing))}b7e(sb){this.Seh();this.ywb();sb.Shd(this.gWc)}ywb(){ob.g(this.$).ob.Tg(this.gWc);ob.g(this.$).ob.wi(null,this.gWc,!1);ob.g(this.$).ob.update(!1)}SYf(){this.DR=this.suggestions.Xie[0]}get rli(){return this.DR&&this.suggestions.tmi(this.$.oa.sheetId,
this.DR)}H3a(sb){return this.suggestions.uXh(sb)}showCallout(){if(!this.r3f&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)){var sb=this.k9b();if(6===sb||4===sb)if(sb=this.suggestions.vWh(this.$.oa.sheetId),2>sb)J.ULS.sendTraceTag(521410393,0,50,`DataCleansingManager.showCallout: suggestion count(${sb}) is below threshold to show teaching callout`);else{var $b=new Ra.a(-847286761,wa.a.Eb,this.$.Mc,0,ma.a.IV),xc={};xc.SuggestionsCount=sb;xc.CalloutName=
16;this.r3f=!0;this.$.Ka.Lb($b,xc)}}}}Object(y.a)(na,"DataCleansingManager",R.a,[461,3]);class lb extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}create(){const sb=H.GetServiceTaskFactory.Ta(this.$.da,328,327,1),$b=H.GetServiceTaskFactory.create(this.$.da,18,this.$.la,1);N.TaskExtensions.Aa(N.TaskExtensions.Xd([sb,$b],this.la),()=>{let xc=this.$.da.za(411);xc||(xc=new na(sb.result,$b.result,this.$),K.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
this.$.da.Ga(411,xc),xc.initialize(),J.ULS.sendTraceTag(537163411,0,50,"DataCleansingManagerFactory.Create: DataCleansingManager initialized successfully"));this.qb(xc)},this.la,3)}static ka(sb){sb.da.Ga(412,new lb(sb))}}Object(y.a)(lb,"DataCleansingManagerFactory",Da.a,[]);var jb=a(785),Yb=a(221),Gb=a(13),wb=a(108),dc=a(4),Jc=a(85),Qc=a(234),fd=a(137);class Wc{}Wc.qah="DataCleansingPane";Wc.sah="DataCleansingPaneHeader";Wc.rah="DataCleansingPaneBody";Wc.tah="DataCleansingPaneTitle";Wc.pah="DataCleansingCloseButton";
Object(y.a)(Wc,"CssClassNames",null,[]);var Rb=a(19),Sb=a(258),mc=a(245),ec=a(12),Rc=a(699);class Mc extends Qc.a{constructor(sb,$b){super(document.createElement("div"));this.yp=!1;this.mye=this.fe=null;this.vu=0;this.$j=()=>{this.hg(!1);this.raiseEvent("DCTPC");return!0};this.$=sb;this.taskPaneManager=$b;this.G8h();Sb.a(sb).Xh(this)}bP(sb){this.get_events().addHandler("DCTPR",sb)}pR(sb){this.get_events().removeHandler("DCTPR",sb)}$L(sb){this.addHandler("DCTPC",sb)}ON(sb){this.removeHandler("DCTPC",
sb)}HTc(sb){this.addHandler("DCTPCO",sb)}fId(sb){this.removeHandler("DCTPCO",sb)}ITc(sb){this.addHandler("DCTPC",sb)}gId(sb){this.removeHandler("DCTPC",sb)}get isVisible(){return super.isVisible}set isVisible(sb){super.isVisible!==sb&&(super.isVisible=sb,this.raiseEvent(sb?"DCTPC":"DCTPCO"))}get jf(){return this.isVisible}get Zd(){return mc.a.uah}get Wg(){return 18}get Sk(){return Rb.a.KOe}get QM(){return S.a.instance.ga(1069)}get wo(){return 320}get isResizable(){return!1}get lc(){return this.domElement}get titleText(){return S.a.instance.ga(1301)}xH(){}hp(){return this.yp}Yr(){return this.yp}cR(){}nQ(){return!1}kj(){}Mj(){}gg(){return!0}hh(sb){return ec.DOMElementExtensions.uf(this.lc,
sb)}hg(sb){this.isVisible=this.yp=sb;this.taskPaneManager.Vw();sb&&0<this.taskPaneManager.aA.length&&(!this.taskPaneManager.Bg||18!==this.taskPaneManager.Bg.taskPane.Wg||this.taskPaneManager.isCollapsed)&&this.taskPaneManager.WF(this,!0);this.$.pf()}qM(){const sb=Rc.b("div","DataCleansingPaneBodyId",Wc.rah),$b=this.domElement;$b.setAttribute(fd.a.ariaLabel,S.a.instance.ga(1302));$b.appendChild(this.VG());$b.appendChild(sb);return sb}dispose(){this.fe&&(Yb.a.instance.Ba(Gb.a.click,this.fe,this.$j),
wb.KeyInputManager.instance.Ev(this.fe,this.mye),this.fe=null);this.taskPaneManager=this.$=null;super.dispose()}G8h(){const sb=this.domElement;sb.id="DataCleansingPaneId";document.getElementById(this.$.Bb+ma.a.VQ).appendChild(sb);sb.classList.add(Wc.qah)}VG(){const sb=Rc.b("div","DataCleansingPaneHeaderId",Wc.sah),$b=Rc.b("span","DataCleansingPaneTitleId",ma.a.Zxc+Wc.tah);$b.innerText=this.titleText;this.fe=jb.a.pb("DataCleansingPaneCloseButtonId",ma.a.sdb+Wc.pah,S.a.instance.ga(10),"ClosePaneGlyph_16x16x32",
!1);this.fe.classList.add(dc.AFrameworkApplication.isRtl?ma.a.O$:ma.a.P$);Yb.a.instance.ra(Gb.a.click,this.fe,this.$j);this.mye=wb.KeyInputManager.instance.ls(this.fe,this.$j,Jc.a.Zh);sb.appendChild($b);sb.appendChild(this.fe);return sb}}Object(y.a)(Mc,"DataCleansingTaskPane",Qc.a,[686,3,247,110]);class bc extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}create(){N.TaskExtensions.Aa(F.a(this.$),sb=>{sb=sb.result;sb=this.$.da.za(415)||this.$.da.Ga(415,new Mc(this.$,sb));this.qb(sb)},this.la,
3)}static ka(sb){sb.da.Ga(416,new bc(sb))}}Object(y.a)(bc,"DataCleansingTaskPaneFactory",Da.a,[]);const ic={width:244,font:"12px sans-serif"},Yc=[45];class md{constructor(sb,$b){this.$=sb;this.ug=$b;this.doUndo=()=>Object(sa.a)(this,void 0,void 0,function*(){yield c(this.$)});this.highlightRangesOnGrid=(xc,ad)=>Object(sa.a)(this,void 0,void 0,function*(){this.oz(xc,ad)});this.selectRangeOnGrid=(xc,ad={})=>Object(sa.a)(this,void 0,void 0,function*(){this.selectRange(xc,ad)});this.openCustomNumberFormat=
()=>Object(sa.a)(this,void 0,void 0,function*(){return new Promise(xc=>{b(this.$,ad=>{xc(ad);J.ULS.sendTraceTag(520942165,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${ad?"OK":"Cancel"}"`)})})});this.openFeedback=xc=>Object(sa.a)(this,void 0,void 0,function*(){d(this.$,xc)});this.sendOtelEvent=xc=>Object(sa.a)(this,void 0,void 0,function*(){f(xc)});this.formatRanges=(xc=[])=>Object(sa.a)(this,void 0,void 0,function*(){return xc.map(ad=>Ca(ad,!1).jz(!1))});this.formatValues=xc=>Object(sa.a)(this,
void 0,void 0,function*(){return xc.map(ad=>u(this.ug,ad.format,ad.value))});this.containsHiddenCells=xc=>l(this.$,xc)}get grid(){return ob.g(this.$)}oz(sb,$b){const xc=this.grid.ob;xc.Tg(Yc,!1,!0);xc.wi(null,Yc,!1);if(null===sb||void 0===sb?0:sb.length){const ad=xb.a.Y6(ab.d(this.$.oa),sb.map(Dd=>Ca(Dd,!1)));xc.yv(ad,Yc,!0,void 0,!1);$b&&this.IAi(sb)}xc.update(!1)}IAi(sb){if(null===sb||void 0===sb?0:sb.length){const $b=this.grid;[sb]=sb.sort((xc,ad)=>xc.top<ad.top?-1:xc.top>ad.top?1:0);sb=ba.Range.Tc(sb.top,
sb.left);$b.kK(sb)||(J.ULS.sendTraceTag(520660942,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),$b.Sr(sb,0,ub.a.dataCleansing))}else J.ULS.sendTraceTag(520660941,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}selectRange(sb,$b){const xc=this.grid;if(null===$b||void 0===$b?0:$b.n0a){$b=Ca($b.n0a,!1);const ad=xc.ha.sa.selectedRanges;if(1<ad.length){J.ULS.sendTraceTag(520660940,0,50,"HostAppCallbacks.selectRange: skipped - more than one range is currently selected");
return}if(!$b.equals(ad[0])){J.ULS.sendTraceTag(520660939,0,50,"HostAppCallbacks.selectRange: skipped - selected range is not equal to the range in the filter");return}}J.ULS.sendTraceTag(520660938,0,50,"HostAppCallbacks.selectRange: selecting range");sb=Ca(sb,!1);$b=Object(pa.v)(sb,this.$);xc.vg($b,sb.topLeft,void 0,null,0,ub.a.dataCleansing,void 0,void 0,void 0,void 0,!0)}}Object(y.a)(md,"HostAppCallbacks",null,[652]);class id{constructor(sb){this.$=sb;this.applySuggestion=($b,xc=[])=>Object(sa.a)(this,
void 0,void 0,function*(){const ad=xc.map(Dd=>Ca(Dd,!1));return m(this.$,$b,ad)});this.refreshAnnotations=()=>{throw Error("Method not implemented.");};this.onPaneLifecycleEvent=$b=>Object(sa.a)(this,void 0,void 0,function*(){e($b)})}}Object(y.a)(id,"DataCleansingCallbacks",null,[585]);class xd{constructor(){this.annotations=[];this.hostState=new Lc;this.worksheetState=new Pb}}Object(y.a)(xd,"DataCleansingHostState",null,[]);class Lc{constructor(){this.isInCoauthoring=this.isInViewMode=this.isInErrorState=
!1}}Object(y.a)(Lc,"HostState",null,[583]);class Pb{constructor(){this.isProtected=this.isInNamedSheetView=!1}}Object(y.a)(Pb,"WorksheetState",null,[584]);class Gc extends R.a{constructor(sb,$b,xc){super();this.$=sb;this.HUc=$b;this.hNa=new xd;this.JBf=()=>{this.stateChanged()};this.Eh=(ad,Dd)=>{this.Yag(Dd.uD);this.q6f(Dd.oa);this.stateChanged()};this.$Q=()=>{this.stateChanged()};this.xB=()=>{this.stateChanged()};this.WQ=()=>{this.stateChanged()};this.vEb=()=>{J.ULS.sendTraceTag(512492932,0,50,"DataCleansingHostManager.onUnrecoverableErrorOccurred: Received AL permanent session close.")};
this.D5=(ad,Dd)=>{ab.m(Dd.item)&&Dd.item.ii!==this.hNa.worksheetState.isProtected&&(J.ULS.sendTraceTag(512492931,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Dd.item.ii}.`),this.stateChanged())};this.callbacks=new id(this.$);this.TIg=new md(this.$,xc);$b.pGg(this.JBf);$b.FGg(this.vEb);$b.BWb();sb.Gn.Pf(this.Eh);sb.ea.V8(this.xB);sb.ea.CX(this.WQ);this.q6f(this.$.oa)}xmb(sb){this.addHandler(Gc.CSd,sb)}lrc(sb){this.removeHandler(Gc.CSd,sb)}dispose(){this.HUc.ccj(this.JBf);
this.HUc.pcj(this.vEb);this.$.Gn.Ag(this.Eh);this.$.ea.j6(this.xB);this.$.ea.x_(this.WQ);this.Yag(this.$.oa);super.dispose()}get state(){const sb=ab.d(this.$.oa);this.hNa.annotations=this.HUc.k0f(sb);ab.m(this.$.oa)&&(this.hNa.worksheetState.isInNamedSheetView=this.$.oa.Fd.mv,this.hNa.worksheetState.isProtected=this.$.oa.ii);this.hNa.hostState.isInViewMode=!this.$.ea.isEditMode;this.hNa.hostState.isInCoauthoring=this.isInCoauthoring();return this.hNa}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(Gc.CSd,
this.state)}q6f(sb){ab.m(sb)&&(sb.Fd.bra(this.$Q),sb.UXa(this.D5))}Yag(sb){ab.m(sb)&&(sb.Fd.xPa(this.$Q),sb.krc(this.D5))}}Gc.CSd="scek";Object(y.a)(Gc,"DataCleansingHostManager",R.a,[]);class Nb extends R.a{constructor(sb){super();this.$=sb;this.o_a=new Map;this.j0f=new Map;this.I8a=()=>{J.ULS.sendTraceTag(520987272,0,50,"DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close.");this.raiseEvent(Nb.xWd)};this.mDb=($b,xc)=>{this.o_a.has(xc.worksheetId)?
this.o_a.get(xc.worksheetId).set(xc.id,xc):this.o_a.set(xc.worksheetId,new Map([[xc.id,xc]]));this.GUc(xc.worksheetId)};this.$Cb=($b,xc)=>{this.o_a.has(xc.worksheetId)&&(this.o_a.get(xc.worksheetId).delete(xc.id),this.GUc(xc.worksheetId))};this.ZCb=($b,xc)=>{this.j0f.set(xc.worksheetId,xc);this.GUc(xc.worksheetId)}}pGg(sb){this.addHandler(Nb.WOd,sb)}ccj(sb){this.removeHandler(Nb.WOd,sb)}FGg(sb){this.addHandler(Nb.xWd,sb)}pcj(sb){this.removeHandler(Nb.xWd,sb)}dispose(){this.$z&&(this.$z.SOf(this.mDb),
this.$z.HOf(this.$Cb),this.$z.GOf(this.ZCb),this.$z.dispose());super.dispose()}BWb(){Object(sa.a)(this,void 0,void 0,function*(){const sb=yield H.GetServiceTaskFactory.Qia(this.$.da,328,327,1);sb?(this.$z=new Ya(sb),sb.fXb(this.I8a),this.$z.zle(this.mDb),this.$z.ule(this.$Cb),this.$z.sle(this.ZCb),this.$z.BWb(),J.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):J.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}k0f(sb){var $b,
xc;const ad=Array.from(null!==(xc=null===($b=this.o_a.get(sb))||void 0===$b?void 0:$b.values())&&void 0!==xc?xc:[]);return[this.j0f.get(sb),...ad].filter(Boolean)}GUc(sb){sb={sheetId:sb,annotations:this.k0f(sb)};this.raiseEvent(Nb.WOd,sb)}}Nb.WOd="sacek";Nb.xWd="ueoek";Object(y.a)(Nb,"DataCleansingAnnotationsManager",R.a,[]);var yc=a(695);class Tc extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}create(){K.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?this.yCe().then(sb=>
{const $b=Object(yc.a)(this.$.da,494,()=>{const xc=new Nb(this.$);return new Gc(this.$,xc,sb)});this.qb($b)},()=>{J.ULS.sendTraceTag(512508561,0,10,"DataCleansingHostManagerFactory.Create: failed to create formatCellsAction")}):this.mSh().then(sb=>{this.qb(sb)},()=>{J.ULS.sendTraceTag(512508560,0,10,"DataCleansingHostManagerFactory.Create: failed to create DataCleansingHostManager")})}yCe(){return V.d(H.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.ib))}mSh(){return Object(sa.a)(this,void 0,
void 0,function*(){var sb=this.$.da.za(494);sb?J.ULS.sendTraceTag(522314576,0,50,"DataCleansingHostManagerFactory.Create: DataCleansingHostManager already exists"):(sb=new Nb(this.$),sb=new Gc(this.$,sb,yield this.yCe()),J.ULS.sendTraceTag(522314575,0,50,"DataCleansingHostManagerFactory.Create: DataCleansingHostManager created successfully"));return sb})}static ka(sb){sb.da.Ga(495,new Tc(sb))}}Object(y.a)(Tc,"DataCleansingHostManagerFactory",Da.a,[]);var gd=a(131),Ad=a(152),Od=a(132),Pd;(function(sb){sb[sb.success=
0]="success";sb[sb.featureDisabled=1]="featureDisabled";sb[sb.rangeNotInGrid=2]="rangeNotInGrid";sb[sb.emptyRange=3]="emptyRange";sb[sb.rangeTooLarge=4]="rangeTooLarge";sb[sb.successWithMergedCells=5]="successWithMergedCells"})(Pd||(Pd={}));Object(y.b)("ResultCode",Pd);var Md=a(58),ge=a(161),pe=a(22),Qd=a(184),he;(function(sb){sb.FormatAsTable="FormatAsTable";sb.ExplicitClose="ExplicitClose";sb.ESC="Dismiss";sb.CommandExecution="CommandExecution";sb.Undo="Undo";sb.SelectionEnd="SelectionEnd"})(he||
(he={}));Object(y.b)("IgnoreSource",he);class ue{constructor(sb,$b,xc){this.NAd=()=>{var ad=new Ra.a(-859308420,wa.a.Eb,this.$.Mc,9,null);this.$.Ka.Lb(ad,{[wa.a.Zf]:"HelpID=22118",["InputMethod"]:wa.a.Eb,["ShouldCanvasTakeFocus"]:!0,[wa.a.Oc]:ma.a.pQ,[ma.a.yda]:!0});ad=this.dataFields;ad.suggestionType="table";Od.b(this.$).Cd(gd.a.a4f,ad,{},!0)};this.h1c=()=>{const ad=pa.v(this.Elb.vna,this.$);var Dd=pa.D(ad);this.p6a(Dd)||this.grid.ha.Qw([Dd],0,Dd.topLeft,0);J.ULS.sendTraceTag(522806800,0,50,this.ah("convertToTable",
"Create table initiated"));Dd={};Dd.TableRange=ad;Dd.HasHeader=!0;this.$.xd(71074531,wa.a.Eb,9,Dd).continueWith(ie=>{Ad.b(ie)&&ie.result?(J.ULS.sendTraceTag(522806799,0,50,this.ah("convertToTable","Create table complete")),Od.b(this.$).Cd(gd.a.$3f,this.dataFields,{},!0),this.Maa()?ge.a(this.$).Xl.activateRibbonTab(ma.a.Pya):this.grid.PXa(this.SKb)):J.ULS.sendTraceTag(522806798,0,10,this.ah("convertToTable","Create table failed"));this.Mid(he.FormatAsTable);this.bBb()})};this.onClose=()=>{this.Mid(he.ExplicitClose);
this.bBb()};this.onDismiss=ad=>{(ad=ad?new Sys.UI.DomEvent(ad):null)&&"keydown"===ad.type&&27===ad.keyCode&&this.Mid(he.ESC);J.ULS.sendTraceTag(522806797,0,100,this.ah("onDismiss","OnDismiss called for Table Invitation"))};this.SKb=()=>{this.Maa()&&(ge.a(this.$).Xl.activateRibbonTab(ma.a.Pya),this.grid.Dab(this.SKb))};this.bBb=()=>{nb.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(ad=>{ad.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",null)})};this.$=sb;this.Mid=xc;this.proactiveSuggestionCard=
$b;this.dataFields={["Class"]:"TableSuggestionCardUtil",["LaunchSource"]:"Default"};this.grid=ob.g(this.$);this.isVisible=!1}mwc(sb,$b){this.dataFields.LaunchSource=$b;this.Elb=sb;$b=[{key:"learnMessage",text:S.a.instance.Xa(706),onClick:this.NAd}];(this.isVisible=this.proactiveSuggestionCard.show(sb.vna,S.a.instance.Xa(700),S.a.instance.Xa(701),S.a.instance.Xa(702),S.a.instance.Xa(703),this.h1c,this.onClose,$b,()=>{this.u5(!0)},()=>{this.u5(!1)},"TableDesignIdeas",K.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?
13:void 0,K.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?11:void 0,5,void 0,this.onDismiss,void 0,!0))?(Od.b(this.$).Cd(gd.a.b4f,this.dataFields,{},!0),J.ULS.sendTraceTag(522806802,0,50,this.ah("showTableSuggestionCard","Proactive suggestion card displayed"))):J.ULS.sendTraceTag(522806801,0,15,this.ah("showTableSuggestionCard","Proactive suggestion card failed to show"))}get visible(){return this.isVisible}hide(){this.proactiveSuggestionCard.hide();this.isVisible=!1}dispose(){this.proactiveSuggestionCard&&
this.proactiveSuggestionCard.dispose()}u5(sb){sb?(sb=[],sb.push(this.Elb.vna),sb=xb.a.Y6(ab.d(this.$.oa),sb),this.grid.ob.yv(sb,[0],!0)):this.grid.ob.aza()}Maa(){return this.grid.Ea.lK(4,this.$.oa)}ah(sb,$b,xc){let ad=Object.assign({},this.dataFields);ad.Method=sb;ad.Message=$b;xc&&(ad.Fields=xc);return Md.a.Ac(ad)}p6a(sb){return sb.Ed(this.grid.ha.sa.activeRange)}}Object(y.a)(ue,"TableSuggestionCardUtil",null,[]);class je{constructor(sb,$b,xc,ad){this.myi=3;this.R3=Dd=>{this.l8e.add(this.JWb.nE);
K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&("FormatAsTable"===Dd?this.sma.gfj():this.sma.F7h());this.rdb.visible&&this.rdb.hide()};this.zg=()=>{this.rdb.visible&&null!=this.JWb&&!this.p6a(this.JWb.nE)&&this.R3("SelectionEnd")};this.XQ=(Dd,ie)=>{1928326585!=ie.Jd.command&&1833782813!=ie.Jd.command&&(this.R3("CommandExecution"),this.$.Ka.dza(this.XQ))};this.$=sb;this.JWb=null;this.tableIntelligenceManager=$b;this.l8e=new Qd.a;this.dataFields=
{["Class"]:"IntelligentMetadataTableManager",["LaunchSource"]:"Default"};this.grid=ob.g(this.$);this.Elb=null;this.H8i();this.proactiveSuggestionCard=xc;this.rdb=new ue(this.$,this.proactiveSuggestionCard,this.R3);this.QGj=.75;this.sma=ad}xLj(sb,$b){var xc;return Object(sa.a)(this,void 0,void 0,function*(){if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1))if(dc.AFrameworkApplication.zF("XLS-SmartView-EnableRoamingServiceIntegration-Treatment;XLS-SmartView-EnableRoamingServiceIntegration-Control"),
K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&(yield this.sma.qPh())>=this.myi)J.ULS.sendTraceTag(520135585,306,50,this.ah("triggerHandRaise","Exceeded maximum intelligent metadata dismiss count."));else{var ad=this.tableIntelligenceManager.J3a().hac(sb,6);for(let Dd of this.l8e)if(Dd.sheetId===sb.sheetId&&Dd.range.Ed(sb.range))return;1<=ad.length&&this.u7h(null===(xc=ad[0])||void 0===xc?void 0:xc.table)&&(this.rdb.mwc(this.Elb,$b),this.$.Ka.WEa(this.XQ))}else J.ULS.sendTraceTag(522740425,
0,50,this.ah("triggerIntelligentMetadataTableHandRaise","Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions is disabled"))})}H8i(){this.grid.ha.cT(this.zg)}u7h(sb){for(let $b of sb.interpretations)if($b.confidence>=this.QGj&&2===$b.orientation&&1===$b.headerRowCount&&!sb.tableName)return this.Elb=$b,this.JWb=sb,!0;return!1}ah(sb,$b,xc){let ad=Object.assign({},this.dataFields);ad.Method=sb;ad.Message=$b;xc&&(ad.Fields=xc);return Md.a.Ac(ad)}p6a(sb){return sb.range.contains(this.grid.ha.sa.activeRange)}}
Object(y.a)(je,"IntelligentMetadataTableManager",null,[]);var Ge=a(510),Ce=a(281),pc=a(215),Uc=a(121);const hd={version:1,mlc:0,odc:0};class yd{constructor(sb){this.H7h=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.mlc++,this.AAc())};this.F7h=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.odc++,this.AAc())};this.ifj=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.mlc=0,this.AAc())};this.gfj=()=>{this.smartViewTableHandRaiseSetting&&
(this.smartViewTableHandRaiseSetting.odc=0,this.AAc())};this.LSf=()=>{J.ULS.sendTraceTag(521007203,0,50,this.ah("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Reading latest roaming setting."));return new Promise($b=>{ta.v(this.$.pa.va,2,xc=>{J.ULS.sendTraceTag(521007198,0,50,this.ah("retrieveSmartViewTableHandRaiseSettingFromRoamingService","OnReadRoamingStringSuccess called."));if(eb.a.rg(xc.Errors))xc={["errors"]:eb.a.zc(xc.Errors)},J.ULS.sendTraceTag(521007197,0,10,this.ah("retrieveSmartViewTableHandRaiseSettingFromRoamingService",
"onReadRoamingSuccessCallback encountered an error.",xc)),$b(null);else if(xc.Result){if(xc=this.ddh(xc.Result))J.ULS.sendTraceTag(521007196,0,50,this.ah("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Successfully retrieved smartViewTableHandRaiseSetting.",{["version"]:xc.version})),1>xc.version?$b(hd):$b(xc)}else $b(null)},xc=>{xc={["EwaErrors"]:Uc.a.kf(xc.data)};J.ULS.sendTraceTag(520135584,0,10,this.ah("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Roaming operation failed.",
xc));$b(null)},null,null)})};this.AAc=()=>{const $b=this.Smj(this.smartViewTableHandRaiseSetting);$b?(J.ULS.sendTraceTag(521007199,0,50,this.ah("updateSmartViewTableHandRaiseSettingFromRoamingService","Updating roaming setting.")),ta.B(this.$.pa.va,2,$b,xc=>{J.ULS.sendTraceTag(521007189,0,50,this.ah("onWriteRoamingStringSuccess","OnWriteRoamingStringSuccess called."));eb.a.rg(xc.Errors)?(xc={["errors"]:eb.a.zc(xc.Errors)},J.ULS.sendTraceTag(521007188,0,10,this.ah("onWriteRoamingStringSuccess","onWriteRoamingStringSuccess encountered an error.",
xc))):xc.Result&&(xc.Result||J.ULS.sendTraceTag(521007187,0,15,this.ah("onWriteRoamingStringSuccess","Failed to write to the roaming service.")))},xc=>{xc={["EwaErrors"]:Uc.a.kf(xc.data)};J.ULS.sendTraceTag(520135583,0,10,this.ah("updateSmartViewTableHandRaiseSettingFromRoamingService","Roaming operation failed.",xc))},null,null)):J.ULS.sendTraceTag(521007200,0,15,this.ah("updateSmartViewTableHandRaiseSettingFromRoamingService","Empty serialized roaming setting."))};this.ddh=$b=>{if(!$b)return J.ULS.sendTraceTag(521007195,
0,15,this.ah("deserializeToSmartViewTableHandRaiseSetting","Received an empty roamingXml.")),null;let xc;try{xc=Md.a.Uh($b)}catch(ad){return J.ULS.sendTraceTag(521007192,0,10,this.ah("deserializeToSmartViewTableHandRaiseSetting","Error while deserializing SmartViewTableHandRaiseSetting.",{["errorMessage"]:ad.message})),null}return xc};this.Smj=$b=>{if(!$b)return J.ULS.sendTraceTag(521007191,0,50,this.ah("updateSmartViewTableHandRaiseSettingFromRoamingService","Empty roaming setting.")),null;$b=Md.a.Ac($b);
return 200<$b.length?(J.ULS.sendTraceTag(521007190,0,10,"serializeFromSmartViewTableHandRaiseSetting - Exceeded the MaxSize for smartViewTableHandRaiseSettingMaxSize."),null):$b};this.ah=($b,xc,ad)=>{let Dd=Object.assign({},this.dataFields);Dd.Method=$b;Dd.Message=xc;ad&&(Dd.Fields=ad);return Md.a.Ac(Dd)};this.$=sb;this.dataFields={["Class"]:"SmartViewTableHandRaiseRoamingHandler"};this.smartViewTableHandRaiseSetting=null}dSh(){return Object(sa.a)(this,void 0,void 0,function*(){if(this.smartViewTableHandRaiseSetting)return this.smartViewTableHandRaiseSetting.mlc;
const sb=yield this.LSf();return sb?(this.smartViewTableHandRaiseSetting=sb,this.smartViewTableHandRaiseSetting.mlc):Number.POSITIVE_INFINITY})}qPh(){return Object(sa.a)(this,void 0,void 0,function*(){if(this.smartViewTableHandRaiseSetting)return this.smartViewTableHandRaiseSetting.odc;const sb=yield this.LSf();return sb?(this.smartViewTableHandRaiseSetting=sb,this.smartViewTableHandRaiseSetting.odc):Number.POSITIVE_INFINITY})}}Object(y.a)(yd,"SmartViewTableHandRaiseRoamingHandler",null,[]);class wd{constructor(sb,
$b,xc){this.g9=this.DMa=null;this.qkd=this.EMa=!1;this.rAa=this.R8a=null;this.Syb=this.jeg=!1;this.xyi=3;this.k3h=(ad,Dd)=>{J.ULS.sendTraceTag(527983895,306,50,this.ah("handleSmartViewActivationCallback","handleSmartViewActivationCallback invoked."));if(!Dd)return J.ULS.sendTraceTag(527983894,306,10,this.ah("handleSmartViewActivationCallback","surveyParams is null.")),null;if(!Dd.contextInfo||0==Dd.contextInfo.length)return J.ULS.sendTraceTag(527983893,306,10,this.ah("handleSmartViewActivationCallback",
"no valid contextInfo in surveyParams.",{["contextInfo"]:Dd.contextInfo})),null;this.e_e(Dd.contextInfo[Dd.contextInfo.length-1].context);return null};this.VCf=()=>{this.R3("Undo");this.$.ea.VPf(this.VCf)};this.zg=()=>{this.proactiveSuggestionCard.isVisible&&null!=this.Rxa&&!this.p6a(this.Rxa.nE.range)?this.R3("SelectionEnd"):this.Syb||this.xXd()};this.mwc=ad=>{const Dd=[{key:"learnMessage",text:S.a.instance.Xa(706),onClick:this.NAd}];this.proactiveSuggestionCard.show(ad,S.a.instance.Xa(700),S.a.instance.Xa(701),
S.a.instance.Xa(702),S.a.instance.Xa(703),this.h1c,this.onClose,Dd,()=>{this.u5(!0)},()=>{this.u5(!1)},"TableDesignIdeas",K.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?13:void 0,K.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?11:void 0,5,void 0,this.onDismiss,void 0,!0);this.proactiveSuggestionCard.isVisible?(Od.b(this.$).Cd(gd.a.b4f,this.dataFields,{},!0),J.ULS.sendTraceTag(523622039,0,50,this.ah("showTableSuggestionCard","Proactive suggestion card displayed"))):
J.ULS.sendTraceTag(523530261,0,15,this.ah("showTableSuggestionCard","Proactive suggestion card failed to show"))};this.NAd=()=>{var ad=new Ra.a(-859308420,wa.a.Eb,this.$.Mc,9,null);this.$.Ka.Lb(ad,{[wa.a.Zf]:"HelpID=22118",["InputMethod"]:wa.a.Eb,["ShouldCanvasTakeFocus"]:!0,[wa.a.Oc]:ma.a.pQ,[ma.a.yda]:!0});ad=Object.assign({},this.dataFields);ad.suggestionType="table";Od.b(this.$).Cd(gd.a.a4f,ad,{},!0)};this.R3=ad=>{this.k8e=this.Rxa.nE;this.xXd();this.Ipj();this.$.Ka.dza(this.XQ);this.grid.ha.qR(this.zg);
K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&("FormatAsTable"===ad?this.sma.ifj():this.sma.H7h());"ExplicitClose"===ad&&Od.b(this.$).Cd(gd.a.rCj,this.dataFields,{},!0);J.ULS.sendTraceTag(526165469,0,50,this.ah("ignoreActiveRange","Ignore Current Range",{["ignoreSource"]:ad}))};this.bBb=()=>{nb.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(ad=>{ad.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",null)})};this.h1c=
()=>{const ad=pa.v(this.rfb.vna,this.$);J.ULS.sendTraceTag(537155670,0,50,this.ah("convertToTable","Create table initiated"));const Dd={};Dd.TableRange=ad;Dd.HasHeader=!0;this.$.xd(71074531,wa.a.Eb,9,Dd).continueWith(ie=>{Ad.b(ie)&&ie.result?(J.ULS.sendTraceTag(537155669,0,50,this.ah("convertToTable","Create table complete")),Od.b(this.$).Cd(gd.a.$3f,this.dataFields,{},!0),this.Maa()?ge.a(this.$).Xl.activateRibbonTab(ma.a.Pya):this.grid.PXa(this.SKb)):J.ULS.sendTraceTag(537155668,0,10,this.ah("convertToTable",
"Create table failed"));this.R3("FormatAsTable");this.bBb()})};this.onClose=()=>{this.R3("ExplicitClose");this.bBb()};this.onDismiss=ad=>{(ad=ad?new Sys.UI.DomEvent(ad):null)&&"keydown"===ad.type&&27===ad.keyCode&&this.R3("Dismiss");J.ULS.sendTraceTag(526260301,0,100,this.ah("onDismiss","OnDismiss called for Table Invitation"))};this.XQ=(ad,Dd)=>{ad=Dd.properties;ad.SourceControlId&&!ad.ShouldCanvasTakeFocus&&ad.SourceControlId.includes("Sensitivity")||this.Fgh(Dd.Jd.command)&&this.R3("CommandExecution")};
this.Ipj=()=>{const ad=this.grid.ha.sa.activeRange;this.grid.ha.updateSelection(ad,ad,0,0)};this.Txa=()=>{this.Maa()&&(this.getMetadata(this.k3c),this.k3c=null,this.grid.Dab(this.Txa))};this.SKb=()=>{this.Maa()&&(ge.a(this.$).Xl.activateRibbonTab(ma.a.Pya),this.grid.Dab(this.SKb))};this.$=sb;this.tableIntelligenceManager=$b;this.k8e=this.rfb=this.Rxa=null;this.dataFields={["Class"]:"IntelligentMetadataOverlayManager",["LaunchSource"]:"Default"};this.k3c=null;this.proactiveSuggestionCard=xc;this.grid=
ob.g(this.$);this.rdb=new ue(this.$,this.proactiveSuggestionCard,this.R3);this.sma=new yd(this.$);nb.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ad=>{this.g9=ad;ad.isFeatureEnabled("SmartViewTableHandRaise",!1).then(Dd=>this.EMa=Dd);ad.isFeatureEnabled("SmartViewIntelligentMetadataTableHandRaise",!1).then(Dd=>{this.qkd=Dd;K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&Dd&&!this.lxb&&(this.lxb=
new je(this.$,this.tableIntelligenceManager,this.proactiveSuggestionCard,this.sma));return Dd});this.DMa=ad.Yla("SmartViewTableHandRaise",Dd=>{this.EMa=Dd.isEnabled});ad.Yla("SmartViewIntelligentMetadataTableHandRaise",Dd=>{this.qkd=Dd.isEnabled;K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.qkd&&!this.lxb&&(this.lxb=new je(this.$,this.tableIntelligenceManager,this.proactiveSuggestionCard,this.sma))})});this.jeg=["en-US","en-GB",
"en-CA","en-AU","en_IN"].includes(this.$.feb);(sb=nb.a.instance.Vb("Common.ISystemInitiatedFeedback"))&&sb.execute(ad=>{ad.$pc("SmartViewSuggestion",this.k3h)});this.$.Hb&&(this.R8a=this.$.Hb.Ng("WebServiceCall","onDemandStopWatch"),this.rAa=this.$.Hb.Ng("WebServiceCall","getTableInfoStopwatch"))}get Uie(){return this.rfb}QRj(sb){this.Rxa=null;sb.tableName||(this.Rxa=sb);sb={["Duration"]:-1};this.R8a&&(this.R8a.stop(),sb.Duration=this.R8a.tc);J.ULS.sendTraceTag(523622040,0,50,this.ah("updateOnDemandRecognizedTable",
"OnDemand request succeeded",sb));this.xXd();this.$.ea.ane(this.VCf)}b7(sb,$b){return Object(sa.a)(this,void 0,void 0,function*(){this.dataFields.LaunchSource=$b;sb||J.ULS.sendTraceTag(523530262,306,10,this.ah("triggerHandRaise","sheetRange is null or undefined"));if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSmartViewLicenseCheck",!1)||this.EMa)if(this.jeg)if(this.$.ya.IsMeetingLiveSession)J.ULS.sendTraceTag(520901637,306,50,this.ah("triggerHandRaise","User is in Teams live."));
else if(pc.a.xLa()||pc.a.fwa())J.ULS.sendTraceTag(520901636,306,50,this.ah("triggerHandRaise","User is in Excel hosted in Teams."));else if(dc.AFrameworkApplication.zF("XLS-SmartView-EnableRoamingServiceIntegration-Treatment;XLS-SmartView-EnableRoamingServiceIntegration-Control"),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&(yield this.sma.dSh())>=this.xyi)J.ULS.sendTraceTag(520135586,306,50,this.ah("triggerHandRaise","Exceeded maximum on demand dismiss count."));
else{dc.AFrameworkApplication.zF("XLS-SmartView-GetTableInfo-Treatment;XLS-SmartView-GetTableInfo-Control");if(!this.pmi(sb)){J.ULS.sendTraceTag(527229345,306,50,this.ah("triggerHandRaise","Surrounding Cells contain values, update boundary required"));if(!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.GetTableInfo",!1))return;const xc=yield this.Dkd(sb);if(!xc){J.ULS.sendTraceTag(522823200,306,50,this.ah("triggerHandRaise","Expanded Range is null or undefined"));return}sb=xc}this.Y0g(sb)?
J.ULS.sendTraceTag(520642720,306,50,this.ah("triggerHandRaise","Header contains links or formulas.")):(dc.AFrameworkApplication.zF("XLS-SmartView-SelectionNotInRange-Control;XLS-SmartView-SelectionNotInRange-Treatment"),this.Aff(sb.range)?this.qwa(sb.range)?J.ULS.sendTraceTag(523117070,306,50,this.ah("triggerHandRaise","Specified range is empty")):K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DisableLPP",!1)||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteSmartViewTestOnly",
!1)?(J.ULS.sendTraceTag(522831705,306,50,this.ah("triggerHandRaise","LPP Disabled, requesting OnDemandMetadata")),this.e_e(sb)):this.qvi(sb):J.ULS.sendTraceTag(526260302,0,50,this.ah("triggerHandRaise","User selection out of range, OOUI hid")))}else J.ULS.sendTraceTag(523544584,306,50,this.ah("triggerHandRaise","Invalid language for TriggerHandRaise."));else J.ULS.sendTraceTag(527958875,306,50,this.ah("triggerHandRaise","License is not enabled."))})}GVd(sb,$b){return Object(sa.a)(this,void 0,void 0,
function*(){this.lxb&&void this.lxb.xLj(sb,$b)})}qvi(sb){const $b=nb.a.instance.Vb("Common.ISystemInitiatedFeedback");$b&&(J.ULS.sendTraceTag(527983892,306,50,this.ah("logSmartViewEventToLpp","logged event to LPP")),$b.execute(xc=>{xc.logActivity("SmartViewProactiveSuggestionActivity",null,sb)}))}e_e(sb){this.Syb||this.grid.ha.cT(this.zg);this.Maa()?this.getMetadata(sb):(this.k3c=sb,this.grid.PXa(this.Txa))}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}xXd(){if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",
!1)&&null!=this.Rxa){var sb=this.Rxa.nE;if(this.k8e!==sb&&sb.sheetId===this.$.xa.oa.sheetId&&this.Aff(sb.range)){sb=.5;let xc=null;this.Syb=!1;for(var $b of this.Rxa.interpretations)$b.confidence>=sb&&2==$b.orientation&&(sb=$b.confidence,xc=$b);xc?1!==xc.headerRowCount||xc.headerColumnCount?(this.grid.ha.qR(this.zg),this.Syb=!0,J.ULS.sendTraceTag(527218011,0,50,this.ah("updateOnDemandActionButton","The recognition cannot be converted to a table"))):this.rfb==xc&&this.proactiveSuggestionCard.isVisible||
(this.rfb=xc,$b=this.dataFields.LaunchSource,K.EwaSettings.isChangeGateEnabled("OfficeVSO:6648444_UseTableSuggestionCardUtil")?this.rdb.mwc(this.Uie,$b):this.mwc(this.Uie.vna),this.$.Ka.WEa(this.XQ)):(this.grid.ha.qR(this.zg),this.Syb=!0,J.ULS.sendTraceTag(527958874,0,50,this.ah("updateOnDemandActionButton","The recognition contained no interpretations")))}else this.proactiveSuggestionCard.isVisible&&this.proactiveSuggestionCard.hide()}}u5(sb){sb?(sb=[],sb.push(this.rfb.vna),sb=xb.a.Y6(ab.d(this.$.oa),
sb),this.grid.ob.yv(sb,[0],!0)):this.grid.ob.aza()}Fgh(sb){return![1928326585,1833782813,-1059615499,-1027730316,-1104934572,-28797232,71074531].includes(sb)}Y0g(sb){sb=new ba.Range(sb.range.top,sb.range.left,sb.range.top,sb.range.right,!0,!1);for(sb=ob.g(this.$).kk("IntelligenceMetadataOverlay.containsFormulasInHeader",sb,1);sb.$$mn();)if(sb.$$cu().fF)return!0;return!1}getMetadata(sb){this.R8a.start();sb=this.tableIntelligenceManager.RQh(sb,this.QRj.bind(this));J.ULS.sendTraceTag(523622038,0,50,
this.ah("getMetadata","OnDemand metadata requested"));sb&&(J.ULS.sendTraceTag(536953376,0,50,this.ah("getMetadata","getMetadataForRange unsuccessful",{["resultCode"]:Pd[sb]})),this.R8a.stop())}Maa(){return this.grid.Ea.lK(4,this.$.oa)}pmi(sb){sb=new ba.Range(1<sb.range.top-1?sb.range.top-1:1,1<sb.range.left-1?sb.range.left-1:1,sb.range.bottom+1,sb.range.right+1,!0,!1);const $b=1==sb.top,xc=1==sb.left,ad=ob.g(this.$).kk("IntelligenceMetadataOverlay",sb,1);for(;ad.$$mn();){const Dd=ad.$$cu();if((Dd.range.top==
sb.top&&!$b||Dd.range.left==sb.left&&!xc||Dd.range.bottom==sb.bottom||Dd.range.right==sb.right)&&0!=Dd.Cy.value.length)return!1}return!0}Aff(sb){return K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.SelectionNotInRange",!1)||this.p6a(sb)}p6a(sb){return sb.Ed(this.grid.ha.sa.activeRange)}qwa(sb){for(sb=ob.g(this.$).kk("IntelligentMetadataOverlayManager.isRangeEmpty",sb,1);sb.$$mn();){const $b=sb.$$cu();if($b&&(0!==$b.Cy.type||!pe.a.yq($b.Cy.value)))return!1}return!0}ah(sb,$b,
xc){let ad=Object.assign({},this.dataFields);ad.Method=sb;ad.Message=$b;xc&&(ad.Fields=xc);return Md.a.Ac(ad)}Dkd(sb){return Object(sa.a)(this,void 0,void 0,function*(){this.rAa||(this.rAa=this.$.Hb.Ng("WebServiceCall","getTableInfoStopwatch"));this.rAa.start();const $b=pa.v(sb.range.topLeft,this.$),xc=this.$.pa.va.Qb(),ad={Duration:-1};return new Promise(Dd=>{var ie=($d,ne,ye)=>Oa.t(this.$.pa.va,$b,Object(Ba.b)($d,te=>{!te||Ce.a(te)?(J.ULS.sendTraceTag(521249761,306,50,this.ah("invokeGetTableInfoAction",
"Result returned with errors")),Dd(null)):(te=pa.D(te.Result.TableRange),this.rAa.stop(),ad.Duration=this.rAa.tc,J.ULS.sendTraceTag(522823199,306,50,this.ah("invokeGetTableInfoAction","GetTableRange Succeeded",ad)),Dd(new xb.a(te,sb.sheetId)))}),Object(Ba.a)(ne,()=>{this.rAa.stop();ad.Duration=this.rAa.tc;J.ULS.sendTraceTag(522823198,306,50,this.ah("invokeGetTableInfoAction","GetTableRange Failed",ad));Dd(null)}),ye,null,xc);ie=K.EwaSettings.fc()?new cc.a(260,0,ie,88):new Ge.a(260,0,ie,24);ie.Pma(()=>
!0);this.$.userOperationManager.Ub(ie,null)})})}}Object(y.a)(wd,"IntelligentMetadataOverlayManager",null,[691,3]);class I extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}create(){const sb=H.GetServiceTaskFactory.Ta(this.$.da,20,404,1),$b=H.GetServiceTaskFactory.Ta(this.$.da,486,487,1);N.TaskExtensions.Aa(N.TaskExtensions.Xd([sb,$b],this.$.la),()=>{const xc=sb.result,ad=$b.result;if(xc&&ad){let Dd=this.$.da.za(426);Dd||(Dd=new wd(this.$,xc,ad),this.$.da.Ga(426,Dd));this.qb(Dd);J.ULS.sendTraceTag(537155667,
0,50,"IntelligentMetadataOverlayManagerFactory.Create: IntelligentMetadataOverlayManager initialized successfully")}else null==xc&&J.ULS.sendTraceTag(537155666,306,10,"IntelligentMetadataOverlayManagerFactory.Create: TableIntelligenceManager instance null."),null==ad&&J.ULS.sendTraceTag(525620054,306,10,"IntelligentMetadataOverlayManagerFactory.Create: ProactiveSuggestionCard instance null."),this.qb(null)},this.$.la,3)}static ka(sb){sb.da.Ga(427,new I(sb))}}Object(y.a)(I,"IntelligentMetadataOverlayManagerFactory",
Da.a,[]);var xa=a(78),Ua=a(453);class vb{constructor(sb,$b){this.text=this.cardViewManager=null;this.$=sb;this.No=$b}T7g(){const sb=this.U7g();Ua.a(this.$,243,242,0,$b=>{this.cardViewManager=$b;$b.a2f(this.No,4,sb)})}v5h(){this.cardViewManager&&this.cardViewManager.sKa(-1,-1,this.No)}U7g(){const sb={};sb.description=this.text;const $b={fieldType:0};$b.display=this.text;sb.fields=[$b];return sb}}Object(y.a)(vb,"PivotTableHandRaiseCardManager",null,[]);var cb=a(708);class Xb extends xa.a{constructor(sb,
$b,xc){super();this.IWb=null;this.isVisible=this.Kid=this.FZ=this.cN=!1;this.f$a=null;this.u5=(ad,Dd)=>{Dd?this.Pcb():this.hcc()};this.onKeyUp=ad=>{const Dd=ad.zs;ad=ad.Ca;switch(ad.keyCode){case 27:return this.cN?(this.hcc(),this.Nca(Dd),!0):!1;case 121:return ad.altKey&&ad.shiftKey?(this.cN?(this.hcc(),this.Nca(Dd)):(this.Pcb(),this.VJb(Dd)),!0):!1;case 17:return this.FZ||this.Kid?!1:(this.Kid=!0,window.setTimeout(()=>{this.Kid=!1},30),this.cN?(this.hcc(),this.Nca(Dd)):(this.Pcb(),this.VJb(Dd)),
!0);default:return!1}};this.onKeyDown=ad=>{ad=ad.Ca;this.FZ=ad.ctrlKey&&17!==ad.keyCode;return 13===ad.keyCode&&this.cN?(this.SDf(),!0):!1};this.$=sb;this.Fp=$b.Y2b(sb,xc,()=>{this.SDf()},"","","","PivotTableHandRaisePointerDown",S.a.instance.ga(1820))}setRange(sb){this.IWb=sb}get mz(){return this.Fp.mz}dispose(){this.Fp.dispose();this.$=null;super.dispose()}Yza(){this.hide();const sb=ob.g(this.$),$b=sb.hb.jj(this.IWb),xc=sb.lg(this.IWb,$b),ad=sb.Lf($b).tn;var Dd=this.$.da.za(271);if((!Dd||!Dd.Ndi())&&
xc&&ad&&0<=xc.x&&0<=xc.y&&ad.width>xc.width+160){Dd=xc.bottomRight.x+this.mz;const ie=xc.bottomRight.y;let $d=!1;Dd+160>ad.bottomRight.x&&(Dd=xc.topLeft.x-this.mz,$d=!0);this.Fp.icg(cb.a.dlj,null,$b);this.Fp.Z5b(this.u5,$b);this.xp(Dd,ie,sb.rtl,$b,$d);K.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")||(this.Fp.domElement($b).title=S.a.instance.Xa(681));this.$.frame.xt.lR(Gb.a.Gd,this.$.domElement,this.onKeyUp,$b);this.$.frame.xt.pt(Gb.a.Mb,this.$.domElement,this.onKeyDown,!0);this.$.da.Za(211,
ne=>{const ye=S.a.instance.ga(1820)+" "+S.a.instance.ga(1742);ne.setEnabled(!0);ne.readText(ye)});this.isVisible=!0}}Pcb(){J.ULS.sendTraceTag(537154657,306,50,"PivotTableHandRaiseLaunchButton:ShowRichToolTip Show tooltip");K.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")&&(this.f$a||(this.f$a=new vb(this.$,this.Fp.domElement(1)),this.f$a.text=S.a.instance.Xa(681)),this.f$a.T7g())}hcc(){this.f$a&&this.f$a.v5h()}hide(){this.isVisible&&(this.Fp.hide(),J.ULS.sendTraceTag(537154656,306,
50,"PivotTableHandRaiseLaunchButton:Hide Dismissing Pivot table hand rasie OOUI."),this.$.frame.xt.Ba(Gb.a.Gd,this.$.domElement,this.onKeyUp),this.$.frame.xt.At(Gb.a.Mb,this.$.domElement,this.onKeyDown,!0),this.isVisible=this.cN=this.FZ=!1)}Nca(sb){this.Fp.getButton(sb).Zab();this.cN=!1}VJb(sb){this.Fp.getButton(sb).tFb();this.cN=!0;this.$.da.Za(211,$b=>{const xc=S.a.instance.Xa(681)+" "+S.a.instance.ga(1821);$b.setEnabled(!0);$b.readText(xc)})}SDf(){J.ULS.sendTraceTag(537154655,306,50,"PivotTableHandRaiseLaunchButton:OpenPane Pivot table hand rasie OOUI clicked.");
const sb={SourceControlId:"PivotTableHandRaise"};sb.StartingRanges=[this.IWb];this.$.xd(2137617149,0,0,sb).continueWith(()=>{this.hide()})}xp(sb,$b,xc,ad,Dd){this.Fp.xp(sb,$b,xc,ad,!1,Dd);J.ULS.sendTraceTag(556615632,306,50,"PivotTableHandRaiseLaunchButton:ShowAt Pivot table hand raise OOUI shown.")}}Object(y.a)(Xb,"PivotTableHandRaiseLaunchButton",xa.a,[]);var rc=a(309);class Ec{constructor(){this.fta=0;this.localStorage=new rc.a;this.fta=this.QLh()}b$b(){return this.fta}HJd(){this.fta=0;this.qUf()}ojd(){this.fta++;
this.qUf()}QLh(){try{if(!this.localStorage.If())return 0;const sb=this.localStorage.getItem("PivotTableHandRaiseDismissCount");return sb?Number.parseLocale(sb):0}catch(sb){return J.ULS.sendTraceTag(522311635,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:getDismissCountFromCache failure"),0}}qUf(){try{this.localStorage.If()&&this.localStorage.setItem("PivotTableHandRaiseDismissCount",this.fta.toString())}catch(sb){J.ULS.sendTraceTag(522311634,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:saveDismissCountToCache failure")}}}
Object(y.a)(Ec,"PivotTableHandRaiseLocalStorageLoaderSaver",null,[]);class ed{constructor(sb){this.version=1;this.DMd=0;this.$=sb}b$b(){return Object(sa.a)(this,void 0,void 0,function*(){this.jTf||(this.jTf=this.RLh());return(yield this.jTf)+this.DMd})}HJd(){this.DMd=0;this.AUf(0)}ojd(){Object(sa.a)(this,void 0,void 0,function*(){this.DMd++;this.AUf(yield this.b$b())})}RLh(){return new Promise(sb=>{ta.v(this.$.pa.va,3,$b=>{eb.a.rg($b.Errors)?(J.ULS.sendTraceTag(520370311,0,10,`readRoamingString encountered an error. Errors: ${eb.a.zc($b.Errors)}`),
sb(Number.POSITIVE_INFINITY)):$b.Result?($b=JSON.parse($b.Result),!$b||null==$b.version||null==$b.fta||$b.version<this.version?sb(0):sb($b.fta)):(J.ULS.sendTraceTag(520370310,0,50,"readRoamingString - Received null"),sb(0))},($b,xc,ad)=>{$b=Uc.a.kf($b.data);J.ULS.sendTraceTag(520370309,0,10,`OnRoamingOperationFailure: Encountered errors for ${ad}. Errors: ${eb.a.zc($b)}.`);sb(Number.POSITIVE_INFINITY)},null,null)})}AUf(sb){sb!==Number.POSITIVE_INFINITY&&(sb=JSON.stringify({version:this.version,fta:sb}),
ta.B(this.$.pa.va,3,sb,$b=>{eb.a.rg($b.Errors)?J.ULS.sendTraceTag(520370308,0,10,`writeRoamingString encountered an error. Errors: ${eb.a.zc($b.Errors)}`):$b.Result||J.ULS.sendTraceTag(520370307,0,10,"writeRoamingString failed to write to roaming service.")},($b,xc,ad)=>{$b=Uc.a.kf($b.data);J.ULS.sendTraceTag(520370306,0,10,`OnRoamingOperationFailure: Encountered errors for ${ad}. Errors: ${eb.a.zc($b)}.`)},null,null))}}Object(y.a)(ed,"PivotTableHandRaiseRoamingHandler",null,[712]);class ud{constructor(sb,
$b,xc,ad,Dd=null){this.kof=K.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseCount",1);this.lof=K.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseDismissCount",20);this.Vh=this.g9=this.DMa=null;this.EMa=!1;this.eoc=this.doc=null;this.s2h=(ie,$d)=>{ie=this.r2h($d);a:{switch(ie){case "InvalidContextInfo":case "SurveyParamsNull":$d="Error";break a;case "Success":$d="Success";break a}$d=void 0}J.ULS.sendTraceTag(521441668,306,50,`PivotTableHandRaiseManager.handlePivotTableActivationCallback Results: ${JSON.stringify({result:ie,
status:$d})}`);return null};this.Uc=(ie,$d)=>{$d&&$d.xgf||(ob.g(this.$).ha.RF(this.Uc),K.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseCardUX",!1)?(J.ULS.sendTraceTag(526984154,306,50,"PivotTableProactiveSuggestion: selection changed, hide hand raise card"),this.Z4c()):this.Vh.hide())};this.$=sb;this.tableIntelligenceManager=$b;this.svgIconProvider=Dd;this.gha=ad;this.q$d=this.X2d=0;K.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||
(this.Vh=new Xb(this.$,ad,Dd));this.proactiveSuggestionCard=xc;nb.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ie=>{this.g9=ie;ie.isFeatureEnabled("ExcelIdeasPivotTableHandRaise",!1).then($d=>this.EMa=$d);this.DMa=ie.Yla("ExcelIdeasPivotTableHandRaise",$d=>{this.EMa=$d.isEnabled})});(sb=nb.a.instance.Vb("Common.ISystemInitiatedFeedback"))&&sb.execute(ie=>{ie.$pc("PivotTableHandRaiseSurface",this.s2h)});K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",
!1)&&(this.eoc=new ed(this.$));K.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&(this.doc=new Ec)}get d3c(){return this.X2d}get cmf(){return this.q$d}b7(sb){return Object(sa.a)(this,void 0,void 0,function*(){var $b;K.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")&&($b=Date.now());const xc=yield this.sLj(sb);a:{switch(xc){case "Success":case "SuccessWithLppDisabled":var ad="Success";break a;case "DismissCountAboveLimit":case "ExpandedRangeNull":case "IncorrectLicense":case "LppAndTableMetadataDisabled":case "NotInEditMode":case "NotPivotable":case "NoTableMetadata":case "RangeTooLarge":case "TriggerCountAboveMax":ad=
"Aborted";break a;case "ActiveRangeNull":case "ExpandRangeFailed":case "SystemInitiatedFeedbackNull":ad="Error";break a}ad=void 0}$b={result:xc,status:ad,duration:K.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")?Date.now()-$b:void 0};J.ULS.sendTraceTag(521441669,306,50,`PivotTableHandRaiseManager.triggerHandRaise Results: ${JSON.stringify($b)}`)})}sLj(sb){return Object(sa.a)(this,void 0,void 0,function*(){K.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&
Od.b(this.$).Cd(gd.a.oXi,{},void 0,!0);if(!this.EMa)return J.ULS.sendTraceTag(537154654,306,50,"PivotTableHandRaiseManager:TriggerHandRaise License is not enabled."),"IncorrectLicense";if(!sb)return J.ULS.sendTraceTag(537154653,306,10,"PivotTableHandRaiseManager:TriggerHandRaise activeRangeForHandRaise is null."),"ActiveRangeNull";if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6212469_PTPSReadOnly")&&!this.$.ea.isEditMode)return J.ULS.sendTraceTag(523100545,306,50,"PivotTableHandRaiseManager:TriggerHandRaise not in edit mode."),
"NotInEditMode";if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)){if((yield this.eoc.b$b())>=this.lof)return J.ULS.sendTraceTag(520370312,306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),"DismissCountAboveLimit"}else if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.doc.b$b()>=this.lof)return J.ULS.sendTraceTag(522311633,306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),
"DismissCountAboveLimit";if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6138004_PTPSMaxCells")){try{var $b=yield this.expandRange(sb)}catch(xc){return"ExpandRangeFailed"}if(!$b)return J.ULS.sendTraceTag(523776330,306,50,"PivotTableHandRaiseManager.triggerHandRaise expanded range is null"),"ExpandedRangeNull";if(176E4<$b.TG)return J.ULS.sendTraceTag(523776329,306,50,"PivotTableHandRaiseManager.triggerHandRaise range is too large to generate suggestions"),"RangeTooLarge";K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseNotOverlapData",
!1)&&(sb=$b)}if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTestOnly",!1))return this.d3c<this.kof?(this.VQd(sb),"SuccessWithLppDisabled"):"TriggerCountAboveMax";if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTableMetadataIntEnabled",!1)){$b=this.CUh(sb);if(!$b)return"NoTableMetadata";if(this.umi($b))return K.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||
K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)?this.Lkf(sb):this.d3c<this.kof?(this.VQd(sb),"SuccessWithLppDisabled"):"TriggerCountAboveMax";J.ULS.sendTraceTag(537154652,306,50,"PivotTableHandRaiseManager:TriggerHandRaise table data is not pivotable.");return"NotPivotable"}return K.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)?
this.Lkf(sb):"LppAndTableMetadataDisabled"})}dispose(){this.Vh&&this.Vh.dispose();this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}CUh(sb){var $b;J.ULS.sendTraceTag(537154651,306,50,"PivotTableHandRaiseManager:GetRelevantRecognizedTable get table metadata info.");sb=null===($b=this.tableIntelligenceManager.J3a().hac(new xb.a(sb,ab.d(this.$.xa.oa)),6)[0])||void 0===$b?void 0:$b.table;K.EwaSettings.isChangeGateEnabled("OfficeVSO:6785518_PTPSLogRecognizedTableID")&&sb&&J.ULS.sendTraceTag(520147406,
306,50,`PivotTableHandRaiseManager.getRelevantRecognizedTable Found metadata with ID: ${sb.id}`);return sb}Lkf(sb){return Object(sa.a)(this,void 0,void 0,function*(){const $b=nb.a.instance.Vb("Common.ISystemInitiatedFeedback");return $b?(this.q$d=this.cmf+1,J.ULS.sendTraceTag(537154648,306,50,`PivotTableHandRaiseManager:TriggerHandRaise PivotTableHandRaiseActivity LPP activity log count: ${this.cmf}`),K.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")?(yield new Promise(xc=>{$b.execute(xc)})).logActivity("PivotTableHandRaiseActivity",
null,sb):$b.execute(xc=>{xc.logActivity("PivotTableHandRaiseActivity",null,sb)}),"Success"):"SystemInitiatedFeedbackNull"})}r2h(sb){J.ULS.sendTraceTag(537154647,306,50,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback HandlePivotTableActivationCallback invoked.");return sb?!sb.contextInfo||!sb.contextInfo.length||1<sb.contextInfo.length?(J.ULS.sendTraceTag(537154645,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback no valid contextInfo in surveyParams."),"InvalidContextInfo"):
this.VQd(sb.contextInfo[0].context):(J.ULS.sendTraceTag(537154646,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback surveyParams is null."),"SurveyParamsNull")}VQd(sb){K.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseCardUX",!1)?(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(gd.a.nXi,{},void 0,!0),J.ULS.sendTraceTag(526984158,306,
50,"PivotTableProactiveSuggestion: show pivot table hand raise."),this.proactiveSuggestionCard.show(sb,S.a.instance.ga(1825),S.a.instance.Xa(683),S.a.instance.ga(1823),S.a.instance.ga(1824),()=>{K.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(gd.a.mXi,{},void 0,!0);J.ULS.sendTraceTag(526984157,306,50,"PivotTableProactiveSuggestion:OpenPane Pivot table hand raise OOUI clicked.");K.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&
this.proactiveSuggestionCard.hide();this.$.xd(2137617149,0,0,{SourceControlId:"PivotTableHandRaise",Iig:[sb]}).continueWith(()=>{K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.eoc.HJd():K.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.doc.HJd();K.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")||this.proactiveSuggestionCard.hide()})},()=>{K.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&
Od.b(this.$).Cd(gd.a.lXi,{},void 0,!0);J.ULS.sendTraceTag(526984156,306,50,"PivotTableProactiveSuggestion: Not Now clicked.");this.Z4c()},void 0,void 0,void 0,void 0,K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseNotOverlapData",!1)?11:void 0,void 0,void 0,void 0,$b=>{$b=$b?new Sys.UI.DomEvent($b):null;"keydown"===(null===$b||void 0===$b?void 0:$b.type)&&27===$b.keyCode&&(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(gd.a.kXi,
{},void 0,!0),this.Z4c())},!1,!0)):(this.Vh.setRange(sb),this.Vh.Yza());ob.g(this.$).ha.LG(this.Uc);this.X2d=this.d3c+1;return"Success"}umi(sb){for(let $b of sb.interpretations)if(.75<=$b.confidence&&2===$b.orientation&&1===$b.headerRowCount)return!0;return!1}expandRange(sb){return Object(sa.a)(this,void 0,void 0,function*(){const $b=ob.g(this.$);yield new Promise(ne=>{if($b.Ea.lK(4,this.$.oa))ne();else{const ye=()=>{$b.Ea.lK(4,this.$.oa)&&($b.Dab(ye),ne())};$b.PXa(ye)}});if($b.Db.qwa(sb))return J.ULS.sendTraceTag(521246810,
306,50,"PivotTableHandRaiseManager.expandRange: Range is empty"),null;const xc=$b.Db.Xj(sb);if(xc)return xc.usedRange;const ad=yield H.GetServiceTaskFactory.Qia(this.$.da,482,483,1),Dd=this.$.pa.va.Qb(),ie=Object(pa.o)(sb,this.$),$d=Object(pa.v)(sb,this.$);return new Promise((ne,ye)=>{var te=(Ze,re,tc)=>ad.getExpandedRangeForPivotTable(this.$.pa.va,$d,ie,Object(Ba.b)(Ze,$c=>{J.ULS.sendTraceTag(526790984,306,50,"PivotTableHandRaiseManager.getSelectionForHandRaise: Expanded range");$c=Object(pa.Z)($c.Result,
this.$.xa);$c.returnValue?ne($c.range):(J.ULS.sendTraceTag(526790983,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to parse expanded range"),ye(Error("PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to parse expanded range")))}),Object(Ba.a)(re,()=>{J.ULS.sendTraceTag(526790982,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to expand range");ye(Error("PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to expand range"))}),tc,null,Dd);
te=K.EwaSettings.fc()?new cc.a(511,0,te,88):new Ge.a(511,0,te,24);te.Pma(()=>!0);this.$.userOperationManager.Ub(te,null)})})}Z4c(){if(!K.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")||this.proactiveSuggestionCard.isVisible)this.proactiveSuggestionCard.hide(),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.eoc.ojd():K.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.doc.ojd()}}Object(y.a)(ud,"PivotTableHandRaiseManager",
null,[694,3]);class Kd extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}create(){const sb=H.GetServiceTaskFactory.Ta(this.$.da,20,404,1),$b=H.GetServiceTaskFactory.Ta(this.$.da,486,487,1);let xc=null;K.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||(xc=H.GetServiceTaskFactory.Ta(this.$.da,12,477,1));let ad=null;!K.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")&&K.EwaSettings.ma(540)&&(ad=H.GetServiceTaskFactory.Ta(this.$.da,388,387,
1));const Dd=[sb,$b];xc&&Dd.push(xc);ad&&Dd.push(ad);N.TaskExtensions.Aa(T.Task.zL(...Dd),()=>{if(!this.$.da.za(430)){var ie=sb.result;const $d=$b.result,ne=null===xc||void 0===xc?void 0:xc.result,ye=null===ad||void 0===ad?void 0:ad.result;ie&&$d?(ie=new ud(this.$,ie,$d,ne,ye),this.qb(ie),this.$.da.Ga(430,ie)):(null==ie&&J.ULS.sendTraceTag(537154644,306,10,"PivotTableHandRaiseManagerFactory.Create: TableIntelligenceManager instance null."),null==$d&&J.ULS.sendTraceTag(525620053,306,10,"PivotTableHandRaiseManagerFactory.Create: ProactiveSuggestionCard instance null."),
this.qb(null))}},this.$.la)}static ka(sb){sb.da.Ga(431,new Kd(sb))}dispose(){this.$=null;super.dispose()}}Object(y.a)(Kd,"PivotTableHandRaiseManagerFactory",Da.a,[]);var Zd=a(1248),Xd=a(1151),Je=a(27),Xe=a(33),Ke=a(48),Qe=a(28),df=a(47);class Ne extends Qc.a{constructor(sb){super(document.createElement("div"));this.$=sb;this.isMac=Je.a.isMac;this.onKeyDown=$b=>{$b=$b.Ca;switch($b.keyCode){case 27:if(this.ns.onDismiss)this.ns.onDismiss($b);this.hide();return!0;default:return!1}};this.onKeyUp=$b=>{$b=
$b.Ca;switch($b.keyCode){case 121:return $b.altKey&&$b.shiftKey?(this.focus(),!0):!1;default:return!1}};this.cei=($b,xc)=>$b.x==xc.x&&$b.y==xc.y&&$b.width==xc.width&&$b.height==xc.height;this.XWd=()=>{this.isVisible?(this.SVj=Qe.a.Wa.je.m,this.hide(),this.vbg=df.a.instance.create(()=>{this.YPj()},this.hfg,"ProactiveSuggestionCard.UpdateCardPosition",void 0,!0)):this.grid.view.Oq(this.XWd)};this.YPj=()=>{Qe.a.Wa.je.m-this.SVj>=this.hfg&&this.trc()};this.grid=ob.g(sb);this.JDd=null;this.s0b=this.oU=
!1;this.hfg=250;this.tXf=!1}show(sb,$b,xc,ad,Dd,ie,$d,ne,ye,te,Ze,re,tc,$c,Ed,Id,ae,ja){if(!Ed&&this.$&&(Ed=this.getCellBounds(sb),!Ed))return!1;this.rootBounds=Sys.UI.DomElement.getBounds(this.grid.kva.lc);this.tXf=ja;this.Jfi=!!re;this.zQe=tc;this.ns={range:sb,container:this.domElement,title:$b,description:xc,primaryButtonText:ad,secondaryButtonText:Dd,SOi:ie,uQi:$d,menuItems:ne,PDb:ye,v5:te,icon:Ze,direction:re,gapSpace:$c,onDismiss:Id,a8g:hb=>{hb&&(this.JDd=hb)},setInitialFocus:ae,ariaLabel:this.isMac?
$b+" "+S.a.instance.ga(1827):$b+" "+S.a.instance.ga(1826)};sb=this.trc(Ed);this.oU||(this.$.frame.xt.ra(Gb.a.Gd,this.$.domElement,this.onKeyUp),this.$.frame.xt.pt(Gb.a.Mb,this.$.domElement,this.onKeyDown,!0),this.oU=!0);this.$.da.Za(211,hb=>{const oa=this.isMac?S.a.instance.ga(1827):S.a.instance.ga(1826);hb.setEnabled(!0);hb.readText(oa)});return sb}hide(){J.ULS.sendTraceTag(527218006,1,50,"ProactiveSuggestionUIControl.Hide: calling AppChrome API to unmount card UI.");K.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&
this.vbg&&this.vbg.cancel();appChrome.unmountReactComponent(this.domElement);this.isVisible=!1;this.grid.view.Oq(this.XWd);this.oU&&(this.$.frame.xt.Ba(Gb.a.Gd,this.$.domElement,this.onKeyUp),this.$.frame.xt.At(Gb.a.Mb,this.$.domElement,this.onKeyDown,!0),this.oU=!1)}focus(){this.JDd&&this.JDd.focus()}dispose(){super.dispose()}getCellBounds(sb){if(sb=this.grid.Xb(sb))if(sb.cell.Ck){if(this.grid.daa(sb.cell.cu.Nd))return this.grid.getCellBounds(sb.cell,!0);J.ULS.sendTraceTag(525341026,1,15,"ProactiveSuggestionUIControl.GetCellBounds failed to show UI, gridViewBlock not found")}else J.ULS.sendTraceTag(527218009,
1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is not in view.");else J.ULS.sendTraceTag(527218010,1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is null.")}getRangeBounds(sb){var $b=this.grid.hb.jj(sb),xc=this.grid.lg(sb,$b),ad=this.grid.Lf($b);$b=ad.tn;if(!$b.Ed(xc))return this.rootBounds;xc=$b.Fe(xc);var Dd=xc.topLeft.y;sb=xc.bottomRight.y;const ie=xc.topLeft.x;xc=xc.bottomRight.x;const $d=new Ke.a(xc,sb-134);this.s0b=
!$b.HGa($d);ad=Sys.UI.DomElement.getLocation(ad.domElement);Dd=new Sys.UI.Point(ie+ad.x-$b.topLeft.x,Dd+ad.y-$b.topLeft.y);$b=new Sys.UI.Point(xc+ad.x-$b.topLeft.x,sb+ad.y-$b.topLeft.y);Dd=Xe.a(this.$).Uia(Dd);$b=Xe.a(this.$).Uia($b);return new Sys.UI.Bounds(Dd.x,Dd.y,$b.x-Dd.x,$b.y-Dd.y)}trc(sb){if(!this.ns)return!1;sb||this.getRangeBounds(this.ns.range);this.tXf?(sb=this.getRangeBounds(this.ns.range),K.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?this.ns.direction=this.s0b&&
null!=this.zQe?this.zQe:this.ns.direction:this.ns.direction=this.Jfi?this.ns.direction:this.s0b?11:13,this.s0b=!1):sb=this.getCellBounds(this.ns.range);if(this.cei(sb,this.rootBounds))return J.ULS.sendTraceTag(525341025,1,15,"ProactiveSuggestionUIControl.RenderCard failed to show UI, targetBounds set to root"),!1;J.ULS.shipAssertTag(527218008,1,!!sb,"ProactiveSuggestionUIControl.RenderCard: target cell bounds should not be null.");J.ULS.sendTraceTag(527218007,1,50,"ProactiveSuggestionUIControl.RenderCard: calling AppChrome API to render card UI.");
appChrome.renderProactiveSuggestionCard(sb.y,sb.x,sb.y+sb.height,sb.x+sb.width,this.ns.container,this.ns.title,this.ns.description,this.ns.primaryButtonText,this.ns.secondaryButtonText,this.ns.SOi,this.ns.uQi,this.ns.menuItems,this.ns.PDb,this.ns.v5,this.ns.icon,this.ns.direction,this.ns.gapSpace,this.ns.onDismiss,this.ns.a8g,this.ns.setInitialFocus,this.ns.ariaLabel);this.isVisible=!0;this.grid.view.Ns(this.XWd);return!0}}Object(y.a)(Ne,"ProactiveSuggestionCard",Qc.a,[699]);class jf extends Da.a{constructor(sb){super();
this.$=sb;this.Fb()}static ka(sb){sb.da.Ga(487,new jf(sb))}create(){var sb;this.qb(null!==(sb=this.$.da.za(486))&&void 0!==sb?sb:this.$.da.Ga(486,new Ne(this.$)))}dispose(){this.$=null;super.dispose()}}Object(y.a)(jf,"ProactiveSuggestionCardFactory",Da.a,[]);var Le=a(116);class me{constructor(sb){sb.kz($b=>{void $b.T$(1).then(()=>{const xc=document.createElement("div"),ad=Object(ob.g)(sb).uj;appChrome.renderProactiveSuggestionDebugPane(xc,ad,Le.a.qu)})});K.EwaSettings.ma(291)&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",
!1)&&void H.GetServiceTaskFactory.Qia(sb.da,510,511,1)}}Object(y.a)(me,"ProactiveSuggestionDebugToolsManager",null,[]);class Za extends Da.a{constructor(sb){super();this.$=sb;this.Fb()}static ka(sb){sb.da.Ga(509,new Za(sb))}create(){this.qb(Object(yc.c)(this.$.da,508,()=>new me(this.$)))}}Object(y.a)(Za,"ProactiveSuggestionDebugToolsManagerFactory",Da.a,[]);var Tb=a(1124);class uc{constructor(sb,$b){this.$=sb;this.tableIntelligenceManager=$b;sb.xa.Pf(()=>this.jXd());this.tableIntelligenceManager.DXa("Valid",
()=>{this.jXd()});this.tableIntelligenceManager.DXa("Invalid",()=>{this.jXd()})}jXd(){const sb=[],$b=[],xc=[],ad=this.$.xa.oa;if(ad){var Dd=this.tableIntelligenceManager.J3a().hac(new xb.a(Object(pa.f)(),ad.sheetId),2);for(const ie of Dd){if(ie.table.nE.sheetId!==ad.sheetId)continue;Dd=this.MHh(ie.table);if(!Dd)continue;const $d=Dd.vna.clone();$d.left+=Dd.headerColumnCount;$d.top+=Dd.headerRowCount;let ne=!0,ye=!0;for(let te=0;te<Dd.fields.count;te++){const Ze=$d.clone();2===Dd.orientation?(Ze.left+=
te,Ze.right=Ze.left):(Ze.top+=te,Ze.bottom=Ze.top);1===Dd.fields.na(te).classification?(this.yke(sb,Ze,ye),ye=!1):(this.yke($b,Ze,ne),ne=!1)}Dd=this.LOh(Dd);null!=Dd&&xc.push(Dd)}this.gHd();0<sb.length&&this.oz(sb,[32]);0<$b.length&&this.oz($b,[33]);0<xc.length&&this.oz(xc,[31])}else J.ULS.sendTraceTag(520147412,0,50,"GridHighlighter.updateGridHighlights: Active sheet null")}gHd(){const sb=[33,32,31];Object(ob.g)(this.$).ob.Tg(sb);Object(ob.g)(this.$).ob.PQa(new xb.a(null,ab.d(this.$.oa)),sb)}yke(sb,
$b,xc){!sb.length||xc?sb.push($b.clone()):(xc=sb[sb.length-1],xc.right+1===$b.left?xc.right=$b.right:xc.bottom+1===$b.top?xc.bottom=$b.bottom:sb.push($b.clone()))}MHh(sb){var $b=sb.interpretations;return 0===(null===$b||void 0===$b?void 0:$b.count)?null:1===$b.count?$b.na(0):2===$b.count?$b.na(0).confidence===$b.na(1).confidence?(sb=2===$b.na(0).orientation?$b.na(0):$b.na(1),$b=1===$b.na(0).orientation?$b.na(0):$b.na(1),new Tb.a(sb.vna,sb.confidence,$b.headerRowCount,sb.headerColumnCount,sb.orientation,
sb.fields)):sb.interpretations.na(0).confidence>sb.interpretations.na(1).confidence?sb.interpretations.na(0):sb.interpretations.na(1):null}oz(sb,$b){sb=xb.a.Y6(ab.d(this.$.oa),sb);Object(ob.g)(this.$).ob.yv(sb,$b,!0)}LOh(sb){const $b=sb.vna.clone();if(2===sb.orientation){if(0===sb.headerRowCount)return null;$b.bottom=$b.top+sb.headerRowCount-1}else{if(0===sb.headerColumnCount)return null;$b.right=$b.left+sb.headerColumnCount-1}return $b}}Object(y.a)(uc,"RecognizedTableGridHighlighter",null,[]);class Oc extends Da.a{constructor(sb){super();
this.$=sb;this.Fb()}static ka(sb){sb.da.Ga(511,new Oc(sb))}create(){void H.GetServiceTaskFactory.Qia(this.$.da,20,404,1).then(sb=>{this.qb(Object(yc.c)(this.$.da,510,()=>new uc(this.$,sb)))})}}Object(y.a)(Oc,"RecognizedTableGridHighlighterFactory",Da.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataCleansing");Type.registerNamespace("_Ewa");x.a.Di('.DataCleansingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.DataCleansingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.DataCleansingPaneBody{flex:auto;position:relative}.DataCleansingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.DataCleansingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{z.a.Fa(sb=>{K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingStatefulTaskPane",!1)?(Tc.ka(sb),ha.ka(sb)):(lb.ka(sb),ha.ka(sb),B.a.zd(sb)||bc.ka(sb))})})();(()=>{z.a.Fa(sb=>{I.ka(sb)})})();(()=>{z.a.Fa(sb=>{Kd.ka(sb)})})();Object(Zd.a)();Object(Xd.a)();(()=>{z.a.Fa(sb=>{jf.ka(sb)})})();(()=>{z.a.Fa(sb=>{Za.ka(sb)})})();(()=>{z.a.Fa(sb=>{Oc.ka(sb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.datacleansing.js.map/b15a540a8d6d317d73e9c295f530a370/EwaDSEsNext.datacleansing.js.map