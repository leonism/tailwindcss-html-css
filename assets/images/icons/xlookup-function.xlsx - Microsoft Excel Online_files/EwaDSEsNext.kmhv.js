'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1044:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1045:function(t,D,a){a.d(D,"a",function(){return k});t=a(0);var c=a(15),b=a(83);D=a(144);var d=a(4),f=a(44),e=a(29);class k extends D.a{constructor(l,m,v,n,w,r,u=null){super();this.QI=null;this.La=m;this.MW=n;this.Nfa=r;this.nb=l;this.Ds=w;this.We=v;this.ihb=this.nb.qa("SaveToHostWithExtraCharsInFileName");this.Ih=u;this.sc(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.We}FGe(l,m){this.dL(1,!!l&&l!==m);this.QI=document.getElementById(k.ZQe);f.a.addHandler(this.QI,"change",Object(b.a)(this,
this.zlc,"onFileNameChange"));f.a.addHandler(this.QI,"input",Object(b.a)(this,this.zlc,"onFileNameChange"));this.QI.focus()}M7b(l){return this.ihb?(new RegExp("["+this.v6b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.v6b('\\/:*?"<>|#{}%~&')+"]")).test(l)}v6b(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}ngd(){const l=e.a.rq(d.AFrameworkApplication.lm.Ym);this.dL(1,!!this.QI&&""!==this.QI.value&&this.QI.value!==l)}zlc(){this.QI&&window.setTimeout(()=>{this.ngd()},0)}L7b(l,m){if(1!==
l)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=m[k.ZQe];m=k.oEf in m?m[k.oEf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",e.a.Rpc(l),m);const v=e.a.o3(d.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==v||1===this.ta.state?this.M7b(l)?this.Ds.create().displayError(1,l,m):this.Nfa.lna(l+v,m,this.Ih):this.Ds.create().displayError(2,l,m)}}dispose(){this.QI&&
(f.a.removeHandler(this.QI,"change",Object(b.a)(this,this.zlc,"onFileNameChange")),f.a.removeHandler(this.QI,"input",Object(b.a)(this,this.zlc,"onFileNameChange")),this.QI=null);super.dispose()}}k.ZQe="txtFileName";k.oEf="chkOverwrite";Object(t.a)(k,"FileNameDialogBase",D.a,[])},1046:function(t,D,a){a.d(D,"a",function(){return n});t=a(0);var c=a(15),b=a(156),d=a(83),f=a(4),e=a(638),k=a(831),l=a(371),m=a(106),v=a(25);class n{constructor(w,r,u,x){this.oUb=null;this.Lug=w;this.nb=u;this.mbe=r;this.W9d=
new b.a;this.xh=x}I6a(){return this.nb.qa("SaveToCloudStorageUIIsEnabled")}HUe(){return v.a.saveToCloudStorage}O_b(){l.a.uGd(Object(d.a)(this,this.HUf,"saveToCloudActionDispatcher"));l.a.F6c([new k.a(v.a.saveToCloudStorage,m.a.frame,0)],this.mbe.r3a())}Fg(){const w=this.mbe.r3a();w?(w.T8(()=>{this.W9d.setResult(!0)}),this.O_b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}XLf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}HUf(w,
r,u,x,z){return r.contextId!==m.a.frame||w!==this.HUe()?2:this.I6a()?1===u?e.SessionStatusManager.instance.g4a||f.AFrameworkApplication.i4?8:32:2===u?(this.XLf(),z&&z.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.xh&&(this.oUb=this.xh.xc("DialogShown","SaveToOneDriveReponseTime")),this.W9d.task.continueWith(()=>{this.oUb&&(this.oUb.stop(),this.oUb=null);this.Lug.start(z)}),32):8:8}}Object(t.a)(n,"SaveToCloudStorageActor",null,[357])},
1047:function(t,D,a){a.d(D,"a",function(){return w});t=a(0);var c=a(15),b=a(83),d=a(1048),f=a(4),e=a(41),k=a(39),l=a(236),m=a(370),v=a(163),n=a(762);class w{constructor(r,u,x,z,B){this.Q7=this.Bm=this.WBa=null;this.ECa=!1;this.Ih=this.Mfa=null;this.TQc=r;this.Pjb=u;this.Ds=x;this.We=z;this.xh=B}gLb(){this.We&&1===this.We.state||(this.Bm=this.Pjb(),this.Bm.message=CommonUIStrings.l_CommentProgressTooltip,this.Bm.Sb=5,this.Bm.it=!1,this.Bm.cAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}KHa(){this.Bm&&
(this.Bm.close(),this.Bm=null)}JR(){1!==f.AFrameworkApplication.ta.state&&this.Ds().displayError(d.a.default)}hPa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");k.a.Ve(this.Q7,k.a.DW(3),void 0,"UploadToCloudManager.RedirectToFolder")}gPa(r){let u=!1,x=!1;f.AFrameworkApplication.fa&&(u=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),x=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
r,u);if(u&&x){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const z={};z[m.a.bPa]="1";z[m.a.documentUrl]=r;f.AFrameworkApplication.GU().execute(B=>{B.Fj(v.a.kta,z)})}else k.a.Ve(r,k.a.DW(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}lna(r,u,x=null,z=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.xh&&(this.Mfa=this.xh.xc("DialogShown","SaveToOneDriveUploadTime"));this.gLb();this.Q7=u;this.WBa=this.TQc.create(r,
x,z);this.Ih=z;this.VP()}VP(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.WBa.execute(Object(b.a)(this,this.dQi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.cQi,"onSaveToCloudUploadFailed"))}dQi(r){this.KHa();this.ECa=!1;if(r&&r.data&&r.data.Td){var u;if(({Vt:u}=e.d(r.data.Td)).returnValue)if(r=u,r.StatusCode!==l.a.DO&&r.StatusCode!==l.a.Cqb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.JR();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.gPa(r.NewDocumentUrl):this.hPa()}catch(x){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",x.toString())}this.mFb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:n.a.aeb(r.data.Td)}),this.JR()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.JR()}cQi(r){5!==r.data.status&&12!==r.data.status||
this.ECa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.KHa(),this.JR(),this.mFb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.ECa=!0,this.VP())}mFb(){this.Mfa&&(this.Mfa.stop(),this.Mfa=null)}}Object(t.a)(w,"UploadToCloudManager",null,[352])},1048:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.default=0;Object(t.a)(c,"SaveToCloudErrorCodes",null,[])},1049:function(t,D,a){a.d(D,"a",
function(){return e});t=a(0);var c=a(15),b=a(83),d=a(1048),f=a(82);class e{constructor(k,l,m,v,n,w){this.Ih=null;this.Fvg=k;this.j1=l;this.flb=m;this.nb=v;this.cPb=n;this.Ds=w}start(k){this.Ih=k;if("SharePointOnlineConsumer"===this.nb.Va("FileSource")){const l=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(l){l.start(null,k);return}}this.j1.cLa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.iTg()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.Fvg.create().MP()}nj(){this.Ds().displayError(d.a.default)}iTg(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.cPb||2===this.cPb)k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId};WL.init(k);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.s5,"onFailure"))}catch(k){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",k,k.stack),this.nj()}}onSuccess(k){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");k&&k.data&&k.data.folders&&this.flb.lna(k.data.folders[0].id,k.data.folders[0].urls.viewInBrowser,null,this.Ih)}s5(k){if(k&&
k.error){if("user_canceled"===k.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",k.error.code,k.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.nj()}}Object(t.a)(e,"SaveToCloudManager",null,[356])},1050:function(t,D,a){a.d(D,"a",function(){return f});t=a(0);var c=a(15),b=a(39),d=a(80);a=a(704);class f extends a.a{constructor(e,
k){super(e,k);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.fxa;this.jva=!0}get linkText(){return f.dnf}ola(e){super.ola(e);b.a.openWindow(4,d.a.pH(f.cnf))}kD(e){super.kD(e);f.Btd&&f.Btd(null)}static initialize(e,k,l,m){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.fxa=e;f.dnf=k;f.cnf=l;f.Btd=m}}f.fxa=null;f.dnf=null;f.cnf=null;f.Btd=null;Object(t.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1051:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.Hlh="ewa-bb";c.Jlh="ewa-bb-entry";c.Rlh="ewa-bb-react";c.Klh="ewa-bb-entry-body";c.Qlh="ewa-bb-icon";c.Mlh="ewa-bb-entry-icon";c.Plh="ewa-bb-entry-title";c.Olh="ewa-bb-entry-message";c.fLe="ewa-bb-entry-button";c.Nlh="ewa-bb-entry-link";c.Llh="ewa-bb-entry-close";c.gLe="ewa-bb-entry-button-holder";c.Ilh="ewa-bb-content";Object(t.a)(c,"CssClassNames",null,[])},1052:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);
a=a(704);class c extends a.a{constructor(b,d){super(b,d);this.fv=!0;this.title=c.noa;this.message=c.loa}get actionButton(){return c.koa}xo(b){super.xo(b);(b=c.moa)&&b(null)}static initialize(b,d,f,e){c.noa=b;c.loa=d;c.koa=f;c.moa=e}}c.noa=null;c.loa=null;c.koa=null;c.moa=null;Object(t.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1053:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);a=a(704);class c extends a.a{constructor(b,d){super(b,d);this.fv=!0;this.title=c.noa;this.message=
c.loa}get actionButton(){return c.koa}xo(b){super.xo(b);(b=c.moa)&&b(null)}static initialize(b,d,f,e){c.noa=b;c.loa=d;c.koa=f;c.moa=e}}c.noa=null;c.loa=null;c.koa=null;c.moa=null;Object(t.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1054:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);a=a(704);class c extends a.a{constructor(b,d){super(b,d);this.fv=!0;this.title=c.noa;this.message=c.loa}get actionButton(){return c.koa}xo(b){super.xo(b);(b=c.moa)&&b(null)}static initialize(b,
d,f,e){c.noa=b;c.loa=d;c.koa=f;c.moa=e}}c.noa=null;c.loa=null;c.koa=null;c.moa=null;Object(t.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1055:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);a=a(704);class c extends a.a{constructor(b,d){super(b,d);this.fv=!0;this.title=c.CBb;this.message=c.fxa}get actionButton(){return c.L7a}xo(b){super.xo(b);c.hxa&&c.hxa(null)}static initialize(b,d,f,e){c.CBb=b;c.fxa=d;c.L7a=f;c.hxa=e}}c.CBb=null;c.fxa=null;c.L7a=null;c.hxa=null;Object(t.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1056:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);a=a(704);class c extends a.a{constructor(b,d){super(b,d);c.L7a&&c.hxa&&(this.fv=!0);this.title=c.CBb;this.message=c.fxa}get actionButton(){return c.L7a}xo(b){super.xo(b);c.hxa&&c.hxa(null)}static initialize(b,d,f,e){c.CBb=b;c.fxa=d;c.L7a=f;c.hxa=e}}c.CBb=null;c.fxa=null;c.L7a=null;c.hxa=null;Object(t.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1057:function(t,
D,a){a.d(D,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.jfb=function(){function b(){return m()&&(B()||3<=(u()?y("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function e(){Ba||(Ba=!0,ob=k("Windows Phone"))}function k(qb){qb=(new RegExp(qb+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Wa=-1;return null!=qb&&2<=qb.length&&(Wa=parseFloat(qb[1]),
isNaN(Wa)&&(Wa=-1)),Wa}function l(){return"function"==typeof navigator.msLaunchUri&&!f()&&!z()&&!v()}function m(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function w(){return n()?8==window.document.documentMode:!1}function r(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function u(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function x(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function z(){var qb=window.navigator.userAgent.toLowerCase();return 0<=qb.indexOf("android")&&0<=qb.indexOf("chrome")}function B(){return 3<=(r()?y("firefox/"):0)}function y(qb){var Wa=window.navigator.userAgent.toLowerCase(),ta=Wa.indexOf(qb),ib,Bb;return 0<=ta?(ib=ta+qb.length,Bb=Wa.length,parseInt(Wa.substring(ib,Bb))):0}function A(qb,Wa,ta,ib,Bb){if(ib&&null!=Wa)Wa();
else if(l())navigator.msLaunchUri(qb,Wa,ta);else if(!(x()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&m())||v())G(qb,Wa,ta);else if(x()&&Bb)a:{try{window.open(qb,"_self")}catch(Ub){null!=ta&&ta();break a}null!=Wa&&Wa()}else K(qb,Wa,ta)}function K(qb,Wa,ta){var ib=document.getElementById("OICLinkTag"),Bb;null==ib&&(ib=document.createElement("a"),ib.id="OICLinkTag",ib.style.visibility="hidden",ib.href="",ib.target=0==(Mb.Options&
Va.SupportsTopTargetNavigation)||Mb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(ib),null!=ib.addEventListener&&ib.addEventListener("click",function(Ub){null!=Ub.stopPropagation&&Ub.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Bb=function(Ub){var Ta=document.createEvent("MouseEvent");return Ta.initMouseEvent(Ub,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ta},Bb.prototype=Event.prototype,window.MouseEvent=Bb),ib.href=qb,ib.dispatchEvent(new MouseEvent("click"))}catch(Ub){null!=
ta&&ta();return}null!=Wa&&Wa()}function G(qb,Wa,ta){var ib=document.getElementById("OICFrame");null==ib&&(ib=document.createElement("iframe"),ib.className="ObjectInDialog",ib.style.visibility="hidden",ib.src="about:blank",document.body.appendChild(ib),ib.id="OICFrame");try{ib.contentWindow.location.href=qb}catch(Bb){null!=ta&&ta();return}null!=Wa&&Wa()}function T(qb){return 0!=(qb.Options&Va.SkipProtocolHandler)||w()}function W(qb){return qb===xb.ReadOnly||qb===xb.ReadWrite}function P(qb,Wa,ta,ib){var Bb,
Ub;try{if(Bb=new ActiveXObject(Ca),Bb)return Ub=Bb.ViewDocument3(window.self,qb,Wa,ib),Ub?(V(ra.O14ActiveX),bb.None):bb.Failed}catch(Ta){}if(Va.O14Only===(ta&Va.O14Only))return Mb.DescriptiveUnattemptedEnums?bb.O14AttemptFailure:bb.Unattempted;try{if(Bb=new ActiveXObject(Na),Bb)return Ub=Bb.ViewDocument3(window.self,qb,Wa,ib),Ub?(V(ra.O12ActiveX),bb.None):bb.Failed}catch(Ta){}if(Va.O12UpOnly===(ta&Va.O12UpOnly))return Mb.DescriptiveUnattemptedEnums?bb.O12UpOnlyFail:bb.Unattempted;try{if(Bb=new ActiveXObject(za),
Bb)return Ub=W(Wa)?Bb.ViewDocument2(window.self,qb,ib):Bb.EditDocument2(window.self,qb,ib),Ub?(V(ra.O11ActiveX),bb.None):bb.Failed}catch(Ta){}return Mb.DescriptiveUnattemptedEnums?bb.ActiveXUnattempted:bb.Unattempted}function E(qb,Wa,ta,ib,Bb){var Ub,Ta,mb;qb==Qa.Visio&&ta==xb.ReadWrite&&(ta=xb.WriteOnly);qb=Bb;(ib=ib||f()&&!(e(),8<=ob))||(Ub="",Ub+=W(ta)?Da+nb:qa,Ub+=pa,qb+=F(Ub));qb+=F(Wa);Mb.NewTelemetryDataIsEnabled&&(Ta=-1!==qb.indexOf("?")?"&":"?",Ta+=Mb.SessionOrigin?"OR="+Mb.SessionOrigin+
"&":"",Ta+=Mb.ClickTime?"CT="+Mb.ClickTime+"&":"",Ta+=Mb.CorrelationId?"CID="+Mb.CorrelationId:"",Ta="?"!=Ta?Ta:"",Ta="&"!=Ta.slice(-1)?Ta:Ta.slice(0,-1),qb+=F(Ta),Mb.CorrelationIdForWinClient&&(qb+=F(Mb.CorrelationIdForWinClient)));Wa=window.location.href;ta=$a;ib=Wa.toLowerCase().indexOf("&"+ta+"=");var Qb;ta=-1==ib?void 0:(mb=ib+(ta.length+2),Qb=Wa.indexOf("&",mb),-1==Qb)?Wa.substr(mb):Wa.substring(mb,Qb);if(null!=ta&&"undefined"!=typeof ta){mb="";try{mb=decodeURIComponent(ta)}catch(Lb){}0<mb.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(mb)&&(qb+=Ja,qb+=mb)}return qb}function H(qb,Wa,ta,ib,Bb,Ub){var Ta=fa(qb),mb;return null==Ta?(wa(Mb.DescriptiveUnattemptedEnums?bb.ProtocolHandlerIsNull:bb.Unattempted,Mb.Application),!1):(mb=E(qb,Wa,ta,ib,Ta),A(mb,N,J,Bb,Ub),!0)}function F(qb){if(m()&&x()){var Wa="";try{Wa=decodeURI(qb)}catch(ta){}if(Wa==qb)return encodeURI(qb)}return qb}function N(){V(ra.ProtocolHandler)}function J(){Mb.Options|=Va.SkipProtocolHandler;ka(Mb,Ob,tb)}
function R(){null!=cc&&cc(ra.RoamingProtocolHandler)}function M(){null!=Ib&&Ib(bb.ControlNeeded)}function L(){var qb=document.getElementById(ua),Wa;if(null==qb){if(Wa=la,m()&&3<=(u()?y("version/"):0)&&U(aa,!0)&&(Wa=aa),!U(Wa,!0))if(m()&&U(Z,!0))Wa=Z;else return null;qb=document.createElement("object");qb.id=ua;qb.type=Wa;qb.style.width="0px";qb.style.height="0px";qb.style.setProperty("visibility","hidden","");document.body.appendChild(qb);qb=document.getElementById(ua)}return qb}function U(qb,Wa){var ta=
window.navigator.mimeTypes,ib;return null==ta?!1:(ib=ta[qb],ib)?Wa&&!ib.enabledPlugin?!1:!0:!1}function X(qb){try{if(null!=new ActiveXObject(qb))return!0}catch(Wa){}return!1}function da(qb){switch(qb){case Qa.OneNote:return ha;default:return""}}function fa(qb){if(qb!=Qa.OneNote&&f()&&!(e(),8<=ob))return"office:";switch(qb){case Qa.Excel:return"ms-excel:";case Qa.OneNote:return"onenote:";case Qa.PowerPoint:return"ms-powerpoint:";case Qa.Visio:return"ms-visio:";case Qa.Word:return"ms-word:";case Qa.Project:return"ms-project:";
case Qa.Publisher:return"ms-publisher:";case Qa.Infopath:return"ms-infopath:";case Qa.Access:return"ms-access:";default:return""}}function S(qb){switch(qb){case Qa.Excel:return"root\\office15\\excel.exe";case Qa.PowerPoint:return"root\\office15\\powerpnt.exe";case Qa.Visio:return"root\\office15\\visio.exe";case Qa.Word:return"root\\office15\\winword.exe";case Qa.Project:return"root\\office15\\winproj.exe";case Qa.Publisher:return"root\\office15\\mspub.exe";case Qa.Infopath:return"root\\office15\\infopath.exe";
case Qa.Access:return"root\\office15\\msaccess.exe";default:return null}}function ka(qb,Wa,ta){if(Mb=qb,Ob=Wa,tb=ta,qb.DocumentUrl){var ib=ta=Wa=qb.DocumentUrl;try{ib=decodeURIComponent(qb.DocumentUrl)}catch(Lb){}try{ta=encodeURI(qb.DocumentUrl)}catch(Lb){}Mb.NewTelemetryDataIsEnabled||(Wa=Wa+""+qb.CorrelationIdForWinClient,ib+=qb.CorrelationIdForWinClient,ta+=qb.CorrelationIdForWinClient);qb.Mode===xb.ReadWrite&&Va.CheckoutRequired===(qb.Options&Va.CheckoutRequired)&&(qb.Mode=xb.ForceCheckout);Va.HostIsEditOnly===
(qb.Options&Va.HostIsEditOnly)&&(qb.Mode=xb.WriteOnly);if(T(qb)?0:m()&&(qb.Application==Qa.OneNote||U(sa,!1)||U(ea,!1))||l()||z()||!(b()||B()||"ActiveXObject"in window&&!f()||x())||15<=ma())H(qb.Application,qb.EncodeUrl?ta:Wa,qb.Mode,qb.Application==Qa.OneNote,qb.SilentExternalHandler,qb.NavigateUsingWindowOpen);else{var Bb;if(Bb=w())a:{var Ub=qb.EncodeUrl?Wa:ib,Ta=qb.Mode,mb=da(qb.Application);try{Bb=(new ActiveXObject(ba)).ViewDocument3(window.self,Ub,Ta,mb);break a}catch(Lb){}Bb=!1}if(Bb)V(ra.O15ActiveX);
else{if(b()||B()){var Qb=qb.EncodeUrl?Wa:ib;ib=qb.Mode;Bb=da(qb.Application);Ub=L();if(null==Ub)Qb=Mb.DescriptiveUnattemptedEnums?bb.PluginIsNull:bb.Unattempted;else{Ta=!1;try{Ta=Ub.ViewDocument3(window.self,Qb,ib,Bb)}catch(Lb){}if(!Ta)try{Ta=W(ib)?Ub.ViewDocument2(window.self,Qb,Bb):Ub.EditDocument2(window.self,Qb,Bb)}catch(Lb){}Qb=Ta?(V(ra.NpapiPlugin),bb.None):bb.Failed}}else{try{Qb=new ActiveXObject(ya),null!=Qb&&Qb.SaveSSOCreds()}catch(Lb){}Qb=P(qb.EncodeUrl?Wa:ib,qb.Mode,qb.Options,da(qb.Application))}if(Qb!=
bb.None){if(ib=qb.CouldUseRoamingApps)Oa||(Oa=!0,Aa=k("Windows NT")),ib=6.1<=Aa&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||B()||x());if(ib&&qb.Application!=Qa.OneNote){if(!c.jfb.YXj()){wa(bb.ControlNeeded,Mb.Application);return}if(qb.RoamingAppsLauncher){"undefined"==typeof qb.RoamingAppsLauncher||null==qb.RoamingAppsLauncher?wa(Mb.DescriptiveUnattemptedEnums?bb.RoamingLauncherIsNull:bb.Unattempted,Mb.Application):"undefined"==typeof qb.RoamingBitsUrl||null==qb.RoamingBitsUrl?c.jfb.iYj(qb.DocumentUrl,
qb.RoamingAppsLauncher,qb.Application,qb.ApplicationParameters,Ob,tb):c.jfb.cig(qb.DocumentUrl,qb.RoamingAppsLauncher,qb.RoamingApplicationExe,qb.ApplicationParameters,qb.RoamingPlatform,qb.RoamingBitsUrl,Ob,tb);return}if(!qb.ContinueIfLauncherIsNull){wa(bb.LauncherNeeded,Mb.Application);return}}Va.NoProtocolHandlerFallback==(qb.Options&Va.NoProtocolHandlerFallback)||T(qb)||n()||m()&&!(Mb.DescriptiveUnattemptedEnums?Qb>=bb.O14Unattempted&&Qb<=bb.DocumentUrlIsNull:Qb==bb.Unattempted)?wa(Qb,Mb.Application):
H(qb.Application,qb.EncodeUrl?ta:Wa,qb.Mode,qb.Application==Qa.OneNote,qb.SilentExternalHandler,qb.NavigateUsingWindowOpen)}}}}else wa(Mb.DescriptiveUnattemptedEnums?bb.DocumentUrlIsNull:bb.Unattempted,Mb.Application)}function V(qb){null!=Ob&&Ob(qb)}function wa(qb,Wa){"undefined"==typeof Wa&&(Wa=null);null!=tb&&tb(qb,Wa)}function ma(){var qb=0;if(b()||B()||x()){var Wa=L();try{null!=Wa&&(qb=Wa.GetOfficeVersion())}catch(ta){}}else X(ba)?qb=15:X(Ca)?qb=14:X(Na)?qb=12:X(za)&&(qb=11);return qb}function ab(){return m()&&
(U(la,!0)||U(aa,!0))}var ba="SharePoint.OpenDocuments.5",Ca="SharePoint.OpenDocuments.4",Na="SharePoint.OpenDocuments.3",za="SharePoint.OpenDocuments.2",la="application/x-sharepoint",aa="application/x-sharepoint-webkit",sa="application/x-sharepoint-protocolhandler",ea="application/x-sharepoint-webkit-protocolhandler",Z="application/officelive",ua="npSharePointPlugin",ya="IDBHO.IDBHOCtrl",ha="OneNote.Notebook",Da="ofv|",nb="ofc|",qa="ofe|",pa="u|",Ja="|f|",$a="wdlor",rb="",Pa="",eb="",Ob,tb,cc,Ib,
Mb,Oa,Aa,Ba,ob,xb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Va={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},bb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
ra={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Qa={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:xb,OpenDocumentOptions:Va,OpenDocumentFailureType:bb,OpenDocumentControl:ra,OfficeApplication:Qa,EditDocumentInClient:ka,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=Qa.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ma,
IsO14MacPluginInstalled:ab,OfferOfficeInDialog:function(){return d()&&11>=ma()},OfferOfficeNoIntrusive:function(){return d()&&15>ma()},OfferMacOffice:function(){return m()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ab()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:Pa}}):G(eb,null,null)},CanUseRoamingControl:function(){var qb,Wa,ta;if(l())return!0;if(x())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return qb=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(qb),Wa=document.createEvent("Events"),Wa.initEvent("RoamingOfficeInstalled",!0,!1),qb.dispatchEvent(Wa),!!qb.getAttribute("installed");if(n())try{return ta=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ta.HrExists()}catch(ib){}return!1},InitUrls:function(qb,Wa,ta){rb=qb;Pa=ta;eb=Wa},LaunchRoamingApps:function(qb,Wa,ta,ib,Bb,Ub){c.jfb.cig(qb,Wa,S(ta),ib,"x86",rb,Bb,Ub)},LaunchRoamingApps2:function(qb,
Wa,ta,ib,Bb,Ub,Ta,mb){var Qb="",Lb;if(null!=ib&&(Qb+=" "+ib),null!=qb&&(Qb+=' "'+qb+'"'),l()||x())cc=Ta,Ib=mb,Ta='office: "'+(Ub+'" "')+(ta+'" "ROAMING"'),Ta+=' "'+Wa+'"',Ta+=' "'+Bb+'"',Ta+=" "+Qb,A(Ta,R,M,!1,!1);else if(r())qb=document.createElement("RoamingExtensionElement"),qb.setAttribute("cabUrl",Ub),qb.setAttribute("app",ta),qb.setAttribute("licensingEntitlements",Wa),qb.setAttribute("platform",Bb),qb.setAttribute("args",Qb),document.documentElement.appendChild(qb),Wa=document.createEvent("Events"),
Wa.initEvent("RoamingOfficeLaunch",!0,!1),qb.dispatchEvent(Wa),null!=Ta&&Ta(ra.RoamingFFExtension);else if(n()){if(Lb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Lb)try{Lb.HrConfigureSingle(Ub,ta,Wa,Bb,Qb),null!=Ta&&Ta(ra.RoamingActiveX)}catch(Jb){}}else null!=mb&&mb(bb.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:K,OpenDocumentWithProtocolHandler:H,OpenDocumentWithProtocolHandlerNoCallBack:function(qb,Wa,ta,ib){var Bb=fa(qb),Ub;return null==
Bb?(wa(Mb.DescriptiveUnattemptedEnums?bb.ProtocolHandlerNoCallbackIsNull:bb.Unattempted,Mb.Application),!1):(Ub=E(qb,Wa,ta,ib,Bb),A(Ub,null,null,!1,!1),!0)}}}();c.ClientUtils=c.jfb},1058:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);var c=a(39);class b{constructor(d,f){this._url=d;this.Hsg=f}ere(){}m5c(){this.Hsg?c.a.downloadFile(this._url):c.a.Ve(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(t.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,
[176,3])},1059:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1060:function(t,D,a){a.d(D,"a",function(){return e});t=a(0);var c=a(1186),b=a(4),d=a(53),f=a(82);class e{constructor(k,l,m,v,n,w){this.hX=k;this.iX=l;this.gIc=m;this.QD=v;this.uQb=n;this.XTa=w}get p2f(){return!this.iX&&!this.gIc}get Urf(){return 2===this.XTa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get GKe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get R7e(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get ova(){return CommonUIStrings.l_OICErrorHelpLink}get t6e(){return"OICFailure"}get icon(){return 3}get sWb(){return 2===
this.XTa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Il(){return CommonUIStrings.l_DefaultDialogTitle}i4i(k){this.psf(k)}Tqi(k){this.psf(k)}psf(k){let l=10;1===k?(f.a.instance.resolve("Common.IOfficeTrialExperience").Qhc(this.XTa),l=3):2===k&&((!this.gIc||this.gIc(this.QD))&&this.iX&&c.a.instance.t7g(this.iX,this.hX,this.QD),l=5);(0===k||1===k)&&this.hX&&this.hX(this.QD);b.AFrameworkApplication.Frc(d.a.RDf,this.uQb,l);this.dispose()}dispose(){this.QD=
this.iX=this.hX=null}}Object(t.a)(e,"AOICErrorDialogWithTrial",null,[3])},1061:function(t,D,a){a.d(D,"a",function(){return e});t=a(0);var c=a(1347),b=a(4),d=a(41),f=a(80);class e{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}tMd(){return d.c([this.W$(),this])}execute(k,l,m){let v="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=f.a.Fl(v,"wdEnableRoaming","1"));b.AFrameworkApplication.rd.hm(v,2,this.tMd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.avb(),k,l,m,void 0,void 0,void 0,void 0,"6")}}Object(t.a)(e,"ARoamingAppsRequest",null,[])},1062:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1063:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1064:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1070:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);var c=a(15);class b{constructor(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.Uhi=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.iSa=(d.DirectPrintSupportedMimeTypes||
"").split(b.R4c);this.jSa=(d.DirectPrintSupportedPlugins||"").split(b.R4c);this.n7h=(d.DirectPrintImmersivePreviewPlugins||"").split(b.R4c);this.Ebf=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.Iei=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.EWg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.bvd=14;this.fpf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){const f=d.split(".");2===f.length?(this.bvd=parseInt(f[0]),this.fpf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.R4c=",";Object(t.a)(b,"DirectPrintBrsSettings",null,[])},1071:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(t.a)(c,"PrintPreviewPaneProps",null,[])},1072:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.A_i="PrintDialogBody";c.printDialogTitle="PrintDialogTitle";c.E6b="ewa-dlg-elements-container-rtl";c.B_i="PrintDialogLeftContainer";c.C_i="PrintDialogRightContainer";c.y$a="PrintDialogRadioButtonContainer";c.SHf="PrintRadioButtonElementInnerDiv";c.I_i="PrintRadioButtonElementOuterDiv";c.z$a="PrintDialogTitleSection";
c.KDd="PrintDialogComboBoxContainer";c.J_i="PrintRadioButtonIcon";c.z_i="PrintButtonArea";c.Hw="PrintPreviewerContainer";Object(t.a)(c,"CssClassNames",null,[])},1134:function(t,D,a){var c=a(10),b=a(0),d=a(15),f=a(4),e=a(1330),k=a(690),l=a(50),m=a(37),v=a(1),n=a(64),w=a(42),r=a(181),u=a(14),x=a(21),z=a(369),B=a(569),y=a(27),A=a(865),K=a(12);class G extends A.a{constructor(bc,ic,Yc,md,id,xd=!1){super(bc,ic,Yc,xd);this.ew=null;this.Mm=md;this.NPb=id}get Jd(){return this.NPb}setFocus(){this.ew.checked?
K.DOMElementExtensions.setFocus(this.ew):K.DOMElementExtensions.setFocus(this.getButton(0).get_element())}}G.H3b="printCurrentSelection";Object(b.a)(G,"BasePrintDialog",A.a,[]);var T=a(117),W=a(5),P=a(208),E=a(121),H=a(11),F=a(230),N=a(62);const J=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(1,Lc);Lc.printOptions=ic;return N.g(bc,"ValidatePrint",Lc,Yc,md,id,xd,0)},R=(bc,ic,Yc,md,id,xd,Lc,Pb=null)=>{Pb=bc.Na(9,Pb);Pb.sheetName=ic;Pb.printSettings=Yc;return N.g(bc,"SetSheetPrintSettings",Pb,md,id,xd,Lc,0)},
M=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(1,Lc);Lc.ConvertInParameters=ic;return N.g(bc,"ConvertWorkbookToPrintPdf",Lc,Yc,md,id,xd,4)},L=(bc,ic,Yc,md,id,xd,Lc,Pb=null)=>{Pb=bc.Na(1,Pb);Pb.sheetName=ic;Pb.printOptions=Yc;return N.g(bc,"SetPrintOptions",Pb,md,id,xd,Lc,0)},U=(bc,ic,Yc,md,id,xd,Lc,Pb=null)=>{Pb=bc.Na(1,Pb);Pb.sheetName=ic;Pb.locale=Yc;return N.g(bc,"GetPrintSettings",Pb,md,id,xd,Lc,4)},X=(bc,ic,Yc,md,id,xd,Lc,Pb=null)=>{Pb=bc.Na(1,Pb);Pb.selectedRanges=ic;Pb.addToPrintArea=Yc;return N.g(bc,
"SetPrintArea",Pb,md,id,xd,Lc,0)},da=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(1,Lc);Lc.sheetName=ic;return N.g(bc,"ClearPrintArea",Lc,Yc,md,id,xd,0)},fa=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(9,Lc);Lc.sheetCell=ic;return N.g(bc,"InsertPageBreak",Lc,Yc,md,id,xd,0)},S=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(9,Lc);Lc.sheetCell=ic;return N.g(bc,"RemovePageBreak",Lc,Yc,md,id,xd,0)},ka=(bc,ic,Yc,md,id,xd,Lc=null)=>{Lc=bc.Na(9,Lc);Lc.sheetName=ic;return N.g(bc,"ResetAllPageBreaks",Lc,Yc,md,id,xd,0)};class V extends G{constructor(bc,
ic,Yc,md,id){super(bc,ic,Yc,md,id);this.fsb=null}get oc(){return"HtmlPrintDialog"}initialize(){d.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.a$h();this.bmb(1216);this.addButton(1);super.initialize()}Cga(){return(bc,ic,Yc)=>J(this.$.pa.va,this.Mm,this.Cia(bc),this.U$(ic),Yc,this.Jd)}commit(){this.b_g();return!0}fy(bc,ic,Yc){var md;const id=bc.Result;if(id&&ic){let xd=0,Lc=0;(null===(md=id.SelectedRanges)||void 0===md?0:md.Ranges)&&0<id.SelectedRanges.Ranges.length&&
id.SelectedRanges.Ranges[0]&&(xd=Math.min(V.i0f(id.SelectedRanges.Ranges[0]),65535));id.UsedRange&&(Lc=Math.min(V.i0f(w.j(w.D(id.UsedRange))),65535));F.h(ic,xd);F.i(ic,Lc)}this.Mm=id;super.fy(bc,ic,Yc)}setFocus(){this.fsb.checked?K.DOMElementExtensions.setFocus(this.fsb):super.setFocus()}a$h(){this.Jb.innerHTML=V.EZi(this.$.ea.isNamedObjectViewMode);this.ew=K.DOMElementExtensions.getElementById(this.Jb,G.H3b);this.fsb=K.DOMElementExtensions.getElementById(this.Jb,"printEntireItem");0!==this.Mm.Type&&
this.Mm.UseSelection?(this.ew.checked=!0,this.fsb.disabled=!this.Mm.SheetName):(this.fsb.checked=!0,this.ew.disabled=0===this.Mm.Type||!x.g(this.$).ha.sa.xg)}b_g(){d.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");const bc=new Sys.StringBuilder;this.kFh(bc);H.HelperMethods.Ve(bc.toString(),"",`location=0,scrollbars=1,resizable=1,menubar=1,toolbar=${y.a.Tf?0:1},status=0`,"PrintDialog.PrintViewUrl")||d.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")}kFh(bc){const ic=
this.$.ya;bc.append(this.$.dda+ic.LayoutsRelativeUri+"/xlprintview.aspx?");P.a.Yg(bc,W.a.e1i,this.Mm.SessionId);P.a.Yg(bc,W.a.g1i,this.ew.checked?"1":"0");if(0===this.Mm.Type)P.a.Yg(bc,W.a.b1i,this.Mm.ObjectId);else{if(!this.Mm.UsedRangeTooBig){var Yc=w.D(this.Mm.UsedRange);(Yc=w.x(Yc,this.Mm.SheetName))&&P.a.Yg(bc,W.a.h1i,Yc)}1===this.Mm.Type?P.a.Yg(bc,W.a.c1i,this.Mm.ObjectId):(Yc=w.B(this.Mm.SelectedRanges.Ranges[0]),Yc=w.x(Yc,this.Mm.SheetName),P.a.Yg(bc,W.a.d1i,Yc))}E.a.vYa(bc,ic);P.a.Yg(bc,
W.a.f1i,this.Mm.Title)}static EZi(bc){return String.format("<div class='"+T.a.Nn+"'>{0}</div>\r\n\t<div class='"+T.a.D6b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",u.a.instance.ga(1217),G.H3b,u.a.instance.ga(1220),"printEntireItem",bc?u.a.instance.ga(1219):u.a.instance.ga(1218))}static i0f(bc){return(bc.LastColumn-bc.FirstColumn+1)*(bc.LastRow-bc.FirstRow+
1)}}Object(b.a)(V,"HtmlPrintDialog",G,[]);var wa=a(171),ma=a(549),ab=a(13),ba=a(8),Ca=a(67),Na=a(1072),za=a(764),la=a(58),aa=a(170),sa=a(290),ea=a(862),Z=a(210),ua=a(723),ya=a(31),ha=a(22),Da=a(280);class nb{constructor(bc,ic){this.printSettings=this.sheetName=null;this.sheetName=bc;this.printSettings=ic}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(nb,"MacroRecorderSheetPrintSettingsSavedPayload",null,[116]);var qa=a(151),pa=a(55);class Ja extends G{constructor(bc,
ic,Yc,md,id,xd,Lc,Pb){super(bc,ic,Yc,md,id,v.EwaSettings.ma(395));this.Ecc=this.x$=this.mca=null;this.LRd=!1;this.H4a=this.wza=this.nya=this.j$a=this.Lwa=null;this.Qla=this.Fya=1;this.k_=0;this.U5=1;this.VFb=!1;this.hs=null;this.PIb=this.QIb=0;this.selectedRange=this.xza=this.oya=null;this.l_=0;this.N8a=()=>{this.l_++;this.U5=this.MXc();this.o6c(this.x$.checked?!0:!1);this.K6&&(this.Ecc.disabled=this.ew.checked);this.bNd(this.x$.checked?!0:!1);d.ULS.sendTraceTag(595194762,0,50,`PdfPrintDialog:OnChangeWhatToPrint What to print option changed to ${this.U5.toString()}`);
return!0};this.Jtf=()=>{this.l_++;this.VFb=this.H4a.checked;d.ULS.sendTraceTag(537154311,0,50,`PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to ${this.VFb.toString()}`)};this.alc=()=>{this.l_++;this.Fya=this.sue();d.ULS.sendTraceTag(595079450,0,50,`PdfPrintDialog:OnChangeOrienation orientation option changed to ${this.Fya.toString()}`);return!0};this.Ktf=()=>{this.l_++;const Gc=this.Qla;this.Qla=Ja.paperSizeOptions[this.nya.selectedIndex];d.ULS.sendTraceTag(595079449,0,
50,`PdfPrintDialog:OnChangePaperSize paperSize option changed from ${Gc.toString()} to ${this.Qla.toString()}`);return!0};this.Ltf=()=>{this.l_++;const Gc=this.k_;this.k_=Ja.scalingOptions[this.wza.selectedIndex];2===this.k_?(this.QIb=1,this.PIb=0):3===this.k_?(this.QIb=0,this.PIb=1):1===this.k_&&(this.PIb=this.QIb=1);d.ULS.sendTraceTag(595079448,0,50,`PdfPrintDialog:OnChangeScaling scaling option changed from ${Gc.toString()} to ${this.k_.toString()}`);return!0};this.Iyd=Gc=>{let Nb;Gc&&Gc.data&&
Gc.data.Td&&Gc.data.responseHeaders&&Gc.data.Td.length?(Gc.data.responseHeaders["Content-Type"]&&ha.a.contains(Gc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)?(d.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully"),Nb={},this.rDb(Nb,null,null)):(Nb=la.a.Uh(Gc.data.Td),d.ULS.sendTraceTag(51676165,0,15,`PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${Nb.Errors[0].MessageId}`)),
Gc=Gc.data.state,Gc.L7c(Nb,Gc.userContext,Gc.methodName)):d.ULS.sendTraceTag(51676163,0,10,`PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : ${Gc?Gc.data?Gc.data.Td?Gc.data.responseHeaders?Gc.data.Td.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs"}`)};this.Hyd=Gc=>{var Nb=E.a.kf(Gc.data);d.ULS.sendTraceTag(51676166,
0,15,`PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [${ya.a.zc(Nb)}]`);Nb=Gc.data.state;Nb.F$(Gc,Nb.userContext,Nb.methodName)};this.rDb=Gc=>{Gc.Errors&&0<Gc.Errors.length?d.ULS.sendTraceTag(51499295,0,50,`PdfPrintDialog: Failed to convert workbook. Error message Id: ${Gc.Errors[0].MessageId}`):(6===this.Jd.Re&&f.AFrameworkApplication.ta.Ee.Rj(x.g(this.$).jVf),d.ULS.shipAssertTag(537154309,0,!!this.$.xa.oa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),
this.$.xa.oa&&this.xha.S2f(this.VGa()))};this.xha=xd;this.activeCell=this.$.oa.activeCell.toString();this.Mm.SelectedRanges&&this.Mm.SelectedRanges.Ranges&&0<this.Mm.SelectedRanges.Ranges.length&&this.Mm.SelectedRanges.Ranges[0]&&(this.selectedRange=w.B(this.Mm.SelectedRanges.Ranges[0]).toString());this.sheetName=Lc;this.DN=Pb;this.uBd={};for(let Gc=0,Nb=Ja.paperSizeOptions.length;Gc<Nb;++Gc)this.uBd[Ja.paperSizeOptions[Gc].toString()]=Gc;this.locale=window.navigator.browserLanguage||window.navigator.language||
this.$.ya.UICultureTag;this.K6=v.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog")}get oc(){return"PdfPrintDialog"}initialize(){this.K6&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&Ja.s6g(this.Jb);this.Ge?this.Wze(1016,null):(this.Nl(),this.bmb(1016));super.initialize()}dispose(){this.KNj();super.dispose()}close(bc){d.ULS.sendTraceTag(591196544,0,50,`PdfPrintDialog.Close: User changed printSettings ${this.l_} times before exiting dialog ${0===
bc?"with":"without"} printing done`);this.hjj();if(this.hs){const ic=this.OKh();!this.LRd&&!this.x$.checked&&this.$.isEditMode&&this.lhd(ic)&&this.Xij(ic)}super.close(bc)}Cga(){return(bc,ic,Yc)=>U(this.$.pa.va,this.$.xa.oa.name,this.locale,this.Cia(bc),this.U$(ic),Yc,null)}fy(bc,ic,Yc){this.hs=bc.Result;this.QIb=this.hs.ScalingWidth;this.PIb=this.hs.ScalingHeight;this.l$c();this.I9h();super.fy(bc,ic,Yc)}Nl(){d.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");
this.b$h();super.Nl()}commit(){this.a_g();return!0}setFocus(){this.Ge?Z.a.gzc(this.mca):this.mca.checked?K.DOMElementExtensions.setFocus(this.mca):super.setFocus()}tai(){switch(this.DN.Cu){case 1:this.mca.checked=!0;break;case 0:this.ew.disabled?this.mca.checked=!0:this.ew.checked=!0;break;case 2:this.x$.checked=!0;break;default:d.ULS.sendTraceTag(537154314,0,10,`Invalid what to print state ${this.DN.Cu}. Resetting to defaults.`),this.DN.Cu=1,this.mca.checked=!0}}hjj(){this.DN.Cu=this.MXc();this.K6&&
(this.DN.ignorePrintArea=this.H4a.checked)}l$c(){if(100!==this.hs.ScalingPercent||this.hs.FitToPage&&(1<this.hs.ScalingWidth||1<this.hs.ScalingHeight))this.LRd=!0,this.hs.ScalingWidth=Ja.p4c,this.hs.ScalingHeight=Ja.o4c,this.hs.ScalingPercent=Ja.o4b,this.hs.FitToPage=Ja.i4c;this.hs.PaperSize.toString()in this.uBd||(this.LRd=!0,this.hs.PaperSize=this.hs.PaperSize===Ja.LMg?34:Ja.brb)}I9h(){this.Fya=this.hs.IsLandscape?2:1;this.k_=this.hs.FitToPage?1===this.hs.ScalingWidth&&1===this.hs.ScalingHeight?
1:this.hs.ScalingWidth||1!==this.hs.ScalingHeight?2:3:0;this.Qla=this.hs.PaperSize;this.o6c(this.x$.checked?!0:!1);this.bNd(this.x$.checked?!0:!1)}o$h(){this.Ecc.disabled=this.ew.checked;this.VFb=this.H4a.checked=this.DN.ignorePrintArea}Y8g(bc){this.xza=document.createElement("select");this.xza.style.width=224+Ca.a.af;this.xza.style.height=32+Ca.a.af;this.xza.setAttribute(W.a.pE,"scalingElementId");this.wza=new ua.a(this.xza,!0);for(let ic=0,Yc=Ja.scalingOptions.length;ic<Yc;++ic){const md=u.a.instance.ga(Ja.Gjj[ic]);
this.wza.XL(md,Ja.scalingOptions[ic].toString(),!1)}bc.appendChild(this.xza)}eDe(bc){this.oya=document.createElement("select");this.oya.style.width=224+Ca.a.af;this.oya.style.height=32+Ca.a.af;this.oya.setAttribute(W.a.pE,"paperSizeElementId");this.nya=new ua.a(this.oya,!0);for(let ic=0,Yc=Ja.paperSizeOptions.length;ic<Yc;++ic){const md=u.a.instance.ga(Ja.mVi[ic]);this.nya.XL(md,Ja.paperSizeOptions[ic].toString(),!1)}bc.appendChild(this.oya)}OKh(){const bc={};bc.IsLandscape=2===this.Fya;bc.PaperSize=
this.Qla;bc.ScalingWidth=this.QIb;bc.ScalingHeight=this.PIb;bc.ScalingPercent=100;bc.FitToPage=0===this.k_?!1:!0;return bc}VGa(){const bc=new Sys.StringBuilder;bc.append(ea.a(this.$,"Pdf",!0));this.xha.Qvc()&&P.a.Yg(bc,ba.a.Edg,"1");P.a.Yg(bc,ba.a.CEd,""+this.U5);P.a.Yg(bc,ba.a.jJf,this.$.xa.oa.name);0===this.U5&&(P.a.Yg(bc,ba.a.iJf,this.selectedRange),P.a.Yg(bc,ba.a.cJf,this.activeCell));P.a.Yg(bc,ba.a.dJf,""+this.Fya);P.a.Yg(bc,ba.a.eJf,""+this.Qla);P.a.Yg(bc,ba.a.hJf,""+this.k_);P.a.Yg(bc,ba.a.gJf,
"1");P.a.Yg(bc,ba.a.bJf,this.VFb?"1":"0");P.a.Yg(bc,ba.a.fJf,"1");d.ULS.sendTraceTag(51499296,0,50,`PdfPrintDialog: Print Pdf Url ${bc.toString()}`);return bc.toString()}sxb(){let bc=null;d.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Ub(new aa.a(223,0,(ic,Yc,md)=>{ic=new sa.a(ic,null,Yc,md,null,!0,!1,"GetFileCopyFileHandler","");ic.correlationID=wa.a.create().toString();bc=ic;f.AFrameworkApplication.rd.O8(this.VGa(),
1,null,null,Ja.z9c,!1,2,this.Iyd,this.Hyd,bc,void 0,void 0,void 0,12E4);return pa.Task.Ua(!0)},16),null)}b$h(){d.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.DZi(this.Jb);this.o6c(!0);this.bNd(!0);this.ew=K.DOMElementExtensions.getElementById(this.Jb,G.H3b);this.mca=K.DOMElementExtensions.getElementById(this.Jb,"printActiveSheet");this.x$=K.DOMElementExtensions.getElementById(this.Jb,"printEntireWorkbook");this.K6&&(this.Ecc=K.DOMElementExtensions.getElementById(this.Jb,
"ignorePrintAreaCheckboxButtonId"),this.H4a=new za.a(this.Ecc));this.svc()&&(this.ew.disabled=!0,this.Mm.SheetName=this.sheetName);this.tai();this.K6&&this.o$h();this.D7i()}svc(){return!!this.Mm.ObjectId||!x.g(this.$).ha.sa.xg}D7i(){ma.a.instance.ra(ab.a.change,this.mca,this.N8a);ma.a.instance.ra(ab.a.change,this.x$,this.N8a);ma.a.instance.ra(ab.a.change,this.ew,this.N8a);ma.a.instance.ra(ab.a.change,this.Lwa,this.alc);ma.a.instance.ra(ab.a.change,this.j$a,this.alc);ma.a.instance.ra(ab.a.change,this.oya,
this.Ktf);ma.a.instance.ra(ab.a.change,this.xza,this.Ltf);this.K6&&this.H4a.jmb(this.Jtf)}KNj(){ma.a.instance.Ba(ab.a.change,this.mca,this.N8a);ma.a.instance.Ba(ab.a.change,this.x$,this.N8a);ma.a.instance.Ba(ab.a.change,this.ew,this.N8a);ma.a.instance.Ba(ab.a.change,this.Lwa,this.alc);ma.a.instance.Ba(ab.a.change,this.j$a,this.alc);ma.a.instance.Ba(ab.a.change,this.oya,this.Ktf);ma.a.instance.Ba(ab.a.change,this.xza,this.Ltf);this.K6&&this.H4a.Dca(this.Jtf)}DZi(bc){bc.classList.add(Na.a.A_i);if(!this.Ge){document.getElementById("ewaDialogTitle").classList.add(Na.a.printDialogTitle);
var ic=document.getElementById("ewaDialogCloseButtonLink");ic.style.top=32+Ca.a.af;this.rtl?ic.style.left=32+Ca.a.af:ic.style.right=32+Ca.a.af}ic=Ja.ez(Na.a.B_i);bc.appendChild(ic);var Yc=Ja.ez(Na.a.z$a,1224);Yc.style.marginBottom=12+Ca.a.af;Yc.id="whatToPrintTitleElementId";ic.appendChild(Yc);Yc=Ja.ez(Na.a.y$a);ic.appendChild(Yc);Ja.vqb(Yc,this.rtl,"printActiveSheet",1228,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
ic.appendChild(document.createElement("BR"));Yc=Ja.ez(Na.a.y$a);ic.appendChild(Yc);Ja.vqb(Yc,this.rtl,"printEntireWorkbook",1221,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");ic.appendChild(document.createElement("BR"));Yc=Ja.ez(Na.a.y$a);ic.appendChild(Yc);Ja.vqb(Yc,this.rtl,G.H3b,1220,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
this.K6?(Yc=Ja.ez(Na.a.z$a,1253),Yc.style.marginTop=24+Ca.a.af,Yc.id="printAreaElementId",ic.appendChild(Yc),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Yc.style.marginBottom=12+Ca.a.af,Yc=Ja.ez(T.a.v7c),Yc.id="ignorePrintAreaCheckboxWarpperId",K.DOMElementExtensions.setVisible(Yc,!0),ic.appendChild(Yc),ic=this.getElementById("ignorePrintAreaCheckboxButtonId"),K.DOMElementExtensions.setVisible(ic,!0),Yc.appendChild(ic),ic=this.getElementById("ignorePrintAreaCheckboxLabelId"),
K.DOMElementExtensions.setVisible(ic,!0),Yc.appendChild(ic)):(Yc=Ja.ez(Na.a.y$a),ic.appendChild(Yc),Ja.k4g(Yc,this.rtl))):(Yc=Ja.ez(Na.a.z$a,1226),Yc.style.marginTop=24+Ca.a.af,Yc.id="paperSizeElementId",ic.appendChild(Yc),Yc=Ja.ez(Na.a.KDd),this.eDe(Yc),ic.appendChild(Yc));ic=Ja.ez(Na.a.C_i);bc.appendChild(ic);bc=Ja.ez(Na.a.z$a,1225);bc.style.marginBottom=12+Ca.a.af;bc.id="orientationTitleElementId";ic.appendChild(bc);bc=Ja.ez(Na.a.y$a);ic.appendChild(bc);Ja.vqb(bc,this.rtl,"portraitRadioButtonId",
1231,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");ic.appendChild(document.createElement("BR"));bc=Ja.ez(Na.a.y$a);ic.appendChild(bc);Ja.vqb(bc,this.rtl,"landscapeRadioButtonId",1230,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.K6&&(bc=Ja.ez(Na.a.z$a,1226),bc.style.marginTop=12+Ca.a.af,bc.id="paperSizeElementId",ic.appendChild(bc),bc=Ja.ez(Na.a.KDd),this.eDe(bc),
ic.appendChild(bc));bc=Ja.ez(Na.a.z$a,1227);bc.style.marginTop=(this.K6?10:74)+Ca.a.af;bc.id="scalingElementId";ic.appendChild(bc);bc=Ja.ez(Na.a.KDd);this.Y8g(bc);ic.appendChild(bc);this.Ge||document.getElementById("buttonarea").classList.add(Na.a.z_i);this.Lwa=K.DOMElementExtensions.getElementById(this.Jb,"landscapeRadioButtonId");this.j$a=K.DOMElementExtensions.getElementById(this.Jb,"portraitRadioButtonId")}a_g(){d.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");
this.U5=this.MXc();2!==this.U5&&(this.Fya=this.sue(),this.nya&&(this.Qla=Ja.paperSizeOptions[this.nya.selectedIndex]),this.wza&&(this.k_=Ja.scalingOptions[this.wza.selectedIndex]));if(this.$.Vva&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){const bc=this.$.pa.va.Qb();this.$.userOperationManager.Ub(new aa.a(133,0,(ic,Yc,md)=>{const id={};id.WhatToPrint=this.U5;id.UseNamedAction=this.xha.Qvc();id.SelectedSheetName=this.$.xa.oa.name;id.ActiveCell=
this.activeCell;id.SelectedRanges=[this.selectedRange];id.IsPdfDocumentRequired=!1;id.Orientation=this.Fya;id.PaperSize=this.Qla;id.Scaling=this.k_;id.RichValuesEnabled=!0;this.K6&&(id.IgnorePrintArea=this.VFb);return M(this.$.pa.va,id,Da.b(this.rDb,ic),Yc,md,bc)},16),null)}else this.sxb()}o6c(bc){this.j$a.disabled=bc;this.Lwa.disabled=bc;this.nya.Vp.disabled=bc;this.wza.Vp.disabled=bc}bNd(bc){bc?(this.Lwa.checked=!1,this.j$a.checked=!1,this.nya.selectedIndex=-1,this.wza.selectedIndex=-1):(2===this.Fya?
this.Lwa.checked=!0:this.j$a.checked=!0,this.nya.selectedIndex=this.uBd[this.Qla.toString()],this.wza.selectedIndex=this.k_)}Xij(bc){d.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");const ic=this.$.xa.oa.name,Yc=this.$.pa.va.Qb();this.$.userOperationManager.Ub(new aa.a(226,0,(md,id,xd)=>R(this.$.pa.va,ic,bc,md,id,xd,Yc),void 0,()=>new nb(ic,bc)),null)}lhd(bc){return this.hs.IsLandscape!==bc.IsLandscape||
this.hs.PaperSize!==bc.PaperSize||this.hs.FitToPage!==bc.FitToPage||this.hs.ScalingHeight!==bc.ScalingHeight||this.hs.ScalingWidth!==bc.ScalingWidth?!0:!1}sue(){return this.Lwa&&this.Lwa.checked?2:1}MXc(){return this.ew.checked?0:this.mca.checked?1:this.x$.checked?2:1}static ez(bc=null,ic=0){const Yc=document.createElement("div");bc&&(Yc.className=bc);0!==ic&&(Yc.innerHTML=u.a.instance.ga(ic));return Yc}static s6g(bc){var ic=document.createElement("input");ic.setAttribute("type","checkbox");ic.className=
T.a.vLe;ic.id="ignorePrintAreaCheckboxButtonId";ic.setAttribute("name","ignorePrintAreaCbName");ic.style.height=16+Ca.a.af;ic.style.width=16+Ca.a.af;K.DOMElementExtensions.setVisible(ic,!1);const Yc=u.a.instance.ga(1253),md=u.a.instance.ga(1254);ic.setAttribute(W.a.Nt,Yc+Ca.a.space+md);bc.appendChild(ic);ic=document.createElement("label");ic.setAttribute("for","ignorePrintAreaCheckboxButtonId");ic.id="ignorePrintAreaCheckboxLabelId";ic.innerHTML=md;ic.setAttribute(W.a.gP,"true");ic.style.position=
"relative";ic.style.marginLeft=15+Ca.a.af;K.DOMElementExtensions.setVisible(ic,!1);bc.appendChild(ic)}static k4g(bc,ic){const Yc=document.createElement("input");Yc.setAttribute("type","checkbox");Yc.id="ignorePrintAreaCheckboxButtonId";Yc.setAttribute("name","ignorePrintAreaCbName");Yc.setAttribute(W.a.pE,"printAreaElementId"+Ca.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Yc.style.height=16+Ca.a.af;Yc.style.width=16+Ca.a.af;ic?Yc.style.marginRight=0+Ca.a.af:Yc.style.marginLeft=0+Ca.a.af;
bc.appendChild(Yc);ic=document.createElement("label");ic.setAttribute("for","ignorePrintAreaCheckboxButtonId");ic.setAttribute(W.a.gP,"true");ic.style.position="relative";ic.style.marginLeft=15+Ca.a.af;bc.appendChild(ic);bc=Ja.ez(Na.a.SHf,1254);bc.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";ic.appendChild(bc)}static vqb(bc,ic,Yc,md,id,xd,Lc,Pb){const Gc=document.createElement("input");Gc.setAttribute("type","radio");Gc.id=Yc;Gc.setAttribute("name",id);Gc.setAttribute(W.a.pE,Pb+Ca.a.space+
Lc);Gc.style.height=16+Ca.a.af;Gc.style.width=16+Ca.a.af;ic?Gc.style.marginRight=0+Ca.a.af:Gc.style.marginLeft=0+Ca.a.af;bc.appendChild(Gc);ic=document.createElement("label");ic.setAttribute("for",Yc);ic.style.position="relative";bc.appendChild(ic);bc=qa.createClusteredImage(32,32,xd,Na.a.J_i,!0,u.a.instance.ga(md));md=Ja.ez(Na.a.SHf,md);md.id=Lc;md.setAttribute(W.a.gP,"true");Lc=Ja.ez(Na.a.I_i);Lc.appendChild(md);ic.appendChild(Lc);ic.appendChild(bc)}}Ja.p4c=1;Ja.o4c=0;Ja.o4b=100;Ja.brb=9;Ja.i4c=
!0;Ja.LMg=13;Ja.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];Ja.mVi=[1233,1234,1241,1235,1236,1237,1238,1239,1232,1242,1243,1244,1245,1246,1247,1248];Ja.scalingOptions=[0,1,2,3];Ja.Gjj=[1249,1250,1251,1252];Ja.z9c=["Content-Type"];Object(b.a)(Ja,"PdfPrintDialog",G,[]);class $a{constructor(bc,ic){this.U5=0;this.F6d=!1;this.Cu=bc;this.ignorePrintArea=ic}get Cu(){return this.U5}set Cu(bc){0<=bc&&2>=bc?this.U5=bc:(d.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.U5=1)}get ignorePrintArea(){return this.F6d}set ignorePrintArea(bc){bc||!bc?this.F6d=bc:d.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)($a,"PdfPrintDialogBrowserSessionState",null,[]);var rb=a(7),Pa=a(133),eb=a(98),Ob=a(1385);class tb{constructor(bc,ic){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=bc;this.addToPrintArea=ic}}Object(b.a)(tb,"MacroRecorderPrintAreaSetPayload",null,[116]);var cc=a(510),Ib=a(368),Mb=a(74);class Oa{constructor(bc){this.sharedSheetCell=
null;this.sharedSheetCell=bc}}Object(b.a)(Oa,"MacroRecorderPageBreakInsertedPayload",null,[116]);class Aa{constructor(bc){this.sharedSheetCell=null;this.sharedSheetCell=bc}}Object(b.a)(Aa,"MacroRecorderPageBreakRemovedPayload",null,[116]);class Ba{constructor(bc){this.sheetName=null;this.sheetName=bc}getSheetName(){return this.sheetName}}Object(b.a)(Ba,"MacroRecorderPageBreaksAllResetPayload",null,[116]);class ob{constructor(bc){this.sheetName=null;this.sheetName=bc}getSheetName(){return this.sheetName}}
Object(b.a)(ob,"MacroRecorderPrintAreaClearedPayload",null,[116]);var xb=a(125),Va=a(111),bb=a(51),ra=a(185);class Qa{constructor(){this.Col=this.Row=null}}Object(b.a)(Qa,"PageBreaksInformation",null,[]);class qb{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(qb,"RowColBreak",null,[]);class Wa{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(Wa,"SharedRange",null,[]);var ta=a(164);class ib{constructor(bc){this.ribbonCommandInfo=this.FEb=null;this.rLj=
(ic,Yc,md)=>{Yc=!!ic&&!!ic.RequestTelemetryData;x.g(this.$).Ci&&x.g(this.$).Ci.Cka(this.WJa.na(this.ribbonCommandInfo.command),ic.StateId,Yc?ic.RequestTelemetryData.EcsOperationDuration:0,Yc?ic.RequestTelemetryData.EcsRequestDuration:0,Yc?ic.RequestTelemetryData.WfeRequestDuration:0);H.HelperMethods.rZ&&this.KVg(md)};this.$=bc;this.WJa=new ta.a;this.ava=new ta.a;this.ava.add(78661008,12);this.ava.add(275604654,13);this.ava.add(-13332329,14);this.ava.add(-837651977,9);this.ava.add(-1778266776,10);
this.ava.add(845325699,11);this.cod=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}executeCommand(bc,ic,Yc,md,id=null,xd=null,Lc=null){this.JVd();this.ribbonCommandInfo=ic;this.vDj(ic.command);bc=Da.b(id,this.rLj);d.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${ic.command} command execution started`);switch(ic.command){case 78661008:return this.M4e(ic,bc,xd,Lc,!1);case 275604654:return this.M4e(ic,bc,xd,Lc,!0);case -13332329:return this.L3e(ic,
bc,xd,Lc);case -837651977:return this.R1h(ic,bc,xd,Lc);case -1778266776:return this.O2h(ic,bc,xd,Lc);case 845325699:return this.H4e(ic,bc,xd,Lc)}return r.a(ic.command)}Ec(bc,ic){switch(ic.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===bc;case 845325699:case -13332329:return!0}return!1}FZf(bc,ic,Yc){const md=x.g(this.$);var id=md.Ea;const xd=w.r(md.ha.sa.selectedRanges,this.$);if((id=id.bF())&&id.length){for(const Lc of id){id=Lc;const Pb=id.sf;if(!Pb)continue;const Gc=
w.j(id.qf),Nb=[];for(const yc of xd.Ranges){if(yc.FirstRow>Gc.LastRow+1||yc.LastRow<Gc.FirstRow||yc.FirstColumn>Gc.LastColumn+1||yc.LastColumn<Gc.FirstColumn)continue;const Tc=this.yTh(Gc,yc,Pb),gd=this.xTh(Gc,yc,Pb);Nb.push(Object(rb.a)(new Wa,{FirstRow:Tc.FirstRow,FirstColumn:gd.FirstColumn,LastRow:Tc.LastRow,LastColumn:gd.LastColumn}))}0<Nb.length&&!Yc?Pb.setPrintArea(Nb):0<Nb.length&&Yc?Pb.addToPrintArea(Nb):!Yc&&Pb.hasPrintArea()&&Pb.clearPrintArea();!Pb.isDirty()&&Pb.hasPageLayout()&&Pb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+
id.Nd,4)}this.QMb(md,bc,ic)}}yXg(bc,ic){const Yc=x.g(this.$);var md=x.g(this.$).Ea.bF();if(md&&md.length){for(const id of md){md=id;const xd=md.sf;xd&&(xd.clearPrintArea(),!xd.isDirty()&&xd.hasPageLayout()&&xd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+md.Nd,4))}this.QMb(Yc,bc,ic)}}abi(bc,ic){const Yc=x.g(this.$);var md=Yc.Ea;const id=w.o(Yc.ha.sa.activeCell,this.$);if(id){var xd=md.bF();if(xd&&xd.length){md=null;for(var Lc of xd){let Pb=Lc,Gc=Pb.sf;if(!Gc)continue;let Nb=
w.j(Pb.qf);if(!(id.FirstRow>Nb.LastRow||id.FirstRow<Nb.FirstRow||id.FirstColumn>Nb.LastColumn||id.FirstColumn<Nb.FirstColumn)&&(md=this.F7g(Gc,Nb,id),Gc.insertPageBreak(md),!Gc.isDirty()&&Gc.hasPageLayout()&&Gc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Pb.Nd,4),md))break}if(!md)for(const Pb of xd)if(md=Pb,Lc=md.sf)md=w.j(md.qf),md=this.dDe(Lc,md,id),Lc.insertPageBreak(md);this.QMb(Yc,bc,ic)}}}a$i(bc,ic){const Yc=x.g(this.$);var md=Yc.Ea;const id=w.o(Yc.ha.sa.activeCell,
this.$);if(id&&(md=md.bF())&&md.length){for(const Lc of md){md=Lc;const Pb=md.sf;if(Pb){var xd=w.j(md.qf);(xd=this.dDe(Pb,xd,id))&&Pb.removePageBreak(xd);!Pb.isDirty()&&Pb.hasPageLayout()&&Pb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+md.Nd,4)}}this.QMb(Yc,bc,ic)}}Qej(bc,ic){const Yc=x.g(this.$);var md=Yc.Ea.bF();if(md&&md.length){for(const id of md){md=id;const xd=md.sf;xd&&(xd.resetAllPageBreak(),!xd.isDirty()&&xd.hasPageLayout()&&xd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+
md.Nd,4))}this.QMb(Yc,bc,ic)}}M4e(bc,ic,Yc,md,id){if(!id){var xd=this.$.yb.getItemByName("PRINT_AREA");if(xd&&(d.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${xd.type}`),2===xd.type))return this.Fci(),pa.Task.Ua(!0)}xd=x.g(this.$).ha.sa;const Lc=w.r(xd.selectedRanges,this.$);if(1===Lc.Ranges.length&&!id){if(xd.aba())return this.d3h(bc,Lc,ic,Yc,md,id),pa.Task.Ua(!0);if(w.R(Lc.Ranges[0]))return this.$.xa.oa.hasPrintArea?
this.L3e(bc,ic,Yc,md):pa.Task.Ua(!0)}this.FZf(bc.command,md,id);return this.P$e(bc,ic,Yc,Lc,id)}L3e(bc,ic,Yc,md){this.yXg(bc.command,md);return this.rci(bc,ic,Yc)}R1h(bc,ic,Yc,md){this.abi(bc.command,md);return this.Cci(bc,ic,Yc)}O2h(bc,ic,Yc,md){const id=w.r(x.g(this.$).ha.sa.selectedRanges,this.$);if(w.R(id.Ranges[0]))return this.H4e(bc,ic,Yc,md);this.a$i(bc.command,md);return this.Gci(bc,ic,Yc)}H4e(bc,ic,Yc,md){this.Qej(bc.command,md);return this.Jci(bc,ic,Yc)}P$e(bc,ic,Yc,md,id){const xd=this.$.pa.va,
Lc=(Gc,Nb,yc)=>X(xd,md,id,Da.b(Gc,ic),Da.a(Nb,Yc),yc,null),Pb=()=>new tb(md,id);return v.EwaSettings.fc()?Ib.a(this.$.userOperationManager,Lc,Gc=>new aa.a(241,0,Gc,64,Pb),bc):Ib.a(this.$.userOperationManager,Lc,Gc=>new cc.a(241,0,Gc,void 0,Pb),bc)}rci(bc,ic,Yc){const md=this.$.xa.oa.name,id=this.$.pa.va,xd=(Pb,Gc,Nb)=>da(id,md,Da.b(Pb,ic),Da.a(Gc,Yc),Nb,null),Lc=()=>new ob(md);return v.EwaSettings.fc()?Ib.a(this.$.userOperationManager,xd,Pb=>new aa.a(243,0,Pb,64,Lc),bc):Ib.a(this.$.userOperationManager,
xd,Pb=>new cc.a(243,0,Pb,void 0,Lc),bc)}Cci(bc,ic,Yc){var md=x.g(this.$);const id=w.o(md.ha.sa.activeCell,this.$);md=(Lc,Pb,Gc)=>fa(this.$.pa.va,id,Da.b(Lc,ic),Da.a(Pb,Yc),Gc,null);const xd=()=>new Oa(id);return v.EwaSettings.fc()?Ib.a(this.$.userOperationManager,md,Lc=>new aa.a(244,0,Lc,64,xd),bc):Ib.a(this.$.userOperationManager,md,Lc=>new cc.a(244,0,Lc,void 0,xd),bc)}Gci(bc,ic,Yc){var md=x.g(this.$);const id=w.o(md.ha.sa.activeCell,this.$);md=(Lc,Pb,Gc)=>S(this.$.pa.va,id,Da.b(Lc,ic),Da.a(Pb,Yc),
Gc,null);const xd=()=>new Aa(id);return v.EwaSettings.fc()?Ib.a(this.$.userOperationManager,md,Lc=>new aa.a(245,0,Lc,64,xd),bc):Ib.a(this.$.userOperationManager,md,Lc=>new cc.a(245,0,Lc,void 0,xd),bc)}Jci(bc,ic,Yc){const md=this.$.xa.oa.name,id=(Lc,Pb,Gc)=>ka(this.$.pa.va,md,Da.b(Lc,ic),Da.a(Pb,Yc),Gc,null),xd=()=>new Ba(md);return v.EwaSettings.fc()?Ib.a(this.$.userOperationManager,id,Lc=>new aa.a(246,0,Lc,64,xd),bc):Ib.a(this.$.userOperationManager,id,Lc=>new cc.a(246,0,Lc,void 0,xd),bc)}yTh(bc,
ic,Yc){if(!bc||!ic||!Yc)return null;const md=new Wa;md.FirstRow=ic.FirstRow===bc.LastRow+1?Yc.getRowIndex(bc.LastRow+1)+1:ic.FirstRow<bc.FirstRow?0:Yc.getRowIndex(ic.FirstRow+1);md.LastRow=ic.FirstRow===bc.LastRow+1||ic.LastRow>bc.LastRow?Yc.getRowIndex(bc.LastRow+1)+1:Yc.getRowIndex(ic.LastRow+1);return md}xTh(bc,ic,Yc){if(!bc||!ic||!Yc)return null;const md=new Wa;md.FirstColumn=ic.FirstColumn===bc.LastColumn+1?Yc.getColumnIndex(bc.LastColumn+1)+1:ic.FirstColumn<bc.FirstColumn?0:Yc.getColumnIndex(ic.FirstColumn+
1);md.LastColumn=ic.FirstColumn===bc.LastColumn+1||ic.LastColumn>bc.LastColumn?Yc.getColumnIndex(bc.LastColumn+1)+1:Yc.getColumnIndex(ic.LastColumn+1);return md}F7g(bc,ic,Yc){if(!ic||!Yc||!bc)return null;const md=bc.getPrintArea();if(!md||!md.length)return null;const id=bc.getRowIndex(Yc.FirstRow+1),xd=bc.getColumnIndex(Yc.FirstColumn+1);let Lc=null,Pb=null;for(const Gc of md)if(id>=Gc.FirstRow&&id<=Gc.LastRow&&xd>=Gc.FirstColumn&&xd<=Gc.LastColumn){if(Yc.FirstRow===Gc.FirstRow&&Yc.FirstColumn===
Gc.FirstColumn)return new Qa;id>Gc.FirstRow&&(Lc=Object(rb.a)(new qb,{Index:id-1,Min:Gc.FirstColumn-1,Max:Math.min(Gc.LastColumn,bc.getColumnIndex(ic.LastColumn+1))}));xd>Gc.FirstColumn&&(Pb=Object(rb.a)(new qb,{Index:xd-1,Min:Gc.FirstRow-1,Max:Math.min(Gc.LastRow,bc.getRowIndex(ic.LastRow+1))}));break}return Lc||Pb?Object(rb.a)(new Qa,{Row:Lc?[Lc]:null,Col:Pb?[Pb]:null}):null}U8g(bc,ic,Yc){if(!ic||!Yc||!bc)return null;let md=null;Yc.FirstRow>ic.FirstRow&&Yc.FirstRow<=ic.LastRow?md=Object(rb.a)(new qb,
{Index:bc.getRowIndex(Yc.FirstRow+1)-1,Min:-1,Max:-1}):Yc.FirstRow===ic.LastRow+1&&(md=Object(rb.a)(new qb,{Index:bc.getRowIndex(ic.LastRow+1),Min:-1,Max:-1}));return md}q4g(bc,ic,Yc){if(!ic||!Yc||!bc)return null;let md=null;Yc.FirstColumn>ic.FirstColumn&&Yc.FirstColumn<=ic.LastColumn?md=Object(rb.a)(new qb,{Index:bc.getColumnIndex(Yc.FirstColumn+1)-1,Min:-1,Max:-1}):Yc.FirstColumn===ic.LastColumn+1&&(md=Object(rb.a)(new qb,{Index:bc.getColumnIndex(ic.LastColumn+1),Min:-1,Max:-1}));return md}dDe(bc,
ic,Yc){if(!Yc||!bc||!ic)return null;const md=this.U8g(bc,ic,Yc);bc=this.q4g(bc,ic,Yc);return md||bc?Object(rb.a)(new Qa,{Row:md?[md]:null,Col:bc?[bc]:null}):null}Fci(){const bc=new Pa.StandardDialog;bc.Sb=0;bc.sc(1,u.a.instance.ga(4));bc.yl(u.a.instance.ga(574),u.a.instance.ga(575),1,null)}vDj(bc){if(this.ava.lb(bc)&&(H.HelperMethods.rZ&&(this.FEb=this.$.Hb.xc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.WJa.lb(bc)&&this.WJa.remove(bc),this.WJa.add(bc,wa.a.create().toString()),x.g(this.$).Ci)){const ic=
bb.b()?bb.b().mj(bc):"";x.g(this.$).Ci.O6(this.ava.na(bc),this.WJa.na(bc),ic)}}KVg(bc){if(this.FEb&&bc){const ic=this.FEb.tc;this.FEb.stop();this.FEb=null;switch(bc){case "SetPrintArea":this.Vob(ic,1700,bc);break;case "ClearPrintArea":this.Vob(ic,1500,bc);break;case "InsertPageBreak":this.Vob(ic,1500,bc);break;case "RemovePageBreak":this.Vob(ic,1600,bc);break;case "ResetAllPageBreaks":this.Vob(ic,1700,bc)}}}Vob(bc,ic,Yc){bc>ic&&(ic=Object(rb.a)(new ra.a,{extendedProperties:new Map}),ic.extendedProperties.set("OperationName",
Yc),ic.extendedProperties.set("OperationExecutionTime",bc.toString()),eb.Health.instance.recordQosError(xb.a.jCj,[Va.a.fCj],!1,!0,!0,!1,ic))}d3h(bc,ic,Yc,md,id,xd){const Lc=new Pa.StandardDialog,Pb=new Ob.a(u.a.instance.ga(572),u.a.instance.ga(573),u.a.instance.ga(6),u.a.instance.ga(5));Lc.Sb=1;Lc.sc(1,Pb.confirmButton);Lc.sc(0,Pb.cancelButton);Lc.yl(Pb.title,Pb.body,3,Gc=>{1===Gc&&(this.FZf(bc.command,id,xd),this.P$e(bc,Yc,md,ic,xd))})}QMb(bc,ic,Yc){Yc();this.WJa.lb(ic)&&bc.Ci.a0(this.WJa.na(ic),
Mb.BasicTelemetryCalculator.uQ)}JVd(){this.cod&&this.$.xd(-1753588160,-1,0,null)}}Object(b.a)(ib,"PrintAreaBreakManager",null,[317]);var Bb=a(382),Ub=a(86);class Ta{constructor(){this.margin=this.C_=this.Yba=this.orientation=this.Cu=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.V0a=!1;this.NoColor=null}equals(bc){return bc?this.orientation===bc.orientation&&this.Yba===bc.Yba&&this.C_===bc.C_&&this.margin===bc.margin&&this.sheetPrintOptions===bc.sheetPrintOptions&&this.V0a===bc.V0a&&this.NoColor===
bc.NoColor:!1}static $Ae(bc,ic){bc&&ic&&(ic.Cu=bc.Cu,ic.orientation=bc.orientation,ic.Yba=bc.Yba,ic.C_=bc.C_,ic.margin=bc.margin,ic.ignorePrintArea=bc.ignorePrintArea,ic.sheetPrintOptions=bc.sheetPrintOptions,ic.V0a=bc.V0a,ic.NoColor=bc.NoColor)}}Object(b.a)(Ta,"PrintSettingsContainer",null,[]);var mb=a(153),Qb=a(340),Lb=a(38),Jb=a(809),Ab=a(778),pb=a(184),va=a(636),db=a(548);class Ya{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(Ya,"PrintSettingMarginOption",null,[]);class gb{constructor(){this.footer=
this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(gb,"PrintSettingMarginValue",null,[]);class Ka{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(Ka,"PrintSettingOption",null,[]);class ub{constructor(bc){this.ECi=[.75,.75,.7,.7,.3,.3];this.tBi=[.75,.75,.25,.25,.3,.3];this.EWj=[1,1,1,1,.5,.5];this.w$d=this.qee=this.Mbe=this.vbe=this.$he=this.T5=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Om=bc;this.G$h();this.N$h()}get whatToPrintOptions(){return this.$he}get orientationOptions(){return this.vbe}get paperSizeOptions(){return this.Mbe}get scalingOptions(){return this.qee}get marginDetailedOptions(){return this.w$d}dispose(){}$ub(bc){if(!bc)return null;
const ic=new gb;ic.left=bc.Left;ic.right=bc.Right;ic.top=bc.Top;ic.bottom=bc.Bottom;ic.header=bc.Header;ic.footer=bc.Footer;return ic}y2c(bc){d.ULS.shipAssertTag(537154186,0,6===bc.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const ic={};ic.Top=bc[0];ic.Bottom=bc[1];ic.Left=bc[2];ic.Right=bc[3];ic.Header=bc[4];ic.Footer=bc[5];return ic}N$h(){this.$he=[Object(rb.a)(new Ka,{printSettingOptionKey:1,printSettingOptionText:this.Om.ga(1228)}),
Object(rb.a)(new Ka,{printSettingOptionKey:2,printSettingOptionText:this.Om.ga(1221)}),Object(rb.a)(new Ka,{printSettingOptionKey:0,printSettingOptionText:this.Om.ga(1220)})];this.vbe=[Object(rb.a)(new Ka,{printSettingOptionKey:1,printSettingOptionText:this.Om.ga(1231)}),Object(rb.a)(new Ka,{printSettingOptionKey:2,printSettingOptionText:this.Om.ga(1230)})];this.Mbe=[Object(rb.a)(new Ka,{printSettingOptionKey:1,printSettingOptionText:this.Om.ga(1233)}),Object(rb.a)(new Ka,{printSettingOptionKey:5,
printSettingOptionText:this.Om.ga(1234)}),Object(rb.a)(new Ka,{printSettingOptionKey:6,printSettingOptionText:this.Om.ga(1241)}),Object(rb.a)(new Ka,{printSettingOptionKey:7,printSettingOptionText:this.Om.ga(1235)}),Object(rb.a)(new Ka,{printSettingOptionKey:8,printSettingOptionText:this.Om.ga(1236)}),Object(rb.a)(new Ka,{printSettingOptionKey:9,printSettingOptionText:this.Om.ga(1237)}),Object(rb.a)(new Ka,{printSettingOptionKey:11,printSettingOptionText:this.Om.ga(1238)}),Object(rb.a)(new Ka,{printSettingOptionKey:12,
printSettingOptionText:this.Om.ga(1239)}),Object(rb.a)(new Ka,{printSettingOptionKey:13,printSettingOptionText:this.Om.ga(1240)}),Object(rb.a)(new Ka,{printSettingOptionKey:3,printSettingOptionText:this.Om.ga(1232)})];this.qee=[Object(rb.a)(new Ka,{printSettingOptionKey:0,printSettingOptionText:this.Om.ga(1249)}),Object(rb.a)(new Ka,{printSettingOptionKey:1,printSettingOptionText:this.Om.ga(1250)}),Object(rb.a)(new Ka,{printSettingOptionKey:2,printSettingOptionText:this.Om.ga(1251)}),Object(rb.a)(new Ka,
{printSettingOptionKey:3,printSettingOptionText:this.Om.ga(1252)})];this.w$d=[Object(rb.a)(new Ya,{printSettingOption:Object(rb.a)(new Ka,{printSettingOptionKey:0,printSettingOptionText:this.Om.ga(1255)}),marginValue:this.$ub(this.normal)}),Object(rb.a)(new Ya,{printSettingOption:Object(rb.a)(new Ka,{printSettingOptionKey:1,printSettingOptionText:this.Om.ga(1256)}),marginValue:this.$ub(this.wide)}),Object(rb.a)(new Ya,{printSettingOption:Object(rb.a)(new Ka,{printSettingOptionKey:2,printSettingOptionText:this.Om.ga(1257)}),
marginValue:this.$ub(this.narrow)}),Object(rb.a)(new Ya,{printSettingOption:Object(rb.a)(new Ka,{printSettingOptionKey:3,printSettingOptionText:this.Om.ga(1258)}),marginValue:this.$ub(this.T5)})]}G$h(){this.normal=this.y2c(this.ECi);this.narrow=this.y2c(this.tBi);this.wide=this.y2c(this.EWj)}}ub.ach=1;ub.Obh=1;ub.brb=9;ub.Tbh=2;ub.Mbh=0;ub.Fbh=!1;ub.Cbh=!1;ub.vHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(ub,"PrintSettingsManagerBase",null,[3]);var ac=a(120),
Ra=a(281);class na{constructor(bc,ic){this.sheetPrintOptions=this.sheetName=null;this.sheetName=bc;this.sheetPrintOptions=ic}getSheetName(){return this.sheetName}}Object(b.a)(na,"MacroRecorderSheetPrintOptionsSavedPayload",null,[116]);class lb extends ub{constructor(bc,ic,Yc,md,id,xd){super(id);this.S3f=this.Ad=!1;this.Qzd=Lc=>{this.xD.Qzd(Lc)};this.Zzd=Lc=>{this.xD.Zzd(Lc)};this.bQi=()=>{d.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
this.aQi=Lc=>{Lc=E.a.kf(Lc.data);d.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${ya.a.zc(Lc)}.`)};this.Hz=(Lc,Pb)=>{2===Pb.Kq?this.qv.clear():1===Pb.Kq&&this.qv&&this.qv.contains(Pb.wf)&&(d.ULS.sendTraceTag(537154188,0,50,`PrintSettingsManager.OnQueueChanged: web method ${ac.a(Pb.wf.operation.operationName)} returned, it took ${Pb.wf.dequeueUtcTime.getTime()-Pb.wf.enqueueUtcTime.getTime()} milliseconds to complete.`),
this.qv.remove(Pb.wf))};this.xD=bc;this.DN=Yc;this.$=ic;this.sheetName=md;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.lVi=this.b2g();this.$.userOperationManager.Fr(this.Hz);this.qv=new pb.a;this.isUniversalPrintEnabled=xd}wci(bc){this.xci(ic=>{bc&&(ic=this.DTh(ic),bc(ic))})}gLd(bc,ic){if(bc){var Yc=new $a(bc.Cu,bc.ignorePrintArea);this.Wij(Yc);!ic||this.S3f?d.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${ic?
"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(ic=this.FTh(bc.C_),ic.IsLandscape=2===bc.orientation,ic.PaperSize=bc.Yba,this.isUniversalPrintEnabled&&(ic.NoColor=bc.NoColor),ic.PageMargin=this.jed(bc.margin),ic.SheetPrintOptions=ub.vHa,ic.SheetPrintOptions.PrintGrid=bc.sheetPrintOptions.PrintGrid,ic.SheetPrintOptions.HorizontalCenter=bc.sheetPrintOptions.HorizontalCenter,ic.SheetPrintOptions.VerticalCenter=bc.sheetPrintOptions.VerticalCenter,ic.SheetPrintOptions.PrintHeaders=
bc.sheetPrintOptions.PrintHeaders,this.Vij(ic))}else d.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}jed(bc){let ic={};0===bc?ic=this.normal:1===bc?ic=this.wide:2===bc?ic=this.narrow:3===bc&&(ic=this.T5);return ic}Nci(bc){if(bc){d.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var ic=()=>new na(this.$.xa.oa.name,bc),Yc=this.$.pa.va,
md=this.$.pa.va.Qb(),id=(xd,Lc,Pb)=>L(Yc,this.$.xa.oa.name,bc,Da.b(this.Qzd,xd),Da.a(this.Zzd,Lc),Pb,md);ic=v.EwaSettings.fc()?new aa.a(598,0,id,64,ic):new cc.a(598,0,id,void 0,ic);this.$.userOperationManager.Ub(ic,null)}else d.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Ad||(this.Ad=!0,this.$.userOperationManager.Co(this.Hz),this.tX())}Wij(bc){this.DN.Cu=bc.Cu;this.DN.ignorePrintArea=bc.ignorePrintArea}xci(bc){const ic=
xd=>{Ra.a(xd)?d.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ya.a.zc(xd.Errors)}.`):(d.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),bc(xd.Result))},Yc=xd=>{xd=E.a.kf(xd.data);d.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ya.a.zc(xd)}.`);bc(null)},md=this.$.pa.va.Qb();
var id=(xd,Lc,Pb)=>U(this.$.pa.va,this.sheetName,this.locale,Da.b(xd,ic),Da.a(Lc,Yc),Pb,md);id=v.EwaSettings.fc()?new aa.a(247,0,id,80):new cc.a(247,0,id,16);id=this.$.userOperationManager.Ub(id,null);this.qv.add(id)}Vij(bc){d.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const ic=this.$.pa.va.Qb();this.$.userOperationManager.Ub(new aa.a(226,0,(Yc,md,id)=>R(this.$.pa.va,this.sheetName,bc,Da.b(Yc,this.bQi),
Da.a(md,this.aQi),id,ic),void 0,()=>new nb(this.sheetName,bc)),null)}Qji(bc){return this.jbf(bc)||!this.tef(bc.PaperSize)}l$c(bc){this.jbf(bc)&&(d.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),bc.ScalingWidth=lb.p4c,bc.ScalingHeight=lb.o4c,bc.ScalingPercent=lb.o4b,bc.FitToPage=lb.i4c);this.tef(bc.PaperSize)||(d.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${bc.PaperSize.toString()} present in file which is unsupported by XLO.`),
bc.PaperSize=lb.brb);return bc}BTh(bc){if(bc.FitToPage){if(1===bc.ScalingWidth&&1===bc.ScalingHeight)return 1;if(!bc.ScalingWidth&&1===bc.ScalingHeight)return 3}else return 0;return 2}ATh(bc){return this.Knd(bc,this.normal)?0:this.Knd(bc,this.wide)?1:this.Knd(bc,this.narrow)?2:3}Knd(bc,ic){return bc.Left===ic.Left&&bc.Right===ic.Right&&bc.Top===ic.Top&&bc.Bottom===ic.Bottom&&bc.Header===ic.Header&&bc.Footer===ic.Footer}FTh(bc){const ic={};ic.ScalingPercent=lb.o4b;ic.FitToPage=0!==bc;2===bc?(ic.ScalingWidth=
1,ic.ScalingHeight=0):3===bc?(ic.ScalingWidth=0,ic.ScalingHeight=1):1===bc&&(ic.ScalingWidth=1,ic.ScalingHeight=1);return ic}tef(bc){return this.lVi.contains(bc.toString())}jbf(bc){return 100!==bc.ScalingPercent||bc.FitToPage&&(1<bc.ScalingWidth||1<bc.ScalingHeight)}b2g(){const bc=new va.a(db.a.Rk());for(let ic=0;ic<this.paperSizeOptions.length;ic++)bc.add(this.paperSizeOptions[ic].printSettingOptionKey.toString());return bc}DTh(bc){let ic=null;if(bc){const Yc=this.DN.Cu,md=this.DN.ignorePrintArea;
this.Qji(bc)&&(this.S3f=!0,bc=this.l$c(bc));ic=new Ta;ic.Cu=Yc;ic.ignorePrintArea=md;ic.orientation=bc.IsLandscape?2:1;ic.Yba=bc.PaperSize;ic.C_=this.BTh(bc);ic.sheetPrintOptions=ub.vHa;ic.sheetPrintOptions.PrintGrid=bc.SheetPrintOptions.PrintGrid;ic.V0a=bc.Draft;this.isUniversalPrintEnabled&&(ic.NoColor=bc.NoColor);ic.sheetPrintOptions.HorizontalCenter=bc.SheetPrintOptions.HorizontalCenter;ic.sheetPrintOptions.VerticalCenter=bc.SheetPrintOptions.VerticalCenter;ic.sheetPrintOptions.PrintHeaders=bc.SheetPrintOptions.PrintHeaders;
ic.margin=this.ATh(bc.PageMargin);v.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&d.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${ic.margin}`);3===ic.margin&&(this.T5={},this.T5.Left=bc.PageMargin.Left,this.T5.Right=bc.PageMargin.Right,this.T5.Top=bc.PageMargin.Top,this.T5.Bottom=bc.PageMargin.Bottom,this.T5.Header=bc.PageMargin.Header,this.T5.Footer=bc.PageMargin.Footer)}return ic}tX(){if(this.qv){for(let bc of this.qv)this.$&&this.$.userOperationManager&&(bc.operation&&
d.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${ac.a(bc.operation.operationName)}.`),this.$.userOperationManager.Zsa(bc)),this.qv.remove(bc);this.qv=null}}}lb.p4c=1;lb.o4c=0;lb.o4b=100;lb.brb=9;lb.i4c=!0;Object(b.a)(lb,"PrintSettingsManager",ub,[]);var jb=a(68);class Yb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Yb,"PrintSettingsTaskPaneCallbacks",null,[]);class Gb{constructor(){this.selectedColor=
this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(Gb,"SelectedPrintSettings",null,[]);class wb{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=
null}}Object(b.a)(wb,"PrintOperationCallbacks",null,[]);class dc{constructor(){this.onBackToSheet=null}}Object(b.a)(dc,"PrintPreviewPaneCallbacks",null,[]);var Jc=a(1071);class Qc{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(Qc,"UniversalPrintAppSettings",null,[]);var fd=a(373);class Wc{constructor(bc,ic,Yc,md){this.activeCell=this.selectedRange=this.ng=this.graphServiceEndpoint=null;
this.l_=0;this.Mm=this.rv=null;this.wH=new Ta;this.zk=new Ta;this.lba=0;this.c7a=null;this.QLb=!1;this.s2a=this.UEb=null;this.dod=!1;this.$5a=this.Oyb=!0;this.Dla=this.lya=this.uMa=null;this.Oxb=!1;this.$6a=null;this.s5a=this.DJc=!1;this.Iyd=id=>{if(!(id&&id.data&&id.data.Td&&id.data.responseHeaders&&id.data.Td.length)){var xd=id?id.data?id.data.Td?id.data.responseHeaders?id.data.Td.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":
"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.ng&&(id=this.fQa(u.a.instance.ga(1209)),this.bAa(id,0));d.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${xd}`);this.bJd&&(id=Object(rb.a)(new ra.a,{extendedProperties:new Map}),id.extendedProperties.set("InvalidParameterName",xd),eb.Health.instance.recordQosError(xb.a.MHf,[Va.a.NHf],!1,!0,!0,!1,id))}else if(0<this.lba&&id.data.id===this.lba){if(id.data.responseHeaders["Content-Type"]&&
(ha.a.contains(id.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||ha.a.contains(id.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){d.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var Lc=null;ha.a.contains(id.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(Lc=this.e4g(id));xd={};this.rDb(xd,null,null,Lc);id.data.responseHeaders["Total-Pdf-PageCount"]?(Lc=parseInt(id.data.responseHeaders["Total-Pdf-PageCount"].toString(),
10),this.Oxb||(this.NDd>=Lc?this.Dla=Lc:this.Oxb=!0),this.$5a&&this.ng&&this.ng.setPageRangeSettings(Lc,this.NDd,this.Oxb,this.lya,this.Dla)):d.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else xd=la.a.Uh(id.data.Td),ya.a.k9(xd.Errors)||jb.a(this.$).fd.fJ(xd.Errors[0].MessageId),this.N5i(xd.Errors),this.ng&&(Lc=this.fQa(xd.Errors[0].Description),-1831476778===xd.Errors[0].MessageId?(d.ULS.sendTraceTag(537154256,
0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.bAa(Lc,0,u.a.instance.ga(1212))):this.bAa(Lc,0)),297284985===xd.Errors[0].MessageId?d.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${xd.Errors[0].MessageId}`):d.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${xd.Errors[0].MessageId}`);id=id.data.state;
id.L7c(xd,id.userContext,id.methodName)}};this.Hyd=id=>{if(0<this.lba&&id.data.id===this.lba){var xd=E.a.kf(id.data);this.ng&&this.bAa(this.fQa(xd[0].Description),1);d.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${ya.a.zc(xd)}]`);xd=id.data.state;xd.F$(id,xd.userContext,xd.methodName);this.$.userOperationManager.lka.operation.Pma(()=>this.QLb)}};this.CHi=(id,xd,Lc)=>{id.Errors&&0<id.Errors.length&&this.ng?(ya.a.k9(id.Errors)||jb.a(this.$).fd.fJ(id.Errors[0].MessageId),
this.bAa(this.fQa(id.Errors[0].Description),0),d.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${id.Errors[0].MessageId}`)):(d.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.rDb(id,xd,Lc,null))};this.BHi=id=>{id=E.a.kf(id.data);this.ng&&this.bAa(this.fQa(id[0].Description),1);d.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${ya.a.zc(id)}]`);
this.$.userOperationManager.lka.operation.Pma(()=>this.QLb)};this.azf=(id,xd)=>{if(xd)switch(xd.F_i){case 1:if(this.zk&&this.s2a)switch(id=this.s2a.tc,this.s2a.stop(),this.s2a=null,this.zk.Cu){case 1:this.kZc(id,4800,"ActiveSheet");break;case 0:this.kZc(id,6100,"CurrentSelection");break;case 2:this.kZc(id,7500,"EntireWorkbook")}break;case 0:this.UEb&&(id=this.UEb.tc,this.UEb.stop(),2400<id&&(xd=Object(rb.a)(new ra.a,{extendedProperties:new Map}),xd.extendedProperties.set("PaneLoadTime",id.toString()),
eb.Health.instance.recordQosError(xb.a.iCj,[Va.a.Y3f],!1,!0,!0,!1,xd)),this.rv.wci(Lc=>{this.nAj(Lc)}))}};this.Hz=(id,xd)=>{(1===xd.Kq&&this.uMa===xd.wf||2===xd.Kq)&&this.PJd()};this.$=bc;this.xha=ic;this.j2=Yc;this.OCb=md;this.bJd=H.HelperMethods.rZ;this.Qa=new Lb.a;this.NDd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.Zxj();this.p$h();this.Udi=this.PVg();this.cod=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=
!!md&&md.f5a()&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.me.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}get Pji(){return this.DJc}PFg(bc){this.Qa.addHandler("ppocek",bc)}Ebj(bc){this.Qa.removeHandler("ppocek",bc)}mAj(bc,ic){this.nfj();this.$.userOperationManager.Fr(this.Hz);this.Mm=bc;this.Qa.raiseEvent("ppocek");this.Mm.SelectedRanges&&this.Mm.SelectedRanges.Ranges&&0<this.Mm.SelectedRanges.Ranges.length&&this.Mm.SelectedRanges.Ranges[0]&&
(this.selectedRange=w.B(this.Mm.SelectedRanges.Ranges[0]).toString());d.ULS.shipAssertTag(537154268,0,!this.rv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.rv=new lb(this,this.$,ic,this.$.xa.oa.name,u.a.instance,this.isUniversalPrintEnabled);d.ULS.shipAssertTag(537154267,0,!this.ng,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.ng=new Ab.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.ng.Ffh();
this.ng.oAj();this.ng.hFg(this.azf)}HQh(){this.rv.T5&&4<=this.rv.marginDetailedOptions.length&&(this.rv.marginDetailedOptions[3].marginValue=this.rv.$ub(this.rv.T5));return this.rv.marginDetailedOptions}svc(){return!!this.Mm&&!!this.Mm.ObjectId||!x.g(this.$).ha.sa.xg}GTh(){const bc=Object(rb.a)(new Gb,{selectedWhatToPrint:ub.ach,selectedOrientation:ub.Obh,selectedPaperSize:ub.brb,selectedScaling:ub.Tbh,selectedMargin:ub.Mbh,selectedIgnorePrintArea:ub.Fbh,selectedPrintGridlines:ub.vHa.PrintGrid,selectedDraft:ub.Cbh,
selectedHorizontalCenter:ub.vHa.HorizontalCenter,selectedVerticalCenter:ub.vHa.VerticalCenter,selectedRowAndColumnHeadings:ub.vHa.PrintHeaders});this.wH?(bc.selectedWhatToPrint=this.wH.Cu,bc.selectedOrientation=this.wH.orientation,bc.selectedPaperSize=this.wH.Yba,bc.selectedScaling=this.wH.C_,bc.selectedMargin=this.wH.margin,bc.selectedIgnorePrintArea=this.wH.ignorePrintArea,bc.selectedPrintGridlines=this.wH.sheetPrintOptions.PrintGrid,bc.selectedDraft=this.wH.V0a,this.isUniversalPrintEnabled&&(bc.selectedColor=
this.wH.NoColor?0:1),bc.selectedHorizontalCenter=this.wH.sheetPrintOptions.HorizontalCenter,bc.selectedVerticalCenter=this.wH.sheetPrintOptions.VerticalCenter,bc.selectedRowAndColumnHeadings=this.wH.sheetPrintOptions.PrintHeaders):d.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return bc}M_e(){return Object(rb.a)(new dc,{onBackToSheet:()=>{this.$ka()}})}CTh(){return Object(rb.a)(new Jc.a,{backActionButtonText:u.a.instance.ga(1208),
printPreviewPaneCallbacks:this.M_e(),logger:new Bb.a,disableTellMeControl:!0,printOperationCallbacks:Object(rb.a)(new wb,{onClosePreviewer:()=>{this.$ka()},getGraphServiceAuthorizationToken:this.r9b(),onLocalPrint:()=>{this.Mzf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(rb.a)(new Qc,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.aei()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,
appName:"Excel"})})}ETh(){return Object(rb.a)(new Yb,{onSettingChange:bc=>{this.TOi(bc)},onPrint:()=>{this.Mzf()}})}TOi(bc){this.l_++;bc?(this.ng&&this.ng.cBj(),this.zk.Cu=bc.selectedWhatToPrint,this.zk.C_=bc.selectedScaling,this.zk.orientation=bc.selectedOrientation,this.zk.Yba=bc.selectedPaperSize,this.zk.margin=bc.selectedMargin,this.isUniversalPrintEnabled&&(this.zk.NoColor=!bc.selectedColor),this.zk.ignorePrintArea=bc.selectedIgnorePrintArea,this.crj(bc.selectedPageStart,bc.selectedPageEnd),
this.rv&&this.m4h(this.zk,bc)?(this.zk.sheetPrintOptions=ub.vHa,this.zk.sheetPrintOptions.PrintGrid=bc.selectedPrintGridlines,this.zk.sheetPrintOptions.HorizontalCenter=bc.selectedHorizontalCenter,this.zk.sheetPrintOptions.VerticalCenter=bc.selectedVerticalCenter,this.zk.sheetPrintOptions.PrintHeaders=bc.selectedRowAndColumnHeadings,this.rv.Nci(this.zk.sheetPrintOptions)):this.sxb()):d.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}$ka(){this.s5a&&
(this.QLb=!0);d.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.l_} times before clicking on backToWorkbook icon`);this.Lzf();this.exe()}Mzf(){d.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.l_} times before clicking on print button.`);v.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&d.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.zk.margin}, Initial margin value : ${this.wH.margin}`);
if(this.useMSPdfViewer)this.OHf();else if(this.$5a)try{this.ng.printPdf(),this.t_c()}catch(bc){d.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.OHf()}else this.xha.S2f(this.VGa(!0)),this.t_c()}OHf(){const bc=this.VGa(!0);this.t_c();H.HelperMethods.Ve(bc,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){Ub.a.Ia(this.Qa)}sxb(){if(this.$.Vva)this.tci();else{this.tX();this.TSf();var bc=null;this.e$h();d.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var ic=(Yc,md,id)=>{Yc=new sa.a(Yc,null,md,id,null,!0,!1,"GetFileCopyFileHandler","");Yc.correlationID=wa.a.create().toString();bc=Yc;this.lba=this.j2.O8(this.VGa(this.$5a?!1:!0,this.Udi?"Base64":"Pdf"),1,null,null,Wc.z9c,!1,2,this.Iyd,this.Hyd,bc,void 0,void 0,void 0,12E4);Yc.requestId=this.lba;d.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.lba}.`);
return pa.Task.Ua(!0)};this.uMa=v.EwaSettings.fc()?this.$.userOperationManager.Ub(new aa.a(223,0,ic,80),null):this.$.userOperationManager.Ub(new cc.a(223,0,ic,16),null)}}t_c(){this.Lzf();this.exe()}Qzd(bc){ya.a.ar(bc.Errors)?this.ng.showErrorMessageForPrintOptions(u.a.instance.ga(1259)):(d.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.sxb(),this.ng&&this.ng.hideErrorMessageForPrintOptions())}Zzd(bc){this.ng&&this.ng.showErrorMessageForPrintOptions(u.a.instance.ga(1259));
bc=E.a.kf(bc.data);d.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${ya.a.zc(bc)}.`)}tci(){d.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.tX();const bc=this.$.pa.va.Qb(),ic=(Yc,md,id)=>{const xd={};xd.WhatToPrint=this.zk.Cu;xd.UseNamedAction=this.xha.Qvc();xd.SelectedSheetName=this.$.xa.oa.name;xd.ActiveCell=this.activeCell;xd.SelectedRanges=
[this.selectedRange];xd.IsPdfDocumentRequired=!1;xd.Orientation=this.zk.orientation;xd.PaperSize=this.zk.Yba;xd.Scaling=this.zk.C_;xd.RichValuesEnabled=!0;xd.IgnorePrintArea=this.zk.ignorePrintArea;xd.Preview=!0;this.isUniversalPrintEnabled&&(xd.NoColor=this.zk.NoColor);this.A0f()&&(xd.PaginationStartPage=this.lya,xd.PaginationEndPage=this.Dla,xd.OutputTotalPdfPageCount=!0);const Lc=this.rv.jed(this.zk.margin);Lc&&(xd.PageMargin={},xd.PageMargin.Top=Lc.Top,xd.PageMargin.Bottom=Lc.Bottom,xd.PageMargin.Left=
Lc.Left,xd.PageMargin.Right=Lc.Right,xd.PageMargin.Header=Lc.Header,xd.PageMargin.Footer=Lc.Footer);return this.c7a=M(this.$.pa.va,xd,Da.b(this.CHi,Yc),Da.a(this.BHi,md),id,bc)};v.EwaSettings.fc()?this.uMa=this.$.userOperationManager.Ub(new aa.a(133,0,ic,80),null):this.uMa=this.$.userOperationManager.Ub(new cc.a(133,0,ic,16),null)}exe(){this.$.userOperationManager.Co(this.Hz);this.tX();this.TSf();d.ULS.shipAssertTag(537154261,0,!!this.ng,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");
this.ng&&(this.ng.hbj(this.azf),this.ng.Ofh(),this.ng=null);this.Mm=null;this.rv&&(this.rv.dispose(),this.rv=null);this.s2a=this.UEb=null;this.DJc=!1;this.Qa&&this.Qa.raiseEvent("ppocek")}Zvj(){return this.$.isEditMode&&!!this.wH&&!!this.zk&&2!==this.zk.Cu&&this.lhd()}gLd(){d.ULS.shipAssertTag(537154260,0,!!this.rv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.rv&&this.rv.gLd(this.zk,this.Zvj())}VGa(bc,ic="Pdf"){const Yc=new Sys.StringBuilder;Yc.append(ea.a(this.$,
ic,!0));P.a.Yg(Yc,ba.a.CEd,""+this.zk.Cu);bc&&this.xha.Qvc()&&P.a.Yg(Yc,ba.a.Edg,"1");P.a.Yg(Yc,ba.a.jJf,this.$.xa.oa.name);0===this.zk.Cu&&(P.a.Yg(Yc,ba.a.iJf,this.selectedRange),P.a.Yg(Yc,ba.a.cJf,this.activeCell));P.a.Yg(Yc,ba.a.dJf,""+this.zk.orientation);P.a.Yg(Yc,ba.a.eJf,""+this.zk.Yba);P.a.Yg(Yc,ba.a.hJf,""+this.zk.C_);P.a.Yg(Yc,ba.a.gJf,"1");P.a.Yg(Yc,ba.a.bJf,this.zk.ignorePrintArea?"1":"0");P.a.Yg(Yc,ba.a.fJf,"1");this.xJg(Yc);this.isUniversalPrintEnabled&&P.a.Yg(Yc,ba.a.F1i,this.zk.NoColor?
"1":"0");this.wJg(Yc);ha.a.equals(ic,"Pdf",!0)&&(Yc.append("&#toolbar=0"),Yc.append("&zoom=100"));bc=Yc.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");d.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${bc}`);return bc}crj(bc,ic){bc||ic?(this.Oxb=!0,this.lya=bc,this.Dla=ic):this.fSf()}xJg(bc){this.A0f()&&(P.a.Yg(bc,ba.a.H1i,""+this.lya),P.a.Yg(bc,ba.a.G1i,""+this.Dla),P.a.Yg(bc,ba.a.I1i,"1"),d.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.lya} to ${this.Dla}`))}A0f(){return null!=
this.lya&&0<this.lya&&null!=this.Dla&&0<this.Dla}wJg(bc){if(this.rv&&this.zk){const ic=this.rv.jed(this.zk.margin);ic&&P.a.Yg(bc,ba.a.E1i,""+ic.Top+" "+ic.Bottom+" "+ic.Left+" "+ic.Right+" "+ic.Header+" "+ic.Footer)}}rDb(bc,ic,Yc,md){this.ng&&(d.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.oa&&(this.$5a?(md||(md=this.VGa(!1)),this.ng.Yri(md)):this.hAj()))}lhd(){return!this.wH.equals(this.zk)}Lzf(){!this.QLb&&
0<this.l_&&(this.dod?this.gLd():d.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));d.ULS.shipAssertTag(537154250,0,!!this.ng,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.ng&&this.ng.w5h();this.JVd()}nj(){d.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.ng){var bc=this.fQa(u.a.instance.ga(1));this.bAa(bc,1)}else bc=ya.a.Yc(1,
0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),v.EwaSettings.xz()?new Qb.a(this.$,bc):(new mb.ErrorDialog(this.$,bc)).xf()}nAj(bc){bc?(0===bc.Cu&&this.svc()&&(d.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.Mm.ObjectId?"floatingObject":"discontinuousRange"}.`),bc.Cu=1),Ta.$Ae(bc,this.wH),Ta.$Ae(bc,this.zk),d.ULS.shipAssertTag(537154248,0,!!this.ng,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.ng&&(this.dod=!0,this.ng.pAj(),this.sxb())):(d.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.nj())}kZc(bc,ic,Yc){bc>ic&&(ic=Object(rb.a)(new ra.a,{extendedProperties:new Map}),ic.extendedProperties.set("WtpSelectedValue",Yc),ic.extendedProperties.set("FullyRenderedPdfLoadTime",bc.toString()),eb.Health.instance.recordQosError(xb.a.hCj,[Va.a.Y3f],!1,!0,!0,!1,ic))}tX(){this.uMa&&(0<this.lba||this.c7a)&&(d.ULS.sendTraceTag(537154246,
0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.lba}.`),this.$.userOperationManager.Zsa(this.uMa),this.c7a?E.a.wu(this.c7a.Ot):this.j2.wu(this.lba),this.PJd())}PJd(){this.c7a=this.uMa=null}e$h(){this.bJd&&this.zk&&(this.s2a=this.$.Hb.xc("UserAction",(1===this.zk.Cu?"ActiveSheet":0===this.zk.Cu?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}fSf(){this.Oxb=!1;this.lya=1;this.Dla=this.NDd}fQa(bc){if(bc)return bc.replace("&#39;",
"'");d.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return bc}hAj(){d.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.Oyb)d.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let bc=this.fQa(u.a.instance.ga(1214));this.bAa(bc,3)}}bAa(bc,ic,Yc=null){this.ng.Wz(bc,ic,Yc)}p$h(){this.$5a=this.Oyb=!0;d.ULS.sendTraceTag(557061534,
0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.Oyb}, isPdfPreviewSupportedInPreviewer: ${this.$5a}`)}nfj(){this.$6a=null;this.PJd();this.fSf();this.UEb=this.$.Hb.xc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.l_=0;this.dod=this.s5a=this.QLb=!1;this.DJc=!0}Zxj(){const bc=this.zmi()||this.Mmi();d.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${bc}`);return bc}PVg(){let bc=
15;y.a.FH&&y.a.Orb&&(bc=parseFloat(y.a.Orb));return 14<bc&&this.Oyb}zmi(){return y.a.bD||f.AFrameworkApplication.isUnifiedHostMode}Mmi(){return!this.$.me.get(111)}TSf(){this.$6a&&(URL.revokeObjectURL(this.$6a),this.$6a=null)}e4g(bc){var ic=bc.data.Td;bc=this.$.Hb.xc("UserAction","PrintPreviewBlobFileCreation");var Yc=window.self.atob(ic);ic=new Uint8Array(ic.length);for(let md=0;md<Yc.length;md++)ic[md]=Yc.charCodeAt(md)&255;Yc=new Blob([ic],{type:"application/pdf"});this.$6a=URL.createObjectURL(Yc);
d.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${bc.tc} ms. Blob size: ${Yc.size}`);bc.stop();return this.$6a+"#toolbar=0&zoom=100"}N5i(bc){if(this.bJd&&ya.a.gh(bc,Wc.zWi)){const ic=Object(rb.a)(new ra.a,{extendedProperties:new Map});ic.extendedProperties.set("ErrorMessageIdName",bc[0].MessageIdName);eb.Health.instance.recordQosError(xb.a.MHf,[Va.a.NHf],!1,!0,!0,!1,ic)}}m4h(bc,ic){return bc.sheetPrintOptions.PrintGrid!==ic.selectedPrintGridlines||
bc.sheetPrintOptions.HorizontalCenter!==ic.selectedHorizontalCenter||bc.sheetPrintOptions.VerticalCenter!==ic.selectedVerticalCenter||bc.sheetPrintOptions.PrintHeaders!==ic.selectedRowAndColumnHeadings}JVd(){this.cod&&this.$.xd(-1753588160,-1,0,null)}aei(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){d.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.OCb.uO("Print",
this.graphServiceEndpoint).then(bc=>bc?(bc.IsSuccess?d.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):d.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${bc.ErrorCode}, Error message : ${bc.ErrorMessage}`),bc):Object(rb.a)(new Jb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(bc=>{let ic=new Jb.a;Object.getType(bc)===Object.getType(ic)?
ic=bc:(ic.ErrorMessage=bc.toString(),ic.ErrorCode="exception");return Promise.resolve(ic)})}r9b(){return()=>{const bc=Promise.resolve("");try{if(this.OCb&&this.OCb.f5a())return this.getToken().then(ic=>ic.IsSuccess?Promise.resolve(ic.Token):bc,()=>bc)}catch(ic){d.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return bc}}onNotifyPrintJobStatus(bc,ic){bc=fd.a.EA.notificationBar.c$(bc,!1);"pending"==ic&&(bc.displayTimeoutSeconds=3);
if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(ic){case "failure":bc.image=1;break;case "success":bc.image=3;break;default:bc.image=0}else bc.image=0;fd.a.EA.notificationBar.hE(bc)}}Wc.zWi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Wc.z9c=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Wc,"PrintPreviewManager",null,[315,3,316]);class Rb{constructor(bc,
ic,Yc){this.ignorePrintArea=!1;this.lLj=()=>{const md=x.g(this.$).Ea;this.jPc=!0;md.Vwd()};this.yOi=()=>{this.ygd()};this.xOi=(md,id,xd)=>{d.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${xd} failed to execute`);this.ygd()};this.$=bc;this.ea=bc.ea;this.xha=ic;this.DN=new $a(1,this.ignorePrintArea);this.xD=ic=new Wc(bc,ic,f.AFrameworkApplication.rd,Yc);this.$.da.Ga(418,ic);this.KHf=new ib(bc);this.$.da.Ga(384,this);this.jPc=!1}get H0f(){return this.jPc}Qc(){return!1}executeCommand(bc,
ic,Yc,md){const id=ic.command;return 1588554917===id?(ic.Yxb=!0,z.a(this.$)&&this.$.da.za(423).hwc(!1),this.ogh(ic)?pa.Task.Ua(!0):r.a(id)):this.KHf.executeCommand(bc,ic,Yc,md,this.yOi,this.xOi,this.lLj)}Ec(bc,ic){return 1588554917===ic.command?(d.ULS.shipAssertTag(537154305,0,this.$.Ija,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.KHf.Ec(bc,ic)}Vc(){return!1}ogh(bc){return this.$.ea.hc?this.pgh(bc):!1}pgh(bc){d.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");
const ic=this.$.Hb.xc("UserAction","DoPrintHtml");var Yc=this.$;const md=this.ea.isNamedObjectViewMode?Yc.yb.oa.sheetName:Yc.xa.oa.name,id=this.ea.isNamedObjectViewMode,xd=!id;Yc=this.zTh(Yc,md,xd);let Lc=!0;!v.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Vva&&(Lc=!1);xd?Lc?B.a(this.$)?d.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.xD.mAj(Yc,this.DN),d.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):
((new Ja(this.$,u.a.instance.ga(1222),3,Yc,bc,this.xha,md,this.DN)).xf(),d.ULS.sendTraceTag(595194760,0,50,`PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in ${ic.tc} ms.`)):((new V(this.$,u.a.instance.ga(1222),3,Yc,bc)).xf(),d.ULS.sendTraceTag(591196514,0,15,`PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in ${ic.tc} ms. isNamedObjectViewMode: ${id}.`));ic.stop();this.ygd();return!0}zTh(bc,ic,Yc){const md={};md.SessionId=this.ea.sessionId;md.UsedRangeTooBig=!1;var id=
x.g(bc);const xd=id.ha,Lc=xd.Ke;if(n.e(bc.oa))md.Type=0,md.ObjectId=bc.oa.name,md.UseSelection=!1;else if(n.g(bc.oa))md.Type=1,md.ObjectId=bc.oa.IKa,md.UseSelection=!0;else if(2===Lc||4===Lc||64===Lc)id=xd.Oa.$b.floatingObject,md.Type=1,md.SheetName=ic,md.ObjectId=id.id,md.UseSelection=!0;else if(Yc&&Lc&470)md.ObjectId=xd.Oa.$b.floatingObject.id,md.SheetName=ic;else if(n.i(bc.oa)){md.Type=2;md.SheetName=ic;if(xd.sa.xg)if(Yc=xd.sa.Wc,md.SelectedRanges=w.q(Yc,bc),20<Yc.TG)md.UseSelection=!0;else{ic=
0;id=id.kk("PrintCommandHandler.DoPrintHtml",Yc);try{for(id.$$rst();id.$$mn()&&2>ic;)id.$$cu().text&&ic++;md.UseSelection=2<=ic}finally{id&&id.dispose()}}else md.UseSelection=!1,md.SelectedRanges=w.q(xd.sa.activeRange,bc);this.ea.isNamedObjectViewMode&&(md.UsedRange=w.v(bc.oa.usedRange,bc))}md.Title=bc.workbookContext.WorkbookFileName;return md}ygd(){x.g(this.$);if(!this.H0f){this.jPc=!0;const bc=this.$.Hb.xc("UserAction","HandlePageLayoutRendering");this.CLj();d.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${bc.tc} ms.`);
bc.stop()}}CLj(){const bc=x.g(this.$).Ea,ic=bc.bF();let Yc=!1,md=0;for(let id=0;id<ic.length;id++){const xd=ic[id],Lc=xd.sf;Lc&&Lc.hasPageLayout()&&(Yc=!0,Lc.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+xd.Nd,4),md++)}Yc&&(d.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${ic.length}, number of blocks that require re-rendering is ${md}`),bc.Vwd())}}Object(b.a)(Rb,"PrintCommandHandler",null,[188,311]);var Sb=a(1070),
mc=a(1277),ec=a(1278);class Rc extends k.a{constructor(bc){super(bc)}Dd(){var bc=f.AFrameworkApplication.fa.appSettings,ic=this.$.ya.DirectPrintSetting;bc.DirectPrintIsEnabled=ic.DirectPrintIsEnabled.toString();bc.DirectPrintProbeIsEnabled=ic.DirectPrintProbeIsEnabled.toString();bc.DirectPrintEnabledForInternetExplorer=ic.DirectPrintEnabledForInternetExplorer.toString();bc.DirectPrintSupportedMimeTypes=ic.DirectPrintSupportedMimeTypes;bc.DirectPrintSupportedPlugins=ic.DirectPrintSupportedPlugins;
bc.DirectPrintImmersivePreviewPlugins=ic.DirectPrintImmersivePreviewPlugins;bc.DirectPrintMinimalSupportedEdgeVersion=ic.DirectPrintMinimalSupportedEdgeVersion;bc.DirectPrintEnabledForEdge=ic.DirectPrintEnabledForEdge.toString();bc=new Sb.a(bc);let Yc=null;ic=null;try{ic=window.navigator.mimeTypes}catch(id){d.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let md=null;try{md=window.navigator.plugins}catch(id){d.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Yc=
new ec.a(bc,ic,md,ec.a.Fbf,ec.a.egf,new mc.a(f.AFrameworkApplication.ta.tW),f.AFrameworkApplication.ta.LD,ec.a.fgf,(id,xd)=>new e.a(id,!1,xd),!1);if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.me.get(116)){const id=l.GetServiceTaskFactory.Ta(this.$.da,349,350,this.ib);m.TaskExtensions.Aa(id,()=>{const xd=new Rb(this.$,Yc,id.result);this.ld([xd])},this.$.la)}else this.ld([new Rb(this.$,Yc,null)])}static ka(bc){k.a.Rd(73,new Rc(bc))}}Object(b.a)(Rc,"PrintCommandHandlerFactory",
k.a,[]);a.d(D,"a",function(){return Mc});const Mc=()=>{c.a.Fa(Rc.ka)}},1139:function(t,D,a){var c=a(10),b=a(0),d=a(220),f=a(50),e=a(37),k=a(15),l=a(86),m=a(84),v=a(240),n=a(617),w=a(208),r=a(121),u=a(34),x=a(39),z=a(234),B=a(43),y=a(6),A=a(35),K=a(68),G=a(584);class T extends z.a{constructor(lb,jb){super(lb);this.LTj=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.DDb=()=>{const Yb=this.IMh();if(Yb){this.$.dI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const Gb=
K.a(this.$).fd.activityState;Gb[A.a.xXa]=y.a.download;Gb[G.a.fSc]=this.command}B.a(this.$).tr(Yb.Errors)}};this.iframe=lb;this.$=jb;this.Fc.ka("load",this.DDb)}get U6h(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(lb,jb){const Yb={};(lb=this.cxh(lb,Yb))&&x.a.voc("dlfr",lb,Yb);this.command=jb}cxh(lb,jb){var Yb=lb.split("?");if(2!==Yb.length)return lb=null,k.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),
lb;Yb=Yb[1].split("&");for(const wb of Yb){var Gb=wb.split("=",2);if(2!==Gb.length){lb=null;k.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}Yb=Gb[0];this.LTj.includes(Yb)&&(Gb=decodeURIComponent(Gb[1]),jb[Yb]=Gb,lb=w.a.lHb(lb,Yb))}return lb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}IMh(){try{return this.iframe.contentWindow.ewaResult}catch(lb){if(!this.$.ea.jc.isDivSyndicated){const jb=
window.document.referrer.match(RegExp("://(.[^/]+)/"));k.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<jb.length?jb[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.Vva}`);throw lb;}return null}}static hre(lb){let jb=document.createElement("iframe");jb.id="ewaFileLoader";jb.style.cssText="height:0;width:0;display:none";jb.src="about:blank";jb.setAttribute("name",
"dlfr");jb=lb.domElement.appendChild(jb);return new T(jb,lb)}}Object(b.a)(T,"FileLoader",z.a,[]);var W=a(140),P=a(55);class E{constructor(lb,jb){this.Xc=()=>{u.a.og(K.a(this.$).fd.activityState,W.a.wxd)||this.Rta.reset()};this.$=jb;this.Pic=lb;this.ea=jb.ea;this.ea.hk(this.Xc);this.Rta=T.hre(this.$)}Vgh(){const lb=this.sRg(this.$),jb=this.$.userOperationManager.operationCount;0<jb&&k.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${jb}`);this.$.userOperationManager.i3("DownloadACopyOperation.DownloadForkedFile");
this.Pic&&k.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.Rta.downloadFile(lb,-21742208);e.TaskExtensions.Aa(P.Task.delay(1),()=>{this.d8e()},this.Rta.la,3)}dispose(){this.ea&&this.ea.Hk(this.Xc);this.$=this.ea=null}d8e(lb=null){lb||(lb=this.$.Hb.xc("LoadResource","DownloadACopyOperation"));!this.Rta.U6h&&lb.tc<E.bof?window.setTimeout(()=>{this.d8e(lb)},E.Wgh):(lb.tc>=E.bof&&k.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),K.a(this.$).fd.nM())}sRg(lb){const jb=
new Sys.StringBuilder,Yb=lb.workbookContext,Gb=lb.ya;jb.append(lb.dda);jb.append(Gb.FileHandlerRelativeUri);jb.append("?id=");jb.append(encodeURIComponent(w.a.lHb(Yb.WorkbookUri,"sc")));lb.ea.hc&&(jb.append("&sessionId="),jb.append(encodeURIComponent(lb.ea.sessionId)));jb.append("&workbookType=FullForkedWorkbook");jb.append("&dataloss=");jb.append(this.Pic?"true":"false");r.a.vYa(jb,Gb);return jb.toString()}}E.bof=1E5;E.Wgh=100;Object(b.a)(E,"DownloadACopyOperation",null,[3]);class H extends v.a{constructor(lb,
jb,Yb=!1){super(lb,jb);this.tBb=null;this.Rzd=Gb=>{this.unsubscribe(wb=>{Gb.remove_disposing(wb)});this.dh(y.a.Jj);this.pp()};this.Pic=Yb}execute(lb){const jb=Object(m.a)(7,lb.Be);if(!jb.Ija)return k.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Ekd(lb),this.dh(y.a.idle),1;this.tBb||(this.tBb=new E(this.Pic,jb));this.tBb.Vgh();k.ULS.shipAssertTag(537154817,0,3!==K.a(jb).oi.au,"The current activity should not be closed.");
return 1}Ekd(lb){const jb=Object(m.a)(7,lb.Be),Yb=new n.a(jb);this.subscribe(lb,this.Rzd,Gb=>{Yb.add_disposing(Gb)});k.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Yb.initialize();Yb.xf()}dispose(){l.a.Ia(this.tBb);this.tBb=null;super.dispose()}}Object(b.a)(H,"DownloadAForkedCopyActivity",v.a,[]);class F extends d.a{constructor(lb){super();this.$=lb;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.ib),()=>{this.qb(new H(y.a.U0a,y.a.Jj,!0))},this.la)}}Object(b.a)(F,"DownloadACopyPreDatalossActivityFactory",d.a,[]);class N extends d.a{constructor(lb){super();this.$=lb;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),()=>{this.qb(new H(y.a.unmergeableDownloadCopy,y.a.Ona))},this.la)}}Object(b.a)(N,"DownloadAForkedCopyActivityFactory",d.a,[]);var J=a(83),R=a(4),M=a(80),L=a(27),U=a(106),X=a(25);class da{constructor(lb,jb,Yb){this.La=
lb;this.xqg=jb;this.Z0=Yb}Fg(){this.La.Ob(X.a.tryMacOffice,U.a.frame,Object(J.a)(this,this.ySi,"onTryMacOffice"));this.La.Ob(X.a.B$f,U.a.frame,Object(J.a)(this,this.TCf,"onTryMacOfficeFromViewer"));this.La.Ob(X.a.A$f,U.a.frame,Object(J.a)(this,this.TCf,"onTryMacOfficeFromViewer"))}ySi(lb,jb,Yb,Gb,wb){if(1===Yb)return 32;wb?(lb=wb.SourceControlId,"btnjTryMacOfficeForWordEditor"===lb?x.a.Ve(M.a.LY(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===lb&&x.a.Ve(M.a.LY(22),
"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.bjf();return 32}TCf(lb,jb,Yb){if(1===Yb)return 32;switch(lb){case X.a.B$f:x.a.Ve(M.a.LY(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case X.a.A$f:x.a.Ve(M.a.LY(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}bjf(){x.a.Ve(da.Mwi,"_blank",void 0,"LaunchMacTrialWindow")}get Bvc(){return this.xqg&&L.a.isMac&&!L.a.Iji&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get wwj(){return this.Bvc}static get Mwi(){return M.a.pH("522401")}}
Object(b.a)(da,"MacOfficeOffer",null,[386]);var fa=a(82);class S{constructor(lb,jb,Yb){this.La=lb;this.Bqg=jb;this.mDc=null;(this.WVb=R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&fa.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{this.mDc=Gb});this.Z0=Yb}Fg(){this.La.Ob(X.a.tryOffice,U.a.frame,Object(J.a)(this,this.zSi,"onTryOffice"));this.La.Ob(X.a.tryOfficeThroughTellMe,
U.a.frame,Object(J.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Ob(X.a.E$f,U.a.frame,Object(J.a)(this,this.F$f,"tryOfficeThroughViewer"));this.La.Ob(X.a.D$f,U.a.frame,Object(J.a)(this,this.F$f,"tryOfficeThroughViewer"))}zSi(lb,jb,Yb,Gb,wb){if(this.WVb&&1===Yb)return this.isFreemiumUpsellEnabled&&this.EKb?32:8;2===Yb&&(wb?(lb=wb.SourceControlId,"btnjTryOfficeForWordEditor"===lb?x.a.Ve(M.a.LY(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
lb?x.a.Ve(M.a.LY(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Qhc()):this.Qhc());return 32}tryOfficeThroughTellMe(lb,jb,Yb,Gb,wb){if(this.WVb&&1===Yb)return this.isFreemiumUpsellEnabled&&this.EKb?32:8;2===Yb&&(wb?(lb=wb.SourceControlId,x.a.Ve(M.a.pH("862405")+this.ESh(lb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):x.a.Ve(M.a.pH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}F$f(lb,jb,Yb){if(this.WVb&&1===Yb)return this.isFreemiumUpsellEnabled&&
this.EKb?32:8;if(2===Yb)switch(lb){case X.a.E$f:x.a.Ve(M.a.LY(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case X.a.D$f:x.a.Ve(M.a.LY(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Trf(){return this.EKb}get hEi(){return this.EKb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get EKb(){return this.Bqg&&!L.a.isMac}get isFreemiumUpsellEnabled(){let lb=!1;this.mDc&&(lb=this.mDc.isFreemiumUpsellEnabled());return lb}Qhc(lb=null){let jb=0;lb&&(jb=lb);x.a.Ve(S.nQh(jb),"_blank",void 0,
"LaunchOfficeOffer")}ESh(lb){let jb=0;switch(lb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":jb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":jb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":jb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":jb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":jb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":jb=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":jb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":jb=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":jb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":jb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":jb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":jb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":jb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":jb=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":jb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":jb=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":jb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":jb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":jb=29}return 0===jb?"":String.format("&pc={0:D}",jb)}static nQh(lb){if(L.a.Zg)switch(lb){case 1:return M.a.pH("393806");case 2:return M.a.pH("393810");case 3:return M.a.pH("393809");case 5:return M.a.pH("393805")}else if(L.a.ep)switch(lb){case 1:return M.a.pH("521979");case 3:return M.a.pH("521980");case 5:return M.a.pH("521978");
case 2:return M.a.pH("522490")}else{if(2===lb)return M.a.pH("517778");if(1===lb)return M.a.LY(30)}return M.a.pH("522402")}}Object(b.a)(S,"OfficeTrialExperience",null,[385]);class ka{ai(lb){lb.register(S,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").uc().Gc(()=>new S(R.AFrameworkApplication.wb,R.AFrameworkApplication.Jyb,R.AFrameworkApplication.lcid));lb.register(da,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").uc().Gc(()=>new da(R.AFrameworkApplication.wb,
R.AFrameworkApplication.hfc,R.AFrameworkApplication.lcid))}}Object(b.a)(ka,"OpenInClientConfiguration",null,[5]);var V=a(547),wa=a(1347),ma=a(38),ab=a(1186),ba=a(144),Ca=a(151),Na=a(221),za=a(13),la=a(85),aa=a(108),sa=a(88);const ea=lb=>{for(let jb=0;jb<lb.children.length;jb++){const Yb=lb.children[jb];Yb.style.position="relative";Yb.style.top=(Yb.parentNode.offsetHeight-Yb.offsetHeight)/2+"px"}},Z=lb=>lb.Ca.keyCode===la.a.Zh||lb.Ca.keyCode===la.a.boa?(lb.Cb.click(),!0):!1,ua=(lb,jb,Yb,Gb,wb,dc,Jc)=>
{const Qc=document.createElement("a");Qc.className="ProtocolLaunchingDialogButtonAnchor";Qc.className+=" OICDialog";Qc.id=lb;Qc.setAttribute(sa.a.Kd,sa.a.Ps);Qc.style.padding="0";Qc.style.margin="0";Gb&&ya(wb,jb,Yb,Gb,Qc);lb=document.createElement("span");lb.className="ProtocolLaunchingDialogButtonLabel";lb.innerText=wb;Qc.appendChild(lb);Qc.tabIndex=0;dc&&Na.a.instance.ra(za.a.click,Qc,dc);Jc&&aa.KeyInputManager.instance.ra(za.a.Gd,Qc,Jc);return Qc},ya=(lb,jb,Yb,Gb,wb)=>{var dc=document.createElement("img");
dc.alt=lb;dc.className=Ca.getImageClassWithCluster(Yb,Gb);dc.src=jb;dc.setAttribute(sa.a.Kd,sa.a.Qs);lb=document.createElement("span");lb.className="ProtocolLaunchingDialogImg32Container";lb.appendChild(dc);dc=document.createElement("span");dc.className="ProtocolLaunchingDialogIconContainer";dc.appendChild(lb);wb.appendChild(dc)};class ha{static get ag(){return ba.a.Yo(ha.Ak,CommonUIStrings.l_OICLaunchDialogTitle)}}ha.Ak="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ha,"OICLaunchDialogHtml",null,[]);class Da extends ba.a{constructor(lb){super();this.bUa=this.SBa=null;this.Xoa=!1;this.hq=lb;this.ag=ha.ag;this.Sb=5;this.Ae="OICLaunchDialog";this.showDialog("",Object(J.a)(this,this.AEi,"oicLaunchDialogResultHandler"));this.ZYf();this.hW("ProtocolLaunchingDialogTitle");4!==R.AFrameworkApplication.ta.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.qI(this.SBa);k.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Z8a(){this.SBa=ua("BtnRichClient",this.hq.vrb,this.hq.Pwb,this.hq.Zid,CommonUIStrings.l_OICLaunchRichClient,Object(J.a)(this,this.GAf,"onRichClientButtonClick"),Z);document.getElementById("OICLaunchRichClient").appendChild(this.SBa);ea(this.SBa);this.bUa=ua("BtnReturn",this.hq.vrb,this.hq.Pwb,this.hq.q8e,CommonUIStrings.l_OICReturnToOnlineClient,Object(J.a)(this,this.DAf,"onReturnButtonClick"),
Z);document.getElementById("OICReturnToApp").appendChild(this.bUa);ea(this.bUa)}DAf(){this.hide();this.hq.hbb();return!0}GAf(){k.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();R.AFrameworkApplication.wb.processAction(X.a.SPa,2);return!0}AEi(){this.hq.hbb()}dispose(){this.Xoa||(this.SBa&&(Na.a.instance.Ba(za.a.click,this.SBa,Object(J.a)(this,this.GAf,"onRichClientButtonClick")),aa.KeyInputManager.instance.Ba(za.a.Gd,this.SBa,Z)),this.bUa&&(Na.a.instance.Ba(za.a.click,
this.bUa,Object(J.a)(this,this.DAf,"onReturnButtonClick")),aa.KeyInputManager.instance.Ba(za.a.Gd,this.bUa,Z)),super.dispose(),this.Xoa=!0)}}Object(b.a)(Da,"OICLaunchDialog",ba.a,[]);class nb{static get ag(){return ba.a.Yo(nb.Ak,CommonUIStrings.l_OICDialogTitle)}}nb.Ak="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(nb,"ProtocolLaunchingDialogV2Html",null,[]);a(414);var qa=a(107);class pa extends ba.a{constructor(lb){super();this.aUa=this.nea=null;this.Xoa=!1;this.Boa=null;this.hq=lb;this.ag=nb.ag;this.Sb=5;this.Ae="ProtocolLaunchingDialog";this.rFc="OICRetryDialog";R.AFrameworkApplication.Ji.n4a&&R.AFrameworkApplication.Ji.gsc();R.AFrameworkApplication.Ji.Hg(new qa.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(J.a)(this,this.rEd,"protocolLaunchingDialogResultHandler"));
this.ZYf();this.hW("Issues");this.PSe();k.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Z8a(){const lb=document.getElementById("Issues");if(lb){ya("",this.hq.vrb,this.hq.Pwb,this.hq.Zid,lb);const jb=document.createElement("span");jb.className="WACDialogSectionTitle";jb.innerText=5===this.hq.LDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;lb.appendChild(jb);ea(lb);lb.style.display="none"}R.AFrameworkApplication.ta.Pa.Rfd?
(this.aUa=ua("GiveFeedback",this.hq.vrb,this.hq.Pwb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(J.a)(this,this.Flc,"onGiveFeedbackClick"),Object(J.a)(this,this.Nwf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.aUa),ea(this.aUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===R.AFrameworkApplication.ta.Pa.editMode||R.AFrameworkApplication.Geh?document.getElementById("ButtonEdit").style.display="none":
(this.nea=ua("Edit",this.hq.vrb,this.hq.Pwb,"",2===R.AFrameworkApplication.ta.Pa.xj?4===R.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===R.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(J.a)(this,this.vvf,"onEditClick"),Object(J.a)(this,this.zvf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.nea),ea(this.nea));0===
R.AFrameworkApplication.ta.Pa.editMode&&!R.AFrameworkApplication.Jyb&&lb&&(lb.style.display="none")}RSe(){return this.Boa?(this.qI(this.Boa),!0):!1}PSe(){return this.nea?(this.qI(this.nea),!0):!1}zvf(lb){return this.Txd(lb,0)}Nwf(lb){return this.Txd(lb,2)}BAf(lb){return this.Txd(lb,1)}Txd(lb,jb){let Yb=!1;if(lb.Ca.keyCode===la.a.Zh||lb.Ca.keyCode===la.a.boa)lb.Cb.click(),Yb=!0;else if(lb.Ca.keyCode===Sys.UI.Key.down||lb.Ca.keyCode===Sys.UI.Key.up)switch(jb){case 1:Yb=this.PSe();break;case 0:Yb=this.RSe()}return Yb}vvf(){this.hide();
4===R.AFrameworkApplication.ta.Pa.editMode?(k.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.hq.hbb()):(k.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.hq.lgd());return!0}Flc(){k.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.hq.k4e();return!0}Emc(){k.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";R.AFrameworkApplication.wb.processAction(X.a.SPa,2);return!0}rEd(){this.hq.hbb()}switchToBackupMode(){var lb=
document.getElementById("ProtocolLaunchingDialogTitle");if(lb){lb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(lb=document.getElementById("Issues"))lb.style.display="block";(lb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!lb.children.length&&(this.Boa=ua("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(J.a)(this,this.Emc,"onRetryOICClick"),Object(J.a)(this,this.BAf,"onRetryOICKeyUp")),lb.appendChild(this.Boa),ea(this.Boa),this.nea||this.RSe())}}dispose(){this.Xoa||(this.nea&&
(Na.a.instance.Ba(za.a.click,this.nea,Object(J.a)(this,this.vvf,"onEditClick")),aa.KeyInputManager.instance.Ba(za.a.Gd,this.nea,Object(J.a)(this,this.zvf,"onEditKeyUp"))),this.aUa&&(Na.a.instance.Ba(za.a.click,this.aUa,Object(J.a)(this,this.Flc,"onGiveFeedbackClick")),aa.KeyInputManager.instance.Ba(za.a.Gd,this.aUa,Object(J.a)(this,this.Nwf,"onGiveFeedbackKeyUp"))),this.Boa&&(Na.a.instance.Ba(za.a.click,this.Boa,Object(J.a)(this,this.Emc,"onRetryOICClick")),aa.KeyInputManager.instance.Ba(za.a.Gd,
this.Boa,Object(J.a)(this,this.BAf,"onRetryOICKeyUp"))),super.dispose(),this.Xoa=!0)}}Object(b.a)(pa,"ProtocolLaunchingDialog",ba.a,[]);var Ja=a(133),$a=a(419);class rb extends Ja.StandardDialog{constructor(lb){super();this.hq=lb;this.Ae="ProtocolLaunchingDialog";R.AFrameworkApplication.Ji.n4a&&R.AFrameworkApplication.Ji.gsc();R.AFrameworkApplication.ta.Pa.Rfd&&this.cke(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(J.a)(this,this.Flc,"onGiveFeedbackClick"));rb.m5e?(this.Sb=12,this.sc(1,
CommonUIStrings.l_CloseFile),this.sc(2,CommonUIStrings.l_OICDialogContinueHere),this.sc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Sb=4,this.sc(1,CommonUIStrings.l_OICDialogContinueHere),this.sc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.SBb(CommonUIStrings.l_OICDialog2ndTitle,5===this.hq.LDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(J.a)(this,this.rEd,"protocolLaunchingDialogResultHandler"),null)}Flc(lb){k.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.Pvf(lb)}Emc(){k.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");R.AFrameworkApplication.wb.processAction(X.a.SPa,2)}rEd(lb){rb.m5e?3===lb?this.MSf():2===lb||0===lb?this.continueEditing():1===lb&&this.rYg():2===lb?this.MSf():(1===lb||0===lb)&&this.continueEditing()}rYg(){k.ULS.sendTraceTag(577783557,211,50,"Closing the document");R.AFrameworkApplication.wb.ae(X.a.close,2,$a.a)}MSf(){k.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(J.a)(this,
this.Emc,"onRetryOICClick"),0)}continueEditing(){4===R.AFrameworkApplication.ta.Pa.editMode||R.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===R.AFrameworkApplication.ta.mode?(k.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.hq.hbb()):(k.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.hq.lgd())}static get m5e(){return R.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===R.AFrameworkApplication.wb.processAction(X.a.close,
1)}}Object(b.a)(rb,"StandardProtocolLaunchingDialog",Ja.StandardDialog,[]);var Pa=a(1230);class eb{}Object(b.a)(eb,"EditDocumentInClientParams",null,[]);class Ob{static X5c(lb,jb,Yb,Gb,wb,dc,Jc=!1,Qc=!1,fd="",Wc=!1,Rb=!1,Sb=!1,mc="",ec="",Rc="",Mc=!1){const bc=new eb;bc.DocumentUrl=lb;bc.Mode=jb;bc.Options=Yb;bc.Application=Gb;bc.SilentExternalHandler=Jc;bc.EncodeUrl=Qc;bc.CorrelationIdForWinClient=fd;bc.NavigateUsingWindowOpen=Wc;bc.DescriptiveUnattemptedEnums=Rb;bc.NoBrowserModalDialogs=Sb;bc.SessionOrigin=
mc;bc.CorrelationId=ec;bc.ClickTime=Rc;bc.NewTelemetryDataIsEnabled=Mc;MSOJS.ClientUtils.EditDocumentInClient(bc,wb,dc)}}Object(b.a)(Ob,"ClientUtils",null,[]);var tb=a(98),cc=a(182),Ib=a(464),Mb=a(171),Oa=a(815),Aa=a(370),Ba=a(163),ob=a(69),xb=a(185);class Va{constructor(lb){this.gfa=this.$3d=this.hUa=null;this.xhb=!1;this.mLc=this.Xae=null;this.HPb=this.SD=this.PUb="";this.application=this.YB=0;this.iGj=this.oTd=!1;this.PTj=lb&&R.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");R.AFrameworkApplication.wb.n3(X.a.SPa)||
R.AFrameworkApplication.wb.Ob(X.a.SPa,U.a.frame,Object(J.a)(this,this.Qgj,"retryOpenInClientAction"));this.C3f=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.qa("SilentExternalHandler")}get LDf(){return this.YB}Quc(lb,jb="",Yb=""){this.SD=Yb||Mb.a.create().toString();this.PUb=jb||Ib.a.TZe();this.HPb=lb}Qgj(lb,jb,Yb){return jb.contextId!==U.a.frame?2:1===Yb?32:this.SPa()}get options(){let lb=0;R.AFrameworkApplication.Nej&&(lb|=1);R.AFrameworkApplication.openInClientEditOnly&&(lb|=4);this.fGj()&&
(lb|=64);return lb}fGj(){return!(2===this.application&&R.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get vrb(){return R.AFrameworkApplication.jB}get Pwb(){return R.AFrameworkApplication.K4a}get q8e(){return""}get Zid(){return""}get K6f(){return R.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get myc(){return this.Xae||(this.Xae=fa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.oTd||this.Wvh()}hbb(){this.iGj||this.lwh()}ALf(lb){this.PTj&&L.a.Zg?new Da(this):
this.D1b(lb)}D1b(lb){const jb=({JAa:lb}=this.Spi(lb)).returnValue;k.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===jb,lb);return jb}IFa(lb,jb,Yb,Gb,wb,dc){this.hUa=lb;this.$3d=jb;this.gfa=dc;this.application=Yb;this.YB=Gb;R.AFrameworkApplication.downloadCopyOnOpenInClient?this.Zif():R.AFrameworkApplication.limitedEdit&&!R.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?R.AFrameworkApplication.Y2f():this.$Mg(wb)}get zEi(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}SPa(){this.zEi&&this.Ssi();return this.D1b(this.xhb)}xWf(){const lb=new Oa.a(Ba.a.openInClient);lb.Values["ui-language"]=R.AFrameworkApplication.lcid.toString();lb.Values[Pa.a.i3c]=R.AFrameworkApplication.userSessionId;return this.gfa.value.send(lb)?32:8}Ssi(){tb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new xb.a,{inStaging:!0}))}xmj(lb){const jb=new Oa.a(Ba.a.XVj);jb.Values["ui-language"]=R.AFrameworkApplication.lcid.toString();
jb.Values[Pa.a.i3c]=R.AFrameworkApplication.userSessionId;jb.Values[Aa.a.WVj]=lb;this.gfa.value.send(jb)}Spi(lb){this.xhb=lb;this.xmj(5===this.YB?Va.WTi:Va.YTi);return 5===this.YB?this.Rpi():this.Wpi()}Rpi(){this.ejf();return{returnValue:32,JAa:"HostEditUrl,"}}Wpi(){let lb;var jb=lb="";R.AFrameworkApplication.Uke&&(jb="|f|"+R.AFrameworkApplication.userSessionId);const Yb=R.AFrameworkApplication.fa.qa("IsAssignmentMode")&&R.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
R.AFrameworkApplication.isUnifiedHostMode||L.a.Bwa,Gb=R.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),wb=R.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(R.AFrameworkApplication.wb.hkc){var dc=R.AFrameworkApplication.wb.TY(3588168074);dc&&this.Quc(dc.epochClickTime,dc.sessionOrigin,dc.correlationId);this.flf()}if(R.AFrameworkApplication.MGf){lb+="NewOrder,";dc=8;this.gfa&&this.gfa.value&&this.gfa.value.isEnabled()&&R.AFrameworkApplication.cYd&&(lb+="Post,",dc=this.xWf());if(32===
dc)return{returnValue:dc,JAa:lb};k.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return R.AFrameworkApplication.lm.C9a?(k.ULS.shipAssertTag(5566816,211,!!R.AFrameworkApplication.lm.C9a),lb+="HostUrl,",{returnValue:R.AFrameworkApplication.ta.p8a(R.AFrameworkApplication.lm.C9a),JAa:lb}):this.hUa?(k.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",R.AFrameworkApplication.userSessionId),lb+="DocUrl,",Ob.X5c(this.hUa,this.YB,
this.options,this.application,Object(J.a)(this,this.yvf,"onEditInClientSuccess"),Object(J.a)(this,this.xvf,"onEditInClientFailure"),this.C3f,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),jb,Yb,Gb,wb,this.PUb,this.SD,this.HPb,R.AFrameworkApplication.wb.hkc),{returnValue:32,JAa:lb}):{returnValue:8,JAa:lb}}lb+="OldOrder,";if(!this.hUa&&R.AFrameworkApplication.lm.C9a)return this.gfa&&this.gfa.value&&this.gfa.value.isEnabled()&&R.AFrameworkApplication.cYd?(lb+="Post,",jb=this.xWf()):(k.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),jb=8),32!==jb?(k.ULS.shipAssertTag(22595484,211,!!R.AFrameworkApplication.lm.C9a),lb+="HostUrl,",{returnValue:R.AFrameworkApplication.ta.p8a(R.AFrameworkApplication.lm.C9a),JAa:lb}):{returnValue:jb,JAa:lb};k.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",R.AFrameworkApplication.userSessionId);lb+="DocUrl,";Ob.X5c(this.hUa,this.YB,this.options,this.application,Object(J.a)(this,this.yvf,"onEditInClientSuccess"),
Object(J.a)(this,this.xvf,"onEditInClientFailure"),this.C3f,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),jb,Yb,Gb,wb,this.PUb,this.SD,this.HPb,R.AFrameworkApplication.wb.hkc);return{returnValue:32,JAa:lb}}KQf(lb){R.AFrameworkApplication.Dn.setDw(8981,lb)}yvf(lb){this.KQf(lb);k.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===lb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.K6f||this.ejf(),this.flf()):this.oTd||this.closeApplication()}xvf(lb,jb=0){k.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",lb,jb);if(5===lb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Yb=!!this.$3d&&!this.xhb;let Gb=0;1===lb&&(Gb=2);6<=lb&&13>=lb&&(Gb=1,1===jb&&(this.oTd=!0));this.myc.hEi?(k.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Gb),ab.a.instance.u7g(this.xhb?Object(J.a)(this,this.nsf,"oicErrorDialogHandlerCloseForced"):Object(J.a)(this,this.osf,"oicErrorDialogHandlerNoCloseForced"),
Yb?Object(J.a)(this,this.Uxf,"onLaunchDownload"):null,this.tGe(!1)?Object(J.a)(this,this.A6h,"iHaveOfficeButtonHandler"):null,Gb,jb)):(k.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Gb),ab.a.instance.s7g(this.xhb?Object(J.a)(this,this.nsf,"oicErrorDialogHandlerCloseForced"):Object(J.a)(this,this.osf,"oicErrorDialogHandlerNoCloseForced"),Yb?Object(J.a)(this,this.Uxf,"onLaunchDownload"):null,Gb))}}flf(){try{const lb=[Object.assign(new ob.a,{name:"CorrelationId",string:this.SD}),
Object.assign(new ob.a,{name:"SessionOrigin",string:this.PUb}),Object.assign(new ob.a,{name:"ClickTime",string:this.HPb}),Object.assign(new ob.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];cc.a("OpenInClientCompleted",!0,0,lb)}catch(lb){k.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+lb.toString())}}ejf(){R.AFrameworkApplication.ta&&R.AFrameworkApplication.ta.Pa.nv&&R.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new rb(this):new pa(this)}nsf(){this.closeApplication()}osf(){this.hbb()}Uxf(){this.Zif()}A6h(){return this.tGe(!0)}tGe(lb){const jb=
(L.a.gdf||L.a.FH)&&!!R.AFrameworkApplication.Q4b;jb&&lb&&(x.a.Ve(R.AFrameworkApplication.Q4b,"_blank",void 0,"OpenInClient"),this.closeApplication());return jb}}Va.YTi="OpenInDesktop";Va.WTi="OpenInBrowser";Object(b.a)(Va,"AOpenInClientOperation",null,[]);var bb=a(5),ra=a(203),Qa=a(77),qb=a(59),Wa=a(320),ta=a(47),ib=a(45),Bb=a(189),Ub=a(90),Ta=a(31),mb=a(1),Qb=a(11),Lb=a(21),Jb=a(468),Ab=a(249),pb=a(252),va=a(149),db=a(583);class Ya extends Va{constructor(lb,jb,Yb){super(!0);this.Qa=new ma.a;this.w5c=
this.aTe=!1;this.E1b=this.Dm=this.uye=null;this.Xc=()=>{u.a.og(K.a(this.$).fd.activityState,W.a.wxd)||this.Rta.reset()};this.zIi=Gb=>{this.KQf(Gb)};this.yIi=()=>{this.Yyj()};this.$=lb;this.ea=lb.ea;this.VJ=jb;this.businessBar=Yb;this.ea.hk(this.Xc);this.Rta=T.hre(this.$);this.i0g();lb.da.Ga(55,this);this.zfa=fa.a.instance.Vb("Common.ISystemInitiatedFeedback")}get q8e(){return"EditInExcelWebApp_32x32x32"}get la(){this.Dm=this.Dm||new Bb.a;return this.Dm.token}get Zid(){return"excel32"}get K6f(){return this.ea.jc.inWebPart}z_g(){this.ALf(this.aTe)}D1g(){const lb=
this.$;e.TaskExtensions.Aa(this.VJ.value,jb=>{this.IFa(lb.workbookContext.ClientUrl,R.AFrameworkApplication.rY,1,lb.isEditMode?2:0,!0,new V.a(()=>jb.result))},this.la,3)}lgd(){0!==qb.a.tg.editMode&&(this.$.rb.$x=!1)}k4e(){const lb={};lb[bb.a.G7b]=!1;lb[bb.a.sU]="OpenInExcel";this.$.xd(802602464,Qa.a.Eb,8,lb)}R0c(){if(this.ea.hc){var lb=this.$;lb.isEditMode&&e.TaskExtensions.Aa(this.VJ.value,jb=>{this.IFa(lb.workbookContext.ClientUrl,R.AFrameworkApplication.rY,1,2,!1,new V.a(()=>jb.result))},this.la,
3)}}xAe(){this.ea.hc&&e.TaskExtensions.Aa(this.VJ.value,lb=>{this.IFa(this.$.workbookContext.ClientUrl,R.AFrameworkApplication.rY,1,this.$.isEditMode?2:0,!1,new V.a(()=>lb.result))},this.la,3)}Quc(lb){super.Quc(lb)}openInExcelClient(){this.ea.hc&&(this.$.isEditMode||e.TaskExtensions.Aa(this.VJ.value,lb=>{this.IFa(this.$.workbookContext.ClientUrl,R.AFrameworkApplication.rY,1,0,!1,new V.a(()=>lb.result))},this.la,3))}openInBrowser(){this.ea.hc&&e.TaskExtensions.Aa(this.VJ.value,lb=>{this.IFa(this.$.workbookContext.ClientUrl,
R.AFrameworkApplication.rY,1,5,!1,new V.a(()=>lb.result))},this.la,3)}downloadFile(lb){const jb=this.Ate(lb);this.Rta.downloadFile(jb,lb);this.tti()}tti(){R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.zfa&&this.zfa.execute(lb=>lb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}HDf(lb,jb=0){if(this.ea.hc){var Yb=this.$;K.a(Yb).dLa?this.IDf(lb,Yb):0<jb?this.ZDj(lb,
Yb,jb):this.O1f(Yb)}}IFa(lb,jb,Yb,Gb,wb,dc){this.$.rb.$x=!mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.jc.inWebPart;this.aTe=wb;this.E1b=null;this.w5c=!1;this.eNg(lb,jb,Gb,wb,dc)}D1b(lb){const jb=this.$.jc;k.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${jb.inEmbedView}, InWebPart:${jb.inWebPart}, DivSyndicated:${jb.isDivSyndicated}, Mode:${this.$.isEditMode?ra.a.edit:ra.a.view}`);return Ya.Udf()?(this.c1b(),Ob.X5c(this.hUa,
this.YB,this.options,1,this.zIi,this.yIi,!1,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),32):super.D1b(lb)}Wvh(){this.ORf();const lb=this.$;if(!this.ea.jc.inWebPart&&this.ea.hc&&!lb.isEditMode){const jb=new Ub.a(2145659238,Qa.a.Eb,this.$.Mc,0,null);this.uye=ta.a.instance.create(()=>{lb.Ka.Lb(jb)},0,ib.a.ZTi)}}dispose(){this.ea&&this.ea.Hk(this.Xc);l.a.rc([this.Qa,this.uye,this.Dm]);this.$=this.ea=null}lwh(){this.ORf()}Zif(){ta.a.instance.create(()=>{this.$.Ka.Lb(new Ub.a(-2028960985,Qa.a.Eb,
0,30,null))},0,ib.a.$Ti,!0,!0)}$Mg(lb){const jb=this.$,Yb=K.a(this.$).fd.activityState;Yb[Jb.a.hje]=!0;jb.isEditMode&&this.ea.hc?(this.c1b(),B.a(jb).ks(new Ab.a(y.a.Ox,5,()=>{jb.dI(!1);Yb[pb.a.lq]=y.a.e1b;Yb[Jb.a.ezg]=lb;Yb[W.a.i$c]=!0;jb.isEditMode&&(Yb[W.a.WS]=1,Yb[W.a.yX]=!0,Yb[va.a.$Wb]=!0,Yb[va.a.lSc]=!0);Yb[Jb.a.kje]=1455037301}))):this.ALf(lb)}B4f(){const lb=R.AFrameworkApplication.rY;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.p8a(lb,!0)){const jb=this.$.ea.jc;k.ULS.sendTraceTag(537154773,
0,50,`Url:[${lb}] IsEmbedded:[${jb.inEmbedView}] InWebPart:[${jb.inWebPart}] DivSyndicated:[${jb.isDivSyndicated}], Mode:[${this.$.isEditMode?ra.a.edit:ra.a.view}]`)}}else this.Rta.downloadFile(lb,-2028960985);this.w5c=!0;this.c1b()}oqi(){this.myc.Trf&&this.myc.Qhc(1)}pqi(){this.myc.Trf&&Qb.HelperMethods.Ve(M.a.LY(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}yqi(){Qb.HelperMethods.Ve(M.a.LY(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}zqi(){Qb.HelperMethods.Ve(M.a.LY(34),
"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}Ate(lb){const jb=new Sys.StringBuilder,Yb=this.$.workbookContext,Gb=this.$.ya;jb.append(this.$.dda);jb.append(Gb.FileHandlerRelativeUri);jb.append("?id=");jb.append(encodeURIComponent(w.a.lHb(Yb.WorkbookUri,"sc")));this.$.ea.hc&&(jb.append("&sessionId="),jb.append(encodeURIComponent(this.$.ea.sessionId)));switch(lb){case -974518828:jb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:jb.append("&workbookType=FullWorkbook");
break;case -1059172980:jb.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:jb.clear()}r.a.vYa(jb,Gb);return jb.toString()}i0g(){wa.a.instance.rWg();const lb=this.$.ya;MSOJS.ClientUtils.InitUrls(lb.RoamingAppsX86RootUrl,lb.RoamingAppsControlInstallerUrl,lb.RoamingAppsFirefoxExtensionUrl)}ORf(){const lb=this.$;this.ea.hc||Wa.a.vEd(lb,K.a(lb).fd);this.c1b();this.E1b&&this.E1b(this,this.w5c);lb.frame.xt.km(this.$.frame.Z$());lb.frame.tW.km(this.$.frame.Z$());lb.rb.$x=!1;Lb.g(lb).focus()}eNg(lb,
jb,Yb,Gb,wb){const dc=this.$;R.AFrameworkApplication.ta&&!Ya.Udf()&&(dc.frame.xt.hn(dc.frame.Z$()),dc.frame.tW.hn(dc.frame.Z$()));super.IFa(lb,jb,1,Yb,Gb,wb)}c1b(){const lb=this.$;K.a(lb).oi.activityName===y.a.openInExcelClient&&K.a(lb).fd.nM()}Yyj(){const lb=Ta.a.Yc(1,0,686,687,0,1341525452,"OpenInExcelActiveXError");B.a(this.$).tr([lb])}ZDj(lb,jb,Yb){let Gb=null;const wb=window.setTimeout(()=>{K.a(jb).Lqc(Gb);this.O1f(jb)},Yb);Gb=()=>{K.a(jb).dLa&&(K.a(jb).Lqc(Gb),window.clearTimeout(wb),this.IDf(lb,
jb))};K.a(jb).pTc(Gb)}O1f(lb){const jb=Ta.a.Yc(1,1,0,701,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");B.a(lb).tr([jb])}IDf(lb,jb){B.a(jb).ks(new Ab.a(y.a.Ox,5,()=>{jb.dI(!1);const Yb=K.a(jb).fd,Gb=Yb.activityState;Gb[pb.a.lq]=y.a.PHe;Gb[db.a.bXb]=jb.ea.jc.hasUnsupportedFeaturesForEdit;Gb[G.a.fSc]=lb;Yb.Kt(Ta.a.E$(this.businessBar.i6c,[1437034227]))}))}static Udf(){return 1<qb.a.getRegisteredEwaInstances().length}}Object(b.a)(Ya,"OpenInExcelOperation",Va,[362,3]);class gb extends d.a{constructor(lb){super();
this.$=lb;this.Fb();gb.h0g()}create(){if(this.$.da.za(55))this.qb(this.$.da.za(55));else{var lb=f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),jb=f.GetServiceTaskFactory.Ta(this.$.da,5,4,this.ib);e.TaskExtensions.Aa(P.Task.zL(lb,jb),()=>{this.qb(new Ya(this.$,new V.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.ib)),jb.result))},this.la,3)}}static h0g(){gb.qsf||(gb.qsf=!0,(new ka).ai(fa.a.instance),fa.a.instance.resolve("Common.IOfficeTrialExperience").Fg(),fa.a.instance.resolve("Common.IMacOfficeOffer").Fg())}}
gb.qsf=!1;Object(b.a)(gb,"OpenInClientFactory",d.a,[]);var Ka=a(114),ub=a(385);class ac extends Ka.a{constructor(lb,jb){super(lb,jb)}execute(lb){const jb=Object(m.a)(7,lb.Be);e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(jb.da,56,jb.la,0),Yb=>{jb.downloadCopyOnOpenInClient?(lb.activityState[ub.a.ije]=!0,Yb.result.B4f()):Yb.result.D1g()},jb.la,3);return 1}}Object(b.a)(ac,"OpenInExcelClientActivity",Ka.a,[]);class Ra extends d.a{constructor(lb){super();this.$=lb;lb.da.Ga(56,new gb(lb));this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.ib),()=>{this.qb(new ac(y.a.openInExcelClient,y.a.idle))},this.la)}}Object(b.a)(Ra,"OpenInExcelClientActivityFactory",d.a,[]);a.d(D,"a",function(){return na});const na=()=>{c.a.Fa(lb=>{lb.da.Ga(57,new Ra(lb));lb.da.Ga(60,new N(lb));lb.da.Ga(63,new F(lb))})}},1143:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(85),d=a(108),f=a(13),e=a(86),k=a(53),l=a(29),m=a(27),v=a(12),n=a(234),w=a(1051),r=a(5),u=a(258),x=a(1052),z=a(704),B=a(1252),y=a(90);class A extends z.a{constructor(eb,Ob,tb){super(eb,
Ob);this.fv=!0;this.command=tb}xo(eb){super.xo(eb);this.businessBar.$.Ka.Lb(new y.a(this.command,eb,this.businessBar.$.Mc,10,null))}}Object(t.a)(A,"CommandActionBusinessBarEntry",z.a,[]);class K extends A{constructor(eb,Ob,tb){super(eb,Ob,tb)}kD(eb){super.kD(eb)}}Object(t.a)(K,"EditAttemptReadOnlyBusinessBarEntry",A,[]);var G=a(43);class T extends z.a{constructor(eb,Ob,tb,cc){super(eb,Ob);this.error=tb;this.options=cc;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&
1&&(this.title=this.error.Caption);this.fv=!(cc&4)}xo(eb){super.xo(eb);this.error.Appearance&=-33;G.a(this.businessBar.$).tr([this.error])}}Object(t.a)(T,"ErrorBusinessBarEntry",z.a,[]);class W extends T{constructor(eb,Ob,tb,cc,Ib){super(eb,Ob,tb,cc);this.command=Ib;this.WY=!0}YZ(eb){super.YZ(eb);this.businessBar.$.Ka.Lb(new y.a(this.command,eb,this.businessBar.$.Mc,10,null))}}Object(t.a)(W,"ErrorAndCommandBusinessBarEntry",T,[]);var P=a(14);class E{constructor(eb,Ob,tb,cc,Ib,Mb,Oa,Aa,Ba){this.WI=
this.s7=this.eS=0;this.Wkg=eb;this.qJj=Ob;this.PO=tb;this.tpg=Oa;this.Khb=l.a.Xv(Ba);this.lng=Ba;this.blg=Aa;0!==cc&&(this.eS=cc);0!==Ib&&(this.s7=Ib);0!==Mb&&(this.WI=Mb)}get title(){return E.ga(this.qJj)}get message(){return E.ga(this.PO)}get messageId(){return this.PO}get PFa(){return this.Wkg}get actionButton(){return E.ga(this.eS)}get uFa(){return E.ga(this.s7)}get link(){return E.ga(this.WI)}get Sk(){return this.tpg}get ARg(){return this.blg}get hash(){return this.Khb}get alt(){const {BusinessBarControl:eb}=
a(1143);switch(this.Sk){case eb.Mha:return E.ga(26);case eb.fA:return E.ga(25);case eb.ui:return E.ga(24);default:return E.ga(0)}}get $6c(){return this.lng}static ga(eb){return P.a.instance.ga(eb)}}Object(t.a)(E,"EwaBusinessBarEntry",null,[]);class H extends E{constructor(eb,Ob,tb,cc,Ib,Mb,Oa,Aa){super(eb,0,Ob,tb,cc,Ib,Mb,Oa,Aa)}get title(){return""}}Object(t.a)(H,"EwaNoTitleBusinessBarEntry",E,[]);var F=a(70);class N extends z.a{constructor(eb,Ob){super(eb,Ob);this.WY=this.fv=!0}xo(eb){super.xo(eb);
this.set_visible(!1);this.businessBar.$.gI();this.businessBar.$.Ka.Lb(new y.a(1038998010,eb,this.businessBar.$.Mc,10,null))}YZ(eb){super.YZ(eb);this.businessBar.$.Ka.Lb(new y.a(-722953877,eb,this.businessBar.$.Mc,10,null))}kD(eb){this.businessBar.removeEntry(55);F.g(eb)}}Object(t.a)(N,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class J extends z.a{constructor(eb,Ob){super(eb,Ob);this.fv=!0;this.WY=!1}xo(eb){super.xo(eb);this.businessBar.$.Ka.Lb(new y.a(-722953877,eb,this.businessBar.$.Mc,
10,null))}kD(eb){this.businessBar.removeEntry(5);F.g(eb)}}Object(t.a)(J,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var R=a(11);class M extends z.a{constructor(eb,Ob,tb){super(eb,Ob);this.pwb=tb;this.fv=!0}xo(eb){super.xo(eb);R.HelperMethods.nV(this.businessBar.$.oG,this.pwb,this.businessBar.$.ZR)}}Object(t.a)(M,"HelpButtonBusinessBarEntry",z.a,[]);class L extends z.a{constructor(eb,Ob,tb){super(eb,Ob);this.pwb=tb;this.jva=!0}ola(eb){super.ola(eb);R.HelperMethods.nV(this.businessBar.$.oG,this.pwb,
this.businessBar.$.ZR)}}Object(t.a)(L,"HelpTextBusinessBarEntry",z.a,[]);var U=a(77);class X extends z.a{constructor(eb,Ob,tb,cc){super(eb,Ob);this.pwb=tb;this.command=cc;this.jva=!0;this.fv=1461300262!==cc}xo(eb){super.xo(eb);this.businessBar.$.Ka.Lb(new y.a(this.command,eb,this.businessBar.$.Mc,10,null))}ola(eb){super.ola(eb);const Ob=new y.a(-859308420,eb,this.businessBar.$.Mc,12,null);this.businessBar.$.Ka.Lb(Ob,{[U.a.Zf]:"HelpID="+this.pwb,["InputMethod"]:eb,[U.a.Oc]:r.a.pQ,[r.a.yda]:!0})}}Object(t.a)(X,
"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class da extends z.a{constructor(eb,Ob){super(eb,Ob);this.WY=this.fv=!0}xo(eb){super.xo(eb);this.set_visible(!1);this.businessBar.$.gI();this.businessBar.$.Ka.Lb(new y.a(-1081442996,eb,this.businessBar.$.Mc,10,null))}YZ(eb){super.YZ(eb);this.businessBar.$.Ka.Lb(new y.a(1702917262,eb,this.businessBar.$.Mc,10,null))}kD(eb){this.businessBar.removeEntry(59);F.g(eb)}}Object(t.a)(da,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",z.a,[]);var fa=
a(1054);class S extends z.a{constructor(eb,Ob){super(eb,Ob);(this.policyManager=eb.$.da.za(274))?(this.message=this.policyManager.loc,this.title=this.policyManager.title,this.jva=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}ola(eb){super.ola(eb);(eb=this.policyManager.dNi)&&eb(null)}}Object(t.a)(S,"PolicyBusinessBarEntry",z.a,[]);var ka=a(1053),V=a(1056),wa=a(1055);
a(414);var ma=a(182),ab=a(25);class ba extends z.a{constructor(eb,Ob){super(eb,Ob);this.fv=!0;this.title=""}xo(eb){super.xo(eb);ma.c(ab.a.YBi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(t.a)(ba,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var Ca=a(1050),Na=a(1276);class za extends z.a{constructor(eb,Ob){super(eb,Ob);this.vBa=Na.a.h3b();this.fv=!0;this.WY=this.vBa.VTj;this.title=this.vBa.title;this.message=this.vBa.message}get actionButton(){return this.vBa.Pte}get uFa(){return this.vBa.Rte}xo(eb){super.xo(eb);
this.vBa.wtf(null)}YZ(eb){super.YZ(eb);this.vBa.ztf(null)}kD(eb){super.kD(eb);this.vBa.NGe(null)}}Object(t.a)(za,"WildFireMobileAppBusinessBarEntry",z.a,[]);var la=a(245),aa=a(22),sa=a(215),ea=a(158),Z=a(46),ua=a(7),ya=a(171),ha=a(957),Da=a(69),nb=a(131);class qa extends z.a{constructor(eb,Ob,tb,cc){super(eb,Ob);this.automateCommandManager=tb.da.za(352);c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager);this.id=ya.a.create();this.$=tb;this.title=P.a.instance.ga(2274);this.message="";this.HSd=
P.a.instance.ga(2270);this.KVj=P.a.instance.ga(2271);this.Seg=P.a.instance.ga(2272);this.P0g=P.a.instance.ga(2273);this.update(cc)}update(eb){this.scriptLink=eb.scriptLink;this.runStatus=eb.runStatus;this.buttonText=eb.buttonText||"";this.Usi(eb.clickId);this.Vej();"preparing"===this.runStatus?(this.message=String.format(P.a.instance.mb(207),this.buttonText),this.fv=!0,this.lXa=this.HSd,this.npb=this.HEa=this.t9a):"running"===this.runStatus?(this.message=String.format(P.a.instance.mb(206),this.buttonText),
this.fv=!0,this.lXa=this.HSd,this.npb=this.HEa=this.t9a):"succeeded"===this.runStatus?(this.message=String.format(P.a.instance.mb(209),this.buttonText),this.fv=!0,this.lXa=this.Seg,this.HEa=this.gDf,this.WY=!0,this.wUc=this.KVj,this.xUc=this.aTi):"runFailed"===this.runStatus?(this.message=String.format(P.a.instance.mb(208),this.buttonText),this.C4a=Pa.Mha,this.fv=!0,this.lXa=this.Seg,this.HEa=this.gDf,"false"===eb.isOwner&&(this.WY=!0,this.wUc=this.P0g,this.xUc=this.kHi)):"fetchFailed"===this.runStatus?
(this.C4a=Pa.Mha,this.message=String.format(P.a.instance.mb(210),this.buttonText)):"canceled"===this.runStatus?(this.C4a=Pa.fA,this.message=String.format(P.a.instance.mb(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.C4a=Pa.fA,this.message=String.format(P.a.instance.mb(211),this.buttonText),this.fv=!0,this.lXa=this.HSd,this.npb=this.HEa=this.t9a):"initializing"===this.runStatus&&(this.C4a=Pa.ui,this.message=P.a.instance.ga(2275))}get Sk(){return this.C4a}get actionButton(){return this.lXa}get uFa(){return this.wUc}xo(eb){super.xo(eb);
this.HEa&&this.HEa()}YZ(eb){super.YZ(eb);this.uFa&&this.xUc()}kD(eb){super.kD(eb);this.npb&&this.npb()}Vej(){this.message="";this.C4a=Pa.ui;this.fv=!1;this.lXa="";this.HEa=void 0;this.WY=!1;this.wUc="";this.xUc=void 0;this.r4a=!1;this.npb=void 0}t9a(){const eb=ya.a.create().toString();this.automateCommandManager.N0h(eb);this.pic(-2186799,eb)}gDf(){const eb=ya.a.create().toString();this.automateCommandManager.M0h(eb);this.pic(1036446140,eb)}aTi(){const eb=ya.a.create();if(this.scriptLink){const Ob=
new ha.b(this.scriptLink);this.automateCommandManager.O4e(this.id.toString(),JSON.stringify(Ob),eb)}this.pic(-585097204,eb.toString())}kHi(){const eb=ya.a.create().toString();this.automateCommandManager.L0h(eb);this.pic(-639858579,eb)}Usi(eb){const Ob=[];Ob.push(Object(ua.a)(new Da.a,{name:"id",string:this.id.toString()}));Ob.push(Object(ua.a)(new Da.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Ob.push(Object(ua.a)(new Da.a,{name:"runStatus",string:this.runStatus}));Ob.push(Object(ua.a)(new Da.a,
{name:"clickId",string:eb}));Ob.push(Object(ua.a)(new Da.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ma.a(nb.a.mEi,void 0,void 0,Ob)}pic(eb,Ob){const tb=[];tb.push(Object(ua.a)(new Da.a,{name:"id",string:this.id.toString()}));tb.push(Object(ua.a)(new Da.a,{name:"hasScriptLink",bool:!!this.scriptLink}));tb.push(Object(ua.a)(new Da.a,{name:"runStatus",string:this.runStatus}));tb.push(Object(ua.a)(new Da.a,{name:"clickId",string:Ob}));ma.d(eb,void 0,void 0,void 0,void 0,void 0,
tb)}}Object(t.a)(qa,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var pa=a(47),Ja=a(1);class $a extends A{constructor(eb,Ob,tb,cc,Ib,Mb){super(eb,Ob,tb);pa.a.instance.create(()=>{if(this.businessBar&&this.businessBar.sLa(Ob.PFa)){const Oa=new y.a(-847286761,0,this.businessBar.$.Mc,0,null),Aa={["CalloutName"]:cc,["Target"]:Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.eS.domElement};this.businessBar.$.Ka.Lb(Oa,
Aa)}},Ib,Mb,!0,!0)}}Object(t.a)($a,"CalloutBusinessBarEntry",A,[]);var rb=a(19);a.d(D,"BusinessBarControl",function(){return Pa});class Pa extends n.a{constructor(eb,Ob){super(Ob);this.IBh=v.DOMElementExtensions.lr+",div";this.OT=Array(70);this.zm=!1;this.kV=tb=>{if(tb.Ca.keyCode===b.a.dA){var cc=this.lc.querySelectorAll(this.IBh);const Ib=v.DOMElementExtensions.Ll(cc);cc=v.DOMElementExtensions.iz(cc);return v.DOMElementExtensions.Kma(tb.Ca,Ib,cc)}return!1};this.jb=eb;this.set_visible(!1);this.addCssClass(w.a.Hlh);
Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(w.a.Rlh);d.KeyInputManager.instance.ra(f.a.Mb,this.lc,this.kV);u.a(eb).Xh(this)}get Zd(){return la.a.nXc}get lc(){return this.domElement}get jf(){return this.get_visible()}get $(){return this.jb}gg(eb,Ob){Ob||v.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Ob}hh(eb){return v.DOMElementExtensions.uf(this.lc,eb)}kj(){}Mj(){}dispose(){this.zm||(d.KeyInputManager.instance.Ba(f.a.Mb,
this.lc,this.kV),e.a.rc(this.OT),this.OT=Array(70),this.jb=null,super.dispose(),this.zm=!0)}sLa(eb){if(!this.get_visible())return!1;eb=this.OT[eb];return!!eb&&eb.isVisible}yE(eb){return!!this.OT[eb]}oNb(eb,Ob){if(eb=this.OT[eb])eb.update(Ob),eb.NPj()}hE(eb,Ob,tb=null,cc=null){let Ib=!1;if(this.yE(eb))tb=this.OT[eb].get_visible();else{this.set_visible(!0);const Oa=Pa.L2e()[eb];this.OT[eb]=this.c$(eb,Ob,tb,cc);tb=!1;Ib=!0;cc="";let Aa=0;Ob&&(cc=Ob.MessageIdName,Aa=Ob.MessageId);const Ba=Oa.$6c;var Mb=
Z.PageLoadTrackingInfo.instance.HJa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${eb}, time from app interactive: ${Mb}`);Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(Mb=this.OT.filter(ob=>null!=ob).length,1<Mb&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${Mb.toString()}`));ea.a(this.$).VId(Oa.hash,cc,Aa,k.a.ozc,!0,1,Ob,Ba)}tb||!B.a.Nac().includes(eb)&&!Ib||(this.OT[eb].set_visible(!0),this.$.gI())}removeEntry(eb){return this.z9i(eb)}WGd(){e.a.rc(this.OT);
this.OT=Array(70);this.set_visible(!1)}z9i(eb){if(!this.yE(eb))return!1;e.a.Ia(this.OT[eb]);this.OT[eb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.gI();return!0}c$(eb,Ob,tb=null,cc=null){const Ib=Pa.L2e()[eb],Mb=!!(this.$.Bd&64);switch(eb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:eb=new z.a(this,Ib);break;case 12:case 29:case 30:case 31:case 32:case 34:case 57:eb=Mb?new A(this,Ib,-8805455):new z.a(this,Ib);break;case 22:eb=new K(this,Ib,-8805455);break;case 46:case 45:eb=
Mb?new W(this,Ib,Ob,0,-8805455):new T(this,Ib,Ob,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:eb=new T(this,Ib,Ob,0);break;case 19:eb=new z.a(this,Ib);break;case 47:eb=new T(this,Ib,Ob,0);break;case 6:case 14:eb=new M(this,Ib,Ob.HelpTopicId);break;case 68:case 66:eb=new L(this,Ib,Ob.HelpTopicId);break;case 37:eb=new L(this,Ib,r.a.Hah);break;case 38:eb=new z.a(this,Ib);break;case 69:eb=new K(this,Ib,924877417);break;case 16:eb=new z.a(this,Ib);eb.title=l.a.Dg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);
eb.message=l.a.Dg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:eb=new A(this,Ib,-1762562205);eb.r4a=!0;break;case 20:eb=new za(this,Ib);break;case 21:case 56:eb=new z.a(this,Ib);break;case 28:eb=new z.a(this,Ib);break;case 24:eb=new ba(this,Ib);break;case 27:eb=new S(this,Ib);break;case 39:eb=new Ca.a(this,Ib);break;case 40:eb=new x.a(this,Ib);break;case 41:eb=new ka.a(this,Ib);break;case 42:eb=new fa.a(this,Ib);break;case 48:eb=new z.a(this,Ib);break;case 49:eb=new z.a(this,
Ib);break;case 50:eb=new z.a(this,Ib);break;case 51:eb=new z.a(this,Ib);break;case 52:eb=new z.a(this,Ib);break;case 53:eb=new wa.a(this,Ib);break;case 54:eb=new V.a(this,Ib);break;case 55:eb=new N(this,Ib);break;case 5:eb=new J(this,Ib);break;case 58:eb=new A(this,Ib,-1753056834);Ob?(Ob=Ob.Directive,aa.a.yq(Ob)||"&nbsp;"===Ob||(eb.message=Ob)):tb&&(eb.message=tb);break;case 59:eb=new da(this,Ib);break;case 60:eb=new z.a(this,Ib);break;case 61:case 64:eb=new L(this,Ib,r.a.wDi);break;case 62:eb=new X(this,
Ib,r.a.RMg,-8805455);break;case 67:eb=new X(this,Ib,r.a.M4i,1461300262);break;case 63:eb=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new $a(this,Ib,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new A(this,Ib,515196233);break;case 65:eb=new qa(this,Ib,this.$,cc);break;default:eb=new T(this,Ib,Ob,7)}eb.H1c();return eb}static L2e(){let eb;eb=sa.a.xLa()?263:262;return Pa.Fte||(Pa.Fte=[new E(0,278,279,
280,0,0,Pa.Mha,1,"BB_UnableToRefreshLock"),new E(1,278,279,280,0,0,Pa.Mha,1,"BB_UnableToRefreshLockExpected"),new E(2,270,271,0,0,0,Pa.fA,5,"BB_WorkbookAlmostTooLarge"),new E(3,272,273,274,0,0,Pa.Mha,1,"BB_WorkbookTooLarge"),new E(4,261,eb,0,0,0,Pa.fA,5,"BB_ExternalWorkbookLinksDisabled"),new E(5,265,264,266,0,0,Pa.Mha,1,"BB_ExternalWorkbookLinksShowError"),new E(6,267,268,269,0,0,Pa.ui,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new E(7,253,254,255,0,0,Pa.ui,5,"BB_UnsupportedFeatures"),new E(8,
0,0,0,0,0,Pa.ui,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new E(9,0,0,0,0,0,Pa.ui,0,"BB_CollabDataStringsLocaleMismatch"),new E(10,0,0,0,0,0,Pa.ui,0,"BB_CollabDataLocaleMismatch"),new E(11,281,282,283,0,0,Pa.Mha,1,"BB_LastGenericStatusError"),new E(12,284,285,286,0,0,Pa.fA,5,"BB_ScratchPadWarning"),new E(13,287,288,289,0,0,Pa.Mha,1,"BB_AuthenticationLost"),new E(14,290,291,292,0,0,Pa.fA,5,"BB_OdfCompatibilityIssues"),new E(15,0,580,0,0,0,Pa.fA,5,"BB_PivotChartInteractivityMissingWarning"),new E(16,
0,0,0,0,0,Pa.ui,2,"BB_WorkbookIsIrmProtected"),new E(17,0,0,0,0,0,Pa.ui,0,"BB_BIFeatureNotAvailable"),new E(18,293,294,289,0,0,Pa.fA,5,"BB_AnonymousCreateMode"),new E(19,256,257,0,0,0,Pa.fA,5,"BB_UnsupportedInteractiveReportEditing"),new E(20,0,0,0,0,0,Pa.ui,0,"BB_MobileAppCampaignBizBar"),new E(21,299,300,0,0,0,Pa.ui,0,"BB_TransientServerCommunicationFailures"),new E(22,1640,1651,1652,0,0,Pa.ui,5,"BB_EditAttemptInReadOnly"),new E(23,1640,1651,0,0,0,Pa.ui,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),
new E(24,0,R.HelperMethods.iPj(),1629,0,0,Pa.ui,3,"BB_UnsupportedBrowser"),new E(25,302,303,0,0,0,Pa.ui,2,"BB_ReadOnlyPermissions"),new E(26,304,305,0,0,0,Pa.ui,2,"BB_DocumentIsIrmProtectedWarning"),new E(27,0,0,0,0,0,Pa.fA,5,"BB_PolicyWarningMessage"),new E(28,1283,301,0,0,0,Pa.ui,0,"BB_WorkingOnIt"),new E(29,1640,1638,1639,0,0,Pa.ui,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new E(30,1653,1654,1655,0,0,Pa.ui,5,"BB_WorkbookIsReadOnlyRecommended"),new E(31,1640,1656,1657,0,0,Pa.ui,5,"BB_WorkbookHasPasswordToModify"),
new E(32,1640,1658,1661,0,0,Pa.ui,3,"BB_LegacySharedWorkbookEditWarning"),new E(33,1648,1659,255,0,0,Pa.ui,5,"BB_LegacyConnectionsWarning"),new E(34,1640,1954,1652,0,0,Pa.ui,0,"BB_TooManyLoadBlockingFloatingObjects"),new E(35,1649,1650,0,0,0,Pa.ui,2,"BB_GroupedSlicers"),new E(36,315,316,0,0,0,Pa.fA,5,"BB_ThirdPartyAddinDisabled"),new E(37,1781,1782,0,0,1783,Pa.ui,5,"BB_FinanceLinkedEntityDisclaimerBar"),new E(38,1810,1811,0,0,0,Pa.fA,5,"BB_WolframDeprecationAlertBar"),new E(39,0,0,0,0,0,Pa.ui,0,"BB_WacGdprNotice"),
new E(40,0,0,0,0,0,Pa.ui,0,"BB_AutomaticSensitivityLabel"),new E(41,0,0,0,0,0,Pa.ui,0,"BB_RecommendedSensitivityLabel"),new E(42,0,0,0,0,0,Pa.ui,0,"BB_MandatorySensitivityLabel"),new E(43,317,318,319,0,0,Pa.ui,0,"BB_LocalStorageDisabled"),new E(44,637,638,0,0,0,Pa.ui,0,"BB_AutoRefreshDisabled"),new E(45,1009,1007,1011,1312,0,Pa.ui,4,"BB_CorruptedFileRepaired"),new E(46,1010,1008,1011,1312,0,Pa.ui,5,"CorruptedOdsFileRepaired"),new E(47,275,276,277,0,0,Pa.fA,5,"BB_MinorVersionLimitReached"),new E(48,
306,307,0,0,0,Pa.fA,5,"BB_SensitivityApplicationGenericError"),new E(49,308,310,0,0,0,Pa.fA,5,"BB_SensitivityApplicationTooLargeFileError"),new E(50,309,310,0,0,0,Pa.fA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new E(51,311,312,0,0,0,Pa.fA,5,"BB_SensitivityApplicationLabelDisabledError"),new E(52,313,314,0,0,0,Pa.fA,5,"BB_SensitivityApplicationMandatoryConflictError"),new E(53,0,0,0,0,0,Pa.fA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new E(54,0,0,0,0,0,Pa.fA,5,"BB_SensitivityApplicationSetLabelError"),
new E(55,2113,2114,2115,2118,0,Pa.ui,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new E(56,299,300,0,0,0,Pa.ui,0,"BB_NetworkDown"),new E(57,320,321,322,0,0,Pa.ui,2,"BB_DefaultToViewDueToCogs"),new E(58,1807,1808,1809,0,0,Pa.ui,1,"BB_RefreshLinkedEntityErrorBar"),new E(59,1784,1785,1786,1787,0,Pa.ui,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new H(60,252,0,0,0,Pa.ui,5,"BB_CanvasHealth"),new E(61,323,324,0,0,325,Pa.ui,0,"BB_NovModeDepreciation"),new E(62,1012,1013,1312,0,1014,Pa.ui,5,"BB_MismatchedFileFormatConverted"),
new E(63,2230,2231,2232,0,0,Pa.ui,5,"BB_OptimizeWorkbook"),new E(64,326,327,0,0,328,Pa.ui,0,"BB_NovModePostDepreciation"),new E(65,0,0,0,0,0,Pa.ui,0,"BB_OfficeScriptsRunning"),new E(66,2206,2207,0,0,2209,Pa.ui,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new E(67,329,330,0,0,331,Pa.ui,5,"BB_ReadOnlyPivotTable"),new E(68,2206,2208,0,0,2209,Pa.ui,0,"BB_PowerQueryRefreshHostNotSupported"),new E(69,1051,m.a.zfc?1053:1052,1050,0,0,Pa.ui,4,"BB_RefreshPageAfterEnablingTheExtension")])}}Pa.Mha=rb.a.Zoh;
Pa.fA=rb.a.aph;Pa.ui=rb.a.$oh;Pa.Fte=null;Object(t.a)(Pa,"BusinessBarControl",n.a,[110])},1145:function(t,D,a){var c=a(10);t=a(0);var b=a(690),d=a(50),f=a(37),e=a(15),k=a(1065),l=a(147),m=a(24),v=a(77),n=a(58);class w{constructor(ra){this.options=null;this.options=ra}}Object(t.a)(w,"MacroRecorderRangeCustomSortedPayload",null,[116]);var r=a(952),u=a(953),x=a(42),z=a(510),B=a(368),y=a(170),A=a(247),K=a(145),G=a(31),T=a(281),W=a(1),P=a(181),E=a(22),H=a(280),F=a(21),N=a(795),J=a(747),R=a(260),M=a(209),
L=a(14),U=a(133);class X{constructor(ra){this.gw=Qa=>{switch(Qa){case 0:this.UMa("Cancel");break;case 1:this.UMa("Expand and sort");this.VPe(!0);break;case 2:this.UMa("Just sort"),this.VPe(!1)}};this.VPe=ra}show(){const ra=new U.StandardDialog;ra.Sb=11;ra.sc(1,L.a.instance.ga(2120));ra.sc(2,L.a.instance.ga(2121));ra.U2f(L.a.instance.ga(2119),L.a.instance.Xa(649),this.gw)}UMa(ra){e.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${ra}`)}}Object(t.a)(X,"ExpandSortSelectionDialog",
null,[]);const da=(ra,Qa)=>{ra=ra.ColumnInfo;switch(Qa){case 1:return ra.CellColors&&ra.CellColors.length?!0:(e.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return ra.TextColors&&ra.TextColors.length?!0:(e.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),
!1);case 3:return ra.Icons&&ra.Icons.length?!0:(e.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return e.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},fa=(ra,Qa,qb,Wa)=>{ra=ra.HeaderColumnInfo;return Wa||ra?2===Qa&&qb?ra.CellColors&&1!==ra.CellColors.length?(e.ULS.sendTraceTag(537151626,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):ra.TextColors&&1!==ra.TextColors.length?(e.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):ra.Icons&&1!==ra.Icons.length?(e.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),
!1):!0:ra?(e.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${qb} == 0.`),!1):!0:!0};var S=a(184);class ka{static isValid(ra){return ka.Cwh.includes(ra.Position)?!0:(e.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${ra.Position}]`),!1)}}ka.Cwh=[0,.5,1];Object(t.a)(ka,"FillGradientStopExtension",null,[]);
class V{constructor(ra,Qa,qb,Wa){new Sys.UI.Point(ra,Qa);new Sys.UI.Point(qb,Wa)}}Object(t.a)(V,"GradientLine",null,[]);class wa{static isValid(ra){if(!(ra.Degree.toString()in wa.Awh))return e.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${ra.Degree}]`),!1;if(!ra.GradientStops)return e.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(ra.GradientStops.length<wa.Czi||ra.GradientStops.length>wa.kyi)return e.ULS.shipAssertTag(537159827,
0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${ra.GradientStops.length}]`),!1;for(const Qa of ra.GradientStops)if(!ka.isValid(Qa))return!1;return!0}}wa.Czi=2;wa.kyi=3;wa.Awh={["0"]:new V(0,0,1,0),["180"]:new V(1,0,0,0),["90"]:new V(0,0,0,1),["270"]:new V(0,1,0,0),["45"]:new V(0,0,1,1),["225"]:new V(1,1,0,0),["135"]:new V(1,0,0,1),["315"]:new V(0,1,1,0)};Object(t.a)(wa,"FillGradientExtension",null,[]);const ma=ra=>ra.SortRange?4===ra.SortRangeType?(e.ULS.sendTraceTag(537151622,
0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${ra.SortRangeType}`),!1):2===ra.SortRangeType&&ra.SortTopToBottom&&(null==ra.HeaderRowSize||0>ra.HeaderRowSize)?(e.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(e.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),ab=ra=>{if(!ra.SortConditions)return!0;
for(const Qa of ra.SortConditions){if(!Ca(ra,Qa.RowColOffset))return e.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Qa.RowColOffset}] is out of bounds. sort range: ${ra.SortRange}`),!1;if(1===Qa.SortConditionType&&Qa.FillGradient&&!wa.isValid(Qa.FillGradient))return e.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ba=(ra,Qa)=>{if(!ra.SortColumnInfoItems)return e.ULS.sendTraceTag(537151618,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var qb=new S.a;for(var Wa of ra.SortColumnInfoItems){if(!Ca(ra,Wa.ColumnOffset))return e.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${Wa.ColumnOffset}] is out of bounds. sort range: ${ra.SortRange}`),!1;if(!Wa.Name)return e.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${Wa.ColumnOffset}]`),!1;if(Wa.CellColors&&
!Wa.CellColors.length)return e.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${Wa.CellColors.length}]`),!1;if(Wa.TextColors&&!Wa.TextColors.length)return e.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${Wa.TextColors.length}]`),!1;if(Wa.Icons&&!Wa.Icons.length)return e.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${Wa.Icons.length}]`),
!1;qb.add(Wa.ColumnOffset)}if(ra.SortConditions)for(const ta of ra.SortConditions)if(!qb.contains(ta.RowColOffset))return e.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${ta.RowColOffset}]`),!1;if(ra.HeaderColumnInfoItems){if(ra.HeaderColumnInfoItems.length!==ra.SortColumnInfoItems.length)return e.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),
!1;for(qb=0;qb<ra.HeaderColumnInfoItems.length;++qb){Wa=ra.HeaderColumnInfoItems[qb];if(Qa&&Wa.ColumnOffset!==ra.SortColumnInfoItems[qb].ColumnOffset)return e.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Wa.CellColors&&1<Wa.CellColors.length)return e.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),
!1;if(Wa.TextColors&&1<Wa.TextColors.length)return e.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Wa.Icons&&1<Wa.Icons.length)return e.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},Ca=(ra,Qa)=>{const qb=ra.SortRange;ra=ra.SortTopToBottom?qb.LastColumn-qb.FirstColumn:qb.LastRow-
qb.FirstRow;return 0<=Qa&&Qa<=ra};var Na=a(378),za=a(131),la=a(96),aa=a(97),sa=a(132);class ea extends Na.a{constructor(ra,Qa){super(ra,Qa);this.RBb=this.Mad();this.ur()}get oc(){return"SortMergedCellsErrorDialog"}fO(ra,Qa){if(1===ra){var qb=x.v(this.RBb,this.$);F.g(this.$).vg(qb,null,null,null,0,aa.a.zCj)}qb={["DialogButton"]:ra,["Location"]:"dialog"};sa.b(this.$).Cd(za.a.BCj,qb,null,!0);super.fO(ra,Qa)}ur(){super.ur();const ra=this.xCj();this.Sb=1;this.sc(1,L.a.instance.ga(2237));this.yl(L.a.instance.ga(2238),
la.a.zh(ra),1,this.b0)}xCj(){return String.format(L.a.instance.mb(174),this.RBb.toString())}Mad(){const ra=this.error.Description.split("_");return new m.Range(Number.parseInvariant(ra[1])+1,Number.parseInvariant(ra[2])+1,Number.parseInvariant(ra[3])+1,Number.parseInvariant(ra[4])+1,!0,!1)}}Object(t.a)(ea,"SortMergedCellsErrorDialog",Na.a,[]);var Z=a(68),ua=a(571),ya=a(605);class ha extends N.a{constructor(ra,Qa,qb,Wa){super(ra);this.pec=this.TPd=!1;this.O5=[];this.zci=(ta,ib)=>{const Bb=this.T5g(ta);
this.TKa(214,(Ub,Ta,mb)=>A.o(this.$.pa.va,Bb,this.SZa(Ub,this.nEh(ib)),this.uT(Ta),mb,null),16,!0)};this.yci=(ta,ib,Bb)=>{ta=A.n(this.$.pa.va,ib,this.$Eh(ib,Bb),this.jLi,null,ta);this.O5.push(ta)};this.jLi=()=>{e.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.$4b(ha.kqb())};this.M4c=(ta,ib)=>{if(1===ta){ta=ib.sortRangeType;const Bb={};Bb.SortOptions=ib.sortOptions;Bb.ShouldRestoreSelection=this.TPd;
Bb.SelectedRange=this.selectedRange;Bb.OriginalActiveCell=this.onc;Bb.TopCellAddress=this.FSa;Bb.ShouldPromptNamedSheetViewTeachingDialog=W.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?0===ta||3===ta:!1;if(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&this.Fwj(ta)){const Ub=this.$;this.namedSheetViewPublic.aAa().continueWith(Ta=>{Ta.result&&ha.TJf(Ub,Bb)})}else ha.TJf(this.$,Bb)}else this.TPd&&this.Wna(this.selectedRange,
this.onc)};this.T5h=(ta,ib)=>{this.TPd=!0;this.Wna(ta,ib)};this.getColorName=ta=>J.a.BJa(M.a.hH(ta));e.ULS.shipAssertTag(529105669,0,!!Qa.ActiveCell);e.ULS.shipAssertTag(529105668,0,!!Qa.SelectedRange);e.ULS.shipAssertTag(529105667,0,x.D(Qa.SelectedRange).contains(x.C(Qa.ActiveCell)));e.ULS.shipAssertTag(529105666,0,E.a.equals(Qa.SelectedRange.SheetName,Qa.ActiveCell.SheetName,!0));W.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.tbb=new ya.a(ra,ua.a.hah,()=>this.pec,
1));this.selectedRange=Qa.SelectedRange;this.onc=Qa.ActiveCell;this.rTg=Qa.ExpandSelection;this.namedSheetViewPublic=qb;this.FSa=Wa;this.initializeAndShow(L.a.instance.ga(183),this.M4c,this.ysa(Qa))}dispose(){this.pec||(this.pec=!0,this.$_b(),this.O5=null,W.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.tbb.dispose(),this.tbb=null));super.dispose()}get oc(){return"CustomSortDialog"}get ha(){return F.g(this.$).ha}nEh(ra){return Qa=>{if(T.b(Qa,-901005882))Z.a(this.$).fd.fJ(-901005882),
this.oEd();else if(T.b(Qa,-569193796))Z.a(this.$).fd.fJ(-569193796),this.hide(),new ea(this.$,Qa.Errors[0]);else if(T.a(Qa))e.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide();else{Qa=Qa.Result;this.$.Wj(Qa.SortRange);var qb=W.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");Qa&&ma(Qa)&&ab(Qa)&&ba(Qa,qb)?ra(Qa):this.$4b(ha.kqb())}}}$Eh(ra,Qa){return(qb,Wa)=>{if(this.pec)e.ULS.sendTraceTag(529105635,
0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!qb||T.a(qb))e.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${G.a.zc(qb.Errors)}`),this.$.ea.vp(qb.Errors),this.hide();else{qb=qb.Result;var ta=ra.RangeType,ib=ra.HeaderRowSize,Bb=ra.SortTopToBottom;qb&&da(qb,ra.ConditionType)&&fa(qb,ta,ib,Bb)?(qb.ColumnInfo.ColumnOffset=Wa,void 0!==qb.HeaderColumnInfo&&
null!==qb.HeaderColumnInfo&&(qb.HeaderColumnInfo.ColumnOffset=Wa),Qa(qb,ra.ConditionType,ra.SortTopToBottom)):(e.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.$4b(ha.kqb()))}}}Fwj(ra){return!!this.namedSheetViewPublic&&(0===ra||3===ra)}T5g(ra){const Qa={};Qa.SelectedRange=this.selectedRange;Qa.ActiveCell=this.onc;Qa.SortInfoMode=ra;Qa.ExpandSortSelection=this.rTg;Qa.ExpandSortSelectionSupported=
!0;return Qa}ysa(ra){const Qa={};Qa[R.a.Uu]=this.oc;Qa.fromAutoFilter=ra.FromAutoFilter;Qa.gridRTL=F.g(this.$).rtl;Qa.activeCell=ra.ActiveCell;Qa.selectedRange=ra.SelectedRange;Qa.invokeGetSortInfo=this.zci;Qa.invokeGetSortConditionColorsOrIcons=this.yci;Qa.highlightSortRange=this.T5h;Qa.getColorName=this.getColorName;return Qa}Wna(ra,Qa){ra=x.D(ra);this.ha.sa.Wc.equals(ra)||this.ha.updateSelection(ra,x.C(Qa),0,void 0,void 0,void 0,!0)}oEd(){(new X(ra=>{const Qa={};Qa.ActiveCell=this.onc;Qa.SelectedRange=
this.selectedRange;Qa.ExpandSelection=ra;Qa.FromAutoFilter=!1;this.$.xd(-207540907,v.a.Eb,8,{["SortCommandData"]:Qa})})).show()}$_b(){if(void 0!==this.O5&&null!==this.O5)for(const ra of this.O5)this.$.pa.va.beb(ra.Ot)}static TJf(ra,Qa){ra.xd(1659552324,v.a.Eb,8,{["CustomSortCommandData"]:Qa})}static kqb(){return G.a.Yc(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(t.a)(ha,"CustomSortDialog",N.a,[]);var Da=a(1066);class nb{constructor(ra){this.selection=null;this.selection=ra}getSelection(){return this.selection}}
Object(t.a)(nb,"MacroRecorderRangeAutoFilterClearedPayload",null,[116]);class qa{constructor(ra){this.filterRange=null;this.filterRange=ra}}Object(t.a)(qa,"MacroRecorderRangeFilterReappliedPayload",null,[116]);var pa=a(62);const Ja=(ra,Qa,qb,Wa,ta,ib,Bb=null)=>{Bb=ra.Na(41,Bb);Bb.options=Qa;return pa.g(ra,"Sort",Bb,qb,Wa,ta,ib,0)},$a=(ra,Qa,qb,Wa,ta,ib,Bb=null)=>{Bb=ra.Na(41,Bb);Bb.selectedRange=Qa;return pa.g(ra,"ClearAutoFilter",Bb,qb,Wa,ta,ib,0)},rb=(ra,Qa,qb,Wa,ta,ib,Bb=null)=>{Bb=ra.Na(41,Bb);
Bb.filterRange=Qa;return pa.g(ra,"ReapplyAutoFilter",Bb,qb,Wa,ta,ib,0)};var Pa=a(767),eb=a(768),Ob=a(111),tb=a(55),cc=a(1067),Ib=a(196),Mb=a(36),Oa=a(338),Aa=a(64);class Ba{constructor(ra,Qa){this.sortOptions=this.NRa=this.selectedRange=null;this.$af=!1;this.activeCell=this.we=this.ub=this.nc=null;this.onContentReady=()=>{this.PMf(!1);const qb=this.ha();qb.sa.xg&&qb.sa.Wc.equals(this.NRa)&&(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?qb.updateSelection(this.selectedRange,
x.C(this.activeCell),0,void 0,void 0,void 0,!0):qb.updateSelection(this.selectedRange,qb.sa.activeCell,0,void 0,void 0,void 0,!0))};this.SKi=(qb,Wa)=>{qb&&!G.a.rg(qb.Errors)&&this.nc&&(this.nc.Oo=qb.Result,this.IJb(),this.applyPivotSort(Wa))};this.RKi=()=>{};this.sSi=(qb,Wa)=>{Wa&&Wa.KJj&&Wa.selection&&Mb.a.cdf()&&(qb=Aa.d(this.$.xa.oa),this.LJj(new Oa.a(x.D(Wa.selection),qb)))};this.$=ra;this.Nif="";this.namedSheetViewPublic=Qa;this.gridView=F.g(this.$);this.$.Hb.Ng("LoadResource","LoadDialogControlsStopwatch")}Qc(ra,
Qa){return!this.Cod(ra,Qa)}executeCommand(ra,Qa,qb){let Wa=null;ra=Qa.command;switch(ra){case -864298118:Wa=this.fgh(Qa,qb);break;case -1010737776:Wa=this.r5c(!0,Qa,qb);break;case 2123420468:Wa=this.r5c(!1,Qa,qb);break;case -1089513346:qb=this.NWe(qb);if(!this.ozb([x.D(qb.SortOptions.SelectedRange)]))return f.TaskExtensions.vk();Wa=this.qHe(Qa,qb);break;case -1032691499:case -764711886:case -2016161444:Wa=this.a1i(Qa,qb);break;case -207540907:case -1677817820:Wa=this.gridView.Db.o4(this.ha().sa.activeCell)?
this.R0i():this.O0i(Qa,qb);break;case 1659552324:Wa=this.qHe(Qa,this.NWe(qb));break;case 368460465:Wa=this.vgh(Qa,qb);break;case 529856798:Wa=this.agh(Qa);break;case 644342024:Wa=this.qgh(Qa)}return Wa||P.a(ra)}Ec(ra,Qa){if(ra=1===ra)switch(Qa.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:ra=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1);break;default:ra=!1}return ra}Vc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}PMf(ra){ra?this.gridView.Nu(this.onContentReady):this.gridView.qy(this.onContentReady);this.$af=ra}get sa(){return this.ha().sa}Jxj(ra){return!!this.sortOptions&&E.a.equals(this.Nif,ra.sha,!0)}Cod(ra,Qa){const qb=F.g(this.$).ha.sa.selectedRanges;return(new K.a(this.$.xa)).om(ra,Qa,qb,this.gridView)}r5c(ra,Qa,qb){const Wa=new k.a;W.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?
this.p9e(Wa,qb,ra):(Wa.OperationType=0,Wa.IsAscending=ra,Wa.HasHeader=!0,Wa.GuessHeader=!0,Wa.SortTopToBottom=!0,Wa.ExpandSortSelectionSupported=!0,qb&&void 0!==qb[Ba.jna]&&null!==qb[Ba.jna]?(qb=qb[Ba.jna],Wa.ActiveCell=qb.ActiveCell,Wa.SelectedRange=qb.SelectedRange,Wa.ExpandSortSelection=qb.ExpandSelection):(Wa.ActiveCell=x.o(this.sa.activeCell,this.$),Wa.SelectedRange=x.v(this.sa.Wc,this.$),Wa.ExpandSortSelection=null));return this.ozb([x.D(Wa.SelectedRange)])?this.gridView.Db.o4(x.D(Wa.SelectedRange))?
this.ngh(ra):this.Fkd(Wa,Qa):f.TaskExtensions.vk()}fgh(ra,Qa){e.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let qb=null;const Wa=this.ha();Wa&&(this.Jxj(Wa)?this.ozb(Wa.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,qb=this.Fkd(this.sortOptions,ra)):qb=this.r5c(!0,ra,Qa));return qb}ozb(ra){return W.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.oq(ra,!0,1):this.$.hVc(ra,!0,1):!0}ngh(ra){this.USh(ra);return tb.Task.Ua(!0)}bQg(ra){if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Qa=this.gridView.Db.Xj(this.sa.Wc,!1);if(Qa)return new u.a(Qa.name,this.sa.activeCell.left-Qa.usedRange.left,ra.IsAscending)}return new r.a(ra)}Fkd(ra,Qa){this.gridView.Cf.UG(!1);const qb=()=>this.bQg(ra);return this.G6c((Wa,ta,ib)=>Ja(this.$.pa.va,ra,H.b(Wa,this.aFh(Qa)),ta,
ib,ra),Wa=>new y.a(141,0,Wa,void 0,qb),Qa,this.Ewj(ra))}Ewj(ra){if(!this.namedSheetViewPublic)return!1;const Qa=this.sa.Wc,qb=x.v(this.sa.Wc,this.$),Wa=this.gridView.Db.JLa(Qa,!0),ta=this.sa.aba()&&this.gridView.Db.Oef(qb),ib=this.gridView.Db.aki(qb);ra=(Qa.x4||Qa.xZ)&&!Qa.isSingle&&(null==ra.ExpandSortSelection?!1:ra.ExpandSortSelection)&&this.gridView.Db.Oef(qb);return Wa||ta||ib||ra}R0i(){return this.$.xd(-1556797033,v.a.Eb,8,null)}O0i(ra,Qa){ra=8===ra.Re&&Qa&&void 0!==Qa[Ba.jna]&&null!==Qa[Ba.jna]?
Qa[Ba.jna]:19===ra.Re&&Qa&&void 0!==Qa[v.a.Zf]&&null!==Qa[v.a.Zf]?n.a.Uh(Qa[v.a.Zf]):this.W4g();if(!this.ozb([x.D(ra.SelectedRange)]))return f.TaskExtensions.vk();F.g(this.$).Cf.UG(!1);let qb=null;(Qa=Qa.TopCellAddress)&&(qb=x.o(Qa,this.$));new ha(this.$,ra,this.namedSheetViewPublic,qb);return tb.Task.Ua(!0)}NWe(ra){return ra[Ba.gah]}qHe(ra,Qa){const qb=Ub=>{W.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&this.J5e(Ub)?this.u4e(Ub.Errors[0]):(Qa.ShouldRestoreSelection&&
this.Wna(Qa.SelectedRange,Qa.OriginalActiveCell),e.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${ra.Re}`),this.FLj(Qa))},Wa=()=>{Qa.ShouldRestoreSelection&&this.Wna(Qa.SelectedRange,Qa.OriginalActiveCell);e.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${ra.Re}`)},ta=(Ub,Ta,mb)=>Ja(this.$.pa.va,Qa.SortOptions,H.b(Ub,qb),H.a(Ta,Wa),mb,this.sortOptions),
ib=()=>new w(Qa.SortOptions),Bb=Ub=>new y.a(187,0,Ub,void 0,ib);return W.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.G6c(ta,Bb,null,Qa.ShouldPromptNamedSheetViewTeachingDialog):B.a(this.$.userOperationManager,ta,Bb,null)}Wna(ra,Qa){ra=x.D(ra);F.g(this.$).ha.sa.Wc.equals(ra)||F.g(this.$).ha.updateSelection(ra,x.C(Qa),0,void 0,void 0,void 0,!0)}W4g(){const ra={};ra.ActiveCell=x.o(this.sa.activeCell,this.$);ra.SelectedRange=x.v(this.sa.Wc,this.$);ra.FromAutoFilter=
!1;ra.ExpandSelection=null;return ra}vgh(ra,Qa){const qb=this.Y$();if(!qb)return tb.Task.Ua(!1);const Wa=this.$.pa.va.Qb(),ta=()=>new Da.a(qb);return W.EwaSettings.fc()?B.a(this.$.userOperationManager,(ib,Bb,Ub)=>A.A(this.$.pa.va,qb,H.b(Pa.a.Sua(Ob.a.VYa,eb.a.toggleAutoFilter,ib),this.sSi),Bb,Ub,{selection:qb,KJj:Qa.On},Wa),ib=>new y.a(516,0,ib,64,ta),ra):B.a(this.$.userOperationManager,(ib,Bb,Ub)=>A.A(this.$.pa.va,qb,Pa.a.Sua(Ob.a.VYa,eb.a.toggleAutoFilter,ib),Bb,Ub,null,Wa),ib=>new z.a(516,0,ib,
void 0,ta),ra)}agh(ra){const Qa=this.Y$();if(!Qa)return tb.Task.Ua(!1);var qb=this.gridView.Db.Xj(this.sa.Wc,!0);qb&&e.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${qb.type.toString()}`);const Wa=this.$.pa.va.Qb(),ta=()=>new nb(Qa);qb=W.EwaSettings.fc()?ib=>new y.a(517,0,ib,64,ta):ib=>new z.a(517,0,ib,void 0,ta);return this.G6c((ib,Bb,Ub)=>$a(this.$.pa.va,Qa,Pa.a.Sua(Ob.a.Ara,eb.a.clearAutoFilter,ib),Bb,Ub,null,Wa),qb,ra)}G6c(ra,Qa,qb,Wa=!0){return this.namedSheetViewPublic&&
Wa?this.namedSheetViewPublic.aAa().continueWith(ta=>{ta.result&&B.a(this.$.userOperationManager,ra,Qa,qb)}):B.a(this.$.userOperationManager,ra,Qa,qb)}qgh(ra){const Qa=this.Y$();if(!Qa)return tb.Task.Ua(!1);const qb=this.$.pa.va.Qb(),Wa=()=>new qa(Qa);return W.EwaSettings.fc()?B.a(this.$.userOperationManager,(ta,ib,Bb)=>rb(this.$.pa.va,Qa,Pa.a.Sua(Ob.a.Ara,eb.a.uKf,ta),ib,Bb,null,qb),ta=>new y.a(518,0,ta,64,Wa),ra):B.a(this.$.userOperationManager,(ta,ib,Bb)=>rb(this.$.pa.va,Qa,Pa.a.Sua(Ob.a.Ara,eb.a.uKf,
ta),ib,Bb,null,qb),ta=>new z.a(518,0,ta,void 0,Wa),ra)}aFh(ra){return(Qa,qb)=>{var Wa;T.b(Qa,-901005882)?(Z.a(this.$).fd.fJ(-901005882),this.oEd(qb,ra.command)):this.J5e(Qa)?this.u4e(Qa.Errors[0]):!T.a(Qa)&&Qa.Result&&(this.sortOptions=qb,this.NRa=x.D(Qa.Result.ActualSortRange),this.Nif=this.ha().sha,this.$af||(this.selectedRange=this.sa.Wc,this.selectedRange.equals(this.NRa)||(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=x.o(this.sa.activeCell,
this.$)),this.NAj())),(null===(Wa=this.sortOptions)||void 0===Wa?0:Wa.ActiveCell)&&(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||this.G1f(this.sortOptions))&&(Qa=this.sortOptions.ActiveCell,Qa=new m.Range(Qa.FirstRow+1,Qa.FirstColumn+1,Qa.FirstRow+1,Qa.FirstColumn+1,!0,!1),this.sL(Qa),this.KVd(Qa)))}}J5e(ra){return T.b(ra,-569193796)}u4e(ra){Z.a(this.$).fd.fJ(-569193796);new ea(this.$,ra)}oEd(ra,Qa){(new X(qb=>{const Wa={};Wa.ActiveCell=ra.ActiveCell;Wa.SelectedRange=
ra.SelectedRange;Wa.ExpandSelection=qb;this.$.xd(Qa,v.a.Eb,8,{[Ba.jna]:Wa})})).show()}NAj(){const ra=this.ha();if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Qa=x.C(this.activeCell);this.NRa.Fe(Qa)||(Qa=this.NRa.topLeft);ra.updateSelection(this.NRa,Qa,0,void 0,void 0,void 0,!0)}else ra.updateSelection(this.NRa,ra.sa.activeCell,0,void 0,void 0,void 0,!0);this.PMf(!0)}Y$(){const ra=this.ha();if(!ra)return e.ULS.shipAssertTag(537151573,0,!!ra,
"SelectionManger is null"),null;this.gridView.Cf.UG(!1);return x.v(ra.sa.Wc,this.$)}IJb(){this.nc&&this.nc.Oo&&(this.we=this.nc.Oo,this.ub=this.nc.W9b())}USh(ra){if(this.$.isEditMode&&(this.nc=this.gridView.Db.ap(this.sa.activeCell))){this.activeCell=x.o(this.sa.activeCell,this.$);if(this.nc&&this.nc.Oo){var Qa=this.nc.Oo.CurrentCol;if(this.nc.Oo.CurrentRow===this.activeCell.FirstRow&&Qa===this.activeCell.FirstColumn){this.IJb();this.applyPivotSort(ra);return}}this.$.pa.va.Qb();Qa=new y.a(228,0,(qb,
Wa,ta)=>A.k(this.$.pa.va,this.activeCell,H.b(qb,this.SKi),H.a(Wa,this.RKi),ta,ra),16);this.$.userOperationManager.Ub(Qa,null)}}applyPivotSort(ra){if(this.nc&&this.ub&&this.activeCell&&this.we){var Qa=8===this.we.CellArea,qb=1===this.we.CellArea||2===this.we.CellArea;(Qa||qb)&&8!==this.we.CellType&&4!==this.we.CellType&&(Qa?B.a(this.$.userOperationManager,(Wa,ta,ib)=>A.b(this.$.pa.va,this.activeCell,ra?1:2,this.ub.Caption,Wa,ta,ib,null),Wa=>new y.a(1015,0,Wa,void 0,null),null):(Qa=1===this.we.CellArea?
1:2,this.$.ma(689)?l.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.nc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.nc.isOlap?"":this.ub.Caption,Qa,ra):l.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.nc.externalSourceIndex,this.ub.Index.toString(),ra)))}}FLj(ra){this.G1f(ra.SortOptions)&&(ra.TopCellAddress?ra=x.C(ra.TopCellAddress):(ra=ra.OriginalActiveCell,ra=new m.Range(ra.FirstRow+1,ra.FirstColumn+1,ra.FirstRow+
1,ra.FirstColumn+1,!0,!1)),this.sL(ra))}sL(ra){Mb.a.Yaa(this.$)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,430,431,1),Qa=>{Qa.result.b7(ra);e.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}KVd(ra){W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,476,475,0),Qa=>{Qa.result.KVd(ra,0);e.ULS.sendTraceTag(537151570,
0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)}a1i(ra,Qa){if(!this.ozb(this.sa.selectedRanges))return f.TaskExtensions.vk();const qb=new k.a;this.p9e(qb,Qa);qb.SortConditions=[this.l8g(ra)];qb.OperationType=2;return this.Fkd(qb,ra)}l8g(ra){const Qa=this.gridView.Xb(this.sa.activeCell);let qb=new cc.a;qb.IsAscending=!0;switch(ra.command){case -1032691499:Qa.Ovb?(ra=Ib.a.Zo(Qa.backgroundColor),qb.SortColor=ra.UR(!0)):qb.SortColor=Ba.NoColor;
qb.SortConditionType=1;break;case -764711886:qb.SortColor=Qa.G_c===Ba.NoColor?Ba.NoColor:Ib.a.ise(Qa.G_c);qb.SortConditionType=2;break;case -2016161444:Qa.Vvb?(qb.SortIcon=Qa.cell.fhc,qb.SortIconSet=Qa.ghc):(qb.SortIcon=Ba.x_d,qb.SortIconSet=Ba.x_d);qb.SortConditionType=3;break;default:e.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return qb}LJj(ra){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,
426,427,1),Qa=>{void Qa.result.GVd(ra,"Filter")},this.$.la,3)}p9e(ra,Qa,qb=!0){ra.OperationType=0;ra.IsAscending=qb;ra.HasHeader=!0;ra.GuessHeader=!0;ra.SortTopToBottom=!0;ra.ExpandSortSelectionSupported=!0;Qa&&Qa[Ba.jna]?(Qa=Qa[Ba.jna],ra.ActiveCell=Qa.ActiveCell,ra.SelectedRange=Qa.SelectedRange,ra.ExpandSortSelection=Qa.ExpandSelection):(ra.ActiveCell=x.o(this.sa.activeCell,this.$),ra.SelectedRange=x.v(this.sa.Wc,this.$),ra.ExpandSortSelection=null)}G1f(ra){return!ra.SortConditions||ra.SortConditions.some(Qa=>
0===Qa.SortConditionType)}}Ba.gah="CustomSortCommandData";Ba.jna="SortCommandData";Ba.x_d=-1;Ba.NoColor=0;Object(t.a)(Ba,"SortCommandHandler",null,[188]);class ob extends b.a{constructor(ra){super(ra)}Dd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,309,310,this.ib),ra=>{this.ld([new Ba(this.$,ra.result)])},this.$.la,3)}static ka(ra){b.a.Rd(160,new ob(ra))}}Object(t.a)(ob,"SortCommandHandlerFactory",b.a,[]);N=a(220);class xb{constructor(ra){ra.da.Ga(446,this)}u9g(ra,Qa){new ea(ra,Qa)}}
Object(t.a)(xb,"SortUtil",null,[324]);class Va extends N.a{constructor(ra){super();this.$=ra;this.Fb()}create(){let ra=this.$.da.za(446);ra||(ra=new xb(this.$),this.$.da.Ga(446,ra));this.qb(ra)}static ka(ra){ra.da.Ga(447,new Va(ra))}}Object(t.a)(Va,"SortUtilFactory",N.a,[]);a.d(D,"a",function(){return bb});const bb=()=>{c.a.Fa(ra=>{ob.ka(ra);Va.ka(ra)})}},1149:function(t,D,a){t=a(0);var c=a(547),b=a(15),d=a(133),f=a(53);class e extends d.StandardDialog{constructor(){super();this.Sb=0;this.sc(1,CommonUIStrings.l_DialogClose)}displayError(qa,
pa){this.XGe(qa,pa,f.a.Lij)}XGe(qa,pa,Ja){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ja);this.Wz(Ja,qa,pa,null)}f5c(qa,pa){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Wz(f.a.Nij,qa,pa,null,!0)}}Object(t.a)(e,"ErrorDialog",d.StandardDialog,[341]);var k=a(83);d=a(1045);var l=a(144);class m{static get ag(){return l.a.Yo(m.Ak,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}m.Ak="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(t.a)(m,"FileNameDialogHtml",null,[]);var v=a(4),n=a(13),w=a(44),r=a(85),u=a(88),x=a(29);class z extends d.a{constructor(qa,pa,Ja,$a,rb,Pa,eb,Ob){super(qa,pa,Ja,$a,rb,Pa,Ob);this.spa=this.HOc=this.Jy=null;this.LRg=CommonUIStrings.l_SaveToAnotherFolder;this.ag=m.ag;this.Ae="FileNameDialog-SaveToSharePoint";this.pkb=eb;this.Jsg=Ob}MP(qa){const pa=x.a.rq(v.AFrameworkApplication.lm.Ym),Ja=v.AFrameworkApplication.breadcrumbFolderName,$a=v.AFrameworkApplication.breadcrumbBrandName,rb={["txtFileName"]:qa||
pa};let Pa=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.ta.Pa.xj&&(Pa=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Pa,Object(k.a)(this,this.L7b,"fileNameDialogHandler"),rb);this.FGe(qa,pa);this.CHa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.Jy=document.getElementById("anotherFolder"),qa=document.getElementById("folderLocation"),this.HOc=
u.a.gpe(qa,this.Jy,"anotherFolderDescribedBy"),this.Jy.className="WACButton WACDialogButtonNormal",qa=!1,Ja&&Ja.length?(this.Hje(this.Jy,this.HOc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,$a,Ja)),qa=this.Gzg($a,Ja)):this.Hje(this.Jy,this.HOc,CommonUIStrings.l_CurrentOnlineFolder),this.GAg(this.Jy),this.Jzg(this.Jy),qa?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Jy,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Jy,"SaveToAnotherLocationOne"),w.a.addHandler(this.Jy,n.a.click,Object(k.a)(this,this.$zd,"onSaveToAnotherLocationClick")),w.a.addHandler(this.Jy,n.a.Mb,Object(k.a)(this,this.OAf,"onSaveToAnotherLocationKeyDown")))}Gzg(qa,pa){let Ja;Ja=!1;const $a=document.getElementById("currentLocation");$a.innerText="";const rb=this.AZe($a,qa),Pa=this.AZe($a,pa);let eb=255,Ob=255;255<rb+Pa&&(eb=Math.max(238,408-rb),Ob=
Math.max(170,408-Pa),Ja=!0);this.fCg($a,qa,Ob,pa,eb);return Ja}AZe(qa,pa){const Ja=document.createElement("div");Ja.innerText=pa;Ja.style.visibility="hidden";qa.appendChild(Ja);pa=Ja.clientWidth;qa.removeChild(Ja);return pa}fCg(qa,pa,Ja,$a,rb){pa&&(this.Fje(qa,pa,Ja),this.YBg(qa));$a&&this.Fje(qa,$a,rb)}Fje(qa,pa,Ja){const $a=document.createElement("div");$a.innerText=pa;$a.title=pa;$a.className="SaveToAnotherFolderBreadcrumb";$a.style.maxWidth=Ja.toString()+"px";qa.appendChild($a)}YBg(qa){const pa=
document.createElement("span");pa.id="FolderSeparator";const Ja=document.createElementNS("http://www.w3.org/2000/svg","svg");Ja.setAttribute("class","SeparatorCaret");const $a=document.createElementNS("http://www.w3.org/2000/svg","polygon");$a.setAttribute("points","1 4 1 11 5 7.5");Ja.appendChild($a);pa.appendChild(Ja);qa.appendChild(pa)}Hje(qa,pa,Ja){Ja=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ja);pa&&(pa.innerText=Ja);qa.tabIndex=0;qa.setAttribute(u.a.Kd,u.a.Ps)}Jzg(qa){const pa=
document.createElement("span");pa.id="anotherFolderText";pa.innerText=this.LRg;pa.className="AnotherFolderTextSpan";qa.appendChild(pa)}GAg(qa){const pa=document.createElement("span");pa.className="cui-img-cont-float cui-img-16by16 ";this.spa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.spa.setAttribute("class","FolderIconSVG");const Ja=document.createElementNS("http://www.w3.org/2000/svg","path");Ja.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.spa.appendChild(Ja);pa.appendChild(this.spa);qa.appendChild(pa)}OAf(qa){!qa||qa.keyCode!==r.a.Zh&&qa.keyCode!==r.a.w0||this.$zd(qa)}$zd(){if(this.QI){const qa=x.a.o3(v.AFrameworkApplication.fileName);let pa=this.QI.value;this.hide();pa&&""!==pa&&""!==qa||1===this.ta.state?(""!==qa&&(pa+=qa),this.M7b(pa)?this.Ds.create().displayError(1,pa,!1):this.pkb.start(pa,this.Jsg)):this.Ds.create().displayError(2,pa,!1)}}sVg(qa){this.Jy&&this.spa&&(qa?(this.Jy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Jy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.spa,"DisabledFolderIconSVG")):(this.Jy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Jy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.spa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Jy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.spa,"DisabledFolderIconSVG"))))}ngd(){super.ngd();this.sVg(!!this.QI&&""!==this.QI.value)}dispose(){this.Jy&&(w.a.removeHandler(this.Jy,n.a.click,Object(k.a)(this,
this.$zd,"onSaveToAnotherLocationClick")),w.a.removeHandler(this.Jy,n.a.Mb,Object(k.a)(this,this.OAf,"onSaveToAnotherLocationKeyDown")),this.Jy=null);super.dispose()}}Object(t.a)(z,"FileNameDialog",d.a,[365]);var B=a(680),y=a(548),A=a(184),K=a(804),G=a(901),T=a(98),W=a(134);class P{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(t.a)(P,"SaveAsDialogInput",null,[]);class E{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(t.a)(E,"SaveLocation",null,[]);var H=a(370),F=a(185);class N{constructor(qa,pa,Ja,$a,rb,Pa,eb,Ob,tb){this.OKc=null;this.rA="";this.pkb=qa;this.Ds=pa;this.Ih=tb;this.Nfa=Ja;this.We=rb;this.Lv=$a;this.vEa=eb;this.IWa=Ob;Pa&&(this.OKc=new c.a(()=>new K.a(Pa.value,null)))}NKh(){const qa=new B.a(y.a.Rk());qa.ia("type","currentHost");return Object.assign(new E,{folderName:this.Lv.breadcrumbFolderName,friendlyPath:this.Lv.breadcrumbBrandName,properties:qa})}Fli(qa){return!!qa&&"ClassicMru"===
qa.type&&!!qa.service_info&&!!qa.service_info.service_id&&-1!==qa.service_info.service_id.indexOf("SHAREPOINT")}nWh(){if(!this.OKc||!this.vEa)return null;var qa=this.OKc.value.SY("SaveAsToSharePointDialog",!1);if(!qa||3!==qa.state||!qa.Mpf)return null;qa=qa.Mpf;const pa=new A.a;let Ja=0,$a=0;for(var rb=0;rb<qa.length;rb++){var Pa=qa[rb];if(!this.Fli(Pa))continue;Ja++;if(!Pa.sharepoint_info)continue;const eb=Pa.url,Ob=Pa.sharepoint_info.site_url,tb=Pa.title;Pa=G.b(Pa,v.AFrameworkApplication.isRtl);
if(!(eb&&Ob&&tb&&Pa))continue;$a++;const cc=new B.a(y.a.Rk());cc.ia("type","SharePoint");cc.ia("siteUrl",Ob);cc.ia("folderUrl",eb);$a++;pa.add(Object.assign(new E,{folderName:tb,friendlyPath:Pa,properties:cc}))}rb=new Map;rb.set("NumPlaces",qa.length.toString());rb.set("NumSharepointPlaces",Ja.toString());rb.set("placesWithMetadata",$a.toString());T.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",rb);0<Ja&&($a?.5>1*$a/Ja&&T.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):T.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return pa}ELh(){const qa=new A.a;qa.add(this.NKh());const pa=this.nWh();pa&&qa.addRange(pa);return Object.assign(new P,{enableMoreLocations:!v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.rA,extension:x.a.o3(this.Lv.Ym),saveLocations:qa.toArray(),scenario:"SaveToSharePoint"})}$9b(){const qa=Object(k.a)(this,this.ELh,
"getDialogInput"),pa={};pa.inputPropsCallback=qa;return pa}MP(qa){this.rA=qa;this.rA||(this.rA=String.format(CommonUIStrings.l_SaveACopy_Filename,x.a.rq(this.Lv.Ym)));qa={["id"]:"SaveAsDialog",["bodyControls"]:this.$9b()};let pa=CommonUIStrings.L_SaveAs;2===this.We.Pa.xj&&(pa=CommonUIStrings.L_SaveACopy);const Ja=new l.a(!1,!1,!0);Ja.Sb=1;Ja.Ae="SaveAsDialog";Ja.sc(1,CommonUIStrings.l_SaveButtonLabel);Ja.initializeAndShow(pa,Object(k.a)(this,this.Hij,"saveAsDialogHandler"),qa)}Qzj(qa,pa){qa&&""!==
qa&&""!==pa||1===this.We.state?this.Eli()?this.hsi(qa,pa):(""!==pa&&(qa+=pa),this.pkb.start(qa,this.Ih)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Ds.create().displayError(2,qa,!1))}hsi(qa,pa){T.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Ja=this.IWa.oCe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.IWa.wcd(Ja).then($a=>{if($a&&0<$a.length){const rb=
$a[0][H.a.$Wi];$a=$a[0][H.a.FFf];if(""!==rb&&""!==$a)this.vEa.lna($a,qa+pa,rb,this.Ih),T.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Ds.create().displayError(0,qa,!1);const Pa=W.a.Kr();Pa&&(Pa.set("SiteUrlAvailable",""===rb?"false":"true"),Pa.set("FolderUrlAvailable",""===$a?"false":"true"));T.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new F.a,{extendedProperties:Pa}))}}else this.Ds.create().displayError(0,qa,
!1),T.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch($a=>{"Canceled"===$a?(($a=W.a.Kr())&&$a.set("IsCanceled","true"),T.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new F.a,{extendedProperties:$a}))):T.Health.instance.recordKpiFailure("SaveACopySFP",$a,!1,!1,null)})}Eli(){return this.IWa?this.IWa.Xod():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Hij(qa,pa){if(pa&&1===qa){qa=pa.fileName;var Ja=x.a.o3(this.Lv.Ym);
pa.moreLocationsSelected&&this.Qzj(qa,Ja);if(pa.locationCallback){var $a=pa.locationCallback();$a?$a.properties&&"currentHost"===$a.properties.na("type")?this.Nfa.lna(qa+Ja,!1,this.Ih):$a.properties&&"SharePoint"===$a.properties.na("type")?(pa=$a.properties.na("siteUrl"),$a=$a.properties.na("folderUrl"),this.vEa.lna($a,qa+Ja,pa,this.Ih)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(t.a)(N,"ReactSaveAsDialog",null,[365]);class J{constructor(qa,pa,Ja,$a,rb,Pa,eb,Ob=null,tb=null,cc=null){this.La=pa;this.nb=qa;this.MW=$a;this.Nfa=Pa;this.Ds=rb;this.We=Ja;this.nee=eb;this.org=Ob;this.vEa=tb;this.IWa=cc}create(qa){return this.We&&this.We.Pa.nv?new N(this.nee,this.Ds,this.Nfa,v.AFrameworkApplication.lm,this.We,this.org,this.vEa,this.IWa,qa):new z(this.nb,this.La,this.We,this.MW,this.Ds,this.Nfa,this.nee,qa)}}Object(t.a)(J,"FileNameDialogFactory",
null,[339]);class R{constructor(qa,pa,Ja,$a){this.Io=this.pjb=null;this.ohb=qa;this.We=Ja;this.etg=$a;this.OCa=new c.a(()=>new K.a(pa.value,Object(k.a)(this,this.Mub,"getMoreInfoEventReceived")))}get yDf(){this.pjb||(this.OCa.value.SY("Save As",!0),this.Io&&this.Io.eR&&this.Io.eR.length&&(this.pjb=this.fSh(this.Io.eR)));return this.pjb}start(qa){if(!this.yDf)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.pjb=v.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Io),!1;const pa=this.etg();pa.jAj();const Ja=pa.OSh();if(!Ja)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ohb.start(($a,rb)=>{pa.hide();qa($a,rb)},()=>{this.INa(pa)},Ja,this.pjb);return!0}INa(qa){qa.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}fSh(qa){qa=
qa.toLowerCase();qa.endsWith("/")||(qa+="/");const pa=qa.indexOf("/documents/");return-1!==pa?qa.substring(0,pa+1)+"_layouts/15/onedrive.aspx":""}Mub(qa){this.Io||3!==qa.state||(this.Io=qa)}}Object(t.a)(R,"OneDriveFilePickerHelper",null,[338]);class M extends l.a{constructor(){super()}jAj(){this.rFc="FilePickerDialog";this.ag="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ae="PickerDialog-MsoSp";this.showDialog("",null)}OSh(){return document.getElementById("FilePickerDiv")}tI(){}Nya(){}}
Object(t.a)(M,"PickerDialog",l.a,[337]);var L=a(638),U=a(831),X=a(371),da=a(27),fa=a(106),S=a(25);class ka{constructor(qa,pa,Ja,$a,rb,Pa,eb){this.nb=qa;this.EGc=Ja;this.La=pa;this.pkb=$a;this.ohb=rb;this.xMc=Pa;this.nlg=eb}Fg(){const qa=this.ohb.r3a();qa?da.a.Nja||this.nb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Je(S.a.saveToSharePoint,fa.a.frame,Object(k.a)(this,this.IUf,"saveToSharePointActionDispatcher"),64):(qa.y7a.continueWith(pa=>{pa.Sf&&this.ohb.nzd(pa)}),this.O_b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}O_b(){X.a.uGd(Object(k.a)(this,this.IUf,"saveToSharePointActionDispatcher"));X.a.F6c([new U.a(S.a.saveToSharePoint,fa.a.frame,0)],this.ohb.r3a())}get I6a(){return this.nb.qa("SaveToAnotherFolderBrsIsEnabled")}get $ue(){return this.nb.qa("UserCanWriteRelative")}IUf(qa,pa,Ja,$a,rb){return pa.contextId!==fa.a.frame||qa!==S.a.saveToSharePoint?2:this.I6a&&(this.xMc.yDf||this.$ue)?1===Ja?L.SessionStatusManager.instance.g4a||v.AFrameworkApplication.i4?
8:this.nlg()?32:8:2===Ja?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(rb&&rb.SaveEntryPoint&&"VersionHistory"===rb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.$ue?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.EGc.create(rb).MP(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.pkb.start(null,rb)),32):8:8}}Object(t.a)(ka,"SaveToSharePointActor",
null,[]);class V{constructor(qa,pa,Ja,$a){this.Ih=this.tae=null;this.vEa=qa;this.Ds=pa;this.xMc=Ja;this.We=$a}start(qa,pa){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.tae=qa;this.Ih=pa;this.xMc.start((Ja,$a)=>{this.x0i(Ja,$a)})||this.UQd()}x0i(qa,pa){if(qa)this.onSuccess(pa);else this.s5(pa)}UQd(){1!==this.We.state&&this.Ds().f5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(qa){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(qa&&qa.data&&qa.data.value&&qa.data.value.length&&qa.data.value[0].sharePoint){const pa=qa.data.value[0].sharePoint.url;qa=qa.data.value[0].sharePoint.listUrl;let Ja=null;if(pa&&(Ja=qa?this.IWh(qa):this.HWh(pa))){this.vEa.lna(pa,this.tae,Ja,this.Ih);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!pa,!Ja)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.UQd()}HWh(qa){qa.endsWith("/")||
(qa+="/");let pa=0;for(let Ja=0;Ja<qa.length;Ja++)if("/"===qa.charAt(Ja)&&5===++pa)return qa.substr(0,Ja);return null}IWh(qa){qa.endsWith("/")&&(qa=qa.substring(0,qa.length-1));const pa=qa.lastIndexOf("/");return-1!==pa?qa.substring(0,pa):null}s5(qa){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");qa&&qa.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",qa.error.errorCode,qa.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.UQd()}}Object(t.a)(V,"SaveToSharePointManager",null,[336]);var wa=a(80);class ma{constructor(qa,pa,Ja,$a,rb,Pa,eb,Ob){this.CEa=qa;this.rA=pa;this.QUa=$a;this.zNc=Pa;this.Q7=Ja;this.Mvg=rb;this.Nea=eb;this.Ih=Ob}execute(qa,pa){if(!v.AFrameworkApplication.Mg&&v.AFrameworkApplication.rd){var Ja=this.CEa+this.Nea;Ja=wa.a.Fl(Ja,"fu",x.a.ef(this.Q7));Ja=wa.a.Fl(Ja,"su",x.a.ef(this.Mvg));Ja=wa.a.Fl(Ja,"fn",x.a.ef(this.rA));Ja=wa.a.Fl(Ja,"n",x.a.ef((new Date).getTime().toString()));
this.Ih&&this.Ih.FileDownloadUrl&&(Ja=wa.a.Fl(Ja,"furl",x.a.ef(this.Ih.FileDownloadUrl)));Ja=Ja+"&"+this.zNc;this.QUa&&this.QUa.length?Ja=wa.a.Fl(Ja,"fnn",x.a.ef(this.QUa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.rd.hm(Ja,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,qa,pa,null,void 0,void 0,void 0,void 0,"9")}}}Object(t.a)(ma,"SharePointSaveAsCaller",
null,[364]);class ab{constructor(qa){this.DEa=qa.appSettings.SaveAsToHostWebServiceBase;this.rA=qa.appSettings.FileName;this.Nea=qa.Va("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(qa,pa,Ja,$a){return new ma(this.DEa,this.rA,qa,pa,Ja,v.AFrameworkApplication.gj,this.Nea,$a)}}Object(t.a)(ab,"SharePointUploadCallerFactory",null,[335]);var ba=a(41),Ca=a(39),Na=a(236),za=a(683),la=a(163),aa=a(639),sa=a(762);class ea{constructor(qa,pa,Ja,$a,rb){this.Bm=this.WBa=null;this.XCc=!1;this.DOc=
this.Q7=null;this.TQc=pa;this.Pjb=Ja;this.Ds=$a;this.We=rb;this.La=qa}lna(qa,pa,Ja,$a){this.XCc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.gLb();this.Q7=qa;$a&&$a.SaveEntryPoint&&(this.DOc=$a.SaveEntryPoint);this.WBa=this.TQc.create(qa,pa,Ja,$a);$a&&"true"===$a.SkipSaveToHost?this.VP():this.RBh()}RBh(){const qa=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.VP()};32!==this.La.ae(S.a.iQa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.VP()},qa])&&qa()}VP(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.WBa.execute(Object(k.a)(this,this.fQi,"onSaveToSharePointUploadFinished"),Object(k.a)(this,this.eQi,"onSaveToSharePointUploadFailed"))}fQi(qa){if(qa&&qa.data&&qa.data.Td){var pa;if(({Vt:pa}=ba.d(qa.data.Td)).returnValue)if(pa.StatusCode!==Na.a.DO&&pa.StatusCode!==
Na.a.Cqb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",qa.data.status,pa.StatusCode),pa.StatusCode!==Na.a.ARf&&this.uHe(qa.data.status)||(this.Kca(pa.StatusCode.toString()),this.Wyj(pa.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.jJd();try{pa.NewDocumentUrl?this.gPa(pa.NewDocumentUrl):this.hPa()}catch(Ja){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
Ja.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:sa.a.aeb(qa.data.Td)}),this.q5b()||(this.Kca("Failed to deserialize response"),this.eLb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.q5b()||(this.Kca("Unknown"),this.eLb())}eQi(qa){qa&&qa.data?this.uHe(qa.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Kca(za.a[qa.data.status]),this.eLb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.q5b()||(this.Kca("Unknown"),this.eLb()))}q5b(){if(!this.XCc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.XCc=!0,this.VP(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}uHe(qa){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",qa);return this.q5b()}hPa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ca.a.Ve(this.Q7,Ca.a.DW(3),void 0,"UploadToSharePointManager.RedirectToFolder")}gPa(qa){let pa=
!1,Ja=!1;v.AFrameworkApplication.fa&&(pa=v.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Ja=v.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",qa,pa);if(pa&&Ja){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const $a={};$a[H.a.bPa]="1";$a[H.a.documentUrl]=qa;$a[H.a.reason]=aa.a.saveAs;v.AFrameworkApplication.GU().execute(rb=>
{rb.Fj(la.a.kta,$a)})}else Ca.a.Ve(qa,Ca.a.DW(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}gLb(){this.We&&1===this.We.state||(this.Bm=this.Pjb(),this.Bm.message=CommonUIStrings.l_CommentProgressTooltip,this.Bm.Sb=5,this.Bm.it=!1,this.Bm.cAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}KHa(){this.Bm&&(this.Bm.close(),this.Bm=null)}eLb(){this.nj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Uzj(){this.nj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}czj(){const qa=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.nj(CommonUIStrings.l_SaveAsFileTooLargeTitle,qa,f.a.Iij)}nj(qa,pa,Ja=f.a.Mij){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",qa,pa);this.KHa();1!==this.We.state&&this.Ds().XGe(qa,pa,Ja)}Wyj(qa){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",qa);switch(qa){case Na.a.gag:this.Uzj();break;case Na.a.ARf:this.czj();break;default:this.eLb()}}jJd(){"VersionHistory"===this.DOc&&
this.La.processAction(S.a.Nrc,2)}Kca(qa){"VersionHistory"===this.DOc&&this.La.ae(S.a.lJd,2,{["FailureReason"]:qa})}}Object(t.a)(ea,"UploadToSharePointManager",null,[334]);var Z=a(246),ua=a(779),ya=a(513),ha=a(55);class Da{constructor(){this.Aqa=this.PLc=this.KLc=this.gb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}ai(qa){this.gb=qa;this.KLc=ya.a.Sq(qa.Vb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.PLc=ya.a.Sq(qa.Vb("Common.IEventEmitter<Common.IMruResult>"));
this.Aqa=ya.a.Sq(qa.Vb("Common.App.SharedFilePicker.ISharedFilePicker"));ha.Task.WAA.call(null,this.KLc,this.PLc,this.Aqa).continueWith(()=>{this.C6i()})}C6i(){this.gb.register(ab,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Gc(()=>new ab(v.AFrameworkApplication.fa)).uc();this.gb.register(ea,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Gc(()=>new ea(v.AFrameworkApplication.wb,
this.gb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new ua.a).create(),()=>new e,v.AFrameworkApplication.ta)).uc();this.gb.register(V,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Gc(()=>new V(this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new e,this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.ta)).uc();this.gb.register(R,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Gc(()=>
new R(this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.KLc.result),v.AFrameworkApplication.ta,()=>new M)).uc();this.gb.register(J,"Common.App.SaveToSharePoint.FileNameDialogFactory").Gc(()=>new J(v.AFrameworkApplication.fa,v.AFrameworkApplication.wb,v.AFrameworkApplication.ta,v.AFrameworkApplication.ta.Pa,this.gb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.gb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.PLc.result),this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Aqa?this.Aqa.result:null)).uc();this.gb.register(ka,"Common.App.SaveToSharePoint.SaveToSharePointActor").Gc(()=>new ka(v.AFrameworkApplication.fa,v.AFrameworkApplication.wb,this.gb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.ta.MTg)).uc();v.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.gb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Fg()}static main(){Z.a.instance.Ii(new Da)}}Object(t.a)(Da,"PackageManager",null,[4,5]);a.d(D,"a",function(){return nb});const nb=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");Da.main()}},1157:function(t,D,a){var c=a(10);t=a(0);var b=a(690),
d=a(50),f=a(37),e=a(1),k=a(181);class l{constructor(Da,nb){this.$=Da;this.presentModeManager=nb}Qc(){return!1}Ec(Da,nb){if(!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(nb.command){case 642419866:return!0;case 588342182:return this.presentModeManager.wz;default:return!1}}executeCommand(Da,nb){Da=f.TaskExtensions.vk();nb=nb.command;switch(nb){case 642419866:this.presentModeManager.hwc(!this.presentModeManager.wz);this.presentModeManager.Ug("TogglePresentMode");
break;case 588342182:this.presentModeManager.v6a=!this.presentModeManager.v6a;this.presentModeManager.L2f(this.presentModeManager.v6a,"TogglePresentModeOverlay");this.presentModeManager.Ug("TogglePresentModeOverlay");break;default:Da=k.a(nb)}return Da}Vc(){return!1}}Object(t.a)(l,"PresentModeCommandHandler",null,[188]);class m extends b.a{constructor(Da){super(Da)}Dd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,423,424,this.ib),Da=>{this.ld([new l(this.$,Da.result)])},this.la,3)}static ka(Da){b.a.Rd(420,
new m(Da))}}Object(t.a)(m,"PresentModeCommandHandlerFactory",b.a,[]);var v=a(220),n=a(15),w=a(128),r=a(4),u=a(112),x=a(84);class z{}z.Oph="ewa-presentMode-overlay";z.Pph="ewa-presentMode-panel-container";z.Qph="ewa-presentMode-rowHdrParent-container";Object(t.a)(z,"CssClassNames",null,[]);var B=a(19),y=a(5),A=a(148),K=a(289),G=a(131),T=a(368),W=a(170);a(59);var P=a(113),E=a(430),H=a(12),F=a(11),N=a(100),J=a(342),R=a(21),M=a(132),L=a(416),U=a(108),X=a(13),da=a(258),fa=a(245),S=a(172),ka=a(45);class V{constructor(Da){this.$qe=
this.JOa=this.eDd=this.fDd=this.ica=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.poc={};this.ooc={};this.FOa=null;this.$Ff=0;this.onKeyDown=nb=>{nb=nb.Ca;if(9===nb.keyCode){var qa=this.ica.querySelectorAll(H.DOMElementExtensions.lr);const pa=H.DOMElementExtensions.Ll(qa);qa=H.DOMElementExtensions.iz(qa);H.DOMElementExtensions.Kma(nb,pa,qa);return!0}return!1};this.Tl=()=>{this.$.da.Za(337,nb=>{this.JOa.getPresentModeFloatieControlsMap().then(qa=>{const pa={};for(let Ja=0;Ja<qa.length;Ja++)pa[qa[Ja].controlId]=
qa[Ja].modelType;qa=nb.d6.L3a(pa);0<qa.length&&appChrome.api.dispatch(qa);this.gjj()})})};this.$=Da}dispose(){this.$=this.eDd=this.fDd=this.ica=this.JOa=null}U9h(){window.requestAnimationFrame(()=>{this.ica=document.createElement("div");this.$.aw.insertBefore(this.ica,this.$.aw.lastChild);this.ica.id=this.$.Bb+y.a.s8b;this.ica.classList.add(z.Pph);this.fDd=document.getElementById(this.$.Bb+y.a.U3c);this.eDd=[this.$.zE];this.isInitialized=!0});this.JOa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.JOa.initializePresentModeFloatie()}QXh(){const Da={};Da.PollingCountPerCaller=u.a.toJSON(this.ooc);Da.PollingDurationPerCaller=u.a.toJSON(this.poc);return Da}TQd(Da){this.isInitialized?Da?(this.JOa.showPresentModeFloatie(this.ica,this.fDd,this.eDd),this.Ug("ShowOrHideFloatiePanel"),this.G7i()):(this.JOa.hidePresentModeFloatie(),this.EOj()):n.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Ug(Da){this.$Ff=F.HelperMethods.Tb();
this.FOa=Da;this.$qe=S.AsyncMethodContext.hr(this.Tl,100,ka.a.e_i+Da,this.$qe)}get lc(){return this.ica}get jf(){this.JOa.updatePresentModeFloatieShyState(2);return!!this.ica}get Zd(){return fa.a.mHf}gg(Da,nb){if(nb)return!1;Da=H.DOMElementExtensions.Ll(this.ica.querySelectorAll(H.DOMElementExtensions.lr));if(!Da)return n.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;Da.focus();return!0}hh(Da){return H.DOMElementExtensions.uf(this.lc,
Da)}kj(){}Mj(){}G7i(){da.a(this.$).Xh(this);this.$.da.Za(15,Da=>{this.ewaAccessibilityManager=Da;this.ewaAccessibilityManager.mode=5});U.KeyInputManager.instance.ra(X.a.Mb,this.lc,this.onKeyDown)}EOj(){da.a(this.$).Nz(this);R.g(this.$).Q_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);U.KeyInputManager.instance.Ba(X.a.Mb,this.lc,this.onKeyDown)}gjj(){const Da=F.HelperMethods.Tb()-this.$Ff,nb=this.poc[this.FOa]?this.poc[this.FOa]:0;this.poc[this.FOa]=nb>Da?nb:Da;this.ooc[this.FOa]=
this.ooc[this.FOa]?this.ooc[this.FOa]+1:1}}Object(t.a)(V,"PresentModeFloatieManager",null,[379,110,3]);var wa=a(7),ma=a(60);class ab{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(t.a)(ab,"OverlayCavityInfo",null,[]);class ba{constructor(){this.height=this.width=0}}Object(t.a)(ba,"OverlayContainerInfo",null,[]);class Ca{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(t.a)(Ca,"PresentModeOverlayProps",
null,[]);class Na{constructor(Da){this.AZa=this.gDd=null;this.$=Da;this.gridView=R.g(this.$)}F$h(){this.gDd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.AZa=Array(5);let Da,nb;for(let qa=1;4>=qa;qa++)Da=document.createElement("div"),H.DOMElementExtensions.setVisible(Da,!1),Da.id=`${"PresentModeOverlay"}-${qa}`,H.DOMElementExtensions.toggleCssClass(Da,z.Oph,!0),nb=this.gridView.Lf(qa).domElement,nb.insertBefore(Da,nb.firstChild),
this.AZa[qa]=Da})}K2f(Da){Da&&this.ZRj();for(let nb=1;4>=nb;nb++)this.sef(nb)&&H.DOMElementExtensions.setVisible(this.AZa[nb],Da);H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-overlay",Da)}ZRj(){const Da=this.WSg();let nb;for(let qa=1;4>=qa;qa++)nb=qa,Da[nb]&&this.gDd.showOverlayWithCavity(this.AZa[nb],Da[nb])}dispose(){this.gDd=this.AZa=this.gridView=this.$=null}WSg(){let Da;const nb=R.g(this.$).rtl;let qa;const pa=Array(5);for(let $a=1;4>=$a;$a++)if(Da=$a,this.sef($a)){var Ja=
this.gridView.Lf($a);qa=this.gridView.ha.Oa.nZ?this.BNh($a,Ja,nb):this.uOh($a,Ja,nb);Ja=this.E7g(Ja);pa[Da]=this.Y7g(this.AZa[Da].id,Ja,qa)}return pa}sef(Da){return this.gridView.hb.oQ(Da)}E7g(Da){return Object(wa.a)(new ba,{width:Da.tn.width,height:Da.tn.height})}Y7g(Da,nb,qa){return Object(wa.a)(new Ca,{containerId:Da,overlayContainerInfo:nb,overlayCavityInfos:qa?[qa]:null})}BNh(Da,nb,qa){var pa=R.g(this.$).ha.Oa.$b;if(!pa)return n.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Ja,$a;if(({nBa:Da,rotation:pa,translateX:Ja,translateY:$a}=pa.extension.ENh(Da)).returnValue){const rb=Da.x-nb.tn.x;return Object(wa.a)(new ab,{left:(qa?nb.tn.width-(rb+Da.width):rb)-3+1,top:Da.y-nb.tn.y-3+1,width:Da.width+5,height:Da.height+5,angle:pa,translateX:Ja,translateY:$a})}return null}uOh(Da,nb,qa){Da=this.gridView.ob.Qtb(this.gridView.ha.sa.activeRange,Da)||ma.a.W2;if(!Da.Fe(nb.tn))return null;const pa=Da.x-nb.tn.x;return Object(wa.a)(new ab,{left:qa?nb.tn.width-(pa+Da.width)-2:
pa-3,top:Da.y-nb.tn.y-3,width:Da.width+5,height:Da.height+5})}}Object(t.a)(Na,"PresentModeOverlayRenderer",null,[377,3]);var za=a(62);const la=(Da,nb,qa,pa,Ja,$a,rb=null)=>{rb=Da.Na(41,rb);rb.shouldEnablePresentMode=nb;return za.g(Da,"SetPresentMode",rb,qa,pa,Ja,$a,0)};var aa=a(282);class sa extends aa.a{constructor(Da,nb){super(Da);this.f_i=()=>{this.jca.TQd(!0)};this.jca=nb;this.domElement.classList.add("ewr-presentMode-on");Da={[sa.Uu]:this.oc};this.Sb=0;this.initializeAndShow("",this.f_i,Da)}get oc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
w.a.Rw(y.a.Q2f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(t.a)(sa,"PresentModeWelcomeDialog",aa.a,[]);class ea{static get cDh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get dDh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(Da){Da.webkitRequestFullscreen?Da.webkitRequestFullscreen():Da.msRequestFullscreen?Da.msRequestFullscreen():Da.mozRequestFullScreen?Da.mozRequestFullScreen():Da.requestFullscreen?Da.requestFullscreen():n.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():n.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get ghi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(t.a)(ea,"FullscreenUtils",null,[]);class Z{constructor(Da){this.Jna=
this.ITe=this.JFb=this.C1a=this.Ioc=this.jca=this.LOa=null;this.Qod=this.qNb=this.wKd=!1;this.KKb=!0;this.vec=!1;this.YQd=!0;this.pNb=this.j0a=this.nAe=0;this.ytc={};this.znc={};this.ync={};this.lHf=0;this.v6a=this.o8d=!1;this.n$i=()=>{H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-transition",!1);$removeHandler(this.C1a,"transitionend",this.Jna)};this.Wi=()=>{parseInt(this.$.aw.style.right,10)!==this.nAe&&window.requestAnimationFrame(()=>{this.Tzc(0);this.$.Kya(K.a.MY("PresentModeManager.OnContentAreaResized"))})};
this.D5=()=>{var nb=Object(x.a)(N.a,this.$.oa);if(nb&&this.wz){this.gridView.Uec=!1;nb=nb.headersVisible;var qa=R.g(this.$).rtl;H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on-headers-off",!nb);H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on-rtl",qa);(12!==this.j0a&&!nb||32!==this.j0a&&nb&&!qa||0!==this.j0a&&nb&&qa)&&window.requestAnimationFrame(()=>{this.Tzc(2)})}};this.Zc=()=>{this.N$e();this.Ug("OnWorkbookOpened");n.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.rp=()=>{this.Qod=!0;this.Rda("OnSelectionStarted")};this.zg=()=>{this.Qod=!1;this.Rda("OnSelectionEnded");this.DUf()};this.Lh=()=>{this.Rda("OnEditStarted")};this.Jf=()=>{this.Rda("OnEditEnded")};this.Bw=()=>{if(!this.vec){const nb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Rda("OnVisibleAreaChanged",!0,nb)}};this.cDb=()=>{this.vec=!0};this.rn=()=>{this.Rda("OnCurrentSelectionModeChanged");this.DUf();this.Ug("OnCurrentSelectionModeChanged")};this.Lm=
()=>{this.Rda("OnBlockCacheItemEvicted")};this.mf=()=>{this.Rda("OnBlockCacheItemChanged")};this.EF=()=>{this.vec||this.Rda("OnActiveItemPanesChanged")};this.Eh=()=>{this.vec=!1;this.jca.Ug("ActiveSheetChanged");this.D5()};this.jEb=(nb,qa)=>{if(nb=Object(x.a)(N.a,qa.item))nb.Rob(16,!0),nb.UXa(this.D5)};this.CJi=()=>{ea.ghi||(this.Ioc&&this.Ioc.Aq&&this.Ioc.hide(),R.g(this.$).$a&&R.g(this.$).Fo(!0),this.hwc(!1),n.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.DJi=()=>{n.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=Da;this.gridView=R.g(this.$);this.Rjj=Da.ya.PresentModeRenderUpdateTimeout;this.initialize(Da)}get wz(){return this.o8d}hwc(Da){this.wz!==Da&&(this.o8d=Da,this.v6a=this.wz,this.N$e(),this.KKb=this.z1f(),window.requestAnimationFrame(()=>{H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-transition",!0);$addHandler(this.C1a,"transitionend",this.Jna);
this.$zj(!Da);this.WUi();H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on",Da);this.Zzj(Da);A.b(this.$).I2f(this.wz);A.c(this.$).I2f(this.wz);this.$.lza();this.LOa.K2f(this.KKb);if(this.wz){this.NYa();w.a.get(y.a.Q2f)?this.jca.TQd(this.wz):this.Ioc=new sa(this.$,this.jca);var nb=L.b(this.$);nb&&(this.wKd=nb.p6c(!1));this.lHf=F.HelperMethods.Tb()}else this.jca.TQd(Da),this.wKd&&(nb=L.b(this.$))&&(nb.p6c(!0),this.wKd=!1),this.C4b(),this.Mui()}))}L2f(Da,nb){this.YQd=Da;this.Rda(nb)}Ug(Da){this.jca.Ug(Da)}dispose(){this.C4b();
this.LOa&&(this.LOa.dispose(),this.LOa=null);this.gridView=this.$=null}$zj(Da){const nb=this.$.da.za(25);void 0===nb||null===nb?n.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):Da?nb.bwc():nb.acc()}WUi(){H.DOMElementExtensions.toggleCssClass(document.getElementById(r.AFrameworkApplication.M1a),B.a.Lp,this.wz);H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on",this.wz);this.cAj(this.wz);this.gridView.Uec=!this.wz;this.pSj();this.$.da.Za(32,
Da=>{Da.MSj(this.wz)});P.b(this.$,Da=>{Da.ccg(this.wz)})}cAj(Da){if(this.JFb)if(Da){if(Da=Object(x.a)(N.a,this.$.oa))H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on-headers-off",!Da.headersVisible),H.DOMElementExtensions.toggleCssClass(this.$.$q,"ewr-presentMode-on-rtl",R.g(this.$).rtl);this.Tzc(0)}else this.$.$q.classList.remove("ewr-presentMode-on-headers-off"),this.$.$q.classList.remove("ewr-presentMode-on-rtl"),this.Tzc(1)}Tzc(Da){var nb=Object(x.a)(N.a,this.$.oa);if(nb){var qa=
parseInt(this.$.aw.style.right,10);if(1===Da||2===Da){if(isNaN(qa)||qa<this.j0a)return;qa-=this.j0a}if(0===Da||2===Da)Da=nb.headersVisible,nb=R.g(this.$).rtl,Da=Da?nb?0:32:12,qa=isNaN(qa)?Da:qa+Da,this.j0a=Da;this.$.aw.style.right=F.HelperMethods.qc(qa);this.nAe=qa}}pSj(){const Da=document.getElementById(this.$.Bb+y.a.d4b).parentNode;H.DOMElementExtensions.toggleCssClass(Da,z.Qph,this.wz)}initialize(Da){this.LOa=new Na(Da);this.LOa.F$h();this.jca=new V(Da);this.jca.U9h();this.C1a=document.getElementById("MainApp");
this.ITe=this.CJi;$addHandler(this.C1a,ea.cDh,this.ITe);$addHandler(this.C1a,ea.dDh,this.DJi);this.JFb||(this.JFb=document.createElement("div"),this.JFb.className="ewa-presentMode-right-frame",this.$.zE.appendChild(this.JFb));this.Jna=this.n$i}NYa(){this.gridView.ha.K1(this.rp);this.gridView.ha.EX(this.zg);this.gridView.dc.Mk(this.Lh);this.gridView.dc.jm(this.Jf);this.gridView.iC(this.rn);this.gridView.view.Ns(this.Bw);this.gridView.iTc(this.cDb);this.gridView.Ea.KG(this.Lm);this.gridView.Ea.Ms(this.mf);
this.$.xa.Pf(this.Eh);this.$.xa.ara(this.EF);this.$.xa.dga(this.jEb);this.$.GA(this.Wi);this.$.el(this.Zc);const Da=Object(x.a)(J.a,this.$.xa);for(const nb of Da.items)nb.UXa(this.D5)}C4b(){this.gridView&&(this.gridView.ha.i6(this.rp),this.gridView.ha.OV(this.zg),this.gridView.dc.Gk(this.Lh),this.gridView.dc.Al(this.Jf),this.gridView.BD(this.rn),this.gridView.view.Oq(this.Bw),this.gridView.GHd(this.cDb),this.gridView.Ea.eI(this.Lm),this.gridView.Ea.Mq(this.mf));if(this.$){this.$.xa.Ag(this.Eh);this.$.xa.bza(this.EF);
this.$.xa.gma(this.jEb);this.$.AD(this.Wi);this.$.Cl(this.Zc);const Da=Object(x.a)(J.a,this.$.xa);for(const nb of Da.items)nb.krc(this.D5)}}z1f(){if(!this.wz||!this.v6a)return!1;if(1===this.gridView.ha.Ke){const Da=this.$.oa.activeRange.isSingle,nb=1===this.$.oa.selectedRanges.length&&!Da,qa=this.gridView.$a,pa=this.Qod;nb||n.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${Da}`);return this.YQd&&nb&&!qa&&
!pa}return this.YQd}Zzj(Da){Da?ea.requestFullscreen(this.C1a):ea.exitFullscreen()}Rda(Da,nb=!1,qa=!1){nb||(this.KKb=this.z1f());n.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${Da}, visibility: ${this.KKb}, immediateUpdate: ${qa}`);if(this.qNb&&qa)n.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.pNb}`),window.cancelAnimationFrame(this.pNb),this.pNb=0;else if(this.qNb){n.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${Da}`);return}qa?this.rXd(F.HelperMethods.Tb(),Da):(this.pNb=window.requestAnimationFrame(pa=>{this.rXd(pa,Da)}),this.qNb=!0)}rXd(Da,nb){var qa=F.HelperMethods.Tb();if(qa-Da>this.Rjj)this.pNb=window.requestAnimationFrame(Ja=>{this.rXd(Ja,nb)}),this.qNb=!1,n.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${qa-Da}ms.`);else{this.LOa.K2f(this.KKb);this.qNb=!1;var pa=
F.HelperMethods.Tb();Da=F.HelperMethods.Tb()-Da;qa=pa-qa;this.Sij(Da,nb);n.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${qa}ms. rafTotalDuration = ${Da}ms`)}}N$e(){T.a(this.$.userOperationManager,(Da,nb,qa)=>la(this.$.pa.va,this.wz,Da,nb,qa,null),Da=>new W.a(252,0,Da),null)}DUf(){let Da=E.a(this.gridView.Ke);1!==this.gridView.Ke||this.$.oa.activeRange.isSingle||(Da="Range");this.ytc[Da]=this.ytc[Da]?this.ytc[Da]+1:1}Sij(Da,nb){const qa=this.znc[nb]?
this.znc[nb]:0;this.znc[nb]=qa>Da?qa:Da;this.ync[nb]=this.ync[nb]?this.ync[nb]+1:1}Mui(){const Da={};var nb=F.HelperMethods.Tb()-this.lHf;Da.PresentModeDuration=nb;Da.SelectionCountPerObject=u.a.toJSON(this.ytc);Da.OverlayCountPerCaller=u.a.toJSON(this.ync);Da.OverlayDurationPerCaller=u.a.toJSON(this.znc);nb=this.jca.QXh();for(let qa in nb)Da[qa]=nb[qa];M.b(this.$).Cd(G.a.d_i,Da,void 0,!0)}}Object(t.a)(Z,"PresentModeManager",null,[331,3]);var ua=a(195);class ya extends v.a{constructor(Da){super();
this.$=Da;this.Fb()}create(){const Da=d.GetServiceTaskFactory.Ta(this.$.da,283,284,1);f.TaskExtensions.Aa(Da,()=>{f.TaskExtensions.Aa(ua.c(Da.result.$n.loadScript("presentMode")),()=>{let nb=this.$.da.za(423);nb||(nb=new Z(this.$),this.$.da.Ga(423,nb));this.qb(nb)},this.$.la,3)},this.$.la,3)}static ka(Da){Da.da.Ga(424,new ya(Da))}}Object(t.a)(ya,"PresentModeManagerFactory",v.a,[]);a.d(D,"a",function(){return ha});const ha=()=>{c.a.Fa(Da=>{ya.ka(Da);m.ka(Da)})}},1161:function(t,D,a){var c=a(10);t=
a(0);var b=a(547),d=a(690),f=a(50),e=a(37),k=a(15),l=a(1230),m=a(4),v=a(163),n=a(750),w=a(98),r=a(262),u=a(639),x=a(27),z=a(156),B=a(176),y=a(287),A=a(5),K=a(147),G=a(102),T=a(77),W=a(75),P=a(368),E=a(170),H=a(59),F=a(62),N=a(320),J=a(582),R=a(1325),M=a(414),L=a(314),U=a(14);class X extends R.a{constructor(Bb,Ub){super(Bb,void 0,void 0,Ub)}get mNa(){return U.a.instance.Xa(412)}get $hc(){return U.a.instance.Xa(413)}get Zhc(){return"DownloadOdsLink"}get GAb(){return"#"}get t7a(){return U.a.instance.Xa(414)}get Xof(){return!0}Fkf(){k.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}Hkf(){k.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}Thc(){M.Redirect.showHelp(L.a.fEi);return!0}}Object(t.a)(X,"DownloadACopyAsOdsDialog",R.a,[]);class da{constructor(Bb,Ub){this.dialog=null;this.evf=()=>{this.dialog&&this.dialog.hide()};this.BEi=Bb;this.rb=Ub;this.rb.lmb(this.evf)}ere(Bb){this.dialog=Bb}m5c(){this.BEi.HDf(-1059172980)}dispose(){this.rb.rHb(this.evf)}}
Object(t.a)(da,"DownloadACopyAsOdsDialogDownloadBehavior",null,[176,3]);const fa=(Bb,Ub,Ta,mb,Qb,Lb,Jb=null)=>{Jb=Bb.Na(9,Jb);Jb.isReadOnlyRecommended=Ub;return F.g(Bb,"SetReadOnlyRecommended",Jb,Ta,mb,Qb,Lb,0)},S=(Bb,Ub,Ta,mb,Qb,Lb,Jb=null)=>{Jb=Bb.Na(9,Jb);Jb.calc_type=Ub;return F.g(Bb,"SetCalculationOptions",Jb,Ta,mb,Qb,Lb,0)};class ka{constructor(Bb){this.calculationMode=0;this.calculationMode=Bb}}Object(t.a)(ka,"MacroRecorderWorkbookCalculationModeSetPayload",null,[116]);class V{constructor(Bb){this.calculateType=
0;this.calculateType=Bb}}Object(t.a)(V,"MacroRecorderWorkbookRecalculatedPayload",null,[116]);var wa=a(85),ma=a(144),ab=a(187),ba=a(13),Ca=a(108),Na=a(1);R=a(260);class za{static get STi(){return za.RTi}}za.RTi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(t.a)(za,"OpenInAppDialogCopyHtml",null,[]);var la=a(151);class aa extends R.a{constructor(Bb){super(Bb);this.QH=null;this.kDb=()=>{k.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.fCc(),!0;x.a.ep?(k.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.xx&&this.xx.length||k.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.xx+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.tm+";end","_top")):9<=x.a.Eid?(k.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.Vka,"_top"),window.setTimeout(()=>{this.openUrl(this.tm,"_blank")},9E3)):(k.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.Vka,
"_top"),window.setTimeout(()=>{this.openUrl(this.tm,"_blank")},500));return!0};this.SNa=Ub=>Ub.Ca.keyCode===wa.a.Zh||Ub.Ca.keyCode===wa.a.boa?(k.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Ub.Cb.click(),!0):!1;1===m.AFrameworkApplication.ta.Pa.xj&&(this.xx=this.$.workbookContext.ClientUrl,this.Vka="ms-excel:ofe|u|"+this.xx,this.tm=m.AFrameworkApplication.fa.Va("AppUrl"),x.a.Paa?this.tm="itms-apps://"+m.AFrameworkApplication.fa.Va("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
x.a.ep&&(Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.ya.IsMeetingLiveSession?(k.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.tm=m.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):x.a.yyb?this.tm=m.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<x.a.CUc.gNa&&(this.tm=m.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get oc(){return"OpenInAppDialogCopy"}openUrl(Bb,
Ub){let Ta=document.getElementById("link");Ta||(Ta=document.createElement("a"),Ta.id="link",Ta.style.visibility="hidden",Ta.href="",document.body.appendChild(Ta));Ta.target=Ub;Ta.href=Bb;Ta.click()}fCc(){k.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ta(this.$.da,21,137,1),Bb=>{let Ub={};Ub.OpenInAppUrl=this.Vka;Ub.StoreUrl=this.tm;Bb.result.Fj("UI_OpenInMobileApp",Ub)},this.$.la)}TTi(){k.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}wg(){this.ag=
ma.a.Yo(za.STi,U.a.instance.ga(667),U.a.instance.ga(668),m.AFrameworkApplication.jB,la.getImageClass(m.AFrameworkApplication.fa.Va("AppIcon")),U.a.instance.ga(669));this.Ae="OpenInAppDialog";this.Sb=5;this.initializeAndShow("",this.TTi.bind(this),null);this.qI(this.QH)}xv(Bb){super.xv(Bb);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.QH=document.getElementById("LinkToInstall");ab.a.instance.ra(ba.a.click,this.QH,this.kDb);Ca.KeyInputManager.instance.ra(ba.a.Gd,this.QH,
this.SNa)}dispose(){this.QH&&(ab.a.instance.Ba(ba.a.click,this.QH,this.kDb),Ca.KeyInputManager.instance.Ba(ba.a.Gd,this.QH,this.SNa),this.QH=null);super.dispose()}}Object(t.a)(aa,"OpenInAppDialogCopy",R.a,[]);var sa=a(133),ea=a(370);class Z{constructor(Bb){this.B6h="itms-apps://";this.C6h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.qig=Ub=>{1==Ub&&this.fCc()};this.$=Bb;this.xx=m.AFrameworkApplication.ta.Pa.xx;this.Vka="ms-excel:ofe|u|"+this.xx;this.tm=m.AFrameworkApplication.fa.Va("AppUrl");
x.a.Paa||x.a.Zg?this.tm=this.B6h+this.C6h:x.a.ep&&(m.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(k.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.tm=m.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):x.a.yyb?this.tm=m.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<x.a.CUc.gNa&&(this.tm=m.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")))}fCc(){k.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ta(this.$.da,21,137,1),Bb=>{let Ub={};Ub[ea.a.NDf]=this.Vka;Ub[ea.a.tm]=this.tm;Bb.result.Fj("UI_OpenInMobileApp",Ub)},this.$.la)}wg(){k.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Bb=new sa.StandardDialog;Bb.Sb=0;Bb.sc(1,U.a.instance.ga(673));Bb.yl(U.a.instance.ga(671),U.a.instance.ga(672),0,this.qig)}}Object(t.a)(Z,"OpenInAppDialogReact",null,[]);R=a(282);class ua extends R.a{constructor(Bb){super(Bb);
this.sessionId=Bb.ya.UserSessionId;this.mQg=Bb.ya.BuildVersion}get oc(){return"WACSessionIdDialog"}IM(){return{[ua.snj]:U.a.instance.ga(674),[ua.tnj]:this.sessionId,[ua.id]:"WACSessionIdDialog",[ua.hXc]:U.a.instance.ga(675),[ua.buildVersion]:this.mQg}}wg(){const Bb=this.IM();this.Sb=5;this.initializeAndShow(U.a.instance.ga(1021),this.gWj.bind(this),Bb)}gWj(){k.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}ua.id="id";ua.snj="sessionIdLabel";ua.tnj="sessionIdValue";ua.hXc=
"buildLabel";ua.buildVersion="buildVersion";Object(t.a)(ua,"WACSessionIdDialog",R.a,[]);var ya=a(28),ha=a(31),Da=a(352),nb=a(11),qa=a(181),pa=a(280),Ja=a(21),$a=a(43),rb=a(249),Pa=a(455),eb=a(375),Ob=a(51),tb=a(6),cc=a(140),Ib=a(964),Mb=a(81),Oa=a(35),Aa=a(298),Ba=a(252);class ob{fQ(Bb,Ub){Bb=ha.a.Yc(12,1,676,0,0,0,"Blank");Bb.Description=String.format(U.a.instance.ga(677),Ub);return Bb}h9b(Bb){switch(Bb){case 1:case 2:return 0;default:return 2}}}Object(t.a)(ob,"ReloadCloseConfirmation",null,[111]);
var xb=a(149),Va=a(583),bb=a(68),ra=a(55),Qa=a(174);class qb extends B.a{constructor(Bb,Ub,Ta,mb){super();this.$=Bb;this.businessBar=mb;this.openInExcelOperation=Ub;this.VJ=Ta}get hc(){return this.$.ea.hc}get workbookContext(){return this.$.workbookContext}get s5b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return bb.a(this.$)}get jc(){return this.$.jc}Qc(){return!1}executeCommand(Bb,Ub,Ta,mb){const Qb=this.s5b,Lb=this.$,Jb=Ub.command,Ab=this.openInExcelOperation,pb=this.$.Bb,
va=Ta.SourceControlId;Lb.Xk.Jke(Jb);Ab.Quc(Ub.startTime.getTime().toString());Bb=null;switch(Jb){case 1455037301:this.$.r4?Ab.xAe():Ab.R0c();break;case -2044628748:case 2004484710:this.$.r4?Ab.xAe():Ab.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===va?(this.iBb("CellLongPress"),k.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.iBb("PencilIcon"),k.ULS.sendTraceTag(576495704,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:k.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const db=bb.a(this.$).fd.activityState;$a.a(Lb).ks(new rb.a(tb.a.Ox,5,()=>{db[Ba.a.lq]=tb.a.Xi}));break;case 480922297:Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new ua(this.$)).wg();break;case -2028960985:Ab.B4f();break;
case -1059172980:new X(Ab.Ate(Jb),new da(Ab,Lb.rb));break;case -1285148982:this.clientWorkflow.fd.activityState[Oa.a.hSc]=!0;this.Xyc(!1);break;case -75280711:this.Xyc(!1);break;case -455164169:this.Xyc(!0);break;case -1388494670:this.$.da.Za(400,Ra=>{Ra.Nxi();this.Xyc(!1)});break;case 810888577:m.AFrameworkApplication.gk=(new Date).getTime();k.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${m.AFrameworkApplication.gk}`);break;case -1804063550:case -974518828:Ub=
0;A.a.HAd in Ta&&(Ub=Ta[A.a.HAd]);Ab.HDf(Jb,Ub);break;case -1339961039:Ub=!1;Ta&&A.a.oIb in Ta&&(Ub=Ta[A.a.oIb]);this.reloadWorkbook(!1,Ub);break;case -8805455:const Ya=this.workbookContext;Lb.isEditMode||(qb.eye(Lb),Bb=e.TaskExtensions.Aa(this.VJ.value,Ra=>{Ra=Ra.result;var na=Ra.isEnabled();na&&J.a(Ra,v.a.copyAndEdit,H.a.tg.yWe(),this.$.ea.Sg.get(2))?k.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
na&&m.AFrameworkApplication.ydg?(na={},na[l.a.GDd]=m.AFrameworkApplication.userSessionId,na[m.AFrameworkApplication.Yzi]=ya.a.Wa.Nb.getTime().toString(),k.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Ra.Fj(v.a.editMode,na)):Qb.CopyAndEditUrl?this.F2g():(this.jc.supportsEditing||Ya.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Lb.isEditMode&&(qb.eye(Lb),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const gb=Lb.pa.va.Qb(),Ka=-1355155015===Jb?1:0,ub=()=>new V(Ka);Bb=P.a(this.$.userOperationManager,(Ra,na,lb)=>F.z(Lb.pa.va,Ka,null,Ra,na,lb,null,gb),Ra=>new E.a(128,0,Ra,void 0,ub),Ub);Ja.g(Lb).Cf.UG(!1);break;case -1158102843:Bb=Ja.g(Lb).Cf.recalcSheet(Ub);Ja.g(Lb).Cf.UG(!1);break;case -988468372:if(Na.EwaSettings.ma(301))if(mb=parseInt(Ta[T.a.Oc],10),0<=mb&&3>mb)this.setCalculationMode(Ub,mb);else return k.ULS.sendTraceTag(537162652,
0,10,`SetCalculationMode , unexpected menuItemId: ${Ta[T.a.Oc]}`),qa.a(Jb);break;case 257398710:K.a.ntw(Qb.ReportAbuseUrl,Lb);break;case 1800405051:this.Oij();break;case -48469327:this.saveACopy();break;case 214430355:Ub=!1;Ta&&A.a.S5c in Ta&&(Ub=Ta[A.a.S5c]);if(!this.Dwj(Ub,Ta))break;m.AFrameworkApplication.i4?this.businessBar.Yf(42,null):this.businessBar.Yf(Ub?22:23,null);break;case 1389557314:Bb=e.TaskExtensions.Aa(this.VJ.value,Ra=>{J.a(Ra.result,v.a.vyh,null,this.$.ea.Sg.get(6))||K.a.ntw(Qb.FileVersionUrl,
Lb)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:va===pb+A.a.Fhf?Ab.pqi():Ab.oqi();break;case 512141517:va===pb+A.a.Ehf?Ab.zqi():Ab.yqi();break;case -1224038235:const ac=n.a.On in Ta?!Ta[n.a.On]:G.j(Lb.ea.workbookContext.Options);Ta[n.a.Description]=ac?U.a.instance.ga(576):U.a.instance.ga(577);Bb=P.a(this.$.userOperationManager,(Ra,na,lb)=>fa(this.$.pa.va,!ac,Ra,na,lb,null),Ra=>new E.a(129,0,Ra),Ub);break;case 1118926154:if(this.$.isEditMode){const Ra=new z.a;this.$.da.Za(53,
na=>{na?(na.Xl.iqi(this.$.Bb+A.a.qqd),Ra.setResult(!0)):k.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Bb=Ra.task}break;case -1698025133:Ab.openInBrowser();break;case 520859864:Bb=e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ta(this.$.da,393,394,mb.Wia()),Ra=>{Ra.result||k.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Bb=qa.a(Jb)}return Bb||ra.Task.Ua(!0)}iBb(Bb){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(nb.HelperMethods.rZ){const Ub=
new Map;Ub.set("EntryPoint",Bb);w.Health.instance.recordKpiUsage(eb.a.QTi,0,Pa.a.Kzi,Ub)}else k.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){m.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(k.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),
(new Z(this.$)).wg()):Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(k.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new aa(this.$)).wg()):(k.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),m.AFrameworkApplication.showOpenInAppDialog()))}Dwj(Bb,Ub){return m.AFrameworkApplication.isMobileMode&&!W.a(this.$.ya,30)?
(this.showOpenInAppDialog(),k.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.iBb("CellDoubleTap"),k.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):m.AFrameworkApplication.ufc&&(Bb&&Da.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(k.ULS.sendTraceTag(537162645,
0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${Da.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):r.a.any([25,26,30,31,57,32,34],Ta=>this.businessBar.sLa(Ta))?(k.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),
!1):Ub&&A.a.P0i in Ub&&!Bb?!1:!0}Ec(Bb,Ub){Bb=!1;switch(Ub.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Bb=!0;break;case 480922297:case 520859864:Bb=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?
!0:!1;break;case 924877417:Bb=Qa.a.Rmd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Bb=Na.EwaSettings.ma(108);break;case -1388494670:Bb=Na.EwaSettings.ma(108);break;case 810888577:Bb=Na.EwaSettings.ma(270);break;case -1224038235:Bb=this.$.ea.amIAlone;break;case -988468372:Bb=Na.EwaSettings.ma(301);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Bb=!0,k.ULS.shipAssertTag(537162642,0,this.$.Ija,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Bb}Vc(){return!1}Oij(){if(this.hc){var Bb=
this.$;$a.a(Bb).ks(new rb.a(tb.a.Ox,5,()=>{Bb.dI(!1,!0);const Ub=this.clientWorkflow.fd.activityState;Ub[Ba.a.lq]=tb.a.Uca;Ub[cc.a.WS]=2;Ub[Oa.a.Dr]=Bb.isEditMode;Ub[cc.a.Tfa]=!1}))}}saveACopy(){if(this.hc){var Bb=this.$;$a.a(Bb).ks(new rb.a(tb.a.Ox,5,()=>{Bb.dI(!1,!1);const Ub=this.clientWorkflow.fd,Ta=Ub.activityState;Ta[Ba.a.lq]=tb.a.gUf;Ta[Va.a.bXb]=this.jc.hasUnsupportedFeaturesForEdit;Ta[cc.a.Tfa]=!1;Ub.Kt(ha.a.E$(this.businessBar.i6c,[-502303485]))}))}}Xyc(Bb){$a.a(this.$).ks(new rb.a(tb.a.Hma,
2,()=>{this.$.dI(!0,!0);var Ub=bb.a(this.$).fd,Ta=this.$.isEditMode;Ta=ha.a.Yc(1,1,0,0,0,Ta?-315732528:-2087635043,Ta?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ta.ForceVersionUpgrade=Bb;Ub.Kt([Ta]);Ub=bb.a(this.$).fd.activityState;Ub[Ba.a.lq]=tb.a.Hma;Ub[Oa.a.Dr]=this.$.isEditMode;Ub[cc.a.Tfa]=!1}))}closeWorkbook(){if(this.hc){var Bb=this.$;H.a.tg.pvc("2145659238")?e.TaskExtensions.Aa(this.VJ.value,Ub=>{Ub.result.Fj(v.a.UQe,{})},this.la,3):$a.a(Bb).ks(new rb.a(tb.a.Ox,5,()=>{Bb.dI(!0,
!1);const Ub=this.clientWorkflow.fd.activityState;Ub[cc.a.yX]=!1;Ub[cc.a.Tfa]=!1;this.jc.inViewerFromWebPart?(N.a.vEd(Bb,this.clientWorkflow.fd),Bb.Xk.Ly("InViewerFromWebPart"),Ub[Ba.a.lq]=tb.a.UZ):(Ub[Ba.a.lq]=tb.a.Jj,Bb.Bd&32?Ub[cc.a.WS]=0:(Ub[cc.a.WS]=1,Ub[cc.a.RWb]=new Ib.a),Ub[xb.a.gje]=!0)}))}}F2g(){const Bb=this.jc.vbaRemovedDuringConversion;k.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Bb}`);const Ub=this.$;Bb?$a.a(Ub).ks(new rb.a(tb.a.Ox,
5,()=>{const Ta=ha.a.Yc(3,0,0,1263,0,1069271157,"XLSMacroFailure");this.clientWorkflow.fd.Kt([Ta]);this.clientWorkflow.fd.activityState[Ba.a.lq]=tb.a.Vdb})):m.AFrameworkApplication.hideHeader?nb.HelperMethods.Ve(this.s5b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):K.a.ntw(this.s5b.CopyAndEditUrl,Ub)}reloadWorkbookInEditMode(){if(this.hc)if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&H.a.tg.WU&&H.a.tg.iGd(),m.AFrameworkApplication.ufc&&
!m.AFrameworkApplication.cba)nb.HelperMethods.Ve(this.$.fob(!0),y.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Bb=this.$,Ub=!1,Ta=this.jc.hasUnsupportedFeaturesForEdit,mb=this.workbookContext.FileWasRepaired;Da.d(this.workbookContext.WorkbookFileName)?(Ub=!0,k.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Ta}`)):Da.a(this.workbookContext.WorkbookFileName)&&(Ub=!0,k.ULS.sendTraceTag(537162633,
0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var Qb=Bb.me.get(59);Qb=!(Bb.ea.jc.supportsEditing&&Qb);if(Ub&&!Ta||Qb&&(Ub||Ta)){let Lb;Lb=Qb?Ta?-2066104278:816071846:Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&W.a(this.$.ya,25)&&!this.$.hzb?765011943:-213064907;Ub=()=>{const Jb=ha.a.qZa([Lb]);this.clientWorkflow.fd.Kt(Jb);this.clientWorkflow.fd.activityState[Ba.a.lq]=tb.a.Vdb}}else Ub=()=>{Bb.dI(!0,!1);var Lb=this.clientWorkflow.fd;
const Jb=Lb.activityState;Jb[cc.a.WS]=1;Jb[Aa.a.WWb]=u.a.Ejc;Jb[Oa.a.Dr]=!0;Jb[Va.a.bXb]=this.jc.hasUnsupportedFeaturesForEdit;Jb[cc.a.Tfa]=!!this.workbookContext.EditUrl;Jb[Mb.a.w1]=this.workbookContext.EditUrl;if(!this.s5b.CopyAndEditUrl){const Ab=[Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&W.a(this.$.ya,25)&&!this.$.hzb?-943219229:1821390342];Lb.Kt(ha.a.E$(this.businessBar.i6c,Ab))}mb&&!Ta?(Da.b(this.workbookContext.WorkbookFileName)&&Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?
(Lb=ha.a.qZa([-425642652]),k.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Lb=ha.a.qZa([108482388]),this.clientWorkflow.fd.Kt(Lb),Jb[Ba.a.lq]=tb.a.uUf):this.$.ea.L5e?(k.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Ob.b().uSd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),
Jb[Ba.a.lq]=tb.a.cFb):Jb[Ba.a.lq]=this.$.ea.dfc?tb.a.KAb:tb.a.Vdb};$a.a(Bb).ks(new rb.a(tb.a.Ox,5,Ub))}}reloadWorkbookInViewMode(){if(this.hc){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&H.a.tg.WU&&H.a.tg.iGd();var Bb=this.$;x.a.Zg&&Ja.g(Bb).Wb.textBox.blur();$a.a(Bb).ks(new rb.a(tb.a.Ox,5,()=>{Bb.dI(!Bb.ea.isNamedObjectViewMode,!1);const Ub=this.clientWorkflow.fd.activityState;Ub[Ba.a.lq]=tb.a.Xga;Ub[cc.a.WS]=1;Ub[cc.a.yX]=!0;Ub[Oa.a.Dr]=!1;Ub[Oa.a.Jlb]=
!0;Ub[Aa.a.WWb]=u.a.Ejc}))}}reloadWorkbook(Bb,Ub){if(this.hc){var Ta=this.$;Ta.ZP&65536&&$a.a(Ta).ks(new rb.a(tb.a.Ox,5,()=>{Ta.dI(Bb,!0);const mb=this.clientWorkflow.fd.activityState;mb[Ba.a.lq]=tb.a.Yy;mb[Oa.a.kSc]=this.workbookContext.NovMode;Ub||(mb[cc.a.WS]=1,mb[cc.a.RWb]=new ob)}))}}setCalculationMode(Bb,Ub){k.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${Ub} `);const Ta=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Ub;const mb=()=>
new ka(Ub);return P.a(this.$.userOperationManager,(Qb,Lb,Jb)=>S(this.$.pa.va,Ub,pa.b(Qb,qb.GQi(this.$,Ta)),pa.a(Lb,qb.FQi(this.$,Ta)),Jb,null),Qb=>new E.a(197,0,Qb,void 0,mb),Bb)}static eye(Bb){Bb.rb&&0<Bb.rb.dR&&Bb.rb.E8c(Ub=>{Ub.Rt()})}static GQi(Bb,Ub){return Ta=>{ha.a.rg(Ta.Errors)&&(Bb.ea.workbookContext.CalcMode=Ub,k.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${Ub}.  Error id names: ${ha.a.zc(Ta.Errors)}`))}}static FQi(Bb,
Ub){return()=>{Bb.ea.workbookContext.CalcMode=Ub;k.ULS.sendTraceTag(537162627,0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${Ub})`)}}}Object(t.a)(qb,"FileOperationsCommandHandler",B.a,[188]);var Wa=a(152);class ta extends d.a{constructor(Bb){super(Bb)}Dd(){const Bb=this.$,Ub=[],Ta=f.GetServiceTaskFactory.create(Bb.da,56,this.la,this.ib);Ub.push(Ta);const mb=f.GetServiceTaskFactory.Ta(Bb.da,5,4,this.ib);Ub.push(mb);e.TaskExtensions.Aa(ra.Task.zL(...Ub),
()=>{Wa.b(Ta)&&this.ld([new qb(Bb,Ta.result,new b.a(()=>f.GetServiceTaskFactory.create(Bb.da,137,this.la,this.ib)),mb.result)])},this.la,0)}static ka(Bb){d.a.Rd(94,new ta(Bb))}}Object(t.a)(ta,"FileOperationsCommandHandlerFactory",d.a,[]);a.d(D,"a",function(){return ib});const ib=()=>{c.a.Fa(ta.ka)}},1162:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(8),f=a(19),e=a(66),k=a(60),l=a(5),m=a(30);class v{}v.qqh="ewa-resizehdr-row-hidden";v.pqh="ewa-resizehdr-col-hidden";Object(t.a)(v,"CssClassNames",
null,[]);var n=a(235),w=a(13),r=a(155),u=a(627),x=a(27),z=a(221),B=a(4),y=a(262),A=a(15),K=a(77),G=a(131),T=a(42),W=a(145),P=a(24),E=a(54),H=a(12),F=a(70),N=a(1),J=a(93),R=a(11),M=a(14),L=a(250),U=a(132),X=a(369),da=a(43),fa=a(33);class S{constructor(Ib,Mb,Oa,Aa,Ba,ob,xb){this.lva=Ib;this.$Bb=Mb;this.ENa=Oa;this.uhd=Aa;this.ebb=Ba;this.Fgf=ob;this.Q3h=xb}}Object(t.a)(S,"HeaderEventCachedInfo",null,[]);class ka{constructor(Ib){this.K5c=Ib}NAe(Ib){Ib=R.HelperMethods.iCd(Ib);return Math.max(0,Math.min(ka.uof,
Ib))}EAe(Ib){return this.yXi(Ib)}bZg(Ib){return Math.round(this.K5c*Ib+2*this.fXe()+1)}yXi(Ib){return Math.max(0,Math.min(ka.$nf,(Math.max(0,Math.min(d.a.hjc,Ib))-2*this.fXe()-1)/this.K5c))}fXe(){return Math.floor(Math.max((this.K5c+3)/4,2))}K$b(Ib,Mb){return Mb?Ib?ka.uof:d.a.xud:Ib?ka.$nf:d.a.hjc}}ka.uof=409;ka.$nf=255;Object(t.a)(ka,"ResizeHeadersConverter",null,[]);var V=a(188);class wa extends J.a{constructor(Ib,Mb){super(Mb.domElement);this.eX=this.oSf=!1;this.sj=this.b7a=this.iAa=null;this.zJd=
!0;this.hgc=!1;this.OIb=this.hl=this.offset=0;this.NM=this.YV=this.f0=null;this.R4h="headerResizeTooltip";this.mG=this.Qsd=null;this.ZVc=this.a8=this.nza=!1;this.eEf=this.I9a=d.a.Kva;this.raf=N.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.xBc=!1;this.sN=Oa=>{if(this.grid.Nj)return!1;Oa=fa.a(this.grid.$).Ud(Oa);if(3===Oa.tb&&!this.Ggf(Oa.Ca)||!this.ZGf(Oa,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Aa=
this.lwc();this.Oad(Oa.clientPoint,Aa,!0);this.nza||(n.a.instance.ra(w.a.zj,this.domElement.ownerDocument.body,this.S8a),r.a.instance.ra(w.a.Xf,this.domElement.ownerDocument.body,this.S8a),this.nza=!0);this.Ecf()&&this.eX&&this.j8e(Oa);return!1};this.sDb=Oa=>{Oa=fa.a(this.grid.$).Ud(Oa);this.Ecf()&&this.ZVc&&this.j8e(Oa);if(!Oa.Ca.type.includes("touch")&&Oa.Ca.button!==Sys.UI.MouseButton.leftButton||!this.$yb)return!1;F.g(Oa.Ca);this.MJe();Oa=this.grid.Nj?this.I9a:d.a.Kva;if(this.grid.Nj&&this.sj)var Aa=
Oa!==this.hl||!this.raf&&this.a8;else this.sj&&(Oa=this.a8?this.jcd():this.sj.p3()),Aa=Oa!==this.hl;if(this.iAa&&Aa&&Oa!==d.a.Kva){Oa=this.grid;Aa=this.wed(Oa);const Ba={};Ba.SheetMultiRange=T.r(Aa,Oa.$);wa.RNd(Ba,this.isRow,this.hl);this.bkh(Ba);Oa.AGj=!0}else this.zg(null,null),this.fHb();return this.xBc=this.a8=!1};this.Mba=Oa=>{if(this.grid.Nj)return!1;Oa=u.a.create(Oa.eventName,Oa.Cb,Oa.Ca,Oa.tb);Oa=fa.a(this.grid.$).Ud(Oa);if(!this.ZGf(Oa,!0))return!1;Oa=this.grid;var Aa=this.wed(Oa);Aa=T.r(Aa,
Oa.$);Oa.ob.Tg([this.isRow?13:14]);Oa.ob.zRa();this.fHb();Oa.$.xd(this.isRow?146338636:1391094586,K.a.Eb,30,{["autoFitRanges"]:Aa});return!1};this.axf=Oa=>{this.eX?(this.a8&&!this.xBc&&this.CAg(),this.hgc||this.B9e(),Oa=new Sys.UI.DomEvent(Oa),Oa=u.a.create(w.a.Bga,this.domElement,Oa,2),Oa=fa.a(this.grid.$).Ud(Oa),this.Yyd(Oa.clientPoint)):A.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.sj?this.sj.tie:-1}, isRow = ${this.isRow}`)};
this.bxf=Oa=>{Oa=new Sys.UI.DomEvent(Oa);Oa=u.a.create(w.a.Bga,this.domElement,Oa,2);this.sDb(Oa)};this.ILi=Oa=>{this.Uxa(Oa,this.sj,!1)};this.S8a=Oa=>{Oa=fa.a(this.grid.$).Ud(Oa);F.g(Oa.Ca);return this.Yyd(Oa.clientPoint)};this.bI=Oa=>{if(this.grid.Nj)return!1;Oa=fa.a(this.grid.$).Ud(Oa);let Aa;if(!this.fff||-1!==this.grid.ha.selectionType)return da.a(this.grid.$).Qp()&&(Aa=this.Wcd(Oa))&&(Aa.lva.style.cursor=""),!1;if(this.eX)return this.B9e(),!1;Aa=this.Wcd(Oa);if(!Aa)return!1;Aa.lva.style.cursor=
!this.grid.$a&&this.bqd(Aa)?this.isRow?"row-resize":"col-resize":"";F.g(Oa.Ca);return!0};this.rp=()=>{this.fHb()};this.zg=()=>{if((3===K.a.Eb||x.a.jp)&&this.grid.ha.sa.xg){var Oa=this.grid.ha.sa.Wc;if(!(!Oa.isRow&&!Oa.Ze||!this.domElement||Oa.isRow&&this.isRow&&!this.Me.Sn.includes(Oa.top)||Oa.Ze&&!this.isRow&&!this.Me.Sn.includes(Oa.left))){var Aa=this.grid.lg(Oa,this.Me.rj.paneType);if(Aa){if(this.grid.Nj){const Ba=this.isRow?Oa.bottom:Oa.right;this.sj=this.Me.Rr(P.Range.Tc(Oa.bottom,Oa.right));
if(!this.sj){A.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Ba}, is row ${this.isRow}`);return}}this.mG||this.$9g();Oa.isRow&&this.isRow?(H.DOMElementExtensions.setVisible(this.mG,!0),this.mG.style.top=Aa.bottomRight.y-this.mG.offsetHeight/2+"px"):Oa.isRow||this.isRow||(H.DOMElementExtensions.setVisible(this.mG,!0),L.c(this.mG.style,this.grid.rtl,Aa.bottomRight.x-this.mG.offsetWidth/2+"px"))}}}};
this.GF=(Oa,Aa)=>{N.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Aa.UL}`);Aa.UL&&this.Hob()};this.Me=Mb;this.isRow=Mb.isRow;this.rtl=Mb.rj.rtl;this.grid=Ib;this.cof=this.isRow?d.a.xud:d.a.hjc;this.N4h=M.a.instance.ga(441);this.W4h=M.a.instance.ga(440);this.Q4h=M.a.instance.ga(442);U.a(this.grid.$,Oa=>{this.Qsd=Oa.EP(G.a.Sfj,
!1)});this.f7i();this.grid.ha.cT(this.zg);this.grid.ha.K1(this.rp);this.grid.Nu(this.zg);da.a(this.grid.$).Vf.U8(this.GF)}get $yb(){return this.eX}get fff(){const Ib=(new W.a(this.grid.$.xa)).Wd(this.isRow?16:8),Mb=this.grid.$.rb.$x,Oa=this.grid.vi,Aa=da.a(this.grid.$).Qp();return Ib&&!Mb&&!Oa&&!Aa}get Ufj(){this.Jkh();return wa.fbb}Uxa(Ib,Mb,Oa){var Aa=new Sys.UI.DomEvent(Ib);Aa=u.a.create(w.a.Bga,this.domElement,Aa,2);Aa=fa.a(this.grid.$).Ud(Aa);this.YGf(Mb,Aa.clientPoint.x,Aa.clientPoint.y,!1,
Oa,Ib);Ib=this.lwc();this.Oad(this.iAa,Ib,!0);this.nza||(Ib=this.domElement.ownerDocument.body,Ib.addEventListener(w.a.Bga,this.axf),Ib.addEventListener(w.a.OFa,this.bxf),this.nza=!0)}GLi(Ib,Mb,Oa){this.YGf(Mb,Ib.clientX,Ib.clientY,!0,this.raf?Oa:!1,Ib);Ib=this.grid;Mb=this.wed(Ib);Mb=T.r(Mb,Ib.$);Ib.ob.Tg([this.isRow?13:14]);Ib.ob.zRa();this.fHb();Ib.$.xd(this.isRow?146338636:1391094586,K.a.Eb,30,{["autoFitRanges"]:Mb})}dispose(){this.QZc();this.grid.ha&&(this.grid.ha.qR(this.zg),this.grid.ha.i6(this.rp));
this.grid.qy(this.zg);da.a(this.grid.$)&&da.a(this.grid.$).Vf.Gca(this.GF);z.a.instance.Ba(w.a.nk,this.domElement,this.Mba);n.a.instance.Ba(w.a.Mf,this.domElement.ownerDocument.body,this.sDb);r.a.instance.Ba(w.a.te,this.domElement.ownerDocument.body,this.sDb);x.a.jp||(n.a.instance.Ba(w.a.pointerDown,this.domElement,this.sN),n.a.instance.Ba(w.a.zj,this.domElement,this.bI));this.nza&&(n.a.instance.Ba(w.a.zj,this.domElement.ownerDocument.body,this.S8a),r.a.instance.Ba(w.a.Xf,this.domElement.ownerDocument.body,
this.S8a),this.nza=!1);this.mG&&(n.a.instance.Ba(w.a.pointerDown,this.mG,this.sN),z.a.instance.Ba(w.a.nk,this.mG,this.Mba),this.QZc(),this.mG=null);this.oSf&&(H.DOMElementExtensions.nf(wa.fbb),wa.fbb=null);this.Me=null;super.dispose()}f7i(){z.a.instance.ra(w.a.nk,this.domElement,this.Mba);n.a.instance.ra(w.a.Mf,this.domElement.ownerDocument.body,this.sDb);r.a.instance.ra(w.a.te,this.domElement.ownerDocument.body,this.sDb);x.a.jp||(n.a.instance.ra(w.a.pointerDown,this.domElement,this.sN),n.a.instance.ra(w.a.zj,
this.domElement,this.bI))}Jkh(){if(!wa.fbb){document.getElementById(wa.nSf);this.oSf=!0;var Ib=wa.fbb=document.createElement("div");this.grid.$.frame.Z$().appendChild(Ib);Ib.id=wa.nSf;Ib.className=m.a.rqh;H.DOMElementExtensions.setVisible(Ib,!1)}}MJe(){if(this.nza){const Ib=this.domElement.ownerDocument.body;this.grid.Nj?(Ib.removeEventListener(w.a.Bga,this.axf),Ib.removeEventListener(w.a.OFa,this.bxf)):(n.a.instance.Ba(w.a.zj,Ib,this.S8a),r.a.instance.Ba(w.a.Xf,Ib,this.S8a));this.nza=!1}this.eX=
!1;N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.rOf():(this.QSf(),this.xHd());X.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}QSf(){this.grid.ob.Tg([this.isRow?13:14]);this.grid.ob.zRa()}CAg(){this.Me.addRowColToModel(this.sj.tie-1,this.sj.N8i);this.xBc=!0}Yyd(Ib){if(!this.eX)return!1;const Mb=this.isRow;if(!this.grid.Nj&&!this.f0){this.f0=document.createElement("div");this.f0.style.cssText="position: relative; width: inherit; height: inherit;"+
(Mb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Oa=this.sj.UJ();Oa.nextSibling;)this.f0.appendChild(Oa.nextSibling);Oa.parentNode.appendChild(this.f0)}Oa=Mb?Ib.y-this.b7a.y:(this.rtl?-1:1)*(Ib.x-this.b7a.x);const Aa=Mb?Ib.y-this.iAa.y:(this.rtl?-1:1)*(Ib.x-this.iAa.x),Ba=this.grid.Nj?this.I9a:this.sj.p3();if(Ba===d.a.Kva)return!1;Oa&&(0<this.hl||0<Ba+Aa)&&Ba+Aa<=this.cof&&(this.hl=this.lwc(Aa),this.Oad(Ib,this.hl,!1),this.grid.Nj?this.hl>=wa.g6e?(this.zJd=!0,this.sj.setCellExtent(this.hl)):
this.zJd&&(this.zJd=!1,this.sj.setCellExtent(wa.g6e)):(H.DOMElementExtensions.Una(this.sj.UJ(),!Mb,Math.max(this.OIb+Aa,0)),this.f0.style[Mb?"top":this.rtl?"right":"left"]=Math.max(Aa,-this.OIb)+"px"),Oa=(this.grid.Nj?this.eEf:Mb?this.sj.Me.lC:this.sj.Me.nC)+Math.max(Aa,this.grid.Nj?-this.I9a+wa.ebc:-this.OIb),H.DOMElementExtensions.Una(this.sj.Me.domElement,!Mb,Oa),this.grid.Nj&&this.sj.Me.$nj(Oa),this.b7a=new Sys.UI.Point(Ib.x,Ib.y),H.DOMElementExtensions.setVisible(this.mG,!1));return!0}p3(){return this.sj?
this.a8?wa.b5h:this.sj.p3():d.a.Kva}Oad(Ib,Mb,Oa){this.NM&&Oa&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.xHd());this.NM||Oa||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Qsd&&this.Qsd(()=>({["Location"]:"canvas"}));this.NM?this.AUe(Mb):(this.NM=document.createElement("div"),
this.NM.id=this.R4h,this.AUe(Mb),this.NM.className=m.a.Moh,Mb=document.getElementById(this.grid.$.Bb+l.a.Vpf),Mb.insertBefore(this.NM,Mb.firstChild),Ib=fa.a(this.grid.$).Uia(Ib),this.NM.style.left=(this.rtl?Math.max(Ib.x-this.NM.offsetWidth,0):Ib.x-Math.max(Ib.x+this.NM.offsetWidth-Mb.offsetWidth,0)).toString()+"px",Mb=document.getElementById(l.a.xFa),this.NM.style.top=(Ib.y-(B.AFrameworkApplication.ta&&B.AFrameworkApplication.ta.Pa.Ef?0:Mb.offsetHeight)-this.NM.offsetHeight).toString()+"px")}xHd(){H.DOMElementExtensions.nf(this.NM);
this.NM=null}AUe(Ib){var Mb=new ka(this.grid.$.workbookContext.DxDigitNormal);Mb=this.isRow?Mb.NAe(Ib).toFixed(2):Mb.EAe(Ib).toFixed(2);this.NM.innerText=`${this.isRow?this.N4h:this.W4h} ${Mb} (${Ib.toString()} ${this.Q4h})`}ZGf(Ib,Mb){let Oa;if(-1!==this.grid.ha.selectionType||2===Ib.tb&&Ib.Ca.button!==Sys.UI.MouseButton.leftButton||!this.bqd(Oa=this.Wcd(Ib))||!this.fff)return!1;F.g(Ib.Ca);this.iAa=this.b7a=new Sys.UI.Point(Ib.clientPoint.x,Ib.clientPoint.y);this.pSg(Oa,Mb);if(!this.sj)return!1;
this.eX=!0;this.Gki(this.sj,Oa)&&this.O8h();this.OIb=this.jcd();return this.$Gf(Ib.Ca.rawEvent,Mb)}YGf(Ib,Mb,Oa,Aa,Ba,ob){this.eX=!0;this.a8=Ba;this.sj=Ib;this.hgc=!1;this.iAa=this.b7a=new Sys.UI.Point(Mb,Oa);Ib=this.sj.getRange();this.YV=Ba?this.Fne(Ib):Ib;this.I9a=this.p3();this.eEf=this.isRow?this.sj.Me.lC:this.sj.Me.nC;this.$Gf(ob,Aa)}$Gf(Ib,Mb){U.b(this.grid.$).Cd(G.a.Jfj,{["IsResizingHiddenHeader"]:this.a8,["IsAutoFitting"]:Mb,["NumberOfSelectedRanges"]:this.grid.ha.sa.BK,["Location"]:"canvas"});
this.grid.Lxj&&(Mb=Mb?"header_resize_autofit":"header_resize_start",V.b(this.grid.$).IAa(Ib,Mb,void 0));this.offset=this.sj.jaa();this.hl=this.grid.Nj?this.I9a:this.sj.p3();if(this.hl===d.a.Kva)return!1;X.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Gki(Ib,Mb){var Oa=this.sj.UJ();if(!Oa)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Oa=Oa.nextSibling;if(!Oa)return!1;Ib=Ib.getRange();Oa=this.Me.rua(Oa).getRange();if(!Ib||
!Oa)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;const Aa=N.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");Ib=Aa&&this.isRow?Ib.bottom:Ib.right;Oa=Aa&&this.isRow?Oa.bottom:Oa.right;return Ib+1!==Oa&&Ib!==Oa&&this.bqd(Mb,!0)}O8h(){var Ib=this.sj.UJ();const Mb=this.Me.rua(Ib.nextSibling);wa.Hki(Mb,this.isRow)?(this.sj=Mb,this.YV=this.sj.getRange()):(this.DAg(Ib),this.sj=Mb,Ib=this.sj.getRange(),this.YV=this.Fne(Ib),this.a8=!0)}Fne(Ib){return this.isRow?
new P.Range(Ib.top-1,Ib.left,Ib.top-1,Ib.right,!1,!0):new P.Range(Ib.top,Ib.left-1,Ib.bottom,Ib.left-1,!1,!0)}DAg(Ib){const Mb=this.Me.rua(Ib.nextSibling),Oa=wa.c6g(Mb,this.isRow,this.rtl);Oa&&Ib.parentNode.insertBefore(Oa,Mb.UJ())}wed(Ib){const Mb=this.YV,Oa=Ib.ha.sa.selectedRanges;if(Ib.ha.sa.Arb(Mb))if(this.isRow){if(y.a.all(Oa,Aa=>Aa.isRow))return Oa}else if(y.a.all(Oa,Aa=>Aa.Ze))return Oa;return[Mb]}getCellExtent(){return this.sj.getCellExtent()}jcd(){const Ib=this.sj.UJ().style;return Math.max(0,
Math.min(this.cof,0|parseInt(this.isRow?Ib.height:Ib.width,10)))}lwc(Ib=0){const Mb=this.grid;var Oa=this.Me.rj.paneType;let Aa;Aa=this.isRow?3===Oa?[3,2]:[1,4]:4===Oa?[2,4]:[1,3];var Ba=Mb.view.visibleArea.bottomRight;const ob=Math.max(this.grid.Nj?this.I9a:this.sj.p3(),0);Ib=this.a8&&!this.grid.Nj?Math.max(this.jcd(),0):Math.max(ob+Ib,0);N.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?(Oa=Mb.IQh(Oa,this.isRow),Oa=this.isRow?new k.a(0,this.offset,Oa,Ib):new k.a(this.offset,0,
Ib,Oa)):Oa=this.isRow?new k.a(0,this.offset,Ba.x,Ib):new k.a(this.offset,0,Ib,Ba.y);Ba=[this.isRow?13:14];N.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?Mb.ob.wi(new P.Range(1,1,d.a.mh,d.a.Ch,!1,!0),Ba,!1):Mb.ob.wi(P.Range.Tc(1,1),Ba,!1);Mb.ob.Bn(Ba,Oa,Aa);return Ib}QZc(){this.YV=this.iAa=this.b7a=null;if(this.f0){const Ib=this.f0.parentNode;if(Ib)for(Ib.removeChild(this.f0);this.f0.firstChild;)Ib.appendChild(this.f0.firstChild);this.f0=null}this.sj=null;this.eX=!1;N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.rOf()}rOf(){this.hgc=!1;this.xHd();H.DOMElementExtensions.setVisible(wa.fbb,!1);H.DOMElementExtensions.setVisible(this.mG,!1);N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.QSf()}Wcd(Ib){if(H.DOMElementExtensions.rz(Ib.Cb,"a"))return null;const Mb=this.Ggf(Ib.Ca);if(Mb&&this.grid.ha.sa.xg){var Oa=this.grid.ha.sa.Wc;Oa=this.Me.Rr(P.Range.Tc(Oa.bottom,Oa.right))}else Oa=this.Me.rua(Ib.Cb);if(!Oa)return null;const Aa=Oa.UJ(),Ba=new Sys.UI.Bounds(Aa.offsetLeft,
Aa.offsetTop,Aa.offsetWidth,Aa.offsetHeight);var ob=H.DOMElementExtensions.getBoundingClientRect(Ib.Cb);ob=new Sys.UI.Point(Ib.clientPoint.x-ob.x,Ib.clientPoint.y-ob.y);this.isRow&&!Mb&&(ob.y+=R.HelperMethods.VC(Ib.Cb,Aa,this.rtl).y);return new S(Aa,ob,Ba,Oa.getRange(),Math.max(wa.Hzi,Math.min(wa.Dyi,(this.isRow?Ba.height:Ba.width)*wa.Tfj)),Mb,!this.isRow&&0<Aa.getElementsByTagName("input").length)}bqd(Ib,Mb=!1){if(!Ib||this.grid.$a)return!1;if(Ib.Fgf)return!0;var Oa=Ib.ENa;const Aa=Ib.ebb;var Ba=
this.Me.rj.paneType,ob=this.grid.Lf(Ba).lh,xb=!!ob&&ob.top===Ib.uhd.top,Va=!!ob&&ob.left===Ib.uhd.left;Ba=!!ob&&ob.bottom===Ib.uhd.bottom&&(3===Ba||2===Ba);this.isRow?(Va=Ib.$Bb.y,Ib=Va<=Aa&&!xb,Oa=Va>=Oa.height-Aa-(Ba?wa.UCh:0),Mb=Mb?Ib:Oa||Ib):(Ba=Ib.Q3h,xb=this.rtl,ob=Ib.$Bb.x,Ib=ob<=Aa&&(!Va||xb)&&(!Ba||!xb),Oa=ob>=Oa.width-Aa&&(!xb||!Va)&&(!Ba||xb),Mb=Mb?xb?Oa:Ib:Ib||Oa);return Mb}pSg(Ib,Mb){const Oa=this.isRow;if(Ib.Fgf)this.sj=this.Me.rua(Ib.lva);else if(Oa&&Ib.$Bb.y<=Ib.ebb&&Ib.ENa.height>
Ib.ebb||!Oa&&Ib.ENa.width>Ib.ebb&&(!this.rtl&&Ib.$Bb.x<=Ib.ebb||this.rtl&&Ib.$Bb.x>=Ib.ENa.width-Ib.ebb)){if(this.sj=Ib.lva.previousSibling?this.Me.rua(Ib.lva.previousSibling):this.VPh(),Mb&&Ib.lva.classList.contains(Oa?m.a.sPe:m.a.rPe)&&(Ib=this.Me.rua(Ib.lva)))Ib=Ib.getRange(),this.YV=Oa?new P.Range(Ib.top-1,Ib.left,Ib.top-1,Ib.right,!1,!0):new P.Range(Ib.top,Ib.left-1,Ib.bottom,Ib.left-1,!1,!0)}else this.sj=this.Me.rua(Ib.lva);!this.YV&&this.sj&&(this.YV=this.sj.getRange())}VPh(){var Ib=this.isRow?
1:0;return(Ib=this.Me.rj.rG(this.Me.rj.Ea.Lg(this.grid.$.oa,e.a.pM(this.Me.position.X+Ib-1,this.Me.position.Y-Ib,this.Me.position.PaneType))))?Ib.UPh():null}B9e(){this.hgc=!0;const Ib=this.Ufj;H.DOMElementExtensions.setVisible(Ib,!0);Ib.style.cursor=this.isRow?m.a.BMe:m.a.mLe;this.lwc()}bkh(Ib){this.grid.$.xd(this.isRow?745189930:-445963340,K.a.Eb,30,{["resizeRowColumnParameters"]:Ib})}$9g(){const Ib=document.createElement("div");Ib.className=m.a.prh;const Mb=document.createElement("div");Mb.className=
f.a.RA;Ib.appendChild(Mb);const Oa=document.createElement("img");Oa.src=E.a.gf(0);Oa.className=this.isRow?f.a.oqh:f.a.jqh;Mb.appendChild(Oa);this.Me.KA.domElement.parentNode.insertBefore(Ib,this.Me.KA.domElement);this.grid.Nj?Ib.addEventListener(w.a.v9,this.ILi):(n.a.instance.ra(w.a.pointerDown,Ib,this.sN),z.a.instance.ra(w.a.nk,Ib,this.Mba));H.DOMElementExtensions.setVisible(Ib,!1);this.mG=Ib}fHb(){this.QZc();this.mG&&(this.Me.KA.domElement.parentNode.removeChild(this.mG),this.mG=null)}Ggf(Ib){return H.DOMElementExtensions.uf(this.mG,
Ib.target)}Hob(){this.eX&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Nj&&this.Yyd(this.iAa),this.MJe(),this.grid.Nj||H.DOMElementExtensions.Una(this.sj.UJ(),!this.isRow,this.OIb),this.fHb(),this.xBc=this.a8=!1)}Ecf(){return N.EwaSettings.ma(673)}j8e(Ib){(Ib=Ib.Ca.rawEvent)&&Ib.detail===wa.Ekj&&(Ib.type===w.a.Tp?(this.eX=!1,this.ZVc=!0):Ib.type===w.a.YH&&(this.eX=!0,this.ZVc=!1))}static Z5g(Ib,Mb){return new wa(Ib,Mb)}static RNd(Ib,Mb,Oa){if(Mb){Ib.ColumnWidth=
-1;Ib.RowHeight=Oa;for(const Aa of Ib.SheetMultiRange.Ranges)Aa.FirstColumn=0,Aa.LastColumn=0}else{Ib.RowHeight=-1;Ib.ColumnWidth=Oa;for(const Aa of Ib.SheetMultiRange.Ranges)Aa.FirstRow=0,Aa.LastRow=0}}static Hki(Ib,Mb){if(!Ib||!Ib.UJ())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Oa=Ib.getRange();Ib=Ib.UJ().style;if(!Oa||!Ib)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ib=Mb?Ib.height:Ib.width;return(Mb?Oa.top:Oa.left)===
(Mb?d.a.mh:d.a.Ch)&&Ib===wa.egg}static c6g(Ib,Mb,Oa){if(!Ib)return A.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Aa=Ib.UJ();if(!Aa||!Aa.style)return A.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Ib=document.createElement("div");const Ba=Aa.style;Ib.style.top=Mb?Ba.top:wa.egg;Mb||(Oa?Ib.style.right=Ba.right:Ib.style.left=Ba.left);Ib.classList.add(Mb?v.qqh:v.pqh);Ib.classList.add(Mb?m.a.Asb:m.a.zsb);Oa=document.createElement("div");
Oa.classList.add(Mb?m.a.ePe:m.a.q8c);Aa=Mb?Number.parseInvariant(Aa.innerText):P.Range.q_a(Aa.innerText);Oa.innerText=Mb?(Aa-1).toString():P.Range.uP(Aa-1);Ib.appendChild(Oa);return Ib}}wa.Hzi=0;wa.Dyi=5;wa.ebc=1;wa.g6e=1;wa.b5h=0;wa.UCh=3;wa.Tfj=.1;wa.nSf="ewa-rszrbg";wa.egg="0px";wa.Ekj=2;wa.fbb=null;Object(t.a)(wa,"HeaderResizeBehavior",J.a,[328]);class ma extends b.a{constructor(){super();this.Fb()}create(){this.qb(wa.Z5g)}static ka(Ib){Ib.da.Ga(136,new ma)}}Object(t.a)(ma,"HeaderResizeBehaviorFactory",
b.a,[]);var ab=a(690),ba=a(50),Ca=a(37),Na=a(171),za=a(418),la=a(510),aa=a(368),sa=a(170),ea=a(281),Z=a(280),ua=a(74),ya=a(21);class ha{constructor(Ib,Mb){this.isRow=!1;this.autoFitRange=null;this.isRow=Ib;this.autoFitRange=Mb}}Object(t.a)(ha,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[116]);class Da{constructor(Ib){this.resizeParameters=null;this.resizeParameters=Ib}}Object(t.a)(Da,"MacroRecorderSheetRowsColumnsResizedPayload",null,[116]);var nb=a(84);b=a(282);var qa=a(22);class pa extends b.a{constructor(Ib,
Mb){super(Ib);this.Dub=Oa=>{Oa=this.kdd(Oa);return this.Had(Oa)};this.Kfj=(Oa,Aa)=>{var Ba=this.A6a=Aa[pa.Gfi];1===Oa?(Oa=Aa[pa.oBj],Ba=this.n2e(Oa,Ba),A.ULS.shipAssertTag(537153996,0,Ba!==pa.Gaa,`ResizeHeadersDialogHandler - invalid size input, size = ${Oa}`),Oa=Ba!==this.Ijd,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.A6a,Ba,Oa),Oa&&this.E3g(Ba)):A.ULS.sendTraceTag(537153994,0,50,
`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Mb.command;this.gridView=ya.g(this.$);this.asc=new ka(this.$.workbookContext.DxDigitNormal);this.Ijd=this.RSg();Ib=this.n2g(this.Ijd);Mb=this.p2g(this.Ijd);this.Il=M.a.instance.ga(this.isRow?482:483);Ib=this.IM(Ib,Mb);this.initializeAndShow(this.Il,this.Kfj,Ib);A.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get oc(){return"ResizeHeadersDialog"}get A6a(){return pa.B8d}set A6a(Ib){pa.B8d=
Ib}IM(Ib,Mb){return{[pa.P3]:this.oc,[pa.Uki]:this.isRow,[pa.k9h]:Ib,[pa.j9h]:Mb,[pa.Nhi]:this.A6a,[pa.jdd]:this.Dub}}RSg(){const Ib=this.jGh();try{return this.QKh(Ib)}finally{Ib&&Ib.dispose()}}E3g(Ib){const Mb={};Mb.SheetMultiRange=T.r(this.gridView.ha.sa.selectedRanges,this.$);pa.RNd(Mb,this.isRow,Ib);this.$.xd(this.isRow?745189930:-445963340,K.a.Eb,8,{["resizeRowColumnParameters"]:Mb})}n2e(Ib,Mb){return qa.a.m4(Ib)?Mb?this.m2g(Ib):this.o2g(Ib):pa.Gaa}o2g(Ib){return Math.floor(parseFloat(Ib))}m2g(Ib){Ib=
parseFloat(Ib);return 0>Ib?pa.Gaa:Ib?this.isRow?R.HelperMethods.GXi(Ib):this.asc.bZg(Ib):0}p2g(Ib){return Ib===pa.Gaa?"":this.isRow?this.asc.NAe(Ib).toString():this.asc.EAe(Ib).toFixed(2)}n2g(Ib){return Ib===pa.Gaa?"":Ib.toString()}QKh(Ib){if(!Ib||!Ib.$$mn()||!Ib.Jn)return pa.Gaa;var Mb=Object(nb.a)(380,Ib.Jn);if(!Mb)return pa.Gaa;for(Mb=this.isRow?Mb.cxb:Mb.Gjd;Ib.$$mn();){const Oa=Object(nb.a)(380,Ib.Jn);if(Oa&&(this.isRow?Oa.cxb:Oa.Gjd)!==Mb)return pa.Gaa}return Mb}jGh(){const Ib=[];for(const Oa of this.gridView.ha.sa.selectedRanges){const Aa=
Oa.clone();var Mb=this.gridView.Lf(this.gridView.hb.jj(Aa));Mb=Aa.Fe(Mb.lh);if(!Mb)return null;this.isRow?Aa.right=Aa.left=Mb.left:Aa.top=Aa.bottom=Mb.top;Ib.push(Aa)}return Ib.length?this.gridView.d$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ib):null}kdd(Ib){if(!qa.a.m4(Ib))return 1;Ib=this.n2e(Ib,this.A6a);return!Ib&&this.Fki()?3:this.Bni(Ib)?0:2}Fki(){const Ib=this.gridView.ha.sa.selectedRanges;return this.isRow&&T.P(Ib)||!this.isRow&&T.O(Ib)}Had(Ib){let Mb="";switch(Ib){case 0:Mb=
"";break;case 1:Mb=M.a.instance.ga(772);break;case 2:Mb=String.format(M.a.instance.mb(99),0,this.K$b(this.A6a));break;case 3:Mb=M.a.instance.ga(773)}return Mb}Bni(Ib){return 0<=Ib&&Ib<=this.K$b(!1)}K$b(Ib){return this.asc.K$b(Ib,this.isRow)}static RNd(Ib,Mb,Oa){if(Mb){Ib.ColumnWidth=pa.Gaa;Ib.RowHeight=Oa;for(const Aa of Ib.SheetMultiRange.Ranges)Aa.FirstColumn=0,Aa.LastColumn=0}else{Ib.RowHeight=pa.Gaa;Ib.ColumnWidth=Oa;for(const Aa of Ib.SheetMultiRange.Ranges)Aa.FirstRow=0,Aa.LastRow=0}}}pa.P3=
"id";pa.Uki="isRow";pa.k9h="initialSizeInPx";pa.j9h="initialSizeInDefaultUnits";pa.Nhi="isInitialUnitsDefaultUnits";pa.jdd="getInputErrorIfInvalid";pa.oBj="size";pa.Gfi="isDefaultUnits";pa.Gaa=-1;pa.B8d=!0;Object(t.a)(pa,"ResizeHeadersDialog",b.a,[]);var Ja=a(62);const $a=(Ib,Mb,Oa,Aa,Ba,ob,xb=null)=>{xb=Ib.Na(41,xb);xb.resizeRowColumnParameters=Mb;return Ja.g(Ib,"ResizeRowsColumns",xb,Oa,Aa,Ba,ob,0)};var rb=a(338),Pa=a(454),eb=a(64);class Ob{constructor(Ib,Mb){this.BPi=(Oa,Aa)=>{if(!ea.a(Oa)&&Aa){const Ba=
!!Oa&&!!Oa.RequestTelemetryData;ya.g(this.$).Ci.Cka(Aa,Oa.StateId,Ba?Oa.RequestTelemetryData.EcsOperationDuration:0,Ba?Oa.RequestTelemetryData.EcsRequestDuration:0,Ba?Oa.RequestTelemetryData.WfeRequestDuration:0)}};this.WGi=(Oa,Aa)=>{Aa&&Aa.IZb&&Aa.IZb.SheetName&&Aa.IZb.Ranges.length&&Aa.Uei&&N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Oa=eb.d(this.$.xa.oa),this.aZg(new rb.a(T.B(Aa.IZb.Ranges[0]),Oa)))};this.$=Ib;this.ug=Mb}Qc(Ib,
Mb){Ib=!0;switch(Mb){case -445963340:case 1391094586:Ib=this.Wd(8);break;case 745189930:case 146338636:Ib=this.Wd(16)}return!Ib}executeCommand(Ib,Mb,Oa){var Aa=Ca.TaskExtensions.vk();var Ba=ya.g(this.$);Ib=Na.a.create().toString();const ob=Mb.command;switch(ob){case 1391094586:case 146338636:var xb=1391094586===ob;(Ib=Oa.autoFitRanges)&&Ib.Ranges&&Ib.Ranges.length||(Ib=T.r(Ba.ha.sa.selectedRanges,this.$));Aa=this.$fh(xb?1:0,Ib,Mb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:xb=
-445963340===ob||-706918724===ob||369708605===ob;if(-445963340===ob||745189930===ob){xb=za.a(Mb.command);Ba.Ci.O6(16,Ib,xb);var Va=Oa.resizeRowColumnParameters}else{Oa=Ba.ha.sa.selectedRanges;Ba=0;for(Va of Oa)if(-706918724===ob||369708605===ob){const bb=Va.right-Va.left+1;Ba+=0<bb?bb:-1*bb}else if(1542466017===ob||1051390410===ob)Ba+=Va.bottom-Va.top+1;369708605===ob||1542466017===ob?A.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Ba}`):(-706918724===
ob||1051390410===ob)&&A.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Ba}`);if(-706918724===ob&&6===Mb.Re&&T.O(Oa)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===ob&&6===Mb.Re&&T.P(Oa)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}Aa=369708605===ob||1542466017===ob?-2:0;Va={};Va.SheetMultiRange=T.r(Oa,this.$);if(xb)for(const bb of Va.SheetMultiRange.Ranges)bb.FirstRow=0,bb.LastRow=0;else for(const bb of Va.SheetMultiRange.Ranges)bb.FirstColumn=0,bb.LastColumn=0;Va.RowHeight=xb?-1:Aa;Va.ColumnWidth=xb?Aa:-1}Aa=this.tgh(Va,Mb,Ib);break;case 957527587:case 2040891415:new pa(this.$,Mb)}return Aa}aZg(Ib){N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&Ca.TaskExtensions.Aa(ba.GetServiceTaskFactory.Ta(this.$.da,
426,427,1),Mb=>{void Mb.result.GVd(Ib,"ColumnAutoFit")},this.$.la,3)}Ec(Ib,Mb,Oa,Aa){if(Ib=!!Oa&&!!Aa&&1===Aa.Vy)switch(Mb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ib=!1}return Ib}Vc(){return!1}cui(Ib){A.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Ib.success}. Reason: ${Object(Pa.c)(Ib)?void 0:Ib.reason}.`)}Wd(Ib){return(new W.a(this.$.xa)).Wd(Ib)}$fh(Ib,
Mb,Oa){const Aa=this.$.pa.va.Qb(),Ba=0===Ib,ob=()=>new ha(Ba,Mb);return aa.a(this.$.userOperationManager,(xb,Va,bb)=>{var ra=this.$.pa.va;xb=Z.b(xb,this.WGi);var Qa={Uei:!Ba,IZb:Mb};const qb=ra.Na(41,Aa);qb.isRow=Ba;qb.autoFitRanges=Mb;return Ja.g(ra,"AutoFit",qb,xb,Va,bb,Qa,0)},xb=>new sa.a(135,0,xb,void 0,ob),Oa)}tgh(Ib,Mb,Oa){const Aa=T.g(Ib.SheetMultiRange.Ranges);var Ba=Mb.command;if(745189930===Ba||-445963340===Ba){A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ib.SheetMultiRange.SheetName,
"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var ob=ya.g(this.$);Ba=745189930===Ba;ob=this.ug.Hzj(ob,Aa,Ba?Ib.RowHeight:Ib.ColumnWidth,Ba);this.cui(ob);Object(Pa.c)(ob)&&ya.g(this.$).Ci.a0(Oa,ua.BasicTelemetryCalculator.uQ)}const xb=this.$.pa.va.Qb({MZ:!0,bZ:3});Ba=(bb,ra,Qa)=>{this.$.sy();T.i(Aa,",",this.$,!1);return $a(this.$.pa.va,Ib,Z.b(bb,this.BPi),ra,Qa,Oa,xb)};const Va=()=>new Da(Ib);return ob&&Object(Pa.c)(ob)?N.EwaSettings.fc()?aa.a(this.$.userOperationManager,Ba,
bb=>new sa.a(136,0,bb,64,Va),Mb):aa.a(this.$.userOperationManager,Ba,bb=>new la.a(136,0,bb,void 0,Va),Mb):aa.a(this.$.userOperationManager,Ba,bb=>new sa.a(136,0,bb,void 0,Va),Mb)}}Object(t.a)(Ob,"ResizeCommandHandler",null,[188]);class tb extends ab.a{constructor(Ib){super(Ib)}Dd(){const Ib=ba.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ib);Ca.TaskExtensions.Aa(Ib,()=>{this.ld([new Ob(this.$,Ib.result)])},this.la,3)}static ka(Ib){ab.a.Rd(113,new tb(Ib))}}Object(t.a)(tb,"ResizeCommandHandlerFactory",
ab.a,[]);a.d(D,"a",function(){return cc});const cc=()=>{c.a.Fa(Ib=>{ma.ka(Ib);tb.ka(Ib)})}},1167:function(t,D,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Sb=0;this.sc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.Wz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}f5c(P){this.Wz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[308]);
var d=a(15),f=a(156);class e{bVe(){d.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const P=new f.a;P.setResult("api.onedrive.com");return P.task}}Object(t.a)(e,"OneDriveConsumerEndpointHelper",null,[214]);var k=a(83),l=a(53),m=a(371),v=a(225);class n{constructor(P,E,H,F){this.EDa=this.t5=null;this.ZOc=this.aPc=!1;this.YVa=null;this.nb=P;this.cPb=E;this.kDa=H;this.Ds=F}get Ooe(){return this.cPb}get fa(){return this.nb}r3a(){this.YVa||(this.YVa=this.B9a?v.a.create(this.B9a,null,null,
null,!1):null);return this.YVa}setup(P){this.EDa=P;this.aPc||this.ZOc?this.aPc&&this.EDa&&this.EDa(!0):(P=this.r3a())?(this.ZOc=!0,P.y7a.continueWith(E=>{this.rOi(E)}),m.a.Kha(P)):(d.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.EDa(!1))}nzd(P){d.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.")}rOi(P){this.ZOc=!1;if(P.Sf)this.nzd(P),this.EDa(!1);else try{this.aPc=
!0,d.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Mjd(),d.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.EDa(!0)}catch(E){d.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",E.toString()),this.EDa(!1)}}startPicker(P){this.t5=P;this.kDa?d.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(k.a)(this,
this.Hxd,"onApiReady")))}Hxd(P){P?this.Phc():this.nj()}nj(){this.Ds().displayError(l.a.ETi)}onSuccess(P){d.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.t5&&this.t5(!0,P)}dispose(){this.YVa&&this.YVa.dispose()}}Object(t.a)(n,"AOneDriveFilePickerApiManager",null,[197,3]);class w extends n{constructor(P,E,H,F,N,J){super(E,H,F,J);this.Ih=null;this.j1=P;this.yvg=N}get B9a(){return this.fa.Va("OneDriveApiUrl")}start(P,E){this.Ih=P;this.startPicker(E)}Mjd(){WL.init(1===
this.Ooe||2===this.Ooe?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(P){this.t5=P;!this.kDa&&this.j1.cLa?(d.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(k.a)(this,this.Hxd,"onApiReady"))):(d.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.yvg())}Phc(){try{d.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.Ih).then(Object(k.a)(this,this.onSuccess,"onSuccess"),Object(k.a)(this,this.s5,"onFailure"))}catch(P){d.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",P,P.stack),this.nj()}}s5(P){if(P&&P.error){if("user_canceled"===P.error.code){d.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}d.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",P.error.code,P.error.message)}else d.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.t5&&this.t5(!1,P);this.nj()}}Object(t.a)(w,"OneDriveFilePickerApiManagerV5",n,[]);class r extends n{constructor(P,E,H,F,N){super(P,E,H,F);this.wRb=this.lbe=null;this.ing=N;this.options={};this.options.clientId=this.fa.Va("OneDriveApiV7ClientId");this.options.cancel=Object(k.a)(this,this.Dyc,"toggleHostDivVisibility")}get B9a(){return this.fa.Va("OneDriveApiV72Url")}start(P,E){this.wRb=E;const H=this.ing.bVe();H.continueWith(()=>{d.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.lbe=H.result;this.startPicker((F,N)=>{this.Dyc();P(F,N)})},3);H.continueWith(()=>{d.ULS.sendTraceTag(24134242,352,15,H.exception.message);this.Dyc()},5)}Mjd(){this.options.success=P=>{const E={};E.data=P;this.onSuccess(E)};this.options.error=P=>{const E={};E.error=P;this.s5(E)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.lbe;this.options.advanced.iframeParentDiv=
this.wRb}Phc(){try{d.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Dyc(),OneDrive.open(this.options)}catch(P){d.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",P.message),this.nj()}}s5(P){this.t5&&this.t5(!1,P);this.nj()}Dyc(){this.wRb.style.visibility="hidden"===this.wRb.style.visibility?"":"hidden"}}Object(t.a)(r,"OneDriveFilePickerApiManagerV7",n,[]);class u extends n{constructor(P,E,H,F){super(P,E,H,F);this.akg=P;this.options=
{};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Va("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get B9a(){return this.fa.Va("OneDriveApiV72Url")}start(P,E,H,F){this.options.advanced.iframeParentDiv=H;this.options.advanced.endpointHint=F;this.options.cancel=E;this.akg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(P)}startPicker(P){this.t5=P;this.kDa?d.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(k.a)(this,this.Hxd,"onApiReady")))}Mjd(){this.options.success=P=>{const E={};E.data=P;this.onSuccess(E)};this.options.error=P=>{const E={};E.error=P;this.s5(E)}}Phc(){try{d.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(P){d.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,P.stack),this.nj()}}nzd(P){d.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.");m.a.g$i(this.B9a);this.YVa=null}nj(){this.Ds().f5c(l.a.Kij)}s5(P){this.t5&&this.t5(!1,P)}}Object(t.a)(u,"OneDriveFilePickerApiManagerV72",n,[]);
class x{constructor(P){this.olsSessionId=this.value=this.key=null;this.olsSessionId=P}}Object(t.a)(x,"IExtraData",null,[]);var z=a(4);class B extends u{constructor(P,E,H,F){super(P,E,H,F);this.options.advanced.filter=P.Va("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=z.AFrameworkApplication.Woe;P.qa("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=P.Va("OneDriveApiV72CommandMode")||"none");P.qa("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new x(z.AFrameworkApplication.userSessionId))}get B9a(){return this.fa.Va("OneDriveApiV72Url")}Phc(){try{d.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",z.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(P){d.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,P.stack),this.nj()}}}Object(t.a)(B,"OneDriveFilePickerApiOpenManagerV72",u,[]);var y=a(236);class A{constructor(P){this.fm=null;this.Xg=P;this.bOc=3}bVe(){this.fm=new f.a;d.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.iMd();return this.fm.task}iMd(P=null){const E=String.format("GetMoreInfoHandler.ashx?{0}",z.AFrameworkApplication.fHa);this.Xg.O8(E,1,null,P,["PersonalFileStorageUrl",
"X-NewKey"],!1,2,Object(k.a)(this,this.eRh,"getMoreInfoSucceeded"),Object(k.a)(this,this.cRh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}cRh(P){if(P.data.httpStatus===y.a.FFb&&"X-NewKey"in P.data.responseHeaders){d.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const E={};E["X-Key"]=P.data.responseHeaders["X-NewKey"];this.iMd(E)}else 0<this.bOc?(d.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.bOc),this.bOc--,this.iMd()):(d.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.fm.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}eRh(P){"PersonalFileStorageUrl"in P.data.responseHeaders&&""!==P.data.responseHeaders.PersonalFileStorageUrl?(d.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.fm.setResult(P.data.responseHeaders.PersonalFileStorageUrl)):(d.ULS.sendTraceTag(24134240,
352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.fm.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(t.a)(A,"OneDriveForBusinessEndpointHelper",null,[214]);var K=a(246),G=a(555);class T{constructor(){this.gb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}ai(P){this.gb=P;this.gb.register(w,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").uc().Gc(()=>
new w(G.a.instance,z.AFrameworkApplication.fa,z.AFrameworkApplication.r1a,z.AFrameworkApplication.limitedEdit,z.AFrameworkApplication.Y2f,()=>new b));z.AFrameworkApplication.Wff?this.gb.register(214,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").uc().Gc(()=>new e):this.gb.register(214,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").uc().Gc(()=>new A(z.AFrameworkApplication.rd));this.gb.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").uc().Gc(()=>
new r(z.AFrameworkApplication.fa,z.AFrameworkApplication.r1a,z.AFrameworkApplication.limitedEdit,()=>new b,this.gb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.gb.register(u,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").uc().Gc(()=>new u(z.AFrameworkApplication.fa,z.AFrameworkApplication.r1a,z.AFrameworkApplication.limitedEdit,()=>new b));this.gb.register(B,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").uc().Gc(()=>new B(z.AFrameworkApplication.fa,
z.AFrameworkApplication.r1a,z.AFrameworkApplication.limitedEdit,()=>new b))}static main(){K.a.instance.Ii(new T)}}Object(t.a)(T,"PackageManager",null,[4,5]);a.d(D,"a",function(){return W});const W=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");T.main()}},1174:function(t,D,a){t=a(0);var c=a(83),b=a(15),d=a(133),f=a(53),e=a(25);class k extends d.StandardDialog{constructor(M,L){super();this.ZVa=!1;this.rA=null;this.La=M;this.ihb=L;this.ARa=!1}displayError(M,L,U){this.rA=L;this.ZVa=U;
b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",M,U);M=this.oZc(M);0===M?(this.Sb=6,this.sc(0,CommonUIStrings.l_DialogClose)):(this.Sb=0,this.sc(1,CommonUIStrings.l_DialogClose));0===M&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Wz(f.a.Jij,this.acd(M),this.FLh(M,L),Object(c.a)(this,this.tKd,"retryDialogHandler"),!0)}tKd(M){1===M?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.rA?this.La.ae(e.a.JIb,
2,[this.rA,this.ZVa]):this.La.processAction(e.a.JIb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}oZc(M){return 0>M||6<M?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",M),0):M}FLh(M,L){M=this.oZc(M);return this.ihb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,L),CommonUIStrings.l_LockTargetText,
CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][M]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,L),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][M]}acd(M){M=this.oZc(M);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][M]}}Object(t.a)(k,"ErrorRetryDialog",d.StandardDialog,[367]);class l{constructor(M,L){this.nb=M;this.La=L;this.ihb=this.nb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new k(this.La,this.ihb)}}Object(t.a)(l,"ErrorRetryDialogFactory",null,[350]);d=a(1045);var m=a(144);class v{static get ag(){return m.a.Yo(v.Ak,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
v.Ak="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(t.a)(v,"FileNameDialogHtml",null,[]);var n=a(4),w=a(29);class r extends d.a{constructor(M,L,U,X,da,fa){super(M,L,U,X,da,fa);this.ag=v.ag;this.Ae="FileNameDialog-SaveAsToHost"}MP(M,L){const U=w.a.rq(n.AFrameworkApplication.lm.Ym);L={["txtFileName"]:M||U,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:L};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.L7b,"fileNameDialogHandler"),L);this.FGe(M,U)}}Object(t.a)(r,"FileNameDialog",d.a,[368]);class u{constructor(M,
L,U,X,da,fa){this.La=L;this.nb=M;this.MW=X;this.Nfa=fa;this.Ds=da;this.We=U}create(){return new r(this.nb,this.La,this.We,this.MW,this.Ds,this.Nfa)}}Object(t.a)(u,"FileNameDialogFactory",null,[351]);var x=a(638),z=a(106);class B{constructor(M,L,U){this.Nfa=U;this.EGc=L;this.nb=M}Fg(){2===n.AFrameworkApplication.ta.Pa.xj?n.AFrameworkApplication.wb.Je(e.a.JIb,z.a.frame,Object(c.a)(this,this.pUf,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.wb.Ob(e.a.JIb,z.a.frame,Object(c.a)(this,this.pUf,
"saveAsToHostActionDispatcher"))}pUf(M,L,U,X,da){return L.contextId!==z.a.frame||M!==e.a.JIb?2:this.nb.qa("SaveAsToHostBrsIsEnabled")?1===U?x.SessionStatusManager.instance.g4a||n.AFrameworkApplication.i4?8:32:2===U?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),M=this.EGc.create(),da&&Object.getType(da)===Array&&2===da.length?M.MP(da[0],!!da[1]):M.MP(null,!1),32):8:8}}Object(t.a)(B,"SaveAsToHostActor",null,[]);var y=a(41),A=a(80),K=a(39),G=a(236),T=a(370),
W=a(163),P=a(639),E=a(762);class H{constructor(M,L,U,X,da,fa,S,ka){this.Bm=null;this.ZVa=this.ECa=!1;this.Mfa=this.Ih=this.rA=null;this.nb=L;this.CEa=this.nb.appSettings.SaveAsToHostWebServiceBase;this.q7d=X;this.Pjb=da;this.Xg=U;this.Ds=fa;this.xh=ka;this.We=S;this.La=M;this.Nea=L.Va("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}gLb(){1!==this.We.state&&(this.Bm=this.Pjb(),this.Bm.message=CommonUIStrings.l_CommentProgressTooltip,this.Bm.Sb=5,this.Bm.it=!1,this.Bm.cAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}JR(M=0){1!==this.We.state&&this.Ds.create().displayError(M,w.a.rq(this.rA),this.ZVa)}hPa(){const M=this.nb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");K.a.Ve(M,K.a.DW(3),void 0,"UploadToHostManager.RedirectToFolder")}gPa(M){let L=!1,U=!1;this.nb&&(L=this.nb.qa("SaveACopyIsEnabledForUiHost"),U=this.nb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
M,L,U);if(L&&U){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const X={};X[T.a.bPa]="1";X[T.a.documentUrl]=M;X[T.a.reason]=P.a.saveAs;n.AFrameworkApplication.GU().execute(da=>{da.Fj(W.a.kta,X)})}else L&&!U&&n.AFrameworkApplication.Uaa?K.a.Ve(M,K.a.DW(4),void 0,"UploadToHostManager.RedirectToEditUrl"):K.a.Ve(M,K.a.DW(3),void 0,"UploadToHostManager.RedirectToEditUrl")}lna(M,L,U=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.q7d&&!this.q7d()&&this.Xg&&(this.xh&&(this.Mfa=this.xh.xc("DialogShown","SaveAsToHostUploadTime")),this.gLb(),this.ZVa=L,this.rA=M,(this.Ih=U)&&"true"===this.Ih.SkipSaveToHost?this.i7b():this.VP())}VP(){32!==this.La.processAction(e.a.iQa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.i7b()):this.La.ae(e.a.iQa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.i7b()},(M,
L)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.JR(L)}])}QSi(M){this.KHa();this.ECa=!1;if(M&&M.data&&M.data.Td)if(({Vt:L}=y.d(M.data.Td)).returnValue)if(M=L,M.StatusCode!==G.a.DO&&M.StatusCode!==G.a.Cqb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var L={};L.FailureReason=M.StatusCode.toString();L.ExtraInfo=M.ExtraInfo;this.Kca(L);this.JR(parseInt(M.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.jJd();try{M.NewDocumentUrl&&""!==M.NewDocumentUrl?this.gPa(M.NewDocumentUrl):this.hPa()}catch(U){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",U.toString())}this.mFb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:E.a.aeb(M.data.Td)}),this.Kca({["FailureReason"]:"Failed to deserialize response"}),this.JR();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Kca({["FailureReason"]:"null response"}),this.JR()}PSi(M){5!==M.data.status&&12!==M.data.status||this.ECa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:M.data.status,["HttpStatus"]:M.data.httpStatus}),this.Kca({["FailureReason"]:M.data.httpStatus.toString()}),this.KHa(),this.JR(),this.mFb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.ECa=!0,this.Ih&&"true"===this.Ih.SkipSaveToHost?this.i7b():
this.VP())}KHa(){this.Bm&&(this.Bm.close(),this.Bm=null)}mFb(){this.Mfa&&(this.Mfa.stop(),this.Mfa=null)}jJd(){this.Ih&&"VersionHistory"===this.Ih.SaveEntryPoint&&this.La.processAction(e.a.Nrc,2)}Kca(M){this.Ih&&"VersionHistory"===this.Ih.SaveEntryPoint&&this.La.ae(e.a.lJd,2,M)}i7b(){let M=this.CEa+this.Nea;M=A.a.Fl(M,"qs",w.a.ef(n.AFrameworkApplication.gj));M=A.a.Fl(M,"n",w.a.ef((new Date).getTime().toString()));M=A.a.Fl(M,"ov",w.a.ef(this.ZVa.toString()));M=A.a.Fl(M,"fn",w.a.ef(this.rA));this.Ih&&
this.Ih.FileDownloadUrl&&(M=A.a.Fl(M,"furl",w.a.ef(this.Ih.FileDownloadUrl)));this.Xg.hm(M,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.QSi,"onUploadFinished"),Object(c.a)(this,this.PSi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(t.a)(H,"UploadToHostManager",null,[348]);var F=a(246),N=a(779);class J{constructor(){this.gb=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.hv(Object(c.a)(this,this.vB,"onFullAppSettingsReady"))}vB(){n.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.gb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Fg()}ai(M){this.gb=M;this.gb.register(l,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Gc(()=>new l(n.AFrameworkApplication.fa,n.AFrameworkApplication.wb)).uc();this.gb.register(H,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Gc(()=>new H(n.AFrameworkApplication.wb,n.AFrameworkApplication.fa,n.AFrameworkApplication.rd,()=>n.AFrameworkApplication.Mg,
()=>(new N.a).create(),M.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.LD)).uc();this.gb.register(u,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Gc(()=>new u(n.AFrameworkApplication.fa,n.AFrameworkApplication.wb,n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.Pa,M.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),M.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).uc();
this.gb.register(B,"Common.App.SaveAsToHost.SaveAsToHostActor").Gc(()=>new B(n.AFrameworkApplication.fa,M.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),M.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).uc()}dispose(){}static main(){F.a.instance.Ii(new J)}}Object(t.a)(J,"SaveAsToHostPackage",null,[4,5]);a.d(D,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.SaveAsToHost");J.main()}},1175:function(t,D,a){t=a(0);var c=a(83),b=a(15),d=a(144);class f{static get ag(){return d.a.Yo(f.Ak,
CommonUIStrings.l_SaveACopyFileName)}}f.Ak="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(t.a)(f,"FileNameDialogHtml",null,[]);var e=a(4),k=a(29);class l extends d.a{constructor(E,H,F,N){super();this.jRb=
this.Q7=null;this.La=E;this.MW=H;this.flb=F;this.sc(1,CommonUIStrings.l_SaveButtonLabel);this.ag=f.ag;this.Ae="FileNameDialog-SaveACopy";this.Ih=N}MP(E,H,F){this.jRb=E;this.Q7=F;E={["txtFileName"]:k.a.rq(e.AFrameworkApplication.lm.Ym),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,H)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.L7b,"fileNameDialogHandler"),E);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}L7b(E,H){1!==E?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(E=H.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),H=k.a.o3(e.AFrameworkApplication.fileName),E&&""!==E&&""!==H&&(E+=H),this.flb.lna(this.jRb,this.Q7,E,this.Ih))}}Object(t.a)(l,"FileNameDialog",d.a,[373]);class m{constructor(E,H,F){this.La=E;this.MW=H;this.flb=F}create(E){return new l(this.La,
this.MW,this.flb,E)}}Object(t.a)(m,"FileNameDialogFactory",null,[358]);var v=a(133),n=a(25);class w extends v.StandardDialog{constructor(E){super();this.Sb=1;this.sc(1,CommonUIStrings.l_RetryButtonLabel);this.sc(0,CommonUIStrings.l_DialogClose);this.La=E}displayError(E){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",E);this.Wz(E,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.tKd,"retryDialogHandler"))}tKd(E){1===E?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(t.a)(w,"RetryDialog",v.StandardDialog,[355]);v=a(1046);var r=a(831),u=a(371),x=a(106);class z extends v.a{constructor(E,H,F,N){super(E,H,F,N);this.Csg=H}I6a(){return this.nb.qa("SaveACopyBrsIsEnabled")}HUe(){return n.a.saveACopy}O_b(){u.a.uGd(Object(c.a)(this,this.HUf,"saveToCloudActionDispatcher"));u.a.F6c([new r.a(n.a.saveACopy,x.a.frame,0)],
this.Csg.r3a())}XLf(){b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(t.a)(z,"SaveACopyActor",v.a,[]);v=a(1049);class B extends v.a{constructor(E,H,F,N,J,R,M){super(H,F,N,J,R,M);this.Kng=E}onSuccess(E){E&&E.data&&E.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Kng.create(this.Ih).MP(E.data.folders[0].id,E.data.folders[0].name,E.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,
10,"Fail to select folder to upload file."),this.nj())}s5(E){E&&E.error&&"user_canceled"===E.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.s5(E)}nj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.nj()}}Object(t.a)(B,"SaveACopyManager",v.a,[]);var y=a(1047);class A extends y.a{constructor(E,H,F,N,J,R){super(H,F,N,J,R);this.La=E}Hod(){return!!this.Ih&&!!this.Ih.SaveEntryPoint&&"VersionHistory"===this.Ih.SaveEntryPoint.toString()}JR(){b.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.Hod()&&this.La.ae(n.a.lJd,2,{["FailureReason"]:"Unknown"});super.JR()}hPa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Hod()&&this.La.processAction(n.a.Nrc,2);super.hPa()}gPa(E){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",E);this.Hod()&&this.La.processAction(n.a.Nrc,2);super.gPa(E)}VP(){this.Ih&&"true"===this.Ih.SkipSaveToHost?super.VP():32!==this.La.processAction(n.a.iQa,
1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.VP()):this.La.ae(n.a.iQa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");y.a.prototype.VP.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.JR()}])}}Object(t.a)(A,"SaveACopyUploadToCloudManager",y.a,[]);var K=a(246),G=a(555),T=a(779);class W{constructor(){this.gb=
null}get name(){return"Common.App.SaveACopy"}init(){e.AFrameworkApplication.fa.hv(Object(c.a)(this,this.vB,"onFullAppSettingsReady"))}vB(){e.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.gb.resolve("Common.App.SaveACopy.SaveACopyActor").Fg()}dispose(){}ai(E){this.gb=E;this.gb.register(A,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Gc(()=>new A(e.AFrameworkApplication.wb,E.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new T.a).create(),()=>new w(e.AFrameworkApplication.wb),
e.AFrameworkApplication.ta,e.AFrameworkApplication.ta.LD)).uc();this.gb.register(m,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Gc(()=>new m(e.AFrameworkApplication.wb,e.AFrameworkApplication.ta.Pa,E.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).uc();this.gb.register(z,"Common.App.SaveACopy.SaveACopyActor").Gc(()=>new z(E.resolve("Common.App.SaveACopy.SaveACopyManager"),E.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
e.AFrameworkApplication.fa,e.AFrameworkApplication.ta.LD)).uc();this.gb.register(B,"Common.App.SaveACopy.SaveACopyManager").Gc(()=>new B(E.resolve("Common.App.SaveACopy.FileNameDialogFactory"),E.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),G.a.instance,E.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),e.AFrameworkApplication.fa,e.AFrameworkApplication.r1a,()=>new w(e.AFrameworkApplication.wb))).uc()}static main(){K.a.instance.Ii(new W)}}Object(t.a)(W,"PackageManager",
null,[4,5]);a.d(D,"a",function(){return P});const P=()=>{Type.registerNamespace("Common.App.SaveACopy");W.main()}},1176:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(15),f=a(29),e=a(84),k=a(240),l=a(35);class m extends k.a{constructor(F,N,J){super(F,N);this.FBd=this.executionContext=null;this.kWi=(R,M)=>{this.dFb(R,M)};this.MJ=J}initialize(F){super.initialize(F)}execute(F){this.executionContext=F;F=Object(e.a)(7,this.executionContext.Be);this.sqb(F);return 1}BI(F){super.BI(F)}sqb(){this.subscribe(this.executionContext,
this.kWi,F=>{this.FBd.add_disposing(F)})}dFb(F){this.unsubscribe(N=>{F.remove_disposing(N)});this.executionContext.activityState[l.a.x1]=0}}Object(t.a)(m,"PasswordProtectedFileActivity",k.a,[]);var v=a(282),n=a(260),w=a(14);class r extends v.a{constructor(F){super(F);this.Voa=0;this.t4i=(N,J)=>{this.V$a(N,J)};this.IYd=(N,J)=>{this.mTa(N,J)}}get oc(){return"PasswordDialog"}get lrb(){return this.Voa}get Il(){return w.a.instance.ga(1976)}V$a(F){this.Voa=F}v2(){const F={};F[v.a.description]=w.a.instance.ga(1977);
F[v.a.Q5]=w.a.instance.ga(1973);F[v.a.$Ef]=w.a.instance.ga(1995);F[v.a.YEf]=w.a.instance.ga(1996);F[v.a.ZEf]=w.a.instance.ga(1974);F[v.a.ljd]=w.a.instance.ga(1980);F[v.a.sre]=w.a.instance.ga(1663);F[v.a.lVj]=w.a.instance.Xa(25);F[v.a.Eeg]=this.IYd;return F}ysa(){const F={};F[n.a.Uu]=this.oc;F[v.a.fZa]=this.v2();return F}wg(){this.Sb=1;this.initializeAndShow(this.Il,this.t4i,this.ysa())}}Object(t.a)(r,"PasswordProtectedFilePasswordInputDialog",v.a,[]);var u=a(62),x=a(31),z=a(281),B=a(51);class y extends r{constructor(F){super(F);
this.oKd=5;this.l8d=!1;this.passwordToModify=null;this.aFf=()=>{this.$.isEditMode&&this.Efc&&(B.b().C6c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Cl(this.aFf))};this.wg();this.$.el(this.aFf)}get Efc(){return this.l8d}get Il(){return w.a.instance.ga(1978)}V$a(F,N){super.V$a(F,N);d.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${F}`)}mTa(F,N){this.passwordToModify=F;const J={};J.FileModifyPassword=
f.a.ef(F);u.N(this.$.pa.va,J,this.VSi(N),this.USi(N),null,null)}v2(){const F=super.v2();F[v.a.ljd]=w.a.instance.ga(1981);F[v.a.description]=w.a.instance.Xa(24);return F}wg(){B.b().C6c("PasswordToModifyDialogShown");d.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.wg()}VSi(F){return N=>{x.a.gh(N.Errors,[-2019873242])&&this.$4b(this.kqb());if(!N||z.a(N))if(0<this.oKd)this.yKf(F);else{d.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${x.a.zc(N.Errors)}`);this.$.ea.vp(N.Errors);this.hide();return}this.l8d=N.Result;this.Efc&&(B.b().uSd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),d.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
F(this.Efc?0:1)}}USi(F){return()=>{0<this.oKd?this.yKf(F):(d.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),F(3))}}yKf(F){--this.oKd;this.mTa(this.passwordToModify,F)}kqb(){return x.a.Yc(1,0,1662,1663,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(t.a)(y,"PasswordProtectedFileModifyPasswordInputDialog",r,[]);var A=a(6);class K extends m{constructor(F,N,J){super(F,N,J)}sqb(F){this.FBd=
new y(F);super.sqb(F)}dFb(F,N){const J=F.lrb,R=F.Efc,M=F.passwordToModify;super.dFb(F,N);this.executionContext.qxa([2001366804]);switch(J){case 1:R?(N=Object(e.a)(7,this.executionContext.Be),this.executionContext.activityState[l.a.yje]=f.a.ef(M),this.executionContext.activityState[l.a.wXa]=!0,F.passwordToModify="",this.dh(N.isEditMode?A.a.yj:this.DJ)):d.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.pp();break;case 0:this.executionContext.activityState[l.a.Dr]=!1;this.dh(this.MJ);this.pp();break;default:d.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${J}'`)}}}Object(t.a)(K,"PasswordProtectedFileModifyActivity",m,[]);class G extends b.a{constructor(F,N,J,R){super();this.activityName=F;this.DJ=N;this.MJ=J;this.$=R;this.Fb()}create(){this.qb(new K(this.activityName,this.DJ,this.MJ))}static ka(F){F.da.Ga(434,new G(A.a.cFb,
A.a.Vdb,A.a.mpb,F))}}Object(t.a)(G,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var T=a(43);class W extends r{constructor(F,N){super(F);this.password=null;this.chf=N;this.wg()}mTa(F,N){this.password=F;N(0)}v2(){const F=super.v2();this.chf&&(F[v.a.$kh]=1);return F}wg(){d.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.chf}`);super.wg();T.a(this.$).Ine()}}Object(t.a)(W,"PasswordProtectedFileOpenPasswordInputDialog",
r,[]);class P extends m{constructor(F,N,J){super(F,N,J)}sqb(F){const N=x.a.gh(this.executionContext.errors,[1217361942]);this.FBd=new W(F,N);F.Hdc||F.mGe();super.sqb(F)}dFb(F,N){let J,R;J=F.password;F.password="";R=F.lrb;super.dFb(F,N);this.executionContext.activityState[l.a.pSc]=f.a.ef(J);this.executionContext.activityState[l.a.wXa]=!0;this.executionContext.qxa([110414285,1217361942]);d.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${R}`);
switch(R){case 1:this.dh(this.DJ);this.pp();break;case 0:this.dh(this.MJ),this.pp()}}}Object(t.a)(P,"PasswordProtectedFileOpenActivity",m,[]);class E extends b.a{constructor(F,N,J,R){super();this.activityName=F;this.DJ=N;this.MJ=J;this.$=R;this.Fb()}create(){this.qb(new P(this.activityName,this.DJ,this.MJ))}static ka(F){F.da.Ga(386,new E(A.a.Onc,A.a.yj,A.a.Jj,F))}}Object(t.a)(E,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(D,"a",function(){return H});const H=()=>{c.a.Fa(E.ka);c.a.Fa(G.ka)}},
1185:function(t,D,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Sb=0;this.sc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.Wz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[355]);var d=a(1049),f=a(1046),e=a(15),k=a(83),l=a(4),m=a(251),v=a(39),n=a(25);class w extends c.StandardDialog{constructor(P,E,H){super();this.La=P;this.j1=E;this.MW=H;this.Mv=!1;this.Sb=1;this.P_(1);
this.sc(1,CommonUIStrings.l_SignIn);this.sc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}MP(){this.j1.IXa(Object(k.a)(this,this.UBf,"onSignIn"));this.yl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(k.a)(this,this.Jai,"inputHandler"))}Jai(P){0===P?(e.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.P5()}OVg(){let P="2";if(this.MW)switch(this.MW.xj){case 3:P="0";break;case 2:P="3";break;case 1:P="1"}return P}hide(){this.j1.nHb(Object(k.a)(this,
this.UBf,"onSignIn"));super.hide()}P5(){const P=new m.QueryStringBuilder("Signin.aspx");P.Oi("prompt","1");P.Oi("cbcxt",this.OVg());l.AFrameworkApplication.zXa(P);v.a.Ve(P.toString(),"LoginWindow",void 0,"SignInDialog")}UBf(){this.Aq&&this.hide();e.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(n.a.saveToCloudStorage,2)}}Object(t.a)(w,"SignInDialog",c.StandardDialog,[370]);class r{constructor(P,E,H){this.La=P;this.j1=
E;this.MW=H}create(){return new w(this.La,this.j1,this.MW)}}Object(t.a)(r,"SignInDialogFactory",null,[354]);var u=a(80),x=a(29);class z{constructor(P,E,H,F,N,J,R){this.CEa=P;this.rA=E;this.QUa=H;this.jRb=F;this.zNc=N;this.Nea=J;this.Ih=R}execute(P,E){if(!l.AFrameworkApplication.Mg&&l.AFrameworkApplication.rd){var H=this.CEa+this.Nea;H=u.a.Fl(H,"fo",x.a.ef(this.jRb));H=u.a.Fl(H,"fn",x.a.ef(this.rA));H=u.a.Fl(H,"qs",x.a.ef(this.zNc));H=u.a.Fl(H,"n",x.a.ef((new Date).getTime().toString()));this.Ih&&
this.Ih.FileDownloadUrl&&(H=u.a.Fl(H,"furl",x.a.ef(this.Ih.FileDownloadUrl)));this.QUa&&(H=u.a.Fl(H,"fnn",x.a.ef(this.QUa)));l.AFrameworkApplication.rd.hm(H,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,P,E,null)}}}Object(t.a)(z,"SkyDriveUploadCaller",null,[371]);class B{constructor(P){this.nb=P;this.DEa=P.appSettings.SkyDriveUploadWebServiceBase;this.rA=P.appSettings.FileName;this.Nea=P.Va("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(P,E,H){return new z(this.DEa,this.rA,
E,P,l.AFrameworkApplication.gj,this.Nea,H)}}Object(t.a)(B,"SkydriveUploadCallerFactory",null,[353]);var y=a(1047),A=a(246),K=a(555),G=a(779);class T{constructor(){this.gb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.gb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fg()}dispose(){}ai(P){this.gb=P;this.gb.register(r,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Gc(()=>
new r(l.AFrameworkApplication.wb,K.a.instance,l.AFrameworkApplication.ta.Pa)).uc();this.gb.register(B,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Gc(()=>new B(l.AFrameworkApplication.fa)).uc();this.gb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Gc(()=>new f.a(P.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),P.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.ta.LD)).uc();this.gb.register(y.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Gc(()=>new y.a(P.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new G.a).create(),()=>new b,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.LD)).uc();this.gb.register(d.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Gc(()=>new d.a(P.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),K.a.instance,P.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.r1a,()=>new b)).uc()}static main(){A.a.instance.Ii(new T)}}Object(t.a)(T,"PackageManager",null,[4,5]);a.d(D,"a",function(){return W});const W=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");T.main()}},1186:function(t,D,a){t=a(0);var c=a(83),b=a(15),d=a(4),f=a(53),e=a(414),k=a(82);class l{constructor(y,A,K,G){this.mLc=null;this.uQb=G;this.hX=y;this.iX=A;this.QD=K;this.rfe=this.Anf.wwj;y=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.Lrg=y[0];this.Krg=y[1]}get Anf(){return this.mLc||(this.mLc=k.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get ova(){return CommonUIStrings.l_OICErrorHelpLink}get Bvc(){return this.rfe}get Cnf(){return this.Lrg}get Bnf(){return this.Krg}get znf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.rfe?3:2}get jsb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get X1b(){return!!this.iX}get ksb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Il(){return CommonUIStrings.l_DefaultDialogTitle}lFd(y){this.VCb(y)}Drd(y){this.VCb(y)}VCb(y){let A=
10;this.iX&&1===y&&(this.iX(this.QD),A=1);this.hX&&this.hX(this.QD);this.UF(A)}FNa(){e.Redirect.showHelp("OICFailure");this.UF(2)}xxd(){this.Anf.bjf();this.UF(4)}UF(y){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.uQb,y);d.AFrameworkApplication.Frc(f.a.PDf,this.uQb,y)}dispose(){this.QD=this.hX=this.iX=null}}Object(t.a)(l,"AOICErrorDialog",null,[3]);var m=a(44),v=a(133);class n extends l{constructor(y,A,K,G){super(y,A,K,G);this.Rpa=this.dm=null;y=
document.createElement("span");y.id="errorMessageText";y.innerText=this.errorMessage;y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));this.dm=document.createElement("a");this.dm.href="#";this.dm.innerText=this.ova;y.appendChild(this.dm);m.a.addHandler(this.dm,"click",Object(c.a)(this,this.FNa,"oicErrorHelpLinkHandler"));A=new v.StandardDialog;A.Ae=this.id;this.Bvc?(K=document.createElement("span"),G=document.createElement("span"),K.innerText=this.Cnf,G.innerText=
this.Bnf,this.Rpa=document.createElement("a"),this.Rpa.href="#",this.Rpa.innerText=this.znf,y.appendChild(document.createElement("br")),y.appendChild(K),y.appendChild(this.Rpa),y.appendChild(G),m.a.addHandler(this.Rpa,"click",Object(c.a)(this,this.xxd,"oicErrorMacOfferLinkHandler"))):this.X1b&&(y.appendChild(document.createElement("br")),y.appendChild(document.createElement("br")),K=document.createElement("span"),K.innerText=this.jsb,y.appendChild(K));this.X1b?(A.Sb=1,A.sc(1,this.ksb)):A.Sb=0;A.yl(this.Il,
null,this.icon,Object(c.a)(this,this.Drd,"legacyOICErrorDialogHandler"),y);A.hW("errorMessageText")}dispose(){this.dm&&(m.a.removeHandler(this.dm,"click",Object(c.a)(this,this.FNa,"oicErrorHelpLinkHandler")),this.dm=null);this.Rpa&&(m.a.removeHandler(this.Rpa,"click",Object(c.a)(this,this.xxd,"oicErrorMacOfferLinkHandler")),this.Rpa=null);super.dispose()}}Object(t.a)(n,"OICErrorDialog",l,[]);class w{constructor(y,A,K){this.hX=A;this.iX=y;this.QD=K}get id(){return"OICErrorDialogWithDownload"}get HKe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get ova(){return CommonUIStrings.l_OICErrorHelpLink}get jsb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ksb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Il(){return CommonUIStrings.l_DefaultDialogTitle}lFd(y){this.VCb(y)}Drd(y){this.VCb(y)}VCb(y){let A=
10;1===y&&(this.iX(this.QD),A=1);this.hX&&this.hX(this.QD);this.UF(A)}FNa(){e.Redirect.showHelp("OICFailure");this.UF(2)}UF(y){d.AFrameworkApplication.Frc(f.a.QDf,3,y)}dispose(){this.QD=this.iX=this.hX=null}}Object(t.a)(w,"AOICErrorDialogWithDownload",null,[3]);class r extends w{constructor(y,A,K){super(y,A,K);this.dm=null;y=document.createElement("span");y.id="errorMessageText";y.innerText=this.HKe;y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));this.dm=document.createElement("a");
this.dm.href="#";this.dm.innerText=this.ova;y.appendChild(this.dm);m.a.addHandler(this.dm,"click",Object(c.a)(this,this.FNa,"oicErrorHelpLinkHandler"));y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));A=document.createElement("span");A.innerText=this.jsb;y.appendChild(A);A=new v.StandardDialog;A.Ae=this.id;A.Sb=1;A.sc(1,this.ksb);A.yl(this.Il,null,this.icon,Object(c.a)(this,this.Drd,"legacyOICErrorDialogHandler"),y);A.hW("errorMessageText")}dispose(){this.dm&&
(m.a.removeHandler(this.dm,"click",Object(c.a)(this,this.FNa,"oicErrorHelpLinkHandler")),this.dm=null);super.dispose()}}Object(t.a)(r,"OICErrorDialogWithDownload",w,[]);var u=a(144);class x extends l{constructor(y,A,K,G){super(y,A,K,G);A={["errorMessage"]:this.errorMessage};A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.ova,["onExecute"]:T=>{this.FNa(T)}};this.Bvc?(A.macOfficePreLinkText=this.Cnf,A.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.znf,
["onExecute"]:T=>{this.xxd(T)}},A.macOfficePostText=this.Bnf):this.X1b&&(A.errorFileDownloadOffer=this.jsb);y=new u.a(!1,!1,!0);this.X1b?(y.Sb=1,y.sc(1,this.ksb)):y.Sb=0;y.Ae=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};y.initializeAndShow(this.Il,Object(c.a)(this,this.lFd,"reactOICErrorDialogHandler"),A)}}Object(t.a)(x,"ReactOICErrorDialog",l,[]);class z extends w{constructor(y,A,K){super(y,A,K);A={["errorMessage"]:this.HKe,["errorFileDownloadOffer"]:this.jsb};A.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.ova,["onExecute"]:G=>{this.FNa(G)}};y=new u.a(!1,!1,!0);y.Sb=1;y.sc(1,this.ksb);y.Ae=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};y.initializeAndShow(this.Il,Object(c.a)(this,this.lFd,"reactOICErrorDialogHandler"),A)}}Object(t.a)(z,"ReactOICErrorDialogWithDownload",w,[]);a.d(D,"a",function(){return B});class B{constructor(){this.iib=!!d.AFrameworkApplication.ta&&d.AFrameworkApplication.ta.Pa.nv}s7g(y,A,K){this.iib?
new x(y,A,null,K):new n(y,A,null,K)}t7g(y,A,K){this.iib?new z(y,A,K):new r(y,A,K)}u7g(y,A,K,G,T){const {ReactOICErrorDialogWithTrial:W}=a(1326),{OICErrorDialogWithTrial:P}=a(1327);this.iib?new W(y,A,K,null,G,T):new P(y,A,K,null,G,T)}static get instance(){return B.Ma||(B.Ma=new B)}}B.Ma=null;Object(t.a)(B,"OICErrorDialogFactory",null,[387])},1203:function(t,D,a){var c=a(10);t=a(0);var b=a(690),d=a(21),f=a(42),e=a(1),k=a(15),l=a(29),m;(function(G){G[G.url=0]="url";G[G.ref=1]="ref";G[G.mailto=2]="mailto"})(m||
(m={}));Object(t.b)("HyperlinkSelectionState",m);var v=a(766),n=a(8),w=a(579),r=a(62),u=a(96),x=a(14);class z extends v.a{constructor(G,T,W){super(G);this.Flb=0;this.Zxb=!1;this.N0a=null;this.yGe=!1;this.Ypb=!0;this.Il=this.ZRc=null;this.hwd=0;this.gwd=this.iwd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.x6h=(P,E)=>{1===P||2===P?(k.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===P?"OK":"Remove"} pressed`),this.iwd=E[z.pri],this.hwd=E[z.hlj],this.gwd=E[z.vfh],2===P&&(this.removeHyperLink=
!0),this.commit()):k.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.UUj=(P,E)=>0!==E&&P.length?1===E?this.qXe(f.y(P,this.ea.xa)||this.gBi(P),765):this.qXe(l.a.$ld(P),767):null;this.selectedRange=T;this.VL=W;this.ea=G.ea;this.sheetName=T.SheetName;this.PKa();this.An();this.Sb=this.Zxb?9:1;this.sc(1,x.a.instance.ga(4));this.Zxb&&this.sc(2,x.a.instance.ga(768));this.initializeAndShow(this.Il,this.x6h,{[z.Uu]:this.oc,[z.VUj]:this.UUj,[z.XNg]:{[z.Feh]:this.yGe,[z.wfh]:this.N0a,[z.Xyg]:this.Flb,
[z.Yyg]:this.ZRc,[z.M2g]:this.Ypb}})}get oc(){return"HyperLinkDialog"}dZe(G,T){switch(T){case 2:return G.startsWith("mailto:")?G:"mailto:"+G;case 1:return`${n.a.GGf}${this.mQh(G)}`;default:return G}}get Hv(){return 526}Ry(){const G=this.$;this.location=this.dZe(this.iwd,this.hwd);try{this.location=u.a.zh(this.location)}catch(P){k.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}k.ULS.sendTraceTag(555755667,0,50,`Committing ${m[this.hwd]} link`);this.cellValue=this.gwd.length?this.gwd:
this.iwd;G.sy();const T=G.pa.va.Qb(),W=f.s(this.selectedRange);return(P,E,H)=>r.b(G.pa.va,W,this.cellValue,this.location,this.removeHyperLink,!1,123,P,E,H,this.VL.range,T)}hj(){const G=f.s(this.selectedRange);return()=>new w.a(G,this.cellValue,this.location)}bxh(){let G=this.VL.cell.A4a;this.VL.cell.Tvb?G&&G.startsWith("mailto:")?(this.Flb=2,G=G.substr(7)):this.Flb=0:this.Flb=1;return G}PKa(){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.Zxb=this.VL.paa:this.Zxb=!!this.VL.yJa(64)||
!!this.VL.yJa(128)}An(){if(this.Zxb){this.N0a=this.VL.text;const G=this.bxh();G&&(this.ZRc=G);this.Il=x.a.instance.ga(828);this.Ypb=this.ZRc===this.N0a}else this.VL.text?(this.N0a=this.VL.text,this.Ypb=!1):(this.N0a="",this.Ypb=!0),this.Flb=0,this.Il=x.a.instance.ga(827);this.VL.fF&&(this.Ypb=!1,this.yGe=!0,e.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.N0a=this.VL.formulaBarText))}gBi(G){return this.ea.yb.qk(G)}qXe(G,T){return G?null:x.a.instance.ga(T)}mQh(G){let T,
W;({sheetName:T,range:W}=f.Z(G,this.ea.xa)).returnValue&&W&&(G=f.x(W,T||this.sheetName,!1));return G}}z.VUj="validateLinkValues";z.XNg="bodyProps";z.Feh="disableDisplayText";z.wfh="displayTextValue";z.Xyg="activeLinkOption";z.Yyg="activeLinkValue";z.M2g="copyLinkValueToDisplay";z.pri="linkValue";z.hlj="selectedLink";z.vfh="displayText";Object(t.a)(z,"HyperlinkDialog",v.a,[]);var B=a(55);class y{constructor(G,T){this.$=G;this.gridView=T}Qc(){return!1}Ec(G,T){return 1===G&&-1583422759===T.command}Vc(){return!1}executeCommand(){this.Azj();
return B.Task.Ua(!0)}Azj(){const G=f.v(this.gridView.ha.sa.Wc,this.$),T=d.e(this.gridView);(!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.oq([this.gridView.ha.sa.Wc],!0))&&T&&new z(this.$,G,T)}}Object(t.a)(y,"ShowHyperlinkCommandHandler",null,[188]);class A extends b.a{constructor(G){super(G)}Dd(){this.ld([new y(this.$,d.g(this.$))])}static ka(G){b.a.Rd(105,new A(G))}}Object(t.a)(A,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(D,
"a",function(){return K});const K=()=>{c.a.Fa(A.ka)}},1204:function(t,D,a){var c=a(10);t=a(0);var b=a(4),d=a(106),f=a(690),e=a(62),k=a(50),l=a(37),m=a(15),v=a(181),n=a(25),w=a(55);class r{constructor(A,K){this.$=A;this.$h=K}Qc(){return!1}executeCommand(A,K,G){A=2;switch(K.command){case -309686558:A=this.$h.ae(n.a.saveACopy,2,G);break;case 617689800:A=this.$h.ae(n.a.saveToCloudStorage,2,G);break;case -1244760097:A=this.$h.ae(n.a.saveToSharePoint,2,G)}return 2===A&&K?v.a(K.command):w.Task.Ua(!0)}Ec(A,
K){A=!1;switch(K.command){case -1244760097:case -309686558:case 617689800:A=!0,m.ULS.shipAssertTag(537153984,0,this.$.Ija,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return A}Vc(){return!1}}Object(t.a)(r,"SaveToHostCommandHandler",null,[188]);class u extends f.a{constructor(A){super(A);this.QBh=(K,G,T,W,P)=>1===T?32:K===n.a.iQa&&2===T?(K=this.$.pa.va.Qb(),e.D(this.$.pa.va,P[0],P[1],null,null,K),32):8}Dd(){l.TaskExtensions.Aa(k.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.ib),()=>{this.ld([new r(this.$,b.AFrameworkApplication.wb)])},this.la,3);b.AFrameworkApplication.wb.Ob(n.a.iQa,d.a.frame,this.QBh)}static ka(A){f.a.Rd(267,new u(A))}}Object(t.a)(u,"SaveToHostCommandHandlerFactory",f.a,[]);var x=a(220);class z{constructor(A,K){this.$=A;this.$h=K;this.$.da.Ga(393,this)}Qc(A){switch(A){case -309686558:return 8===this.$h.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.$h.ae(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.$h.ae(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(t.a)(z,"SaveToHostManager",null,[325,3]);class B extends x.a{constructor(A){super();this.$=A;this.Fb()}create(){this.qb(this.$.da.za(393)||new z(this.$,b.AFrameworkApplication.wb))}static ka(A){A.da.Ga(394,new B(A))}}Object(t.a)(B,"SaveToHostManagerFactory",x.a,[]);a.d(D,"a",function(){return y});const y=()=>{c.a.Fa(u.ka);c.a.Fa(B.ka)}},1205:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(15),f=a(84),e=a(114),k=a(31),
l=a(35);class m extends e.a{constructor(E,H){super(E,H)}execute(E){const H=Object(f.a)(7,E.Be);d.ULS.shipAssertTag(537153921,0,k.a.bnb(E.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");H.dI(!0,!0);E.activityState[l.a.VWb]=H.ea.sessionId;E.activityState[l.a.Ilb]=!0;E.activityState[l.a.aXb]=!0;d.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(t.a)(m,"SessionReloadActivity",e.a,
[]);var v=a(6);class n extends b.a{constructor(){super();this.Fb()}create(){this.qb(new m(v.a.Mbb,v.a.Yy))}static ka(E){E.da.Ga(142,new n)}}Object(t.a)(n,"SessionReloadActivityFactory",b.a,[]);var w=a(58),r=a(264),u=a(109),x=a(47),z=a(45),B=a(34),y=a(1),A=a(46),K=a(244),G=a(115);class T extends e.a{constructor(E,H,F,N,J){super(E,H);T.Utd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];T.Ttd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
T.unf=[-1468309555,611268539,-1750576502,61029505];T.tnf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.uwc=F;this.iBj=N;this.pKj=J}execute(E){var H=Object(f.a)(7,E.Be);E.activityState[l.a.Uqa]=!0;var F=T.FWh(E);if(T.pvj(E,F))return T.Pxi(E),F=50,0<E.errors.length&&(F=15),d.ULS.sendTraceTag(537153891,0,F,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${k.a.zc(E.errors)}`),E.activityState[l.a.Uqa]=!1,this.dh(v.a.idle),
3;switch(F){case 1:case 3:this.Aai(E,F);break;case 2:this.zai(E);break;case 0:E.activityState[l.a.xXa]=null}d.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${F}. activityName:${this.activityName}. NextActivityName:${this.WZ}. TimeFromLastStatefulResponse:${H.ea.k0}.`);var N=B.a.og(E.activityState,G.a.Ydb);d.ULS.shipAssertTag(40502925,0,!N||N&&(1===F||3===F),`triggerSilentReloadAfterTokenRefresh: ${N}, silentReloadType: ${F}`);H=H.Xk.reloadCount;return 0!==F&&
0<H?(N=r.a.Pua(H,200),d.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${F}] retryNum [${H}] delayInMs [${N}] activityName [${this.activityName}]`),x.a.instance.create(()=>{T.nM(E)},N,z.a.vnj),1):3}Aai(E,H){d.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const F=Object(f.a)(7,E.Be);E.activityState[l.a.Ilb]=!0;F.Hdc||A.PageLoadTrackingInfo.instance.qj("ReopenOnLoad");!T.isEditMode(E)&&k.a.bnb(E.errors)&&
(d.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),E.activityState[l.a.VWb]=F.ea.sessionId,E.activityState[l.a.aXb]=!0);E.kud();3===H?(F.ea.eg()||F.ea.nDi(),F.dI(!0,!0),this.dh(this.pKj),E.activityState[l.a.oje]=F.workbookContext.CalcMode):(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===H&&F.dI(!0,!0),E.activityState[l.a.hSc]=!1,this.dh(this.uwc))}zai(E){d.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");E.activityState[l.a.xXa]=null;E.kud();this.dh(this.iBj);E=Object(f.a)(7,E.Be);E.Hdc||(A.PageLoadTrackingInfo.instance.qj("RefreshOnLoad"),E.RHb())}static nM(E){E.nM()}static FWh(E){const H=Object(f.a)(7,E.Be),F=H.ea,N=T.isEditMode(E);var J=k.a.gh(E.errors,N?T.Ttd:T.Utd);const R=k.a.gh(E.errors,N?T.tnf:T.unf),M=H.SM,L=H.Xk.reloadCount,U=H.ya.MaxConsecutiveSilentReloadAllowed,X=H.Xk.I5e(),da=k.a.zc(E.errors),fa=k.a.zc(E.Gya),
S=0<k.a.xM(ma=>!ma.triggerSilentReopenOnly,E.errors).length;let ka=J;const V=B.a.og(E.activityState,G.a.Ydb);V&&(ka=!0);const wa={name:"SessionReloadSilentActivity.GetSilentReloadType"};wa.editMode=N;wa.isSilentReopenError=J;wa.isSilentRefreshError=R;wa.reloadSequenceCount=H.Xk.oPa;wa.reloadCount=L;wa.maxReloads=U;wa.stopSilentReloads=X;wa.errorNames=da;wa.processedErrorNames=fa;wa.isClientDirty=M;wa.errorsForSilentReopenOnly=S;wa.triggerSilentReloadAfterTokenRefresh=V;wa.IsReopenDisabled=H.MLa;J=
w.a.Ac(wa);d.ULS.sendTraceTag(21837004,0,50,J);if(!X){if(ka&&(N?T.gvj(E):T.ivj(E)))return K.a.C0f(E,H)?3:H.MLa?2:1;if(R&&(N||!F.$$a))return 2}return 0}static pvj(E,H){for(const F of E.errors)if(-1337545025===F.MessageId||-238814601===F.MessageId)return!1;return k.a.xM(F=>!F.triggerSilentReopenOnly,E.errors).length?3!==H:!1}static Pxi(E){const H=k.a.xM(F=>!F.triggerSilentReopenOnly,E.errors);for(const F of H)E.zba(F)}static isEditMode(E){const H=Object(f.a)(7,E.Be);return H.ea.hc?H.jv&&!!(H.Bd&64):
B.a.og(E.activityState,l.a.Dr)}static ivj(E){const H=Object(f.a)(7,E.Be),F=k.a.E$(E.errors,T.Utd);if(u.b(F,N=>N.ForceVersionUpgrade))return!1;E=k.a.bnb(E.errors);return!H.ea.$$a||E?!0:!1}static gvj(E){E=k.a.E$(E.errors,T.Ttd);return!u.b(E,H=>H.ForceVersionUpgrade)}}T.Utd=null;T.Ttd=null;T.unf=null;T.tnf=null;Object(t.a)(T,"SessionReloadSilentActivity",e.a,[]);class W extends b.a{constructor(E,H){super();this.activityName=E;this.DJ=H;this.Fb()}create(){this.qb(new T(this.activityName,this.DJ,v.a.Yy,
v.a.Xi,v.a.JMb))}static ka(E){E.da.Ga(143,new W(v.a.Hma,v.a.MZb));E.da.Ga(144,new W(v.a.auc,v.a.jOa));E.da.Ga(145,new W(v.a.buc,v.a.JAd));E.da.Ga(154,new W(v.a.Nbb,v.a.xO))}}Object(t.a)(W,"SessionReloadSilentActivityFactory",b.a,[]);a.d(D,"a",function(){return P});const P=()=>{c.a.Fa(E=>{n.ka(E);W.ka(E)})}},1215:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(15),f=a(84),e=a(240),k=a(314),l=a(31),m=a(14),v=a(378),n=a(96);class w extends v.a{constructor(y,A){super(y,A);this.Voa=0;this.ur()}get oc(){return"SharedWorkbookDialog"}get lrb(){return this.Voa}fO(y,
A){this.Voa=y;super.fO(y,A)}ur(){super.ur();this.Sb=9;const y=this.eQh();this.sc(1,m.a.instance.ga(1661));this.sc(2,m.a.instance.ga(989));this.yl(m.a.instance.ga(707),n.a.zh(y),this.icon,this.b0)}eQh(){return String.format(m.a.instance.ga(708))}}Object(t.a)(w,"LegacySharedWorkbookDialog",v.a,[]);var r=a(6),u=a(35);class x extends e.a{constructor(y,A,K){super(y,A);this.executionContext=null;this.Xqi=G=>{const T=this.Cs.fd,W=Object(f.a)(7,T.Be);let P;P=G.lrb;this.unsubscribe(E=>{G.remove_disposing(E)});
for(let E=0,H=T.errors.length;E<H;E++)-573864504===T.errors[E].MessageId&&T.zba(T.errors[E]);switch(P){case 1:W.ea.izc=!0;d.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.dh(W.isEditMode?r.a.JMb:this.Nbh);this.pp();break;case 2:this.dh(r.a.openInExcelClient);this.pp();break;case 0:T.activityState[u.a.Dr]=!1,this.dh(this.MJ),this.pp()}};this.Nbh=A;this.MJ=K}initialize(y){super.initialize(y)}execute(y){this.executionContext=
y;this.$4g();return 1}BI(y){super.BI(y)}$4g(){const y=Object(f.a)(7,this.executionContext.Be),A=l.a.qZa([-573864504]);A[0].HelpDescription=m.a.instance.ga(710);A[0].HelpTopicId=k.a.Yqi;const K=new w(y,A[0]);this.subscribe(this.executionContext,this.Xqi,G=>{K.add_disposing(G)})}}Object(t.a)(x,"LegacySharedWorkbookActivity",e.a,[]);class z extends b.a{constructor(y,A,K,G){super();this.activityName=y;this.DJ=A;this.MJ=K;this.$=G;this.Fb()}create(){this.qb(new x(this.activityName,this.DJ,this.MJ))}static ka(y){y.da.Ga(460,
new z(r.a.KAb,r.a.Vdb,y.Czb?r.a.Jj:r.a.mpb,y))}}Object(t.a)(z,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(D,"a",function(){return B});const B=()=>{c.a.Fa(z.ka)}},1239:function(t,D,a){t=a(0);var c=a(1277),b=a(1278),d=a(4);class f{constructor(){this.L3d=this.gb=null}get name(){return"Common.App.DirectPrint"}ai(l){this.gb=l;l.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").uc().Gc(()=>new c.a(d.AFrameworkApplication.ta.tW));l.register(233,"Common.App.DirectPrint.IDirectPrintManager").uc().Gc(()=>
b.a.create(this.gb))}init(){this.L3d=this.gb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.L3d.start()}dispose(){}}Object(t.a)(f,"PackageManager",null,[4,5]);var e=a(246);a.d(D,"a",function(){return k});const k=()=>{Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Ii(new f)}},1252:function(t,D,a){t=a(0);var c=a(15),b=a(4),d=a(86),f=a(27),e=a(38),k=a(78),l;(function(J){J[J.unableToRefreshLock=0]="unableToRefreshLock";J[J.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";
J[J.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";J[J.workbookTooLarge=3]="workbookTooLarge";J[J.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";J[J.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";J[J.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";J[J.unsupportedFeatures=7]="unsupportedFeatures";J[J.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";J[J.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
J[J.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";J[J.lastGenericStatusError=11]="lastGenericStatusError";J[J.scratchPadWarning=12]="scratchPadWarning";J[J.authenticationLost=13]="authenticationLost";J[J.odfCompatibilityIssues=14]="odfCompatibilityIssues";J[J.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";J[J.workbookIsIrmProtected=16]="workbookIsIrmProtected";J[J.biFeatureNotAvailable=17]="biFeatureNotAvailable";J[J.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
J[J.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";J[J.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";J[J.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";J[J.editAttemptInReadOnly=22]="editAttemptInReadOnly";J[J.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";J[J.unsupportedBrowser=24]="unsupportedBrowser";J[J.readOnlyPermissions=25]="readOnlyPermissions";J[J.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";J[J.policyWarningMessage=27]="policyWarningMessage";J[J.workingOnIt=28]="workingOnIt";J[J.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";J[J.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";J[J.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";J[J.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";J[J.legacyConnectionsBB=33]="legacyConnectionsBB";J[J.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";J[J.groupedSlicersBB=35]="groupedSlicersBB";J[J.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";J[J.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";J[J.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";J[J.wacGdprNotice=39]="wacGdprNotice";J[J.automaticSensitivityLabel=40]="automaticSensitivityLabel";J[J.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";J[J.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";
J[J.localStorageDisabled=43]="localStorageDisabled";J[J.autoRefreshDisabled=44]="autoRefreshDisabled";J[J.corruptedFileRepaired=45]="corruptedFileRepaired";J[J.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";J[J.minorVersionLimitReached=47]="minorVersionLimitReached";J[J.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";J[J.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";J[J.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";
J[J.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";J[J.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";J[J.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";J[J.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";J[J.promptEnableExternalLinks=55]="promptEnableExternalLinks";J[J.networkDown=56]="networkDown";J[J.defaultToViewDueToCogs=
57]="defaultToViewDueToCogs";J[J.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";J[J.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";J[J.canvasHealth=60]="canvasHealth";J[J.novModeDepreciation=61]="novModeDepreciation";J[J.mismatchedFileFormatConverted=62]="mismatchedFileFormatConverted";J[J.optimizeWorkbook=63]="optimizeWorkbook";J[J.novModePostDepreciation=64]="novModePostDepreciation";J[J.officeScriptsRunning=65]="officeScriptsRunning";J[J.powerQueryRefreshDataSourceNotSupported=
66]="powerQueryRefreshDataSourceNotSupported";J[J.readOnlyPivotTable=67]="readOnlyPivotTable";J[J.powerQueryRefreshHostNotSupported=68]="powerQueryRefreshHostNotSupported";J[J.refreshPageAfterEnablingTheExtension=69]="refreshPageAfterEnablingTheExtension";J[J.count=70]="count"})(l||(l={}));Object(t.b)("EwaBusinessBarEntryType",l);var m=a(5),v=a(1052);class n extends Sys.EventArgs{constructor(J,R,M=null){super();this.PFa=J;this.g5c=R;this.data=M}}Object(t.a)(n,"BusinessBarEntryDisplayChangedEventArgs",
Sys.EventArgs,[]);var w=a(1054),r=a(1053),u=a(1056),x=a(1055),z=a(1050),B=a(467),y=a(50),A=a(522),K=a(37),G=a(641),T=a(31),W=a(1),P=a(21),E=a(57),H=a(68),F=a(832);a.d(D,"a",function(){return N});class N extends k.a{constructor(J,R){super();this.Qa=new e.a;this.pT=null;this.dGc=[];this.Ukc=()=>{this.$.pa.cLa?this.removeEntry(13):this.Yf(13,null)};this.ki=(M,L)=>{for(let U=0,X=N.Nac().length;U<X;U++)M=N.Nac()[U],this.removeEntry(M);L.context&&0<L.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,
0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.tdj()};this.Un=(M,L)=>{var U;M=this.Pyh(L.errors);let X=[];for(let fa=0,S=M.length;fa<S;++fa){const ka=M[fa];if(1===ka.Type&&ka.Appearance&32)X=this.a3h(ka,X);else if(L.gnj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var da=(null===(U=L.context)||void 0===U?0:U.stopwatch)?L.context.stopwatch.tc:-1;5E3>da?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${da}ms).`):b.AFrameworkApplication.Xli()||this.MCg(ka,L.context.methodName)}da=[...N.Nac()];for(let V=0,wa=X.length;V<wa;++V){const ma=X[V];this.Yf(ma,ka);Array.remove(da,ma)}for(let V=0,wa=da.length;V<wa;++V)this.removeEntry(da[V])}};this.Xc=(M,
L)=>{this.Dc(M,L)};this.Dc=()=>{const M=this.$.ea;M.hc||M.eg()||(this.WGd(),this.dGc.length=0)};this.Zc=(M,L)=>{this.$.ea.eg()&&!L.YU||this.P8e(L.YU)};this.zEb=()=>{const M=this.$.userOperationManager.Aac();M&&M.operation.flags&1&&this.o2f()};this.Twf=()=>{this.o2f()};this.Uf=()=>{this.ywe();this.y2f()};this.rN=()=>{if(this.$.r4&&this.$.ea.eg()&&this.$.ea.hc)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),
this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const M=this.$.da.za(331);M&&M.xIa||this.removeEntry(55);this.removeEntry(5)}};this.$=J;this.nYa=R;this.dLg();b.AFrameworkApplication.rd&&b.AFrameworkApplication.rd.NSc(this);this.tXa=Array(70);for(let M=0;70>M;M++)this.tXa[M]=null;this.yh=G.EcmaDateClock.instance;this.Yhf=this.yh.Nb.getTime();R&&(R=J.pa,R.My(this.Un),R.Gr(this.ki),R.hmb(this.Ukc),R.IXa(this.Ukc),J.ea.hk(this.Xc),J.ea.Ou(this.Uf),J.el(this.Zc),J.ik(this.Dc),J.ea.CX(this.rN),
J.userOperationManager.Fr(this.zEb),W.EwaSettings.ma(169)&&J.ea.Sg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.y4e(),this.P8e(E.c(J)));J.da.Ga(5,this)}y4e(){T.a.ar(this.$.ea.JF)&&this.Un(this,new B.a(this.$.ea.JF,null,!1,-1,-1,-1,-1,"",-1,"",-1))}nDg(J){this.Qa.addHandler("bBarAttachedOrDetached",J)}get i6c(){return this.dGc}get domElement(){return this.pT?this.pT.domElement:null}dispose(){if(this.$){const J=this.$,R=J.pa;R.Oz(this.Un);R.qt(this.ki);R.Iqc(this.Ukc);R.nHb(this.Ukc);
J.ea.Hk(this.Xc);J.ea.Mw(this.Uf);J.Cl(this.Zc);J.Bl(this.Dc);J.ea.x_(this.rN);J.userOperationManager.Co(this.zEb);P.g(J).Wb.Gk(this.Twf)}d.a.Ia(this.pT);this.$=this.pT=null;super.dispose()}iei(J){switch(J){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;case 59:return W.EwaSettings.ma(649);default:return!1}}Yf(J,R,M=null,L=null,U=null){if(!this.$.isMobileMode||this.iei(J))this.nYa&&!this.yE(J)&&(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,
0,50,`Adding entry to BB: ${Enum.toString(l,J)}`),this.tXa[J]=this.yh.l7,this.pT.hE(J,R,L,U),this.Qa.raiseEvent("bBarAttachedOrDetached",new n(J,!0,M))),R&&32===R.Appearance&&H.a(this.$).fd.zba(R)}ozj(J,R,M,L){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");z.a.initialize(J,R,M,L);this.Yf(39,null)}pyj(J,R,M,L){v.a.initialize(J,R,M,L);this.Yf(40,null)}xAj(J,R,M,L){r.a.initialize(J,R,M,L);this.Yf(41,null)}Ozj(J,R,M,L){w.a.initialize(J,R,M,L);this.Yf(42,null)}GAj(J,R,M,
L){x.a.initialize(J,R,M,L);this.Yf(53,null)}FAj(J,R,M,L){u.a.initialize(J,R,M,L);this.Yf(54,null)}removeEntry(J){this.nYa&&(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(l,J)}`),this.tXa[J]=null,this.pT.removeEntry(J)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new n(J,!1)))}sLa(J){return this.nYa?this.pT.sLa(J):!1}yE(J){return this.nYa?this.pT.yE(J):!1}sCb(){c.ULS.sendTraceTag(537170248,0,50,
"Network disconnect notification received from the app")}ckc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}dLg(){const {BusinessBarControl:J}=a(1143);if(this.nYa&&!this.pT){P.g(this.$).Wb.Mk(this.Twf);var R=document.getElementById(this.$.Bb+m.a.Hte);this.pT=new J(this.$,R)}}WGd(){this.nYa&&this.pT.WGd()}tdj(){if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const R=
this.yh.l7;if(3E5<=R-this.Yhf){this.Yhf=R;for(let M=0;70>M;M++){var J=this.tXa[M];if(J&&(J=R-J,3E5<=J)){const L=Enum.toString(l,M);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${L}] was activated but not turned off for ${J} Millis`)}}}}}Pyh(J){const R=[];for(const M of J)switch(M.MessageId){case -113742550:const L=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||T.a.gh(J,L))&&R.push(-113742550)}return T.a.QF(J,
R)}a3h(J,R){switch(J.MessageId){case 2113407564:const M=T.a.qZa([1821390342,-943219229,-502303485,1437034227]);for(let L=0;L<M.length;L++)M[L].HelpTopicId=J.HelpTopicId,M[L].HelpDescription=J.HelpDescription,this.dGc.push(M[L])}switch(J.MessageId){case -395951567:this.Yf(6,J);break;case 1643490758:this.Yf(4,J);break;case -907264831:this.Yf(5,J);break;case 757111532:case 2113407564:this.Yf(7,J);break;case 2010656511:this.Yf(15,J);break;case 1321660996:this.$.I3c=!0;this.Yf(8,J);break;case 526339737:this.$.I3c=
!0;this.Yf(9,J);break;case -407088521:this.Yf(10,J);break;case 1756116017:this.Yf(14,J);break;case -1703455218:this.Yf(17,J);break;case 1393475740:this.Yf(25,J);break;case -949523941:this.Yf(26,J);break;case 1779381952:this.Yf(44,J);break;case 1421575100:this.Yf(45,J);break;case 613676060:this.Yf(46,J);break;case 1233668252:this.Yf(62,J);break;case 1911608588:J=!!(this.$.Bd&64);!this.$.ea.eg()&&J&&R.push(29);break;case 1544494907:break;case -655555355:R.push(this.Cpd()?1:0);break;case -1221382671:R.push(2);
break;case 1662282929:R.push(3);break;case 104919273:this.$.ea.eg()||R.push(30);break;case -689453604:J=!!(this.$.Bd&64);this.$.ea.L5e=!0;!this.$.ea.eg()&&J&&R.push(31);break;case 157762400:this.$.ea.dfc=!0;!this.$.ea.eg()&&this.$.Bd&64&&!this.$.isEditMode&&R.push(32);break;case -1125398042:W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.eg()&&this.$.Bd&64&&!this.$.isEditMode&&R.push(34);break;case -73730134:W.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&
!this.$.ea.eg()&&this.$.Bd&64&&R.push(33);break;case -293349236:R.push(66);break;case 1580811823:R.push(68);break;case -37299333:break;case 136737622:R.push(47);break;case -1780327030:this.Yf(55,J);break;case -113742550:this.Yf(57,J);break;case -260312420:this.$.ea.eg()||R.push(67);break;default:this.Yf(11,J)}return R}f9h(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!F.a.ind(F.a.lbd(1))&&(f.a.ep||f.a.Zg)){const J=y.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);K.TaskExtensions.Aa(J,
()=>{this.Yf(20,null)},this.la,3)}}A8h(J){!J&&A.b(this.$)&&this.Yf(61,null)}B8h(J){!J&&A.c(this.$)&&this.Yf(64,null)}P8e(J){(!J&&!this.$.printingEnabled||this.$.me.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Yf(16,null));this.f9h();this.ywe();this.y2f();this.A8h(J);this.B8h(J)}ywe(){this.$.workbookContext.Options&32768&&this.ezj()}ezj(){this.tXa[37]||this.Yf(37,
null)}eBj(){this.tXa[38]||this.Yf(38,null)}y2f(){W.EwaSettings.ma(649)&&this.$.workbookContext.Options&524288&&this.Yf(59,null)}W2f(J,R){this.Yf(58,J,null,R)}Ake(J,R=null){this.pT.yE(J)?this.pT.oNb(J,R):this.Yf(J,null,null,null,R)}o2f(){this.$.Bd&8&&this.Yf(12,null)}Cpd(){const J=this.$.da.za(38);return J?J.tokenExpired:!1}MCg(J,R){if(!this.yE(21)&&-1387426400!==J.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const M={};M.FailedMethod=
R;this.Yf(21,J,M)}}static Nac(){return N.Wne||(N.Wne=[0,1,2,3])}}N.Wne=null;Object(t.a)(N,"BusinessBarManager",k.a,[332,3,76])},1265:function(t,D,a){t=a(0);var c=a(220),b=a(1252);class d extends c.a{constructor(k){super();this.$=k;this.Fb()}create(){this.qb(this.$.da.za(5)||new b.a(this.$,!this.$.vaa))}static ka(k){k.da.Ga(4,new d(k))}}Object(t.a)(d,"BusinessBarManagerFactory",c.a,[]);var f=a(10);a.d(D,"a",function(){return e});const e=()=>{f.a.Fa(d.ka)}},1276:function(t,D,a){t=a(0);var c=a(15),b=
a(83),d=a(847),f=a(832),e=a(1197);class k{constructor(){this.eDc=new e.a;this.cDc=new e.a;this.bDc=new e.a;this.ZOg(this.eDc);this.YOg(this.cDc);this.XOg(this.bDc);this.jIc=new e.a;this.iIc=new e.a;this.hIc=new e.a;this.vRg(this.jIc);this.uRg(this.iIc);this.tRg(this.hIc);this.uEc=new e.a;this.rPg(this.uEc);this.SEa(this.uEc);this.SEa(this.bDc);this.SEa(this.cDc);this.SEa(this.eDc);this.SEa(this.iIc);this.SEa(this.jIc);this.SEa(this.hIc)}jXh(w,r){switch(w){case 1:return this.G_h(r);case 2:return this.ZGh(r)}return f.a.Ovc?
this.uEc:null}ZOg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}YOg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}XOg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}vRg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
w.add("OverlayBig","Get the Word app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover Word");w.add("OverlaySmallSplit2","designed for the iPad.");w.add("SkipButton","Skip for now")}rPg(w){w.add("Headline","Get the Office Online extension for Chrome");w.add("UseAppButton","Get the extension");w.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}uRg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);w.add("OverlayBig","Get the PowerPoint app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover PowerPoint");w.add("OverlaySmallSplit2",
"designed for the iPad.");w.add("SkipButton","Skip for now")}tRg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}SEa(w){w.add("Corporation","Microsoft Corporation")}G_h(w){switch(w){case 3:return this.jIc;
case 2:return this.iIc;case 1:return this.hIc}return null}ZGh(w){switch(w){case 3:return this.eDc;case 2:return this.cDc;case 1:return this.bDc}return null}static get instance(){k.Ma||(k.Ma=new k);return k.Ma}}k.Ma=null;Object(t.a)(k,"WildFireStringFactory",null,[]);var l=a(4),m=a(39),v=a(27);a.d(D,"a",function(){return n});class n{constructor(w,r,u,x,z=null,B=null){this.zMc=null;this._id=w;this.gNc=r;this.Log=z;this.cib=x;this.mkb=B;this.voa=null;this.cXa=u;this.Kkb=k.instance.jXh(r,w)}H1c(){this.voa=
new d.a(this.title,this.message,null);this.voa.addButton(this.Pte,Object(b.a)(this,this.wtf,"onButtonOneClick"),"");this.cXa&&this.voa.WBg(this.Rte,Object(b.a)(this,this.ztf,"onButtonTwoClick"));this.voa.O9=Object(b.a)(this,this.NGe,"dismissBar");this.voa.image=3;this.voa.id=16;this.voa.closeable=!0}get title(){return this.Kkb.na("Headline")}get message(){return this.Kkb.na("CallToAction")}get VTj(){return this.cXa}get Pte(){return this.cXa?this.Kkb.na("InstallButton"):this.Kkb.na("UseAppButton")}get Rte(){return this.cXa?
this.Kkb.na("OpenAppButton"):""}wtf(){this.cXa?this.lbi():this.MTj()}ztf(){this.cXa&&this.JTi()}get yRg(){return this.voa}get openUrl(){this.zMc||(this.zMc=this.Log());return this.zMc}lbi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.cib&&this.mkb&&this.mkb();f.a.iMf(this._id,this.gNc)}JTi(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.cib&&this.mkb&&this.mkb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Yoe(this._id),
this.openUrl,0,!1))}MTj(){f.a.Ovc?this.CRg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.gOd("BizBarClicked"),1!==this.gNc&&2!==this.gNc||f.a.UXg(this.openUrl,this.cib,this._id,this.mkb))}CRg(){this.cib?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");m.a.uU(l.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Veh(){this.cib?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):
c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.gOd(f.a.Vwe)}NGe(){f.a.Ovc?this.Veh():(f.a.gOd(f.a.lbd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static h3b(){const w=l.AFrameworkApplication.ta.Pa,r=new n(w.xj,f.a.Lac(),8<v.a.B4a,1===w.l5,()=>w.xx,w.iUf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r}}Object(t.a)(n,"WildFireBusinessBar",null,[])},1277:function(t,D,a){t=a(0);var c=a(15),b=a(83),d=a(133),f=a(4),e=a(13),k=a(94),
l=a(44),m=a(178),v=a(1069),n=a(88),w=a(56),r=a(80),u=a(934);class x extends d.StandardDialog{constructor(B,y,A,K=null){super();this.WO=this.em=this.jpa=null;this.Vm=[];this.wTb=y;this.QO=B;this.epg=A;this.IUb=K;this.Jkb=new u.a("LoadResource","LoadPrintablePdf")}MP(){this.Sb=5;this.width=40;const B=document.createElement("span");B.id=this.ei("DirectPrintHeaderContent");const y=document.createElement("span");y.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(y,"DirectPrintHeader");
this.WO=document.createElement("iframe");this.WO.name="pdfObjectFrame";this.WO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.WO.onload=Object(b.a)(this,this.K_i,"printablePdfLoaded");if(this.IUb&&0<this.IUb.count){var A=r.a.aed(this.wTb,this.IUb);const K=r.a.tHd(this.wTb,this.IUb);this.em=document.createElement("form");this.em.id="printPreviewPostForm";this.em.method="POST";this.em.target=this.WO.name;this.em.action=K;for(let G of A)A=document.createElement("input"),A.type="hidden",A.name=
G.key,A.value=G.value,this.em.appendChild(A)}else this.WO.setAttribute("src",this.wTb);Sys.UI.DomElement.addCssClass(this.WO,m.a.Rae);this.epg?(Sys.UI.DomElement.addCssClass(this.WO,"DirectPrintPdfObjectHidden"),y.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,n.a.rh(this.WO,n.a.jC,n.a.jk)):(Sys.UI.DomElement.addCssClass(this.WO,"DirectPrintPdfObject"),this.Vm.push(this.WO));B.appendChild(y);B.appendChild(document.createElement("br"));B.appendChild(this.WO);this.em&&B.appendChild(this.em);
B.appendChild(document.createElement("br"));B.appendChild(this.F0g(this.em?"#":this.wTb));this.Jkb.start();this.SBb(CommonUIStrings.l_AppTitle,null,null,null,null,B);this.hW(this.ei("DirectPrintHeaderContent"));this.em&&this.em.submit();this.I5g();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}F0g(B){const y=document.createElement("span");var A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;y.appendChild(A);f.AFrameworkApplication.fa&&
(2===f.AFrameworkApplication.ta.Pa.xj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ta.Pa.xj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(B=document.createElement("span"),2===f.AFrameworkApplication.ta.Pa.xj?B.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ta.Pa.xj&&(B.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.jpa=B,y.appendChild(document.createElement("br")),y.appendChild(B)):(A=document.createElement("a"),A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,A.href=B,A.target="_blank",A.id="PrintPDFLink",A.className="AllowBrowserClick",this.jpa=A,y.appendChild(document.createElement("br")),y.appendChild(A),this.em&&l.a.addHandler(A,"click",Object(b.a)(this,this.Rmc,"onSubmit")),this.QO.ra(e.a.click,this.jpa,Object(b.a)(this,this.SHe,"downloadPDFLinkClicked"),null));this.Vm.push(this.jpa);
return y}Rmc(B){this.em&&(this.em.target="_blank",this.em.submit());B.preventDefault()}I5g(){if(0<this.Vm.length){const B=new v.a(this.Vm),y=k.FocusManager.instance().eQ();y&&(this.jpa.focus(),y.$e=B,y.KZ=!0)}}SHe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}qsd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}K_i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Jkb&&this.Jkb.stop()}dispose(){this.jpa&&
(this.QO.Ba(e.a.click,this.jpa,Object(b.a)(this,this.SHe,"downloadPDFLinkClicked")),this.jpa=null);w.a.w_(this.WO);this.WO=null;super.dispose()}}Object(t.a)(x,"DirectPrintDialog",d.StandardDialog,[265]);a.d(D,"a",function(){return z});class z{constructor(B){this.QO=B}LLh(B,y){return new x(this.QO,B,y,null)}}Object(t.a)(z,"DirectPrintDialogFactory",null,[232])},1278:function(t,D,a){t=a(0);var c=a(15),b=a(547),d=a(83),f=a(1330),e=a(1070);class k{constructor(r,u){this.B6f=r;this.jSa=u}}Object(t.a)(k,
"DirectPrintProbeResults",null,[]);var l=a(4),m=a(262),v=a(27),n=a(112);a.d(D,"a",function(){return w});class w{constructor(r,u,x,z,B,y,A,K,G,T){this.ZVb=null;this.Rmg=r;this.gjb=u;this.aMc=x;this.oqg=z;this.Uqg=B;this.sNc=new b.a(Object(d.a)(this,this.JTh,"getProbeResults"));this.zUa=y;this.N9d=G;this.awg=A;this.Vqg=K;this.brg=T}get KC(){return this.Rmg}start(){}L1i(){const r=Array(this.KC.iSa.length);if(void 0!==this.gjb&&null!==this.gjb)for(let u=0;u<this.KC.iSa.length;u++)r[u]=this.KC.iSa[u]in
this.gjb&&this.oqg(this.gjb[this.KC.iSa[u]]);return r}M1i(){const r=Array(this.KC.jSa.length),u=!(void 0===this.aMc||null===this.aMc);for(let x=0;x<this.KC.jSa.length;x++){const z=this.KC.jSa[x];r[x]=u&&z in this.aMc?!0:this.Uqg(z)}return r}AXh(){const r=this.L1i(),u=Array(r.length);for(let x=0;x<r.length;x++)u[x]=r[x]?this.exh(this.gjb[this.KC.iSa[x]]):null;return u}exh(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}JTh(){var r=this.AXh();const u=
this.M1i(),x={},z={};for(let B=0;B<this.KC.iSa.length;B++)x[this.KC.iSa[B]]=r[B];for(r=0;r<this.KC.jSa.length;r++)z[this.KC.jSa[r]]=u[r];return new k(x,z)}Wxj(){return this.brg||!this.KC.isEnabled||l.AFrameworkApplication.isUnifiedHostMode?!1:this.WFj()}Qvc(){if(null!=this.ZVb)return this.ZVb;const r=w.Dbf(this.KC);return this.ZVb=this.KC.Ebf&&r||this.Gei()}Gei(){return v.a.fp&&this.KC.Iei&&v.a.Xwe>=this.KC.EWg?!0:!1}WFj(){if(!this.Vqg(this.KC))return!1;var r=n.a.Cfd(this.sNc.value.B6f);for(const u of r)if(void 0!==
u&&null!==u)return!0;r=n.a.Cfd(this.sNc.value.jSa);for(const u of r)if(u)return!0;return!1}b4h(){const r=n.a.Cfd(this.sNc.value.B6f);for(const u of r)if(m.a.contains(this.KC.n7h,u))return!0;return!1}S2f(r){l.AFrameworkApplication.ta&&l.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.N9d(r,null):this.Wxj()?this.mfh(r,this.b4h()&&!0):this.N9d(r,null)}mfh(r,u){const x=this.awg.xc("UserAction","OpenDirectPrintDialog");this.zUa.LLh(r,u).MP();x.stop()}static egf(r){try{return new ActiveXObject(r),
!0}catch(u){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static Fbf(r){return void 0===r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const u=new e.a(l.AFrameworkApplication.fa.appSettings);let x=null;try{x=window.navigator.mimeTypes}catch(T){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let z=null;try{z=window.navigator.plugins}catch(T){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const B=
w.Fbf,y=w.egf;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const A=l.AFrameworkApplication.ta.LD,K=w.fgf,G=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Pa.nv&&!l.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new w(u,x,z,B,y,r,A,K,(T,W)=>new f.a(T,!1,W,!0,G),l.AFrameworkApplication.rLa)}static fgf(r){return v.a.fp||v.a.iu&&r.Uhi||r.Ebf&&w.Dbf(r)?!0:!1}static Dbf(r){var u=v.a.Orb;if(u){var x=u.split(".");if(2===x.length)return u=parseInt(x[0]),x=
parseInt(x[1]),u>r.bvd||u===r.bvd&&x>=r.fpf}return!1}}Object(t.a)(w,"DirectPrintManager",null,[233])},1325:function(t,D,a){a.d(D,"a",function(){return m});t=a(0);var c=a(83);D=a(133);var b=a(1058),d=a(259),f=a(4),e=a(13),k=a(80),l=a(27);class m extends D.StandardDialog{constructor(v,n=!0,w=!1,r=null,u=null,x=!1){super();this.WUa=this.VUa=this.em=this.fX=null;var z=this.DUd?this.DUd:CommonUIStrings.l_DefaultDialogTitle;m.t4a=x;this.CQb=r||new b.a(v,!0);this.CQb.ere(this);const B=[],y=[];m.zu&&(this.eUc&&
this.eUc.forEach(G=>{Array.add(B,G)}),this.qne&&this.qne.forEach(G=>{Array.add(y,G)}));n?w?(this.Sb=4,this.sc(1,this.buttonText),this.sc(2,CommonUIStrings.l_DialogClose)):(this.Sb=6,this.sc(0,CommonUIStrings.l_DialogClose)):this.Sb=5;x=document.createElement("span");this.Z2c&&(x.className=this.Z2c);r=document.createElement("a");r.innerText=this.$hc;r.href=v;r.target="_blank";r.id=this.Zhc;r.className=d.AFrame.Yne;var A=!l.a.bD&&!!u&&0<u.count;if(A){const G=k.a.aed(v,u);u=k.a.tHd(v,u);r.href="#";r.target=
"_self";this.em=document.createElement("form");this.em.id="printPreviewPostForm1";this.em.method="post";this.em.target="_blank";this.em.action=u;for(var K of G)u=document.createElement("input"),u.type="hidden",u.name=K.key,u.value=K.value,this.em.appendChild(u)}else this.em=null;this.em||m.t4a?m.t4a||Array.add(y,{["type"]:"AppLinkProps",["id"]:this.Zhc,["text"]:this.$hc,["onExecute"]:()=>{this.FKf()}}):Array.add(y,{["type"]:"AppLinkProps",["id"]:this.Zhc,["text"]:this.$hc,["handler"]:{["href"]:A?
"#":v,["target"]:A?"_self":"_blank"}});this.mNa&&Array.add(B,this.mNa);w?(v=document.createElement("span"),v.innerText=this.mNa.replace("{0}",""),x.appendChild(v)):this.Xof?(v=document.createElement("span"),v.id=this.ei("message"),K=document.createElement("span"),u=document.createElement("span"),A=this.mNa.split("{0}"),K.innerText=A[0],u.innerText=A[1],v.appendChild(K),v.appendChild(r),v.appendChild(u),x.appendChild(v)):(v=document.createElement("span"),v.innerText=this.mNa,x.appendChild(v),x.appendChild(document.createElement("br")),
x.appendChild(document.createElement("br")),x.appendChild(r),m.t4a||Array.add(B,"{0}"));this.em&&x.appendChild(this.em);m.zu&&(this.t7a&&(this.GAb?this.ake(this.t7a,this.GAb):(Array.add(B,"{0}"),Array.add(y,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.t7a,["onExecute"]:()=>{this.Thc()}}))),this.Vqa(B,y));this.SBb(z,null,this.Y7e,null,Object(c.a)(this,this.gw,"dialogHandler"),m.zu?null:x);this.hW(this.ei("message"));!m.zu&&this.GAb&&this.t7a&&(z=document.createElement("div"),z.className=
"WACDialogLearnMoreLinkContainer",this.fX=document.createElement("a"),this.fX.innerText=this.t7a,this.fX.href=this.GAb,this.fX.target="_blank",this.fX.id=this.ei("LearnMoreLinkId"),this.fX.className=d.AFrame.Yne,z.appendChild(this.fX),n?this.vb.insertBefore(z,this.vb.lastChild):this.vb.appendChild(z),this.hW(String.format("{0} {1}",this.ei("message"),this.ei("LearnMoreLinkId"))));this.Sgb=r;w?this.qI(this.SB):this.qI(this.Sgb);this.Fkf();f.AFrameworkApplication.ta.tW.ra(e.a.click,this.Sgb,Object(c.a)(this,
this.QHe,"downloadLinkClicked"),null);this.fX&&f.AFrameworkApplication.ta.tW.ra(e.a.click,this.fX,Object(c.a)(this,this.Thc,"learnMoreLinkClicked"),null);this.AQb=!1}get Y7e(){return null}get DUd(){return null}get mNa(){return null}get GAb(){return null}get t7a(){return null}get Xof(){return!1}get buttonText(){return CommonUIStrings.l_Open}get Z2c(){return null}get eUc(){return null}get qne(){return null}FVc(){this.em&&(this.VUa||(this.VUa=Object(c.a)(this,this.KEi,"onActionButtonClicked"),this.Ey.ra(e.a.click,
this.SB,this.VUa)),this.WUa||(this.WUa=Object(c.a)(this,this.LEi,"onActionButtonKeyUp"),this.Yd.ra(e.a.Gd,this.SB,this.WUa)));super.FVc()}KEi(v){this.LPe(v);return!0}LEi(v){return this.Phf(v,Object(c.a)(this,this.LPe,"executeDismissActionButtonFromArgs"))}LPe(v){this.em&&this.em.submit();this.Mta(v.Cb)}qsd(){}QHe(){this.Hkf();this.em?this.em.submit():this.CQb.m5c();return!0}Thc(){return!1}dispose(){this.CQb.dispose();this.Sgb&&(f.AFrameworkApplication.ta.tW.Ba(e.a.click,this.Sgb,Object(c.a)(this,
this.QHe,"downloadLinkClicked")),this.Sgb=null);this.fX&&(f.AFrameworkApplication.ta.tW.Ba(e.a.click,this.fX,Object(c.a)(this,this.Thc,"learnMoreLinkClicked")),this.fX=null);this.Ey&&this.VUa&&(this.Ey.Ba(e.a.click,this.SB,this.VUa),this.VUa=null);this.Yd&&this.WUa&&(this.Yd.Ba(e.a.Gd,this.SB,this.WUa),this.WUa=null);super.dispose()}FKf(){this.em&&(document.body.appendChild(this.em),this.em.submit(),document.body.removeChild(this.em))}gw(v){1===v&&(this.qsd(),this.em?m.zu&&this.FKf():this.CQb.m5c());
this.dispose()}static get zu(){return f.AFrameworkApplication.ta.Pa.nv&&f.AFrameworkApplication.ta.Pa.Qef}static get t4a(){return m.m6d}static set t4a(v){m.m6d=v}}m.m6d=!1;Object(t.a)(m,"ADialogWithLinkToResource",D.StandardDialog,[])},1326:function(t,D,a){a.r(D);a.d(D,"ReactOICErrorDialogWithTrial",function(){return f});t=a(0);var c=a(83);D=a(1060);var b=a(414),d=a(144);class f extends D.a{constructor(e,k,l,m,v,n){super(e,k,l,m,v,n);k={["errorMessage"]:this.GKe,["offerString"]:this.Urf};e=new d.a(!1,
!1,!0);this.p2f?(e.Sb=1,k.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.ova,["onExecute"]:()=>{b.Redirect.showHelp(this.t6e)}}):(e.Sb=4,e.sc(2,this.R7e));e.sc(1,this.sWb);e.Ae=this.id;k={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:k};e.initializeAndShow(this.Il,Object(c.a)(this,this.i4i,"reactOICErrorDialogWithTrialHandler"),k)}}Object(t.a)(f,"ReactOICErrorDialogWithTrial",D.a,[])},1327:function(t,D,a){a.r(D);a.d(D,"OICErrorDialogWithTrial",function(){return d});t=
a(0);var c=a(83);D=a(1060);var b=a(133);class d extends D.a{constructor(f,e,k,l,m,v){super(f,e,k,l,m,v);f=document.createElement("span");f.innerText=this.GKe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));e=document.createElement("span");e.innerText=this.Urf;f.appendChild(e);e=new b.StandardDialog;this.p2f?(e.Sb=1,e.jke(this.ova,this.t6e)):(e.Sb=4,e.sc(2,this.R7e));e.sc(1,this.sWb);e.Ae=this.id;e.yl(this.Il,null,this.icon,Object(c.a)(this,this.Tqi,"legacyOICErrorDialogWithTrialHandler"),
f)}}Object(t.a)(d,"OICErrorDialogWithTrial",D.a,[])},1328:function(t,D,a){a.r(D);a.d(D,"CheckRoamingRightsRequest",function(){return c});t=a(0);a=a(1061);class c extends a.a{constructor(){super()}avb(){return 2}W$(){return 1}}Object(t.a)(c,"CheckRoamingRightsRequest",a.a,[])},1329:function(t,D,a){a.r(D);a.d(D,"GetRoamingLauncherRequest",function(){return c});t=a(0);a=a(1061);class c extends a.a{constructor(){super()}avb(){return 0}W$(){return 2}}Object(t.a)(c,"GetRoamingLauncherRequest",a.a,[])},
1330:function(t,D,a){a.d(D,"a",function(){return m});t=a(0);var c=a(15),b=a(1325),d=a(1058),f=a(4),e=a(88),k=a(80),l=a(27);class m extends b.a{constructor(v,n,w=null,r=!0,u=!1){super(v,!0,!(m.aBa&&r),new d.a(v,n),w,u);m.aBa=m.aBa&&r;if(m.aBa){n=document.createElement("iframe");r=null;u=this.ieh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(w&&0<w.count){const x=k.a.aed(v,w);v=k.a.tHd(v,w);r=document.createElement("form");r.id="printPreviewPostForm";r.method="POST";r.target=n.name;r.action=v;for(let z of x)v=
document.createElement("input"),v.type="hidden",v.name=z.key,v.value=z.value,r.appendChild(v)}else n.src=v;u.appendChild(n);r&&(u.appendChild(r),r.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");e.a.rh(n,e.a.jC,e.a.jk)}}get Y7e(){return"Print_32x32x32"}get DUd(){return m.aBa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get mNa(){return m.aBa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get eUc(){const v=[];Array.add(v,CommonUIStrings.l_PrintDialogCanCloseDocument);
if(b.a.t4a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ta.Pa.rEe&&(n=f.AFrameworkApplication.ta.Pa.rEe);Array.add(v,n)}return m.aBa?v:null}get $hc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Zhc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get Z2c(){return f.AFrameworkApplication.fGe?"UIFontDialogTextLarge":null}Fkf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Hkf(){f.AFrameworkApplication.Dn.Wwb(9540);
c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}qsd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get aBa(){return!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Pa.nv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(l.a.bD||l.a.iu||l.a.Tf||l.a.PLa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set aBa(v){}}Object(t.a)(m,
"PrintDialogWithLinkToPdf",b.a,[])},1347:function(t,D,a){t=a(0);var c=a(83),b=a(41);class d{constructor(){this.classId=0}static zHa(m){try{return b.a(m)}catch(v){}return null}}Object(t.a)(d,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.qmd=!1}}Object(t.a)(f,"GetRoamingAppsLauncherContext",null,[]);var e=a(4),k=a(107);a.d(D,"a",function(){return l});class l{constructor(m){this.sEc=!1;this.sWa=l.Ycc;this.kOc=this.mMc=0;this.platform=null;this.zug=m;this.Che=
this.lOc=!1}get roamingAppsAreEnabled(){return this.zug}get fUj(){return this.roamingAppsAreEnabled&&this.lOc?this.Che:!1}rWg(){e.AFrameworkApplication.yfc&&this.roamingAppsAreEnabled&&!this.lOc&&!this.sEc&&(this.kOc=1,this.sEc=!0,this.rfj(),this.IPe())}rfj(){this.sWa=l.Ycc;this.mMc=0}getRoamingAppsLauncher(m,v,n){this.fUj?(m=new f,m.callback=v,m.state=n,m.qmd=!0,this.NPe(m)):v(!1,"",n)}IPe(){const m=new (a(1328).CheckRoamingRightsRequest);m.RoamingApp=this.kOc;m.BaseDocQuerySignature=e.AFrameworkApplication.gj;
m.execute(Object(c.a)(this,this.tWg,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.sWg,"checkUserRoamingRightsFailed"),null)}tWg(m){e.AFrameworkApplication.Mg||((m=d.zHa(m.data.Td))?this.iOd(m.HasRights):this.iOd(!1))}sWg(){if(!e.AFrameworkApplication.Mg)if(this.mMc>=l.vyi)this.iOd(!1);else{var m=new k.a(2,1,this.sWa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);e.AFrameworkApplication.Ji.Hg(m);this.mMc++;this.sWa*=l.Ngj;this.sWa>l.rof&&(this.sWa=l.rof)}}iOd(m){this.Che=
m;this.lOc=!0;this.sEc=!1}retryCheckUserRoamingRights(){this.IPe()}NPe(m){const v=new (a(1329).GetRoamingLauncherRequest);v.RoamingApp=this.kOc;v.BaseDocQuerySignature=e.AFrameworkApplication.gj;v.execute(Object(c.a)(this,this.mVh,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.lVh,"getRoamingAppsLauncherFailed"),m)}mVh(m){if(!e.AFrameworkApplication.Mg){var v=d.zHa(m.data.Td);m=m.data.state;v?(this.platform=v.Platform,m.callback(!0,v.Launcher,m.state)):m.callback(!1,"",m.state)}}lVh(m){if(!e.AFrameworkApplication.Mg){var v=
m.data.state;5===m.data.status&&v.qmd?(v.qmd=!1,this.NPe(v)):v.callback(!1,"",v.state)}}static get instance(){return l.dC||(l.dC=new l(e.AFrameworkApplication.xKg))}}l.Ycc=1E3;l.Ngj=5;l.rof=12E5;l.vyi=5;l.dC=null;Object(t.a)(l,"RoamingAppsManager",null,[])},1421:function(t,D,a){a.r(D);var c=a(1044),b=a(0),d=a(246);class f{get name(){return"Common.App.DialogWithLinkToResource"}ai(){}init(){}dispose(){}static main(){d.a.instance.Ii(new f)}}Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,
[4,5]);var e=a(547),k=a(15),l=a(83),m=a(804),v=a(29),n=a(130);class w{static Gjh(tc){return w.Bte("New",tc)}static Hjh(tc){return w.Bte("Open",tc)}static mte(tc,$c){return w.Ega("LoadingMenuSection",w.rsi,tc,w.gob("lblLoading",$c))}static hob(tc,$c,Ed=null,Id=null){return w.Ega("MessageMenuSection",w.Lpf,$c,w.gob("lblMessage",tc,Ed,Id))}static kQg(tc){return w.mte(tc,CommonUIStrings.l_VoicedLoadingText)}static lQg(tc,$c){return w.hob(CommonUIStrings.l_NewCreationLocationMessage,tc.ji,$c.eR,$c.pna)}static jQg(tc,
$c){return w.hob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,$c.pna,"\n\n"),tc.ji)}static ote(tc){return w.hob(CommonUIStrings.l_NewGenericErrorMessage,tc.ji)}static hQg(tc,$c,Ed){return w.Ega("menuNewBlank",w.K4h,Ed?tc.ji:null,w.cob(tc.d6e,tc.e6e,tc.f6e,null,tc.sja,tc.Jwb,$c,"blank"))}static gRg(){return w.gob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static yte(){return w.gob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static hRg(tc,$c){return w.Ega("menuNewTemplates",
tc,null,$c)}static fQg(tc,$c){return w.Ega("menuNewMoreTemplates",w.$Se,null,w.cob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,tc,$c))}static jPg(tc,$c,Ed){let Id="";Ed&&$c&&(Id=w.Ega("BrowseMoreMenuSection",w.$Se,null,w.cob("btnBrowseMore",$c,$c,null,null,null,tc||"1959943459",Ed)));return Id}static gob(tc,$c,Ed=null,Id=null){let ae=Id;$c&&0<$c.length&&(ae=w.Gqf.$nc($c).trimEnd(),ae=0<=ae.indexOf("{0}")?String.format(ae,Id):String.format("{0} {1}",
ae,Id));Ed=Ed&&Id?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',v.a.ff(Ed),v.a.ff(Id),v.a.ff(ae)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',v.a.ff(tc||""),w.Gqf.$nc(v.a.ff($c||"")),Ed)}static cob(tc,$c,Ed,Id,ae,ja,hb,oa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
v.a.ff(tc||""),v.a.ff($c||""),v.a.ff(Ed||""),Id||"32by32",v.a.ff(ae||""),v.a.ff(ja||""),hb,v.a.ff(oa||""))}static Bte(tc,$c){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',tc,$c)}static Ega(tc,$c,Ed,Id){Ed=Ed?String.format('Title="{0}"',v.a.ff(Ed)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
v.a.ff(tc||""),v.a.ff($c||""),Ed,Id)}}w.Lpf="MenuMru";w.rsi="MenuLoading";w.K4h="MenuHeader";w.$Se="MenuFooter";w.Gqf=n.a.Bx("\n","&#10;");Object(b.a)(w,"NewAndOpenXmlUtilities",null,[]);var r=a(4),u=a(98),x=a(160);class z{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(z,"HostInformation",null,[]);var B=a(107),y=a(39),A=a(370),K=a(163),G=a(639),T=a(572),W=a(106),P=a(25);class E{constructor(tc,$c,Ed,Id,ae,ja){this.mQc=this.Io=this.tPb=null;this.fVb=this.wPc=
!1;this.J$d=0;this.kPc=this.EJc=!1;this.c1=tc;this.nhb=$c;this.OCa=new e.a(()=>new m.a(Ed.value,Object(l.a)(this,this.Mub,"getMoreInfoEventReceived")));this.asg=Id;this.Ypa=ae;this.qvg=ja;this.Akb=this.Mvc;2===this.AK.Fba&&(this.kPc=!0)}get dP(){switch(this.AK.Fba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Fg(){const tc=this.AK.s8a;tc.Ob(P.a.newDocument,W.a.frame,Object(l.a)(this,this.newDocument,"newDocument"));tc.Je(P.a.soc,W.a.frame,
Object(l.a)(this,this.soc,"populateNewMenu"),96)}newDocument(tc,$c,Ed,Id,ae){return 1===Ed?32:2===Ed&&ae&&ae.MenuItemId&&ae.SourceControlId?this.V_a(ae.MenuItemId,ae.SourceControlId):8}V_a(tc,$c){var Ed=this.fkc.t2c;if(null===Ed)return 8;var Id=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.cba&&Id){k.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ae={};ae[A.a.Q7f]=
tc;ae[A.a.dP]=this.dP;ae[A.a.lcid]=r.AFrameworkApplication.lcid.toString();ae[A.a.reason]=G.a.createNew;r.AFrameworkApplication.GU().execute(ja=>{ja.Fj(K.a.V_a,ae)})}else Id=(new Date).getTime(),$c=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Ed,v.a.ef(this.Lka),v.a.ef(tc),v.a.ef(this.dP),v.a.ef(r.AFrameworkApplication.lcid.toString()),v.a.ef(Id.toString()),v.a.ef($c),v.a.ef(r.AFrameworkApplication.canary),r.AFrameworkApplication.gj),
(Ed=r.AFrameworkApplication.fa.Va("ScenarioId"))&&""!==Ed&&($c+="&wdscenarioid="+v.a.ef(Ed)),$c+="&"+r.AFrameworkApplication.pac(),r.AFrameworkApplication.kwa&&($c+="&"+r.AFrameworkApplication.F$b()),(Ed=this.Io?this.Io.eR:null)&&($c+="&DestinationUrl="+v.a.ef(Ed)),y.a.Ve($c,"_blank",void 0,"CreateNewDocument");2===this.AK.Fba&&k.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:T.a[this.AK.Fba],["Template"]:tc});return 32}Bvi(tc){let $c=Number.MAX_VALUE,Ed=Number.MIN_VALUE;
const Id=window.performance;if(Id&&"undefined"!==typeof Id.getEntriesByName){for(let ja=0;ja<tc.length;ja++){var ae=Id.getEntriesByName(tc[ja]);ae&&0<ae.length&&(ae=ae[0],$c=Math.min(parseInt(String(ae.fetchStart)),$c),Ed=Math.max(parseInt(String(ae.responseEnd)),Ed))}Ed>$c&&k.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Ed-$c,["MinFetchStart"]:$c,["MaxResponseEnd"]:Ed})}}soc(tc,$c,Ed,Id,ae){if(1===Ed)return this.kPc&&(r.AFrameworkApplication.dN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.kPc=!1),32;2!==Ed||this.EJc||(this.J$d=(new Date).getTime(),k.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Mvc,["CachedNewMenuXmlExists"]:!!this.tPb,["ShouldCallGetMoreInfo"]:this.AK.supportsGetMoreInfoForPersonalStorage}));return this.nYi(ae)}nYi(tc){tc&&(this.tPb?tc.PopulationXML=this.tPb:(this.AK.supportsGetMoreInfoForPersonalStorage&&!this.Io&&this.hCi.SY("Opened New menu",!0),tc.PopulationXML=this.QFh(this.getTemplateListJson())));
return 32}Vef(){return!this.AK.supportsGetMoreInfoForPersonalStorage||!!this.Io&&3===this.Io.state&&!!this.Io.pna&&!!this.Io.eR}rki(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.vZ?!0:this.Vef()}getTemplateListJson(){if(!this.Mvc||!this.rki())return null;if(this.Akb&&!this.fVb){var tc="9";const $c=r.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in $c&&(tc=$c.NumberOfTemplatesInBackstage);let Ed=this.dP;"TemplateCollectionId"in $c&&(Ed=$c.TemplateCollectionId);
tc=String.format(this.AK.gV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",v.a.ef(r.AFrameworkApplication.lcid.toString()),v.a.ef(Ed),tc);Boolean.parse($c.AppendOriginQueryParam||"false")&&(tc+="&org=backstage");tc+="&"+r.AFrameworkApplication.pac();r.AFrameworkApplication.kwa&&(tc+="&"+r.AFrameworkApplication.F$b());this.AK.tCb.hm(tc,1,null,null,!1,2,Id=>{this.AK.tba("CreateNewActor.GetTemplateListJson",Id.data);this.BHj(Id.data.Td)},Id=>{this.AK.tba("CreateNewActor.GetTemplateListJson",
Id.data);this.AHj()},null,void 0,void 0,void 0,void 0,"5");this.Akb=!1}return this.mQc}BHj(tc){this.mQc=tc;this.Akb=!1;this.HGb();if(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.vZ&&x.c()){tc=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const $c=r.AFrameworkApplication.cba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.mQc,!0,tc&&$c))}}AHj(){this.fVb=this.Akb=!0;this.HGb();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.vZ&&
x.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));u.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}kYh(tc){var $c=0;for(var Ed=0;Ed<tc.length;Ed++)if("ST"===tc[Ed].ImageType){$c=Ed;break}const Id=tc.length?tc[$c]:null;tc=Id?Id.Url||"":"";var ae;let ja=Ed=$c=!1;if(Id&&(ae=Id.AspectRatio))ae=parseFloat(ae),1>ae?$c=!0:1.5<ae?Ed=!0:1===ae&&(ja=!0);else switch(k.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:tc}),this.AK.Fba){case 3:$c=!0;break;case 2:Ed=!0;break;case 5:ja=!0}return{returnValue:tc,i7h:$c?"95by123":Ed?"123by69":ja?"100by100":"123by95"}}QFh(tc){tc=({nvc:$c}=this.iQg(tc,this.fkc,this.fkc.QFa||"1056925771")).returnValue;if($c){this.tPb=tc;var $c=(new Date).getTime()-this.J$d;k.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:$c})}return tc}Mub(tc,$c){k.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");
this.Io||3!==tc.state?2===tc.state&&(k.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.wPc=!0,this.HGb()):(this.Io=tc,$c||this.HGb(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.vZ&&x.c()&&x.d("setFileMenuHostInformation")&&(tc=Object.assign(new z,{hostUrl:this.Io.eR,hostName:this.Io.pna,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,folderName:r.AFrameworkApplication.breadcrumbFolderName}),k.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(tc))))}iQg(tc,$c,Ed){let Id;Id=!1;const ae=this.Vef();let ja="";this.AK.supportsGetMoreInfoForPersonalStorage&&(this.wPc?(ja=w.ote($c),this.wPc=!1,k.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Io?ae?ja=w.lQg($c,this.Io):this.Io.vbi?(Id=!0,this.Akb=!1,ja=w.jQg($c,this.Io),k.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Id=!0,ja=w.ote($c),k.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Io.eR,["StorageServiceDisplayNameIsSet"]:!!this.Io.pna})):(ja=w.kQg($c.ji),k.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));ae&&(ja+=w.hQg($c,Ed,!ja)+({nvc:Id}=this.fRg(tc,Ed)).returnValue);return{returnValue:w.Gjh(ja),nvc:Id}}fRg(tc,$c){let Ed;Ed=!1;if(!this.Mvc)return Ed=!0,k.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",nvc:Ed};let Id="",ae="",ja="MenuTemplate";if(this.fVb)Id=w.yte(),this.fVb=!1,k.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(tc){try{const hb=Sys.Serialization.JavaScriptSerializer.deserialize(tc,!0);Id=this.eRg(hb,$c);k.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.Hqf&&"OneDrive"===this.Lka&&(ae=w.fQg(this.iCi,r.AFrameworkApplication.Hqf))}catch(hb){k.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:tc}),Id=w.yte()}Ed=!0}else ja="MenuLoading",Id=w.gRg(),k.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:w.hRg(ja,Id)+ae,nvc:Ed}}eRg(tc,$c){let Ed="";const Id=[];for(let ja=0;ja<tc.length;ja++){var ae=tc[ja];let hb="";if(ae){const oa=ae.Title,fb=ae.AssetId;ae=ae.Thumbnails;fb&&oa&&ae&&({i7h:ae,returnValue:hb}=this.kYh(ae),Ed+=w.cob("jbtnNewTemplate"+ja,oa,null,
ae,null,hb,$c,fb))}Id[ja]=hb}tc=new B.a(4,1,5E3,()=>{this.Bvi(Id)},106);this.AK.dkc.Hg(tc);return Ed}HGb(){this.EJc=!0;this.AK.zqf.Ww(this.fkc.itb);this.EJc=!1}get AK(){return this.c1.value}get fkc(){return this.nhb.value}get hCi(){return this.OCa.value}get iCi(){return this.asg.value}get Lka(){return this.Ypa.value}get Mvc(){return this.qvg.value}}Object(b.a)(E,"CreateNewActor",null,[]);var H=a(1324);class F extends H.a{constructor(){super()}Yke(){this.$S(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);
this.$S(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.$S(2,CommonUIStrings.l_Open);this.$S(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.$S(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.$S(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return F.Ma||(F.Ma=new F)}static eUi(tc){return F.instance.ga(tc)}}F.Ma=null;Object(b.a)(F,"MruActorIntlHelper",H.a,[]);var N;(function(tc){tc[tc.success=0]="success";tc[tc.failure=1]="failure";tc[tc.spinner=2]="spinner";tc[tc.none=3]="none"})(N||
(N={}));Object(b.b)("DisplayState",N);var J=a(41);class R{constructor(tc,$c,Ed,Id,ae,ja,hb,oa){this.aEc=null;this.jRc=!0;this.sPb="";this.Ywg=0;this.EVa=null;this.zKc=3;this.nb=oa;this.c1=tc;this.fj=$c;this.Lng=Ed;this.Pkg=Id;this.Okg=ae;this.OCa=new e.a(()=>new m.a(ja.value,null));this.Aog=new e.a(()=>new m.a(hb.value,Object(l.a)(this,this.OAi,"mruEventResultReceived")));this.nb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.nb.qa("UiHostSupportsDocRebootFeatures")}OAi(tc,$c){this.EVa=tc;$c||this.zMf()}f8i(){this.Cw.s8a.Je(P.a.roc,
W.a.frame,Object(l.a)(this,this.roc,"populateMruMenu"),96)}roc(tc,$c,Ed,Id,ae){return 1!==Ed&&ae?this.kYi(ae):32}kYi(tc){this.kkh();this.jkh();tc.PopulationXML=w.Hjh(this.sPb+this.aEc);return 32}kkh(){var tc=3;let $c=!1;if(this.sPb&&this.Ywg===this.EVa.mJj)k.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),tc=this.zKc;else{k.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});
var Ed=this.Cw.kw();this.EVa=this.NAi.SY("File Open opened",!0);this.sPb&&2!==this.zKc&&3!==this.EVa.state?$c=!0:(tc=this.WVh(this.EVa),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.vZ&&x.c()&&tc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(tc,!0)),this.sPb=({$Bi:tc}=this.RFh(this.EVa)).returnValue);Ed=this.Cw.kw()-Ed;k.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Ed})}2!==tc&&(Ed={["DisplayState"]:N[tc]},
1!==tc&&(Ed.IsStale=$c),k.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Ed));this.zKc=tc}WVh(tc){let $c;try{$c=J.c(tc.wvd)}catch(Ed){$c=null,k.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Ed)}return $c}jkh(){this.jRc?(k.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.aEc=({oWj:this.jRc}=this.Wwi()).returnValue):k.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
k.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.jRc,["NotDisplayingLink"]:!this.aEc})}RFh(tc){let $c;1===tc.state||0===tc.state?(k.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),tc=2,$c=w.mte(this.$ia(2),this.$ia(5))):3===tc.state&&tc.wvd?($c=this.gQg(tc.wvd),tc=0):(k.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),$c=w.hob(this.$ia(1),this.$ia(2)),tc=1);return{returnValue:$c,
$Bi:tc}}gQg(tc){let $c;const Ed=this.OBb.QFa||"2155708348";if(tc.length){$c=w.gob("lblRecentDocuments",this.$ia(3));let Id=0;for(let ae=0;ae<tc.length;ae++){const ja=tc[ae];"FileName"in ja&&"DocumentUrl"in ja&&"Path"in ja&&($c+=w.cob("MruButton"+ae,ja.FileName.toString(),ja.Path.toString(),null,this.OBb.sja,this.OBb.Jwb,Ed,ja.DocumentUrl.toString()),ja.IsPinned&&Id++)}$c=w.Ega("RecentDocumentsMenuSection",w.Lpf,this.$ia(2),$c);k.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:tc.length,["NumPinnedDocuments"]:Id})}else $c=w.hob(this.$ia(0),this.$ia(2)),k.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return $c}Wwi(){let tc;tc=!0;let $c=this.COg;var Ed=this.BOg;if($c&&Ed||!this.Cw.supportsGetMoreInfoForPersonalStorage)tc=!1;else{const Id=this.M$b.SY("File Open",!1);3===Id.state&&($c=Id.eR,Ed=Id.pna,tc=!1)}Ed=Ed?String.format(this.$ia(4),Ed):null;return{returnValue:w.jPg(this.OBb.QFa,Ed,$c),oWj:tc}}zMf(){this.Cw.zqf.Ww(this.OBb.itb)}get Cw(){return this.c1.value}get $ia(){return this.fj.value}get OBb(){return this.Lng.value}get COg(){return this.Pkg.value}get BOg(){return this.Okg.value}get M$b(){return this.OCa.value}get NAi(){return this.Aog.value}}
Object(b.a)(R,"MruRenderer",null,[]);var M=a(236),L=a(762);class U{constructor(tc,$c,Ed,Id,ae,ja,hb){this.Io=null;this.zee=!1;this.lpa=this.v1d=0;this.hsg=tc;this.VVa=$c;this.XSb=Ed;this.nhb=Id;this.Ypa=ae;this.c1=ja;this.OCa=new e.a(()=>new m.a(hb.value,Object(l.a)(this,this.Mub,"getMoreInfoEventReceived")))}V_a(){!this.Io&&this.ewd.supportsGetMoreInfoForPersonalStorage?this.M$b.SY("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}Mub(tc){if(!this.Io&&3===tc.state)this.Io=tc;else if(2===
tc.state){this.zee?k.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.M$b.SY("NewDocumentFromStream",!0),this.zee=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.v1d=(new Date).getTime();var tc=this.iyh.t2c;if(null===tc)this.VVa(null);else{var $c=this.XSb.menuItemId,Ed=this.XSb.cG,Id=this.XSb.mFj,ae=this.XSb.nyh;this.lpa="streamBase64"===Id?ae.length/1024:0;k.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.dP,
this.lpa);var ja=(new Date).getTime();tc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",tc,v.a.ef(this.Lka),v.a.ef($c),v.a.ef(this.dP),v.a.ef(r.AFrameworkApplication.lcid.toString()),v.a.ef(ja.toString()),v.a.ef(Ed),v.a.ef(r.AFrameworkApplication.canary),r.AFrameworkApplication.gj,v.a.ef(Id));tc+="&"+r.AFrameworkApplication.pac();r.AFrameworkApplication.kwa&&(tc+="&"+r.AFrameworkApplication.F$b());($c=this.Io?this.Io.eR:null)&&
(tc+="&DestinationUrl="+v.a.ef($c));this.ewd.tCb.hm(tc,2,ae,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(l.a)(this,this.cCi,"newDocumentFromStreamSuccessHandler"),Object(l.a)(this,this.bCi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}cCi(tc){if(tc&&tc.data&&tc.data.Td)if(({Vt:$c}=J.d(tc.data.Td)).returnValue)if(tc=$c,tc.StatusCode!==M.a.DO&&tc.StatusCode!==M.a.Cqb)k.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.dP,this.lpa,tc.StatusCode),this.VVa(null);else if(tc.NewDocumentUrl&&""!==tc.NewDocumentUrl){var $c=(new Date).getTime()-this.v1d;k.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.dP,this.lpa,$c);this.hsg(tc.NewDocumentUrl)}else k.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.dP,this.lpa),this.VVa(null);else k.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.dP,this.lpa,{["ResponseData"]:L.a.aeb(tc.data.Td)}),this.VVa(null);else k.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.dP,this.lpa),this.VVa(null)}bCi(tc){tc&&tc.data&&k.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.dP,this.lpa,tc.data.status);this.VVa(null)}get dP(){switch(this.ewd.Fba){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get iyh(){return this.nhb.value}get Lka(){return this.Ypa.value}get ewd(){return this.c1.value}get M$b(){return this.OCa.value}}Object(b.a)(U,"NewDocumentFromStreamOperation",null,[]);class X{constructor(tc,$c,Ed,Id){this.nhb=tc;this.Ypa=$c;this.c1=Ed;this.zog=Id}create(tc,$c,Ed){return new U(tc,$c,Ed,this.nhb,this.Ypa,this.c1,this.zog)}}Object(b.a)(X,"NewDocumentFromStreamOperationFactory",null,[363]);var da=a(82),fa=a(513),S=a(55);
class ka{get name(){return"Common.App.NewAndOpen.UX"}ai(tc){tc.register(X,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").uc().Gc(()=>new X(new e.a(()=>r.AFrameworkApplication.ta.Pa.ucd()),new e.a(()=>r.AFrameworkApplication.Lka),new e.a(()=>tc.uh("Common.INewAndOpenCommonHelpers")),new e.a(()=>tc.uh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.fa.hv(()=>{this.Zwb()})}Zwb(){const tc=
fa.a.Sq(da.a.instance.Vb("Common.INewAndOpenCommonHelpers")),$c=fa.a.Sq(da.a.instance.Vb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.Lka&&S.Task.WAA.call(null,tc,$c).continueWith(()=>{const Ed=new E(new e.a(()=>tc.result),new e.a(()=>r.AFrameworkApplication.ta.Pa.ucd()),new e.a(()=>$c.result),new e.a(()=>r.AFrameworkApplication.ta.Pa.vcd().QFa||"1959943459"),new e.a(()=>r.AFrameworkApplication.Lka),new e.a(()=>r.AFrameworkApplication.Xii));Ed.Fg();Ed.HGb()});if(r.AFrameworkApplication.$Kf){const Ed=
fa.a.Sq(da.a.instance.Vb("Common.IEventEmitter<Common.IMruResult>"));S.Task.WAA.call(null,tc,$c,Ed).continueWith(()=>{const Id=new R(new e.a(()=>tc.result),new e.a(()=>F.eUi),new e.a(()=>r.AFrameworkApplication.ta.Pa.vcd()),new e.a(()=>r.AFrameworkApplication.dUi),new e.a(()=>r.AFrameworkApplication.cUi),new e.a(()=>$c.result),new e.a(()=>Ed.result),r.AFrameworkApplication.fa);Id.f8i();Id.zMf()})}}dispose(){}}Object(b.a)(ka,"UXPackageManager",null,[4,5,3]);var V=a(1167),wa=a(1174),ma=a(1149),ab=a(1185),
ba=a(1175),Ca;(function(tc){tc[tc.myFiles=0]="myFiles";tc[tc.recent=1]="recent";tc[tc.currentFolder=2]="currentFolder";tc[tc.yourPhone=3]="yourPhone"})(Ca||(Ca={}));Object(b.b)("SharedFilePickerLandingLocation",Ca);class Na{constructor(tc){this.AKa=this.D$a=null;this._initialized=!1;this.hid=tc}n1a(tc){this._initialized||(tc.fo(K.a.FLf),tc.Vl(K.a.FLf,Object(l.a)(this,this.pPi,"onReceivedPickerResponse")),this._initialized=!0)}wcd(tc){return this.AKa=new Promise(($c,Ed)=>{const Id={};Id[A.a.ZWi]=tc;
this.D$a=(ae,ja)=>{""===ja?(k.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),$c(ae)):("Canceled"===ja?k.ULS.sendTraceTag(572548164,306,50,ja):k.ULS.sendTraceTag(556901065,306,10,ja),Ed(ja))};this.hid.execute(ae=>{this.n1a(ae);ae.Fj(K.a.iUi,Id)})})}pPi(tc){this.D$a(tc.Values[A.a.jlj],void 0===tc.Values[A.a.cCd]||null===tc.Values[A.a.cCd]?"":tc.Values[A.a.cCd])}Xod(){return r.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}oCe(tc,$c,Ed,Id,ae,ja,hb){const oa={};oa[A.a.Wkj]=
tc;oa[A.a.titleText]=$c;oa[A.a.nIg]=Ed;oa[A.a.oIg]=Id;oa[A.a.pIg]=!1;oa[A.a.lfh]=!0;oa[A.a.uyh]=ae;oa[A.a.cXi]=ja;oa[A.a.bXi]=Ca[hb];x.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(oa[A.a.dXi]="Dark");return oa}}Object(b.a)(Na,"SharedFilePickerManager",null,[333]);class za{constructor(){this.gb=null}get name(){return"Common.App.SharedFilePicker"}ai(tc){this.gb=tc;tc.register(Na,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").uc().Gc(()=>
new Na(tc.Vb("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.fa.hv(()=>{this.Zwb()})}Zwb(){this.gb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){d.a.instance.Ii(new za)}}Object(b.a)(za,"SharedFilePickerPackage",null,[4,5]);var la=a(1276),aa=a(832),sa=a(27);class ea{get name(){return"Common.App.WildFire"}Gje(tc){let $c=!1;tc&&(tc.H1c(),tc.yRg&&($c=!1));return $c}m4g(){var tc=r.AFrameworkApplication.ta.Pa;tc=new la.a(tc.xj,aa.a.Lac(),!1,1===tc.l5);
this.Gje(tc)&&k.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}h3b(tc,$c,Ed,Id,ae,ja){tc=new la.a(tc,Ed,Id,$c,ae,ja);this.Gje(tc)&&k.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}s$g(){const tc=r.AFrameworkApplication.ta.Pa;var $c=r.AFrameworkApplication.fa;const Ed=tc.xj,Id=1===tc.l5;if($c.qa(aa.a.UZh(Ed))){var ae=aa.a.Lac(),ja=8<sa.a.B4a;if(2!==Ed||2!==ae||!Id){$c=$c.qa(aa.a.VZh(Ed));var hb=tc.iUf(),oa=()=>tc.xx;$c&&!aa.a.ind(aa.a.lbd(Ed))&&this.h3b(Ed,Id,ae,ja,oa,hb)}}}init(){var tc=
r.AFrameworkApplication.fa;const $c=tc.qa("WildFireChromeExtensionEnabled");tc=tc.qa("WildFireChromeExtensionBar")&&$c;aa.a.Ovc&&tc&&!aa.a.ind(aa.a.Vwe)?this.m4g():(document.body&&aa.a.uxj&&this.s$g(),r.AFrameworkApplication.wb.Ob(P.a.vrd,W.a.frame,Object(l.a)(this,this.vrd,"launchWildFireBusinessBar")))}vrd(tc,$c,Ed,Id,ae){if(1===Ed)return 32;if(!ae)return 8;this.h3b(ae.app,ae.mode,ae.platform,ae.useTwoButton,null,null);return 32}dispose(){}ai(){}static main(){d.a.instance.Ii(new ea)}}Object(b.a)(ea,
"PackageManager",null,[4,5]);var Z=a(1265);a(1057);var ua=a(10),ya=a(690),ha=a(50),Da=a(37),nb=a(181);class qa{constructor(tc){this.$h=tc}Qc(){return!1}executeCommand(tc,$c,Ed){return 2!==this.$h.ae(P.a.newDocument,2,Ed)?S.Task.Ua(!0):nb.a($c.command)}Ec(tc,$c){return 1056925771===$c.command}Vc(tc,$c,Ed){tc=!0;switch($c){case "PopulateNewMenu":this.$h&&this.$h.ae(P.a.soc,2,Ed);break;default:tc=!1}return tc}}Object(b.a)(qa,"CreateNewCommandHandler",null,[188]);class pa extends ya.a{constructor(tc){super(tc)}Dd(){const tc=
ha.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),$c=ha.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ib);Da.TaskExtensions.Aa(Da.TaskExtensions.Xd([tc,$c],this.la),()=>{this.ld([new qa(r.AFrameworkApplication.wb)])},this.la,3)}static ka(tc){ya.a.Rd(87,new pa(tc))}}Object(b.a)(pa,"CreateNewCommandHandlerFactory",ya.a,[]);var Ja=a(1161),$a=a(1059),rb=a(1203),Pa=a(505),eb=a(102),Ob=a(170),tb=a(11),cc=a(22),Ib=a(280),Mb=a(987);class Oa{}Oa.create="Create";Oa.activate="Activate";
Oa.close="Close";Oa.remove="Delete";Oa.duplicate="Duplicate";Object(b.a)(Oa,"Actions",null,[]);var Aa=a(31),Ba=a(43);class ob extends S.Task{constructor(tc){super();this.WZd=null;this.YZd=0;this.iPb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.WVa=this.WVa()}catch($c){this.dispose(),this.Oza($c),this._state=3}};this.Dt=tc;this.WVa=this.YBc;this.moveNext()}YBc(){this.WZd=Aa.a.Yc(3,2,0,1664,0,-1244327602,"MsFormDeleteConfirmation");this.iPb=Ba.a(this.Dt.$).nj(this.WZd).G();
this.iPb.isCompleted||(this._state=2,this.iPb.P8a(this.moveNext));return this.vgg}vgg(){this.YZd=this.iPb.SY();0===this.YZd&&(this.Dt.$.workbookContext.Options=tb.HelperMethods.aO(!1,this.Dt.$.workbookContext.Options,2048),this.Dt.deleteMsFormMetaDataSheet());this._state=3;this.FJb(!0)}dispose(){}}Object(b.a)(ob,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",S.Task,[3]);class xb{}xb.action="Action";xb.GAh="FlexPane";xb.J8b="formId";xb.id="id";xb.title="Title";
xb.uOb="XlWorkbookId";xb.BCh="Fragment";xb.host="Host";xb.nKj="TopView";xb.t1="auth_pvr";Object(b.a)(xb,"Parameters",null,[]);var Va=a(62);const bb=(tc,$c,Ed,Id,ae,ja,hb=null)=>{hb=tc.Na(9,hb);hb.sheetName=$c;hb.confirmationChoice=!0;return Va.g(tc,"DeleteSheet",hb,Ed,Id,ae,ja,0)};class ra{constructor(tc){this.oo="Excel";this.$=tc;this.vU=Mb.a.current}get hasMsForm(){return eb.c(this.$.pg)}get Sjc(){return this.$.workbookContext.MsFormId}get rOb(){return this.$.workbookContext.MsFormDocUrl}get t1(){return cc.a.contains(this.$.Vv.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Qc(tc,$c){switch($c){case -105284469:return!eb.i(this.$.pg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(tc,$c){tc=Da.TaskExtensions.vk();$c=$c.command;switch($c){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:tc=this.deleteMsForm();break;default:tc=nb.a($c)}return tc}Ec(tc,
$c){if(!this.$.ea.Sg.get(61))return!1;tc=!1;switch($c.command){case -105284469:tc=eb.i(this.$.pg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:tc=this.hasMsForm}return tc}Vc(){return!1}insertMsForm(){const tc=v.a.rq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),$c={},Ed={};$c[xb.action]=Oa.create;$c[xb.t1]=this.t1;Ed[xb.action]=Oa.create;Ed[xb.uOb]=encodeURIComponent(this.rOb);Ed[xb.host]=this.oo;Ed[xb.title]=encodeURIComponent(tc);this.GBb($c,
Ed);this.$.workbookContext.Options=tb.HelperMethods.aO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const tc={},$c={};tc[xb.t1]=this.t1;$c[xb.J8b]=this.Sjc;$c[xb.uOb]=encodeURIComponent(this.rOb);$c[xb.host]=this.oo;this.GBb(tc,$c)}previewMsForm(){const tc={},$c={};tc[xb.t1]=this.t1;$c[xb.J8b]=this.Sjc;$c[xb.uOb]=encodeURIComponent(this.rOb);$c[xb.host]=this.oo;$c[xb.nKj]="Preview";this.GBb(tc,$c)}sendMsForm(){const tc={},$c={};tc[xb.t1]=this.t1;$c[xb.J8b]=this.Sjc;$c[xb.GAh]="SendForm";$c[xb.uOb]=
encodeURIComponent(this.rOb);$c[xb.host]=this.oo;this.GBb(tc,$c)}deleteMsForm(){return new ob(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.$t(new Ob.a(158,0,(tc,$c,Ed)=>bb(this.$.pa.zw,this.vU.ntb,Ib.b(tc,()=>{this.Cch()}),$c,Ed,null)))}Cch(){const tc={},$c={};tc[xb.action]=Oa.remove;tc[xb.t1]=this.t1;$c[xb.action]=Oa.remove;$c[xb.host]=this.oo;$c[xb.J8b]=encodeURIComponent(this.Sjc);$c[xb.uOb]=encodeURIComponent(this.rOb);this.GBb(tc,$c)}GBb(tc,$c){const Ed=this.$.ya.MsFormBaseUrl+
"/Pages/DesignPage.aspx";let Id="";var ae="";if($c){for(let oa in $c){var ja=oa,hb=$c[oa];ae+=ae.length?"&":"";ae+=ja+"="+hb}tc||(tc={});tc[xb.BCh]=encodeURIComponent(ae)}if(tc)for(let oa in tc)$c=oa,ae=tc[oa],Id+=Id.length?"&":"?",Id+=$c+"="+ae;window.open(Ed+Id,"_blank")}}Object(b.a)(ra,"MsFormCommandHandler",null,[188]);class Qa extends ya.a{constructor(tc){super(tc)}Dd(){const tc=ha.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ib);Da.TaskExtensions.Aa(Da.TaskExtensions.Xd([tc],this.la),
()=>{this.ld([new ra(this.$)])},this.la,3)}static ka(tc){tc.ea.Sg.get(61)&&ya.a.Rd(215,new Qa(tc))}}Object(b.a)(Qa,"MsFormCommandHandlerFactory",ya.a,[]);var qb=a(220);class Wa extends qb.a{constructor(tc){super();this.$=tc;this.Fb()}create(){Da.TaskExtensions.Aa(ha.GetServiceTaskFactory.create(this.$.da,164,this.la,this.ib),()=>{this.qb(new ka)},this.la,3)}}Object(b.a)(Wa,"NewAndOpenUXFactory",qb.a,[]);class ta{constructor(tc,$c){this.$h=$c;this.$=tc}executeCommand(tc,$c,Ed){tc=2;switch($c.command){case P.a.openUrlInNewTab:tc=
this.$h.ae(P.a.openUrlInNewTab,2,Ed);break;case P.a.iOa:tc=this.$h.ae(P.a.iOa,2,Ed)}return 2!==tc?S.Task.Ua(!0):nb.a($c.command)}Ec(tc,$c){return $c.command===P.a.openUrlInNewTab||$c.command===P.a.iOa}Vc(tc,$c,Ed){return"PopulateMruMenu"===$c?(this.$h.ae(P.a.roc,2,Ed),!0):!1}Qc(){return!1}}Object(b.a)(ta,"OpenFromMruCommandHandler",null,[188]);class ib extends ya.a{constructor(tc){super(tc)}Dd(){const tc=ha.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),$c=ha.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.ib);Da.TaskExtensions.Aa(Da.TaskExtensions.Xd([tc,$c],this.la),()=>{this.ld([new ta(this.$,r.AFrameworkApplication.wb)])},this.la,3)}static ka(tc){ya.a.Rd(88,new ib(tc))}}Object(b.a)(ib,"OpenFromMruCommandHandlerFactory",ya.a,[]);var Bb=a(1139),Ub=a(1176),Ta=a(1215),mb=a(1062),Qb=a(1157),Lb=a(1063),Jb=a(1064),Ab=a(1162),pb=a(1204),va=a(1205),db=a(84),Ya=a(368),gb=a(100),Ka=a(21),ub=a(369);class ac{constructor(tc,$c){this.sheetName=null;this.value=!1;this.sheetName=tc;this.value=$c}getSheetName(){return this.sheetName}Xua(){return this.value}}
Object(b.a)(ac,"MacroRecorderSheetOptionToggledPayload",null,[116]);const Ra=(tc,$c,Ed,Id,ae,ja,hb,oa=null)=>{oa=tc.Na(9,oa);oa.sheetName=$c;oa.show=Ed;return Va.g(tc,"ShowGridlines",oa,Id,ae,ja,hb,0)},na=(tc,$c,Ed,Id,ae,ja,hb,oa=null)=>{oa=tc.Na(9,oa);oa.sheetName=$c;oa.show=Ed;return Va.g(tc,"ShowHeadings",oa,Id,ae,ja,hb,0)},lb=(tc,$c,Ed,Id,ae,ja,hb,oa=null)=>{oa=tc.Na(9,oa);oa.sheetName=$c;oa.directionRtl=Ed;return Va.g(tc,"ChangeSheetDirection",oa,Id,ae,ja,hb,0)};class jb{constructor(tc){this.$=
tc}Qc(){return!1}executeCommand(tc,$c){const Ed={};this.$.Wj(Ed);tc=$c.command;const Id=Object(db.a)(gb.a,this.$.xa.getItemByName(Ed.SheetName));if(!Id)return nb.a(tc);let ae,ja,hb,oa,fb;switch(tc){case 705559150:case -1411193626:ae=16;ja=!Id.hideGridLines;hb=Ra;fb=183;oa=Id.hideGridLines;break;case -2052321504:case 515737500:ae=4;ja=!Id.headersVisible;hb=na;fb=184;oa=!Id.headersVisible;break;case -1478455630:ae=2;ja=!Id.displayRtl;hb=lb;fb=185;oa=!Id.displayRtl;Ka.g(this.$).Ea.IPj(ja);break;default:return nb.a(tc)}Id.Rob(ae,
ja);const Eb=()=>new ac(Ed.SheetName,oa),jc=this.$.pa.va;return Ya.a(this.$.userOperationManager,(Hc,qd,zd)=>hb(jc,Ed.SheetName,oa,Ib.b(Hc,Hd=>{jb.oEb(Hd,Id,ae,ja)}),Ib.a(qd,()=>{jb.yDb(Id,ae,ja)}),zd,null),Hc=>new Ob.a(fb,0,Hc,void 0,Eb),$c)}Ec(tc,$c){tc=!1;switch($c.command){case -1411193626:case 515737500:case -1478455630:tc=!0;break;case 705559150:case -2052321504:tc=ub.a(this.$)}return tc}Vc(){return!1}static oEb(tc,$c,Ed,Id){Aa.a.ar(tc.Errors)&&$c.Rob(Ed,!Id)}static yDb(tc,$c,Ed){tc.Rob($c,
!Ed)}}Object(b.a)(jb,"SheetOptionsToggleCommandHandler",null,[188]);class Yb extends ya.a{constructor(tc){super(tc)}Dd(){this.ld([new jb(this.$)])}static ka(tc){ya.a.Rd(100,new Yb(tc))}}Object(b.a)(Yb,"SheetOptionsToggleCommandHandlerFactory",ya.a,[]);var Gb=a(171),wb=a(176),dc=a(147),Jc=a(64),Qc=a(59),fd=a(208),Wc=a(582),Rb=a(90),Sb=a(1),mc=a(249),ec=a(210),Rc=a(12);class Mc extends ec.a{constructor(tc,$c,Ed,Id=null){super(tc,Ed,2,Id);this.eIc=null;this.onResize=()=>{const ae=this.YOh();this.CKa.setAttribute("width",
ae.x.toString());this.CKa.setAttribute("height",ae.y.toString());this.uQj(ae);this.czd()};this.pFe=$c;this.$.GA(this.onResize);this.Ybc()}get CKa(){return this.eIc}initialize(){let tc;const $c=this.$.Bb+"iframeDialog_frame",Ed=this.$.Bb+"iframeDialog";tc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',$c,this.XXe(Ed));this.Jb.style.margin=tb.HelperMethods.qc(0);this.Jb.style.marginBottom=tb.HelperMethods.qc(-2);this.Jb.innerHTML=tc;this.eIc=document.getElementById($c);
this.domElement.id=Ed;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.AD(this.onResize);super.dispose()}setFocus(){Rc.DOMElementExtensions.setFocus(this.CKa)}onHide(){this.CKa.contentWindow.close();Rc.DOMElementExtensions.nf(this.CKa);this.eIc=null;super.onHide()}uQj(tc){const $c=this.domElement.style;$c.width=tb.HelperMethods.qc(tc.x);$c.marginLeft=tb.HelperMethods.qc(-tc.x/2)}YOh(){const tc=Rc.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
tc.width),this.pFe.x),Math.min(Math.floor(.9*tc.height),this.pFe.y))}}Object(b.a)(Mc,"IFrameDialog",ec.a,[]);var bc=a(5),ic=a(75),Yc=a(14);class md extends Mc{constructor(tc){super(tc,new Sys.UI.Point(960,680),Yc.a.instance.ga(1262));this.name=bc.a.kJe}get oc(){return"EmbeddingDialog"}XXe(tc){const $c=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);fd.a.Yg($c,bc.a.vmh,tc);ic.a(this.$.ya,34)&&fd.a.Yg($c,bc.a.nLe,"1");ic.a(this.$.ya,35)&&fd.a.Yg($c,bc.a.oLe,"1");return $c.toString()}onShow(){k.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)(md,"EmbeddingDialog",Mc,[]);var id=a(1230),xd=a(86),Lc=a(80),Pb=a(815);class Gc{}Gc.U_f="FrameDialog_ShareFromEdit";Gc.view="FrameDialog_View";Gc.aye="FrameDialog_CloseAndRefresh";Gc.nuj="FrameDialog_ShareFromView";Gc.edit="FrameDialog_Edit";Gc.q6i="FrameDialog_RefreshGrid";Gc.vYg="FrameDialog_CloseMe";Gc.kye="FrameDialog_CloseMeError";Gc.ready="FrameDialog_Ready";Gc.FXi="FrameDialog_PleaseClose";Gc.$J="GotoRange";
Object(b.a)(Gc,"PostMessageConstants",null,[]);var Nb=a(510),yc=a(247),Tc=a(121),gd=a(281),Ad=a(97);class Od{constructor(){this.$J=null;this.GCd=1461300262}}Object(b.a)(Od,"SessionUpdateContext",null,[]);class Pd extends Mc{constructor(tc,$c,Ed){super(tc,new Sys.UI.Point(Pd.bch,Pd.Ebh),Yc.a.instance.ga($c?1267:1266));this.c0a=null;this.uJc=!1;this.Zmc=Id=>{const ae=this.$,ja=new Od;ja.$J=Id.Values[Gc.$J];let hb=!1;switch(Id.MessageId){case Gc.U_f:this.Rt();hb=!0;ja.GCd=1334518759;break;case Gc.view:this.Bna=
Yc.a.instance.ga(1267);this.adg(!0);break;case Gc.aye:this.Rt(),hb=!0}Id=(oa,fb,Eb)=>yc.m(ae.pa.va,Ib.b(oa,this.EQi),fb,Eb,ja);Sb.EwaSettings.fc()?(Id=new Ob.a(140,0,Id),Id.flags=hb?16:80):(Id=hb?new Ob.a(140,0,Id):new Nb.a(140,0,Id),Id.flags=16);ae.userOperationManager.Ub(Id,this.Jd)};this.AIi=()=>{const Id=this.$;Id.ya.SurveyRedirectUrl?(this.Rt(),Id.xd(1305810481,0,8,null)):(this.Bna=Yc.a.instance.ga(1266),this.adg(!1))};this.SQi=()=>{const Id=this.$;this.Rt();Id.xd(1334518759,0,8,null)};this.glc=
Id=>{const ae=this.$;this.Rt();Id.MessageId===Gc.kye&&ae.ea.S$c()};this.lPi=()=>{this.uJc=!0;this.raiseEvent(Pd.Erd)};this.EQi=(Id,ae)=>{if(!gd.a(Id)){Id=this.$;if(ae.$J){const ja=Id.ea.xa;if(ja.contains(ae.$J.SheetName))this.Rlc(ae);else{let hb=null;hb=()=>{ja.gma(hb);this.Rlc(ae)};ja.dga(hb)}}1461300262!==ae.GCd&&Id.xd(ae.GCd,0,8,null)}};this.p8d=$c;this.Jd=Ed}SEg(tc){this.addHandler(Pd.Erd,tc)}Vaj(tc){this.removeHandler(Pd.Erd,tc)}get oc(){return"FormDialog"}get vdf(){return this.uJc}get e6a(){return this.p8d}dispose(){xd.a.Ia(this.c0a);
this.c0a=null;super.dispose()}initialize(){super.initialize();const tc=Lc.a.gaa(this.$.ya.FormLightBoxUrl),$c=this.c0a=new id.a(this.CKa.contentWindow,tc);$c.isEnabled()&&$c.QEa(tc)&&(this.Zla(Gc.U_f,this.Zmc),this.Zla(Gc.view,this.Zmc),this.Zla(Gc.aye,this.Zmc),this.Zla(Gc.nuj,this.SQi),this.Zla(Gc.edit,this.AIi),this.Zla(Gc.q6i,this.Zmc),this.Zla(Gc.ready,this.lPi),this.Zla(Gc.vYg,this.glc),this.Zla(Gc.kye,this.glc))}close(tc){tc===this.mM&&this.vdf&&this.c0a.send(new Pb.a(Gc.FXi))||super.close(tc)}XXe(){return this.mCe(this.e6a)}mCe(tc){const $c=
this.$.ya,Ed=new Sys.StringBuilder($c.FormLightBoxUrl);fd.a.Yg(Ed,bc.a.kCh,this.$.ea.sessionId);fd.a.Yg(Ed,bc.a.iCh,tc?bc.a.jCh:bc.a.hCh);Tc.a.vYa(Ed,$c);return Ed.toString()}adg(tc){this.uJc=!1;this.CKa.src=this.mCe(tc);this.p8d=tc}Zla(tc,$c){this.c0a.fo(tc);this.c0a.Vl(tc,$c)}Rlc(tc){const $c=this.$.ea.xa.getItemByName(tc.$J.SheetName);$c&&0===$c.xy&&Ka.g(this.$).vg(tc.$J,null,null,null,20,Ad.a.UBh)}}Pd.bch=900;Pd.Ebh=1200;Pd.Erd="lightBoxReady";Object(b.a)(Pd,"FormDialog",Mc,[202]);var Md;(function(tc){tc[tc.comment=
10]="comment";tc[tc.range=12]="range";tc[tc.table=13]="table";tc[tc.chart=14]="chart";tc[tc.sheet=15]="sheet"})(Md||(Md={}));Object(b.b)("NavigationType",Md);var ge=a(865),pe=a(117),Qd=a(19),he=a(553),ue=a(939),je=a(283),Ge=a(724),Ce=a(54);class pc extends Ge.a{constructor(tc,$c,Ed,Id,ae,ja=0){super(tc,Yc.a.instance.ga($c),!1);this.message=Ed;this.CEi=Id;this.lZd=ae;this.operationFlags=ja}get oc(){return"WebMethodConfirmationDialog"}get Hv(){return 1005}get gsa(){return this.operationFlags}initialize(){let tc=
"<div class='"+pe.a.Nn+"'>\r\n\t<div class='"+pe.a.DLe+"'>\r\n\t\t<div class='"+Qd.a.Sxe+"'>\r\n\t\t\t<img src='{0}' class='"+Qd.a.wOe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+pe.a.HLe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";tc=String.format(tc,Ce.a.gf(13),Yc.a.instance.ga(25),Yc.a.instance.ga(this.message));this.Jb.innerHTML=tc;this.addButton(0,this.CEi);this.addButton(1);super.initialize()}Ry(){return this.lZd}}Object(b.a)(pc,"WebMethodConfirmationDialog",Ge.a,[]);class Uc extends ge.a{constructor(tc){super(tc,
Yc.a.instance.ga(1269));this.TSa=this.pQa=this.textBox=null;this.XCf=()=>{const $c=this.$;this.Rt();const Ed=new pc($c,1272,1273,1274,(Id,ae,ja)=>{var hb=$c.pa.va.Qb(),oa=$c.pa.va;hb=oa.Na(1,hb);return Va.g(oa,"UnshareForm",hb,Id,ae,ja,null,0)},16);Ed.initialize();Ed.xf()}}get oc(){return"ShareFormDialog"}dispose(){this.TSa&&this.TSa.Eca(this.XCf);xd.a.rc([this.textBox,this.pQa,this.TSa]);this.TSa=this.pQa=this.textBox=null;super.dispose()}initialize(){let tc="<div class='"+pe.a.Nn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+
pe.a.A1a+"'>\r\n\t<input type='text' id='{1}' class='"+pe.a.RC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";tc=String.format(tc,Yc.a.instance.ga(1270),"sfd_input","sfd_unshare",Qd.a.Lp,Yc.a.instance.ga(1271));this.Jb.innerHTML=tc;this.textBox=new je.a(this.getElementById("sfd_input"));this.pQa=new ue.a(this.textBox.domElement);this.TSa=he.a.create(this.getElementById("sfd_unshare"));this.TSa.G1(this.XCf);this.textBox.text=Yc.a.instance.ga(741);
this.textBox.enabled=!1;this.textBox.readOnly=!sa.a.Zg;this.addButton(1,10);super.initialize()}Cga(){return(tc,$c,Ed)=>{var Id=this.$.pa.va.Qb(),ae=this.$.pa.va;tc=this.Cia(tc);$c=this.U$($c);Id=ae.Na(1,Id);return Va.g(ae,"ShareForm",Id,tc,$c,Ed,null,0)}}fy(tc,$c,Ed){this.textBox.text=tc.Result;this.textBox.enabled=!0;Rc.DOMElementExtensions.setVisible(this.TSa.domElement,!0);super.fy(tc,$c,Ed)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(tc){}super.setFocus()}}
Object(b.a)(Uc,"ShareFormDialog",ge.a,[]);var hd=a(244),yd=a(6),wd=a(81),I=a(252),xa=a(68),Ua=a(618),vb=a(139),cb=a(419),Xb=a(182),rc=a(254),Ec=a(16),ed=a(251);class ud extends wb.a{constructor(tc,$c,Ed){super();this.Kue=this.Lue=!1;this.VFi=()=>{this.Lue=!0;this.W1f()};this.$=tc;this.Sa=$c;this.VJ=Ed;xa.a(this.$).oGd(new vb.a(yd.a.dbg,yd.a.idle,ud.lVg),new hd.a(yd.a.iye,yd.a.UZ,null,yd.a.xO,yd.a.idle))}get KBc(){return eb.b(this.$.pg)}get eLd(){return this.$.isEditMode&&(this.$.ea.Whh||this.$.SM)}Qc(tc,
$c){tc=this.$.workbookContext.FullDocumentInfo;switch($c){case 353606613:case -1099009678:case 192430811:return!Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 783415632:return!Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return $c=rc.a()&&this.$.ea.Sg.get(5),!tc.FileSharingUrl&&!$c;case -1570751769:case 1986648902:return 131072!==
(this.$.ZP&131072);case 330035228:return!(this.n2a(!0)&&this.KBc);case -509039657:return!(this.n2a()&&this.KBc);case 1334518759:return!(this.n2a()&&this.KBc&&this.Vue())}return!1}executeCommand(tc,$c,Ed){tc=this.$.workbookContext.FullDocumentInfo;var Id=P.a.workflow,ae=Da.TaskExtensions.vk();const ja=$c.command;if(ja===Id||-266099===ja)return this.C3h($c,Id,tc);switch(ja){case 1986648902:this.i_f();break;case -1570751769:this.j1h($c);break;case 869186573:$c=P.a.muj;ae=r.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");
Id=null;(Sb.EwaSettings.ma(550)||ae)&&Ed&&"CopyLink"===Ed.SourceControlId?(Id={},Id[A.a.oKb]="copy",$c=P.a.T_f):ae&&Ed&&"ManageAccess"===Ed.SourceControlId?(Id={},Id[A.a.oKb]="manageAccess",$c=P.a.ouj):Ed&&"LinkToComment"===Ed.SourceControlId&&(Id={},Id[A.a.oKb]="copy",Id[A.a.COd]=Ed.navId,$c=P.a.T_f);ae=this.c3f(tc,Id);Xb.c($c);break;case -1099009678:ae=this.$uc(12,tc);break;case 192430811:ae=this.$uc(13,tc);break;case 353606613:ae=this.$uc(14,tc);break;case 783415632:ae=this.$uc(15,tc);break;case -59906385:case 1197060601:this.Q2h($c,
tc);break;case 1305810481:this.g4e(!1,$c);break;case 330035228:this.g4e(!0,$c);break;case -509039657:this.deleteForm();break;case 1334518759:$c.Yxb=!0;this.shareForm();break;case 710925581:Qc.a.tg.pvc("710925581")&&(ae=Da.TaskExtensions.Aa(this.VJ.value,hb=>{hb.result.Fj(K.a.conversation,{})},this.la,3));break;case 327119921:this.Y0h();break;default:ae=nb.a(ja)}return ae}Ec(tc,$c){tc=!1;$c=$c.command;if($c===P.a.workflow)return!0;switch($c){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:tc=
!0;break;case 353606613:case -1099009678:case 192430811:tc=Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:tc=Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return tc}Vc(tc,$c,Ed){if("PopulateFormMenu"===$c){$c=this.KBc?this.Vue()?ud.rwh:ud.swh:ud.gCi;tc=this.Sa.Bc();for(let Id=0;Id<$c.length;Id++)tc.buttons.push(this.Sa.pb($c[Id]));$c=this.Sa.pq("Forms.Flyout");
$c.pc.push(tc);Ed.MenuItems=$c.rE();return!0}return!1}C3h(tc,$c,Ed){return this.eLd&&tc.command===$c?(this.cLd(tc,-266099),Da.TaskExtensions.kaa()):Da.TaskExtensions.Aa(this.VJ.value,Id=>{Wc.a(Id.result,K.a.workflow,null,Ed.WorkflowPostMessage)||tb.HelperMethods.Ve(Ed.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}Vue(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Sg.get(26)}Y0h(){var tc=Gb.a.create().toString();k.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${tc}`);var $c=this.$.frame,Ed=$c.p8a,Id=this.$;const ae=new ed.QueryStringBuilder(r.AFrameworkApplication.fa.Va("TeamsMeetingShareEndpoint"));ae.Oi("deeplinkId",tc);ae.Oi("lm","deeplink");tc=ae.Oi;var ja={};const hb=new ed.QueryStringBuilder(r.AFrameworkApplication.fa.Va("TeamsAppSharingUrl"));hb.Oi("auth","2");hb.Oi("flight","officeunihost");hb.Oi("source","TEAMS-ELECTRON.meetingStage.deeplink");var oa={};oa.fileType=v.a.o3(Id.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
oa.objectUrl=Id.workbookContext.FullDocumentInfo.WorkbookPath;oa.baseUrl=Id.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Id=Id.workbookContext.WorkbookFileVersionId;let fb=decodeURIComponent(Id);for(;Id!=fb;)Id=fb,fb=decodeURIComponent(Id);0>Id.indexOf("{")||0>Id.indexOf("}")?(k.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Id}`),Id=""):Id=Id.substring(Id.indexOf("{")+1,Id.indexOf("}")).toLowerCase()}oa.fileId=Id;oa=J.c(J.c(oa));hb.Oi("subEntityId",
oa.substring(1,oa.length-1));ja.appSharingUrl=hb.toString();ja.appId=r.AFrameworkApplication.fa.Va("TeamsAppId");ja=JSON.stringify(ja);tc.call(ae,"appContext",ja);Ed.call($c,ae.toString(),!0)}j1h(tc){this.eLd?this.cLd(tc,1986648902):this.i_f()}g4e(tc,$c){!tc&&this.$.ya.SurveyRedirectUrl?this.Q0i():(tc=new Pd(this.$,tc,$c),tc.initialize(),tc.xf())}Q2h(tc,$c){this.eLd&&1197060601===tc.command?this.cLd(tc,-59906385):Da.TaskExtensions.Aa(this.VJ.value,Ed=>{Ed=Ed.result;Ed&&Wc.a(Ed,K.a.replyWithChanges,
null,this.$.ea.Sg.get(8))||(Ed=new Sys.StringBuilder($c.ReplyWithChangesUrl),fd.a.Yg(Ed,cb.e,cb.d),dc.a.ntw(Ed.toString(),this.$))},this.la,3)}cLd(tc,$c){const Ed=xa.a(this.$).fd.activityState,Id=new Rb.a($c,tc.method,tc.mode,tc.Re,tc.tabName);Ba.a(this.$).ks(new mc.a(yd.a.Ox,5,()=>{Ed[I.a.lq]=yd.a.jUf;Ed[Ua.a.dSc]=Id;this.$.Xk.Ly("SocialSharingSaveBeforeCommand");this.$.Xk.Jke(Id.command)}))}i_f(){const tc=this.$.ya.DocumentHostInfo;tc.HostEmbeddedViewUrl||this.Lue?this.W1f():this.$.me.get(53)&&
Da.TaskExtensions.Aa(this.VJ.value,$c=>{this.kNj($c.result)||dc.a.ntw(tc.FileEmbedCommandUrl,this.$)},this.la,3)}kNj(tc){return tc.isEnabled()&&(this.Kue||(this.Kue=tc.Vl(K.a.Jue,this.VFi)))?tc.Fj(K.a.Yxh,null):!1}W1f(){if(sa.a.jp)dc.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const tc=new md(this.$);tc.initialize();tc.xf()}}deleteForm(){const tc=this.$,$c=new pc(tc,1275,1276,1268,(Ed,Id,ae)=>{var ja=tc.pa.va.Qb(),hb=tc.pa.va;ja=hb.Na(9,ja);ja.surveyId=null;return Va.g(hb,"DeleteSurvey",ja,
Ed,Id,ae,null,0)});$c.initialize();$c.xf()}shareForm(){const tc=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Sg.get(26)){const $c=new Uc(this.$);$c.initialize();$c.xf()}else Da.TaskExtensions.Aa(this.VJ.value,$c=>{Wc.a($c.result,K.a.shareForm,{[A.a.lGj]:this.$.workbookContext.SurveyTitle},this.$.ea.Sg.get(10))||dc.a.ntw(tc.ShareFormCommandUrl,this.$)},this.la,3)}Q0i(){const tc=this.$;tc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const $c=new Sys.StringBuilder(tc.ya.SurveyRedirectUrl);
fd.a.Yg($c,"startupDialog","FormEdit");const Ed=xa.a(this.$),Id=Ed.fd.activityState;Id[wd.a.w1]=$c.toString();Id[wd.a.WL]=wd.a.Qvd;this.$.Xk.Ly("SocialSharingEnvironmentChange");Ba.a(tc).ks(new mc.a(yd.a.Ox,5,()=>{const ae=Aa.a.Yc(3,2,1320,1321,1322,554412057,"FossEnvironmentUnsupported");Ed.fd.Kt([ae]);Id[I.a.lq]=yd.a.dbg}))}n2a(tc=!1){return(this.$.ea.isEditMode||tc)&&this.$.ea.Sg.get(25)&&rc.a()}oWh(tc){var $c=Ka.g(this.$).ha;const Ed=this.$.xa.oa?Jc.d(this.$.xa.oa):null;if(!Ed)return k.ULS.sendTraceTag(537151649,
0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Md[tc]}.`),null;var Id=null;14===tc?Id=this.NVh($c):12===tc?(Id=$c.sha,Id=cc.a.contains(Id,"!",!0)?Id.split("!")[1]:Id):13===tc&&($c=$c.sa.selectedRanges,$c[0]&&($c=Ka.g(this.$).Db.Xj($c[0])))&&(Id=$c.aj);if(!Id&&15!==tc)return k.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Md[tc]}`),null;$c={};
$c[A.a.oKb]="copy";$c[A.a.COd]=this.xMh(tc,Id,Ed);k.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Md[tc]} and sectionNameOrId: ${Id} and SheetId: ${Ed}`);return $c}NVh(tc){if(tc.Oa.nZ&&(tc=tc.Oa.$b.floatingObject)&&0===tc.type){const $c=tc.id.split(".");if(1<$c.length)return $c[1];k.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${tc.id}`)}return null}xMh(tc,
$c,Ed){let Id=tc+"_";Id=btoa(15===tc?Id+Ed:Id+($c+"_"+Ed));Id=Id.replace(RegExp("\\+","g"),"-");Id=Id.replace(RegExp("\\/","g"),"_");return Id=Id.replace(RegExp("\\=+$","g"),"")}c3f(tc,$c){return Da.TaskExtensions.Aa(this.VJ.value,Ed=>{Wc.a(Ed.result,K.a.sharing,$c,this.$.ea.Sg.get(5))?k.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${$c?$c[A.a.oKb]:""}`):tb.HelperMethods.Ve(tc.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},
this.la,3)}$uc(tc,$c){if(15===tc&&!Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==tc&&!Sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const Ed=this.oWh(tc);if(Ed)return k.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Ed[A.a.COd]}`),this.c3f($c,Ed);k.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Md[tc]}`);
return null}}ud.gCi=[103];ud.rwh=[107,104,105,106];ud.swh=[104,105];ud.lVg=[new Ec.a(yd.a.iye,554412057,0,0,1323),new Ec.a(yd.a.idle,554412057,0,1)];Object(b.a)(ud,"SocialSharingCommandHandler",wb.a,[188]);class Kd extends ya.a{constructor(tc){super(tc)}Dd(){const tc=new e.a(()=>ha.GetServiceTaskFactory.create(this.$.da,137,this.la,this.ib));Da.TaskExtensions.Aa(ha.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib),$c=>{this.ld([new ud(this.$,$c.result,tc)])},this.la,3)}static ka(tc){ya.a.Rd(114,
new Kd(tc))}}Object(b.a)(Kd,"SocialSharingCommandHandlerFactory",ya.a,[]);var Zd=a(1145);class Xd{constructor(tc){this.$h=tc}executeCommand(tc,$c,Ed){return 2!==this.$h.ae(P.a.tryOfficeThroughTellMe,2,Ed)?S.Task.Ua(!0):nb.a($c.command)}Ec(tc,$c){return 215809929===$c.command}Vc(){return!1}Qc(){return!1}}Object(b.a)(Xd,"TryOfficeThroughTellMeCommandHandler",null,[188]);class Je extends ya.a{constructor(tc){super(tc)}Dd(){this.ld([new Xd(r.AFrameworkApplication.wb)])}static ka(tc){ya.a.Rd(207,new Je(tc))}}
Object(b.a)(Je,"TryOfficeThroughTellMeCommandHandlerFactory",ya.a,[]);var Xe=a(156),Ke=a(77),Qe=a(152),df=a(260),Ne=a(144),jf=a(173);class Le{static EM(){return Ne.a.Yo(Le.Ak,jf.a.Xa(435))}}Le.Ak="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(b.a)(Le,"NamedSheetViewTeachingDialogHtml",null,[]);var me=a(51);class Za extends df.a{constructor(tc){super(tc);this.stopwatch=this.Vo=null;this.oBi=$c=>{if(1===$c)this.$.Ka.Lb(new Rb.a(-2050946363,Ke.a.Eb,2,8,null)).continueWith(Ed=>{this.Vo.setResult(!Qe.a(Ed)&&Ed.result)}),$c="Yes";else{const Ed=2===$c;this.Vo.setResult(Ed);$c=2===$c?"No":"Close";Ed&&this.m_i()}this.vui($c);this.hide()}}get oc(){return"ShowNamedSheetViewTeachingDialog"}wg(){this.Sb=4;this.stopwatch=this.$.Hb.xc("UserAction",
this.oc);const tc=Yc.a.instance.ga(1905);this.ag=Le.EM();this.Vo=new Xe.a;this.initializeAndShow(tc,this.oBi,{});return this.Vo.task}xv(tc){super.xv(tc);this.sc(1,Yc.a.instance.ga(1907));this.sc(2,Yc.a.instance.Xa(448))}m_i(){this.$.ea.$jc=!1}vui(tc){const $c={};$c.a=this.$.ya.UserSessionId;$c.b="NamedSheetViewTeachingDialogClose";$c.c=tc;$c.e=!0;this.stopwatch&&(this.stopwatch.stop(),$c.d=this.stopwatch.tc);me.b().Ie(53,$c,!0)}}Object(b.a)(Za,"NamedSheetViewTeachingDialog",df.a,[]);var Tb=a(154);
class uc{constructor(tc){this.$=tc;tc.da.Ga(309,this)}aAa(){if(this.exj()){if(Sb.EwaSettings.ma(574)){this.$.xa.oa.Fd.WPd=!0;const tc=new Xe.a;this.$.Ka.Lb(new Rb.a(-2050946363,Ke.a.Eb,2,0,null)).continueWith($c=>{tc.setResult(!Qe.a($c)&&$c.result)});return tc.task}return(new Za(this.$)).wg()}return S.Task.Ua(!0)}exj(){const tc=this.$.xa.oa;return this.$.ea.A8a&&this.$.ea.$jc&&!tc.Fd.mv&&this.$.ea.uM&&!Tb.f(this.$)}}Object(b.a)(uc,"NamedSheetViewPublic",null,[330]);class Oc extends qb.a{constructor(tc){super();
this.$=tc;this.Fb()}create(){this.qb(this.$.da.za(309)||new uc(this.$))}static ka(tc){tc.da.Ga(310,new Oc(tc))}}Object(b.a)(Oc,"NamedSheetViewPublicFactory",qb.a,[]);var sb=a(7),$b=a(184),xc=a(1323),ad=a(856),Dd=a(560);class ie{constructor(tc,$c,Ed,Id,ae,ja,hb){this.title=tc;this.body=$c;this.x_i=Ed;this.primaryButtonAction=Id;this.secondaryButtonAction=ja;this.LVf=ae;this.targetObject=hb}}Object(b.a)(ie,"NamedSheetViewTeachingCalloutContent",null,[]);class $d{constructor(tc){this.Jge=0;this.C7f=
tc}get A7f(){return this.Jge}get Z0i(){return this.A7f<this.C7f.count?this.C7f.na(this.Jge++):null}}Object(b.a)($d,"NamedSheetViewTeachingCalloutList",null,[]);var ne=a(1068);class ye{constructor(tc){this.stopwatch=this.OYb=this.dyc=this.VTd=null;this.B7f=0;this.$=tc}Z8h(tc){this.B7f=tc;const $c=Object(sb.a)(new $b.a,{});ye.Ggi(tc)?($c.add(new ie(Yc.a.instance.Xa(437),Yc.a.instance.Xa(438),Yc.a.instance.ga(1935),()=>{this.SH(2,"Continue");this.FJ(!0)},Yc.a.instance.ga(1936),()=>{this.FJ();this.SH(1,
"ExitGuide")},ne.a())),1===tc&&$c.add(new ie(Yc.a.instance.ga(1937),Yc.a.instance.Xa(440),Yc.a.instance.ga(1935),()=>{this.SH(2,"FirstEnterTempViewContinueSecond");this.FJ(!0)},Yc.a.instance.ga(1936),()=>{this.FJ();this.SH(1,"FirstEnterTempViewExitGuideSecond")},ne.a())),$c.add(new ie(Yc.a.instance.Xa(441),Yc.a.instance.Xa(442),Yc.a.instance.ga(1935),()=>{this.SH(2,"FirstEnterExitCalloutContinue");this.FJ(!0)},Yc.a.instance.ga(1936),()=>{this.FJ();this.SH(1,"FirstEnterExitCalloutGuide")},ye.FZe())),
$c.add(new ie(Yc.a.instance.ga(1938),Yc.a.instance.Xa(439),Yc.a.instance.ga(1939),()=>{this.D2f();this.FJ();this.SH(1,"LearnMore")},Yc.a.instance.ga(1940),()=>{this.FJ();this.SH(1,"Done")},ye.EZe()))):2===tc?$c.add(new ie(Yc.a.instance.ga(1937),Yc.a.instance.Xa(440),Yc.a.instance.ga(1934),()=>{this.FJ();this.SH(1,"EnterTempViewAfterPersistedView")},null,null,ne.a())):3===tc&&($c.add(new ie(Yc.a.instance.Xa(437),Yc.a.instance.ga(1946),Yc.a.instance.ga(1935),()=>{this.SH(2,"AutoOptInExitCalloutContinue");
this.FJ(!0)},Yc.a.instance.ga(1936),()=>{this.FJ();this.SH(1,"AutoOptInExitGuide")},ye.FZe())),$c.add(new ie(Yc.a.instance.ga(1937),Yc.a.instance.Xa(440),Yc.a.instance.ga(1935),()=>{this.SH(2,"Continue");this.FJ(!0)},Yc.a.instance.ga(1936),()=>{this.FJ();this.SH(1,"ExitGuide")},ne.a())),$c.add(new ie(Yc.a.instance.ga(1938),Yc.a.instance.Xa(439),Yc.a.instance.ga(1939),()=>{this.D2f();this.FJ();this.SH(1,"LearnMore")},Yc.a.instance.ga(1940),()=>{this.FJ();this.SH(1,"Done")},ye.EZe())));this.VTd=new $d($c)}D2f(){const tc=
new Rb.a(-859308420,Ke.a.Eb,this.$.Mc,9,null);this.$.Ka.Lb(tc,{[Ke.a.Zf]:"HelpID=SheetViews",["InputMethod"]:Ke.a.Eb,[Ke.a.Oc]:bc.a.pQ,["ShouldCanvasTakeFocus"]:!0})}show(tc){this.Z8h(tc);this.Kcb()}Rqj(tc){this.OYb=tc}Kcb(){var tc=this.VTd.Z0i;if(tc){var $c=Object(sb.a)(new xc.a,{label:tc.x_i,onExecute:tc.primaryButtonAction}),Ed=null;tc.LVf&&(Ed=Object(sb.a)(new xc.a,{label:tc.LVf,onExecute:tc.secondaryButtonAction}));tc=Object(sb.a)(new ad.a,{target:tc.targetObject,content:tc.body,title:tc.title,
showCloseIcon:!0,primaryButtonProps:$c,secondaryButtonProps:Ed,useTeachingStyles:!0});tc=this.OYb.callout(tc);$c=Object(sb.a)(new Dd.a,{onShow:()=>{this.SH(0)}});this.dyc=this.OYb.addNotification(tc,$c)}}dismiss(){this.FJ();this.SH(1,"DismissedByOthers")}FJ(tc=!1){this.dyc&&(this.OYb.removeNotification(this.dyc),this.dyc=null);tc&&this.Kcb()}SH(tc,$c=null){const Ed={};Ed.a=this.$.ya.UserSessionId;Ed.b=this.B7f;Ed.c=this.VTd.A7f;Ed.d=tc;Ed.e=$c;0===tc?this.stopwatch=this.$.Hb.xc("UserAction","ShowNamedSheetViewTeachingCallout"):
(this.stopwatch&&(this.stopwatch.stop(),Ed.f=this.stopwatch.tc,this.stopwatch=null),2===tc&&(this.stopwatch=this.$.Hb.xc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));me.b().Ie(52,Ed,!0)}static EZe(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static FZe(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Ggi(tc){return 0===tc||1===tc}}Object(b.a)(ye,"NamedSheetViewTeachingCallout",null,[327]);class te extends qb.a{constructor(tc){super();
this.$=tc;this.Fb()}create(){let tc=this.$.da.za(322);tc||(tc=new ye(this.$),this.$.da.Ga(322,tc));this.qb(tc)}static ka(tc){tc.da.Ga(323,new te(tc))}}Object(b.a)(te,"NamedSheetViewTeachingCalloutFactory",qb.a,[]);var Ze=a(1239),re=a(1134);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");d.a.instance.Ii(new ka);Object(V.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(wa.a)();Object(ma.a)();Object(ab.a)();Object(ba.a)();Type.registerNamespace("Common.App.SharedFilePicker");
za.main();Type.registerNamespace("Common.App.WildFire");ea.main();Object(Z.a)();ua.a.Fa(pa.ka);Object(Ja.a)();Object($a.a)();Object(rb.a)();Pa.a.Di(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{ua.a.Fa(tc=>{Qa.ka(tc)})})();(()=>{ua.a.Fa(tc=>{tc.da.Ga(165,new Wa(tc))})})();ua.a.Fa(ib.ka);Object(Bb.a)();Object(Ub.a)();Object(Ta.a)();Object(mb.a)();
Object(Qb.a)();Object(Lb.a)();Object(Jb.a)();Object(Ab.a)();Object(pb.a)();Object(va.a)();ua.a.Fa(Yb.ka);ua.a.Fa(Kd.ka);Object(Zd.a)();ua.a.Fa(Je.ka);(()=>{ua.a.Fa(tc=>{Oc.ka(tc);te.ka(tc)})})();Object(Ze.a)();Object(re.a)()},704:function(t,D,a){a.d(D,"a",function(){return T});t=a(0);var c=a(7),b=a(15),d=a(86),f=a(221),e=a(13),k=a(108),l=a(197),m=a(85);D=a(234);var v=a(1051),n=a(19),w=a(5),r=a(318),u=a(54),x=a(12),z=a(70),B=a(14),y=a(21),A=a(96),K=a(895),G=a(1);class T extends D.a{constructor(W,P){super(document.createElement("div"));
this.vjf=this.koe=this.Bie=this.b1b=this.oba=this.s7=this.eS=this.Xy=null;this.jva=this.WY=this.fv=this.r4a=!1;this.NGi=E=>{this.kD(E)};this.TGi=E=>{13===E.keyCode&&this.kD(E)};this.Axd=E=>{this.xo(E.tb);return!0};this.Gxd=E=>{this.YZ(E.tb);return!0};this.Vlc=E=>{this.ola(E.tb?E.tb:0);return!0};this.OGi=E=>{this.kD(E.Ca);return!0};this.tig=(E=null)=>{this.xo(E.inputMethod?E.inputMethod:0);return!0};this.uig=(E=null)=>{this.YZ(E.inputMethod?E.inputMethod:0);return!0};this.E0=W;this.QC=P;this.aWc=P.PFa.toString();
this.title=P.title;this.message=P.message;this.set_visibilityMode(1)}get BRg(){return this.QC.PFa}get businessBar(){return this.E0}get actionButton(){return this.QC?this.QC.actionButton:""}get uFa(){return this.QC?this.QC.uFa:""}get linkText(){return this.QC?this.QC.link:""}get Sk(){return this.QC?this.QC.Sk:""}get alt(){return this.QC?this.QC.alt:""}dispose(){d.a.rc([this.b1b,this.eS,this.s7]);this.fv&&this.eS&&(f.a.instance.Ba(e.a.click,this.eS.domElement,this.Axd),k.KeyInputManager.instance.Ev(this.domElement,
this.Bie));this.WY&&this.s7&&(f.a.instance.Ba(e.a.click,this.s7.domElement,this.Gxd),k.KeyInputManager.instance.Ev(this.domElement,this.koe));this.jva&&this.oba&&(f.a.instance.Ba(e.a.click,this.oba,this.Vlc),k.KeyInputManager.instance.Ev(this.domElement,this.vjf));this.oba=this.Xy=this.E0=this.s7=this.eS=null;super.dispose()}update(){}NPj(){this.aDe(!0)}H1c(){this.aDe(!1)}r8g(){this.message=A.a.zh(this.message);this.title=A.a.zh(this.title);l.UISurfaces.Cdd().then(W=>{W.initializeMessageBarInStore();
let P=Object(c.a)(new K.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.QC.ARg,closeable:!this.r4a,dismissButtonAriaLabel:B.a.instance.ga(10),onDismiss:this.OGi});this.jva&&(P.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Vlc});this.fv&&(P.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.tig});this.WY&&(P.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.uFa,["onExecute"]:this.uig});
W.createNewMessageBar(this.domElement,P);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}bDe(W){let P="<div class='"+v.a.Klh+"' id='{0}'><div class='"+v.a.Ilh+"'><a class='"+v.a.Qlh+"' title='{1}'><span class='"+n.a.$0b+" "+v.a.Mlh+"' id='{2}'>";this.Sk.length&&(P+="<img class='{3}' src='{4}'/>");P+="</span></a><span class='"+v.a.Plh+"' id='{5}'>{6}</span><span class='"+
v.a.Olh+"' id='message'>{7}</span><a id='link' href='#' class='"+v.a.Nlh+"'>{8}</a><span class='"+v.a.gLe+"'><button type='button' id='action' class='"+v.a.fLe+"'>{9}</button></span><span class='"+v.a.gLe+"'><button type='button' id='altAction' class='"+v.a.fLe+"'>{10}</button></span></div><a class='"+v.a.Llh+"' tabindex='0' role='button'><span id='close' class='"+n.a.RA+"'><img class='"+n.a.c8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";W||(this.domElement.tabIndex=0,
this.businessBar.domElement.appendChild(this.domElement));var E=this.businessBar.$.Bb;W=E+"ewaBusinessBarEntryBody"+this.aWc;const H=E+"ewaBusinessBarEntryTitle"+this.aWc;E=E+"ewaBusinessBarEntryIcon"+this.aWc;this.domElement.className=v.a.Jlh;this.domElement.innerHTML=String.format(P,W,this.alt,E,this.Sk,u.a.gf(0),H,this.title,this.message,this.linkText,this.actionButton,this.uFa,u.a.gf(13),B.a.instance.ga(794));x.DOMElementExtensions.ru(this.domElement,w.a.sra,H,W);this.oba=$get("link",this.domElement);
x.DOMElementExtensions.setVisible(this.oba,this.jva);this.jva&&(f.a.instance.ra(e.a.click,this.oba,this.Vlc),this.vjf=k.KeyInputManager.instance.ls(this.oba,this.Vlc,m.a.Zh,m.a.w0));this.eS=new r.a(x.DOMElementExtensions.getElementById(this.domElement,"action"));this.eS.isVisible=this.fv;this.s7=new r.a(x.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.s7.isVisible=this.WY;this.fv&&(f.a.instance.ra(e.a.click,this.eS.domElement,this.Axd),this.Bie=k.KeyInputManager.instance.ls(this.eS.domElement,
this.Axd,m.a.Zh,m.a.w0),this.WY&&(f.a.instance.ra(e.a.click,this.s7.domElement,this.Gxd),this.koe=k.KeyInputManager.instance.ls(this.eS.domElement,this.Gxd,m.a.Zh,m.a.w0)));this.Xy=$get("close",this.domElement);this.b1b=this.pe.Vd(this.Xy);this.b1b.ka("click",this.NGi);this.b1b.ka("keydown",this.TGi);x.DOMElementExtensions.setVisible(this.Xy,!this.r4a)}aDe(W){65==this.QC.PFa?this.bDe(W):G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.r8g():this.bDe(W)}xo(){b.ULS.sendTraceTag(21517968,
0,50,`BusinessBar [${this.QC.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.QC.$6c}`);y.g(this.businessBar.$).Fo(!0)}YZ(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.QC.hash}]: BusinessBarEntry.OnAltActionClick()`);y.g(this.businessBar.$).Fo(!0)}ola(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.QC.hash}]: BusinessBarEntry.OnLinkClick()`);y.g(this.businessBar.$).Fo(!0)}kD(W){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.QC.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.QC.$6c}`);
this.set_visible(!1);this.businessBar.removeEntry(this.BRg);z.g(W)}}Object(t.a)(T,"BusinessBarEntry",D.a,[])},778:function(t,D,a){a.r(D);t=a(0);var c=a(7),b=a(15),d=a(4);a(27);var f=a(382),e=a(38),k=a(50),l=a(12),m=a(127),v=a(1),n=a(14),w=a(21);class r extends Sys.EventArgs{constructor(F){super();this.F_i=F}}Object(t.a)(r,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var u=a(258),x=a(245);class z{constructor(F){this.ng=F}Xh(){u.a(this.ng.$).hB(this.Zd)||u.a(this.ng.$).Xh(this)}g7(){u.a(this.ng.$).hB(this.Zd)&&
u.a(this.ng.$).Nz(this)}get Zd(){return x.a.PHf}get lc(){const {PrintPreviewPane:F}=a(778);return document.getElementById(F.D_i)}get jf(){return!0}hh(F){return l.DOMElementExtensions.uf(this.lc,F)}kj(){this.ng.$.frame.Ee.Rj(this.ng.$.frame.Ee.RE)}Mj(){}gg(F,N){return N?!1:(this.ng.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(t.a)(z,"PrintPreviewHeaderKeyboardAccessibleSection",null,[110]);class B{constructor(F){this.ng=F}Xh(){u.a(this.ng.$).hB(this.Zd)||u.a(this.ng.$).Xh(this)}g7(){u.a(this.ng.$).hB(this.Zd)&&
u.a(this.ng.$).Nz(this)}get Zd(){return x.a.QHf}get lc(){const {PrintPreviewPane:F}=a(778);return this.ng.useMSPdfViewer?document.getElementById(a(778).PrintPreviewPane.HBd):document.getElementById(F.lFf)}get jf(){return!0}hh(F){return l.DOMElementExtensions.uf(this.lc,F)}kj(){this.ng.$.frame.Ee.Rj(this.ng.$.frame.Ee.RE)}Mj(){}gg(F,N){return N?!1:(this.ng.useMSPdfViewer?(F=document.getElementById(a(778).PrintPreviewPane.HBd))&&l.DOMElementExtensions.setFocus(F,!0):l.DOMElementExtensions.setFocus(this.ng.IK),
!0)}}Object(t.a)(B,"PrintPreviewKeyboardAccessibleSection",null,[110]);class y{constructor(F){this.ng=F}Xh(){u.a(this.ng.$).hB(this.Zd)||u.a(this.ng.$).Xh(this)}g7(){u.a(this.ng.$).hB(this.Zd)&&u.a(this.ng.$).Nz(this)}get Zd(){return x.a.THf}get lc(){const {PrintPreviewPane:F}=a(778);return document.getElementById(F.ODd)}get jf(){return!0}hh(F){return l.DOMElementExtensions.uf(this.lc,F)}kj(){this.ng.$.frame.Ee.Rj(this.ng.$.frame.Ee.RE)}Mj(){}gg(F,N){return N?!1:(this.ng.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)}}Object(t.a)(y,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[110]);class A{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(t.a)(A,"MSPdfViewerFileUrl",null,[]);class K{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=
!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(t.a)(K,"PrintSettingsTaskPaneProps",null,[]);class G{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(t.a)(G,"ViewerPaneProps",null,[]);var T=a(1071),W=a(376),P=a(5),E=a(1072);a.d(D,"PrintPreviewPane",function(){return H});class H extends e.a{constructor(F,N,J,R){super();this.WAb=this.hic=this.IK=this.WFb=this.Hw=this.tV=this.yD=this.MF=null;this.VAb=!1;this.cwa=
!0;this.PDd=this.LDd=this.MDd=this.ewaAccessibilityManager=this.Tnc=null;this.Mld=!1;this.wxf=()=>{b.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.VAb}`);this.VAb&&(this.G5h(),this.IK.style.visibility="visible",this.hic?this.hic.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(H.HCb,new r(1)),this.mNd(),this.VAb=!1)};this.$=F;this.xD=N;this.d8g();
this.useMSPdfViewer=J;this.isUniversalPrintEnabled=R}hFg(F){this.addHandler(H.HCb,F)}hbj(F){this.removeHandler(H.HCb,F)}oAj(){this.Z7g()}pAj(){var F=this.$.Hb.xc("UserAction","createSettingsPaneStopwatch");const N=document.getElementById(H.ODd);this.f8g();const J=this.g8g();this.yD.createPrintSettingsTaskPane(N,J);F.stop();this.VAb=!1;if(this.isUniversalPrintEnabled&&this.Hw){F="A4";switch(J.selectedPrintSettingsValues.selectedPaperSize){case 8:F="A3";break;case 9:F="A4";break;case 11:F="A5";break;
case 12:F="JIS B4";break;case 13:F="JIS B5";break;case 5:F="North America Legal";break;case 1:F="North America Letter";break;case 6:F="North America Invoice";break;case 7:F="North America Executive";break;case 3:F="North America Ledger"}this.MF.setDocumentSettings({mediaSize:F,orientation:2===J.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===J.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.CGd()}setPageRangeSettings(F,N,J,R,M){this.yD&&
(this.yD.setPageRangeSettings(F,N,J,R,M),this.sZf(String.format(n.a.instance.mb(204),R,M,F)))}w5h(){this.Hw&&(this.Hw.style.display="none")}Ofh(){this.dispose();this.IWd();this.HNj();this.MF&&this.MF.closePrintPreviewPane();this.tV=this.yD=this.MF=this.Hw=null}Yri(F){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.WAb=this.$.Hb.xc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),
this.tV.renderPdf(F)):this.IK&&((this.hic=this.$.Hb.xc("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.VAb=!0,this.IK.src&&this.IK.src===F?this.wxf(null):this.IK.src=F);if(this.isUniversalPrintEnabled&&this.Hw){const N=W.b(this.$.workbookContext);this.MF.setFileUrl(F,N)}}onPdfLoad(){this.WAb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.WAb.tc} ms, isFirstTimeLoad: ${this.cwa}`),
this.WAb.stop()):b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(H.HCb,new r(1));this.hideWaitCursor();this.mNd()}printPdf(){l.DOMElementExtensions.setFocus(this.IK);this.IK.contentWindow.print()}cBj(){this.showSpinner();this.showWaitCursor();this.sZf("")}G5h(){this.hideSpinner();this.hideWaitCursor()}Wz(F,N,J=null){this.Hw&&this.tV&&(this.Mld=!1,this.tV.showErrorDetails(N,F,J),this.xD.s5a=!0,this.IK&&(this.IK.src=""),this.disablePrintButton(),
this.hideWaitCursor(),H.xji(N)&&(this.Mld=!0,this.BOi()))}hidePreviewError(){this.xD.s5a=!1;this.tV.hidePreviewError();this.enablePrintButton()}Ffh(){(this.WFb=document.getElementById(H.RHf))&&this.WFb.parentNode&&this.WFb.parentNode.removeChild(this.WFb)}hideErrorMessageForPrintOptions(){this.yD&&this.yD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(F){this.yD&&this.yD.showErrorMessageForPrintOptions(F)}showSpinner(){this.xD.s5a||v.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&
this.Mld?this.hidePreviewError():this.IK&&(this.IK.style.visibility="hidden");this.tV&&this.tV.showSpinner()}hideSpinner(){this.tV&&this.tV.hideSpinner()}enablePrintButton(){this.yD&&this.yD.enablePrintButton();this.isUniversalPrintEnabled&&this.Hw&&this.MF.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.yD&&this.yD.disablePrintButton();this.isUniversalPrintEnabled&&this.Hw&&this.MF.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.yD&&this.yD.showWaitCursor();this.isUniversalPrintEnabled&&
this.Hw&&this.MF.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.yD&&this.yD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Hw&&this.MF.updatePrintButtonEnableDisableState(!0)}b8g(){if(this.Hw)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Hw=document.createElement("div"),this.Hw.id=H.RHf,this.Hw.classList.add(H.G_i),this.$.$q.insertBefore(this.Hw,this.$.$q.firstChild),d.AFrameworkApplication.ta&&
d.AFrameworkApplication.ta.Pa.Ef){const F=document.getElementById(P.a.xFa);F&&(this.Hw.style.top=`${F.clientHeight}px`,this.Hw.style.height=`calc(100vh - ${F.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.MF.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.MF.enterPrintSettingsTaskPaneFocusTrapZone()}rYi(){this.$.da.Za(15,F=>{this.ewaAccessibilityManager=F;this.ewaAccessibilityManager.mode=3})}d8g(){this.PDd=new y(this);this.MDd=new B(this);this.LDd=
new z(this)}CGd(){this.PDd.Xh();this.MDd.Xh();this.LDd.Xh();this.rYi()}IWd(){this.PDd.g7();this.MDd.g7();this.LDd.g7();w.g(this.$).Q_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}MN(){this.Tnc=m.a.instance.Vd(this.IK);this.Tnc.ka("load",this.wxf)}HNj(){this.Tnc&&this.IK&&this.Tnc.detach("load")}mNd(){this.isUniversalPrintEnabled?this.yYf(H.E_i,H.kCi):this.yYf(H.ODd,H.LHf)}yYf(F,N){this.cwa&&(F=document.getElementById(F))&&(N=l.DOMElementExtensions.getElementById(F,N))&&(this.cwa=
!1,N.focus())}BOi(){this.xD.s5a=!1;this.enablePrintButton();this.mNd()}Z7g(){const F=k.GetServiceTaskFactory.Ta(this.$.da,283,284,0).result.$n;F.loadScript("excel-print-preview-sprite").then(()=>{F.loadScript("printPreviewer").then(()=>{F.loadScript("excelPrintPreviewer").then(()=>{this.e8g()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}e8g(){const F=
this.$.Hb.xc("UserAction","createEmptyPreviewerStopwatch");this.b8g();this.c8g();this.isUniversalPrintEnabled?this.MF.createEmptyPrintPreviewPaneAsync(this.Hw,this.iDe()).then(()=>{F.stop();this.Vze();this.MF.updatePrintButtonEnableDisableState(!1)}):(this.MF.createEmptyPrintPreviewPane(this.Hw,this.iDe()),F.stop(),this.Vze())}Vze(){const F=this.$.Hb.xc("UserAction","createPdfPreviewPaneStopwatch"),N=document.getElementById(H.HBd);this.useMSPdfViewer&&(N.tabIndex=0);this.M7g();this.L7g(N);F.stop();
this.raiseEvent(H.HCb,new r(0))}c8g(){this.MF||(this.MF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.MF||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}f8g(){this.yD||(this.yD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.yD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}M7g(){this.tV||
(this.tV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.tV||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}L7g(F){this.tV.createPrintPreviewPane(F,this.p$g());this.useMSPdfViewer||(this.IK=l.DOMElementExtensions.getElementById(this.Hw,H.lFf),this.IK.title=n.a.instance.ga(1210),this.MN())}g8g(){let F,N="en-US";F=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?
N=this.$.ya.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new K,{whatToPrintOptions:this.xD.rv.whatToPrintOptions,orientationOptions:this.xD.rv.orientationOptions,paperSizeOptions:this.xD.rv.paperSizeOptions,scalingOptions:this.xD.rv.scalingOptions,marginDetailedOptions:this.xD.HQh(),selectedPrintSettingsValues:this.xD.GTh(),printSettingsTaskPaneCallbacks:this.xD.ETh(),
logger:new f.a,shouldDisableCurrentSelection:this.xD.svc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:F,dataCultureTag:N,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}iDe(){return this.isUniversalPrintEnabled?this.xD.CTh():Object(c.a)(new T.a,{backActionButtonText:n.a.instance.ga(1208),printPreviewPaneCallbacks:this.xD.M_e(),logger:new f.a,disableTellMeControl:!0})}p$g(){return this.useMSPdfViewer?Object(c.a)(new G,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.$6g(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(c.a)(new G,{useMSPdfViewer:!1})}$6g(){return Object(c.a)(new A,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}sZf(F){this.Hw&&this.MF.setAdditionalHeaderText(F)}static xji(F){return 3===F||2===F}}H.RHf="PrintPreviewerContainer";H.ODd="printSettingsTaskPaneId";H.HBd="previewId";H.lFf="printpreviewiframe";H.D_i="printPreviewHeaderId";H.LHf="printButton";
H.E_i="printPreviewPaneId";H.kCi="printButtonId";H.G_i=E.a.Hw;H.HCb="pppnosu";Object(t.a)(H,"PrintPreviewPane",e.a,[359])},832:function(t,D,a){a.d(D,"a",function(){return e});t=a(0);var c=a(15),b=a(4),d=a(39),f=a(27);class e{static fVe(k,l){switch(k){case 3:return e.YZh(l);case 2:return e.BSh(l);case 1:return e.LMh(l)}return""}static YZh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static BSh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static LMh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(k,l,m){if(f.a.Zg||f.a.ep)window.setTimeout(()=>{e.iMf(m,e.Lac())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(e.Yoe(m),k,0,!1)}static UXg(k,l,m,v){l&&
v&&v();e.openInClient(k,l,m)}static Lac(){return f.a.Zg?1:f.a.ep?2:f.a.S6a?3:f.a.isMac?4:0}static UZh(k){switch(k){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static VZh(k){switch(k){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get yyb(){return"zh-CN"===window.navigator.language}static iMf(k,l){1===l?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),k=e.fVe(k,l),8<f.a.B4a?d.a.Ve(k,void 0,void 0,"RedirectToAppStore"):d.a.uU(k)):document.hidden||(e.yyb?(k=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),d.a.uU(k)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(e.fVe(k,
l),null,null)))}static Yoe(k){switch(k){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Ovc(){return(f.a.S6a||f.a.isMac)&&f.a.fp}static get uxj(){return f.a.Zg||f.a.ep}static lbd(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static ind(k){return(k=e.DPh(k))&&""!==k?Boolean.parse(k):!1}static gOd(k){e.pqj(k)}static DPh(k){try{return localStorage.getItem(k)}catch(l){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static pqj(k){try{localStorage.setItem(k,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}e.Vwe="ChromeExtensionBarDismiss";Object(t.a)(e,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/cb69ca3838342897475960036eb701ba/EwaDSEsNext.kmhv.js.map