'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1135:function(t,D,a){t=a(0);var c=a(83),b=a(547),d=a(15),f=a(133);class e{constructor($a,rb,Pa){this.OQd=this.PQd=this.QQd=!1;this.eRd=!$a&&!rb;this.fRd=!$a&&!Pa;this.eRd||this.fRd||(this.QQd=!$a,this.PQd=!rb,this.OQd=!Pa)}}Object(t.a)(e,"RenameDisabledDialogInfo",null,[]);class k extends f.StandardDialog{constructor($a,rb,Pa,eb,Ob){super();this.cUd=[];this.W0=new e($a,rb,Pa);this.Mqa=eb;this.zpa=Ob;this.Ae=
"RenameDisabledDialog";this.Sb=0;this.sc(1,CommonUIStrings.l_DialogClose);this.Msj();this.Kcj()}Msj(){this.W0.eRd?this.cLb(this.Mqa?this.zpa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.W0.fRd?this.cLb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.RAg();this.Vqa(this.cUd)}cLb($a){Array.add(this.cUd,$a)}RAg(){const $a=[];this.W0.QQd||Array.add($a,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.W0.PQd||Array.add($a,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.W0.OQd||Array.add($a,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<$a.length&&Array.add(this.cUd,$a)}}Object(t.a)(k,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends k{constructor($a,rb,Pa,eb,Ob){super($a,rb,Pa,eb,Ob)}Kcj(){this.SBb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(t.a)(l,"ReactRenameDisabledDialog",k,[]);var m=a(144);class v{static get ag(){return m.a.Yo(v.Ak,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}v.Ak="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(t.a)(v,"RenameDisabledDialogHtml",null,[]);class n extends m.a{constructor($a,rb,Pa,eb,Ob){super();this.W0=new e($a,rb,Pa);this.Mqa=eb;this.zpa=Ob;this.Ae="RenameDisabledDialog";this.Sb=0;this.sc(1,CommonUIStrings.l_DialogClose);this.ag=v.ag;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.hW("RenameRow")}Z8a(){if(this.W0.eRd){let $a;$a=this.Mqa?this.zpa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;n.cLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),$a)}else this.W0.fRd?n.cLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.F5h()}F5h(){this.W0.QQd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.W0.PQd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.W0.OQd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static cLb($a,rb,Pa){$a.style.display="none";rb.innerText=Pa}}Object(t.a)(n,"RenameDisabledDialog",m.a,[]);var w=a(4),r=a(29),u=a(106),x=a(25);class z{constructor($a,rb){this.rDa=0;this.La=$a;this.J7=rb}initialize($a){if(!this.La||!this.J7)return!1;this.rDa=$a;this.Fg();return!0}Fg(){this.La.Ob(x.a.aha,u.a.frame,Object(c.a)(this,this.aha,"commitNewDocumentTitle"))}aha($a,rb,Pa,eb,Ob){if(1===Pa)return this.La.processAction(x.a.renameFile,
1);$a=r.a.rq(this.J7.Ym);Ob=(0,Ob.getNewDocumentTitle)();Ob.length>this.rDa&&(Ob=Ob.substr(0,this.rDa));if(32!==this.La.ae(x.a.renameFile,2,Ob))return this.AW($a),8;this.AW(Ob);return 32}AW($a){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle($a))}static ldd(){return new z(w.AFrameworkApplication.wb,w.AFrameworkApplication.lm)}}Object(t.a)(z,"ReactRenameUIHandler",null,[285]);var B=a(92),y=a(515),A=a(549),K=a(13),G=a(108),T=a(235),W=a(88),P=a(39),E=a(27),H=a(82);class F{constructor($a,
rb,Pa,eb,Ob,tb,cc,Ib,Mb,Oa,Aa,Ba){this._initialized=!1;this._element=null;this.rDa=0;this.QOc=this.oIc=!1;this.La=$a;this.CDc=rb;this.Yd=Pa;this.uA=eb;this.J7=Ob;this.pee=tb;this.DUb=cc;this.xEc=Ib;this.X7=Mb;this.h8d=Oa;this.qVa=Aa;this.jJc=Ba}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize($a,rb,Pa){if(!(this.La&&this.J7&&this.pee&&this.DUb&&this.xEc&&rb)||0>=$a)return!1;this._element=rb;this._element.title=Pa;this._element.setAttribute(W.a.Kd,W.a.Ps);this._element.setAttribute("Unselectable",
"on");this.rDa=$a;this.tv();return this._initialized=!0}tv(){this.CDc&&(this.CDc.ra(K.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.CDc.ra(K.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.ra(K.a.Mb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.uA.ra(K.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.uA.ra(K.a.Mf,this._element,Object(c.a)(this,this.Kf,"onPointerUp"))}onBlur(){this.isActive&&!this.oIc&&
(this.h8d||this.xEc(this._element),this.rze(),this.Y3c(!1));return this.oIc=!1}onPaste(){d.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown($a){return this.isActive?this.MMi($a):this.NMi($a)}MMi($a){let rb=!1;switch($a.Ca.keyCode){case Sys.UI.Key.enter:this.rze();this.Y3c(this.qVa||this.jJc);rb=!0;break;case Sys.UI.Key.tab:this.h8d&&this.xEc(this._element);break;case Sys.UI.Key.esc:this.gKd(),this.Y3c(this.qVa||this.jJc),rb=!0}return rb}NMi($a){let rb=
!1;switch($a.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Z9f(this.jJc),this.isActive&&this.DUb(this._element),rb=!0}return rb}onPointerDown(){this.isActive||(this.Z9f(!1),this.isActive&&(this._element.focus(),this.DUb(this._element),this.QOc=!0));return!1}Kf(){return this.QOc?(this.DUb(this._element),this.QOc=!1,!0):!1}h6a(){return 32===this.La.processAction(x.a.renameFile,1)}rze(){const $a=r.a.rq(this.J7.Ym);let rb=this._element.innerText.trim();rb.length>this.rDa&&(rb=rb.substr(0,
this.rDa));rb!==$a&&""!==rb?32!==this.La.ae(x.a.renameFile,2,rb)?this.gKd():this.AW(rb):this.gKd()}gKd(){this.AW(r.a.rq(this.J7.Ym))}AW($a){this._initialized&&(this._element.innerText=$a,this.pee())}Z9f($a){this.h6a()?this.isActive||($a&&(this.oIc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(W.a.Kd,W.a.sVc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,B.CuiHelper.AIe),
this.X7&&this.X7.execute(rb=>{rb.YJf(!0)}),$a&&this._element.focus(),d.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(x.a.Ocb,2)}Y3c($a){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(W.a.Kd,W.a.Ps);Sys.UI.DomElement.removeCssClass(this._element,B.CuiHelper.AIe);this.X7&&this.X7.execute(rb=>{rb.YJf(!1)});$a&&(this._element.blur(),this._element.focus())}static Rz(){y.a.Rz(w.AFrameworkApplication.isRtl)}static ldd(){return new F(w.AFrameworkApplication.wb,
A.a.instance,G.KeyInputManager.instance,T.a.instance,w.AFrameworkApplication.lm,F.Rz,P.a.Ukj,P.a.CXg,H.a.instance.Vb("Common.App.Header.HeaderEventSource"),E.a.Tja,E.a.Zg,E.a.Tf)}}Object(t.a)(F,"RenameUIHandler",null,[285]);class N{static get instance(){return w.AFrameworkApplication.ta.Pa.Zr?N.Ma||(N.Ma=z.ldd()):N.Ma||(N.Ma=F.ldd())}}N.Ma=null;Object(t.a)(N,"RenameUIHandlerFactory",null,[]);var J=a(98),R=a(134);class M{constructor(){this.eCi=this.aCi=this.T$g=null}}Object(t.a)(M,"RenameMruEntryProperties",
null,[]);var L=a(370),U=a(163),X=a(639),da;(function($a){$a[$a.unknown=-1]="unknown";$a[$a.success=0]="success";$a[$a.renameInvalidFileName=1]="renameInvalidFileName";$a[$a.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";$a[$a.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";$a[$a.permissionDenied=4]="permissionDenied";$a[$a.serverCommunicationFailure=5]="serverCommunicationFailure";$a[$a.fileNameTooLong=6]="fileNameTooLong"})(da||(da={}));Object(t.b)("CommonOperationResult",
da);class fa{constructor($a,rb,Pa,eb,Ob,tb,cc,Ib,Mb,Oa,Aa,Ba){this.s8d=$a;this.La=rb;this.HEc=Pa;this.Lv=eb;this.kDa=Ob;this.zxg=tb;this.Mqa=cc;this.qhe=Ib;this.bug=Mb;this.zpa=Oa;this.nb=Aa;this.aug=Ba}Fg(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pa.Zr||this.$h.Ob(x.a.hxb,u.a.frame,Object(c.a)(this,this.hxb,"initializeRenameUIHandler"));this.$h.Ob(x.a.Ocb,u.a.frame,Object(c.a)(this,this.Ocb,"showRenameDisabledDialog"));this.$h.Ob(x.a.renameFile,u.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.$h.Je(x.a.fileNameUpdate,u.a.frame,Object(c.a)(this,this.p6i,"refreshFilename"),64);this.$h.Je(x.a.Qjc,u.a.frame,Object(c.a)(this,this.Qjc,"moveToFolderCompleteByHost"),64);this.$h.Ob(x.a.sNa,u.a.frame,Object(c.a)(this,this.sNa,"moveToFolder"));w.AFrameworkApplication.ta&&(w.AFrameworkApplication.fa.qa("PostMessageEmbedded")||w.AFrameworkApplication.fa.qa("IsJsApi"))&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&w.AFrameworkApplication.GU().execute($a=>
{$a.fo(U.a.Jpf);$a.Vl(U.a.Jpf,fa.e5i);$a.fo(U.a.B9c);$a.Vl(U.a.B9c,fa.c5i)})}h6a(){return 0===this.aug.g0e()?32:8}$Tj(){return this.Zy?this.Mqa?this.Zy.AHe:this.Zy.Jtb:!0}hxb(){return N.instance.initialize(w.AFrameworkApplication.N7b,w.AFrameworkApplication.P0a,w.AFrameworkApplication.zId||CommonUIStrings.l_RenameFileTooltip)?32:8}Ocb(){const $a=this.$Tj(),rb=this.zxg();d.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.kDa,rb,$a,this.Mqa);w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pa.nv&&w.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new l(this.kDa,!rb,!$a,this.Mqa,this.zpa()):new n(this.kDa,!rb,!$a,this.Mqa,this.zpa());return 32}renameFile($a,rb,Pa,eb,Ob){if(1===Pa)return this.h6a();if(!w.AFrameworkApplication.m7b)return 8;if(8===this.h6a())return this.$h.processAction(x.a.Ocb,2),8;d.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");w.AFrameworkApplication.m7b(Ob,Object(c.a)(this,
this.dEb,"onRenameFileSuccess"),Object(c.a)(this,this.vPi,"onRenameFileFailure"));return 32}dEb($a,rb){$a?0!==$a.OperationResult?this.$3e($a.OperationResult):(this.mmj(rb,$a.NewName),this.yPj($a,Object(c.a)(w.AFrameworkApplication.ta.Pa,w.AFrameworkApplication.ta.Pa.ycg,"updateOpenInClientDocumentUrl")),w.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&w.AFrameworkApplication.ta.updateCommandUI(),this.bug.gbg()):this.$3e(5)}mmj($a,rb){const Pa={};Pa[L.a.myh]=rb;$a.Fj(U.a.B9c,
Pa)}yPj($a,rb){this.MPj($a);w.AFrameworkApplication.Q4b=$a.DirectInvokeDavUrl;rb=rb($a.EditDocInClientUrl);const Pa=new M;Pa.eCi=this.Lv.Ym;Pa.T$g=rb;Pa.aCi=$a.EditDocInClientUrl;this.$h.ae(x.a.renameMostRecentlyUsedFileEntry,2,Pa)}$3e($a){switch($a){case 1:$a=new f.StandardDialog,$a.Sb=0,$a.mW(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.GSf()}}MPj($a){this.Lv.Ym=fa.mJg(this.Lv.Ym,$a.NewName);$a.BreadcrumbFolderName&&(this.Lv.breadcrumbFolderName=
$a.BreadcrumbFolderName);$a.BreadcrumbFolderUrl&&(this.Lv.breadcrumbFolderUrl=$a.BreadcrumbFolderUrl);this.qhe($a.NewName)}vPi($a){const rb=new f.StandardDialog;rb.Sb=0;switch($a){case 1:d.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");rb.$za(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:d.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");rb.$za(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:d.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:$a}),rb.$za(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}w.AFrameworkApplication.GU().execute(Pa=>{Pa.Fj(U.a.lyh,{["FailureMessage"]:da[$a]})});this.GSf()}p6i($a,rb,Pa){if(1===Pa)return this.h6a();if(!w.AFrameworkApplication.sIa)return 8;w.AFrameworkApplication.sIa(Object(c.a)(this,this.zmc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.ymc,"onRefreshFilenameFailure"),
!1);return 32}sNa($a,rb,Pa,eb,Ob){if(1===Pa)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Pa){const tb={};$a=w.AFrameworkApplication.cba;rb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");$a=(!$a||$a&&rb)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);tb[L.a.VFj]=$a;Ob&&Ob.MoveButtonClickedTime&&(tb[L.a.vAi]=Ob.MoveButtonClickedTime.getTime());w.AFrameworkApplication.GU().execute(cc=>{cc.Fj(U.a.sNa,
tb)});if(Ob&&Ob.MoveButtonClickedTime){if($a=R.a.Kr())Ob=(new Date).getTime()-Ob.MoveButtonClickedTime.getTime(),$a.set("MovePostDuration",Ob.toString());J.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",$a)}return 32}return 8}Qjc($a,rb,Pa,eb,Ob){if(1===Pa)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.h6a():8;if(2===Pa){if(!w.AFrameworkApplication.pWf)return J.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,
null),8;if(!Ob)return J.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ob[L.a.qfi])if(Ob[L.a.sdg])if($a=Ob[L.a.sdg].toLowerCase(),rb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Pa=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),rb&&w.AFrameworkApplication.cba&&Pa){const tb={};tb[L.a.bPa]="1";tb[L.a.documentUrl]=$a;tb[L.a.reason]=X.a.saveAs;J.Health.instance.recordKpiSuccess("MoveToFolder",null);
w.AFrameworkApplication.GU().execute(cc=>{cc.Fj(U.a.kta,tb)})}else if(!w.AFrameworkApplication.cba&&Pa)J.Health.instance.recordKpiSuccess("MoveToFolder",null),P.a.Ve($a,P.a.DW(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return J.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else J.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else w.AFrameworkApplication.sIa(Object(c.a)(this,this.zmc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.ymc,"onRefreshFilenameFailure"),!1),w.AFrameworkApplication.pWf(),J.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Txj($a,rb){return $a&&rb?$a!==this.Lv.breadcrumbFolderName||rb!==this.Lv.breadcrumbFolderUrl:!1}zmc($a,rb){$a&&($a.NewName!==r.a.rq(this.Lv.Ym)||this.Txj($a.BreadcrumbFolderName,$a.BreadcrumbFolderUrl))&&this.dEb($a,rb)}ymc(){}GSf(){this.qhe(r.a.rq(this.Lv.Ym))}get $h(){return this.La.value}get Zy(){return this.HEc.value}static get instance(){return fa.Ma||(fa.Ma=
fa.Ktb())}static Ktb(){return new fa(w.AFrameworkApplication.i6a,new b.a(()=>w.AFrameworkApplication.wb),new b.a(()=>w.AFrameworkApplication.Zy),w.AFrameworkApplication.lm,w.AFrameworkApplication.limitedEdit,()=>w.AFrameworkApplication.userCanRename,w.AFrameworkApplication.qrc,Object(c.a)(N.instance,N.instance.AW,"updateTitle"),H.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.fa,H.a.instance.resolve("Common.IRenameProps"))}static mJg($a,
rb){$a=r.a.o3($a);return rb+$a}static e5i($a){const rb=$a.Values[L.a.Oii];d.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",rb);rb?w.AFrameworkApplication.wb.ae(x.a.Qjc,2,$a.Values):J.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static c5i($a){w.AFrameworkApplication.wb.ae(x.a.renameFile,2,$a.Values.NewName)}}fa.Ma=null;Object(t.a)(fa,"RenameActor",null,[]);a(564);class S{}Object(t.a)(S,"ActivityEventName",null,[]);class ka{}
ka.compatMode="CompatMode";ka.noSelection="NoSelection";Object(t.a)(ka,"ActivityEventReason",null,[]);var V=a(638);class wa{constructor($a,rb){this.La=$a;this.zUa=rb}Fg(){this.La.Ob(x.a.X2f,u.a.frame,Object(c.a)(this,this.AAj,"showRenameDialogAction"))}AAj($a,rb,Pa){$a=32;if(1===Pa)return V.SessionStatusManager.instance.g4a||w.AFrameworkApplication.i4?8:32;2===Pa&&(32!==this.La.processAction(x.a.renameFile,1)?(this.La.processAction(x.a.Ocb,2),$a=8):32===this.La.processAction(x.a.bLb,1)?this.La.processAction(x.a.bLb,
2):this.zUa.value.create().Tvc());return $a}}Object(t.a)(wa,"RenameDialogActor",null,[276]);class ma{constructor($a,rb,Pa){this.dialog=null;this.La=$a;this.Lv=rb;this.kpa=Pa}EUh(){const $a={};$a.nameInputProps={["type"]:"AppInputProps",["id"]:ma.O0a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:r.a.rq(this.Lv.Ym),["maxLength"]:this.kpa};return $a}Tvc(){const $a={["id"]:"RenameDialog",["bodyControls"]:this.EUh()};this.dialog=new m.a(!1,!1,!0);this.dialog.Sb=1;this.dialog.Ae="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.xId,"renameDialogHandler"),$a)}xId($a,rb){rb&&1===$a&&rb[ma.O0a]&&($a=r.a.rq(this.Lv.Ym),rb=(rb[ma.O0a]||"").trim(),rb!==$a&&""!==rb&&this.La.ae(x.a.renameFile,2,rb))}}ma.O0a="txtDocumentName";Object(t.a)(ma,"ReactRenameDialog",null,[286]);class ab{static get ag(){return m.a.Yo(ab.Ak,CommonUIStrings.l_RenameDialogLabel)}}ab.Ak="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(ab,"RenameDialogHtml",null,[]);class ba extends m.a{constructor($a,rb,Pa){super();this.La=$a;this.Lv=rb;this.kpa=Pa;this.Ae="RenameDialog";this.ag=ab.ag}Tvc(){var $a={["txtDocumentName"]:r.a.rq(this.Lv.Ym)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.xId,"renameDialogHandler"),$a);$a=document.getElementById(ba.O0a);0<this.kpa&&($a.maxLength=this.kpa);$a.focus()}xId($a,rb){1===$a&&($a=r.a.rq(this.Lv.Ym),rb=(rb[ba.O0a]||"").trim(),rb!==$a&&""!==rb&&this.La.ae(x.a.renameFile,
2,rb))}}ba.O0a="txtDocumentName";Object(t.a)(ba,"RenameDialog",m.a,[286]);class Ca{constructor($a){this.J7=null;this.kpa=0;this.La=$a;this._initialized=!1}initialize($a,rb){this.J7=$a;this.kpa=rb;this._initialized=!0}create(){return this._initialized?w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pa.nv&&w.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new ma(this.La,this.J7,this.kpa):new ba(this.La,this.J7,this.kpa):null}}Object(t.a)(Ca,"RenameDialogFactory",null,[273]);var Na=
a(259),za=a(182),la=a(160),aa=a(107),sa=a(103);class ea{constructor($a,rb){this.La=$a;this.Yb=rb}Fg(){this.La.Ob(x.a.bLb,u.a.frame,Object(c.a)(this,this.BAj,"showRenameFlyoutAction"))}ITg(){return la.d("setDocumentTitleFlyoutOpened")&&w.AFrameworkApplication.ta.Pa.Zr}BAj($a,rb,Pa){if(1===Pa)return this.ITg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}cCg(){ea.Ili&&w.AFrameworkApplication.V5a&&sa.a.instance.Hg(new aa.a(5,1,5E3,()=>{32===this.La.processAction(x.a.bLb,
1)&&this.Yb&&this.Yb.pi.name===Na.AFrame.m$&&(za.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(x.a.bLb,2))}))}static get Ili(){ea.jSb&&null!=ea.jSb||(w.AFrameworkApplication.Aic("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ea.jSb=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ea.jSb}}ea.jSb=null;Object(t.a)(ea,"RenameFlyoutActor",null,
[271]);class Z{constructor($a,rb,Pa,eb,Ob){this.HEc=Ob;this.t8d=Pa;this.s8d=eb;this.Dxg=$a;this.zpa=rb}get Zy(){return this.HEc.value}g0e(){if(!this.s8d())return 5;if(this.zpa())return 1;if(this.Zy){if(this.t8d&&!this.Zy.AHe)return 3;if(!this.t8d&&!this.Zy.Jtb)return 4}return this.Dxg()?0:2}}Object(t.a)(Z,"RenameProps",null,[272]);a(184);var ua=a(99);class ya{constructor($a,rb,Pa,eb,Ob,tb){this.Tm=!1;this.IKc=new ua.a;this.FUa=rb;this.HL=Pa;this.zlg=eb;this.nb=Ob;this.$fe=tb}enable(){this.Tm||(this.gbg(),
this.zSd(),this.Tm=!0)}generateKey($a,rb,Pa){return String.format("{0}/{1}/{2}",Pa,$a,rb)}IPh(){const $a=r.a.rq(this.FUa().Ym);return this.generateKey(this.FUa().breadcrumbFolderName,this.FUa().breadcrumbFolderUrl,$a)}JPh($a,rb,Pa){return $a&&rb?this.generateKey($a,rb,Pa):Pa}qeh($a,rb,Pa){return $a&&$a!==this.FUa().breadcrumbFolderName||rb&&rb!==this.FUa().breadcrumbFolderUrl?!0:Pa!==r.a.rq(this.FUa().Ym)}gbg(){const $a=this.IPh();this.IKc.ia($a,new Date)}YBd($a){this.zwj($a)&&this.zie($a)}zwj($a){const rb=
this.zlg();return rb?this.$fe&&this.$fe.wyb||!rb.Zbf||!w.AFrameworkApplication.sIa?(this.A5f($a),this.Tm=!1):!0:!1}eCf($a,rb,Pa,eb){const Ob=this.qeh($a,rb,Pa);$a=this.JPh($a,rb,Pa);rb=this.IKc.Cc($a).returnValue;Ob&&!rb&&(this.a4e(eb),d.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Isd));Ob||this.IKc.ia($a,this.HL())}}Object(t.a)(ya,"ARenamedFileChecker",null,[243]);class ha extends ya{constructor($a,rb,Pa,eb,Ob,tb,cc,Ib){super($a,rb,Pa,eb,Ob,tb);this.kde=Ob;this.$tg=cc;this.rpg=
Ib}get Isd(){return"RenamedFileCheckerUsingSettingsRefresh"}zSd(){this.kde.GTc(Object(c.a)(this,this.N4e,"handleSettingsRefresh"))}N4e($a,rb){rb&&rb.vCb&&rb.EEi&&(rb.s6a("BreadcrumbDocName")||rb.s6a("BreadcrumbFolderName")||rb.s6a("BreadcrumbFolderUrl")||rb.s6a("DirectInvokeDAVUrl")||rb.s6a("EditDocInClientUrl"))&&(d.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Isd),this.YBd(rb))}A5f(){this.kde.qbj(Object(c.a)(this,this.N4e,"handleSettingsRefresh"))}zie($a){if($a&&$a.vCb){const rb=
$a.vCb;this.eCf(rb.Va("BreadcrumbFolderName"),rb.Va("BreadcrumbFolderUrl"),rb.Va("BreadcrumbDocName"),$a)}}a4e($a){const rb={OperationResult:0,classId:1};$a=$a.vCb;rb.BreadcrumbFolderName=$a.Va("BreadcrumbFolderName");rb.BreadcrumbFolderUrl=$a.Va("BreadcrumbFolderUrl");rb.DirectInvokeDavUrl=$a.Va("DirectInvokeDAVUrl");rb.EditDocInClientUrl=$a.Va("EditDocInClientUrl");$a=$a.Va("BreadcrumbDocName");rb.NewName=w.AFrameworkApplication.jta?$a:r.a.rq($a);this.rpg.execute(Pa=>{this.Hci(rb,Pa)})}Hci($a,rb){this.$tg().dEb($a,
rb)}}Object(t.a)(ha,"RenamedFileCheckerUsingSettingsRefresh",ya,[]);class Da extends ya{constructor($a,rb,Pa,eb,Ob,tb,cc,Ib,Mb,Oa){super($a,Pa,eb,Ob,tb,Mb);this.bkb=this.fWb=null;this.ftg=rb;this.La=cc;this.ee=Ib;Oa&&Oa.execute(Aa=>{this.G8i(Aa)})}get Isd(){return"RenamedFileCheckerUsingTask"}G8i($a){this.fWb=$a;this.fWb.GFg(Object(c.a)(this,this.Ogd,"handleVisibilityChange"))}Ogd($a,rb){!this.Tm||0!==rb.newState&&1!==rb.newState||this.bkb||(this.zSd(),this.YBd(this.bkb))}zSd(){this.bkb=new aa.a(3,
2,this.ftg(),Object(c.a)(this,this.YBd,"performRenameFileCheckTick"),89);this.ee.Hg(this.bkb)}A5f($a){this.ee.Hp($a)}zie($a){this.fWb&&2===this.fWb.KYj?this.I9i($a):w.AFrameworkApplication.sIa(Object(c.a)(this,this.zmc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.ymc,"onRefreshFilenameFailure"),!0)}I9i($a){this.ee.Hp($a);this.bkb=null}zmc($a){$a&&this.eCf($a.BreadcrumbFolderName,$a.BreadcrumbFolderUrl,$a.NewName,null)}a4e(){this.La.processAction(x.a.fileNameUpdate,2)}ymc(){}}Object(t.a)(Da,"RenamedFileCheckerUsingTask",
ya,[]);var nb=a(94);class qa{constructor(){this.nb=this.gb=null}get name(){return"Common.App.RenameFile"}ai($a){this.gb=$a;this.nb=w.AFrameworkApplication.fa;this.gb.register(wa,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Gc(()=>new wa(w.AFrameworkApplication.wb,this.gb.aKd("Common.App.Rename.IRenameDialogFactory"))).uc();this.gb.register(Ca,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Gc(()=>new Ca(w.AFrameworkApplication.wb)).uc();
this.gb.register(243,"Common.App.Rename.IRenamedFileChecker").Gc(()=>this.C8g()).uc();this.gb.register(ea,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Gc(()=>new ea(w.AFrameworkApplication.wb,nb.FocusManager.instance())).uc()}C8g(){if(this.nb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const $a=this.gb.uh("Common.IRefreshableAppSettings");if($a&&$a.pod)return new ha(()=>$a.nd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>w.AFrameworkApplication.lm,()=>
new Date,()=>w.AFrameworkApplication.Zy,$a,this.gb.uh("Common.ISessionStatus"),()=>fa.instance,this.gb.Vb("Postmessage.IHostPostmessenger"))}return new Da(()=>this.nb.nd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.nb.nd("RenamedFileCheckerPingIntervalInMs",12E4),()=>w.AFrameworkApplication.lm,()=>new Date,()=>w.AFrameworkApplication.Zy,w.AFrameworkApplication.fa,w.AFrameworkApplication.wb,w.AFrameworkApplication.Ji,this.gb.uh("Common.ISessionStatus"),this.gb.Vb("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.nb.hv(Object(c.a)(this,
this.vB,"onFullAppSettingsReady"))}vB(){const $a=w.AFrameworkApplication.ta.Pa.Zr;w.AFrameworkApplication.i6a()&&N.instance.initialize(w.AFrameworkApplication.N7b,$a?null:w.AFrameworkApplication.P0a,$a?null:w.AFrameworkApplication.zId||CommonUIStrings.l_RenameFileTooltip)&&(this.gb.register(Z,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Gc(()=>new Z(()=>w.AFrameworkApplication.userCanRename,()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.qrc,w.AFrameworkApplication.i6a,
new b.a(()=>w.AFrameworkApplication.Zy))).uc(),fa.instance.Fg(),this.nb.qa("RenameDialogIsEnabled")&&(this.gb.resolve("Common.App.Rename.RenameDialogFactory").initialize(w.AFrameworkApplication.lm,w.AFrameworkApplication.N7b),this.gb.resolve("Common.App.Rename.IRenameDialogActor").Fg()),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").Fg(),w.AFrameworkApplication.qrc&&this.gb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").cCg())}dispose(){}}
Object(t.a)(qa,"PackageManager",null,[4,5]);var pa=a(246);a.d(D,"a",function(){return Ja});const Ja=()=>{Type.registerNamespace("Common.App.Rename");pa.a.instance.Ii(new qa,7)}},1437:function(t,D,a){a.r(D);t=a(1135);var c=a(10);D=a(0);var b=a(690),d=a(50),f=a(37),e=a(4),k=a(59),l=a(181),m=a(25),v=a(55);class n{constructor(fa){this.renameFileManager=fa}executeCommand(fa,S,ka){switch(S.command){case m.a.aha:return k.a.tg.Zr?2!==e.AFrameworkApplication.wb.ae(m.a.aha,2,ka)?v.Task.Ua(!0):l.a(S.command):
l.a(S.command);case 1897077126:return this.renameFileManager.renameFile(ka,S),v.Task.Ua(!0);default:return l.a(S.command)}}Ec(fa,S,ka,V){switch(S.command){case m.a.aha:return k.a.tg.Zr;case 1897077126:return!!V&&2===V.Vy}return!1}Vc(){return!1}Qc(){return!1}dispose(){this.renameFileManager=null}}Object(D.a)(n,"RenameFileCommandHandler",null,[188,3]);class w extends b.a{constructor(fa){super(fa)}Dd(){const fa=d.GetServiceTaskFactory.create(this.$.da,119,this.la,this.ib);f.TaskExtensions.Aa(fa,()=>
{this.ld([new n(fa.result)])},this.la,3)}static ka(fa){b.a.Rd(118,new w(fa))}}Object(D.a)(w,"RenameFileCommandHandlerFactory",b.a,[]);var r=a(86),u=a(220),x=a(224),z=a(15),B=a(29),y=a(78),A=a(376),K=a(77),G=a(368),T=a(170),W=a(90),P=a(281),E=a(1),H=a(22),F=a(280);class N{constructor(fa){this.$=fa}get Zbf(){return this.$.workbookContext.FileCoauthorable}get wyb(){return!1}get Jtb(){return this.$.ea.amIAlone}get AHe(){if(this.Jtb)return!0;for(const fa of this.$.ea.Jm)if(!fa.SupportsRename)return!1;
return!0}}Object(D.a)(N,"EwaCoauthManager",null,[163]);var J=a(62),R=a(68);class M extends y.a{constructor(fa,S){super();this.wca=this.yId=this.$Pf=this.e4c=null;this.jja=()=>{var ka=this.$.ea.to;if(ka&&ka.WorkbookFileName){var V=B.a.rq(ka.WorkbookFileName),wa=!!H.a.compare(this.$.workbookContext.WorkbookFileName,ka.WorkbookFileName,!1),ma=E.EwaSettings.ma(536)&&!!ka.BreadcrumbFolderUrl&&!!H.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,ka.BreadcrumbFolderUrl,!1);if(wa||ma)this.wca=
{},this.wca.NewFileName=V,this.wca.EditDocInClientUrl=ka.EditDocInClientUrl,this.wca.DirectInvokeDAVUrl=ka.DirectInvokeDAVUrl,this.wca.DownloadACopyUrl=ka.DownloadACopyUrl,E.EwaSettings.ma(536)&&ka.BreadcrumbFolderUrl&&(this.wca.BreadcrumbFolderName=ka.BreadcrumbFolderName,this.wca.BreadcrumbFolderUrl=ka.BreadcrumbFolderUrl),ka=e.AFrameworkApplication.wb.ae(m.a.fileNameUpdate,2,V),this.wca=null,z.ULS.shipAssertTag(537154064,0,32===ka,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.OIi=(ka,V,wa)=>{this.$Pf=V;this.yId=wa;this.$.Ka.Lb(new W.a(1897077126,K.a.Eb,2,3,null),{["newFileName"]:ka})};this.NIi=ka=>{this.wca&&ka(this.h0e(this.wca),this.Vr)};this.dEb=ka=>{P.a(ka)||!ka.Result?(ka=M.nFh(ka),R.a(this.$).fd.fJ([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.yId(ka)):this.$Pf(this.h0e(ka.Result),this.Vr)};this.uPi=()=>{this.yId(5)};this.$=fa;this.Vr=S;this.$.ea.Ou(this.jja)}initialize(){e.AFrameworkApplication.m7b=this.OIi;e.AFrameworkApplication.sIa=
this.NIi;this.e4c=e.AFrameworkApplication.Zy;e.AFrameworkApplication.Zy=new N(this.$)}dispose(){e.AFrameworkApplication.m7b=null;e.AFrameworkApplication.sIa=null;this.$.ea.Mw(this.jja);e.AFrameworkApplication.Zy=this.e4c;this.$=this.e4c=null;super.dispose()}renameFile(fa,S){const ka=fa.newFileName;if(ka){const V=this.$.pa.va.Qb();G.a(this.$.userOperationManager,(wa,ma,ab)=>{var ba=this.$.pa.va;wa=F.b(wa,this.dEb);ma=F.a(ma,this.uPi);const Ca=ba.Na(9,V);Ca.newFileName=ka;return J.g(ba,"RenameFile",
Ca,wa,ma,ab,null,0)},wa=>new T.a(134,0,wa),S)}}$ei(){return 32===e.AFrameworkApplication.wb.processAction(m.a.aha,1)}h0e(fa){var S=this.$.workbookContext;e.AFrameworkApplication.rY=fa.DownloadACopyUrl;const ka=E.EwaSettings.ma(536)&&!!fa.BreadcrumbFolderUrl;ka&&(e.AFrameworkApplication.lm.breadcrumbFolderName=fa.BreadcrumbFolderName,e.AFrameworkApplication.lm.breadcrumbFolderUrl=fa.BreadcrumbFolderUrl,S.FullDocumentInfo.BreadcrumbFolderUrl=fa.BreadcrumbFolderUrl,S.FullDocumentInfo.BreadcrumbFolderName=
fa.BreadcrumbFolderName);S.FullDocumentInfo.BreadcrumbDocName=fa.NewFileName;A.d(S,fa.NewFileName);S={};S.NewName=fa.NewFileName;S.DirectInvokeDavUrl=fa.DirectInvokeDAVUrl;S.EditDocInClientUrl=fa.EditDocInClientUrl;ka&&(S.BreadcrumbFolderName=fa.BreadcrumbFolderName,S.BreadcrumbFolderUrl=fa.BreadcrumbFolderUrl);S.OperationResult=0;return S}static nFh(fa){switch(fa.Errors[0].MessageId){case -414480287:fa=2;break;case 650565124:fa=1;break;case 1636785843:fa=6;break;case -782844485:fa=4;break;default:fa=
5}return fa}}Object(D.a)(M,"RenameFileManager",y.a,[446,3]);var L=a(51);class U extends u.a{constructor(fa){super();this.hY=this.renameFileManager=null;this.$=fa;this.Fb()}create(){if(!this.hY){const fa=x.a.a0a(L.b(),this.la,"Task","IRenameFileManager");this.hY=fa.task;const S=d.GetServiceTaskFactory.create(this.$.da,137,this.la,this.ib),ka=d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([ka,S],this.la),()=>{const V=new M(this.$,S.result);this.$.da.Ga(120,
V);fa.setResult(V)},this.la,3)}this.hY.continueWith(fa=>{this.qb(fa.result)})}dispose(){r.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(fa){fa.da.Ga(119,new U(fa))}}Object(D.a)(U,"RenameFileManagerServiceFactory",u.a,[]);class X{constructor(fa){this.$h=fa}Qc(){return!1}executeCommand(fa,S,ka){return 2!==this.$h.ae(m.a.X2f,2,ka)?v.Task.Ua(!0):l.a(S.command)}Ec(fa,S){return 1204860550===S.command}Vc(){return!1}}Object(D.a)(X,"RenameFileDialogCommandHandler",
null,[188]);class da extends b.a{constructor(fa){super(fa)}Dd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),()=>{this.ld([new X(e.AFrameworkApplication.wb)])},this.la,3)}static ka(fa){b.a.Rd(131,new da(fa))}}Object(D.a)(da,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(t.a)();(()=>{c.a.Fa(fa=>{U.ka(fa);w.ka(fa)})})();c.a.Fa(da.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/3c39e5e78507021ec3a273a6f2483ea9/EwaDSEsNext.rn.js.map