/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1138:function(t,D,a){t=a(0);var c=a(15),b=a(690),d=a(77),f=a(37);class e{constructor(gb,Ka){this.automateCommandManager=gb;this.$=Ka}Qc(){return!1}executeCommand(gb,Ka,ub){gb=f.TaskExtensions.vk();Ka=Ka.command;switch(Ka){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.xd(2045014907,-1,0,null),this.automateCommandManager.uqi(Ka,
1904816141===Ka?ub[d.a.Oc].toString():null)}return gb}Ec(gb,Ka){gb=!1;switch(Ka.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:gb=this.$.Xaa}return gb}Vc(gb,Ka,ub){return"PopulateAutomateGalleryMenu"===Ka&&this.$.Xaa?(this.automateCommandManager.Vc(Ka,ub),!0):!1}}Object(t.a)(e,"AutomateCommandHandler",null,[188]);var k=a(453);class l extends b.a{constructor(gb){super(gb)}Dd(){k.a(this.$,374,375,
this.ib,()=>{const gb=this.$.da.za(352);gb?this.ld([new e(gb,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static ka(gb){gb.da.Ga(308,new l(gb))}}Object(t.a)(l,"AutomateCommandHandlerFactory",b.a,[]);b=a(220);var m=a(7),v=a(4);class n{constructor(){this.token=null;this.timeStamp=0}}Object(t.a)(n,"AuthContext",null,[]);var w=a(719),r=a(131),u=a(110),x=a(28),z=a(809),B=a(182),y=a(69);class A{constructor(gb,Ka,ub){var ac,
Ra;this.$=gb;this.oAuthManager=Ka;this.Pu=ub;this.Dnb=new n;this.yre=null!==(Ra=null===(ac=this.oAuthManager)||void 0===ac?void 0:ac.f5a())&&void 0!==Ra?Ra:!1}getAuthContext(){return this.Dnb}Jub(){const gb=x.a.Wa.Nb,Ka=[];if(this.oAuthManager)Ka.push(Object(m.a)(new y.a,{name:"IsAuthSupported",bool:this.yre}));else return this.A7b(Ka,gb,"need_OAuthManager","No OAuthManager");if(!this.Pu.zz||!this.Pu.zz.value)return this.A7b(Ka,gb,"need_license","No License");if(v.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.A7b(Ka,
gb,"need_user","Anonymous User");if(33E5>Date.now()-this.Dnb.timeStamp)return Ka.push(Object(m.a)(new y.a,{name:"UsedCachedToken",bool:!0})),B.a(r.a.txd,!0,0,Ka),Promise.resolve(Object(m.a)(new z.a,{IsSuccess:!0,Token:this.Dnb.token}));Ka.push(Object(m.a)(new y.a,{name:"UsedCachedToken",bool:!1}));let ub=1;const ac=(Ra,na)=>(new Promise(lb=>{window.setTimeout(()=>{lb(Ra)},na)})).then(lb=>{Ka.push(Object(m.a)(new y.a,{name:"Error"+ub,string:lb.ErrorMessage}));Ka.push(Object(m.a)(new y.a,{name:"ErrorCode"+
ub,string:lb.ErrorCode}));ub++;return this.q$f()});return this.q$f().catch(Ra=>ac(Ra,200)).catch(Ra=>ac(Ra,400)).then(Ra=>{Ra.IsSuccess?(this.Dnb.token=Ra.Token,this.Dnb.timeStamp=Date.now()):(Ka.push(Object(m.a)(new y.a,{name:"Error"+ub,string:Ra.ErrorMessage})),Ka.push(Object(m.a)(new y.a,{name:"ErrorCode"+ub,string:Ra.ErrorCode})));Ka.push(Object(m.a)(new y.a,{name:"Attempts",int64:ub}));Ka.push(Object(m.a)(new y.a,{name:"Error",string:Ra.ErrorMessage}));Ka.push(Object(m.a)(new y.a,{name:"ErrorCode",
string:Ra.ErrorCode}));B.a(r.a.txd,Ra.IsSuccess,u.getElapsedMilliseconds(gb,x.a.Wa.Nb),Ka);return Promise.resolve(Ra)}).catch(Ra=>{Ka.push(Object(m.a)(new y.a,{name:"Error"+ub,string:Ra.ErrorMessage}));Ka.push(Object(m.a)(new y.a,{name:"ErrorCode"+ub,string:Ra.ErrorCode}));Ka.push(Object(m.a)(new y.a,{name:"Attempts",int64:ub}));return this.A7b(Ka,gb,Ra.ErrorCode,Ra.ErrorMessage)})}A7b(gb,Ka,ub,ac){gb.push(Object(m.a)(new y.a,{name:"Error",string:ac}));gb.push(Object(m.a)(new y.a,{name:"ErrorCode",
string:ub}));B.a(r.a.txd,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),gb);return Promise.resolve(Object(m.a)(new z.a,{IsSuccess:!1,ErrorMessage:ac,ErrorCode:ub}))}q$f(){var gb=w.a.sYh();let Ka=0;gb=this.oAuthManager.uO("Maker",gb).then(ub=>{if(ub)return!ub.IsSuccess&&this.Pwj(ub)?Promise.reject(ub):Promise.resolve(ub);ub=Object(m.a)(new z.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(ub)}).catch(ub=>{let ac=new z.a;Object.getType(ub)===Object.getType(ac)?
ac=ub:(ac.ErrorMessage=ub.toString(),ac.ErrorCode="exception");return Promise.reject(ac)});return Promise.race([gb,new Promise((ub,ac)=>{Ka=window.setTimeout(()=>{ac(Object(m.a)(new z.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(ub=>{window.clearTimeout(Ka);return ub})}Pwj(gb){return"interaction_required"===gb.ErrorCode||"InitFailed"===gb.ErrorCode||"invalid_resource"===gb.ErrorCode||"login_required"===gb.ErrorCode&&gb.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(t.a)(A,"AutomateCommandAuth",null,[697]);var K=a(810);class G{constructor(){this.j_=null}}Object(t.a)(G,"AutomateCommandGalleryBase",null,[]);var T=a(372),W=a(29),P=a(554),E=a(1381),H=a(19),F=a(54),N=a(14);a(308);var J=a(586);class R{constructor(gb,Ka){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=gb;this.currentUserMlapiToken=Ka}}Object(t.a)(R,"UserInfo",null,[]);var M=a(510),L=a(170),U=a(62),X=a(36),da=a(1),fa=a(280);const S=gb=>"TestHost"===gb.ya.DocumentHostInfo.HostTier,
ka=(gb,Ka)=>{Ka.WacTaskPaneInfra=X.a.zd(gb);Ka.TaskpanelessRFB=da.EwaSettings.getBooleanFeatureGate(w.a.z7f,!1);Ka.OfficeScriptsAutomateTask=w.a.jsf;Ka.DeferAdminCheck=w.a.Tsa;Ka.SharedScriptsButton=V()},V=()=>da.EwaSettings.getBooleanFeatureGate(w.a.Duj,!1),wa=(gb,Ka)=>{S(gb)&&(da.EwaSettings.getBooleanFeatureGate(w.a.djc,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(gb.ya.UserSessionId);makerstorage.setUserAccessInfo(new R(Ka,
null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")},ma=gb=>{if(S(gb))return da.EwaSettings.getBooleanFeatureGate(w.a.djc,!1)?"makerservicelocal":"localstorage";gb=w.a.wdd();return w.a.r1e(gb)},ab=(gb,Ka,ub,ac,Ra)=>{const na=gb.userOperationManager,lb=gb.pa;let jb=null,Yb=null,Gb=null;const wb=()=>{if(na.GGa()||0<lb.va.c3||0<lb.Ok.c3)return!1;jb&&na.Co(jb);Yb&&lb.qt(Yb);Gb&&lb.Oz(Gb);const dc=(Jc,Qc,fd)=>U.g(lb.va,"ExecuteRichApiRequest",ac,fa.b(Jc,Ka),fa.a(Qc,ub),fd,null,
0);da.EwaSettings.fc()?na.$t(new L.a(507,0,dc,80)):na.$t(new M.a(507,0,dc,16));return!0};wb()||(jb=()=>{wb()},Yb=()=>{wb()},Gb=()=>{wb()},na.Fr(jb),lb.Gr(Yb),lb.My(Gb));return Ra.task},ba=gb=>{gb=gb.pa.va.Na(1);gb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return gb},Ca=gb=>X.a.zd(gb)?gb.isChromeRtl?H.a.Xph:H.a.Wph:H.a.D1a,Na=
gb=>X.a.zd(gb)?H.a.wMe:H.a.vMe;class za{constructor(gb,Ka){this.automateCommandManager=gb;this.$=Ka}rFh(gb){const Ka=this.automateCommandManager.Sa.pq().rE();if(!V()){var ub=za.KT(gb,N.a.instance.ga(2133));this.YSc(ub,w.a.bSi,this.automateCommandManager.Pj,w.a.HDi,N.a.instance.ga(2129),this.automateCommandManager.Sa);Ka.MenuSectionList.push(ub)}ub=za.KT(gb,N.a.instance.ga(2134));this.YSc(ub,w.a.ZAi,w.a.d5?this.automateCommandManager.ot.PRe(this.automateCommandManager.Pj):this.automateCommandManager.Up.PRe(this.automateCommandManager.Pj),
w.a.Grf,N.a.instance.ga(2130),this.automateCommandManager.Sa);Ka.MenuSectionList.push(ub);ub=za.KT(gb,N.a.instance.ga(2135));this.YSc(ub,w.a.Dij,this.automateCommandManager.GB,w.a.Grf,"",this.automateCommandManager.Sa);Ka.MenuSectionList.push(ub);ub=Object(m.a)(new T.a,{Id:w.a.Une,ExternalId:w.a.Une,Command:"1606046412",LabelText:N.a.instance.ga(2126),Alt:N.a.instance.ga(2127),Image16by16:F.a.gf(16),Image16by16Class:H.a.UMe,Visible:!0});gb=za.KT(gb,null);gb.ControlsId="myScriptsSection.Controls";
if(V()){const ac=Object(m.a)(new T.a,{Id:w.a.V_f,ExternalId:w.a.V_f,Command:"1043696663",LabelText:N.a.instance.ga(2136),Alt:N.a.instance.ga(2136),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});gb.ControlList.push(ac)}gb.ControlList.push(ub);Ka.MenuSectionList.push(gb);return Ka}YSc(gb,Ka,ub,ac,Ra,na){if(ub&&0<ub.length){Ka=na.FC(Ka,1,"Size150by20").o_b();Ra={};na={};na.root=za.W_a(320,30);na.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",
lineHeight:"normal"};na.label={margin:"0px 3px"};Ra.galleryButtonInExpanded=na;Ka.GalleryStyle=Ra;for(Ra=0;Ra<ub.length&&Ra<ac;Ra++)na=ub.t3(Ra),Ka.GalleryItems.push(za.Z1c(na.id,na));gb.ControlList.push(Ka)}else ub=Object(m.a)(new J.a,{Id:Ka,ExternalId:Ka,LabelText:Ra}),gb.ControlsId=ub.Id+".Controls",gb.ControlList.push(ub)}static mEh(gb){if(gb){const Ka=String.format(w.a.Hai,gb.isShared?w.a.vLj:w.a.Yjj,F.a.gf(16));gb=String.format(w.a.Iai,W.a.Dg(gb.name));return String.format(w.a.Gai,Ka,gb)}return""}static KT(gb,
Ka){return Object(m.a)(new P.a,{Id:gb,Title:Ka,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})}static Z1c(gb,Ka){const ub=w.a.tLj,ac=w.a.Wjj,Ra=w.a.uLj,na=w.a.Xjj;return Ka?za.sCe(Ka.shareId||Ka.id,Ka.name,Ka.isShared&&!V()?ub:ac,gb,gb,Ka.isShared&&!V()?Ra:na):za.sCe("","","",gb,gb)}static sCe(gb,Ka,ub,ac=null,Ra=null,na=null){const lb={},jb={};lb.root=za.W_a(20,20);jb.root=za.W_a(20,20);return Object(m.a)(new E.a,{Id:gb,ExternalId:ac||gb,
MenuItemId:Ra||gb,Command:"1904816141",Icon:ub,Image:F.a.gf(16),ImageClass:na,LabelText:Ka,FullIconStyle:lb,PreviewIconStyle:jb,Alt:Ka})}static W_a(gb,Ka){const ub={};ub.width=gb;ub["min-width"]=gb;ub.height=Ka;return ub}}Object(t.a)(za,"AutomateCommandRenderer",null,[]);class la{constructor(gb,Ka){this.scripts=gb;this.g4f=Ka}get length(){return this.scripts.length}LJa(gb){for(let Ka=0;Ka<this.scripts.length;Ka++)if(this.scripts[Ka].id===gb||this.scripts[Ka].shareId===gb)return Ka;return-1}sort(){this.g4f(this.scripts)}Ls(gb){return-1===
this.LJa(gb.id)?(this.scripts.push(gb),!0):!1}XSc(gb){return-1===this.LJa(gb.id)?(this.scripts=[gb].concat(this.scripts),!0):!1}DAi(gb){gb=this.LJa(gb.id);if(-1!==gb){for(var Ka=this.scripts[gb].g_a();0<gb;)this.scripts[gb]=this.scripts[gb-1],gb--;this.scripts[0]=Ka}}Ceb(gb){const Ka=this.LJa(gb.id);if(-1!==Ka){const ub=this.scripts[Ka].shareId;this.scripts[Ka]=gb;this.scripts[Ka].shareId=ub}}Wdf(gb){const Ka=this.LJa(gb.id);return-1!==Ka?gb.name===this.scripts[Ka].name:!1}A0a(gb){gb=this.LJa(gb);
return-1!==gb?(this.scripts.splice(gb,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}qH(gb){gb=this.LJa(gb);return-1!==gb?this.scripts[gb]:null}t3(gb){return 0<=gb&&this.length>gb?this.scripts[gb]:null}PRe(gb){const Ka=new la([],this.g4f);for(let ub=0;ub<this.scripts.length;ub++){const ac=this.scripts[ub];gb.qH(ac.id)||Ka.Ls(ac)}return Ka}Idb(){const gb=[];for(const Ka of this.scripts)gb.push(Ka.EUd());return gb}}Object(t.a)(la,"ScriptCollection",null,[]);var aa=a(190);class sa{constructor(gb){this.a$=
aa.b(gb)||{};this.shareId=this.shareId||null}get id(){return this.a$.id}get shareId(){return this.a$.shareId}set shareId(gb){this.a$.shareId=gb||null}get name(){return this.a$.name}get HEe(){return this.a$.dateLastPublished}get body(){return this.a$.body}get description(){return this.a$.description}get cbf(){return this.a$.isCreator}get isShared(){return!!this.shareId&&0<this.shareId.length}g_a(){return new sa(this.a$)}EUd(){return this.a$}}Object(t.a)(sa,"ScriptCore",null,[]);var ea=a(41);class Z extends G{constructor(gb,
Ka){super();this.$=gb;this.Oe=Ka}Eed(gb){switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":return this.j_.t3(parseInt(gb,10)-1);default:return this.Oe.ot.qH(gb)||this.Oe.Up.qH(gb)||this.Oe.Pj.qH(gb)||this.Oe.GB.qH(gb)}}Pcd(gb,Ka){let ub=null;if(this.Oe.l4a)switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":ub=this.j_.t3(parseInt(gb,10)-1);break;default:ub=this.j_.qH(gb)}X.a.isReactRibbonEnabled()?Ka[K.a.GalleryButtonProps]=za.Z1c(gb,ub):Ka[K.a.InnerHTML]=za.mEh(ub);Ka[K.a.Alt]=
ub?ub.name:""}JN(gb){this.j_=this.IFd();this.$.pf();const Ka=[];Ka.push(Object(m.a)(new y.a,{name:"Operation",string:gb}));Ka.push(Object(m.a)(new y.a,{name:"HasReadRecentCachedScripts",bool:this.Oe.Ibc}));Ka.push(Object(m.a)(new y.a,{name:"ReadScriptsDone",bool:this.Oe.mhd}));Ka.push(Object(m.a)(new y.a,{name:"ReadSamplesScriptsDone",bool:this.Oe.uGb}));Ka.push(Object(m.a)(new y.a,{name:"SamplesScriptCount",int64:this.Oe.GB.length}));Ka.push(Object(m.a)(new y.a,{name:"ReadRecentScriptsDone",bool:this.Oe.Z$a}));
Ka.push(Object(m.a)(new y.a,{name:"RecentScriptCount",int64:this.Oe.ot.length}));Ka.push(Object(m.a)(new y.a,{name:"ReadWorkbookScriptsDone",bool:this.Oe.KV}));Ka.push(Object(m.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Oe.Pj.length}));B.a(r.a.isf,!0,0,Ka)}Egd(gb){let Ka=!1,ub="";const ac=new sa(gb.scriptMetadata),Ra={Operation:"HandleRefreshRibbonGallery"};Ra.RefreshOperation=gb.operationName;switch(gb.operationName){case w.a.DMf:({message:ub,returnValue:Ka}=this.Dgd(ac));break;case w.a.BMf:({message:ub,
returnValue:Ka}=this.Bgd(ac));break;case w.a.AMf:({message:ub,returnValue:Ka}=this.Agd(ac));break;case w.a.CMf:({message:ub,returnValue:Ka}=this.Cgd(ac));break;case w.a.u6i:({message:ub,returnValue:Ka}=this.K2h(ac))}(Ra.GalleryUpdated=Ka)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${ub}`),this.JN("RefreshGallery")):c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${ub}`);
Ra.Message=ub;c.ULS.sendTraceTag(537170320,0,50,ea.c(Ra))}IFd(){const gb=new la([],()=>{}),Ka=this.Oe.Pj?this.Oe.Pj.length:0,ub=this.Oe.ot?this.Oe.ot.length:0,ac=this.Oe.GB?this.Oe.GB.length:0;let Ra=0,na=w.a.xHf;for(let lb=0;lb<na;lb++)if(lb<Ka)gb.Ls(this.Oe.Pj.t3(lb));else if(lb-Ka+Ra<ub){const jb=this.Oe.ot.t3(lb-Ka+Ra);this.Oe.Pj.qH(jb.id)?(Ra++,lb--):gb.Ls(jb)}else lb-Ka-ub+Ra<ac&&gb.Ls(this.Oe.GB.t3(lb-Ka+Ra-ub));return gb}Dgd(gb){let Ka;if(this.Oe.ot.XSc(gb))Ka="";else{Ka="";const ub=gb.g_a();
this.Oe.Pj.Ceb(ub);this.Oe.Pj.sort();this.Oe.ot.Ceb(gb)}return{returnValue:!0,message:Ka}}Bgd(gb){this.Oe.Pj.A0a(gb.id);return this.Oe.ot.A0a(gb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}Agd(gb){const Ka=gb.g_a();Ka.shareId=null;this.Oe.ot.XSc(Ka);return this.Oe.Pj.Ls(gb)?(this.Oe.Pj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}Cgd(gb){return this.Oe.Pj.A0a(gb.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}K2h(gb){const Ka=gb.g_a();let ub=!1;this.Oe.Pj.Wdf(Ka)&&(this.Oe.Pj.Ceb(Ka),this.Oe.Pj.sort(),ub=!0);this.Oe.ot.XSc(gb)?ub=!0:this.Oe.ot.Wdf(gb)&&(this.Oe.ot.Ceb(gb),this.Oe.ot.DAi(gb),ub=!0);return{returnValue:ub,message:""}}}Object(t.a)(Z,"AutomateCommandGallery",G,[]);var ua=a(82);class ya{constructor(){this.zz=null}}Object(t.a)(ya,"AutomateCommandLicensingBase",null,[]);
class ha{constructor(gb,Ka,ub=null,ac="",Ra=""){this.value=gb;this.isSuccess=Ka;this.timeStamp=ub;this.errorCode=ac;this.errorMessage=Ra}}Object(t.a)(ha,"BoolResultWrapper",null,[]);class Da extends ya{constructor(){super()}tZc(){const gb=x.a.Wa.Nb,Ka=[];return new Promise(ub=>{ua.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ac=>{ac.isFeatureEnabled("ExcelOfficeScripting",!1).then(Ra=>{Ka.push(Object(m.a)(new y.a,{name:"IsLicensed",bool:Ra}));B.a(r.a.esf,
!0,u.getElapsedMilliseconds(gb,x.a.Wa.Nb),Ka);this.zz=new ha(Ra,!0);ub(Ra)}).catch(Ra=>{Ka.push(Object(m.a)(new y.a,{name:"IsLicensed",bool:!1}));Ka.push(Object(m.a)(new y.a,{name:"Error",string:Ra.toString()}));Ka.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"exception"}));B.a(r.a.esf,!1,u.getElapsedMilliseconds(gb,x.a.Wa.Nb),Ka);this.zz=new ha(!1,!1,void 0,"exception",Ra.toString());ub(!1)})})})}}Object(t.a)(Da,"AutomateCommandLicensing",ya,[]);var nb=a(1294),qa=a(1292),pa=a(1291),Ja=a(1293),
$a=a(1382),rb=a(27),Pa=a(171),eb=a(567),Ob=a(309),tb=a(5);class cc{constructor(gb,Ka,ub,ac){this.iid=gb;this.Gwh=Ka;this.zla=ub;this.dha=ac}}Object(t.a)(cc,"LaunchSDXParams",null,[]);class Ib{constructor(gb,Ka,ub,ac,Ra,na){this.actionName=gb;this.shapeId=Ka;this.scriptLink=ub;this.clickId=ac;this.Zaa=Ra;this.buttonText=na}}Object(t.a)(Ib,"RunfromButtonParameters",null,[]);var Mb=a(161),Oa=a(58),Aa=a(782),Ba=a(51),ob=a(46),xb=a(160);class Va{constructor(gb,Ka,ub,ac,Ra,na,lb,jb,Yb){this.HA=null;this.cache=
new Ob.a;this.hwa=!1;this.oFa={};this.$=gb;this.iOc=ub;this.indexedDB=ac;this.Inb=Ra;this.Pu=na;this.tga=lb;this.Oe=jb;this.kC=Yb;this.zMg=new za(this,gb);this.Ipg=x.a.Wa.Nb;this.F5f="";ac.If()&&(this.hwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));gb=!0;if(rb.a.cte){this.cache.If()&&!w.a.Tsa&&(Ka=this.Oe.GIh(w.a.w9b(this.$)),Ka.isSuccess&&(gb=u.getElapsedSeconds(Ka.timeStamp,x.a.Wa.Nb),this.Pu.zz=new ha(!0,!0),this.HA=new ha(Ka.value,!0),gb=this.HA.value?604800<gb:86400<gb,this.$vb=
this.rRa(!0)));this.GGh();if("undefined"!==typeof makerstorage&&this.Vgf)if(this.F5f=ma(this.$),S(this.$))wa(this.$,"localstorageToken"),this.Pu.zz=new ha(!0,!0),this.HA=new ha(!0,!0),this.$vb=this.rRa(!0);else if((Ka=w.a.wdd())&&makerstorage.setStorageEnvironmentOverride(Ka),gb||w.a.Tsa)try{this.$.bcb("automateTab",!0),this.$vb=w.a.Tsa?this.Pu.tZc().then(()=>this.tga.Jub()).then(()=>this.rRa(!1)).catch(()=>this.rRa(!1)):this.Pu.tZc().then(()=>this.tga.Jub()).then(Gb=>this.I3h(Gb)).then(()=>this.rRa(!1)).catch(()=>
this.rRa(!1))}catch(Gb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Gb.message}`),this.$vb=Promise.resolve(!1),this.$.bcb("automateTab",!1)}this.$vb?this.$vb.then(Gb=>{this.TId(Gb);this.Oe.VXh()}):this.TId(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.TId(!1)}get Up(){return this.Oe.Up}get Pj(){return V()?
new la([],()=>{}):this.Oe.Pj}get GB(){return this.Oe.GB}get ot(){return this.Oe.ot}get Sa(){return this.iOc}get l4a(){return this.Oe.l4a}get initTime(){return this.Ipg}get Zaa(){const gb=!!this.Pu.zz&&this.Pu.zz.isSuccess&&this.Pu.zz.value;var Ka=!!this.HA&&!this.HA.isSuccess;const ub=!!this.HA&&this.Pu.zz.isSuccess&&this.HA.value;Ka=w.a.Tsa||ub||Ka&&!rb.a.aka(11);return this.Vgf&&gb&&Ka}get Vgf(){const gb="TestHost"===this.$.ya.DocumentHostInfo.HostTier;var Ka=v.AFrameworkApplication.fa.Va("UserPrincipalName");
Ka=!v.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!Ka&&!Ka.includes("ext#")&&!Ka.includes("guest#");return!rb.a.Qja&&(gb||this.tga.yre&&Ka)}rRa(gb){const Ka=v.AFrameworkApplication.fa.qa("IsO365CommercialHost");let ub="",ac="",Ra=!1;var na,lb=(na=this.Pu.zz&&this.Pu.zz.isSuccess)&&this.Pu.zz.value;na=w.a.Tsa?na:!(lb&&(!this.HA||!this.HA.isSuccess));this.Pu.zz&&!this.Pu.zz.isSuccess?(ac=this.Pu.zz.errorCode,ub=this.Pu.zz.errorMessage):this.HA&&!this.HA.isSuccess&&(ac=this.HA.errorCode,ub=this.HA.errorMessage);
lb=[];lb.push(Object(m.a)(new y.a,{name:"IsScriptingEnabled",bool:this.Zaa}));lb.push(Object(m.a)(new y.a,{name:"IsValidHost",bool:Ka}));lb.push(Object(m.a)(new y.a,{name:"IsUserLicensed",bool:this.Pu.zz?this.Pu.zz.value:!1}));w.a.Tsa||lb.push(Object(m.a)(new y.a,{name:"IsAdminSwitchOn",bool:this.HA?this.HA.value:!1}));lb.push(Object(m.a)(new y.a,{name:"ShowTab",bool:this.Zaa}));w.a.Tsa||lb.push(Object(m.a)(new y.a,{name:"ServiceChecked",bool:!gb}));this.Zaa?X.a.rwa(this.$)&&(gb=Mb.a(this.$),(null===
gb||void 0===gb?0:gb.Xl)?(lb.push(Object(m.a)(new y.a,{name:"RibbonType",string:"React"})),gb.Xl.CAj(tb.a.qGb),gb.Xl.TNd(["AutomateAutomateTask"],!w.a.jsf),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Ra=!0)):(ac="ribbon_manager_error",ub="The RibbonManager or RibbonUser is null")):this.y5h();lb.push(Object(m.a)(new y.a,{name:"Error",string:ub}));lb.push(Object(m.a)(new y.a,
{name:"ErrorCode",string:ac}));B.a(r.a.uEi,na,u.getElapsedMilliseconds(this.initTime,x.a.Wa.Nb),lb);this.$.bcb("automateTab",!1);return Promise.resolve(Ra)}Vc(gb,Ka){if(!Ka)return!1;Ka.MenuItems=this.zMg.rFh(Ka.MenuId);return!0}UXi(){this.hwa&&(w.a.d5?this.Oe.eLf(this.kC).continueWith(gb=>{gb.result&&this.kC.JN(w.a.ePa)}):this.Oe.R4i(this.kC));S(this.$)?this.A0e(Object(m.a)(new z.a,{IsSuccess:!0,Token:"FakeToken"})):this.tga.Jub().then(gb=>{this.A0e(gb)})}Pcd(gb,Ka,ub){if(w.a.d5)this.kC.Pcd(gb,Ka,
ub);else{ub=null;if(this.Oe.l4a)switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":ub=this.kC.j_.t3(parseInt(gb,10)-1);break;default:ub=this.kC.j_.qH(gb)}Ka[K.a.GalleryButtonProps]=za.Z1c(gb,ub);Ka[K.a.Alt]=ub?ub.name:""}}Egd(gb){if(w.a.d5)this.kC.Egd(gb);else{let Ka=!1,ub="";const ac=new sa(gb.scriptMetadata),Ra={Operation:"HandleRefreshRibbonGallery"};Ra.RefreshOperation=gb.operationName;switch(gb.operationName){case w.a.DMf:({message:ub,returnValue:Ka}=this.Dgd(ac));break;case w.a.BMf:({message:ub,
returnValue:Ka}=this.Bgd(ac));break;case w.a.AMf:({message:ub,returnValue:Ka}=this.Agd(ac));break;case w.a.CMf:({message:ub,returnValue:Ka}=this.Cgd(ac))}(Ra.GalleryUpdated=Ka)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${ub}`),this.JN("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${ub}`);Ra.Message=ub;c.ULS.sendTraceTag(537170311,0,50,
ea.c(Ra))}}e3h(gb,Ka,ub,ac){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.oq(null,!1,1023))gb=new Ib(w.a.TTf,gb,Ka,ub,this.Zaa,ac),this.Inb.Jvb(gb)}O4e(gb,Ka,ub){gb=new Ib(w.a.JVj,gb,Ka,ub,this.Zaa);this.Inb.Jvb(gb)}M0h(gb){this.Inb.egd(w.a.PAj,gb)}L0h(gb){this.Inb.egd(w.a.O0g,gb)}N0h(gb){this.Inb.egd(w.a.TEj,gb)}uqi(gb,Ka){var ub=Ba.b().mj(gb);const ac=[];ac.push(Object(m.a)(new y.a,{name:"SessionId",string:this.$.ya.UserSessionId}));ac.push(Object(m.a)(new y.a,
{name:"MenuItemId",string:Ka}));ac.push(Object(m.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Pj.length}));ac.push(Object(m.a)(new y.a,{name:"PublishedScriptCount",int64:this.Up.length}));ac.push(Object(m.a)(new y.a,{name:"RecentScriptCount",int64:this.ot.length}));ac.push(Object(m.a)(new y.a,{name:"Command",string:ub}));Ka=this.FVh(gb,Ka);if(ub=this.$Ph(gb,ub,Ka))ac.push(Object(m.a)(new y.a,{name:w.a.L9,string:ub.zla.Ip[w.a.L9]})),nb.a.instance.zMa(ub.Gwh,"Taskpane",ub.dha,ub.iid,ub.zla),1904816141===
gb&&(ac.push(Object(m.a)(new y.a,{name:"ScriptId",string:Ka.id})),ac.push(Object(m.a)(new y.a,{name:"ShareId",string:Ka.shareId})),ac.push(Object(m.a)(new y.a,{name:"IsPreviewGallery",bool:!!this.kC.j_.qH(Ka.id)})),ac.push(Object(m.a)(new y.a,{name:"IsOwner",bool:Ka.cbf||!!this.Up.qH(Ka.id)})),this.$.pf());B.a(r.a.rEi,void 0,void 0,ac)}$Ph(gb,Ka,ub){let ac=null;const Ra=w.a.vu,na=new qa.a(w.a.r7e,w.a.gTe,w.a.locale),lb=new pa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,w.a.CLd),jb=new Ja.a;
jb.Ip.AdminPolicyForFeedback=ea.c(this.oFa);jb.Ip.DocumentHostInfo=Oa.a.Ac(this.$.ya.DocumentHostInfo);jb.Ip.CodeEditorUrl=w.a.$2a(this.$);jb.Ip.MakerTestService=da.EwaSettings.getBooleanFeatureGate(w.a.djc,!1);jb.Ip[w.a.iTf]=w.a.J2a(this.$);jb.Ip.StorageModePreference=this.F5f||"";jb.Ip.Source="Ribbon";jb.Ip[w.a.y7f]=Oa.a.Ac(Ra);jb.Ip[w.a.rse]=this.$.dsf?"true":"false";jb.Ip[w.a.L9]=Pa.a.create().toString();var Yb=Ca(this.$);const Gb=Na(this.$);jb.optionalProperties.HeaderCssClass=Yb;jb.optionalProperties.TitleCssClass=
Gb;jb.Ip[w.a.h6e]=Yb;jb.Ip[w.a.F8f]=Gb;Yb={};Yb.ribbonCommand=Ka;Yb[w.a.D5f]=this.tga.getAuthContext();Yb[w.a.F$a]=this.Oe.dLf?this.Up.Idb():null;Yb[w.a.gXj]=this.Oe.yFd?this.Pj.Idb():null;w.a.d5&&(Yb[w.a.ePa]=this.Oe.wFd?this.ot.Idb():null);jb.Ip[w.a.z$e]=Oa.a.Ac(Yb);Ka={};ka(this.$,Ka);jb.Ip[w.a.sSe]=Oa.a.Ac(Ka);switch(gb){case -45542983:jb.Ip.Script="";jb.Ip.Destination="Editor";jb.Ip.IsOwner=!0;jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2122);jb.optionalProperties[$a.a.taskPaneWidth]=Ra;jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=
w.a.$2a(this.$);ac=w.a.i1b;break;case -1342227603:jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2124);jb.optionalProperties[$a.a.taskPaneWidth]=Ra;jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.I_e(this.$);break;case 971811139:case 1606046412:jb.Ip.Script="";jb.Ip.Destination="BackStage";jb.Ip.IsOwner=!0;jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2122);jb.optionalProperties[$a.a.taskPaneWidth]=Ra;jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.$2a(this.$);ac=
w.a.i1b;break;case 1043696663:jb.Ip.Script="";jb.Ip.Destination="BackStage_Workbook";jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2122);jb.optionalProperties[$a.a.taskPaneWidth]=Ra;jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.$2a(this.$);ac=w.a.i1b;break;case 1845457202:jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2123);jb.optionalProperties[$a.a.taskPaneWidth]=Ra;jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.b0e(this.$);ac=w.a.bkj;break;case -2126202430:case 1623358083:case 1904816141:if(ub)jb.Ip.Script=
Oa.a.Ac(ub.EUd()),jb.Ip.Destination="Details",jb.Ip.IsOwner=ub.cbf||!!this.Up.qH(ub.id),jb.optionalProperties[$a.a.Zk]=N.a.instance.ga(2122),jb.optionalProperties[$a.a.taskPaneWidth]=Ra,jb.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.$2a(this.$),ac=w.a.i1b;else return null;break;default:return null}return new cc(na,lb,jb,ac)}FVh(gb,Ka){switch(gb){case -2126202430:gb=this.Oe.fMb.qH(w.a.K7f);break;case 1623358083:gb=this.Oe.fMb.qH(w.a.L7f);break;default:gb=Ka?this.Eed(Ka):null}return gb}GGh(){ua.a.instance.Vb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(gb=>
{this.oFa.FeedbackEnabled=!0;this.oFa.ScreenshotEnabled=!0;this.oFa.EmailEnabled=!0;gb.RJ("Enabled").then(Ka=>{this.oFa.FeedbackEnabled=Ka},()=>{});gb.RJ("IncludeScreenshot").then(Ka=>{this.oFa.ScreenshotEnabled=Ka},()=>{});gb.RJ("IncludeEmail").then(Ka=>{this.oFa.EmailEnabled=Ka},()=>{})})}I3h(gb){const Ka=x.a.Wa.Nb,ub=[];if(!gb||!gb.IsSuccess){const ac=gb?gb.ErrorCode:"need_token";gb=gb?gb.ErrorMessage:"No Access Token";ub.push(Object(m.a)(new y.a,{name:"ServiceChecked",bool:!1}));ub.push(Object(m.a)(new y.a,
{name:"Error",string:gb}));ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:ac}));B.a(r.a.rxd,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.HA=new ha(!1,!1,void 0,ac,gb);return Promise.resolve(!1)}ub.push(Object(m.a)(new y.a,{name:"ServiceChecked",bool:!0}));wa(this.$,gb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(ac=>{this.HA=new ha(ac.OfficeScriptingEnabled,!0);this.Oe.nSg(w.a.w9b(this.$),ac.OfficeScriptingEnabled);ub.push(Object(m.a)(new y.a,{name:"IsEnabled",
bool:this.HA.value}));B.a(r.a.rxd,!0,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);return Promise.resolve(this.HA.value)}).catch(ac=>{Object.getType(ac)===makerstorage.StorageServiceError?(ub.push(Object(m.a)(new y.a,{name:"Error",string:ac.message})),ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${ac.errorCode.toString()}_${ac.status.toString()}`}))):(ub.push(Object(m.a)(new y.a,{name:"Error",string:ac.toString()})),ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"exception"})));
B.a(r.a.rxd,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.HA=new ha(!1,!1,void 0,"exception",ac.toString());return Promise.resolve(!1)})}A0e(gb){this.Oe.zVh(this.kC);w.a.d5?this.Oe.rUh(gb,this.kC,this.cache):this.PTh(gb);V()||this.Oe.Q4i(Ka=>{this.Oe.mWh(Ka,gb,this.kC)},this.kC)}PTh(gb){const Ka=x.a.Wa.Nb,ub=[];if(gb&&gb.IsSuccess){wa(this.$,gb.Token);var ac=eb.a.create().toString();ub.push(Object(m.a)(new y.a,{name:"CorrelationId",string:ac}));makerstorage.getScripts(ac).then(Ra=>{ub.push(Object(m.a)(new y.a,
{name:"HasReadCachedScripts",bool:this.Oe.Yvb}));this.Up.clear();for(const na of Ra)this.Up.Ls(new sa(na));this.Up.sort();this.Oe.dLf=!0;this.Oe.Y$a=!0;this.hwa&&(Ra=Oa.a.Ac(this.Up.Idb()),this.indexedDB.wbb(new Aa.a(w.a.F$a,Ra)));ub.push(Object(m.a)(new y.a,{name:"ScriptCount",int64:this.Up.length}));B.a(r.a.UCb,!0,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.JN(w.a.F$a)}).catch(Ra=>{Object.getType(Ra)===makerstorage.StorageServiceError?(ub.push(Object(m.a)(new y.a,{name:"Error",string:Ra.message})),
ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${Ra.errorCode.toString()}_${Ra.status.toString()}`})),17===Ra.errorCode&&this.cache.kHd(w.a.w9b(this.$))):(ub.push(Object(m.a)(new y.a,{name:"Error",string:Ra.toString()})),ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.UCb,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.Oe.Y$a=!0;this.JN(w.a.F$a)})}else ac=gb?gb.ErrorCode:"need_token",gb=gb?gb.ErrorMessage:"No Access Token",ub.push(Object(m.a)(new y.a,
{name:"ServiceChecked",bool:!1})),ub.push(Object(m.a)(new y.a,{name:"Error",string:gb})),ub.push(Object(m.a)(new y.a,{name:"ErrorCode",string:ac})),B.a(r.a.UCb,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub),this.Oe.Y$a=!0,this.JN(w.a.F$a)}Eed(gb){if(w.a.d5)return this.kC.Eed(gb);switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":return this.kC.j_.t3(parseInt(gb,10)-1);default:return this.Up.qH(gb)||this.Pj.qH(gb)||this.GB.qH(gb)}}Dgd(gb){let Ka;if(this.Up.Ls(gb))this.Up.sort(),Ka="";
else{Ka="";const ub=gb.g_a();this.Pj.Ceb(ub);this.Pj.sort();this.Up.Ceb(gb);this.Up.sort()}return{returnValue:!0,message:Ka}}Bgd(gb){this.Pj.A0a(gb.id);return this.Up.A0a(gb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}Agd(gb){const Ka=gb.g_a();Ka.shareId=null;this.Up.Ls(Ka)&&this.Up.sort();return this.Pj.Ls(gb)?(this.Pj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}Cgd(gb){return this.Pj.A0a(gb.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}JN(gb){if(w.a.d5)this.kC.JN(gb);else{this.IFd();this.$.pf();const Ka=[];Ka.push(Object(m.a)(new y.a,{name:"Operation",string:gb}));Ka.push(Object(m.a)(new y.a,{name:"HasReadCachedScripts",bool:this.Oe.Yvb}));Ka.push(Object(m.a)(new y.a,{name:"ReadScriptsDone",bool:this.Oe.mhd}));Ka.push(Object(m.a)(new y.a,{name:"ReadSamplesScriptsDone",bool:this.Oe.uGb}));Ka.push(Object(m.a)(new y.a,
{name:"SamplesScriptCount",int64:this.GB.length}));Ka.push(Object(m.a)(new y.a,{name:"ReadPublishedScriptsDone",bool:this.Oe.Y$a}));Ka.push(Object(m.a)(new y.a,{name:"PublishedScriptCount",int64:this.Up.length}));Ka.push(Object(m.a)(new y.a,{name:"ReadWorkbookScriptsDone",bool:this.Oe.KV}));Ka.push(Object(m.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Pj.length}));B.a(r.a.isf,!0,0,Ka)}}IFd(){this.kC.j_=new la([],()=>{});const gb=this.Pj?this.Pj.length:0,Ka=this.Up?this.Up.length:0,ub=this.GB?
this.GB.length:0;let ac=0;const Ra=w.a.xHf;for(let na=0;na<Ra;na++)if(na<gb)this.kC.j_.Ls(this.Pj.t3(na));else if(na-gb+ac<Ka){const lb=this.Up.t3(na-gb+ac);this.Pj.qH(lb.id)?(ac++,na--):this.kC.j_.Ls(lb)}else na-gb-Ka+ac<ub&&this.kC.j_.Ls(this.GB.t3(na-gb+ac-Ka))}TId(gb){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(gb?(ob.PageLoadTrackingInfo.instance.k6(tb.a.RN,
["automateTab"]),ob.PageLoadTrackingInfo.instance.TV(tb.a.RN,["automateTab"]),ob.PageLoadTrackingInfo.instance.SV(tb.a.RN,["automateTab"])):ob.PageLoadTrackingInfo.instance.Jca(tb.a.RN,["automateTab"]))}y5h(){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&xb.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(tb.a.qGb))}}Object(t.a)(Va,"AutomateCommandManager",null,[696]);var bb=a(1349),ra=a(1296),Qa=a(248),qb=a(955),Wa=a(50),ta=a(104),ib=
a(21),Bb=a(957);class Ub{constructor(gb,Ka,ub,ac){this.u6a=!1;this.H8a=()=>{this.Z0f()?(this.JGf(),ib.g(this.$).Ea.FHd(this.H8a)):this.u6a&&ib.g(this.$).Ea.FHd(this.H8a)};this.vHi=(Ra,na)=>{Object.getType(na)===String&&na.toString().endsWith(w.a.bvb(this.$))&&(this.u6a=!1)};this.$=gb;this.tga=Ka;this.Pu=ub;this.businessBarManager=ac;this.Wtj()}Jvb(gb){if(gb.Zaa){const Ka=[];Ka.push(Object(m.a)(new y.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.u6a}));Ka.push(Object(m.a)(new y.a,{name:"actionName",
string:gb.actionName}));Ka.push(Object(m.a)(new y.a,{name:w.a.L9,string:gb.clickId.toString()}));this.u6a?this.iWf(gb):this.w1h(gb);B.a(r.a.sEi,void 0,void 0,Ka)}}egd(gb,Ka){const ub={};ub[w.a.L9]=Ka;this.kMd(gb,ub)}Wtj(){this.Z0f()?this.JGf():ib.g(this.$).Ea.tle(this.H8a)}Z0f(){if(this.u6a||S(this.$))return!1;const gb=ta.a(this.$);return ib.g(this.$).Ea.DYb&&gb.Hdi()}JGf(){this.Pu.zz?this.Pu.zz.value&&this.tga.Jub():this.Pu.tZc().then(gb=>{gb&&this.tga.Jub()});B.a(r.a.nEi)}hmj(){const gb=Pa.a.create().toString();
var Ka={};ka(this.$,Ka);const ub={};ub[w.a.D5f]=this.tga.getAuthContext();const ac={};ac[w.a.sSe]=Oa.a.Ac(Ka);ac[w.a.z$e]=Oa.a.Ac(ub);ac[w.a.ygh]=Oa.a.Ac(this.$.ya.DocumentHostInfo);ac[w.a.$Ej]=ma(this.$);ac[w.a.y7f]=Oa.a.Ac(w.a.vu);ac[w.a.rse]=this.$.dsf?"true":"false";ac[w.a.iTf]=w.a.J2a(this.$);ac[w.a.h6e]=Ca(this.$);ac[w.a.F8f]=Na(this.$);ac[w.a.L9]=gb;Ka=[];Ka.push(Object(m.a)(new y.a,{name:w.a.L9,string:gb}));B.a(r.a.qEi,void 0,void 0,Ka);this.kMd(w.a.m9h,ac)}w1h(gb){this.tyj(gb);S(this.$)&&
wa(this.$,"localstorage");f.TaskExtensions.Aa(Wa.GetServiceTaskFactory.Ta(this.$.da,374,375,1),Ka=>{this.dsi(Ka.result).continueWith(()=>{this.gmj(gb)});this.u6a=!0},this.$.la,3)}dsi(gb){const Ka={};Ka.SolutionId=w.a.solutionId;Ka.Version=w.a.CLd;Ka.StoreType=OSF.StoreType.Sdx;Ka.StoreId=OSF.StoreType.Sdx;Ka.AssetId=w.a.solutionId;Ka.AssetStoreId=OSF.StoreType.Sdx;Ka.TargetType=1;Ka.SharedRuntimeId=w.a.bvb(this.$);Ka.SourceLocationOverrideResourceId=w.a.bvb(this.$);Ka.IsToBePersisted=!1;const ub=
new bb.a;ub.Zk=N.a.instance.ga(2146);ub.taskPaneWidth=w.a.vu;const ac=new qb.a;ac.Hdb=Na(this.$);ac.I3=Ca(this.$);return gb.nLd(Ka,ub,void 0,void 0,ac)}gmj(gb){this.hmj();Qa.a(this.$)&&Qa.a(this.$).Ile(this.vHi);this.iWf(gb)}iWf(gb){const Ka={};Ka[w.a.nij]=gb.shapeId;Ka[w.a.mij]=gb.scriptLink;Ka[w.a.L9]=gb.clickId.toString();Ka[w.a.lij]=gb.buttonText;this.kMd(gb.actionName,Ka)}kMd(gb,Ka){const ub=new pa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,w.a.CLd),ac=new qa.a(w.a.r7e,w.a.gTe,this.$.ya.UICultureTag),
Ra=new Ja.a;Ra.optionalProperties[$a.a.Zk]=N.a.instance.ga(2146);Ra.optionalProperties[$a.a.sourceLocationOverrideResourceId]=w.a.bvb(this.$);Ra.optionalProperties[$a.a.GRc]=Ka;Ra.optionalProperties[$a.a.taskPaneWidth]=w.a.vu;nb.a.instance.zMa(ub,ra.a.action,gb,ac,Ra)}tyj(gb){da.EwaSettings.getBooleanFeatureGate(w.a.z7f,!1)&&gb.actionName===w.a.TTf&&(gb=new Bb.a(gb.scriptLink,"initializing",gb.clickId.toString(),gb.buttonText),this.businessBarManager.Ake(65,gb))}}Object(t.a)(Ub,"AutomateCommandRunFromButton",
null,[695]);var Ta=a(156),mb=a(22);class Qb{constructor(){this.ot=null;this.Yvb=this.uGb=this.KV=this.Y$a=this.yFd=this.dLf=this.wFd=this.Z$a=this.Ibc=!1;this.fMb=this.GB=this.Pj=this.Up=null}get l4a(){const gb=w.a.d5?this.Ibc:this.Yvb;return this.uGb||gb||this.mhd}get mhd(){return(w.a.d5?this.Z$a:this.Y$a)&&this.KV&&this.uGb}static HCj(gb){gb.sort((Ka,ub)=>ub.HEe-Ka.HEe)}static Lwc(gb){gb.sort((Ka,ub)=>mb.a.compare(Ka.name,ub.name,!0))}static cXh(gb){let Ka,ub;ub=Ka=null;if(gb){const ac=gb.indexOf(":");
if(-1!==ac)return Ka=gb.substr(0,ac),ub=gb.substr(ac+1),{returnValue:!0,E5f:Ka,shareId:ub}}return{returnValue:!1,E5f:Ka,shareId:ub}}static YVh(gb,Ka){const ub={};ub[w.a.Wfg]=encodeURIComponent(gb.workbookContext.WorkbookFileName);ub[w.a.qVf]=Ka.Idb();return ea.c(ub)}static hLf(gb,Ka){return f.TaskExtensions.Y9(Ka.j3a(w.a.LBc),ub=>{ub=ub.result;if(""!==ub){var ac=ea.b(ub);ub=ac[w.a.qVf];if(ac[w.a.Wfg]===encodeURIComponent(gb.workbookContext.WorkbookFileName)){ac=new la([],Ra=>{Qb.Lwc(Ra)});for(const Ra of ub)ac.Ls(new sa(Ra));
ac.sort();return ac}}},gb.la,3)}}Object(t.a)(Qb,"AutomateCommandStorageBase",null,[]);var Lb=a(121),Jb=a(99);class Ab extends Qb{constructor(gb,Ka){super();this.$=gb;this.S0a=new DOMParser;this.cache=new Ob.a;this.indexedDB=Ka;Ka.If()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.Yvb=!1;this.Up=new la([],ub=>{Qb.HCj(ub)});this.Pj=new la([],ub=>{Qb.Lwc(ub)});this.GB=new la([],ub=>{Qb.Lwc(ub)});this.ot=new la([],()=>{});this.fMb=new la([],ub=>{Qb.Lwc(ub)})}nSg(gb,Ka){if(this.cache.If()){const ub=
{};ub.TimeStamp=x.a.Wa.Nb;ub.IsEnabled=Ka;this.cache.yNd(gb,Oa.a.Ac(ub))}}GIh(gb){let Ka=!1,ub=!1,ac=null;this.cache.If()&&(gb=ea.b(this.cache.Eub(gb)))&&(ub=gb.IsEnabled,ac=new Date(gb.TimeStamp),Ka=!0);return new ha(ub,Ka,ac)}eLf(gb){const Ka=x.a.Wa.Nb,ub=[];return f.TaskExtensions.Y9(this.indexedDB.j3a(w.a.ePa),ac=>{const Ra=!this.Z$a||!this.ot.length;ac=ac.result;ub.push(Object(m.a)(new y.a,{name:"ExistingScriptCount",int64:this.ot.length}));if(""!==ac&&(ac=ea.b(ac),ub.push(Object(m.a)(new y.a,
{name:"CachedScriptCount",int64:ac.length})),Ra)){for(const na of ac)this.ot.Ls(new sa(na));this.Ibc=!0;this.wFd=0<ac.length;B.a(r.a.gsf,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.eGd(gb);return!0}B.a(r.a.gsf,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);return!1},this.$.la,3)}R4i(gb){da.EwaSettings.getBooleanFeatureGate(w.a.$Vc,!1)&&!V()&&this.X4i(gb);w.a.d5?this.eLf(gb):this.P4i(gb)}rUh(gb,Ka,ub){const ac=x.a.Wa.Nb,Ra=[];if(gb&&gb.IsSuccess){wa(this.$,gb.Token);var na=eb.a.create().toString();
Ra.push(Object(m.a)(new y.a,{name:"CorrelationId",string:na}));makerstorage.getRecentScripts(na).then(lb=>{Ra.push(Object(m.a)(new y.a,{name:"HasReadCachedScripts",bool:this.Ibc}));this.ot.clear();for(const jb of lb)this.ot.Ls(new sa(jb));this.Z$a=this.wFd=!0;this.indexedDB.If()&&(lb=Oa.a.Ac(this.ot.Idb()),this.indexedDB.wbb(new Aa.a(w.a.ePa,lb)));Ra.push(Object(m.a)(new y.a,{name:"ScriptCount",int64:this.ot.length}));B.a(r.a.UCb,!0,u.getElapsedMilliseconds(ac,x.a.Wa.Nb),Ra);Ka.JN(w.a.ePa)}).catch(lb=>
{Object.getType(lb)===makerstorage.StorageServiceError?(Ra.push(Object(m.a)(new y.a,{name:"Error",string:lb.message})),Ra.push(Object(m.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${lb.errorCode.toString()}_${lb.status.toString()}`})),17===lb.errorCode&&ub.kHd(w.a.w9b(this.$))):(Ra.push(Object(m.a)(new y.a,{name:"Error",string:lb.toString()})),Ra.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.oEi,!1,u.getElapsedMilliseconds(ac,x.a.Wa.Nb),Ra);this.Z$a=!0;Ka.JN(w.a.ePa)})}else na=
gb?gb.ErrorCode:"need_token",gb=gb?gb.ErrorMessage:"No Access Token",Ra.push(Object(m.a)(new y.a,{name:"ServiceChecked",bool:!1})),Ra.push(Object(m.a)(new y.a,{name:"Error",string:gb})),Ra.push(Object(m.a)(new y.a,{name:"ErrorCode",string:na})),B.a(r.a.UCb,!1,u.getElapsedMilliseconds(ac,x.a.Wa.Nb),Ra),this.Z$a=!0,Ka.JN(w.a.ePa)}Q4i(gb,Ka){const ub=new Ta.a,ac=ba(this.$);ab(this.$,Ra=>{if((Ra=Ra.Result)&&200===Ra.ResponseStatusCode)Ra=Ra.ResponseBody.join(""),Ra=JSON.parse(Ra),gb(this.VVi(Ra.value)),
ub.setResult(!0);else{Ra=Ra?"RichApi_"+Ra.ResponseStatusCode:"RichApiError";const na=[];na.push(Object(m.a)(new y.a,{name:"Error",string:"Failed to read shared script ids from document"}));na.push(Object(m.a)(new y.a,{name:"ErrorCode",string:Ra}));this.KV=!0;this.WZa(Ka,x.a.Wa.Nb,0,na);ub.setResult(!1)}},Ra=>{Ra=Lb.a.kf(Ra.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const na=[];na.push(Object(m.a)(new y.a,{name:"Error",string:"Failure using rich api: "+
Ra}));na.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"RichApiFailure"}));this.KV=!0;this.WZa(Ka,x.a.Wa.Nb,0,na);ub.setResult(!1)},ac,ub)}mWh(gb,Ka,ub){const ac=x.a.Wa.Nb;let Ra=0,na=0;this.KV=Ra===gb.count;const lb=[];lb.push(Object(m.a)(new y.a,{name:"ScriptIds",int64:gb.count}));if(gb.count)if(Ka&&Ka.IsSuccess){wa(this.$,Ka.Token);for(var jb of gb){const Yb=eb.a.create().toString();makerstorage.getSharedScript(jb.value,Yb).then(Gb=>{const wb=[];wb.push(Object(m.a)(new y.a,{name:"BodySize",
int64:Gb.body.length}));wb.push(Object(m.a)(new y.a,{name:"CorrelationId",string:Yb}));B.a(r.a.hsf,!0,u.getElapsedMilliseconds(ac,x.a.Wa.Nb),wb);Ra++;Gb=new sa(Gb);Gb.shareId=gb.na(Gb.id);this.Pj.Ls(Gb);this.KV=Ra===gb.count;this.yFd=!0;this.WZa(ub,ac,na,lb)}).catch(Gb=>{const wb=[];Object.getType(Gb)===makerstorage.StorageServiceError?(lb.push(Object(m.a)(new y.a,{name:"Error",string:Gb.message})),lb.push(Object(m.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${Gb.errorCode.toString()}_${Gb.status.toString()}`}))):
(wb.push(Object(m.a)(new y.a,{name:"Error",string:Gb.toString()})),wb.push(Object(m.a)(new y.a,{name:"ErrorCode",string:"exception"})));wb.push(Object(m.a)(new y.a,{name:"CorrelationId",string:Yb}));B.a(r.a.hsf,!1,u.getElapsedMilliseconds(ac,x.a.Wa.Nb),wb);Ra++;na++;this.KV=Ra===gb.count;this.WZa(ub,ac,na,lb)}).finally(()=>{if(da.EwaSettings.getBooleanFeatureGate(w.a.$Vc,!1)&&this.indexedDB.If()&&this.KV){const Gb=Qb.YVh(this.$,this.Pj);this.indexedDB.wbb(new Aa.a(w.a.LBc,Gb))}})}}else jb=Ka?Ka.ErrorCode:
"need_token",Ka=Ka?Ka.ErrorMessage:"No Access Token",lb.push(Object(m.a)(new y.a,{name:"Error",string:Ka})),lb.push(Object(m.a)(new y.a,{name:"ErrorCode",string:jb})),this.KV=!0,this.WZa(ub,ac,na,lb);else this.KV=this.yFd=!0,this.WZa(ub,ac,na,lb),da.EwaSettings.getBooleanFeatureGate(w.a.$Vc,!1)&&f.TaskExtensions.Y9(Qb.hLf(this.$,this.indexedDB),Yb=>{Yb.result&&(this.indexedDB.x4c(w.a.LBc),this.Pj.clear(),ub.JN("CachedScripts"))},this.$.la,3)}zVh(gb){const Ka={id:"samples-6"};Ka.name=N.a.instance.ga(2140);
this.GB.Ls(new sa(Ka));Ka.id="samples-8";Ka.name=N.a.instance.ga(2141);this.GB.Ls(new sa(Ka));Ka.id="samples-2";Ka.name=N.a.instance.ga(2137);this.GB.Ls(new sa(Ka));Ka.id="samples-4";Ka.name=N.a.instance.ga(2138);this.GB.Ls(new sa(Ka));Ka.id="samples-5";Ka.name=N.a.instance.ga(2139);this.GB.Ls(new sa(Ka));Ka.id="samples-9";Ka.name=N.a.instance.ga(2142);this.GB.Ls(new sa(Ka));this.uGb=!0;gb.JN("SampleScripts")}VXh(){const gb={};gb.id=w.a.K7f;gb.name=N.a.instance.ga(2143);this.fMb.Ls(new sa(gb));gb.id=
w.a.L7f;gb.name=N.a.instance.ga(2144);this.fMb.Ls(new sa(gb))}VVi(gb){const Ka=new Jb.a;if(gb=this.S0a.parseFromString(gb,"text/xml").querySelector('[id="script-ids-node-id"]')){gb=gb.getElementsByTagName("scriptId");for(let ub=0;ub<gb.length;ub++){const ac=gb[ub].getAttribute("id");if(ac){let Ra,na;({E5f:Ra,shareId:na}=Qb.cXh(ac)).returnValue&&Ka.ia(Ra,na)}}}return Ka}X4i(gb){const Ka=x.a.Wa.Nb,ub=[];f.TaskExtensions.Y9(Qb.hLf(this.$,this.indexedDB),ac=>{ac=ac.result;ub.push(Object(m.a)(new y.a,
{name:"ExistingScriptCount",int64:this.Pj.length}));if(ac){ub.push(Object(m.a)(new y.a,{name:"CachedScriptCount",int64:ac.length}));const Ra=!this.KV||0===this.Pj.length;if(Ra){for(const na of ac.getScripts())this.Pj.Ls(na);this.Pj.sort();B.a(r.a.sxd,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.eGd(gb);return!0}B.a(r.a.sxd,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub)}else B.a(r.a.sxd,!1,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);return!1},this.$.la,3)}P4i(gb){const Ka=x.a.Wa.Nb,ub=[];f.TaskExtensions.Y9(this.indexedDB.j3a(w.a.F$a),
ac=>{const Ra=!this.Y$a||!this.Up.length;ac=ac.result;ub.push(Object(m.a)(new y.a,{name:"ExistingScriptCount",int64:this.Up.length}));if(""!==ac&&(ac=ea.b(ac),ub.push(Object(m.a)(new y.a,{name:"CachedScriptCount",int64:ac.length})),Ra)){for(const na of ac)this.Up.Ls(new sa(na));this.Up.sort();B.a(r.a.fsf,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);this.eGd(gb);return!0}B.a(r.a.fsf,Ra,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ub);return!1},this.$.la,3)}WZa(gb,Ka,ub,ac){this.KV&&(ac.push(Object(m.a)(new y.a,
{name:"ScriptCount",int64:this.Pj.length})),ac.push(Object(m.a)(new y.a,{name:"ScriptErrorCount",int64:ub})),B.a(r.a.pEi,!ub,u.getElapsedMilliseconds(Ka,x.a.Wa.Nb),ac),this.Pj.sort(),gb.JN(w.a.LBc))}eGd(gb){this.Yvb=!0;gb.JN("CachedScripts")}}Object(t.a)(Ab,"AutomateCommandStorage",Qb,[]);var pb=a(695);class va extends b.a{constructor(gb){super();this.$=gb;this.Fb()}create(){const gb=Wa.GetServiceTaskFactory.Ta(this.$.da,349,350,this.ib),Ka=F.a.loadScript(132,4,this.ib,void 0,void 0,351),ub=Wa.GetServiceTaskFactory.create(this.$.da,
102,this.$.la,this.ib),ac=Wa.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ib),Ra=Wa.GetServiceTaskFactory.Ta(this.$.da,5,4,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([gb,Ka,ub,ac,Ra],this.la,3),()=>{const na=gb.result,lb=ac.result;var jb=Ra.result;const Yb=new Da,Gb=new A(this.$,na,Yb),wb=new Ab(this.$,lb),dc=new Z(this.$,wb),Jc=new Ub(this.$,Gb,Yb,jb);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?(jb=Object(pb.b)(this.$.da,352,()=>new Va(this.$,
na,ub.result,lb,Jc,Yb,Gb,wb,dc)),this.qb(jb)):this.qb(this.$.da.za(352)||new Va(this.$,na,ub.result,lb,Jc,Yb,Gb,wb,dc))},this.la,3)}static ka(gb){gb&&gb.da.Ga(351,new va(gb))}}Object(t.a)(va,"AutomateCommandManagerFactory",b.a,[]);var db=a(10);a.d(D,"a",function(){return Ya});const Ya=()=>{db.a.Fa(gb=>{l.ka(gb);va.ka(gb)})}},1177:function(t,D,a){t=a(0);var c=a(15),b=a(83),d;(function(P){P[P.generalException=0]="generalException";P[P.invalidArgument=1]="invalidArgument";P[P.notAllowed=2]="notAllowed";
P[P.apiNotAvailable=3]="apiNotAvailable";P[P.unresolvedPendingRequest=4]="unresolvedPendingRequest";P[P.timeout=5]="timeout";P[P.adalTimeout=6]="adalTimeout";P[P.userNotSignedIn=7]="userNotSignedIn";P[P.userAborted=8]="userAborted";P[P.silentSignInFailed=9]="silentSignInFailed";P[P.invalidResourceUrl=10]="invalidResourceUrl";P[P.invalidGrant=11]="invalidGrant";P[P.connectionLost=12]="connectionLost";P[P.clientError=13]="clientError";P[P.serverError=14]="serverError"})(d||(d={}));Object(t.b)("ErrorCodes",
d);a(1290);class f{constructor(P,E){this.requestCallback=this.requestParameters=null;this.requestParameters=P;this.requestCallback=E}}Object(t.a)(f,"OutstandingRequest",null,[]);class e{}e.ACi="AADSTS50058";e.invalidResourceUrl="AADSTS50001";e.vCi="AADSTS65001";e.KCi="AADSTS70011";e.userAborted="13002";e.IYi="Popup Window is null";e.HYi="Popup Window closed";e.adalTimeout="Token renewal operation failed due to timeout";e.ZJj="tokenRevoked";Object(t.a)(e,"WopiHostErrorType",null,[]);var k=a(4),l=a(728),
m=a(567),v=a(41),n=a(1289);class w{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(w,"WopiIdentityInfo",null,[469]);class r{constructor(P,E,H){this.expiration=this.authority=this.accessToken=null;this.accessToken=P;this.authority=E;this.expiration=H}}Object(t.a)(r,"WopiIdentityToken",null,[468]);var u=a(27),x=a(146),z=a(370),B=a(163),y=a(69),A=a(339);class K{constructor(P){this._initialized=!1;this.L9a={};this.nxc={};this.iO=
k.AFrameworkApplication.ta.LD;this.hid=P}n1a(P){this._initialized||(P.fo(B.a.vGf),P.Vl(B.a.vGf,Object(b.a)(this,this.nPi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(P,E,H=null){this.UMa(P,E);return new Promise((F,N)=>{if(this.Mkd(E))if(E in this.L9a)N("unresolvedPendingRequest");else{var J=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,v.c({["error"]:"Request timeout.",["callerId"]:E}));N("timeout")},12E4);this.Uad(P,E,H,(R,M)=>{window.clearTimeout(J);R?F(R):(c.ULS.sendTraceTag(37856033,
369,15,v.c({["error"]:d[M]})),N(M))})}else c.ULS.sendTraceTag(37856034,344,10,v.c({["error"]:"Caller is not allowed."})),N("notAllowed")})}getPrimaryIdentityInfo(P){return new Promise((E,H)=>{this.Mkd(P)?this.wTh((F,N)=>{F?E(F):(c.ULS.sendTraceTag(37856064,369,10,v.c({["error"]:N.toString()})),H(N))}):(c.ULS.sendTraceTag(37856065,344,10,v.c({["error"]:"Caller is not allowed."})),H("notAllowed"))})}getAuthContext(P){return new Promise((E,H)=>{const F=this.getAuthContextSync(P);F?E(F):H("notAllowed")})}getAuthContextSync(P){if(this.Mkd(P)){const E=
new n.a;E.upn=k.AFrameworkApplication.fa.Va("UserPrincipalName");E.userId=k.AFrameworkApplication.fa.Va("LoggableUserId");E.authority=k.AFrameworkApplication.fa.Va("HostAuthAuthority");E.tenantId=k.AFrameworkApplication.fa.Va("TenantId");E.isAnonymous=k.AFrameworkApplication.fa.qa("IsAnonymousUser");E.supportsAuthToken=this.n6h(P);P=k.AFrameworkApplication.fa.Va("HostAuthType");E.authorityType="aad"===P.toLowerCase()?2:"msa"===P.toLowerCase()?1:0;return E}c.ULS.sendTraceTag(40751647,344,10,v.c({["error"]:"Caller is not allowed."}));
return null}n6h(P){const E=l.a.Bwb;return u.a.Bwa?E&&l.a.D7f?Array.contains(l.a.D7f,P.toLowerCase()):!1:E}Uad(P,E,H,F){var N=[];Array.add(N,Object.assign(new y.a,{name:"CallerId",string:E}));Array.add(N,Object.assign(new y.a,{name:z.a.eSd,string:P.correlationId}));x.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:N}));N=m.a.create().toString();const J="getAccessToken_"+N,R=this.iO.xc("ComponentAttach",J);this.nxc[J]=R;const M=
{};M[z.a.fSd]=N;M[z.a.pDj]=P.resource;M[z.a.qDj]=P.scope;M[z.a.x4f]=k.AFrameworkApplication.fa.Va("HostAuthType");M[z.a.tDj]=k.AFrameworkApplication.fa.Va("UserPrincipalName");M[z.a.rDj]=P.silentLogin;M[z.a.mDj]=P.options;M[z.a.eSd]=P.correlationId;M[z.a.nDj]=E;H&&(M[z.a.addinName]=H.AddinName,M[z.a.lDj]=H.AddinTrustId);this.hid.execute(L=>{this.n1a(L);L.Fj(B.a.getAuthToken,M)});this.L9a[N]=new f(P,F)}wTh(P){const E=k.AFrameworkApplication.fa.Va("UserName"),H=k.AFrameworkApplication.fa.Va("UserPrincipalName"),
F=k.AFrameworkApplication.fa.Va("LoggableUserIdSpace"),N=new w;N.email=H;N.displayName=E;switch(F){case "OrgIdPuid":N.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":N.authority="MicrosoftAccount";break;default:N.authority=F}P(N,null)}nPi(P){let E=null;try{let F=P.Values[z.a.fSd];const N=P.Values[z.a.kDj],J=P.Values[z.a.x4f],R=P.Values[z.a.sDj];let M=null,L=null;const U=this.L9a[F];if("undefined"!==typeof U&&U){var H=[];Array.add(H,Object.assign(new y.a,{name:z.a.eSd,string:U.requestParameters.correlationId}));
x.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:H}));E=U.requestCallback;delete this.L9a[F];"undefined"!==typeof N&&N&&N.length?L=new r(N,J,R):M=d[this.Exi(P)];H="getAccessToken_"+F;H in this.nxc&&(this.nxc[H].stop(),delete this.nxc[H]);E(L,M)}else c.ULS.sendTraceTag(37856066,344,10,v.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:F}))}catch(F){P=P.Values[z.a.fSd],P in this.L9a&&delete this.L9a[P],
this.qic(),c.ULS.sendTraceTag(37856067,344,10,v.c({["error"]:F.message,["stack"]:F.stack})),E&&E(null,"generalException")}}Mkd(P){var E=k.AFrameworkApplication.C_h();P=P.toLowerCase();for(const H of E)if(P===H.toLowerCase())return!0;E=l.a.KUc;for(let H in E)if(P===E[H].toLowerCase())return!0;return!1}Exi(P){P=P.Values[z.a.oDj];this.qic();c.ULS.sendTraceTag(39068821,344,15,v.c({["error"]:P}));return P?-1<P.indexOf(e.ACi)?9:-1<P.indexOf(e.IYi)||-1<P.indexOf(e.HYi)?12:-1<P.indexOf(e.invalidResourceUrl)?
10:-1<P.indexOf(e.userAborted)?8:-1<P.indexOf(e.KCi)||-1<P.indexOf(e.vCi)||P===e.ZJj?11:-1<P.indexOf(e.adalTimeout)?6:0:13}UMa(P,E){P=this.e6i(P.resource);c.ULS.sendTraceTag(39921882,344,50,v.c({["callerId"]:E,["resource"]:P}))}qic(){c.ULS.sendTraceTag(39068822,344,50,v.c({["userAgent"]:window.navigator.userAgent}))}e6i(P){return(P?P:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(K,"WopiIdentityManager",null,[441]);var G=a(246);class T{constructor(){this.gb=
null}get name(){return"Common.App.WopiIdentity"}ai(P){this.gb=P;P.register(K,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").uc().Gc(()=>new K(P.Vb("Postmessage.IHostPostmessenger")))}init(){k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.hv(Object(b.a)(this,this.vB,"onFullAppSettingsReady"))}vB(){try{this.gb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(P){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+
P)}}dispose(){}static main(){G.a.instance.Ii(new T)}}Object(t.a)(T,"WopiIdentityPackage",null,[4,5]);a.d(D,"a",function(){return W});const W=()=>{Type.registerNamespace("Common.App.WopiIdentity");T.main()}},1183:function(t,D,a){a.r(D);t=a(0);var c=a(7),b=a(15),d=a(4),f=a(156),e=a(184),k=a(84),l=a(510),m=a(170),v=a(62),n=a(50),w=a(37),r=a(224),u=a(121),x=a(523);class z{constructor(za){za=za.split("|");this.ex=za[1];this.FPc=za[2];this.RSd=za[3]}get solutionId(){return this.ex}get solutionVersion(){return this.FPc}get needToRestoreManifest(){return this.RSd===
OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(z,"AddinStoreInfo",null,[]);class B{}Object(t.a)(B,"CustomFunctionRegistrationInfos",null,[]);var y=a(193),A=a(63);const K=(za,la,aa)=>G(za,la,y.a.none,A.a.current,aa),G=(za,la,aa,sa,ea)=>{aa=za.continueWith(()=>{la(za)},3,aa,sa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ea)},4);return aa},T=(za,la,aa)=>W(za,la,y.a.none,A.a.current,aa),W=(za,la,aa,sa,ea)=>{aa=za.So(()=>la(za),3,aa,sa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163462,
0,10,ea)},4);return w.TaskExtensions.Dzc(aa)},P=(za,la,aa)=>E(za,la,y.a.none,A.a.current,aa),E=(za,la,aa,sa,ea)=>{aa=za.So(()=>la(za),3,aa,sa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ea)},4);return aa},H=(za,la,aa)=>F(za,la,y.a.none,A.a.current,aa),F=(za,la,aa,sa,ea)=>{aa=za.So(()=>la(za),3,aa,sa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ea)},4);return w.TaskExtensions.Dzc(aa)},N=(za,la,aa)=>J(za,la,y.a.none,A.a.current,aa),J=(za,la,aa,sa,ea)=>{aa=za.continueWith(()=>
{la(za)},3,aa,sa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ea)},4);return aa},R=(za,la)=>{P(a(1183).CustomFunctionsInstaller.eZe("CustomFunctionsRuntimeLogging"),aa=>{if(aa.result&&window.console)switch(aa=M(za.severity)+" "+za.message+la,za.severity){case 2:window.console.log&&window.console.log(aa);break;case 0:window.console.info&&window.console.info(aa);break;case 1:window.console.error&&window.console.error(aa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},
M=za=>{switch(za){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var L=a(958);class U{}Object(t.a)(U,"InstallationInfo",null,[]);class X{}Object(t.a)(X,"UninstallationInfo",null,[]);var da=a(28),fa=a(90),S=a(34),ka=a(31),V=a(1),wa=a(22),ma=a(280),ab=a(782),ba=a(55);class Ca{constructor(za,la){this.bPc=za;this._message=la}get severity(){return this.bPc}get message(){return this._message}}Object(t.a)(Ca,"CustomFunctionLog",null,[]);a.d(D,"CustomFunctionsInstaller",
function(){return Na});class Na{constructor(za,la,aa){this.hwa=!1;this.lF={};this.$=za;this.oj=la;this.lkd().uma();this.indexedDB=aa;this.indexedDB.If()&&(this.hwa=!0,this.indexedDB.initialize(Na.rjd,Na.sjd))}get QU(){return this.oj.QU}$9e(za,la,aa,sa){if(sa.invariantNamespace)for(let ea=0;ea<sa.invariantNamespace.length;++ea){const Z=sa.invariantNamespace.charAt(ea);if("."!==Z&&"_"!==Z&&"a">Z&&"z"<Z&&"A">Z&&"Z"<Z&&"0">Z&&"9"<Z)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Z}', Position=${ea}.`),
Error.create("InvariantNamespace validation failed");}return T(this.tSg(aa,sa.manifest),()=>T(this.tFd(za),ea=>{let Z=ea.result;return(null===Z||void 0===Z?0:Z.isDynamicMetadata)?this.xGd(za,la,Z,!1,!1,!1):T(this.uXj(za,la,sa),ua=>{let ya;Z=(ya=new U,ya.addinId=aa,ya.locale=sa.locale,ya.addinInvariantNamespace=sa.invariantNamespace,ya.addinNamespace=sa.namespace,ya.addinTitle=sa.title,ya.isXllCompatible=sa.isXllCompatible,ya.metadataContent=JSON.stringify(JSON.parse(ua.result)),ya);return this.xGd(za,
la,Z,!1,Na.mxh(sa.osfControl.getStoreType()),L.a(this.$,sa))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}b$e(za,la,aa,sa){if(!Na.Opd(aa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return T(this.tFd(za),ea=>{ea=ea.result;if(!ea&&(ea=S.a.Cc(this.QU,za),!ea))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,la,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ea.metadataContent=JSON.stringify(JSON.parse(aa));ea.isDynamicMetadata=!0;return this.xGd(za,la,ea,!0,!0,sa)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}pag(za,
la){this.oj.Lha();const aa=Object(c.a)(new X,{solutionId:za}),sa=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,la,null)}.`;return T(this.iHd(za),()=>T(this.pHd(za),()=>this.FWd(this.oj,za,la,aa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),sa)}uXj(za,la,aa){const sa=new f.a;OSF.OUtil.xhrGet(aa.metadataUrl,ea=>{ea?sa.setResult(ea):sa.setException(Error.create("Invalid manifest"))},
ea=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,la,null)}. ErrorCode: ${ea}.`);sa.setException(Error.create("Failed to download manifest"))});return sa.task}lkd(){return T(this.Epc(),za=>{const la=za.result;if(!la.length)return ba.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");
za=new e.a;const aa=[];for(let sa=0;sa<la.length;sa++){const ea=Object(k.a)(String,la[sa]);za.add(P(this.tFd(ea),Z=>{if(Z=Z.result){const ua=S.a.Cc(this.lF,Z.addinId);ua&&ua===Z.metadataContent||(this.lF[Z.addinId]=Z.metadataContent,this.QU[ea]=Z,aa.push(Z))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return H(ba.Task.WhenAllEnumerable(za),()=>{if(aa.length){let sa;const ea=(sa=new B,sa.registrationInfos=aa,sa);return this.RZb(this.oj,
la,ea)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ba.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}c$e(){var za=new f.a;new e.a;const la=[],aa=[];Object.keys(this.QU).forEach(sa=>{sa=Object(k.a)(String,sa);const ea=S.a.Cc(this.QU,sa);la.push(ea);aa.push(sa)});if(!aa.length)return za.setResult(!0),
za.task;za=Object(c.a)(new B,{registrationInfos:la});return this.RZb(this.oj,aa,za)}Epc(){return P(this.udd(x.a.aYa),za=>{za=za.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(za||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(za||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}bgg(za){return this.ENd(x.a.aYa,Sys.Serialization.JavaScriptSerializer.serialize(za))}tFd(za){return T(this.udd(x.a.p3a(za)),
la=>{la=la.result||"";return 0<la.length?ba.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(la,!0)):ba.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}mXj(za,la){return T(this.aKe(za),()=>T(this.ENd(x.a.p3a(za),Sys.Serialization.JavaScriptSerializer.serialize(la)),()=>Na.FNd(x.a.$gd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}iHd(za){return T(this.KNf(za),
()=>T(this.cOf(x.a.p3a(za)),()=>T(this.Epc(),la=>la.result.length?ba.Task.Ua(!0):Na.FNd(x.a.$gd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}bLf(za){return this.udd(x.a.o3a(za))}Zfg(za,la){return T(this.aKe(za),
()=>this.ENd(x.a.o3a(za),la),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}pHd(za){return T(this.KNf(za),()=>this.cOf(x.a.o3a(za)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}aKe(za){return T(this.Epc(),la=>{la=la.result;const aa=za.toLowerCase();if(la.includes(aa))return ba.Task.Ua(!0);la.push(aa);return this.bgg(la)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}KNf(za){return T(this.Epc(),
la=>{la=la.result;const aa=za.toLowerCase();return la.includes(aa)?(la.splice(Array.indexOf(la,aa),1),this.bgg(la)):ba.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}tSg(za,la){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return za=new OSF.AddinIdInfo(za),za.needToRestoreManifest()?this.Zfg(za.getSolutionId(),la):ba.Task.Ua(!0);za=new z(za);return za.needToRestoreManifest?this.Zfg(za.solutionId,
la):ba.Task.Ua(!0)}xgj(za){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const aa=new OSF.AddinIdInfo(za);return aa.needToRestoreManifest()?P(this.bLf(aa.getSolutionId()),sa=>{(sa=sa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(aa.getSolutionId(),aa.getSolutionVersion(),sa,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ba.Task.Ua(!0)}const la=new z(za);return la.needToRestoreManifest?
P(this.bLf(la.solutionId),aa=>{(aa=aa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(la.solutionId,la.solutionVersion,aa,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ba.Task.Ua(!0)}cOf(za){return this.hwa?this.indexedDB.x4c(za):Na.R9i(za)}ENd(za,la){return this.hwa?this.indexedDB.wbb(new ab.a(za,la)):Na.FNd(za,la)}udd(za){return this.hwa?this.indexedDB.j3a(za):Na.eZe(za)}xGd(za,la,aa,sa,ea,Z){const ua=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,
la,null)}.`;return w.TaskExtensions.Dzc(P(this.yGd(this.oj,za,la,aa,!1,sa,Z),()=>ea?this.mXj(za,aa):ba.Task.Ua(!0),ua))}yGd(za,la,aa,sa,ea,Z,ua){if(!Z&&(Z=S.a.Cc(this.lF,sa.addinId))&&Z===sa.metadataContent)return ba.Task.Ua(!0);this.lF[sa.addinId]=sa.metadataContent;this.QU[la]=sa;ua||za.bHb(la);za.Lha();return T(this.n7i(la,aa,sa),()=>this.bEd(sa.addinId,ea),"Failed to register functions for customfunction addin")}n7i(za,la,aa){const sa=new f.a,ea=this.iob(aa);return this.Uha(Z=>{V.EwaSettings.ma(256)&&
R(Na.Tqb,za);(Z=Z.Result)&&204===Z.ResponseStatusCode?sa.setResult(!0):(delete this.lF[aa.addinId],delete this.QU[za],K(this.iHd(za),()=>{K(this.pHd(za),()=>{this.$1f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${za}. Received status code ${Z?Z.ResponseStatusCode.toString():"Unknown"}.`),sa.setResult(!1))},Z=>{Z=u.a.kf(Z.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,
la,null)}. Errors: ${ka.a.zc(Z)}.`);V.EwaSettings.ma(256)&&R(Na.Sqb,za);delete this.lF[aa.addinId];delete this.QU[za];sa.setResult(!1)},ea,sa,!0)}RZb(za,la,aa){const sa=new f.a,ea=da.a.Wa.je.m;la.forEach(ua=>{ua=Object(k.a)(String,ua);za.xwe(ua)});za.Lha();const Z=this.$Wc(aa);return this.Uha(ua=>{V.EwaSettings.ma(256)&&R(Na.Tqb,Sys.Serialization.JavaScriptSerializer.serialize(la));ua=ua.Result;let ya=!0;var ha=Sys.Serialization.JavaScriptSerializer.deserialize(ua.ResponseBody.toString());ha=Array.isArray(ha.value)?
ha.value:null;const Da=new e.a;for(let nb=0;nb<ha.length;nb++)if(!ha[nb]){ya=!1;const qa=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ua.ResponseStatusCode}.`;Da.add(T(this.iHd(la[nb]),()=>{delete this.lF[aa.registrationInfos[nb].addinId];delete this.QU[la[nb]];return this.pHd(la[nb])},qa))}N(ba.Task.WhenAllEnumerable(Da),()=>{K(this.bEd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${da.a.Wa.je.m-
ea} Millisecond.`);ya?sa.setResult(ya):N(this.$1f(),()=>{sa.setResult(ya)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ua=>{ua=u.a.kf(ua.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${ka.a.zc(ua)}.`);
V.EwaSettings.ma(256)&&R(Na.Sqb,Sys.Serialization.JavaScriptSerializer.serialize(la));for(ua=0;ua<aa.registrationInfos.length;ua++)delete this.lF[aa.registrationInfos[ua].addinId],delete this.QU[la[ua]];sa.setResult(!1)},Z,sa,!0)}FWd(za,la,aa,sa){return T(this.zOj(za,la,aa,sa),()=>this.bEd(sa.solutionId,!1),"Failed to unregister functions for customfunction addin")}zOj(za,la,aa,sa){const ea=new f.a;za.bHb(la);(za=S.a.Cc(this.QU,la))&&delete this.lF[za.addinId];delete this.QU[la];sa=this.mXc(sa);return this.Uha(()=>
{V.EwaSettings.ma(256)&&R(Na.t3c,la);ea.setResult(!0)},Z=>{Z=u.a.kf(Z.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(la,aa,null)}. Errors: ${ka.a.zc(Z)}.`);V.EwaSettings.ma(256)&&R(Na.s3c,la);ea.setResult(!1)},sa,ea,!1)}Uha(za,la,aa,sa,ea){const Z=this.$.userOperationManager,ua=this.$.pa;let ya=null,ha=null,Da=null;const nb=()=>{if(Z.GGa()||0<ua.va.c3||
0<ua.Ok.c3)return!1;ya&&Z.Co(ya);ha&&ua.qt(ha);Da&&ua.Oz(Da);const qa=aa.request,pa=($a,rb,Pa)=>{V.EwaSettings.ma(256)&&R(ea?Na.r3c:Na.u3c,qa.RequestBody);return v.g(ua.va,"ExecuteRichApiRequest",aa,ma.b($a,za),ma.a(rb,la),Pa,null,0)};let Ja=0;V.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?qa.RequestFlags&1&&256!==(qa.RequestFlags&256)||(Ja=16):Ja=qa.RequestFlags&1?0:16;V.EwaSettings.fc()?Z.$t(new m.a(507,0,pa,Ja|64)):Z.$t(new l.a(507,0,pa,Ja));return!0};nb()||
(ya=()=>{nb()},ha=()=>{nb()},Da=()=>{nb()},Z.Fr(ya),ua.Gr(ha),ua.My(Da));return sa.task}iob(za){const la={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};la.RequestBody=JSON.stringify(za);la.RequestFlags=1;V.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(la.RequestFlags|=256);za=this.$.pa.va.Na(1);za.request=la;return za}$Wc(za){const la={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};la.RequestBody=
JSON.stringify(za);la.RequestFlags=1;V.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(la.RequestFlags|=256);za=this.$.pa.va.Na(1);za.request=la;return za}mXc(za){const la={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};la.RequestBody=JSON.stringify(za);la.RequestFlags=1;V.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(la.RequestFlags|=256);za=this.$.pa.va.Na(1);za.request=la;return za}bEd(za,
la){const aa=n.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return W(aa,()=>{aa.result.AJd();return za&&la?this.xgj(za):ba.Task.Ua(!0)},this.$.la,r.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}$1f(){const za=new fa.a(1949669462,0,this.$.Mc,0,null);return this.$.Ka.Lb(za)}static eZe(za){try{return ba.Task.Ua(localStorage.getItem(za))}catch(la){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${la.message||
"Unknown"}`),ba.Task.Ua(null)}}static FNd(za,la){try{return localStorage.setItem(za,la),ba.Task.Ua(!0)}catch(aa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${aa.message||"Unknown"}`),ba.Task.Ua(!1)}}static R9i(za){try{return localStorage.removeItem(za),ba.Task.Ua(!0)}catch(la){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${la.message||
"Unknown"}`),ba.Task.Ua(!1)}}static mxh(za){return wa.a.equals(za,"registry",!0)||wa.a.equals(za,"uploadfiledevcatalog",!0)||d.AFrameworkApplication.userNameUnknown||d.AFrameworkApplication.limitedEdit}static Opd(za){if(!za)return!1;try{JSON.parse(za)}catch(la){return!1}return!0}}Na.rjd="CustomFunctionCache";Na.sjd="CustomFunction";Na.r3c=new Ca(2,"CustomFunctions [Registration] [Begin] SolutionId=");Na.Tqb=new Ca(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Na.Sqb=new Ca(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Na.u3c=new Ca(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Na.t3c=new Ca(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Na.s3c=new Ca(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(Na,"CustomFunctionsInstaller",null,[746])},1187:function(t,D,a){a.r(D);t=a(0);var c=a(7),b=a(15),d=a(931),f=a(156),e=a(84),k=a(510),l=a(170),m=a(62),v=a(50),n=a(37),w=a(121),r=a(523),u=a(958);class x{constructor(M){M=M.split("|");this.ex=M[1];this.FPc=M[2];
this.RSd=M[3]}get solutionId(){return this.ex}get solutionVersion(){return this.FPc}get needToRestoreManifest(){return this.RSd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(x,"AddinStoreInfo",null,[]);class z{}Object(t.a)(z,"CustomFunctionRegistrationInfos",null,[]);const B=(M,L)=>{if(a(1187).CustomFunctionsLegacyInstaller.Iub("CustomFunctionsRuntimeLogging")&&window.console)switch(L=y(M.severity)+" "+M.message+L,M.severity){case 2:window.console.log&&window.console.log(L);break;case 0:window.console.info&&
window.console.info(L);break;case 1:window.console.error&&window.console.error(L)}},y=M=>{switch(M){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(t.a)(A,"InstallationInfo",null,[]);class K{}Object(t.a)(K,"UninstallationInfo",null,[]);var G=a(152),T=a(34),W=a(31),P=a(1),E=a(14),H=a(280),F=a(860),N=a(55);class J{constructor(M,L){this.bPc=M;this._message=L}get severity(){return this.bPc}get message(){return this._message}}Object(t.a)(J,"CustomFunctionLog",
null,[]);a.d(D,"CustomFunctionsLegacyInstaller",function(){return R});class R{constructor(M){this.lF={};this.$=M;this.lkd().uma()}$9e(M,L,U,X){const da=new f.a;if(X.invariantNamespace)for(L=0;L<X.invariantNamespace.length;++L){const S=X.invariantNamespace.charAt(L);if("."!==S&&"_"!==S&&"a">S&&"z"<S&&"A">S&&"Z"<S&&"0">S&&"9"<S)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${S}', Position=${L}.`),da.setResult(!1),
da.task}R.cacheManifest(U,X.manifest);let fa=R.uFd(M);(null===fa||void 0===fa?0:fa.isDynamicMetadata)?this.wGd(M,fa,da,!1,!1):OSF.OUtil.xhrGet(X.metadataUrl,S=>{fa=Object(c.a)(new A,{addinId:U,locale:X.locale,addinInvariantNamespace:X.invariantNamespace,addinNamespace:X.namespace,addinTitle:X.title,isXllCompatible:X.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(S))});this.wGd(M,fa,da,!1,u.a(this.$,X))},S=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${M}. ErrorCode: ${S}.`);
da.setResult(!1)});return da.task}b$e(M,L,U,X){L=new f.a;if(!R.Opd(U))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),L.setResult(!1),L.task;const da=R.uFd(M);if(!da)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),L.setResult(!1),L.task;da.metadataContent=JSON.stringify(JSON.parse(U));da.isDynamicMetadata=
!0;this.wGd(M,da,L,!0,X);return L.task}pag(M){const L=new f.a,U=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(U,()=>{const X=U.result;X.Lha();const da=Object(c.a)(new K,{solutionId:M});R.jHd(M);R.qHd(M);n.TaskExtensions.Aa(this.FWd(X,M,da),fa=>{G.b(fa)?L.setResult(fa.result):(fa.Sf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${M}.`):fa.Bh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${M}.`),
L.setResult(!1))},this.$.la,0)},this.$.la,3);return L.task}lkd(){const M=new f.a,L=R.zFd();0<L.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const U=[];L.forEach(da=>{da=Object(e.a)(String,da);if(da=R.uFd(da)){const fa=T.a.Cc(this.lF,da.addinId);fa&&fa===da.metadataContent||(this.lF[da.addinId]=da.metadataContent,U.push(da))}});if(!U.length)return M.setResult(!0),b.ULS.sendTraceTag(537163521,0,
50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),M.task;const X=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(X,()=>{const da=X.result,fa=Object(c.a)(new z,{registrationInfos:U});n.TaskExtensions.Aa(this.RZb(da,L,fa),S=>{G.b(S)?M.setResult(S.result):(S.Sf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):S.Bh&&b.ULS.sendTraceTag(537163490,
0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),M.setResult(!1))},this.$.la,0)},this.$.la,3);return M.task}wgj(M){M=new x(M);if(M.needToRestoreManifest){const L=R.J4i(M.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(M.solutionId,M.solutionVersion,L,this.$.ya.UICultureTag)}}wGd(M,L,U,X,da){const fa=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(fa,()=>{n.TaskExtensions.Aa(this.yGd(fa.result,M,L,!1,X,da),
S=>{G.b(S)?((S=S.result)&&R.nXj(M,L),U.setResult(S)):(S.Sf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${M}.`):S.Bh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${M}.`),U.setResult(!1))},this.$.la,0)},this.$.la,3)}yGd(M,L,U,X,da,fa){if(!da&&(da=T.a.Cc(this.lF,U.addinId))&&da===U.metadataContent)return N.Task.Ua(!0);this.lF[U.addinId]=
U.metadataContent;const S=new f.a;fa||M.bHb(L);M.Lha();M=this.iob(U);return this.Uha(ka=>{P.EwaSettings.ma(256)&&B(R.Tqb,L);const V=ka.Result;204===V.ResponseStatusCode?n.TaskExtensions.Aa(this.aEd(S,U.addinId,X),wa=>{wa.Sf?L?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${U.addinId}.`):
wa.Bh&&(L?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${L}.`):b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${U.addinId}.`));S.setResult(!1)},this.$.la,4):(ka=()=>{delete this.lF[U.addinId];R.jHd(L);R.qHd(L);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${L}. Received status code ${V.ResponseStatusCode}.`);
S.setResult(!1)},ka=Object(c.a)(new F.a,{NKa:OSF.InfoType.Error,title:U.addinTitle,description:String.format(E.a.instance.mb(153),E.a.instance.ga(1884)),buttonText:E.a.instance.ga(4),Gga:ka,jcc:!1,yha:ka,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),d.a.nQd(ka))},ka=>{ka=w.a.kf(ka.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}. Errors: ${W.a.zc(ka)}.`);P.EwaSettings.ma(256)&&
B(R.Sqb,L);delete this.lF[U.addinId];S.setResult(!1)},M,S,!0)}RZb(M,L,U){const X=new f.a;L.forEach(fa=>{fa=Object(e.a)(String,fa);M.xwe(fa)});M.Lha();const da=this.$Wc(U);return this.Uha(fa=>{P.EwaSettings.ma(256)&&B(R.Tqb,Sys.Serialization.JavaScriptSerializer.serialize(L));fa=fa.Result;let S=!0;var ka=Sys.Serialization.JavaScriptSerializer.deserialize(fa.ResponseBody.toString());ka=Array.isArray(ka.value)?ka.value:null;for(let V=0;V<ka.length;V++)ka[V]||(S=!1,delete this.lF[U.registrationInfos[V].addinId],
R.jHd(L[V]),R.qHd(L[V]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${L[V]}. Received status code ${fa.ResponseStatusCode}.`));n.TaskExtensions.Aa(this.aEd(X,"",!1),V=>{V.Sf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):V.Bh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
X.setResult(!1)},this.$.la,4);X.setResult(S)},fa=>{fa=w.a.kf(fa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(L)}. Errors: ${W.a.zc(fa)}.`);P.EwaSettings.ma(256)&&B(R.Sqb,Sys.Serialization.JavaScriptSerializer.serialize(L));for(const S of U.registrationInfos)delete this.lF[S.addinId];X.setResult(!1)},da,X,!0)}FWd(M,L,U){const X=new f.a;
M.bHb(L);M=this.mXc(U);return this.Uha(()=>{P.EwaSettings.ma(256)&&B(R.t3c,L);n.TaskExtensions.Aa(this.aEd(X,U.solutionId,!1),da=>{da.Sf?L&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}.`):da.Bh&&L&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${L}.`);X.setResult(!1)},this.$.la,4)},
da=>{da=w.a.kf(da.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}. Errors: ${W.a.zc(da)}.`);P.EwaSettings.ma(256)&&B(R.s3c,L);X.setResult(!1)},M,X,!1)}Uha(M,L,U,X,da){const fa=this.$.userOperationManager,S=this.$.pa;let ka=null,V=null,wa=null;const ma=()=>{if(fa.GGa()||0<S.va.c3||0<S.Ok.c3)return!1;ka&&fa.Co(ka);V&&S.qt(V);wa&&S.Oz(wa);const ab=U.request,ba=(Na,za,la)=>{P.EwaSettings.ma(256)&&
B(da?R.r3c:R.u3c,ab.RequestBody);return m.g(S.va,"ExecuteRichApiRequest",U,H.b(Na,M),H.a(za,L),la,null,0)};let Ca=ab.RequestFlags&1?0:16;P.EwaSettings.fc()?fa.$t(new l.a(507,0,ba,Ca|64)):fa.$t(new k.a(507,0,ba,Ca));return!0};ma()||(ka=()=>{ma()},V=()=>{ma()},wa=()=>{ma()},fa.Fr(ka),S.Gr(V),S.My(wa));return X.task}iob(M){const L={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.pa.va.Na(1);M.request=L;return M}$Wc(M){const L=
{HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.pa.va.Na(1);M.request=L;return M}mXc(M){const L={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.pa.va.Na(1);M.request=L;return M}aEd(M,L,U){const X=v.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);n.TaskExtensions.Aa(X,()=>{X.result.AJd();L&&U&&this.wgj(L);M.setResult(!0)},
this.$.la,3);return X}c$e(){return N.Task.Ua(!0)}static zFd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(R.Iub(r.a.aYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(R.Iub(r.a.aYa)||"[]"):null)||[]}static cgg(M){R.GNd(r.a.aYa,Sys.Serialization.JavaScriptSerializer.serialize(M))}static uFd(M){M=R.Iub(r.a.p3a(M))||"";return 0<M.length?Sys.Serialization.JavaScriptSerializer.deserialize(M,!0):null}static nXj(M,L){R.$Je(M);R.GNd(r.a.p3a(M),Sys.Serialization.JavaScriptSerializer.serialize(L))}static jHd(M){R.JNf(M);
R.dOf(r.a.p3a(M))}static J4i(M){return R.Iub(r.a.o3a(M))}static oXj(M,L){R.$Je(M);R.GNd(r.a.o3a(M),L)}static qHd(M){R.JNf(M);R.dOf(r.a.o3a(M))}static $Je(M){const L=R.zFd();M=M.toLowerCase();L.includes(M)||(L.push(M),R.cgg(L))}static JNf(M){const L=R.zFd();M=M.toLowerCase();L.includes(M)&&(L.splice(Array.indexOf(L,M),1),R.cgg(L))}static cacheManifest(M,L){M=new x(M);M.needToRestoreManifest&&R.oXj(M.solutionId,L)}static Iub(M){try{return localStorage.getItem(M)}catch(L){return b.ULS.sendTraceTag(537163469,
0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${L.message||"Unknown"}`),null}}static GNd(M,L){try{localStorage.setItem(M,L)}catch(U){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${U.message||"Unknown"}`)}}static dOf(M){try{localStorage.removeItem(M)}catch(L){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${L.message||
"Unknown"}`)}}static Opd(M){if(!M)return!1;try{JSON.parse(M)}catch(L){return!1}return!0}}R.r3c=new J(2,"CustomFunctions [Registration] [Begin] SolutionId=");R.Tqb=new J(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");R.Sqb=new J(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");R.u3c=new J(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");R.t3c=new J(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");R.s3c=new J(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(t.a)(R,"CustomFunctionsLegacyInstaller",null,[746])},1225:function(t,D,a){t=a(0);var c=a(193),b=a(15);class d{}Object(t.a)(d,"AddinCommandsHost",null,[]);var f=a(1306),e=a(1383),k=a(858),l=a(62);const m=(T,W,P,E,H,F)=>{const N=T.Na(9);N.sharedInfo=W;return l.g(T,"InsertAgaveTaskpane",N,P,E,H,F,0)},v=(T,W,P,E,H,F,N=null)=>{N=T.Na(9,N);N.sharedInfo=W;return l.g(T,"ShowAgaveTaskpane",N,P,E,H,F,0)};var n=a(510),w=a(368),r=a(170),u=a(37),x=a(1),z=a(280),B=a(144);class y extends B.a{constructor(T){super();
this.Ae=this.nCa="AddInCommandsDialog";this.Sb=5;this.dialogWidth=695;this.dialogHeight=438;this.V0g="100%";this.S0g="408px";this.T0g="15px";this.U0g="0";this.zsg=T}get containerDiv(){return this.Jk}Lz(){super.Lz();this.Jk.style.width=this.V0g;this.Jk.style.height=this.S0g;this.Jk.style.marginTop=this.T0g;this.Jk.style.padding=this.U0g}tI(){super.tI();this.vb.style.width=String.format("{0}px",this.dialogWidth);this.vb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();
this.zsg()}}Object(t.a)(y,"AddInCommandsDialog",B.a,[]);var A=a(55),K=a(63);B=a(99);a.d(D,"a",function(){return G});class G extends d{constructor(T,W,P,E=null,H=null){super();this.$=T;this.oe=W;this.ownerAddinInfo=P;this.Jd=H;this.TPa=E||A.Task.Ua(!0)}N0g(){const T=this.TPa;this.TPa=A.Task.Ua(!0);return T}disposeHost(T){this.oe.tPa(T)}setOwnerAddinEToken(T){this.ownerAddinInfo.eToken=T}showTaskpane(T,W,P){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let E=null,H=!1,F=(new f.a("m_excelWebRenderer_ewaCtl_",
this.ownerAddinInfo.solutionId,new k.a,!0)).vEe(T.solutionId.substr(this.ownerAddinInfo.solutionId.length));E=W.getSharedRuntimeForTaskpane("Workbook",F);H=!!E&&1===E.LifeTime;this.oe.Awe(H?this.ownerAddinInfo.solutionId:T.solutionId,H?E:null,null)||(this.ylf(H,!0),this.TPa=this.jkd(T,E,(N,J)=>{N?(H&&(N.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,N.SharedRuntime=E),N.WebExtensionOsfControlType=3,this.oe.ZGa(N),P(N.InstanceId,J),this.ylf(H,!1),x.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),P(null,J))}))}getSettings(T,W){let P=this.oe.L$(T.solutionId);P?W(this.oe.AY(P).OsfPropertyBag):this.TPa=this.jkd(T,null,E=>{E?W(E.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(T,W,P){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const E=this.$.pa.va,H=N=>{const J=N.Result,R=J?J.AgaveData:
null;R?(this.oe.rDe(R,()=>{const M=new y(()=>{this.disposeHost(R.InstanceId)});M.initializeAndShow("",null,null);return M.containerDiv}),P(R.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),P(null,N.Errors?N.Errors[0].ErrorCause:5001))},F=G.Aqb(T,this.ownerAddinInfo);T=(N,J,R)=>m(E,F,z.b(N,H),J,R,null);x.EwaSettings.fc()?this.TPa=w.a(this.$.userOperationManager,T,N=>new r.a(500,0,N,64),this.Jd):this.TPa=w.a(this.$.userOperationManager,T,N=>new n.a(500,0,N),this.Jd)}createUILessSandbox(T,
W,P){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const E=W.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),H=!!E&&1===E.LifeTime;(W=this.oe.Uzh(H?this.ownerAddinInfo.solutionId:T.solutionId,H?E:null))?P(W,0):this.TPa=this.jkd(T,E,(F,N)=>{F?(H?(F.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,F.SharedRuntime=E,F.TaskpaneVisible=!1,F.WebExtensionOsfControlType=3,this.oe.ZGa(F)):(F.WebExtensionOsfControlType=4,this.oe.rDe(F,()=>{G.geb.ia(F.InstanceId,new e.a);return G.geb.na(F.InstanceId).ata})),
P(F.InstanceId,N)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),P(null,N))})}jkd(T,W,P){let E=null;const H=this.$.pa.va,F=L=>{const U=L.Result;(E=U?U.AgaveData:null)||P(null,L.Errors?L.Errors[0].ErrorCause:5001)},N=G.Aqb(T,this.ownerAddinInfo);W&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),N.SharedRuntimeId=W.Resid);let J=500;var R=(L,U,X)=>m(H,N,z.b(L,F),U,X,null);let M=0;void 0===N.IsToBePersisted||null===N.IsToBePersisted||N.IsToBePersisted||
(J=538,R=(L,U,X)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return v(H,N,z.b(L,F),U,X,null)},M=16);x.EwaSettings.fc()?(M|=64,R=w.a(this.$.userOperationManager,R,L=>new r.a(J,0,L,M),this.Jd)):R=w.a(this.$.userOperationManager,R,L=>new n.a(J,0,L,M),
this.Jd);return u.TaskExtensions.ts(R,()=>E?this.bsd(H,E.InstanceId,(L,U)=>{if(L){W||(E.PrimaryMarketplace.MarketplaceType=T.storeType);E.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;E.OwnerAddinStoreType=this.ownerAddinInfo.storeType;E.OsfPropertyBag=[];for(U=0;U<L.Settings.length;U++){const X=[];X[0]=L.Settings[U].Name;X[1]=L.Settings[U].Value;E.OsfPropertyBag[U]=X}P(E,0)}else P(null,U.Errors?U.Errors[0].ErrorCause:5001)}):A.Task.Ua(!1),c.a.none,3,K.a.current)}bsd(T,W,P){const E=F=>{P(F.Result,
F)},H=(F,N,J)=>{F=z.b(F,E);const R=T.Na(1);R.controlId=W;return l.g(T,"DdaLoadSettings",R,F,N,J,null,0)};return x.EwaSettings.fc()?w.a(this.$.userOperationManager,H,F=>new r.a(501,0,F,80),this.Jd):w.a(this.$.userOperationManager,H,F=>new n.a(501,0,F,16),this.Jd)}ylf(T,W){var P;T&&(null===(P=window.performance)||void 0===P?0:P.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${W}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(T){G.geb.lb(T)&&
G.geb.na(T).initializeAndShowWithTitle()}static hideUILessDialog(T){G.geb.lb(T)&&G.geb.na(T).hide()}static Aqb(T,W){const P={};P.SolutionId=T.solutionId;P.Version=T.version;P.StoreType=W.storeType;P.StoreId=T.storeId;P.AssetId=T.solutionId;P.AssetStoreId="omex";P.TargetType=1;P.Width=350;P.OwnerAddinSolutionId=W.solutionId;P.OwnerAddinStoreType=W.storeType;P.SharedRuntimeId=null;P.Preload=!1;return P}}G.geb=new B.a;Object(t.a)(G,"WACExcelAddinCommandsHost",d,[])},1231:function(t,D,a){var c=a(10);
t=a(0);var b=a(690),d=a(15),f=a(103),e=a(4),k=a(1297),l=a(1),m=a(181),v=a(55);class n{constructor(z,B,y){this.Wqb=null;this.$=z;B?(d.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.Wqb=new k.a(z,B,y)):d.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Qc(){return!1}executeCommand(z,B,y){z=!1;switch(B.command){case 73979048:this.Wqb&&
this.Wqb.MZi(B,f.a.instance,e.AFrameworkApplication.fa,y),z=!0}return z?v.Task.Ua(!0):m.a(B.command)}Ec(z,B){return 73979048===B.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Vc(){return!1}dispose(){this.Wqb&&this.Wqb.dispose()}}Object(t.a)(n,"DataFromPictureCommandHandler",null,[188,3]);var w=a(37),r=a(50);class u extends b.a{constructor(z){super(z)}Dd(){const z=r.GetServiceTaskFactory.Ta(this.$.da,328,327,1),B=r.GetServiceTaskFactory.Ta(this.$.da,
484,485,1);w.TaskExtensions.Aa(w.TaskExtensions.Xd([z,B],this.$.la),()=>{this.ld([new n(this.$,z.result,B.result)])},this.$.la,3)}static ka(z){b.a.Rd(452,new u(z))}}Object(t.a)(u,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return x});const x=()=>{c.a.Fa(z=>{u.ka(z)})}},1289:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static xHh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(t.a)(c,"WopiAuthContext",null,[532])},1290:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.zDf="OneDriveWOPI";Object(t.a)(c,"HostApplicationType",null,[])},1291:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e){this._id=b;
this.cwg=d;this.ege=f;this.IBa=e}getId(){return this._id}getStoreId(){return this.cwg}getStoreType(){return this.ege}}Object(t.a)(c,"ExtensionIdentity",null,[717])},1292:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(b,d,f){this.a$d=f}}Object(t.a)(c,"HostProperties",null,[])},1293:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(){this.optionalProperties={};this.Ip={}}}Object(t.a)(c,"ExtensionLaunchProperties",null,[])},1294:function(t,D,a){a.d(D,
"a",function(){return v});t=a(0);var c=a(1291),b=a(1293),d=a(956),f=a(1296),e=a(1292),k=a(4),l=a(567),m=a(25);class v{constructor(){this.La=k.AFrameworkApplication.wb}zMa(n,w,r,u,x){this.cqi(n,w,r,u,x)}cqi(n,w,r,u,x){const {ExtensionComponentInstance:z}=a(1295),B={};B[d.a.Fsb]=n;B[d.a.Jze]=w;B[d.a.dha]=r;B[d.a.iid]=u;B[d.a.zla]=x;u=8;if(k.AFrameworkApplication.Mod(n.getId()))switch(w){case f.a.action:u=this.La.ae(m.a.FPe,2,B);break;case f.a.taskpane:u=this.La.ae(m.a.h2f,2,B);break;case f.a.sdxDialog:u=
this.La.ae(m.a.Rhc,2,B);break;default:u=16}32===u?(u=l.a.create().toString(),x.optionalProperties.InstanceToken&&(u=x.optionalProperties.InstanceToken),n=new z(n,w,r,u),v.Ov[u]=n):n=new z(n,w,r,null);n.Dnj(B)}bqi(n){var w=n.ExtId;const r=n.ComponentType,u=n.ComponentId;var x=n.HostProps;n=n.OptionalProps;w=new c.a(w.Id,w.StoreId,w.StoreType,w.AppVersion);x=new e.a(x.HostType,x.FormFactor,x.Locale);const z=new b.a;z.optionalProperties=n.OptionalProperties;z.Ip=n.DevProperties;v.instance.zMa(w,r,u,
x,z)}getInstance(n){return v.Ov[n]}N9i(n){delete v.Ov[n]}static get instance(){v.sGc||(v.sGc=new v);return v.sGc}}v.sGc=null;v.Ov={};Object(t.a)(v,"ExtensionLifeCycleManager",null,[716])},1295:function(t,D,a){a.r(D);a.d(D,"ExtensionComponentInstance",function(){return f});t=a(0);var c=a(1294),b=a(4),d=a(25);class f{constructor(e,k,l,m){this.IBa=this.sG=null;this._id=e;this.Ulg=l;this.Qpg=m;this.La=b.AFrameworkApplication.wb?b.AFrameworkApplication.wb:null}Lbd(){return this.Ulg}get appVersion(){return this.IBa}Dnj(e){this.sG=
e}stop(){const e=this.La.ae(d.a.sYg,2,this.sG);c.a.instance.N9i(this.Qpg);return 32===e}gsc(){this.La.ae(d.a.BSf,2,this.sG)}}Object(t.a)(f,"ExtensionComponentInstance",null,[726])},1296:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.taskpane="Taskpane";c.action="Action";c.sdxDialog="SDXDialog";Object(t.a)(c,"ComponentTypeNames",null,[])},1297:function(t,D,a){(function(c){a.d(D,"a",function(){return A});var b=a(0),d=a(15),f=a(171),e=a(84),k=a(1303),l=a(38),m=a(248),v=a(42),n=a(368),
w=a(170),r=a(62),u=a(90),x=a(14),z=a(21),B=a(41),y=a(1304);class A extends l.a{constructor(K,G,T){super();this.o8e=k.a.getTypeName();this.Lwb=this.zT=this.Jd=null;this.imageHeight=this.imageWidth=0;this.KKa=this.errorMessage=this.tableData=null;this.wid=0;this.FRc=!1;this.BEe=W=>{if(W){var P={};if(({Vt:P}=B.d(this.sbh(W.data))).returnValue&&(W=Object(e.a)(Object,P),"."===W.DataFromPictureWildcard))if(W.SessionId!==this.KKa)d.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");
else switch(d.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),W.CmdType){case "ACK":this.FRc=!0;this.x7f.stop();d.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.fmj();0<this.errorMessage.length?this.oWf():0<this.tableData.length&&this.GWf();break;case "insert_html":const H=this.$.pa.va;P={};var E=z.g(this.$).ha.sa.Wc.clone();P.PasteId=
f.a.create().toString();P.DestinationRanges=v.s(v.v(E,this.$));E=W.Parameters.split("|",3);d.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${E[0]}|${E[1]}|${E[2]}.`);E=W.Parameters.indexOf("|");E=W.Parameters.indexOf("|",E+1);E=W.Parameters.indexOf("|",E+1);P.SourceHtml=W.Parameters.substring(E+1);P.CopyOperationId=null;const F=H.Na(1,H.Qb());F.pasteHtmlParameters=P;n.a(this.$.userOperationManager,(N,J,R)=>r.g(H,"pasteHtmlContent",F,N,J,R,
null,64),N=>new w.a(204,0,N,1),null);this.wid++;d.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.wid.toString()}`)}}};this.k7h=(W,P)=>{if(W=P.kJ)if(!P.parentPath||1>=P.parentPath.length||P.parentPath[1]!==this.KKa)d.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{d.ULS.sendTraceTag(523805123,
0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");P=W.errorCode;switch(P){case null:case -1:this.errorMessage=x.a.instance.ga(2265);break;case 1:this.errorMessage=x.a.instance.ga(2266);break;case 2:this.errorMessage=x.a.instance.ga(2267)}0<this.errorMessage.length&&d.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${P?P.toString():"null"}.`);this.zoe.stop();this.tableData=W.html;this.FRc&&(0<this.errorMessage.length?
this.oWf():0<this.tableData.length&&this.GWf())}else d.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=K;this.augmentationLoopManager=G;this.uploaderCreator=T;this.initialize()}dispose(){window.removeEventListener("message",this.BEe,!1);super.dispose()}ERi(K,G){d.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let T=new Image;T.onload=()=>{var W=document.createElement("canvas");
W.width=T.width;W.height=T.height;const P=W.getContext("2d");try{P.drawImage(T,0,0,T.width,T.height)}catch(F){d.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${F.message}`);return}let E;try{E=W.toDataURL("image/jpeg")}catch(F){d.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${F.message}`);return}W=E.split(",");if(2>W.length)d.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{W=W[1];try{var H=window.self.atob(W)}catch(F){d.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${F.message}`);return}28E5<H.length?(d.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),G.dzj()):(this.jij(this.Jd,this.zT,W,T.width,T.height),URL.revokeObjectURL(T.src),T=null,d.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
T.src=K}MZi(K,G,T,W){this.Jd=K;this.zT=W;this.uploaderCreator.S9h(this.$,G,T,W,this)}jij(K,G,T,W,P){this.KKa=f.a.create().toString();this.wid=0;this.Lwb=T;this.imageWidth=W;this.imageHeight=P;this.errorMessage=this.tableData="";this.FRc=!1;this.x7f=this.$.Hb.Ng("LoadResource","DataFromPictureTaskpaneLaunch");this.x7f.start();this.jUi(K,G);this.zoe=this.$.Hb.Ng("LoadResource","DataFromPictureAnnotation");this.zoe.start();this.HTj()}HTj(){if(this.Lwb.length){var K=window.self.atob(this.Lwb);var G=new Uint8Array(K.length);
for(let T=0;T<K.length;T++)G[T]=K.charCodeAt(T);this.augmentationLoopManager.GTj(G,this.KKa,this.imageWidth,this.imageHeight)}else d.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}jUi(K,G){G.SessionID=this.KKa;G.DataFromPictureAssetId="FA000000050";G.LoadDataFromPictureTaskpane=!0;K=new u.a(-859308420,K.method,K.mode,K.Re,K.tabName);this.$.Ka.Lb(K,G)}q6c(K){try{const G=c.from(K,"utf16le").toString("base64");return y.a.OGa(this.KKa,
G)}catch(G){return d.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}sbh(K){try{const G=y.a.OGa(this.KKa,K);return c.from(G,"base64").toString("utf16le")}catch(G){return d.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}fmj(){if(this.Lwb.length){var K=m.a(this.$).L$("FA000000050"),G={["DataFromPictureWildcard"]:"."};G.imageData=this.q6c(this.Lwb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,
"onCustomMessage",G,T=>{T&&d.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else d.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}GWf(){if(this.tableData.length){var K=m.a(this.$).L$("FA000000050"),G={["DataFromPictureWildcard"]:"."};G.tableHtml=this.q6c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,"onCustomMessage",
G,T=>{T&&d.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else d.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}oWf(){if(this.errorMessage.length){var K=m.a(this.$).L$("FA000000050"),G={["DataFromPictureWildcard"]:"."};G.errorMessage=this.q6c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,"onCustomMessage",
G,T=>{T&&d.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else d.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.BEe,!1);this.augmentationLoopManager.activateAnnotation(this.o8e);this.augmentationLoopManager.$O(this.o8e,this.k7h)}}Object(b.a)(A,"DataFromPictureManager",
l.a,[713])}).call(this,a(1298).Mgg)},1298:function(t,D,a){(function(c){function b(){try{var E=new Uint8Array(1);E.__proto__={__proto__:Uint8Array.prototype,WYj:function(){return 42}};return"function"===typeof E.subarray&&0===E.subarray(1,1).byteLength}catch(H){return!1}}function d(E,H){if((f.EO?2147483647:1073741823)<H)throw new RangeError("Invalid typed array length");f.EO?(E=new Uint8Array(H),E.__proto__=f.prototype):(null===E&&(E=new f(H)),E.length=H);return E}function f(E,H,F){if(!(f.EO||this instanceof
f))return new f(E,H,F);if("number"===typeof E){if("string"===typeof H)throw Error("If encoding is specified then the first argument must be a string");return l(this,E)}return e(this,E,H,F)}function e(E,H,F,N){if("number"===typeof H)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&H instanceof ArrayBuffer){H.byteLength;if(0>F||H.byteLength<F)throw new RangeError("'offset' is out of bounds");if(H.byteLength<F+(N||0))throw new RangeError("'length' is out of bounds");
H=void 0===F&&void 0===N?new Uint8Array(H):void 0===N?new Uint8Array(H,F):new Uint8Array(H,F,N);f.EO?(E=H,E.__proto__=f.prototype):E=m(E,H);H=E}else if("string"===typeof H){N=E;E=F;if("string"!==typeof E||""===E)E="utf8";if(!f.Gbf(E))throw new TypeError('"encoding" must be a valid string encoding');F=w(H,E)|0;N=d(N,F);H=N.write(H,E);H!==F&&(N=N.slice(0,H));H=N}else H=v(E,H);return H}function k(E){if("number"!==typeof E)throw new TypeError('"size" argument must be a number');if(0>E)throw new RangeError('"size" argument must not be negative');
}function l(E,H){k(H);E=d(E,0>H?0:n(H)|0);if(!f.EO)for(var F=0;F<H;++F)E[F]=0;return E}function m(E,H){var F=0>H.length?0:n(H.length)|0;E=d(E,F);for(var N=0;N<F;N+=1)E[N]=H[N]&255;return E}function v(E,H){if(f.isBuffer(H)){var F=n(H.length)|0;E=d(E,F);if(0===E.length)return E;H.copy(E,0,0,F);return E}if(H){if("undefined"!==typeof ArrayBuffer&&H.buffer instanceof ArrayBuffer||"length"in H)return(F="number"!==typeof H.length)||(F=H.length,F=F!==F),F?d(E,0):m(E,H);if("Buffer"===H.type&&T(H.data))return m(E,
H.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(E){if(E>=(f.EO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.EO?2147483647:1073741823).toString(16)+" bytes");return E|0}function w(E,H){if(f.isBuffer(E))return E.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(E)||E instanceof ArrayBuffer))return E.byteLength;
"string"!==typeof E&&(E=""+E);var F=E.length;if(0===F)return 0;for(var N=!1;;)switch(H){case "ascii":case "latin1":case "binary":return F;case "utf8":case "utf-8":case void 0:return B(E).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*F;case "hex":return F>>>1;case "base64":return A(E).length;default:if(N)return B(E).length;H=(""+H).toLowerCase();N=!0}}function r(E,H,F){var N=!1;if(void 0===H||0>H)H=0;if(H>this.length)return"";if(void 0===F||F>this.length)F=this.length;if(0>=
F)return"";F>>>=0;H>>>=0;if(F<=H)return"";for(E||(E="utf8");;)switch(E){case "hex":E=H;H=F;F=this.length;if(!E||0>E)E=0;if(!H||0>H||H>F)H=F;N="";for(F=E;F<H;++F)E=N,N=this[F],N=16>N?"0"+N.toString(16):N.toString(16),N=E+N;return N;case "utf8":case "utf-8":return z(this,H,F);case "ascii":E="";for(F=Math.min(this.length,F);H<F;++H)E+=String.fromCharCode(this[H]&127);return E;case "latin1":case "binary":E="";for(F=Math.min(this.length,F);H<F;++H)E+=String.fromCharCode(this[H]);return E;case "base64":return 0===
H&&F===this.length?G.FTe(this):G.FTe(this.slice(H,F));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":H=this.slice(H,F);F="";for(E=0;E<H.length;E+=2)F+=String.fromCharCode(H[E]+256*H[E+1]);return F;default:if(N)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase();N=!0}}function u(E,H,F,N,J){if(0===E.length)return-1;"string"===typeof F?(N=F,F=0):2147483647<F?F=2147483647:-2147483648>F&&(F=-2147483648);F=+F;isNaN(F)&&(F=J?0:E.length-1);0>F&&(F=E.length+F);if(F>=E.length){if(J)return-1;
F=E.length-1}else if(0>F)if(J)F=0;else return-1;"string"===typeof H&&(H=f.from(H,N));if(f.isBuffer(H))return 0===H.length?-1:x(E,H,F,N,J);if("number"===typeof H)return H&=255,f.EO&&"function"===typeof Uint8Array.prototype.indexOf?J?Uint8Array.prototype.indexOf.call(E,H,F):Uint8Array.prototype.lastIndexOf.call(E,H,F):x(E,[H],F,N,J);throw new TypeError("val must be string, number or Buffer");}function x(E,H,F,N,J){function R(X,da){return 1===M?X[da]:X.V4i(da*M)}var M=1,L=E.length,U=H.length;if(void 0!==
N&&(N=String(N).toLowerCase(),"ucs2"===N||"ucs-2"===N||"utf16le"===N||"utf-16le"===N)){if(2>E.length||2>H.length)return-1;M=2;L/=2;U/=2;F/=2}if(J)for(N=-1;F<L;F++)if(R(E,F)===R(H,-1===N?0:F-N)){if(-1===N&&(N=F),F-N+1===U)return N*M}else-1!==N&&(F-=F-N),N=-1;else for(F+U>L&&(F=L-U);0<=F;F--){L=!0;for(N=0;N<U;N++)if(R(E,F+N)!==R(H,N)){L=!1;break}if(L)return F}return-1}function z(E,H,F){F=Math.min(E.length,F);for(var N=[];H<F;){var J=E[H],R=null,M=239<J?4:223<J?3:191<J?2:1;if(H+M<=F)switch(M){case 1:128>
J&&(R=J);break;case 2:var L=E[H+1];128===(L&192)&&(J=(J&31)<<6|L&63,127<J&&(R=J));break;case 3:L=E[H+1];var U=E[H+2];128===(L&192)&&128===(U&192)&&(J=(J&15)<<12|(L&63)<<6|U&63,2047<J&&(55296>J||57343<J)&&(R=J));break;case 4:L=E[H+1];U=E[H+2];var X=E[H+3];128===(L&192)&&128===(U&192)&&128===(X&192)&&(J=(J&15)<<18|(L&63)<<12|(U&63)<<6|X&63,65535<J&&1114112>J&&(R=J))}null===R?(R=65533,M=1):65535<R&&(R-=65536,N.push(R>>>10&1023|55296),R=56320|R&1023);N.push(R);H+=M}E=N.length;if(E<=W)N=String.fromCharCode.apply(String,
N);else{F="";for(H=0;H<E;)F+=String.fromCharCode.apply(String,N.slice(H,H+=W));N=F}return N}function B(E,H){H=H||Infinity;for(var F,N=E.length,J=null,R=[],M=0;M<N;++M){F=E.charCodeAt(M);if(55295<F&&57344>F){if(!J){if(56319<F){-1<(H-=3)&&R.push(239,191,189);continue}else if(M+1===N){-1<(H-=3)&&R.push(239,191,189);continue}J=F;continue}if(56320>F){-1<(H-=3)&&R.push(239,191,189);J=F;continue}F=(J-55296<<10|F-56320)+65536}else J&&-1<(H-=3)&&R.push(239,191,189);J=null;if(128>F){if(0>--H)break;R.push(F)}else if(2048>
F){if(0>(H-=2))break;R.push(F>>6|192,F&63|128)}else if(65536>F){if(0>(H-=3))break;R.push(F>>12|224,F>>6&63|128,F&63|128)}else if(1114112>F){if(0>(H-=4))break;R.push(F>>18|240,F>>12&63|128,F>>6&63|128,F&63|128)}else throw Error("Invalid code point");}return R}function y(E){for(var H=[],F=0;F<E.length;++F)H.push(E.charCodeAt(F)&255);return H}function A(E){var H=G,F=H.uJj;E=(E.trim?E.trim():E.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>E.length)E="";else for(;0!==E.length%4;)E+="=";return F.call(H,
E)}function K(E,H,F,N){for(var J=0;J<N&&!(J+F>=H.length||J>=E.length);++J)H[J+F]=E[J];return J}var G=a(1300);a(1301);var T=a(1302);D.Mgg=f;D.wYj=function(E){+E!=E&&(E=0);return f.Xne(+E)};D.dYj=50;f.EO=void 0!==c.EO?c.EO:b();D.dZj=f.EO?2147483647:1073741823;f.from=function(E,H,F){return e(null,E,H,F)};f.EO&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));
f.Xne=function(E){k(E);return d(null,E)};f.iIg=function(E){return l(null,E)};f.isBuffer=function(E){return!(null==E||!E.iqg)};f.compare=function(E,H){if(!f.isBuffer(E)||!f.isBuffer(H))throw new TypeError("Arguments must be Buffers");if(E===H)return 0;for(var F=E.length,N=H.length,J=0,R=Math.min(F,N);J<R;++J)if(E[J]!==H[J]){F=E[J];N=H[J];break}return F<N?-1:N<F?1:0};f.Gbf=function(E){switch(String(E).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};f.concat=function(E,H){if(!T(E))throw new TypeError('"list" argument must be an Array of Buffers');if(0===E.length)return f.Xne(0);var F;if(void 0===H)for(F=H=0;F<E.length;++F)H+=E[F].length;H=f.iIg(H);var N=0;for(F=0;F<E.length;++F){var J=E[F];if(!f.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(H,N);N+=J.length}return H};f.byteLength=w;f.prototype.iqg=!0;f.prototype.toString=function(){var E=this.length|0;return 0===E?"":0===arguments.length?
z(this,0,E):r.apply(this,arguments)};f.prototype.equals=function(E){if(!f.isBuffer(E))throw new TypeError("Argument must be a Buffer");return this===E?!0:0===f.compare(this,E)};f.prototype.compare=function(E,H,F,N,J){if(!f.isBuffer(E))throw new TypeError("Argument must be a Buffer");void 0===H&&(H=0);void 0===F&&(F=E?E.length:0);void 0===N&&(N=0);void 0===J&&(J=this.length);if(0>H||F>E.length||0>N||J>this.length)throw new RangeError("out of range index");if(N>=J&&H>=F)return 0;if(N>=J)return-1;if(H>=
F)return 1;H>>>=0;F>>>=0;N>>>=0;J>>>=0;if(this===E)return 0;var R=J-N,M=F-H,L=Math.min(R,M);N=this.slice(N,J);E=E.slice(H,F);for(H=0;H<L;++H)if(N[H]!==E[H]){R=N[H];M=E[H];break}return R<M?-1:M<R?1:0};f.prototype.includes=function(E,H,F){return-1!==this.indexOf(E,H,F)};f.prototype.indexOf=function(E,H,F){return u(this,E,H,F,!0)};f.prototype.lastIndexOf=function(E,H,F){return u(this,E,H,F,!1)};f.prototype.write=function(E,H,F,N){if(void 0===H)N="utf8",F=this.length,H=0;else if(void 0===F&&"string"===
typeof H)N=H,F=this.length,H=0;else if(isFinite(H))H|=0,isFinite(F)?(F|=0,void 0===N&&(N="utf8")):(N=F,F=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var J=this.length-H;if(void 0===F||F>J)F=J;if(0<E.length&&(0>F||0>H)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");for(J=!1;;)switch(N){case "hex":H=Number(H)||0;N=this.length-H;F?(F=Number(F),F>N&&(F=N)):F=N;N=E.length;if(0!==N%2)throw new TypeError("Invalid hex string");
F>N/2&&(F=N/2);for(N=0;N<F;++N){J=parseInt(E.substr(2*N,2),16);if(isNaN(J))break;this[H+N]=J}return N;case "utf8":case "utf-8":return K(B(E,this.length-H),this,H,F);case "ascii":return K(y(E),this,H,F);case "latin1":case "binary":return K(y(E),this,H,F);case "base64":return K(A(E),this,H,F);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":N=E;J=this.length-H;for(var R=[],M=0;M<N.length&&!(0>(J-=2));++M){var L=N.charCodeAt(M);E=L>>8;L%=256;R.push(L);R.push(E)}return K(R,this,H,F);default:if(J)throw new TypeError("Unknown encoding: "+
N);N=(""+N).toLowerCase();J=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.AYj||this,0)}};var W=4096;f.prototype.slice=function(E,H){var F=this.length;E=~~E;H=void 0===H?F:~~H;0>E?(E+=F,0>E&&(E=0)):E>F&&(E=F);0>H?(H+=F,0>H&&(H=0)):H>F&&(H=F);H<E&&(H=E);if(f.EO)H=this.subarray(E,H),H.__proto__=f.prototype;else{F=H-E;H=new f(F,void 0);for(var N=0;N<F;++N)H[N]=this[N+E]}return H};f.prototype.V4i=function(E){if(0!==E%1||0>E)throw new RangeError("offset is not uint");
if(E+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[E]<<8|this[E+1]};f.prototype.copy=function(E,H,F,N){F||(F=0);N||0===N||(N=this.length);H>=E.length&&(H=E.length);H||(H=0);0<N&&N<F&&(N=F);if(N===F||0===E.length||0===this.length)return 0;if(0>H)throw new RangeError("targetStart out of bounds");if(0>F||F>=this.length)throw new RangeError("sourceStart out of bounds");if(0>N)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length);E.length-
H<N-F&&(N=E.length-H+F);var J=N-F;if(this===E&&F<H&&H<N)for(N=J-1;0<=N;--N)E[N+H]=this[N+F];else if(1E3>J||!f.EO)for(N=0;N<J;++N)E[N+H]=this[N+F];else Uint8Array.prototype.set.call(E,this.subarray(F,F+J),H);return J};f.prototype.fill=function(E,H,F,N){if("string"===typeof E){"string"===typeof H?(N=H,H=0,F=this.length):"string"===typeof F&&(N=F,F=this.length);if(1===E.length){var J=E.charCodeAt(0);256>J&&(E=J)}if(void 0!==N&&"string"!==typeof N)throw new TypeError("encoding must be a string");if("string"===
typeof N&&!f.Gbf(N))throw new TypeError("Unknown encoding: "+N);}else"number"===typeof E&&(E&=255);if(0>H||this.length<H||this.length<F)throw new RangeError("Out of range index");if(F<=H)return this;H>>>=0;F=void 0===F?this.length:F>>>0;E||(E=0);if("number"===typeof E)for(N=H;N<F;++N)this[N]=E;else for(E=f.isBuffer(E)?E:B((new f(E,N)).toString()),J=E.length,N=0;N<F-H;++N)this[N+H]=E[N%J];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1299))},1299:function(t){var D=function(){return this}();
try{D=D||(new Function("return this"))()}catch(a){"object"===typeof window&&(D=window)}t.exports=D},1300:function(t,D){function a(f){var e=f.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=e);return[f,f===e?0:4-f%4]}D.byteLength=function(f){f=a(f);var e=f[1];return 3*(f[0]+e)/4-e};D.uJj=function(f){var e=a(f);var k=e[0];e=e[1];var l=new d(3*(k+e)/4-e),m=0,v=0<e?k-4:k,n;for(n=0;n<v;n+=4)k=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+
2)]<<6|b[f.charCodeAt(n+3)],l[m++]=k>>16&255,l[m++]=k>>8&255,l[m++]=k&255;2===e&&(k=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>4,l[m++]=k&255);1===e&&(k=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,l[m++]=k>>8&255,l[m++]=k&255);return l};D.FTe=function(f){for(var e=f.length,k=e%3,l=[],m=0,v=e-k;m<v;m+=16383){for(var n=l,w=n.push,r,u=f,x=m+16383>v?v:m+16383,z=[],B=m;B<x;B+=3)r=(u[B]<<16&16711680)+(u[B+1]<<8&65280)+(u[B+2]&255),z.push(c[r>>18&63]+c[r>>12&63]+c[r>>6&63]+c[r&
63]);r=z.join("");w.call(n,r)}1===k?(f=f[e-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===k&&(f=(f[e-2]<<8)+f[e-1],l.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(t=0;64>t;++t)c[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;b[45]=62;b[95]=63},1301:function(t,D){D.read=function(a,c,b,d,f){var e=8*f-d-1;var k=(1<<
e)-1,l=k>>1,m=-7;f=b?f-1:0;var v=b?-1:1,n=a[c+f];f+=v;b=n&(1<<-m)-1;n>>=-m;for(m+=e;0<m;b=256*b+a[c+f],f+=v,m-=8);e=b&(1<<-m)-1;b>>=-m;for(m+=d;0<m;e=256*e+a[c+f],f+=v,m-=8);if(0===b)b=1-l;else{if(b===k)return e?NaN:Infinity*(n?-1:1);e+=Math.pow(2,d);b-=l}return(n?-1:1)*e*Math.pow(2,b-d)};D.write=function(a,c,b,d,f,e){var k,l=8*e-f-1,m=(1<<l)-1,v=m>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;e=d?0:e-1;var w=d?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,d=m):
(d=Math.floor(Math.log(c)/Math.LN2),1>c*(k=Math.pow(2,-d))&&(d--,k*=2),c=1<=d+v?c+n/k:c+n*Math.pow(2,1-v),2<=c*k&&(d++,k/=2),d+v>=m?(c=0,d=m):1<=d+v?(c=(c*k-1)*Math.pow(2,f),d+=v):(c=c*Math.pow(2,v-1)*Math.pow(2,f),d=0));for(;8<=f;a[b+e]=c&255,e+=w,c/=256,f-=8);d=d<<f|c;for(l+=f;0<l;a[b+e]=d&255,e+=w,d/=256,l-=8);a[b+e-w]|=128*r}},1302:function(t){var D={}.toString;t.exports=Array.isArray||function(a){return"[object Array]"==D.call(a)}},1303:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);
D=a(720);var c=a(694);class b extends D.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Od()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Od(){return["AugLoop_Core_Annotation"]}}Object(t.a)(b,"DetectedHtmlTableAnnotation",D.a,[])},1304:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{static OGa(b,d){if(!(b&&d&&b.length&&d.length)||256<b.length)return"";const f=
Array(256),e=Array(256);let k,l=0,m=0;let v,n="";for(k=0;256>k;k++)f[k]=k;for(k=0;256>k;k++){var w=b.charCodeAt(k%b.length);if(256<=w)return"";l=(l+f[k]+w)%256;w=f[k];f[k]=f[l];f[l]=w}for(k=0;256>k;k++)e[k]=f[256-k-1];l=k=0;for(b=0;b<d.length;b++){k=(k+1)%256;l=(l+f[k])%256;w=f[k];f[k]=f[l];f[l]=w;w=d.charCodeAt(b);if(256<=w)return"";v=w^f[(f[k]+f[l])%256];m=(m+e[k])%256;w=e[k];e[k]=e[m];e[m]=w;n+=String.fromCharCode(v^f[(e[k]+e[m])%256])}return n}}Object(t.a)(c,"RC4A",null,[])},1306:function(t,D,
a){a.d(D,"a",function(){return b});t=a(0);a(15);var c=a(4);class b{constructor(d,f,e,k){this.fjb=d;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&e.PQh();this.mkg=this.ex=f;this.kvg=k}get oCb(){return this.fjb}get solutionId(){return this.ex}get assetId(){return this.mkg}get NPd(){return this.kvg}kJa(d){d=this.oCb+this.solutionId+d;return this.NPd?(d in b.pYb||(b.pYb[d]="AddinControl"+b.XGg++),b.pYb[d]):d}vEe(d){if(this.NPd){const e=b.pYb;for(let k in e){var f=k;if(d===e[k])return f.substr(this.oCb.length+
this.solutionId.length)}}return d}F1e(d){d=this.oCb+this.solutionId+d;return this.NPd?(d in b.bUc||(b.bUc[d]="AddinTab"+b.gHg++),b.bUc[d]):d}}b.pYb={};b.bUc={};b.gHg=0;b.XGg=0;Object(t.a)(b,"DefaultRibbonNamingProvider",null,[786])},1353:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(84),d;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";
r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=
20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=
28]="worksheetNavigationObjectChangedEvent";r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";
r[r.tableAddedEvent=102]="tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=
1E3]="invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=
2103]="shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(d||(d={}));Object(t.b)("MessageType",d);var f=a(761),e=a(248),k=a(732),l=a(58),m=a(37),v=a(152),n=a(1);a.d(D,"DdaEventDispatch",function(){return w});class w{constructor(r){this.VA=null;this.m9f={};this.o9f=
{};this.b$c={};this.Hwd={};this.Fgd=(u,x)=>{u=this.$.Hb.xc("Task","DdaEventDispatch.HandleServerEvent");x=x.MWf;for(let y=0;y<x.length;y++)switch(x[y].EventType){case 2:var z=x[y],B={};B.Name=z.Name;B.BindingType=z.BindingType;B.ColCount=z.ColCount;B.RowCount=z.RowCount;this.eva(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,B,null);break;case 4:this.eva(x[y].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=x[y],z.InstanceId){B=Array(z.Entries.length);
for(let A=0;A<z.Entries.length;A++)B[A]=w.jac(z.Entries[A],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?this.e0i(z.InstanceId,B):z.InstanceId&&this.eva(z.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}else{this.b$c={};this.Hwd={};for(B=0;B<z.Entries.length;B++)this.WGe(z.Entries[B],z.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${this.b$c}, Number of Not Fired event: ${this.Hwd}, Total Number of Fired event: ${this.m9f}, Total Number of Not Fired event: ${this.o9f}`)}}u.stop()};
this.jJb=(u,x)=>{this.eva(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,x)};this.$=r;this.Rtc=this.Fgd}TXb(r){r&&(this.Lha(),this.VA.push(r))}Yqc(r){this.VA&&(Array.remove(this.VA,r),this.VA.length||(this.$.wantServerEvents=!1,this.$.Zbj(this.Rtc),this.VA=null))}e0i(r,u){const x=Object(b.a)(k.DdaFacade,e.a(this.$));m.TaskExtensions.Aa(x.lSh(r),z=>{if(v.b(z)){var B=z.result;z=x.en(B);if(B)if(z.Bfc)this.eva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(z.U3b)for(B=0;B<u.length;B++)z.U3b.push(u[B]);
else z.U3b=u}else z.Sf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.Bh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}z0i(r,u){const x=Object(b.a)(k.DdaFacade,e.a(this.$)),z=x.rGh(r);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,u,this.jJb):x.m3g(r,u)}WGe(r,u){let x=!1;const z=parseInt(r.Type,
10);var B=r.Target;const y=Object(b.a)(k.DdaFacade,e.a(this.$));if((B=y.Yi.rSh(z,B))&&0<Object.keys(B).length){x=!0;for(let K in B)if(B=K,y.Yi.fZb(B)){const G=Array(1);G[0]=w.jac(r,u);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var A=G[0][3];if(void 0!==A&&null!==A&&(A=Object(b.a)(Object,l.a.Uh(A)))&&void 0!==A.triggerControlId&&null!==A.triggerControlId&&void 0!==A.triggerSource&&null!==A.triggerSource){let T=!1;u?(A.triggerSource="Unknown",T=!0):y.cgh(A.triggerControlId,
B)&&(A.triggerSource="ThisLocalAddin",T=!0);T&&(G[0][3]=l.a.Ac(A))}}this.eva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,G)}}x?(this.Occ(d[z],this.b$c),this.Occ(d[z],this.m9f)):(this.Occ(d[z],this.Hwd),this.Occ(d[z],this.o9f))}Lha(){this.VA||(this.VA=[],this.$.Rme(this.Rtc),this.$.wantServerEvents=!0)}Occ(r,u){r in u||(u[r]=0);u[r]+=1}zM(r,u,x){const z={};z.Target=u;z.Category=65536;z.Type=r;z.Message=x;z.Id=-1;this.WGe(z,!1)}iAh(r,u){const x={Target:"",Category:2,Type:1E3};x.Message=u;x.Id=
0;u=Array(1);u[0]=w.jac(x,!1);this.z0i(r,u)}h8b(r,u,x,z){const B={};B.Target=x;B.Category=65536;B.Type=u;B.Message=z;B.Id=-1;u=Array(1);u[0]=w.jac(B,!1);this.eva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}hAh(r,u){this.eva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}eva(r,u,x,z){if(this.VA){var B=Object(b.a)(k.DdaFacade,e.a(this.$));if(!B||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||B.Yi.fZb(r)){r=new f.a(u,r,
x,z);for(let y=0,A=this.VA.length;y<A;y++)(u=this.VA[y])&&u(r)}}}static jac(r,u){const x=Array(6);x[0]=r.Category;x[1]=r.Type;x[2]=r.Target;x[3]=r.Message;x[4]=r.Id;x[5]=u;return x}}Object(t.a)(w,"DdaEventDispatch",null,[])},1382:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.taskPaneWidth="TaskPaneWidth";c.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";c.Zk="TaskPaneTitle";c.Sk="IconCssClass";c.OTd="TaskPaneIconUrl";c.QR="TaskPaneIconId";c.sB="NonPersistedSettings";
c.onTaskPaneClose="OnTaskPaneClose";c.GRc="ActionArgs";Object(t.a)(c,"PropertyNames",null,[])},1383:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);D=a(144);var c=a(88);class b extends D.a{constructor(){super(void 0,void 0,void 0,!0);this.nCa="AddinCommandsUILessDialog";this.EQc="WACDialogTitleText";this.rea="0";this.YW=380;this.Yoa=190;this.Ae=this.nCa;this.Sb=5;this.amg=String.format("{0}px",this.YW);this.qea=String.format("{0}px",this.Yoa);this.k5e=this.it=!1;this.Lz()}Lz(){super.Lz();this.Jk.style.width=
this.amg;this.Jk.style.height=this.qea;this.Jk.style.padding=this.rea}xv(d){this.tI();document.getElementById(this.ei(this.EQc)).innerText=d}tI(){super.tI();this.vb.style.width=String.format("{0}px",this.YW);this.vb.style.height=String.format("{0}px",this.Yoa);this.vb.removeAttribute(c.a.Kd);this.vb.removeAttribute(c.a.pE)}hide(){this.xwb()}get ata(){return this.Jk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(t.a)(b,"AddinCommandsUILessDialog",
D.a,[795])},1413:function(t,D,a){a.r(D);var c=a(505),b=a(950),d=a(1177),f=a(10),e=a(0),k=a(220),l=a(184),m=a(581);class v{constructor(){this.Dfb=null}get XMg(){this.Dfb||(this.Dfb=new l.a,this.Dfb.add(12),this.Dfb.add(11));return this.Dfb}Rdi(O){return this.XMg.contains(O.operation)}NNj(O){const Ma=[],Cb=O.payload;for(const lc of Cb.batchedOperations)Ma.push(new m.a(O.operation,lc));return Ma}}Object(e.a)(v,"MacroRecorderBatchedEventList",null,[]);var n=a(15),w=a(58),r=a(120),u=a(636);class x{equals(O,
Ma){return O===Ma}getHashCode(O){return O}Jia(O){return O}}Object(e.a)(x,"UserOperationNameComparer",null,[123,124]);class z{static A_h(){z.Jc||(z.Jc=new u.a(new x),z.Jc.add(507),z.Jc.add(10),z.Jc.add(576),z.Jc.add(563),z.Jc.add(564),z.Jc.add(565),z.Jc.add(566),z.Jc.add(567),z.Jc.add(568),z.Jc.add(569),z.Jc.add(570),z.Jc.add(571),z.Jc.add(572),z.Jc.add(573),z.Jc.add(574),z.Jc.add(575),z.Jc.add(501),z.Jc.add(520),z.Jc.add(1),z.Jc.add(1002),z.Jc.add(129),z.Jc.add(198),z.Jc.add(500),z.Jc.add(519),z.Jc.add(538),
z.Jc.add(1E3),z.Jc.add(1003),z.Jc.add(144),z.Jc.add(502),z.Jc.add(505),z.Jc.add(179),z.Jc.add(205),z.Jc.add(134),z.Jc.add(230),z.Jc.add(103),z.Jc.add(110),z.Jc.add(112),z.Jc.add(113),z.Jc.add(124),z.Jc.add(133),z.Jc.add(154),z.Jc.add(162),z.Jc.add(168),z.Jc.add(172),z.Jc.add(201),z.Jc.add(222),z.Jc.add(227),z.Jc.add(513),z.Jc.add(534),z.Jc.add(539),z.Jc.add(545),z.Jc.add(600),z.Jc.add(547),z.Jc.add(555),z.Jc.add(558),z.Jc.add(562),z.Jc.add(585),z.Jc.add(1001),z.Jc.add(1005),z.Jc.add(1008),z.Jc.add(1010),
z.Jc.add(1011),z.Jc.add(1012),z.Jc.add(1018),z.Jc.add(252),z.Jc.add(253),z.Jc.add(258),z.Jc.add(101),z.Jc.add(102),z.Jc.add(108),z.Jc.add(257),z.Jc.add(119),z.Jc.add(120),z.Jc.add(123),z.Jc.add(126),z.Jc.add(127),z.Jc.add(130),z.Jc.add(140),z.Jc.add(159),z.Jc.add(160),z.Jc.add(165),z.Jc.add(166),z.Jc.add(167),z.Jc.add(169),z.Jc.add(189),z.Jc.add(223),z.Jc.add(214),z.Jc.add(228),z.Jc.add(233),z.Jc.add(247),z.Jc.add(504),z.Jc.add(511),z.Jc.add(512),z.Jc.add(525),z.Jc.add(533),z.Jc.add(537),z.Jc.add(542),
z.Jc.add(544),z.Jc.add(548),z.Jc.add(550),z.Jc.add(551),z.Jc.add(552),z.Jc.add(554),z.Jc.add(577),z.Jc.add(584),z.Jc.add(586),z.Jc.add(587),z.Jc.add(588),z.Jc.add(592),z.Jc.add(1009),z.Jc.add(1016),z.Jc.add(1017));return z.Jc}}z.Jc=null;Object(e.a)(z,"MacroRecorderUnrecognizedEventList",null,[]);class B{constructor(O,Ma,Cb){this.f8b=null;this.Owi=(lc,Dc)=>{this.$0f()&&this.Z9c(Dc)};this.Enf=Ma;this.Dnf=Cb;this.$=O;this.$.Xaa&&this.$.rFg(this.Owi);O.da.Ga(297,this)}init(O){this.$.Xaa&&(O?this.f8b=
O:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Z9c(O){if(this.$0f())try{if(this.Dnf.Rdi(O)){const Ma=this.Dnf.NNj(O);for(const Cb of Ma)this.YRe(Cb)}else this.YRe(O)}catch(Ma){O=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${r.a(O.operation)}, Exception: ${Ma.stack}`,n.ULS.sendTraceTag(537155423,0,10,O)}}YRe(O){var Ma=this.Enf.kZe(O,!0);Ma?(this.f8b(Ma.eventId,w.a.Ac(O.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ma.eventId}`)):
(Ma=this.Enf.kZe(O,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ma.eventId}, but failed to match filters`):z.A_h().contains(O.operation)||(this.f8b(0,w.a.Ac(O.operation)),O=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${r.a(O.operation)}`,n.ULS.sendTraceTag(537155420,0,50,O))}$0f(){return this.$.Uja&&this.f8b&&this.$.Taa?!0:!1}}Object(e.a)(B,"MacroRecorderEventHandler",null,[747]);var y=a(1);class A{constructor(){this.zGc=
this.AGc=this.AMc=this.aRc=null}get operations(){this.AMc||(this.AMc=new l.a,this.Zb());return this.AMc}get ZAc(){this.aRc||(this.aRc=new l.a,this.mg());return this.aRc}get CQe(){this.zGc||(this.zGc=new l.a);return this.zGc}get featureGates(){this.AGc||(this.AGc=new l.a,this.Bva());return this.AGc}mg(){}Bva(){}kd(O){this.ZAc.add(O)}Pb(O){this.operations.contains(O)||this.operations.add(O)}Wlb(){this.featureGates.add(668)}bke(O){this.CQe.add(O)}}Object(e.a)(A,"MacroRecorderEventBase",null,[]);class K extends A{constructor(){super()}get eventId(){return 130}Zb(){this.Pb(100)}}
Object(e.a)(K,"AccessibilityCheckRunEvent",A,[]);class G extends A{constructor(){super()}get eventId(){return 160}Zb(){this.Pb(241)}mg(){this.kd(O=>O.addToPrintArea)}}Object(e.a)(G,"AddedToPrintAreaEvent",A,[]);class T extends A{constructor(){super()}get eventId(){return 65}Zb(){this.Pb(516)}}Object(e.a)(T,"AutoFilterToggledEvent",A,[]);class W extends A{constructor(){super()}get eventId(){return 118}Zb(){this.Pb(502)}mg(){this.kd(O=>!(O.E3a().FirstColumn===O.E3a().LastColumn&&O.E3a().FirstRow===
O.E3a().LastRow))}}Object(e.a)(W,"AutoSumEvent",A,[]);class P extends A{constructor(O,Ma){super();this.Gea=O;this.FUj=Ma}get eventId(){return this.Gea}Zb(){this.Pb(529);this.Pb(594)}mg(){this.kd(O=>this.FUj.includes(O.Sdd()))}}Object(e.a)(P,"ChartPropertyAppliedEventBase",A,[]);class E extends P{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(E,"ChartAxisChangedEvent",P,[]);class H extends P{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,
307,308,309,310,311])}}Object(e.a)(H,"ChartAxisTitleChangedEvent",P,[]);class F extends P{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(F,"ChartDataLabelsChangedEvent",P,[]);class N extends P{constructor(){super(76,[-100])}}Object(e.a)(N,"ChartDataSelectedEvent",P,[]);class J extends P{constructor(){super(83,[500,501,502])}}Object(e.a)(J,"ChartDataTableChangedEvent",P,[]);var R=a(548),M=a(412),L=a(84);class U extends A{constructor(){super()}}Object(e.a)(U,"RichApiRequestExecutedEventBase",
A,[]);class X{constructor(O,Ma,Cb){this.response=this.request=this.eventId=this.source=null;O&&(this.source=O.source,this.eventId=O.eventId,this.request=Ma,this.response=Cb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(X,"MacroRecorderRichApiRequestExecutedPayload",null,[116]);class da extends U{constructor(){super()}get eventId(){return 117}sF(O){da.g6||(da.g6=new u.a(R.a.Rk()),da.g6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
da.g6.add("fa000000014"));return!!O&&da.g6.contains(O.toLowerCase())}Zb(){this.Pb(507);this.Pb(10);this.Pb(576)}mg(){this.kd(O=>Object(M.a)(X,O)&&(O=Object(L.a)(X,O),O.isValid&&this.sF(O.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${O.eventId}`),!0):!1)}}da.g6=null;Object(e.a)(da,"ChartFormatRichApiRequestExecutedEvent",U,[]);class fa extends P{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(e.a)(fa,
"ChartGridlinesChangedEvent",P,[]);class S extends A{constructor(){super()}get eventId(){return 66}Zb(){this.Pb(528)}}Object(e.a)(S,"ChartInsertedEvent",A,[]);class ka extends P{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(e.a)(ka,"ChartLegendChangedEvent",P,[]);class V extends P{constructor(){super(75,[-101])}}Object(e.a)(V,"ChartRowColumnSwitchedEvent",P,[]);class wa extends P{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(wa,"ChartTitleChangedEvent",P,[]);class ma extends P{constructor(){super(78,
[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(e.a)(ma,"ChartTypeChangedEvent",P,[]);class ab extends A{constructor(){super()}get eventId(){return 131}Zb(){this.Pb(521)}}Object(e.a)(ab,"ConnectorFloatingObjectResizedEvent",A,[]);class ba extends A{constructor(){super()}get eventId(){return 129}Zb(){this.Pb(109)}}Object(e.a)(ba,"EntitySelectedEvent",A,[]);class Ca extends A{constructor(){super()}get eventId(){return 49}Zb(){this.Pb(149);
this.Pb(147)}}Object(e.a)(Ca,"FindCellEvent",A,[]);class Na extends A{constructor(){super()}get eventId(){return 96}Zb(){this.Pb(122)}}Object(e.a)(Na,"FloatingObjectAltTextAppliedEvent",A,[]);class za extends A{constructor(){super()}get eventId(){return 93}Zb(){this.Pb(522)}}Object(e.a)(za,"FloatingObjectDeletedEvent",A,[]);class la extends A{constructor(){super()}get eventId(){return 94}Zb(){this.Pb(524)}}Object(e.a)(la,"FloatingObjectMovedAndResizedEvent",A,[]);class aa extends A{constructor(){super()}get eventId(){return 95}Zb(){this.Pb(523)}}
Object(e.a)(aa,"FloatingObjectRotatedEvent",A,[]);class sa extends A{constructor(){super()}get eventId(){return 100}Zb(){this.Pb(543)}}Object(e.a)(sa,"GroupDetailsShownOrHiddenEvent",A,[]);class ea extends A{constructor(){super()}get eventId(){return 154}Zb(){this.Pb(125)}}Object(e.a)(ea,"HyperlinksRemovedFromRangeEvent",A,[]);class Z extends U{constructor(){super()}get eventId(){return 125}sF(O){Z.g6||(Z.g6=new u.a(R.a.Rk()),Z.g6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Z.g6.add("fa000000005"));
return!!O&&Z.g6.contains(O.toLowerCase())}Zb(){this.Pb(507);this.Pb(10);this.Pb(576)}mg(){this.kd(O=>Object(M.a)(X,O)?(O=Object(L.a)(X,O),O.isValid&&this.sF(O.source)):!1)}}Z.g6=null;Object(e.a)(Z,"IdeasRichApiRequestExecutedEvent",U,[]);class ua extends A{constructor(){super()}get eventId(){return 136}Zb(){this.Pb(115)}}Object(e.a)(ua,"LinkedEntityConvertedEvent",A,[]);class ya extends A{constructor(){super()}get eventId(){return 148}Zb(){this.Pb(114)}}Object(e.a)(ya,"LinkedEntityDisambiguationPaneToggledEvent",
A,[]);class ha extends A{constructor(){super()}get eventId(){return 127}Zb(){this.Pb(119)}}Object(e.a)(ha,"MovedToEdgeEvent",A,[]);class Da extends A{constructor(){super()}get eventId(){return 135}Zb(){this.Pb(191)}Bva(){this.Wlb()}}Object(e.a)(Da,"NamedSheetViewCreatedEvent",A,[]);class nb extends A{constructor(){super()}get eventId(){return 166}Zb(){this.Pb(200)}Bva(){this.Wlb()}}Object(e.a)(nb,"NamedSheetViewDeletedEvent",A,[]);class qa extends A{constructor(){super()}get eventId(){return 133}Zb(){this.Pb(192)}Bva(){this.Wlb()}}
Object(e.a)(qa,"NamedSheetViewExitedEvent",A,[]);class pa extends A{constructor(){super()}get eventId(){return 162}Zb(){this.Pb(199)}Bva(){this.Wlb()}}Object(e.a)(pa,"NamedSheetViewRenamedEvent",A,[]);class Ja extends A{constructor(){super()}get eventId(){return 167}Zb(){this.Pb(195)}Bva(){this.Wlb()}}Object(e.a)(Ja,"NamedSheetViewSwitchedEvent",A,[]);class $a extends A{constructor(){super()}get eventId(){return 99}Zb(){this.Pb(174)}}Object(e.a)($a,"OutlineLevelSetEvent",A,[]);class rb extends A{constructor(){super()}get eventId(){return 156}Zb(){this.Pb(244)}}
Object(e.a)(rb,"PageBreakInsertedEvent",A,[]);class Pa extends A{constructor(){super()}get eventId(){return 157}Zb(){this.Pb(245)}}Object(e.a)(Pa,"PageBreakRemovedEvent",A,[]);class eb extends A{constructor(){super()}get eventId(){return 158}Zb(){this.Pb(246)}}Object(e.a)(eb,"PageBreaksAllResetEvent",A,[]);class Ob extends A{constructor(){super()}get eventId(){return 112}Zb(){this.Pb(503)}mg(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&
!O.isFromCurrentSession)}}Object(e.a)(Ob,"PasteArtOtherWorkbookEvent",A,[]);class tb extends A{constructor(){super()}get eventId(){return 52}Zb(){this.Pb(503)}mg(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&O.isFromCurrentSession)}}Object(e.a)(tb,"PasteArtSameWorkbookEvent",A,[]);class cc extends A{constructor(){super()}get eventId(){return 110}Zb(){this.Pb(204)}}Object(e.a)(cc,"PasteHtmlEvent",A,[]);class Ib extends A{constructor(){super()}get eventId(){return 35}Zb(){this.Pb(506)}}
Object(e.a)(Ib,"PasteRangeEvent",A,[]);class Mb extends A{constructor(){super()}get eventId(){return 111}Zb(){this.Pb(503)}mg(){this.kd(O=>1===O.pasteParameters.CopyPasteTargetType)}}Object(e.a)(Mb,"PasteShadowWorkbookRangeEvent",A,[]);class Oa extends A{constructor(){super()}get eventId(){return 42}Zb(){this.Pb(180)}}Object(e.a)(Oa,"PasteStringEvent",A,[]);class Aa extends A{constructor(){super()}get eventId(){return 134}Zb(){this.Pb(220)}}Object(e.a)(Aa,"PendingMergeEvent",A,[]);class Ba extends A{constructor(){super()}get eventId(){return 122}Zb(){this.Pb(510)}}
Object(e.a)(Ba,"PictureInsertedEvent",A,[]);class ob extends A{constructor(){super()}get eventId(){return 153}Zb(){this.Pb(161)}}Object(e.a)(ob,"PivotDrillToggledEvent",A,[]);class xb extends A{constructor(O,Ma){super();this.Gea=O;this.opType=Ma}get eventId(){return this.Gea}Zb(){this.Pb(225)}mg(){this.kd(O=>O.opType===this.opType)}}Object(e.a)(xb,"PivotTableSettingsChangedEventBase",A,[]);class Va extends xb{constructor(){super(171,4)}}Object(e.a)(Va,"PivotTableAllItemLabelsRepeatedEvent",xb,[]);
class bb extends xb{constructor(){super(184,17)}}Object(e.a)(bb,"PivotTableAltTextDescriptionChangedEvent",xb,[]);class ra extends xb{constructor(){super(183,16)}}Object(e.a)(ra,"PivotTableAltTextTitleChangedEvent",xb,[]);class Qa extends xb{constructor(){super(173,6)}}Object(e.a)(Qa,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",xb,[]);class qb extends xb{constructor(){super(172,5)}}Object(e.a)(qb,"PivotTableBlankLineAfterEachItemToggledEvent",xb,[]);class Wa extends xb{constructor(){super(170,
3)}}Object(e.a)(Wa,"PivotTableColumnGrandTotalShownEvent",xb,[]);class ta extends A{constructor(){super()}get eventId(){return 98}Zb(){this.Pb(132)}}Object(e.a)(ta,"PivotTableCreatedEvent",A,[]);class ib extends xb{constructor(){super(177,10)}}Object(e.a)(ib,"PivotTableDisplayErrorStringToggledEvent",xb,[]);class Bb extends xb{constructor(){super(178,11)}}Object(e.a)(Bb,"PivotTableDisplayNullStringToggledEvent",xb,[]);class Ub extends xb{constructor(){super(179,12)}}Object(e.a)(Ub,"PivotTableErrorStringChangedEvent",
xb,[]);class Ta extends xb{constructor(){super(174,7)}}Object(e.a)(Ta,"PivotTableExpandCollapseButtonsShownEvent",xb,[]);class mb extends xb{constructor(){super(187,20)}}Object(e.a)(mb,"PivotTableIndentChangedEvent",xb,[]);class Qb extends xb{constructor(){super(176,9)}}Object(e.a)(Qb,"PivotTableItemsWithNoDataOnColumnsShownEvent",xb,[]);class Lb extends xb{constructor(){super(175,8)}}Object(e.a)(Lb,"PivotTableItemsWithNoDataOnRowsShownEvent",xb,[]);class Jb extends xb{constructor(){super(186,19)}}
Object(e.a)(Jb,"PivotTableLayoutTypeSetEvent",xb,[]);class Ab extends xb{constructor(){super(180,13)}}Object(e.a)(Ab,"PivotTableNullStringChangedEvent",xb,[]);class pb extends A{constructor(){super()}get eventId(){return 149}Zb(){this.Pb(219)}}Object(e.a)(pb,"PivotTablePivotLocationChangedEvent",A,[]);class va extends A{constructor(){super()}get eventId(){return 102}Zb(){this.Pb(145)}}Object(e.a)(va,"PivotTablePivotedEvent",A,[]);class db extends xb{constructor(){super(182,15)}}Object(e.a)(db,"PivotTableRefreshDataOnLoadToggledEvent",
xb,[]);class Ya extends A{constructor(){super()}get eventId(){return 104}Zb(){this.Pb(50)}mg(){this.kd(O=>!!O.pivotTableId&&!!O.pivotTableName)}}Object(e.a)(Ya,"PivotTableRefreshedEvent",A,[]);class gb extends xb{constructor(){super(168,1)}}Object(e.a)(gb,"PivotTableRenamedEvent",xb,[]);class Ka extends xb{constructor(){super(169,2)}}Object(e.a)(Ka,"PivotTableRowGrandTotalShownEvent",xb,[]);class ub extends xb{constructor(){super(181,14)}}Object(e.a)(ub,"PivotTableSaveSourceDataWithFileToggledEvent",
xb,[]);var ac=a(602);class Ra extends A{constructor(){super()}get eventId(){return 155}Zb(){this.Pb(131)}mg(){this.kd(O=>{O=Object(L.a)(ac.a,O);return!!O&&!!O.oJa()&&!!O.hierarchyName})}}Object(e.a)(Ra,"PivotTableSortedEvent",A,[]);class na extends xb{constructor(){super(185,18)}}Object(e.a)(na,"PivotTableSubTotalsVisibilitySettingSetEvent",xb,[]);class lb extends A{constructor(){super()}get eventId(){return 206}Zb(){this.Pb(560)}}Object(e.a)(lb,"PivotValueFieldSettingAppliedEvent",A,[]);class jb extends A{constructor(){super()}get eventId(){return 161}Zb(){this.Pb(243)}}
Object(e.a)(jb,"PrintAreaClearedEvent",A,[]);class Yb extends A{constructor(){super()}get eventId(){return 159}Zb(){this.Pb(241)}mg(){this.kd(O=>!O.addToPrintArea)}}Object(e.a)(Yb,"PrintAreaSetEvent",A,[]);class Gb extends A{constructor(){super()}get eventId(){return 57}Zb(){this.Pb(517)}}Object(e.a)(Gb,"RangeAutoFilterClearedEvent",A,[]);class wb extends A{constructor(O,Ma){super();this.Gea=O;this.tYd=Ma}get eventId(){return this.Gea}Zb(){this.Pb(11)}mg(){this.kd(O=>16===O.HY().ValidMembers);this.kd(O=>
O.HY().Font.ValidMembers===this.tYd)}}Object(e.a)(wb,"RangeFontFormattedEventBase",A,[]);class dc extends wb{constructor(){super(3,4)}}Object(e.a)(dc,"RangeBoldedEvent",wb,[]);class Jc extends A{constructor(){super()}get eventId(){return 2}Zb(){this.Pb(11)}mg(){this.kd(O=>128===O.HY().ValidMembers)}}Object(e.a)(Jc,"RangeBorderedEvent",A,[]);class Qc{}Qc.F9a="Table";Qc.knc="Sheet";Object(e.a)(Qc,"MacroRecorderEventConstants",null,[]);class fd extends A{constructor(){super()}get eventId(){return 113}Zb(){this.Pb(208)}mg(){this.kd(O=>
O.getParameters().FilterType===Qc.knc)}}Object(e.a)(fd,"RangeCheckedItemsFilteredEvent",A,[]);class Wc extends A{constructor(){super()}get eventId(){return 109}Zb(){this.Pb(105)}}Object(e.a)(Wc,"RangeConditionalFormattingCreatedEvent",A,[]);class Rb extends A{constructor(){super()}get eventId(){return 124}Zb(){this.Pb(221)}}Object(e.a)(Rb,"RangeConditionalFormattingRuleDeletedEvent",A,[]);class Sb extends A{constructor(){super()}get eventId(){return 29}Zb(){this.Pb(508)}mg(){this.kd(O=>3===O.$s()||
1===O.$s()||4===O.$s())}}Object(e.a)(Sb,"RangeContentClearedEvent",A,[]);class mc extends A{constructor(){super()}get eventId(){return 40}Zb(){this.Pb(104)}}Object(e.a)(mc,"RangeCopiedCutCellsInsertedEvent",A,[]);class ec extends A{constructor(){super()}get eventId(){return 114}Zb(){this.Pb(209)}mg(){this.kd(O=>O.getParameters().FilterType===Qc.knc)}}Object(e.a)(ec,"RangeCustomFilteredEvent",A,[]);class Rc extends A{constructor(){super()}get eventId(){return 106}Zb(){this.Pb(121)}}Object(e.a)(Rc,
"RangeDataValidationChangedEvent",A,[]);class Mc extends wb{constructor(){super(4,64)}}Object(e.a)(Mc,"RangeDoubleUnderlinedEvent",wb,[]);class bc extends A{constructor(){super()}get eventId(){return 69}Zb(){this.Pb(190)}}Object(e.a)(bc,"RangeDuplicatesRemovedEvent",A,[]);class ic extends A{constructor(){super()}get eventId(){return 1}Zb(){this.Pb(527);this.Pb(12)}}Object(e.a)(ic,"RangeEditedEvent",A,[]);class Yc extends A{constructor(){super()}get eventId(){return 164}Zb(){this.Pb(255)}mg(){this.kd(O=>
4===O.actionType)}}Object(e.a)(Yc,"RangeExternalLinksBrokeAllLinksEvent",A,[]);class md extends A{constructor(){super()}get eventId(){return 119}Zb(){this.Pb(255)}mg(){this.kd(O=>3===O.actionType)}}Object(e.a)(md,"RangeExternalLinksBrokeLinkEvent",A,[]);class id extends A{constructor(){super()}get eventId(){return 205}Zb(){this.Pb(256)}Bva(){this.bke("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(e.a)(id,"RangeExternalLinksChangeSourceEvent",A,[]);class xd extends A{constructor(){super()}get eventId(){return 163}Zb(){this.Pb(553)}mg(){this.kd(O=>
1===O.actionType)}}Object(e.a)(xd,"RangeExternalLinksRefreshedAllEvent",A,[]);class Lc extends A{constructor(){super()}get eventId(){return 77}Zb(){this.Pb(553)}mg(){this.kd(O=>0===O.actionType)}}Object(e.a)(Lc,"RangeExternalLinksRefreshedEvent",A,[]);class Pb extends A{constructor(){super()}get eventId(){return 165}Zb(){this.Pb(224)}}Object(e.a)(Pb,"RangeExternalLinksSetAutoRefreshEvent",A,[]);class Gc extends A{constructor(){super()}get eventId(){return 5}Zb(){this.Pb(11)}mg(){this.kd(O=>64===O.HY().ValidMembers)}}
Object(e.a)(Gc,"RangeFillColoredEvent",A,[]);class Nb extends A{constructor(){super()}get eventId(){return 59}Zb(){this.Pb(155)}}Object(e.a)(Nb,"RangeFilledEvent",A,[]);class yc extends A{constructor(){super()}get eventId(){return 115}Zb(){this.Pb(176)}mg(){this.kd(O=>O.yU().AutoFilterType===Qc.knc&&!!O.yU().CriteriaType)}}Object(e.a)(yc,"RangeFilterAppliedEvent",A,[]);class Tc extends A{constructor(){super()}get eventId(){return 58}Zb(){this.Pb(176)}mg(){this.kd(O=>O.yU().AutoFilterType===Qc.knc&&
!O.yU().CriteriaType)}}Object(e.a)(Tc,"RangeFilterClearedEvent",A,[]);class gd extends A{constructor(){super()}get eventId(){return 41}Zb(){this.Pb(518)}}Object(e.a)(gd,"RangeFilterReappliedEvent",A,[]);class Ad extends A{constructor(){super()}get eventId(){return 86}Zb(){this.Pb(150)}}Object(e.a)(Ad,"RangeFlashFilledEvent",A,[]);class Od extends wb{constructor(){super(6,32)}}Object(e.a)(Od,"RangeFontColoredEvent",wb,[]);class Pd extends wb{constructor(){super(7,8)}}Object(e.a)(Pd,"RangeFontItalicizedEvent",
wb,[]);class Md extends wb{constructor(){super(8,1)}}Object(e.a)(Md,"RangeFontNamedEvent",wb,[]);class ge extends wb{constructor(){super(9,2)}}Object(e.a)(ge,"RangeFontSizedEvent",wb,[]);class pe extends A{constructor(){super()}get eventId(){return 74}Zb(){this.Pb(215)}}Object(e.a)(pe,"RangeFormattedAsTableEvent",A,[]);class Qd extends A{constructor(){super()}get eventId(){return 97}Zb(){this.Pb(188)}}Object(e.a)(Qd,"RangeGroupedOrUngroupedEvent",A,[]);class he extends A{constructor(){super()}get eventId(){return 60}Zb(){this.Pb(11)}mg(){this.kd(O=>
2===O.HY().ValidMembers)}}Object(e.a)(he,"RangeHorizontallyAlignedEvent",A,[]);class ue extends A{constructor(){super()}get eventId(){return 43}Zb(){this.Pb(526)}}Object(e.a)(ue,"RangeHyperlinkAppliedEvent",A,[]);class je extends A{constructor(){super()}get eventId(){return 63}Zb(){this.Pb(11)}mg(){this.kd(O=>256===O.HY().ValidMembers)}}Object(e.a)(je,"RangeIndentChangedEvent",A,[]);class Ge extends A{constructor(){super()}get eventId(){return 53}Zb(){this.Pb(156)}mg(){this.kd(O=>2===O.$s()||5===
O.$s()||6===O.$s()||7===O.$s())}}Object(e.a)(Ge,"RangeMergedEvent",A,[]);class Ce extends A{constructor(){super()}get eventId(){return 107}Zb(){this.Pb(216)}}Object(e.a)(Ce,"RangeNamedCellStyleAppliedEvent",A,[]);class pc extends A{constructor(){super()}get eventId(){return 12}Zb(){this.Pb(11)}mg(){this.kd(O=>32===O.HY().ValidMembers)}}Object(e.a)(pc,"RangeNumberFormattedEvent",A,[]);var Uc=a(952);class hd extends A{constructor(){super()}get eventId(){return 108}Zb(){this.Pb(141)}mg(){this.kd(O=>
Object(M.a)(Uc.a,O))}}Object(e.a)(hd,"RangeSortedEvent",A,[]);class yd extends wb{constructor(){super(10,128)}}Object(e.a)(yd,"RangeStrikedThroughEvent",wb,[]);class wd extends wb{constructor(){super(11,16)}}Object(e.a)(wd,"RangeUnderlinedEvent",wb,[]);class I extends A{constructor(){super()}get eventId(){return 61}Zb(){this.Pb(11)}mg(){this.kd(O=>1===O.HY().ValidMembers)}}Object(e.a)(I,"RangeVerticallyAlignedEvent",A,[]);class xa extends A{constructor(){super()}get eventId(){return 62}Zb(){this.Pb(11)}mg(){this.kd(O=>
8===O.HY().ValidMembers)}}Object(e.a)(xa,"RangeWrapTextToggledEvent",A,[]);class Ua extends A{constructor(){super()}get eventId(){return 103}Zb(){this.Pb(51)}}Object(e.a)(Ua,"RefreshedAllEvent",A,[]);class vb extends A{constructor(){super()}get eventId(){return 47}Zb(){this.Pb(148)}}Object(e.a)(vb,"ReplaceAllEvent",A,[]);class cb extends A{constructor(){super()}get eventId(){return 91}Zb(){this.Pb(532)}mg(){this.kd(O=>95!==O.getShapeType()&&96!==O.getShapeType()&&97!==O.getShapeType()&&98!==O.getShapeType()&&
100!==O.getShapeType()&&102!==O.getShapeType()&&103!==O.getShapeType())}}Object(e.a)(cb,"ShapeInsertedEvent",A,[]);class Xb extends A{constructor(){super()}get eventId(){return 92}Zb(){this.Pb(531)}}Object(e.a)(Xb,"ShapeStyleSetEvent",A,[]);var rc=a(808);class Ec extends A{constructor(O,Ma){super();this.Gea=O;this.tYd=Ma}get eventId(){return this.Gea}Zb(){this.Pb(581)}mg(){this.kd(O=>Object(M.a)(rc.a,O)&&4===O.getShapeTextFormat().ValidMembers);this.kd(O=>Object(M.a)(rc.a,O)&&O.getShapeTextFormat().Font.ValidMembers===
this.tYd)}}Object(e.a)(Ec,"ShapeTextFontFormattedEventBase",A,[]);class ed extends Ec{constructor(){super(193,4)}}Object(e.a)(ed,"ShapeTextBoldedEvent",Ec,[]);var ud=a(954);class Kd extends A{constructor(){super()}get eventId(){return 191}Zb(){this.Pb(581)}mg(){this.kd(O=>Object(M.a)(ud.a,O))}}Object(e.a)(Kd,"ShapeTextChangedEvent",A,[]);class Zd extends Ec{constructor(){super(196,32)}}Object(e.a)(Zd,"ShapeTextFontColorChangedEvent",Ec,[]);class Xd extends Ec{constructor(){super(197,1)}}Object(e.a)(Xd,
"ShapeTextFontNameChangedEvent",Ec,[]);class Je extends Ec{constructor(){super(198,2)}}Object(e.a)(Je,"ShapeTextFontSizeChangedEvent",Ec,[]);class Xe extends A{constructor(){super()}get eventId(){return 199}Zb(){this.Pb(581)}mg(){this.kd(O=>Object(M.a)(rc.a,O)&&2===O.getShapeTextFormat().ValidMembers)}}Object(e.a)(Xe,"ShapeTextHorizontallyAlignedEvent",A,[]);class Ke extends Ec{constructor(){super(194,8)}}Object(e.a)(Ke,"ShapeTextItalicizedEvent",Ec,[]);class Qe extends Ec{constructor(){super(195,
16)}}Object(e.a)(Qe,"ShapeTextUnderlinedEvent",Ec,[]);class df extends A{constructor(){super()}get eventId(){return 200}Zb(){this.Pb(581)}mg(){this.kd(O=>Object(M.a)(rc.a,O)&&1===O.getShapeTextFormat().ValidMembers)}}Object(e.a)(df,"ShapeTextVerticallyAlignedEvent",A,[]);class Ne extends A{constructor(){super()}get eventId(){return 13}Zb(){this.Pb(138)}}Object(e.a)(Ne,"SheetAddedEvent",A,[]);var jf=a(8);class Le extends A{constructor(){super()}get eventId(){return 142}Zb(){this.Pb(237)}mg(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==jf.a.ay)||!O.DeltaColumn&&0>O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==jf.a.pv)})}}Object(e.a)(Le,"SheetCellsDeletedEvent",A,[]);class me extends A{constructor(){super()}get eventId(){return 143}Zb(){this.Pb(237)}mg(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==jf.a.ay)||!O.DeltaColumn&&0<O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==jf.a.pv)})}}Object(e.a)(me,"SheetCellsInsertedEvent",A,[]);class Za extends A{constructor(){super()}get eventId(){return 139}Zb(){this.Pb(237)}mg(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===jf.a.ay)}}Object(e.a)(Za,"SheetColumnDeletedEvent",
A,[]);class Tb extends A{constructor(){super()}get eventId(){return 138}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
jf.a.ay)}}Object(e.a)(Tb,"SheetColumnInsertedEvent",A,[]);class uc extends A{constructor(){super()}get eventId(){return 14}Zb(){this.Pb(137)}}Object(e.a)(uc,"SheetDeletedEvent",A,[]);class Oc extends A{constructor(){super()}get eventId(){return 137}Zb(){this.Pb(185)}}Object(e.a)(Oc,"SheetDirectionChangedEvent",A,[]);class sb extends A{constructor(){super()}get eventId(){return 54}Zb(){this.Pb(139)}}Object(e.a)(sb,"SheetDuplicatedEvent",A,[]);class $b extends A{constructor(){super()}get eventId(){return 15}Zb(){this.Pb(207)}}
Object(e.a)($b,"SheetNameEditedEvent",A,[]);class xc extends A{constructor(){super()}get eventId(){return 90}Zb(){this.Pb(151)}}Object(e.a)(xc,"SheetPaneFrozenEvent",A,[]);class ad extends A{constructor(){super()}get eventId(){return 120}Zb(){this.Pb(226)}}Object(e.a)(ad,"SheetPrintSettingsSavedEvent",A,[]);var Dd=a(853);class ie extends A{constructor(){super()}get eventId(){return 215}Zb(){this.Pb(507)}Bva(){this.bke("Microsoft.Office.Excel.SheetProtectionMacroRecording")}mg(){this.kd(O=>Object.getType(O)===
Dd.a)}}Object(e.a)(ie,"SheetProtectionPausedResumedEvent",A,[]);class $d extends A{constructor(){super()}get eventId(){return 64}Zb(){this.Pb(557)}}Object(e.a)($d,"SheetReorderedEvent",A,[]);class ne extends A{constructor(){super()}get eventId(){return 141}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===jf.a.pv)}}Object(e.a)(ne,"SheetRowDeletedEvent",A,[]);class ye extends A{constructor(){super()}get eventId(){return 140}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===jf.a.pv)}}Object(e.a)(ye,"SheetRowInsertedEvent",A,[]);class te extends A{constructor(){super()}get eventId(){return 39}Zb(){this.Pb(135)}}Object(e.a)(te,"SheetRowsColumnsAutoFitEvent",A,[]);class Ze extends A{constructor(){super()}get eventId(){return 36}Zb(){this.Pb(136)}}
Object(e.a)(Ze,"SheetRowsColumnsResizedEvent",A,[]);class re extends A{constructor(){super()}get eventId(){return 68}Zb(){this.Pb(183)}}Object(e.a)(re,"SheetShowGridlinesToggledEvent",A,[]);class tc extends A{constructor(){super()}get eventId(){return 67}Zb(){this.Pb(184)}}Object(e.a)(tc,"SheetShowHeadingsToggledEvent",A,[]);class $c extends A{constructor(){super()}get eventId(){return 89}Zb(){this.Pb(213)}}Object(e.a)($c,"SheetSpellCheckedEvent",A,[]);class Ed extends A{constructor(){super()}get eventId(){return 70}Zb(){this.Pb(515)}}
Object(e.a)(Ed,"SheetTabColoredEvent",A,[]);class Id extends A{constructor(){super()}get eventId(){return 71}Zb(){this.Pb(157)}}Object(e.a)(Id,"SheetVisibilityChangedEvent",A,[]);class ae extends A{constructor(){super()}get eventId(){return 126}Zb(){this.Pb(239)}}Object(e.a)(ae,"SheetsVisibilityChangedEvent",A,[]);class ja extends A{constructor(){super()}get eventId(){return 188}Zb(){this.Pb(203)}}Object(e.a)(ja,"SlicerInsertedEvent",A,[]);class hb extends A{constructor(){super()}get eventId(){return 189}Zb(){this.Pb(173)}mg(){this.kd(O=>
!O.clearFilter)}}Object(e.a)(hb,"SlicerSelectionAppliedEvent",A,[]);class oa extends A{constructor(){super()}get eventId(){return 190}Zb(){this.Pb(173)}mg(){this.kd(O=>O.clearFilter)}}Object(e.a)(oa,"SlicerSelectionClearedEvent",A,[]);class fb extends A{constructor(){super()}get eventId(){return 27}Zb(){this.Pb(208)}mg(){this.kd(O=>O.getParameters().FilterType===Qc.F9a)}}Object(e.a)(fb,"TableCheckedItemsFilteredEvent",A,[]);class Eb extends A{constructor(){super()}get eventId(){return 144}Zb(){this.Pb(237)}mg(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Eb,"TableColumnDeletedEvent",A,[]);class jc extends A{constructor(){super()}get eventId(){return 145}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);
this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(jc,"TableColumnInsertedEvent",A,[]);var Hc=a(953);class qd extends A{constructor(){super()}get eventId(){return 121}Zb(){this.Pb(141)}mg(){this.kd(O=>Object(M.a)(Hc.a,O))}}Object(e.a)(qd,"TableColumnSortedEvent",A,[]);class zd extends A{constructor(){super()}get eventId(){return 105}Zb(){this.Pb(193)}}Object(e.a)(zd,
"TableConvertedToRangeEvent",A,[]);class Hd extends A{constructor(){super()}get eventId(){return 16}Zb(){this.Pb(206)}}Object(e.a)(Hd,"TableCreatedEvent",A,[]);class Yd extends A{constructor(){super()}get eventId(){return 30}Zb(){this.Pb(209)}mg(){this.kd(O=>O.getParameters().FilterType===Qc.F9a)}}Object(e.a)(Yd,"TableCustomFilteredEvent",A,[]);class se extends A{constructor(){super()}get eventId(){return 25}Zb(){this.Pb(187)}mg(){this.kd(O=>1===O.options.OperationType)}}Object(e.a)(se,"TableCustomSortedEvent",
A,[]);class Re extends A{constructor(){super()}get eventId(){return 28}Zb(){this.Pb(176)}mg(){this.kd(O=>O.yU().AutoFilterType===Qc.F9a);this.kd(O=>0===O.yU().CriteriaType)}}Object(e.a)(Re,"TableFilterClearedEvent",A,[]);class Ye extends A{constructor(){super()}get eventId(){return 32}Zb(){this.Pb(176)}mg(){this.kd(O=>O.yU().AutoFilterType===Qc.F9a);this.kd(O=>{const Ma=new l.a;Ma.add(1);Ma.add(2);Ma.add(8);Ma.add(9);Ma.add(10);Ma.add(11);Ma.add(12);Ma.add(13);Ma.add(14);Ma.add(15);Ma.add(16);Ma.add(17);
Ma.add(18);Ma.add(19);Ma.add(20);Ma.add(21);Ma.add(22);Ma.add(23);Ma.add(24);Ma.add(25);Ma.add(26);Ma.add(27);Ma.add(28);Ma.add(29);Ma.add(30);Ma.add(31);Ma.add(32);Ma.add(33);Ma.add(34);Ma.add(35);Ma.add(36);Ma.add(37);Ma.add(38);Ma.add(39);return Ma.contains(O.yU().CriteriaType)})}}Object(e.a)(Ye,"TableItemFilteredEvent",A,[]);class rf extends A{constructor(){super()}get eventId(){return 101}Zb(){this.Pb(217)}}Object(e.a)(rf,"TableRenamedEvent",A,[]);class tf extends A{constructor(){super()}get eventId(){return 73}Zb(){this.Pb(211)}}
Object(e.a)(tf,"TableResizedEvent",A,[]);class Bf extends A{constructor(){super()}get eventId(){return 44}Zb(){this.Pb(514)}}Object(e.a)(Bf,"TableRowColumnRearrangedEvent",A,[]);class Jf extends A{constructor(){super()}get eventId(){return 146}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(Jf,"TableRowDeletedEvent",A,[]);class Lf extends A{constructor(){super()}get eventId(){return 147}Zb(){this.Pb(237)}mg(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Lf,"TableRowInsertedEvent",A,[]);class fg extends A{constructor(){super()}get eventId(){return 26}Zb(){this.Pb(177)}mg(){this.kd(O=>
O.yU().AutoFilterType===Qc.F9a)}}Object(e.a)(fg,"TableSortedEvent",A,[]);class Bg extends A{constructor(){super()}get eventId(){return 87}Zb(){this.Pb(212)}}Object(e.a)(Bg,"TableStyleAppliedEvent",A,[]);class Sf extends A{constructor(){super()}get eventId(){return 88}Zb(){this.Pb(196)}}Object(e.a)(Sf,"TableStyleOptionToggledEvent",A,[]);class Ha extends A{constructor(){super()}get eventId(){return 31}Zb(){this.Pb(210)}mg(){this.kd(O=>O.getParameters().FilterType===Qc.F9a)}}Object(e.a)(Ha,"TableTop10FilteredEvent",
A,[]);class Db extends A{constructor(){super()}get eventId(){return 207}Zb(){this.Pb(238)}}Object(e.a)(Db,"TextToColumnsEvent",A,[]);class zc extends A{constructor(){super()}get eventId(){return 128}Zb(){this.Pb(559)}}Object(e.a)(zc,"ValuesSortedEvent",A,[]);class cd extends A{constructor(){super()}get eventId(){return 55}Zb(){this.Pb(197)}}Object(e.a)(cd,"WorkbookCalculationModeSetEvent",A,[]);class td extends A{constructor(){super()}get eventId(){return 34}Zb(){this.Pb(181)}mg(){this.kd(O=>!!O.parentCommentId)}}
Object(e.a)(td,"WorkbookCommentRepliedEvent",A,[]);class Sd extends A{constructor(){super()}get eventId(){return 33}Zb(){this.Pb(181)}mg(){this.kd(O=>!O.parentCommentId)}}Object(e.a)(Sd,"WorkbookCommentedEvent",A,[]);class oe extends A{constructor(){super()}get eventId(){return 56}Zb(){this.Pb(128)}}Object(e.a)(oe,"WorkbookRecalculatedEvent",A,[]);class le extends A{constructor(){super()}get eventId(){return 46}Zb(){this.Pb(171)}}Object(e.a)(le,"WorkbookRedoEvent",A,[]);class Te extends A{constructor(){super()}get eventId(){return 45}Zb(){this.Pb(170)}}
Object(e.a)(Te,"WorkbookUndoEvent",A,[]);class Me extends A{constructor(){super()}get eventId(){return 116}Zb(){this.Pb(507);this.Pb(576);this.Pb(10)}mg(){this.kd(O=>{if(Object(M.a)(X,O)&&(O=Object(L.a)(X,O),void 0!==O.source&&null!==O.source&&void 0!==O.eventId&&null!==O.eventId))return n.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${O.source}; eventId: ${O.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(e.a)(Me,"DefaultRichApiRequestExecutedEvent",A,[]);class cf extends A{constructor(){super()}get eventId(){return 216}Zb(){this.Pb(1022)}}Object(e.a)(cf,"TablelAltTextEditedEvent",A,[]);class Ae extends A{constructor(){super()}get eventId(){return 217}Zb(){this.Pb(263)}}Object(e.a)(Ae,"FloatingObjectZOrderChangedEvent",A,[]);class gf{constructor(O){this.zb=null;this.$=O}get macroRecorderEvents(){this.zb||(this.zb=new l.a,this.zb.add(new ic),this.zb.add(new Jc),this.zb.add(new dc),
this.zb.add(new Mc),this.zb.add(new Gc),this.zb.add(new Od),this.zb.add(new Pd),this.zb.add(new Md),this.zb.add(new ge),this.zb.add(new yd),this.zb.add(new wd),this.zb.add(new pc),this.zb.add(new Ne),this.zb.add(new uc),this.zb.add(new $b),this.zb.add(new Hd),this.zb.add(new Eb),this.zb.add(new jc),this.zb.add(new Jf),this.zb.add(new Lf),this.zb.add(new Tb),this.zb.add(new Za),this.zb.add(new ye),this.zb.add(new ne),this.zb.add(new se),this.zb.add(new fg),this.zb.add(new fb),this.zb.add(new Re),this.zb.add(new Sb),
this.zb.add(new Yd),this.zb.add(new Ha),this.zb.add(new Ye),this.zb.add(new Sd),this.zb.add(new td),this.zb.add(new Ib),this.zb.add(new Ze),this.zb.add(new Le),this.zb.add(new me),this.zb.add(new te),this.zb.add(new mc),this.zb.add(new gd),this.zb.add(new ue),this.zb.add(new Oa),this.zb.add(new Bf),this.zb.add(new le),this.zb.add(new Te),this.zb.add(new vb),this.zb.add(new Ca),this.zb.add(new tb),this.zb.add(new Ge),this.zb.add(new sb),this.zb.add(new cd),this.zb.add(new oe),this.zb.add(new Gb),this.zb.add(new Tc),
this.zb.add(new Nb),this.zb.add(new he),this.zb.add(new I),this.zb.add(new xa),this.zb.add(new je),this.zb.add(new $d),this.zb.add(new T),this.zb.add(new S),this.zb.add(new tc),this.zb.add(new re),this.zb.add(new bc),this.zb.add(new Id),this.zb.add(new Ed),this.zb.add(new tf),this.zb.add(new pe),this.zb.add(new V),this.zb.add(new N),this.zb.add(new Lc),this.zb.add(new ma),this.zb.add(new wa),this.zb.add(new H),this.zb.add(new ka),this.zb.add(new F),this.zb.add(new J),this.zb.add(new E),this.zb.add(new fa),
this.zb.add(new Ad),this.zb.add(new Bg),this.zb.add(new Sf),this.zb.add(new $c),this.zb.add(new xc),this.zb.add(new cb),this.zb.add(new Xb),this.zb.add(new za),this.zb.add(new la),this.zb.add(new aa),this.zb.add(new Na),this.zb.add(new Qd),this.zb.add(new ta),this.zb.add(new $a),this.zb.add(new sa),this.zb.add(new rf),this.zb.add(new va),this.zb.add(new Ua),this.zb.add(new Ya),this.zb.add(new zd),this.zb.add(new Rc),this.zb.add(new Ce),this.zb.add(new hd),this.zb.add(new Wc),this.zb.add(new cc),this.zb.add(new Mb),
this.zb.add(new Ob),this.zb.add(new fd),this.zb.add(new ec),this.zb.add(new yc),this.zb.add(new W),this.zb.add(new Ba),this.zb.add(new md),this.zb.add(new ad),this.zb.add(new qd),this.zb.add(new Rb),this.zb.add(new ae),this.zb.add(new ha),this.zb.add(new zc),this.zb.add(new ba),this.zb.add(new K),this.zb.add(new ab),this.zb.add(new qa),this.zb.add(new Aa),this.zb.add(new Da),this.zb.add(new ua),this.zb.add(new Oc),this.zb.add(new ya),this.zb.add(new pb),this.zb.add(new ob),this.zb.add(new ea),this.zb.add(new Ra),
this.zb.add(new rb),this.zb.add(new Pa),this.zb.add(new eb),this.zb.add(new Yb),this.zb.add(new G),this.zb.add(new jb),this.zb.add(new pa),this.zb.add(new xd),this.zb.add(new Yc),this.zb.add(new Pb),this.zb.add(new nb),this.zb.add(new Ja),this.zb.add(new gb),this.zb.add(new Ka),this.zb.add(new Wa),this.zb.add(new Va),this.zb.add(new qb),this.zb.add(new Qa),this.zb.add(new Ta),this.zb.add(new Lb),this.zb.add(new Qb),this.zb.add(new ib),this.zb.add(new Bb),this.zb.add(new Ub),this.zb.add(new Ab),this.zb.add(new ub),
this.zb.add(new db),this.zb.add(new ra),this.zb.add(new bb),this.zb.add(new na),this.zb.add(new Jb),this.zb.add(new mb),this.zb.add(new ja),this.zb.add(new hb),this.zb.add(new oa),this.zb.add(new Kd),this.zb.add(new ed),this.zb.add(new Ke),this.zb.add(new Qe),this.zb.add(new Zd),this.zb.add(new Xd),this.zb.add(new Je),this.zb.add(new Xe),this.zb.add(new df),this.zb.add(new id),this.zb.add(new lb),this.zb.add(new Db),this.zb.add(new ie),this.zb.add(new cf),this.zb.add(new Ae),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&
this.u9i());return this.zb}kZe(O,Ma){let Cb=this.lZe(O,this.macroRecorderEvents,Ma);Cb||(Cb=this.lZe(O,gf.u_h(),Ma),!Cb&&this.Fdf(O,gf.mFe,Ma)&&(Cb=gf.mFe));return Cb}lZe(O,Ma,Cb){const lc=new l.a;for(let Dc of Ma)this.Fdf(O,Dc,Cb)&&lc.add(Dc);return 1===lc.count?lc.na(0):1<lc.count?gf.NHh(lc):null}Fdf(O,Ma,Cb){const lc=gf.pUi(O,Ma);return Cb?lc&&gf.fVj(O,Ma):lc}u9i(){const O=new l.a;for(let Ma of this.zb){let Cb=!1;for(let lc of Ma.featureGates)if(!y.EwaSettings.ma(lc)){O.add(Ma);Cb=!0;break}if(!Cb)for(let lc of Ma.CQe)if(!y.EwaSettings.getBooleanFeatureGate(lc,
!1)){O.add(Ma);break}}for(let Ma of O)this.zb.remove(Ma)}static u_h(){gf.EBb||(gf.EBb=new l.a,gf.EBb.add(new da),gf.EBb.add(new Z));return gf.EBb}static pUi(O,Ma){return Ma.operations.contains(O.operation)}static fVj(O,Ma){Ma=Ma.ZAc;if(!Ma.count)return!0;let Cb=!0;for(let lc of Ma)if(!lc(O.payload)){Cb=!1;break}return Cb}static NHh(O){let Ma=O.na(0);for(let Cb of O)Cb.ZAc.count>Ma.ZAc.count&&(Ma=Cb);return Ma}}gf.EBb=null;gf.mFe=new Me;Object(e.a)(gf,"MacroRecorderEventList",null,[]);class zf extends k.a{constructor(O){super();
this.$=O;this.Fb()}create(){this.qb(this.$.da.za(297)||new B(this.$,new gf(this.$),new v))}static ka(O){O.da.Ga(298,new zf(O))}}Object(e.a)(zf,"MacroRecorderEventHandlerFactory",k.a,[]);var rg=a(1138),ng=a(1231),Sa=a(7);a(554);class yb{constructor(){this.elg=new l.a}get E_b(){return this.elg}aSh(O){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",O);const Ma=new l.a;for(let Cb of this.E_b)for(let lc of Cb.RCb)lc.id===O&&Ma.add(lc);return Ma}Oje(O){this.E_b.add(O)}p9i(O){for(let Ma of this.E_b)if(Ma.Qne===
O.Qne){this.E_b.remove(Ma);break}}static Deh(O,Ma,Cb=null){O=yb.mKh(O);0<O.length&&(yb.uuc(O,!1),Cb&&Cb(Ma,O))}static mKh(O){const Ma=[];if(O&&O.RCb&&0<O.RCb.count)for(let Cb of O.RCb)if(Cb.controls&&0<Cb.controls.count)for(let lc of Cb.controls)if(lc.menuItems&&0<lc.menuItems.count)for(let Dc of lc.menuItems)Array.add(Ma,Dc.id);return Ma}static uuc(O,Ma){if(O.length){var Cb=[];for(const lc of O)Cb.push(appChrome.actions.updateControlEnabledDisabledState(lc,Ma));appChrome.api.dispatch(Cb)}}}Object(e.a)(yb,
"ContextMenuExtensibilityCache",null,[790,791]);var Zb=a(1450),sc=a(83),Fc=a(4),ld=a(860),Jd=a(805);class h{EXa(O,Ma=null){if(O=Jd.a.y2a(O)){appChrome.addInApi.dispatchActionsToInstallAddIn(O,Ma);for(const Cb of O.tabs)if(Cb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,()=>{});break}}}zHd(O){(O=Jd.a.y2a(O))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(O)}static Leh(O,Ma,Cb=null){O=h.cVh(O);0<O.length&&(h.uuc(O,!1),Cb&&Cb(Ma,O))}static cVh(O){const Ma=[];if(O&&(O=O.mV,O.Ks&&
0<O.Ks.count))for(let Cb of O.Ks)if(Cb.groups&&0<Cb.groups.length)for(const lc of Cb.groups)if(lc.controls&&0<lc.controls.length)for(const Dc of lc.controls)Array.add(Ma,Dc.id);return Ma}static uuc(O){if(O.length){var Ma=[];for(const Cb of O)Ma.push(appChrome.actions.updateControlEnabledDisabledState(Cb,!0));appChrome.api.dispatch(Ma)}}}Object(e.a)(h,"OneLineRibbonExtensibilityManager",null,[808]);var Fb=a(931);class hc{constructor(){this.O0d=this.tCc=null}get IRc(){return this.tCc||(this.tCc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set IRc(O){this.tCc=
O}get wMg(){return this.O0d||(this.O0d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromAssetIdRuntimeId(O,Ma){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(O,Ma)}cgd(O,Ma,Cb,lc,Dc,dd=null,kd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",O);if((O=Ma.aia(Dc.ownerAddinInfo.storeType,Dc.ownerAddinInfo.solutionId))&&O.yB&&!O.yB.getIsUpgrading())if(Ma=null,0<O.yB.getNotificationParams().length&&(Ma=
this.pte(O.yB.getNotificationParams()[0]))&&2147758681===Ma.errorCode&&(O.isUpgraded=!0),2!==O.yB.getStatus()&&(1!==O.yB.getStatus()||Ma&&2147758681===Ma.errorCode))Ma&&this.L1f(O,Ma,kd);else try{Cb.setOwnerAddinEToken(O.yB.getEToken()),Dc.action(Cb,lc.Wba),dd&&dd()}catch(sd){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Fc.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?sd.stack:sd.message)),Fb.a.lQd(CommonUIStrings.l_InternalError+
" "+CommonUIStrings.l_InternalError_Directive)}}L1f(O,Ma,Cb=null){const lc=O.yB;if(1===lc.getNotificationParams().length||Ma.jcc){const Dc=Ma.Gga,dd=Ma.yha;Ma.Gga=()=>{lc.removeFirstNotification();if(0<lc.getNotificationParams().length){const kd=this.pte(lc.getNotificationParams()[0]);this.L1f(O,kd)}2147758681===Ma.errorCode&&(h.Leh(O.Do,lc,Object(sc.a)(this,this.d9e,"initUpgradeStateDetectTask")),yb.Deh(O.Spb,lc,Object(sc.a)(this,this.d9e,"initUpgradeStateDetectTask")));Dc&&Dc()};Ma.yha=()=>{dd&&
dd();Cb&&Cb()};Fb.a.nQd(Ma)}}d9e(O,Ma){let Cb=null;Cb=()=>{O.getIsUpgrading()?window.setTimeout(Cb,1E3):O.getUpgradingFailed()?h.uuc(Ma,!0):Fc.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Cb,1E3)}pte(O){const Ma=new ld.a;Ma.NKa=O.infoType;Ma.id=O.id;Ma.title=O.title;Ma.description=O.description;Ma.buttonText=O.buttonTxt;Ma.Gga=O.buttonCallback;Ma.jcc=O.highPriority;Ma.yha=O.dismissCallback;Ma.errorCode=O.errorCode;Ma.e8e=O.iframeNotificationUrl;return Ma}}Object(e.a)(hc,"AddinCommandsActionHandler",
null,[785]);var wc=a(82),bd=a(156),Bd=a(690),Cd=a(5),Wd=a(733),ee=a(691);class He{constructor(O,Ma){this.Sa=O;this.m1g=Ma}OEh(O){if(void 0!==O&&null!==O&&O===Cd.a.uAe)O="ContextMenuCell";else return null;const Ma=this.Sa.Bc();this.fEh(Ma,O);return Ma}fEh(O,Ma){Ma=this.m1g.aSh(Ma);for(let Cb of Ma){Ma=Cb.controls;for(let lc of Ma)this.SDh(O,lc)}}SDh(O,Ma){var Cb=Ma.IT[Wd.a.id];const lc=Ma.IT[Wd.a.FTa],Dc=Ma.IT[Wd.a.ITa];let dd="Image16by16",kd=Ma.IT[Wd.a.GTa];ee.c(Dc)&&(dd="None");0<Ma.menuItems.count?
(Cb=this.Sa.Su(Cb,Cb,lc,798637440),Cb.NJb(dd,Dc,null),this.MEh(Cb.menu,Ma),O.buttons.push(Cb)):O.buttons.push(this.Sa.RGa(Cb,lc,kd,Dc,dd,null,!1))}MEh(O,Ma){const Cb=this.Sa.Bc();for(let lc of Ma.menuItems){Ma=lc.Eka[Wd.a.id];const Dc=lc.Eka[Wd.a.FTa],dd=lc.Eka[Wd.a.ITa];let kd="Image16by16";const sd=lc.Eka[Wd.a.GTa];ee.c(dd)&&(kd="None");Ma=this.Sa.RGa(Ma,Dc,sd,dd,kd,null,!1);Cb.buttons.push(Ma)}O.pc.push(Cb)}}Object(e.a)(He,"AddInCommandsContextMenuExtensibilityHandler",null,[779]);var Ga=a(855);
class Kb{constructor(){this.ji=null;this.visible=!1}}Object(e.a)(Kb,"AddinStatusCommandValues",null,[]);class gc{static v1i(O){const Ma=new Kb;Ma.ji=O.$Xa;Ma.visible=Ma.ji?!0:!1;return Ma}static fwc(O,Ma,Cb,lc,Dc){const dd=document.getElementById(Cb);dd?gc.Kzj(O,Ma,dd,lc,Dc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Cb))}static Kzj(O,Ma,Cb,lc,Dc){Cb?O.$Xa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Fb.a.wyj(Ma,Cb,lc,Dc):O.$Xa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
Fb.a.Pzj(Ma,Cb):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(e.a)(gc,"AddinCommandsStatusHandler",null,[]);var Ic=a(38),Nc=a(223),nd=a(14);class Ud extends Ic.a{constructor(O,Ma){super();this.agaveCommandManager=this.statusBarManager=null;this.zxe=()=>{this.VF&&this.VF.dxe()};this.B3e=()=>{this.raiseEvent("LAC")};this.Xc=(Cb,lc)=>{!Cb.hc&&Nc.b(lc)&&this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null)};this.VF=
Ma;this.$=O;this.FEj=O.Bb+"OfficeAddinLabel-Medium14";this.$.da.Za(29,Cb=>{this.statusBarManager=Cb;Cb.hJ(this)});this.$.ea.hk(this.Xc);this.VF.cDg(this.B3e);this.$.da.Za(206,Cb=>{this.agaveCommandManager=Cb;Cb.CEg(this.zxe)})}nq(O){this.addHandler("LAC",O)}Nq(O){this.removeHandler("LAC",O)}Pr(O,Ma){if("QueryAddinLabel"!==O)return!1;Ma[Ga.a.LabelText]!==this.VF.$Xa&&(O=gc.v1i(this.VF),Ma[Ga.a.LabelText]=O.ji,Ma[Ga.a.Visible]=O.visible,window.setTimeout(()=>{this.fwc()},0));return!0}mn(){return!0}fwc(){this.$&&
gc.fwc(this.VF,this.$.domElement,this.FEj,nd.a.instance.ga(338),nd.a.instance.ga(339))}dispose(){this.$.ea.Hk(this.Xc);this.VF.y$i(this.B3e);this.agaveCommandManager&&(this.agaveCommandManager.Jaj(this.zxe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.VF=this.$=null;super.dispose()}}Object(e.a)(Ud,"AddinCommandsStatusBarManager",Ic.a,[184,185]);var ke=a(1305),Nd=a(716),ve=a(146),Oe=a(124),ze=a(567),nf=a(136);class $f{constructor(){this.ZXa=
null}setErrorMessageForAddin(O,Ma){this.ZXa||(this.ZXa={});this.ZXa[O]=Ma}FMh(O){return this.ZXa&&O in this.ZXa?this.ZXa[O]:null}}Object(e.a)($f,"AddinCommandsErrorManager",null,[]);var sf=a(328),og=a(95);class Ea{constructor(){this.Fq=this.HN=0;this.YTc=null;this.bpc=this.Nyc=0;this.Ioa=this.fHc=this.LCc=this.$1b=this.tia=this.W8=null}get hne(){this.LCc||(this.LCc=new l.a);return this.LCc}get pad(){this.fHc||(this.fHc=new l.a);return this.fHc}get IGa(){this.Ioa||(this.Ioa=new l.a);return this.Ioa}}
Object(e.a)(Ea,"AddinCommandsListLoaderContext",null,[]);var Fa=a(811);class vc{}Object(e.a)(vc,"AppsForOfficeEntitlementQueryInfo",null,[]);var rd=a(41);const de=O=>{const Ma={};Ma.solutionId=O.solutionId;Ma.version=O.version;Ma.storeType=O.storeType;Ma.storeId=O.storeId;Ma.assetId=O.assetId;Ma.assetStoreId=O.assetStoreId;Ma.targetType=O.targetType;Ma.requireConsent=O.requireConsent||!1;Ma.isAddinCommands=!0;Ma.addinCommandsActionType=0;return Ma};class qe{constructor(O,Ma){this.entitlement=O;this.metadata=
Ma}xJj(){const O=de(this.entitlement);O.targetType=this.targetType;return O}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(e.a)(qe,"AddinEntitlementEx",null,[]);var bf=a(255),of=a(29);class Mf{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(e.a)(Mf,"AddinAbstract",null,[]);class Ff extends Sys.EventArgs{constructor(){super();this.Do=this.Zj=null}}Object(e.a)(Ff,"InsertionParamEventArgs",Sys.EventArgs,[]);class hg{constructor(O,Ma,Cb,lc=null){this.tIb=Fc.AFrameworkApplication.fa.Va("RoamingServiceHandlerWebServiceBase");this.appName=O;this.Ghb=Ma;this.Chb=Cb;this.Kjb=
lc}j7b(O){const Ma=new Sys.StringBuilder(this.tIb);Ma.append("RoamingServiceHandler.ashx?action=");Ma.append("getAddinTeachingCalloutSettings");Ma.append("&");Ma.append(this.led(O));Ma.append("&");Ma.append(Fc.AFrameworkApplication.gj);Fc.AFrameworkApplication.rd.hm(Ma.toString(),1,null,null,!0,2,Object(sc.a)(this,this.Via,"getRequestSuccessCallback"),Object(sc.a)(this,this.r3,"getRequestFailureCallback"),null)}K1a(O){var Ma=new Sys.StringBuilder(this.tIb);Ma.append("RoamingServiceHandler.ashx?action=");
Ma.append("saveAddinTeachingCalloutSettings");Ma.append("&");Ma.append(Fc.AFrameworkApplication.gj);Ma=Ma.toString();O=rd.c(O);Fc.AFrameworkApplication.rd.hm(Ma,2,O,null,!0,4,null,Object(sc.a)(this,this.yV,"postRequestFailureCallback"),null)}Via(O){let Ma=!1,Cb=null;try{if(0<O.data.Td.length){const lc=Object(L.a)(Object,rd.a(O.data.Td)),Dc=lc?lc[this.appName]:null;Dc&&(Cb=Object(L.a)(Object,rd.a(Dc.toString())))}Ma=!0}catch(lc){this.r3(null)}Ma&&this.Ghb&&this.Ghb(Cb)}r3(O){this.Chb&&this.Chb(O?O.data:
null)}yV(O){this.Kjb&&this.Kjb(O?O.data:null)}led(O){const Ma=new Sys.StringBuilder("requestedsettings=");for(let Cb=0;Cb<O.count;Cb++)Ma.append(O.na(Cb)),Cb<O.count-1&&Ma.append(";");return Ma.toString()}}Object(e.a)(hg,"AddinTeachingUIRoamingRequestHandler",null,[]);class xf extends Sys.EventArgs{constructor(O){super();this.solutionId=O.solutionId;this.assetId=O.assetId;this.storeType=O.storeType;this.storeId=O.storeId;this.assetStoreId=O.assetStoreId;this.targetType=O.targetType;this.width=O.width;
this.height=O.height;this.displayName=O.displayName;this.version=O.version}}Object(e.a)(xf,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Df=a(339);class Tf{constructor(O){this.bYa=this.Zj=null;this.YPa=!1;this.Ioa=this.UOb=this.Ula=this.Qh=this.LW=this.SN=null;this.Qa=O}get appName(){return Fc.AFrameworkApplication.fa.Va("WebAppShortName")}get Emb(){this.LW||(this.LW=new hg(this.appName,Object(sc.a)(this,this.Via,"getRequestSuccessCallback"),Object(sc.a)(this,this.r3,"getRequestFailureCallback"),
Object(sc.a)(this,this.yV,"postRequestFailureCallback")));return this.LW}get fra(){this.UOb||(this.UOb=new l.a);return this.UOb}set fra(O){this.UOb=O}get IGa(){this.Ioa||(this.Ioa=new l.a);return this.Ioa}set IGa(O){this.Ioa=O}ESc(O,Ma){window.addEventListener?(this.Zj=O,this.bYa=Ma,window.addEventListener("LaunchAddinTaskpane",Object(sc.a)(this,this.ozd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(sc.a)(this,this.ryd,"onDismissButtonClickedEventHandler"),
!0),window.addEventListener("CloseCallout",Object(sc.a)(this,this.fyd,"onCloseButtonClickedEventHandler"),!0),Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(sc.a)(this,this.eDb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}QLj(O,Ma,Cb,lc){this.Qh=O;this.fra=Ma;this.IGa=Cb;this.Ula=lc;n.ULS.sendTraceTag(0,
220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ma?Ma.count.toString():"null",Cb?Cb.count.toString():"null");0<this.fra.count||0<this.IGa.count?(O=new l.a,O.add(this.appName),this.Emb.j7b(O)):this.Ula(new l.a,null)}ozd(){const O=new bf.ScriptSharpLegacyMap;this.bYa&&this.bYa.tabs&&!this.bYa.tabs[0].isOfficeTab&&O.ia("SDX.FeatureFlags","NonOfficeTab");this.rka(Tf.FU(this.Zj),"ClickOnLaunch",O);Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Bka();this.bYa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.bYa,()=>{const Ma=new Ff;Ma.Zj=this.Zj;this.Qa.raiseEvent(Nd.a.ord,Ma)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}fyd(){this.rka(Tf.FU(this.Zj),"ClickOnClose");Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Bka()}ryd(){this.rka(Tf.FU(this.Zj),"ClickOnDismiss");Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Bka()}eDb(O){if(O&&(O=O.detail)&&O.id&&this.cld(O.id)){const Ma=(O.action||"").toLowerCase();if(O.success&&"opened"===Ma)this.rka(Tf.FU(this.Zj),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Bka(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(sc.a)(this,this.eDb,"onCampaignLaunchedHandler"),!0);else{let Cb;try{Cb=JSON.stringify(O),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+
Cb)}catch(lc){Cb="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Cb+" Error: "+(lc?lc.toString():""))}}}}cld(O){O=of.a.ll(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}r6(O){if(this.appName){const Ma=
{},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=O;Ma[this.appName]=rd.c(Cb);this.Emb.K1a(Ma);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}Bka(){if(!this.YPa){const O=window.g_roamingAddinList;O&&(this.r6(O),this.YPa=!0)}}Via(O){O?this.bQd(O)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.SN="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.Fpb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Ula(this.fra,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.SN=null,this.Fpb())}r3(O){n.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.httpStatus:-1);this.Ula(this.fra,null)}yV(O){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
O?O.httpStatus:-1)}Fpb(){const O=this.G4c();0===O.targetType?(O.solutionId?this.zEd(O):this.rka(null,"NoSolutionId"),this.Mcg(O),this.Ula(this.fra,null)):this.Ula(this.fra,O);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",O.addinId)}zEd(O){const Ma=new vc;Ma.callbackFunc=Cb=>{if(Cb.errorCode){if(this.rka(O.solutionId,"FailToGetAppDetails"),Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var lc=window.g_roamingAddinList;
lc&&this.r6(lc)}}else if(Cb.value)for(lc of Cb.value){var Dc=lc[1];if(Dc===O.solutionId){Cb={};Cb.solutionId=Dc;Cb.assetId=lc[5];Dc=Fc.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Cb.storeType=Dc?lc[12]:lc[6];Fc.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Cb.storeId=O.storeId:Cb.storeId=lc[11];Cb.assetStoreId=lc[6];Cb.targetType=lc[3];Cb.width=lc[7];Cb.height=lc[8];Cb.displayName=lc[0];Cb.version=lc[4];n.ULS.sendTraceTag(0,220,50,
"Raise a teaching callout event for content addin: {0}.",O.solutionId);lc=new xf(Cb);this.Qa.raiseEvent(Nd.a.rQd,lc);break}}};Ma.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ma.fromInsertDialog=!1;Ma.refresh=!1;this.Qh.queryEntitlementDetails(Ma)}bQd(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<Fc.AFrameworkApplication.fa.GM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
O),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}G4c(){let O=new sf.a(new Mf,0),Ma=new sf.a(new Mf,0),Cb=0,lc=0,Dc=0;var dd=new l.a;for(var kd of this.fra)dd.add(kd);for(let sd of this.IGa)dd.add(sd);for(let sd of dd)if(!("excatalog"!==sd.storeType||ee.c(sd.installTimeInMS)||!sd.installTimeInMS||sd.installTimeInMS<=Fc.AFrameworkApplication.fa.GM("DateTimeInMSForNewAddin",16409952E5))){dd=Tf.Htb(sd);if(this.SN&&(kd=this.SN.split(","),0<kd.length&&Array.contains(kd,
dd))){Dc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}dd.startsWith("private_")?(O=Tf.XYe(sd,O),lc++):(Ma=Tf.XYe(sd,Ma),Cb++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lc,Cb,Dc);return 0<Ma.value?Ma.key:0<O.value?O.key:Object.assign(new Mf,{addinId:null,targetType:-1,solutionId:null,storeId:null})}rka(O,Ma,Cb=null){O={["AppTeachingUICalloutAction"]:Ma,["SDX.Id"]:O,
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Cb)for(let lc of Cb.keys)O[lc]=Cb.na(lc);ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}))}Mcg(O){O&&(O=this.SN?this.SN+","+O.addinId:O.addinId,Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=O:this.r6(O))}static FU(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,
O.storeType,O.assetId,null,null,O.storeId)}static XYe(O,Ma){return Ma.value<O.installTimeInMS?new sf.a(Object.assign(new Mf,{addinId:Tf.Htb(O),targetType:O.targetType,storeId:O.storeId,solutionId:O.solutionId}),O.installTimeInMS):Ma}static Htb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(e.a)(Tf,"PrivateCatalogTeachingCalloutHandler2",null,[]);var Pg=a(80);const ig=()=>{const O=Pg.a.RY(window.location.href.toLowerCase(),
"wdomexsrctype");return!!O&&"4"===O},ag=()=>Pg.a.RY(window.location.href.toLowerCase(),"wdtpl"),eh=()=>{const O=Pg.a.RY(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"1"===O},xg=O=>{let Ma=null;switch(O){case 0:Ma="omex";break;case 1:Ma="spcatalog";break;case 2:Ma="spapp";break;case 3:Ma="filesystem";break;case 4:Ma="exchange";break;case 6:Ma="registry";break;case 7:Ma="inmemory";break;case 8:Ma="uploadfiledevcatalog";break;case 9:Ma="hardcodedpreinstall";break;case 10:Ma="excatalog";
break;case 16:Ma="wopicatalog"}return Ma},fh=O=>{let Ma=-1;switch(O.toLowerCase()){case "omex":Ma=0;break;case "spcatalog":Ma=1;break;case "spapp":Ma=2;break;case "filesystem":Ma=3;break;case "exchange":Ma=4;break;case "registry":Ma=6;break;case "inmemory":Ma=7;break;case "uploadfiledevcatalog":Ma=8;break;case "hardcodedpreinstall":Ma=9;break;case "excatalog":Ma=10;break;case "wopicatalog":Ma=16}return Ma};var gh=a(679);class $g{constructor(O){this.Br=null;this.sA=O}get_current(){if(!this.Br)throw Error.argumentOutOfRange();
return this.Br.data}moveNext(){if(!this.Br)return this.Br=this.sA,!!this.sA;if(!this.Br.next)return!1;this.Br=this.Br.next;return!0}Pjc(){if(!this.Br)return this.Br=this.sA,!!this.sA;if(!this.Br.previous)return!1;this.Br=this.Br.previous;return!0}reset(){this.Br=this.sA}}Object(e.a)($g,"ListEnumerator",null,[0]);class Sg{constructor(O,Ma,Cb){this.next=Cb;this.previous=Ma;this.data=O}}Object(e.a)(Sg,"ListNode",null,[]);class gg{constructor(){this.xA=this.aq=null;this._count=0}add(O){this.aq?this.xA=
this.xA.next=new Sg(O,this.xA,null):this.aq=this.xA=new Sg(O,null,null);this._count=this.count+1}insert(O,Ma){if(O>this.count||0>O)throw Error.argumentOutOfRange("pos");if(O===this.count)this.add(Ma);else{for(var Cb=this.aq;0!==O--;)Cb=Cb.next;O=new Sg(Ma,Cb.previous,Cb);O.previous?O.previous.next=O:this.aq=O;O.next?O.next.previous=O:this.xA=O;this._count=this.count+1}}remove(O){let Ma=this.aq;for(;Ma&&Ma.data!==O;)Ma=Ma.next;if(!Ma)return!1;Ma.previous?Ma.previous.next=Ma.next:this.aq=Ma.next;Ma.next?
Ma.next.previous=Ma.previous:this.xA=Ma.previous;this._count=this.count-1;return!0}clear(){let O=this.aq,Ma;for(this.xA=this.aq=null;O;)Ma=O.next,O.previous=null,O.next=null,O=Ma;this._count=0}indexOf(O){let Ma=this.aq,Cb=0;for(;Ma&&Ma.data!==O;)Ma=Ma.next,Cb++;return Ma?Cb:-1}na(O){return this.at(O).data}get count(){return this._count}getEnumerator(){return new $g(this.aq)}[Symbol.iterator](){return Object(gh.a)(this.getEnumerator())}h$b(O){O=this.at(O);return new $g(O)}toArray(){const O=Array(this.count);
let Ma=0;for(let Cb of this)O[Ma]=Cb,Ma++;return O}at(O){let Ma=this.aq,Cb=0;for(;Cb!==O;){if(!Ma)throw Error.argumentOutOfRange("pos");Ma=Ma.next;Cb++}return Ma}}Object(e.a)(gg,"List",null,[1]);class yg extends Sys.EventArgs{constructor(O){super();this.properties=O}}Object(e.a)(yg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ah{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(e.a)(ah,"MiniAddinInfo",null,[]);class ff{constructor(O,
Ma,Cb){this.Qa=new og.a;this.context=new Ea;this.kQc=this.G5f=this.URd=this.eFa=this.SN=this.LW=null;this.contextActivationMgr=O;this.YGg=Ma;this.fFa=Cb;this.appName=Fc.AFrameworkApplication.fa.Va("WebAppShortName")}get bMb(){this.kQc||(this.kQc=new Tf(this.Qa));return this.kQc}aDg(O){this.Qa.addHandler(Nd.a.Amb,O)}tGg(O){this.Qa.addHandler(Nd.a.rQd,O)}iNj(O){null!==O&&(this.context.HN=O[Nd.a.X8],this.context.Fq=O[Nd.a.cP],this.context.Nyc=this.context.bpc=0,O=Nd.a.gFa in O?O[Nd.a.gFa]:0,-1!==this.context.HN&&
0!==this.context.Fq&&(this.context.W8=new gg,this.context.tia=new gg,this.context.$1b=new gg,this.context.YTc=this.YGg.createAddinDataProvider(xg(this.context.HN),this.contextActivationMgr),this.context.YTc?this.context.YTc.getEntitlementsAsync(this.contextActivationMgr.Wba,!0,O,Ma=>{this.fNi(Ma)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.HN)))}fNi(O){if(O&&0<O.length){this.context.Nyc=O.length;const Cb=Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?
ag():null;for(let lc=0;lc<O.length;lc++){const Dc=O[lc];if(Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&eh()&&Dc&&Dc.storeType&&"omex"===Dc.storeType.toLowerCase()&&Dc.assetId&&Cb&&Dc.assetId.toLowerCase()===Cb.toLowerCase()){var Ma={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:ff.FU(Dc)};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj(Ma)}))}!Dc||1!==Dc.targetType&&-1!==Dc.targetType?
this.Mkc():(Ma={},Fc.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ma.solutionId=Dc.solutionId,Ma.version=Dc.version):(Ma.marketplaceId=Dc.solutionId,Ma.marketplaceVersion=Dc.version),Ma.storeType=Dc.storeType,Ma.storeId=Dc.storeId,Ma.targetData=Dc,ff.cMb?this.contextActivationMgr.isAddinCommandsExAsync(Ma,Object(sc.a)(this,this.AMi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ma,
(dd,kd,sd)=>{dd?(kd&&this.context.W8.add(sd.targetData),10===this.context.HN&&(dd=sd.targetData,kd=dd.targetType,ee.c(sd.targetTypeForExp)||(kd=sd.targetTypeForExp,dd.targetType=kd),this.context.tia.add(dd),0===kd&&this.context.$1b.add(dd))):(sd=sd.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(sd.solutionId,sd.storeType,sd.assetId,null,null,sd.storeId),sd.storeType));this.Mkc()}))}}else this.Mkc()}Mkc(){var O;
(O=this.context).bpc=O.bpc+1;this.context.bpc>=this.context.Nyc&&(this.fFa.bXf(this.context.HN,!1),0<this.context.Nyc&&10===this.context.HN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(O=!1,Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&ig()&&(O=this.wti()),this.Jsi(),Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!O?ff.cMb?this.bMb.QLj(this.contextActivationMgr,
this.context.hne,this.context.IGa,(Ma,Cb)=>{const lc=new l.a;for(let Dc of Ma)Ma=Dc.xJj(),Cb&&Cb.solutionId===Dc.solutionId&&(Ma.showCallout=!0,this.bMb.Mcg(Cb)),lc.add(Ma);this.Ula(lc)}):this.CGh(this.context.W8):this.lXb(this.context.W8)):this.lXb(this.context.W8))}lXb(O){if(ff.cMb)this.Ula(this.I_g(O));else{var Ma=new l.a;if(O)for(let Cb of this.context.W8)Ma.add(de(Cb));this.context.W8&&1>this.context.W8.count&&Fa.a.deb(Nd.a.Bmb,"false",this.context.HN);O={["ack2"]:Ma};O[Nd.a.X8]=this.context.HN;
O[Nd.a.cP]=this.context.Fq;this.Qa.raiseEvent(Nd.a.Amb,new yg(O),this)}}I_g(O){const Ma=new l.a;if(O)for(let Cb of O)Ma.add(de(Cb));return Ma}Ula(O){O&&O.count||Fa.a.deb(Nd.a.Bmb,"false",this.context.HN);O={["ack2"]:O};O[Nd.a.X8]=this.context.HN;O[Nd.a.cP]=this.context.Fq;this.Qa.raiseEvent(Nd.a.Amb,new yg(O),this)}r6(O){if(this.appName){const Ma={},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=O;Ma[this.appName]=rd.c(Cb);this.LW&&(this.LW.K1a(Ma),n.ULS.sendTraceTag(539530527,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}CGh(O){(this.eFa=O)?(O=new l.a,O.add(this.appName),this.LW=new hg(this.appName,Object(sc.a)(this,this.Via,"getRequestSuccessCallback"),Object(sc.a)(this,this.r3,"getRequestFailureCallback"),Object(sc.a)(this,this.yV,"postRequestFailureCallback")),this.LW.j7b(O)):(O={["ack2"]:new l.a},O[Nd.a.X8]=
this.context.HN,O[Nd.a.cP]=this.context.Fq,this.Qa.raiseEvent(Nd.a.Amb,new yg(O),this))}Via(O){O?this.bQd(O)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.SN="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.Fpb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.lXb(this.eFa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.SN=null,this.Fpb())}r3(O){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",
O?O.httpStatus:-1);this.lXb(this.eFa)}yV(O){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}Fpb(){const O=this.G4c();if(0===O.targetType){O.solutionId?(this.URd=O.solutionId,this.G5f=O.storeId,this.zEd()):this.rka("NoSolutionId");if(O.addinId){const Ma=this.SN?this.SN+","+O.addinId:O.addinId;Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ma:
this.r6(Ma)}this.mke(null)}else this.mke(O.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",O.addinId)}zEd(){const O=new vc;O.callbackFunc=Ma=>{if(Ma.errorCode){if(this.rka("FailToGetAppDetails"),Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Cb=window.g_roamingAddinList;Cb&&this.r6(Cb)}}else if(Ma.value)for(Cb of Ma.value){var lc=Cb[1];if(lc===this.URd){Ma={};Ma.solutionId=lc;Ma.assetId=Cb[5];lc=Fc.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");
Ma.storeType=lc?Cb[12]:Cb[6];Fc.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Ma.storeId=this.G5f:Ma.storeId=Cb[11];Ma.assetStoreId=Cb[6];Ma.targetType=Cb[3];Ma.width=Cb[7];Ma.height=Cb[8];Ma.displayName=Cb[0];Ma.version=Cb[4];Cb=new xf(Ma);this.Qa.raiseEvent(Nd.a.rQd,Cb);break}}};O.storeType=OSF.StoreTypeEnum.PrivateCatalog;O.fromInsertDialog=!1;O.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(O)}bQd(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),
O<Fc.AFrameworkApplication.fa.GM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",O),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}G4c(){let O=new sf.a(new ah,0),Ma=new sf.a(new ah,0),Cb=0,lc=0,Dc=0;var dd=new gg;if(0<this.context.W8.count)for(var kd of this.context.W8)dd.add(kd);if(0<this.context.$1b.count)for(let sd of this.context.$1b)dd.add(sd);for(let sd of dd)if(!("excatalog"!==
sd.storeType||ee.c(sd.installTimeInMS)||!sd.installTimeInMS||sd.installTimeInMS<=Fc.AFrameworkApplication.fa.GM("DateTimeInMSForNewAddin",16409952E5))){dd=ff.Htb(sd);if(this.SN&&(kd=this.SN.split(","),0<kd.length&&Array.contains(kd,dd))){Dc++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}dd.startsWith("private_")?(O.value<sd.installTimeInMS&&(O=new sf.a(Object.assign(new ah,{addinId:dd,targetType:sd.targetType,storeId:sd.storeId,solutionId:sd.solutionId}),
sd.installTimeInMS)),lc++):(Ma.value<sd.installTimeInMS&&(Ma=new sf.a(Object.assign(new ah,{addinId:dd,targetType:sd.targetType,storeId:sd.storeId,solutionId:sd.solutionId}),sd.installTimeInMS)),Cb++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lc,Cb,Dc);return 0<Ma.value?Ma.key:0<O.value?O.key:Object.assign(new ah,{addinId:null,targetType:-1,solutionId:null,storeId:null})}mke(O){const Ma=new l.a;for(let lc of this.eFa){const Dc=
de(lc);if(O){var Cb=ff.Htb(lc);O===Cb&&(Dc.showCallout=!0,Cb=this.SN?this.SN+","+O:O,Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Cb:this.r6(Cb))}Ma.add(Dc)}this.eFa&&1>this.eFa.count&&Fa.a.deb(Nd.a.Bmb,"false",this.context.HN);O={["ack2"]:Ma};O[Nd.a.X8]=this.context.HN;O[Nd.a.cP]=this.context.Fq;this.Qa.raiseEvent(Nd.a.Amb,new yg(O),this)}wti(){if(ff.cMb)return this.xti(this.context.pad);var O=!1;if(this.context.tia&&
1>this.context.tia.count)return O;const Ma=ag();if(!Ma)return O;for(let Cb of this.context.tia)if(Cb.storeId&&Cb.storeId.toLowerCase()===Ma.toLowerCase()||Cb.assetId&&Cb.assetId.toLowerCase()===Ma.toLowerCase())O={["SDX_Id"]:ff.FU(Cb),["SDX_TargetType"]:ee.c(Cb.targetType)?"":Cb.targetType.toString()},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Oe.a.Tj(O)})),O=!0;return O}Jsi(){if(ff.cMb)this.Ksi(this.context.pad);else if(!(this.context.tia&&
1>this.context.tia.count))if(this.fFa.Bdf()){var O=this.fFa.L_e();O?(O=this.DWe(this.context.tia,O),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.DWe(this.context.tia,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.fFa.EZf(O)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}DWe(O,Ma){const Cb={};let lc=!1;for(let Dc of O)if(O=ff.FU(Dc))!Ma||O in Ma||(this.$wa(Dc,O),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),
"private"===O.toLowerCase()?lc||(lc=!0,Cb[O]=null):Cb[O]=null;return Cb}$wa(O,Ma){var Cb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Cb={["SDX.Id"]:Ma,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ee.c(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Cb};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj(Cb)}));1===O.targetType&&(O={["SDX.Id"]:Ma,["SDX.AppInstallOrigin"]:"Organization",
["SDX.CommandPlacement"]:"Ribbon"},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Oe.a.Tj(O)})))}xti(O){let Ma=!1;if(O&&1>O.count)return Ma;const Cb=ag();if(!Cb)return Ma;for(let lc of O)if(lc.storeId&&lc.storeId.toLowerCase()===Cb.toLowerCase()||lc.assetId&&lc.assetId.toLowerCase()===Cb.toLowerCase())O={["SDX_Id"]:ff.N_e(lc),["SDX_TargetType"]:ee.c(lc.targetType)?"":lc.targetType.toString()},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:Oe.a.Tj(O)})),Ma=!0;return Ma}Ksi(O){if(!(O&&1>O.count))if(this.fFa.Bdf()){var Ma=this.fFa.L_e();Ma?(O=this.EWe(O,Ma),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.EWe(O,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.fFa.EZf(O)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}EWe(O,Ma){const Cb={};let lc=!1;for(let Dc of O)if(O=ff.N_e(Dc))!Ma||O in Ma||(this.wvi(Dc,O),n.ULS.sendTraceTag(527523849,306,50,
"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?lc||(lc=!0,Cb[O]=null):Cb[O]=null;return Cb}wvi(O,Ma){var Cb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Cb={["SDX.Id"]:Ma,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ee.c(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Cb};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj(Cb)}));1===O.targetType&&(O={["SDX.Id"]:Ma,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Oe.a.Tj(O)})))}AMi(O,Ma,Cb,lc){O?(-1===lc.targetType&&(lc.targetType=Cb.targetTypeForExp),O=new qe(Cb.targetData,lc),Ma&&this.context.hne.add(O),10===this.context.HN&&(this.context.pad.add(O),0===O.targetType&&this.context.IGa.add(O))):(Ma=Cb.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma.solutionId,Ma.storeType,Ma.assetId,null,null,Ma.storeId),Ma.storeType));this.Mkc()}rka(O){O={["AppTeachingUICalloutAction"]:O,["SDX.Id"]:this.URd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}))}static get cMb(){return Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static FU(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static N_e(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static Htb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(e.a)(ff,"AddInCommandsListLoader",null,[]);class ia{constructor(O){this.Ksg=O}get Wba(){return this.Ksg}insertOsfControl(O){return this.Wba.insertOsfControl(O)}getManifestInvaildErrorString(){return this.Wba.getManifestInvaildErrorString()}isAddinCommandsAsync(O,
Ma){this.Wba.isAddinCommandsAsync(O,Ma)}isAddinCommandsExAsync(O,Ma){this.Wba.isAddinCommandsExAsync(O,Ma)}ownerAddinControlRecreated(O,Ma){this.Wba.ownerAddinControlRecreated(O,Ma)}queryEntitlementDetails(O){this.Wba.queryEntitlementDetails(O)}}Object(e.a)(ia,"ContextActivationMgrWrapper",null,[787]);class Hb{createAddinDataProvider(O,Ma){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(O,Ma.Wba)}static get instance(){Hb.Ma||(Hb.Ma=new Hb);return Hb.Ma}}Hb.Ma=null;Object(e.a)(Hb,
"OSFAddinDataProviderFactory",null,[788]);class Vb{constructor(){this.Ver=1}}Object(e.a)(Vb,"CacheItem",null,[]);class Ac{constructor(O){this.mDa=O}tl(O){const Ma=this.mDa.getItem(O);if(Ma){let Cb=new Vb;try{Cb=Sys.Serialization.JavaScriptSerializer.deserialize(Ma,!0)}catch(lc){return this.mDa.removeItem(O),null}return Cb.Data?Cb.Data:Cb.data}return null}rPa(O){this.mDa.removeItem(O)}}Object(e.a)(Ac,"AppsDataCacheManager",null,[812]);var vd=a(812);class Td{constructor(){new Ac(vd.a.instance)}bXf(O,
Ma){O=Nd.a.HXe()+O;vd.a.instance.setItem(O,Ma.toString())}L_e(){var O=Nd.a.O_e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",O);O=vd.a.instance.getItem(O);return rd.a(O)}EZf(O){const Ma=Nd.a.O_e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ma);vd.a.instance.setItem(Ma,rd.c(O))}Bdf(){return!!vd.a.instance.localStorage}static get instance(){Td.Ma||(Td.Ma=new Td);return Td.Ma}}Td.Ma=null;Object(e.a)(Td,"AddInCommandsCacheManager",null,[792]);class fe{constructor(O,Ma,Cb,lc,Dc,
dd){this.Fq=O;this.Zj=Ma;this.aW=Cb;this.displayName=Dc;this.eif=dd}}Object(e.a)(fe,"PostLaunchAddinCommandsParameters",null,[]);class Ee{constructor(O,Ma,Cb){this.YPa=!1;this.LW=null;this.eb=O;this.Yhb=Ma;this.sfb=Cb}ESc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(sc.a)(this,this.ozd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(sc.a)(this,this.ryd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(sc.a)(this,this.fyd,"onCloseButtonClickedEventHandler"),!0),Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(sc.a)(this,this.eDb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}ozd(){const O={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Ee.FU(this.Yhb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.sfb&&this.sfb.tabs&&!this.sfb.tabs[0].isOfficeTab&&(O["SDX.FeatureFlags"]="NonOfficeTab");ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Bka();this.sfb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.sfb,()=>{const Ma=new Ff;Ma.Zj=this.Yhb;this.eb.raiseEvent(Nd.a.ord,
Ma)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}fyd(){const O={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Ee.FU(this.Yhb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Bka()}ryd(){const O={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Ee.FU(this.Yhb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Bka()}eDb(O){if(O&&(O=O.detail)&&O.id&&this.cld(O.id)){const Cb=
(O.action||"").toLowerCase();if(O.success&&"opened"===Cb){var Ma={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:Ee.FU(this.Yhb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Ma)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Bka();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(sc.a)(this,this.eDb,"onCampaignLaunchedHandler"),!0)}else try{Ma=JSON.stringify(O),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ma)}catch(lc){Ma="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ma+" Error: "+(lc?lc.toString():""))}}}cld(O){O=of.a.ll(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}r6(O){const Ma=Fc.AFrameworkApplication.fa.Va("WebAppShortName");if(Ma){const Cb={},lc={};lc.LastTeachingUIShowTime=(new Date).toUTCString();lc.AddinHasShown=O;Cb[Ma]=rd.c(lc);this.LW=new hg(Ma,null,null,Object(sc.a)(this,this.yV,"postRequestFailureCallback")),this.LW.K1a(Cb),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}Bka(){if(!this.YPa){const O=window.g_roamingAddinList;O&&(this.r6(O),this.YPa=!0)}}yV(O){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}static FU(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}}Object(e.a)(Ee,"PrivateCatalogTeachingCalloutHandler",null,[]);class kf{constructor(O){this.$8d=null;this.V6d=
O}get Mwa(){return this.$8d}EXa(O,Ma=null){this.V6d.EXa(O,Ma);this.$8d=O}zHd(O){this.V6d.zHd(O)}}Object(e.a)(kf,"RibbonExtensibilityManagerWithChangeDetection",null,[808]);var lf=a(859),ca=a(99);class Xa{static uYe(O){const Ma=new l.a;if(Xa.zze)for(var Cb of Xa.zze)Ma.add(Cb);Cb=null;switch(O){case "Workbook":Cb=Xa.YWj;break;case "Document":Cb=Xa.xgh;break;case "Presentation":Cb=Xa.g_i}if(Cb)for(const lc of Cb)Ma.add(lc);return Ma}}Xa.zze=["PrimaryCommandSurface","ContextMenu"];Xa.YWj=null;Xa.xgh=
null;Xa.g_i=null;Object(e.a)(Xa,"ExtensionPointType",null,[]);class C{constructor(O){this.Wae=null;if(ee.c(O))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Jjg=O}get RCb(){return this.Wae||(this.Wae=new l.a)}get Qne(){return this.Jjg}}Object(e.a)(C,"ContextMenuExtensibility",null,[796]);class Y{constructor(O,Ma=null,Cb=0){if(ee.c(O))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Dsg=O;this.Vvg=Ma;this.nog=Cb}get mV(){return this.Dsg}get startedNode(){return this.Vvg}get NFh(){return this.nog}}Object(e.a)(Y,"RibbonExtensibility",null,[874]);class Ia{constructor(O){this.kng=O.entitlement}get entitlement(){return this.kng}createActionContext(O,Ma){O={};O.ownerAddinInfo=this.entitlement;O.action=Ma;return O}}Object(e.a)(Ia,"AddInCommandsContextProvider",null,[]);class zb{constructor(O,Ma,Cb){this.h0d=
this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=O;this.eventBuilder=Ma;this.contextMenuBuilder=Cb}get jne(){return this.h0d}J4g(O){return new Ia(O)}createActionBuilder(O,Ma){return OfficeExt.DefaultControlActionBinder.createActionBuilder(O,Ma.entitlement,Ma.manifest)}startApplyAddin(O){this.h0d=O;const Ma=this.J4g(O);this.actionBuilder=this.createActionBuilder(Ma,O)}endApplyAddin(){}Pad(O,Ma,Cb=0){return this.ribbonBuilder.Ks&&
0<this.ribbonBuilder.Ks.count?new Y(this.bFh(O,Ma),this.jne.startedNode,Cb):null}eUe(){var O=null;if(this.contextMenuBuilder.ujc&&0<this.contextMenuBuilder.ujc.count){O||(O=this.jne.entitlement.solutionId);O=new C(O);for(let Ma of this.contextMenuBuilder.ujc)O.RCb.add(Ma);return O}return null}bFh(O,Ma){return this.ribbonBuilder.Ks&&0<this.ribbonBuilder.Ks.count?new Jd.a(this.ribbonBuilder.Ks,O,Ma):null}}Object(e.a)(zb,"AddinCommandsBuilder",null,[]);class nc{constructor(O,Ma,Cb,lc,Dc,dd,kd){this.$Ra=
new ca.a;this.Fq=O;this.Qh=Ma;this.Lo=Cb;this.ribbonManager=lc;this.contextMenuManager=Dc;this.VF=dd;this.fga=kd;this.iO=Fc.AFrameworkApplication.ta.LD}CAb(O,Ma,Cb,lc,Dc,dd,kd){const sd=(Gd,Vd,Pe,Se)=>{Dc(Gd,Vd,Pe,Se);Gd=lf.a[this.Fq]+Vd.assetId;({value:Vd}=this.$Ra.Cc(Gd)).returnValue&&(Vd.stop(),this.$Ra.remove(Gd))};if(0!==this.Fq&&O){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",O.count);4===this.Fq&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
lc)),this.TWg(O,lc),dd());for(let Gd of O)if(O=Gd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.Ceg(O))if(kd&&O.requireConsent)kd(O,Vd=>{try{if(this.iO){const Se=lf.a[this.Fq]+Vd.solutionId,ef=this.iO.xc("ComponentAttach",Se);this.$Ra.ia(Se,ef)}const Pe=this.VF.aia(Vd.storeType,Vd.solutionId);6!==this.Fq&&(Pe&&(this.K0b(Pe),Pe.yB.purge(!1)),
this.Qh.insertOsfControl(this.HFb(Vd,Ma,Cb,sd)),Pe&&this.Qh.ownerAddinControlRecreated(Vd.solutionId,Vd.storeType))}catch(Pe){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.solutionId,Vd.ownerAddinStoreType||Vd.storeType,Vd.assetId,null,null,Vd.storeId),Vd.version,Vd.storeType,Vd.storeId,Pe.message)),sd(!1,Vd,null,null)}});
else try{if(this.iO){const Pe=lf.a[this.Fq]+O.solutionId,Se=this.iO.xc("ComponentAttach",Pe);this.$Ra.ia(Pe,Se)}const Vd=this.VF.aia(O.storeType,O.solutionId);6!==this.Fq&&(Vd&&(this.K0b(Vd),Vd.yB.purge(!1)),this.Qh.insertOsfControl(this.HFb(O,Ma,Cb,sd)),Vd&&this.Qh.ownerAddinControlRecreated(O.solutionId,O.storeType))}catch(Vd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Lo.PM,
Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,Vd.message)),sd(!1,O,null,null)}else sd(!1,O,null,null)}}Zpi(O,Ma,Cb,lc,Dc,dd){const kd=(sd,Gd,Vd,Pe)=>{dd(sd,Gd,Vd,Pe);sd=lf.a[this.Fq]+Gd.solutionId;({value:Gd}=this.$Ra.Cc(sd)).returnValue&&(Gd.stop(),this.$Ra.remove(sd))};if(6===this.Fq&&O)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,
O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.Ceg(O))try{if(this.iO){const Gd=lf.a[this.Fq]+O.solutionId,Vd=this.iO.xc("ComponentAttach",Gd);this.$Ra.ia(Gd,Vd)}const sd=this.VF.aia(O.storeType,O.solutionId);sd||kd(!1,O,null,null);Fc.AFrameworkApplication.ta&&Fc.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.CUe(O,Ma,lc,Dc,Cb,Gd=>{kd(Gd,O,Cb,sd.displayName)}):(this.CUe(O,Ma,lc,Dc,Cb),kd(!0,O,Cb,sd.displayName))}catch(sd){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,sd.message)),kd(!1,O,null,null)}else kd(!1,O,null,null)}REi(O,Ma,Cb,lc,Dc,dd){if(dd)if(dd._isAddinCommandsManifest(this.Lo.PM))try{Fc.AFrameworkApplication.ta&&Fc.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.BUe(O,Ma,Cb,Dc,dd,kd=>{lc(kd,O,dd,dd.getDefaultDisplayName())}):(this.BUe(O,Ma,Cb,Dc,dd),lc(!0,O,dd,dd.getDefaultDisplayName()))}catch(kd){n.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,kd.message)),lc(!1,O,dd,dd.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),lc(!1,O,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Lo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),
lc(!1,O,null,null)}HFb(O,Ma,Cb,lc){const Dc={},dd=document.createElement("div");dd.setAttribute("visible","false");Dc.div=dd;Dc.id=O.solutionId;Dc.solutionId=O.solutionId;Dc.version=O.version;Dc.storeType=O.storeType;Dc.storeId=O.storeId;Dc.assetId=O.assetId;Dc.assetStoreId=O.assetStoreId;Dc.isvirtualOsfControl=!0;Dc.virtualOsfControlActivationCallback=(kd,sd)=>{const Gd=this.VF.aia(O.storeType,O.solutionId);Gd&&(Gd.isUpgraded&&(O.isUpgraded=!0),this.K0b(Gd));this.REi(O,Ma,Cb,lc,kd,sd)};Dc.reason=
3===this.Fq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Dc}BUe(O,Ma,Cb,lc,Dc,dd=null){const kd={};kd.solutionId=lc.getSolutionId();kd.version=lc.getVersion();kd.storeType=lc.getStoreType();kd.storeId=lc.getStoreId();kd.assetId=lc.getSolutionId();kd.assetStoreId=lc.getAssetStoreId();kd.targetType=lc.getOsfControlType();let sd=null,Gd=null;if(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))sd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Lo.PM,this.Lo.formFactor)).parseExtensions(kd,Dc,this.fga),Gd=Xa.uYe(this.Lo.PM);else try{sd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Lo.PM,this.Lo.formFactor)).parseExtensions(kd,Dc,this.fga),Gd=Xa.uYe(this.Lo.PM)}catch(Pe){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Pe.message),Pe;}if(Gd&&0<Gd.count){if(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Vd=Ma(O);Ma=Cb(O);Cb=!!Fc.AFrameworkApplication.fa&&Fc.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Vd=new zb(Vd,null,Ma);for(let Pe of Gd)Vd.commandSurface=Pe,sd.apply(Vd,this.fga,Cb)}else try{let Pe=Ma(O),Se=Cb(O),ef=!!Fc.AFrameworkApplication.fa&&Fc.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Vd=new zb(Pe,null,Se);for(let lg of Gd)Vd.commandSurface=lg,sd.apply(Vd,this.fga,ef)}catch(Pe){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Pe.message),Pe;}if(OSF.OUtil.checkFlight(14))try{let Pe=Vd.Pad(O.solutionId,Dc.getDefaultDisplayName()),Se=Vd.eUe();Pe&&this.ribbonManager.EXa(Pe,dd);Se&&this.contextMenuManager.Oje(Se);this.VF.tke(lc,Pe,Se,Dc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Dc.getDefaultDisplayName())}catch(Pe){throw OfficeExt.DevConsole.log(Pe),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}else try{let Pe=Vd.Pad(O.solutionId,
Dc.getDefaultDisplayName()),Se=Vd.eUe();Pe&&this.ribbonManager.EXa(Pe);Se&&this.contextMenuManager.Oje(Se);this.VF.tke(lc,Pe,Se,Dc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Dc.getDefaultDisplayName())}catch(Pe){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}}}CUe(O,Ma,Cb,lc,Dc,dd=null){const kd={};kd.solutionId=O.solutionId;kd.version=O.version;kd.storeType=O.storeType;kd.storeId=O.assetStoreId;
kd.assetId=O.assetId;kd.assetStoreId=O.assetStoreId;kd.targetType=O.targetType;const sd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Lo.PM,this.Lo.formFactor);try{const Gd=Ma.getManifest(),Vd=sd.parse(kd,Gd,Dc,this.fga,Ma.getSharedRuntimeId(),Ma),Pe=Cb(O),Se=lc(O),ef=new zb(Pe,null,Se);ef.commandSurface="PrimaryCommandSurface";Vd.apply(ef,this.fga,!0);if(ef.ribbonBuilder.Ks&&0<ef.ribbonBuilder.Ks.count){const lg=ef.Pad(O.solutionId,Ma.getManifest().getDefaultDisplayName(),1);Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.EXa(lg,dd):lg&&this.ribbonManager.EXa(lg,dd);this.VF.fBg(Ma,lg,Dc,Ma.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ma.getManifest().getDefaultDisplayName())}}catch(Gd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ma.getManifest().getDefaultDisplayName(),Gd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Gd)}}K0b(O){O.Do&&this.ribbonManager.zHd(O.Do);
O.Spb&&this.contextMenuManager.p9i(O.Spb);this.VF.X8i(O.yB.getStoreType(),O.yB.getSolutionId())}TWg(O,Ma){Ma=xg(Ma);for(let Cb of this.VF.W4a){if(Cb.yB.getStoreType()!==Ma)continue;let lc=!0;for(let Dc of O){const dd=Dc;if(dd&&Cb.qff(dd.storeType,dd.solutionId)){lc=!1;break}}lc&&(this.K0b(Cb),Cb.yB.purge(!1))}}Ceg(O){return!!O&&!!O.solutionId&&!!O.version&&!!O.storeType&&!!O.storeId}}Object(e.a)(nc,"AddInCommandsIntegration",null,[]);class kc{constructor(O,Ma,Cb,lc,Dc,dd,kd,sd=null){this.eb=new og.a;
this.NCc=O;this.fmg=Ma;this.Rm=Cb;this.ehe=lc;this.qWa=Dc;this.vjg=dd;this.VOb=kd;this.vsg=sd;this.mqg=Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.OIc=Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}bDg(O){this.eb.addHandler(Nd.a.ine,O)}REg(O){this.eb.addHandler(Nd.a.ord,O)}sGg(O){this.eb.addHandler(Nd.a.R1f,O)}hDg(O){this.eb.addHandler(Nd.a.XVc,O)}qqi(O,Ma,Cb){const lc=Cb[Nd.a.zmb],
Dc=void 0===Cb[Nd.a.cP]?0:Cb[Nd.a.cP];if(lc&&0!==Dc)if(0>=lc.count&&4!==Dc)this.BGf(new fe(Dc,null,null,Ma,null,!0));else{var dd=lc.count,kd=new kf(new h),sd=void 0===Cb[Nd.a.X8]?-1:Cb[Nd.a.X8],Gd=new nc(Dc,this.Rm,this.NCc,kd,this.fmg,this.qWa,this.VOb),Vd=bg=>this.ehe.pQg(bg.solutionId,this.VOb,this.NCc,O),Pe=bg=>this.ehe.APg(bg.solutionId),Se=(bg,cg,Of)=>{dd--;Of=new fe(Dc,cg,kd,Ma,Of,0>=dd);if(bg&&cg)this.BGf(Of);else{if(3===Dc||cg&&cg.isUpgraded)bg="",cg&&(bg=Telemetry.PrivacyRules.GetPrivacyCompliantId(cg.solutionId,
cg.ownerAddinStoreType||cg.storeType,cg.assetId,null,null,cg.storeId)),cg={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:bg},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj(cg)}));this.AGf(Of)}dd||Fc.AFrameworkApplication.ta.updateCommandUI()},ef=(bg,cg,Of,mg)=>{Se(bg,cg,mg)},lg=()=>{this.Uwd();0>=lc.count&&4===Dc&&this.qWa.fNd()};6===Dc?(sd=Cb[Nd.a.UHa],Cb=Cb[Nd.a.VHa],Gd.Zpi(lc.na(0),
sd,Cb,Vd,Pe,(bg,cg,Of,mg)=>{Se(bg,cg,mg)})):Gd.CAb(lc,Vd,Pe,sd,ef,lg,this.vsg)}else ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.NCc.PM)),this.AGf(new fe(Dc,null,null,Ma,null,!0))}AGf(O){this.Uwd(O);this.H2f(!1,
O)}BGf(O){const Ma=O.Zj;let Cb=null;null!==Ma&&(Cb=Ma.storeType,Cb=Cb.toLowerCase());if(O&&"omex"===Cb&&(3===O.Fq||Ma.isUpgraded)){var lc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma.solutionId,Ma.ownerAddinStoreType||Ma.storeType,Ma.assetId,null,null,Ma.storeId)};ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Oe.a.Tj(lc)}))}this.Uwd(O);lc=this.OIc&&eh()&&"omex"===
Cb&&!!O.aW&&!!Ma.solutionId&&2===O.Fq&&Ma.solutionId.toLowerCase()===ag().toLowerCase();if("omex"===Cb&&O.aW&&(3===O.Fq&&"hardcodedpreinstall"!==Cb||Ma.isUpgraded)||lc)lc=new Ff,lc.Zj=Ma,lc.Do=O.aW.Mwa,this.eb.raiseEvent(Nd.a.XVc,lc);if(this.mqg){lc=ig();const Dc=ag();lc&&Ma&&"excatalog"===Ma.storeType&&O.aW&&5===O.Fq&&Dc&&(Ma.storeId&&Ma.storeId.toLowerCase()===Dc.toLowerCase()||Ma.assetId&&Ma.assetId.toLowerCase()===Dc.toLowerCase())&&(lc=new Ff,lc.Zj=Ma,lc.Do=O.aW.Mwa,this.eb.raiseEvent(Nd.a.XVc,
lc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}Ma&&(Td.instance.bXf(fh(Cb),!0),"uploadfiledevcatalog"===Cb&&(lc=this.vjg.createAddinDataProvider(Cb,this.Rm))&&lc.localCacheAddinCommands(this.Rm.Wba,Ma.solutionId,Ma.version,Ma.storeId),Fa.a.deb(Nd.a.Bmb,"true",fh(Cb)));this.H2f(!0,O)}H2f(O,Ma){O?Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ma.aW&&5===Ma.Fq&&Ma.aW.Mwa&&void 0!==Ma.Zj.showCallout&&
null!==Ma.Zj.showCallout&&Ma.Zj.showCallout?(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Tf(this.eb)).ESc(Ma.Zj,Jd.a.y2a(Ma.aW.Mwa)):(new Ee(this.eb,Ma.Zj,Jd.a.y2a(Ma.aW.Mwa))).ESc(),O=new Ff,O.Do=Ma.aW.Mwa,O.Zj=Ma.Zj,this.eb.raiseEvent(Nd.a.R1f,O)):3!==Ma.Fq?Ma.eif&&this.qWa.fNd():Ma.aW&&Ma.aW.Mwa&&"hardcodedpreinstall"!==Ma.Zj.storeType&&Fb.a.yyj(Ma.displayName,Ma.aW.Mwa,Ma.Zj.isAutoLaunched):3===Ma.Fq?Ma.Zj&&"uploadfiledevcatalog"===
Ma.Zj.storeType.toLowerCase()?(Ma=this.VOb.FMh(Ma.Zj.solutionId),Fb.a.lQd(Ma?Ma:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.qWa.jYf():Ma.eif&&this.qWa.fNd()}Uwd(O=null){var Ma=O?O.Zj:null;const Cb=new Ff;if(Cb.Zj=Ma){var lc=this.qWa.aia(Ma.storeType,Ma.solutionId,6===O.Fq?1:0);if(lc&&lc.Do){Cb.Do=lc.Do;var Dc=this.OIc?ag():null;Dc=this.OIc&&eh()&&!!Ma.solutionId&&!!Dc&&Ma.solutionId.toLowerCase()===Dc.toLowerCase()&&2===O.Fq;if(3===O.Fq&&"hardcodedpreinstall"!==
Ma.storeType||Dc)O="",lc.Do.mV&&lc.Do.mV.Ks&&(lc=lc.Do.mV.Ks.na(0))&&(O=lc.id),Ma={["SDX_CommandPlacement"]:O,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma.solutionId,Ma.ownerAddinStoreType||Ma.storeType,Ma.assetId,null,null,Ma.storeId)},ve.a.sendTelemetryEvent(Object.assign(new Df.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Oe.a.Tj(Ma)}))}}this.eb.raiseEvent(Nd.a.ine,Cb)}}Object(e.a)(kc,"LaunchAddinCommandsHandler",
null,[827]);class fc{}fc.FTa="Alt";fc.GTa="Command";fc.id="Id";fc.ITa="Image16by16";fc.FOb="LabelText";fc.KTa="Title";fc.GROUP="Group";fc.r_d="Groups";fc.ifb="Controls";fc.button="Button";fc.Q$="FlyoutAnchor";fc.LARGE="Large";fc.SMALL="Small";Object(e.a)(fc,"AddinDataNodeConstants",null,[]);a(372);a(563);a(557);a(160);class Zc{constructor(O,Ma){this.tDa=this.I2d=null;if(ee.c(O)||ee.c(Ma))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.lmg=Ma;this._id=O;this.IT[fc.id]=this._id}get id(){return this._id||""}get IT(){return this.I2d||(this.I2d={})}get controlType(){return this.lmg||""}get menuItems(){return this.tDa||(this.tDa=new l.a)}}Object(e.a)(Zc,"ControlDefinition",null,[794]);class od{constructor(O){this.F$d=null;if(ee.c(O))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=O;this.Eka[fc.id]=this._id}get Eka(){return this.F$d||
(this.F$d={})}get id(){return this._id||""}}Object(e.a)(od,"MenuItemDefinition",null,[830]);class pd{constructor(O){this.Koa=null;if(ee.c(O))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=O}get id(){return this._id}get controls(){return this.Koa||(this.Koa=new l.a)}}Object(e.a)(pd,"OfficeMenuDefinition",null,[793]);var Ld=a(25);class be{constructor(O,Ma,Cb){this.MI=
this.vUa=null;this.$Lc=O;this.kUa=Ma;this.MTa=Cb;this.Urg=new l.a}get akc(){return this.$Lc}get upb(){return this.kUa}get HRc(){return this.MTa}addButton(O){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",O.actionType);this.MI=new Zc(this.Hra(O.id),fc.button);this.MI.IT[fc.FOb]=O.label;this.MI.IT[fc.FTa]=O.label;this.MI.IT[fc.ITa]=O.icon["16"];this.Snb(this.MI.IT[fc.id],O.action);this.REa(this.MI.IT);this.vUa.controls.add(this.MI);this.MI=null}startBuildMenu(O){if(ee.c(this.vUa))this.vUa=
new pd(O.id);else{const Ma=this.Hra(O.id);this.MI=new Zc(Ma,fc.Q$);this.oZa(this.MI.IT,O);this.MI.IT[fc.ITa]=O.icon["16"];this.MI.IT[fc.GTa]=Ld.a.alwaysEnabled}}addMenuItem(O){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",O.actionType);const Ma=new od(this.Hra(O.id));this.oZa(Ma.Eka,O);O.icon&&(Ma.Eka[fc.ITa]=O.icon["16"]);this.Snb(Ma.Eka[fc.id],O.action);this.REa(Ma.Eka);this.MI.menuItems.add(Ma)}endBuildMenu(){ee.c(this.MI)?(this.ujc.add(this.vUa),this.vUa=null):(this.vUa.controls.add(this.MI),
this.MI=null)}get ujc(){return this.Urg}Snb(O,Ma){this.HRc.bindAction(O,Ma)}REa(O){this.upb.REa(O)}Hra(O){return this.akc.kJa(O)}oZa(O,Ma){O[fc.FOb]=Ma.label;O[fc.FTa]=Ma.label}}Object(e.a)(be,"ContextMenuExtensibilityCreator",null,[817,810]);class De{constructor(O){this.fjb=O}get oCb(){return this.fjb}kJa(O){return this.oCb+O}}Object(e.a)(De,"DefaultContextMenuNamingProvider",null,[816]);var xe=a(1306);class Fe{bindAction(O,Ma){OfficeExt.DefaultControlActionBinder.bindAction(O,Ma)}}Object(e.a)(Fe,
"DefaultUIControlActionBinder",null,[818]);class Ue{constructor(O){this.aCa=O}get command(){return this.aCa}REa(O){O[fc.GTa]=this.command}}Object(e.a)(Ue,"DefaultUIControlCommandBinder",null,[811]);var af=a(32);class hf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(hf,"AddInControl",null,[]);class pf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(pf,
"AddInGroup",null,[]);class mf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(mf,"AddInMenuItem",null,[]);class Nf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(Nf,"AddInTab",null,[]);class wf{constructor(O,Ma,Cb,lc,Dc,dd){this.SOb=new l.a;this.ygb=this.tea=this.wUa=null;this.$Lc=O;this.MTa=Ma;this.kUa=Cb;
this.ex=lc;this.VOb=Dc;this.H4d=dd}get akc(){return this.$Lc}get Ks(){return this.SOb}get HRc(){return this.MTa}get upb(){return this.kUa}startBuildTab(O){const Ma=O.isOfficeTab?O.id:this.akc.F1e(O.id),Cb=O.isOfficeTab?null:O.label;this.wUa=Object.assign(new Nf,{id:Ma,title:Cb,isOfficeTab:O.isOfficeTab,visible:O.visible,groups:[],tabType:O.tabType,insertBefore:O.insertBefore,insertAfter:O.insertAfter,autoFocus:O.autoFocus})}startBuildGroup(O){const Ma=this.Hra(O.id);this.tea=Object.assign(new pf,
{id:Ma,mlrId:O.mlrId,title:O.label,controls:[],groupType:0})}addNativeGroup(O){this.tea=Object.assign(new pf,{id:O.id,mlrId:O.mlrId,title:O.label,controls:[],groupType:1});this.wUa.groups.push(this.tea)}addButton(O){const Ma=this.Hra(O.id);Ma&&(this.Snb(Ma,O.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new hf,{id:Ma,title:O.label,iconLocation:this.cdd(O),enabled:O.enabled,controlType:0,attributes:this.oZa()}),this.H4d.Bje(new af.a(Ma,
this.upb.command.toString())),this.tea.controls.push(O))}addNativeControl(O){O.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new hf,{id:O.id,title:"",iconLocation:"",enabled:O.enabled,controlType:2,attributes:this.oZa()}),this.tea.controls.push(O))}startBuildMenu(O){const Ma=this.Hra(O.id);Ma&&(this.ygb=Object.assign(new hf,{id:Ma,title:O.label,iconLocation:this.cdd(O),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(O){const Ma=
this.Hra(O.id);Ma&&(this.Snb(Ma,O.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",O.actionType),O=Object.assign(new mf,{id:Ma,title:O.label,iconLocation:this.cdd(O),enabled:O.enabled,attributes:this.oZa()}),this.H4d.Bje(new af.a(Ma,this.upb.command.toString())),this.ygb.menuItems.push(O))}endBuildMenu(){ee.c(this.ygb.id)||this.tea.controls.push(this.ygb);this.ygb=null}endBuildGroup(){ee.c(this.tea.id)||this.wUa.groups.push(this.tea);this.tea=null}endBuildTab(){ee.c(this.wUa.id)||
this.SOb.add(this.wUa);this.wUa=null}oZa(){const O={};this.REa(O);return O}cdd(O){return O.icon["80"]?O.icon["80"]:O.icon["32"]}REa(O){this.upb.REa(O)}Hra(O){return this.akc.kJa(O)}Snb(O,Ma){this.HRc.bindAction(O,Ma)}}Object(e.a)(wf,"OneLineRibbonExtensibilityCreator",null,[809,810]);class vg{constructor(O,Ma){this.fjb=O;this.MTa=new Fe;this.kUa=new Ue(Ma)}APg(O){O=new De(O);return new be(O,this.kUa,this.MTa)}pQg(O,Ma,Cb,lc){Cb=new xe.a(this.fjb,O,Cb,!0);return new wf(Cb,this.MTa,this.kUa,O,Ma,lc)}}
Object(e.a)(vg,"UIExtensibilityFactory",null,[789]);var ug=a(90),Qg=a(858),lh=a(22),Gf=a(37),Hg=a(77),qf=a(50);class Ig{constructor(O){this.dFa=this.iFa=this.Zj=this.Do=null;this.VNf=0;this.UMi=()=>{if(this.Zj&&this.dFa){const Ma=new ug.a(Ld.a.C1,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ma,{["SourceControlId"]:this.dFa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.zyj=(Ma,Cb)=>{Ma=null;if(Cb)if(Ma=Cb,this.Zj=Ma.Zj,(this.Do=Ma.Do)&&this.Do.mV&&
this.Do.mV.Ks&&(this.iFa=this.Do.mV.Ks.na(0)),this.iFa&&this.iFa.id)if(this.iFa.isOfficeTab)if(Cb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ma=this.Zj.solutionId,Ma in Cb?this.dFa=Cb[Ma]:(Cb=Ig.GetPrivacyCompliantId(this.Zj),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Cb}`),this.dFa=this.BGh(this.Do)),this.dFa)if(lh.a.contains(this.iFa.id,Cd.a.JV,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Jd.a.y2a(this.Do),
()=>{this.h3f(this.med(this.dFa))});else{if(Cb=this.$.Ka)Cb.Zme(this.rCf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Cb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Oe.a.Tj(Cb)})),this.W4();else this.j3f(this.med(this.iFa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Cb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Cb)})),this.W4();
else this.W4()};this.rCf=()=>{if(lh.a.contains(this.iFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ma=this.$.Ka;Ma&&Ma.UPf(this.rCf);this.h3f(this.med(this.dFa))}};this.WMi=()=>{var Ma={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Ma)}));this.W4();let Cb=
{};Cb[Hg.a.Zf]=this.zC;Ma={};Ma.solutionId=this.zC.solutionId;Ma.assetId=this.zC.assetId;Ma.assetStoreId=this.zC.assetStoreId;Ma.height=0!=this.zC.height?this.zC.height:600;Ma.storeId=this.zC.storeId;Ma.storeType=this.zC.storeType;Ma.targetType=this.zC.targetType;Ma.width=0!=this.zC.width?this.zC.width:600;Ma.displayName=this.zC.displayName;Ma.version=this.zC.version;Ma.isAddinCommands=!1;Cb[Nd.a.gra]=Ma;let lc=new ug.a(-741808261,0,0,2,null);Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.Ta(this.$.da,
374,375,1),Dc=>{Dc=Dc.result;null!=Dc&&Dc.insertAgave(Cb,lc)},this.$.la,3)};this.KGi=()=>{let Ma={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Ma)}));this.W4()};this.dIi=()=>{let Ma={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Ma)}));this.W4()};this.yV=Ma=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ma?Ma.httpStatus:-1}`)};this.$=O.$;this.addinUICommandHandler=O;this.appName=Fc.AFrameworkApplication.fa.Va("WebAppShortName")||"Excel";this.aHg=Fc.AFrameworkApplication.fa.nd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static HTa(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}r8i(O){this.zC=O;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.WMi,!0),window.addEventListener("DismissCallout",this.dIi,!0),window.addEventListener("CloseCallout",this.KGi,!0))}med(O){return"[id="+O+"]"}j3f(O,
Ma){Ma>this.aHg?(window.clearTimeout(this.VNf),this.i3f("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+O)?this.i3f(O):this.VNf=window.setTimeout(()=>{this.j3f(O,Ma+1)},1E3)}h3f(O){var Ma=document.querySelector("button[data-unique-id='RightPaddle']");if(Ma)O={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));else if(Ma=document.querySelector("button"+O),!Ma||"none"===window.getComputedStyle(Ma).display)if(Ma=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ma){Ma={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(Ma)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.W4();return}this.M9f(Ma,"ShowTeachingUIForAddinButton")}i3f(O){O=document.querySelector("button"+O);if(!O&&(O=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!O)){O={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));n.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.W4();return}this.M9f(O,"ShowTeachingUIForAddinTab")}M9f(O,Ma){O.setAttribute("lpp-id","latestAddin");const Cb=wc.a.instance.Vb("Common.ISystemInitiatedFeedback");Cb&&O?(Cb.execute(lc=>{lc.logActivity(Ma,null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Ig.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)})),this.W4())}BGh(O){if(!O)return null;O=O.mV;if((null===O||void 0===O?0:O.Ks)&&0<O.Ks.count)for(let Ma of O.Ks)if(Ma.groups&&0<Ma.groups.length)for(const Cb of Ma.groups)if(Cb.controls&&0<Cb.controls.length)for(const lc of Cb.controls){if(lc.attributes&&
0===lc.controlType&&lc.enabled)return lc.id;if(lc.menuItems)for(const Dc of lc.menuItems)if(Dc.attributes&&Dc.enabled)return lc.id}return null}RAj(){var O=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(O&&"none"!==window.getComputedStyle(O).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{O=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==O){O={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)}));n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.W4();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ma=wc.a.instance.Vb("Common.ISystemInitiatedFeedback");null==
Ma||null==O?(O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.W4()):(Ma.execute(Cb=>{Cb.logActivity("ShowTeachingUIForContentAddin",null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Ig.HTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj(O)})),n.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}r6(O){const Ma={},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=O;Ma[this.appName]=rd.c(Cb);this.Emb=new hg(this.appName,null,null,
this.yV),this.Emb.K1a(Ma),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}W4(){if(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.YPa){const O=window.g_roamingAddinList;O&&(this.r6(O),this.YPa=!0)}}}Object(e.a)(Ig,"AddinTeachingCalloutHandler",null,[]);var zh=a(1225),Vi=a(373),Nh=a(11),hi=a(181),Hh=a(40),zg=a(21),sh=a(55);class vi{constructor(O,
Ma,Cb,lc,Dc,dd,kd=null){this.disposed=!1;this.wFi=(sd,Gd)=>{if(Gd)if(Gd)if(sd=Gd.Zj){Gd=Gd.Do;var Vd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(sd.solutionId in Vd)Gd=Vd[sd.solutionId];else if(Gd=this.qKh(Gd),void 0===Gd||null===Gd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Vd=new ug.a(Ld.a.C1,0,0,2,null);this.executeCommand(0,Vd,{["SourceControlId"]:Gd},null);sd.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,
15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.W9e=(sd,Gd)=>{"Insert"==Gd.tabName&&(sd=this.$.Ka,null!=sd&&(sd.UPf(this.W9e),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.bMb.RAj())};this.VMi=(sd,Gd)=>{sd=null;Gd&&(sd=Gd);(null===sd||void 0===sd?0:sd.Do)&&this.Irj(sd.Do);this.$.pf();y.EwaSettings.ma(87)&&sd&&sd.Zj&&this.vMg(sd.Zj)};this.$=
O;n.ULS.shipAssertTag(537170659,0,!(void 0===Ma||null===Ma),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Hh.a.u2()}`);this.oe=Ma;this.tAe=Cb;this.oYb=lc;this.gga=Dc;this.Cmb=dd;this.Lo=new Qg.a;this.fga=new $f;this.$8c=kd;ke.a.Awb=ke.a.BPe;this.f4c=new l.a;this.L0a=new l.a}dispose(){void 0!==this.Cmb&&null!==this.Cmb&&(this.Cmb.dispose(),this.Cmb=null);this.oe=this.$=null;this.disposed=!0}Rvj(O,Ma){switch(O){case Ld.a.C1:O=this.Cvj(Ma);break;default:O=!1}return O}Qc(){return!1}executeCommand(O,
Ma,Cb){O=Gf.TaskExtensions.vk();Ma=Ma.command;switch(Ma){case 843847158:break;case -2025863019:Fb.a.lQd(Cb[Nd.a.ZTc].toString(),()=>{zg.g(this.$).focus()});break;case -1777565636:zh.a.showUILessDialog(Cb[Nd.a.Dmb].toString());this.oe.Nyj(Cb[Nd.a.Dmb].toString());break;case 1592314317:zh.a.hideUILessDialog(Cb[Nd.a.Dmb].toString());this.oe.l5h(Cb[Nd.a.Dmb].toString());break;case Ld.a.C1:O=this.cgd(Cb);break;case Ld.a.BAb:this.CAb(Cb);break;case Ld.a.pma:this.pma(Cb);break;case Ld.a.mQd:this.Cmb.fwc();
break;case Ld.a.refreshAddinCommands:this.g6i();break;case 1949669462:this.gga.jYf(!0);break;case -1014260128:O=this.executeDynamicAddInCommandsAPI(Cb);break;default:O=hi.a(Ma)}return O}Ec(O,Ma){O=!1;switch(Ma.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Ld.a.pma:case Ld.a.mQd:case Ld.a.refreshAddinCommands:case 1949669462:case Ld.a.BAb:case -1014260128:O=!0;break;case Ld.a.C1:O=!Fc.AFrameworkApplication.protectedFile}return O}Vc(){return!1}qKh(O){if(!O)return n.ULS.sendTraceTag(528098432,
220,10,"Failed to get button id for addin"),null;if((O=O.mV)&&O.Ks&&0<O.Ks.count)for(let Ma of O.Ks){if(Ma.groups&&1===Ma.groups.length){O=Ma.groups[0];if(O.controls&&1===O.controls.length){const Cb=O.controls[0];if(Cb.attributes&&!Cb.controlType&&Cb.enabled)return Cb.id}O.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ma.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}g6i(){if(this.gga.esd()){this.gga.dxe();var O=this.ibd();if(O&&0<O.count)for(let Ma of O)O=
{[Nd.a.X8]:Ma,[Nd.a.cP]:4,[Nd.a.gFa]:(new Date).getTime()},this.pma(O)}}pma(O){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${O[Nd.a.cP]}, DataProvider ${O[Nd.a.X8]}.`);this.gga.Ynj();window.setTimeout(()=>{if(void 0===this.oe||null===this.oe)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Hh.a.u2()}`);else{const Ma=new ff(new ia(this.oe.Qh),Hb.instance,
Td.instance);Ma.aDg((Cb,lc)=>{this.CAb(lc.properties)});Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ma.tGg((Cb,lc)=>{null==lc?ve.a.sendTelemetryEvent(Object(Sa.a)(new Df.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Oe.a.Tj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.bMb=new Ig(this),this.bMb.r8i(lc),Cb=this.$.Ka,null!=Cb&&(Cb.Zme(this.W9e),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ma.iNj(O)}},0)}CAb(O){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${O[Nd.a.cP]}.`);try{if(y.EwaSettings.ma(186)){const Cb=O[Nd.a.zmb];if(Cb&&0<Cb.count){const lc=Cb.count;for(let Dc=lc-1;0<=Dc;Dc--){const dd=Cb.na(Dc);OSF.OsfControl.isFirstPartyStoreString(dd.storeType)||
Cb.remove(Cb.na(Dc))}if(Cb.count<lc){const Dc=qf.GetServiceTaskFactory.Ta(this.$.da,5,4,0);Gf.TaskExtensions.Aa(Dc,()=>{Dc.result.Yf(36,null)},this.$.la,3)}if(!Cb.count)return}}if(void 0===this.oe||null===this.oe)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Hh.a.u2()}`);else{var Ma=null;Ma=Fc.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new kc(this.Lo,this.tAe,new ia(this.oe.Qh),new vg(this.$.Bb,Ld.a.C1),this.gga,
Hb.instance,this.fga,(Cb,lc)=>{const Dc={};Dc.InstanceId=ze.a.create().toString();Dc.PrimaryMarketplace={};Dc.PrimaryMarketplace.SolutionId=Cb.solutionId;Dc.PrimaryMarketplace.SolutionVersion=Cb.version;Dc.PrimaryMarketplace.MarketplaceType=Cb.storeType;Dc.PrimaryMarketplace.MarketplaceRef=Cb.storeId;Dc.WebExtensionType=1;this.oe.XAj(Dc,()=>{lc(Cb)})}):new kc(this.Lo,this.tAe,new ia(this.oe.Qh),new vg(this.$.Bb,Ld.a.C1),this.gga,Hb.instance,this.fga);Ma.hDg(this.wFi);Ma.bDg(this.VMi);if(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Cb=new Ig(this);Ma.REg(Cb.UMi);Ma.sGg(Cb.zyj)}this.$.da.za(53).Xl&&nf.a.get_instance().pk(5,null).continueWith(()=>{this.disposed||Ma.qqi(this.$8c,this.$.domElement,O)})}}catch(Cb){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Cb.message}.`)}}}cgd(O){const Ma=Gf.TaskExtensions.vk();O=O[this.Lo.fha];const Cb=this.oYb.IRc(O),lc=new zh.a(this.$,this.oe,Cb.ownerAddinInfo,Ma);return this.A3e(Ma,O,Cb,lc)}A3e(O,Ma,Cb,lc){this.oYb.cgd(Ma,this.gga,lc,new ia(this.oe.Qh),
Cb,()=>{O=lc.N0g()},()=>{zg.g(this.$).focus()});return O}vMg(O){const Ma=Gf.TaskExtensions.vk();var Cb=this.oe.L$(O.solutionId);if(Cb){var lc=this.oe.AY(Cb);if(Nh.HelperMethods.qw(lc)&&0!==lc.SharedRuntime.State)return}lc=this.oYb.wMg;const Dc=O.solutionId in lc?lc[O.solutionId]:null;if(Dc){const dd=this.oYb.IRc(Dc),kd=new zh.a(this.$,this.oe,dd.ownerAddinInfo,Ma),sd=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,null!==dd.ownerAddinInfo?dd.ownerAddinInfo.storeType:O.storeType,O.assetId,
null,null,O.storeId);lc=Gd=>{if(Gd){const Vd={};for(const Pe of Gd)Vd[Pe[0]]=Pe[1];(Gd=Nd.a.gne in Vd?Vd[Nd.a.gne]:null)&&"true"===Gd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${sd}.`),this.A3e(Ma,Dc,dd,kd))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${sd}.`);if(Cb)lc(this.oe.AY(Cb).OsfPropertyBag);else if(Cb=
this.$.ea.workbookContext.WebExtensions)for(const Gd of Cb)if((1===Gd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===O.targetType&&Gd.PrimaryMarketplace.MarketplaceType.toLowerCase()===O.storeType.toLowerCase()&&Gd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===O.storeId.toLowerCase()&&Gd.PrimaryMarketplace.SolutionId.toLowerCase()===O.solutionId.toLowerCase()){lc(Gd.OsfPropertyBag);break}}}CTd(O,Ma,Cb=!1){O&&(!Cb||Ma||this.f4c.contains(O)||this.f4c.add(O),(Cb=
this.L0a.contains(O))&&Ma&&this.L0a.remove(O),Cb||Ma||this.L0a.add(O))}Irj(O){if((O=O.mV)&&O.Ks)for(let Ma of O.Ks)if(Ma.groups)for(const Cb of Ma.groups)if(Cb.controls)for(const lc of Cb.controls)if(this.CTd(lc.id,lc.enabled,!0),1===lc.controlType&&lc.menuItems)for(const Dc of lc.menuItems)this.CTd(Dc.id,Dc.enabled,!0)}ibd(){const O=new l.a;y.EwaSettings.ma(53)&&(this.$.ea.Sg.get(27)&&(O.add(0),O.add(16)),this.$.ea.Sg.get(33)&&O.add(1),O.add(8));return O}executeDynamicAddInCommandsAPI(O){let Ma=
!0;if(void 0===O||null===O||void 0===O[Nd.a.Mrb]||null===O[Nd.a.Mrb])return sh.Task.Ua(!1);switch(O[Nd.a.Mrb]){case 1:Ma=this.mQj(O);break;case 2:Ma=this.Mrj(O);break;case 4:this.L0a.clear();this.L0a.addRange(this.f4c);break;case 3:Ma=this.installContextualTab(O);break;default:Ma=!1}return sh.Task.Ua(Ma)}Cvj(O){return O&&this.Lo.fha in O?(O=O[this.Lo.fha])?this.L0a.contains(O):!1:!1}mQj(O){var Ma=null;let Cb=null,lc=null,Dc=!0;void 0!==O[Nd.a.S2]&&null!==O[Nd.a.S2]&&void 0!==O[this.Lo.fha]&&null!==
O[this.Lo.fha]&&void 0!==O[Nd.a.R2]&&null!==O[Nd.a.R2]&&(Ma=O[Nd.a.S2],Cb=O[Nd.a.M5b],lc=O[this.Lo.fha],Dc=O[Nd.a.R2]);if(!Ma||!lc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;O=(new xe.a(this.$.Bb,Ma,this.Lo,!0)).kJa(lc);Ma={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ma.AssetId=Cb;Ma.MaskedTabId=O;Ma.IsToEnable=Dc;n.ULS.sendTraceTag(537170648,220,50,w.a.Ac(Ma));this.CTd(O,Dc);Vi.a.EA.updateCommandUI();return!0}Mrj(O){var Ma,
Cb,lc=null,Dc=null;let dd=null;var kd=null;let sd=!0;void 0!==O[Nd.a.L5c]&&null!==O[Nd.a.L5c]&&void 0!==O[Nd.a.S2]&&null!==O[Nd.a.S2]&&void 0!==O[this.Lo.fha]&&null!==O[this.Lo.fha]&&void 0!==O[Nd.a.R2]&&null!==O[Nd.a.R2]&&(lc=O[Nd.a.L5c],Dc=O[Nd.a.S2],dd=O[Nd.a.M5b],kd=O[this.Lo.fha],sd=O[Nd.a.R2]);if(!lc||!Dc||!kd)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;O=(new xe.a(this.$.Bb,Dc,this.Lo,!0)).F1e(kd);kd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
kd.StoreType=lc;kd.AssetId=dd;kd.MaskedTabId=O;kd.IsToShow=sd;n.ULS.sendTraceTag(537170646,220,15,w.a.Ac(kd));lc=this.gga.aia(lc,Dc,1);Dc=!1;if(null===(Cb=null===(Ma=null===lc||void 0===lc?void 0:lc.Do)||void 0===Ma?void 0:Ma.mV)||void 0===Cb?0:Cb.Ks)for(let Gd of lc.Do.mV.Ks)if(Gd.id===O){Dc=!0;break}if(!Dc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ma=[];sd?appChrome.selectors.getSelectedTabId()!==O&&Ma.push(appChrome.actions.activateRibbonTab(O)):
(appChrome.selectors.getSelectedTabId()===O&&Ma.push(appChrome.actions.setCurrentTab(Cd.a.JV)),Ma.push(appChrome.actions.deactivateRibbonTab(O)));appChrome.api.dispatch(Ma);return!0}installContextualTab(O){let Ma=null,Cb=null,lc=null;var Dc=null;if(void 0!==O[Nd.a.S2]&&null!==O[Nd.a.S2]&&void 0!==O[Nd.a.R2]&&null!==O[Nd.a.R2]){const dd=O[Nd.a.R2];Ma=O[Nd.a.S2];void 0!==dd[Nd.a.UHa]&&null!==dd[Nd.a.UHa]&&void 0!==dd[Nd.a.VHa]&&null!==dd[Nd.a.VHa]&&(Cb=dd[Nd.a.UHa],lc=dd[Nd.a.VHa],Dc=dd[Nd.a.M5c])}if(!(Ma&&
lc&&Cb&&Dc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;O=this.gga.aia(Dc.PrimaryMarketplace.MarketplaceType,Dc.PrimaryMarketplace.SolutionId,1);if(null===O||void 0===O?0:O.Do)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;O={};O.solutionId=Dc.PrimaryMarketplace.SolutionId;O.version=Dc.PrimaryMarketplace.SolutionVersion;O.storeType=Dc.PrimaryMarketplace.MarketplaceType;O.storeId=Dc.PrimaryMarketplace.MarketplaceRef;
O.assetId=Dc.PrimaryMarketplace.SolutionId;O.assetStoreId=Dc.PrimaryMarketplace.MarketplaceRef;O.targetType=Dc.WebExtensionOsfControlType;O.width=Dc.TaskpaneWidth;O.height=0;O.isAddinCommands=!0;Dc=new l.a;Dc.add(O);O={};O[Nd.a.zmb]=Dc;O[Nd.a.cP]=6;O[Nd.a.UHa]=Cb;O[Nd.a.VHa]=lc;this.CAb(O);return!0}}Object(e.a)(vi,"AddinUICommandHandler",null,[189,188,3]);var wi=a(65),Wi=a(596),Xi=a(18),Li=a(17);class xi extends Bd.a{constructor(O){super(O);this.handler=null;this.Pyg=()=>{n.ULS.sendTraceTag(38410434,
0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Bd&16384)}]`);const Ma=new bd.a;this.$.da.Za(53,Vd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Ma.setResult(Vd)});const Cb=Ma.task,lc=new yb,Dc=Zb.a.getInstance(),dd=new Ud(this.$,Dc),kd=qf.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ib),sd=this.T6i(lc),Gd=qf.GetServiceTaskFactory.Ta(this.$.da,349,
350,this.ib);return Gf.TaskExtensions.Aa(Gf.TaskExtensions.Xd([Cb,kd,sd,Gd],this.la),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(this.$.da,106,this.la,this.ib),Vd=>{this.handler=new vi(this.$,Vd.result,lc,new hc,Dc,dd,wc.a.instance.uh("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.ld([this.handler]);this.$.da.Ga(198,this.handler)},this.la,3)},this.la,3)};this.gbh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ka.rab(this.handler),this.$.da.YT(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.YT(204);Li.a(Xi.a,21,this.$.da,198)}}Dd(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");wi.a(this.$).add(Object(Sa.a)(new Wi.a,
{lvc:()=>{const O=this.$.ea.uF&&this.$.ea.hc&&!!(this.$.Bd&16384)&&this.$.isEditMode;this.$.ea.hc&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${O}] IsSessionFullyLoaded [${this.$.ea.uF}] IsSessionActive [${this.$.ea.hc}] ShowCommandUI [${!!(this.$.Bd&16384)}] IsEditMode [${this.$.isEditMode}]`);return O},zWb:this.Pyg,e4b:this.gbh,P1a:2}))}T6i(O){const Ma=qf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib);
return Gf.TaskExtensions.Aa(Ma,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new He(Ma.result,O))},this.la,3)}static ka(O){Bd.a.Rd(199,new xi(O))}}Object(e.a)(xi,"AddinUICommandHandlerFactory",Bd.a,[]);var yi=a(1183),zi=a(1187),Oh=a(695);class Ph extends k.a{constructor(O){super();this.$=O;this.Fb()}create(){let O;if(y.EwaSettings.ma(400)){const Ma=qf.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.ib),Cb=qf.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ib);Gf.TaskExtensions.Aa(sh.Task.zL(Ma,Cb),()=>{y.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?this.qb(Object(Oh.a)(this.$.da,278,()=>new yi.CustomFunctionsInstaller(this.$,Ma.result,Cb.result))):this.qb(this.$.da.za(278)||new yi.CustomFunctionsInstaller(this.$,Ma.result,Cb.result))},this.$.la,3)}else y.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?
O=Object(Oh.c)(this.$.da,278,()=>new zi.CustomFunctionsLegacyInstaller(this.$)):(O=this.$.da.za(278))||(O=this.$.da.Ga(278,new zi.CustomFunctionsLegacyInstaller(this.$))),this.qb(O)}static ka(O){O.da.Ga(279,new Ph(O))}}Object(e.a)(Ph,"CustomFunctionsInstallerFactory",k.a,[]);var Qh=a(86),Yi=a(47),Zi=a(45);class Bh{constructor(O,Ma){this.ZOa=this.$Oa=null;this.P9f=(Cb,lc)=>{let Dc=null,dd=null,kd=null;lc?(Object(M.a)(222,lc)?(Dc=lc.pFa,kd=lc.instanceId):Object(M.a)(295,lc)&&(Dc=lc.get_element(),kd=
lc.instanceId),Dc)?(dd=Object(L.a)(742,Cb),dd)?this.yLf(kd,Dc,dd)||kd in this.ZOa||(this.$Oa[kd]=0,this.ZOa[kd]=Yi.a.instance.HE(()=>{10<=this.$Oa[kd]||this.yLf(kd,Dc,dd)?(delete this.$Oa[kd],this.ZOa[kd].dispose(),delete this.ZOa[kd]):this.$Oa[kd]+=1},500,Zi.a.MHg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,
0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=O;this.$=Ma;this.MVc=!1;this.$.da.Ga(224,this)}ka(O){this.MVc?n.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.MVc=!0,this.ZOa={},this.$Oa={},O?O.LDg(this.P9f):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(O){if(O){O.$$i(this.P9f);O=this.ZOa;for(let Ma in O)Qh.a.Ia(O[Ma]);this.$Oa=this.ZOa=
null;this.MVc=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}yLf(O,Ma,Cb){if(this.vdi(Cb,O))return!1;O=Ma.querySelector("iframe");if(!O)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;O=O.title;if(!O||!O.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(O);
return!0}vdi(O,Ma){return(O=O.Qh.getOsfControl(Ma))?O.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(Bh,"AgaveOnSelectedReadoutHandler",null,[743]);class Vg extends k.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da;Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.Ta(O,211,212,this.ib),Ma=>{Ma=O.za(224)||new Bh(Ma.result,this.$);this.qb(Ma)},this.la,3)}static ka(O){O.da.Ga(225,new Vg(O))}}Object(e.a)(Vg,"AgaveOnSelectedReadoutHandlerFactory",k.a,[]);var Jg=a(732),
Rh=a(54);const vh=(O,Ma)=>Rh.a.asd(64,()=>window.OfficeExtension&&window.OfficeExtension.WacRuntime,Fc.AFrameworkApplication.fa.nd("MaxRetriesForLoadingScript",0),O,Ma);var Mi=a(236);class hh{constructor(O,Ma,Cb){this.iframe=O;this.onSuccess=Ma;this.onError=Cb;$addHandler(window,"message",Object(sc.a)(this,this.I4e,"handleResponse"))}I4e(O){try{if(O&&O.rawEvent&&O.rawEvent.origin&&this.iframe&&this.iframe.id){var Ma=this.TEf(O.rawEvent.origin);const Cb=this.TEf(document.domain);if(R.a.Rk().equals(Cb,
Ma))if(O.rawEvent.source&&O.rawEvent.source.frameElement&&O.rawEvent.source.frameElement.id&&R.a.Rk().equals(O.rawEvent.source.frameElement.id,this.iframe.id)){Ma=null;try{Ma=JSON.parse(O.rawEvent.data)}catch(lc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",lc.message)}Ma?(Ma.statusCode!==Mi.a.DO||void 0!==Ma.error&&Ma.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
Ma.statusCode,Ma.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ma.authorizationCode?Ma.authorizationCode:Ma.signInUrl)),$removeHandler(window,"message",Object(sc.a)(this,this.I4e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Cb){n.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",Cb.message)}}TEf(O){let Ma="";try{O&&(Ma=-1<O.indexOf("//")?O.split("/")[2]:O.split("/")[0])&&(Ma=Ma.split(":")[0],Ma=Ma.split("?")[0])}catch(Cb){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Cb.message)}return Ma}static ka(O,Ma,Cb){new hh(O,Ma,Cb)}}Object(e.a)(hh,"ResponseHandler",null,[]);var Ai=a(251);class ih{constructor(O){this.DEa=O}tryAuthenticate(O,Ma){this.b$a(ih.wpg,()=>{O()},Ma)}tryAuthorize(O,
Ma){this.b$a(ih.tkg,O,Ma)}getSignInUrl(O,Ma){this.b$a(ih.Dfe,O,Ma)}signOut(O,Ma){this.b$a(ih.Gvg,O,Ma)}b$a(O,Ma,Cb){var lc=new Ai.QueryStringBuilder("AuthenticationProxyHandler.aspx");lc.Oi("responseType",O);Fc.AFrameworkApplication.zXa(lc);lc=String.format("{0}{1}&{2}",this.DEa,lc.toString(),Fc.AFrameworkApplication.gj);const Dc=document.createElement("iframe");Dc.setAttribute("id","privateCatalogIframe");Dc.setAttribute("name","privateCatalogIframe");Dc.setAttribute("style","display: none");R.a.Rk().equals(O,
ih.Dfe)||Dc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");hh.ka(Dc,Ma,Cb);Dc.setAttribute("src",lc);document.body.appendChild(Dc)}}ih.tkg="authcode";ih.wpg="identitytoken";ih.Dfe="signinurl";ih.Gvg="signout";Object(e.a)(ih,"AuthenticationProxy",null,[]);class Vc{}Vc.getUserId="getUserId";Vc.getLastStoreUpdate="laststoreupdate";Vc.getEntitlement="getEntitlements";Vc.getEToken="getEToken";Vc.getManifest="getManifest";Vc.getAppState="getAppState";
Vc.getKilledApps="getRemovedAddins";Vc.getAppDetails="getAppDetails";Vc.removeApps="removeAddin";Vc.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Vc.getPrivateCatalogAddIns="getAddIns";Vc.getPrivateCatalogManifests="getAppManifests";Vc.isStoreDisabled="isStoreDisabled";Object(e.a)(Vc,"S2SWebRequestActions",null,[]);var Fd=a(572);class Lg{getUserId(O,Ma){const Cb=new l.a;Cb.add(new sf.a("corr",O));this.gW(Vc.getUserId,Cb,1,Ma)}getLastStoreUpdate(O,Ma,Cb){const lc=new l.a;lc.add(new sf.a("lc",
O));lc.add(new sf.a("corr",Ma));this.gW(Vc.getLastStoreUpdate,lc,1,Cb)}getEntitlement(O,Ma,Cb,lc){O=new l.a;O.add(new sf.a("av",Ma));O.add(new sf.a("corr",Cb));this.gW(Vc.getEntitlement,O,1,lc)}getEToken(O,Ma,Cb,lc,Dc,dd){const kd=new l.a;kd.add(new sf.a("cmu",O));kd.add(new sf.a("cmf",Ma));kd.add(new sf.a("assetid",Cb));kd.add(new sf.a("expver",lc));kd.add(new sf.a("corr",Dc));this.gW(Vc.getEToken,kd,1,dd)}getManifest(O,Ma,Cb,lc){const Dc=new l.a;Dc.add(new sf.a("cmu",O));Dc.add(new sf.a("assetid",
Ma));Dc.add(new sf.a("corr",Cb));this.gW(Vc.getManifest,Dc,1,lc)}getAppState(O,Ma,Cb){const lc=new l.a;lc.add(new sf.a("ma",O));lc.add(new sf.a("corr",Ma));this.gW(Vc.getAppState,lc,1,Cb)}getKilledApps(O,Ma){const Cb=new l.a;Cb.add(new sf.a("corr",O));this.gW(Vc.getKilledApps,Cb,1,Ma)}getAppDetails(O,Ma,Cb,lc){const Dc=new l.a;Dc.add(new sf.a("cmo",O));Dc.add(new sf.a("corr",Cb));this.sendWithBody(Vc.getAppDetails,Dc,Ma,2,lc,!1)}removeApps(O,Ma,Cb){const lc=new l.a;lc.add(new sf.a("corr",Ma));this.sendWithBody(Vc.removeApps,
lc,O,2,Cb,!1)}getLastPrivateCatalogUpdate(O,Ma,Cb,lc,Dc,dd){const kd=new l.a;kd.add(new sf.a("catalog","privatecatalog"));kd.add(new sf.a("clientCode",O));kd.add(new sf.a("clientVersion",Ma));kd.add(new sf.a("corr",Dc));O=String.format("authorizationCode={0}&refreshToken={1}",Cb?of.a.ef(Cb):"",lc?of.a.ef(lc):"");this.sendWithBody(Vc.getLastPrivateCatalogUpdate,kd,O,2,dd,!0)}getPrivateCatalogAddIns(O,Ma,Cb,lc,Dc,dd){const kd=new l.a;kd.add(new sf.a("catalog","privatecatalog"));kd.add(new sf.a("clientCode",
O));kd.add(new sf.a("clientVersion",Ma));kd.add(new sf.a("corr",Dc));O=String.format("authorizationCode={0}&refreshToken={1}",Cb?of.a.ef(Cb):"",lc?of.a.ef(lc):"");this.sendWithBody(Vc.getPrivateCatalogAddIns,kd,O,2,dd,!0)}getPrivateCatalogManifests(O,Ma,Cb,lc,Dc){const dd=new l.a;dd.add(new sf.a("catalog","privatecatalog"));dd.add(new sf.a("corr",lc));O=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",of.a.ef(O),Ma?of.a.ef(Ma):"",Cb?of.a.ef(Cb):"");this.sendWithBody(Vc.getPrivateCatalogManifests,
dd,O,2,Dc,!0)}isStoreDisabled(O,Ma){const Cb=new l.a;Cb.add(new sf.a("corr",O));this.gW(Vc.isStoreDisabled,Cb,2,Ma)}gW(O,Ma,Cb,lc){this.sendWithBody(O,Ma,null,Cb,lc,!1)}sendWithBody(O,Ma,Cb,lc,Dc,dd){const kd=new Ai.QueryStringBuilder("AddinServiceHandler.ashx");kd.Oi("action",O);kd.Oi("app",Fd.a[Fc.AFrameworkApplication.ta.Pa.xj]);for(let sd of Ma)kd.Oi(sd.key,sd.value);Ma=String.format("{0}{1}&{2}",Fc.AFrameworkApplication.ta.Pa.gV,kd.toString(),Fc.AFrameworkApplication.gj);Fc.AFrameworkApplication.rd.hm(Ma,
lc,Cb,null,!1,2,sd=>{let Gd=null,Vd=null;sd&&sd.data&&(sd.data.responseHeaders["X-BlockedForMinor"]&&"1"===sd.data.responseHeaders["X-BlockedForMinor"].toString()&&(sd.data.httpStatus=451),Gd=sd.data.Td,Vd=sd.data.responseHeaders);Dc(sd.data.httpStatus,Gd,Vd)},sd=>{var Gd=null;let Vd=null;dd&&sd&&sd.data&&sd.data.Td&&(Gd=sd.data.Td,Vd=sd.data.responseHeaders);Dc(sd.data.httpStatus,Gd,Vd);if(Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Gd={message:"AddinServiceHandler request failed"};Gd.code=sd.data.httpStatus;Gd.action=O;if(sd.data.request||sd.data.request.get_headers())Gd["X-UserSessionId"]=sd.data.request.get_headers()["X-UserSessionId"];408===sd.data.httpStatus||503===sd.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Gd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Gd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",sd.data.httpStatus)},null,void 0,void 0,void 0,void 0,
"AddinServiceHandler_"+O,void 0,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(Lg,"S2SWebRequestManager",null,[]);class Bi extends k.a{constructor(O){super();this.xLf=this.ddaFacade=null;this.$=O;O.da.Ga(106,this);this.Fb()}get oe(){return this.ddaFacade||(this.ddaFacade=new Jg.DdaFacade(this.$,this.xLf))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Fc.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Fc.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
y.EwaSettings.ma(404)?wc.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled("mso_officeStore",!0).then(Ma=>{Jg.DdaFacade.k2b=Ma;this.ACe();return null})}):this.ACe()}ACe(){const O=qf.GetServiceTaskFactory.Ta(this.$.da,224,225,this.ib),Ma=Rh.a.asd(63,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.ib,106),Cb=vh(this.la,this.ib);Gf.TaskExtensions.Aa(Gf.TaskExtensions.Xd([O,Ma,Cb],this.$.la),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Hh.a.u2()}`):this.N8h();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.xLf=O.result;this.qb(this.oe);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}N8h(){y.EwaSettings.ma(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Lg);
this.$.me.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Lg,new ih(Fc.AFrameworkApplication.fa.appSettings.WebServiceBase),y.EwaSettings.ma(71),y.EwaSettings.ma(431));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Lg);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Lg)}dispose(){Qh.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(O){new Bi(O)}}Object(e.a)(Bi,"DdaFacadeServiceFactory",
k.a,[]);var Ih=a(453);class Ci{constructor(O,Ma,Cb,lc,Dc,dd){this.$=O;this.agaveCommandManager=dd}Vc(){return!1}Qc(){return!1}Ec(O,Ma,Cb,lc){let Dc=!1;switch(Ma.command){case -684355545:Dc=!0;break;case -741808261:Dc=!!Cb;break;case -859308420:Dc=!!lc&&1===lc.Vy;break;case 418618014:Dc=1===O&&!!lc&&1===lc.Vy;break;case -515602470:Ma=y.EwaSettings.ma(234)&&2===O;Dc=(1===O||Ma)&&!!lc&&1===lc.Vy;break;case 2086613372:Dc=y.EwaSettings.ma(234)&&2===O&&!!lc&&1===lc.Vy;break;case -1336341324:Dc=y.EwaSettings.ma(479)&&
1===O&&!!lc&&1===lc.Vy;break;case 451940422:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===O&&!!lc&&1===lc.Vy;break;case -1444574190:case -336193495:Dc=1===O&&!!lc&&1===lc.Vy;break;case 1296389134:Dc=1===O&&!!lc&&1===lc.Vy;break;case -1473679467:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===O&&!!lc&&1===lc.Vy;break;case 1221897806:Dc=y.EwaSettings.ma(166)&&2===O;break;case 1172793074:case 1930653487:Dc=
y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===O;break;case -1753056834:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Dc=!0;break;case 301511274:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Dc=this.$.isEditMode&&
this.$.ea.rKb}return Dc}executeCommand(O,Ma,Cb){let lc=Gf.TaskExtensions.vk();const Dc=Ma.command;switch(Ma.command){case -1473679467:Ih.a(this.$,488,489,1,dd=>{lc=dd.Pai(Cb.SourceControlId,Ma)});break;case 1296389134:this.agaveCommandManager.RDj(Cb.SourceControlId,Cb.LabelText);break;case -684355545:this.agaveCommandManager.hYc();break;case -741808261:lc=this.agaveCommandManager.insertAgave(Cb,Ma);Ih.a(this.$,488,489,1,dd=>{dd.pzg(Cb)});break;case -1336341324:y.EwaSettings.ma(479)&&(lc=this.agaveCommandManager.pgd(Cb,
O,Ma));break;case 1172793074:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(lc=this.agaveCommandManager.pgd(Cb,O,Ma));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:lc=this.agaveCommandManager.pgd(Cb,O,Ma);break;default:lc=hi.a(Dc)}return lc}}Object(e.a)(Ci,"AgaveCommandHandler",null,
[188]);class Ni{}Object(e.a)(Ni,"Selection",null,[]);var Sh=a(1292),Oi=a(1291),Di=a(1293),wg=a(1382),Ei=a(1294);class Pi{}Object(e.a)(Pi,"SmartLookupApplicationInterface",null,[]);class Qi{}Object(e.a)(Qi,"ApplicationProperties",null,[]);class Jh{}Object(e.a)(Jh,"EnterpriseUserInfo",null,[]);class ii{}Object(e.a)(ii,"FeatureGates",null,[]);class Kh{constructor(O,Ma,Cb=!0){this.VJj=9E5;this.YJj=3E5;this.Dtd=null;this.umf="";this.Atd=0;this.IEe=Date.now;this.gxa=O;this.Q7a=Ma;Cb&&this.fbd()}CWh(){const O=
this.IEe();if(O<this.Atd+this.VJj)return O>this.Atd+this.YJj&&this.fbd(),this.umf;this.fbd();return""}fbd(){this.Dtd=this.Dtd||new Promise(O=>{this.DWh().then(Ma=>{this.umf=Ma;this.Atd=this.IEe();this.Dtd=null;O(Ma)})})}DWh(){return this.Q7a&&this.Q7a.length?new Promise(O=>{this.gxa.uO("SmartLookup",this.Q7a).then(Ma=>{Ma.IsSuccess?Ma.Token||(O(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Ma.ErrorCode+": "+Ma.ErrorMessage),O(""));O(Ma.Token)}).catch(Ma=>{Ma=rd.c(Ma);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ma);O("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)(Kh,"SmartLookupAuthenticationManager",null,[210]);class kg{static zMh(){switch(Object(L.a)(String,Fc.AFrameworkApplication.Rb.AudienceGroup)||""){case "Dogfood":if(Fc.AFrameworkApplication.fa){let O=
Fc.AFrameworkApplication.fa.Va("UserPrincipalName");O=of.a.ll(O);const Ma=Fc.AFrameworkApplication.fa.lo("SmartLookupINTEnabledForSKITeam")?Fc.AFrameworkApplication.fa.lw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ma,O)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static $Vh(){switch(Fc.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Fc.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Fc.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":kg.zMh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(kg,"Utils",null,[]);var Ch=a(551),Th=a(171);class Wg{constructor(O){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.anf=Fc.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.cwi=Fc.AFrameworkApplication.fa.Va("SmartLookupApprovedOriginPattern");this.Q7a=Fc.AFrameworkApplication.fa.Va("SmartLookupShredderServiceEndpoint");this.Iwi=Pg.a.FM(Fc.AFrameworkApplication.fa.Va("AppCatalogUrl")||"");this.P7a=new ii;this.P7a.EnableAllTabV2=!0;this.P7a.EnableIntentService=!0;this.P7a.EnableInDocumentSearch=Fc.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.P7a.EnableLocalSearch=Fc.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.P7a.IntentServiceEndpoint=
kg.$Vh();this.Cwi=new Kh(O,this.Q7a)}get approvedOriginPattern(){return this.cwi}eHh(){return Promise.resolve(this.fHh())}fHh(){const O=new Qi;O.anid="";O.applicationVersion=Fc.AFrameworkApplication.buildVersion;O.appCorrelationId=Th.a.create().toString();O.themePlatform=Wg.fWj;O.lcid=Fc.AFrameworkApplication.lcid;O.launchUtcTime=(new Date).toUTCString();O.featureGates=this.P7a;var Ma=Ch.a.mH(Fc.AFrameworkApplication.lcid);Ma=Ma?Ma.name:null;O.market=this.V9b(Ma);O.uiLanguage=Ma;O.sessionId=Fc.AFrameworkApplication.userSessionId;
O.themeId=0;O.parentalControl=Wg.yVi;const Cb=new Jh;Cb.CountryCode=this.V9b(Ma);Cb.ServiceEndpoint=this.Q7a;Cb.IsGoLocal=!1;Cb.IsEnabled=this.anf;Cb.IsEnterpriseEnabled=this.anf;Cb.TenantRoot=this.Iwi;O.enterpriseUserInfo=Cb;O.accessToken=this.Cwi.CWh();return O}V9b(O){O=O.split("-");return O[O.length-1]}}Wg.fWj="web";Wg.yVi="yes";Object(e.a)(Wg,"SmartLookupManager",null,[181]);class Ah extends Ic.a{constructor(O){super();this.$=O;this.isFirstLaunch=!1}Vc(){return!1}Qc(){return!1}Ec(O,Ma){O=y.EwaSettings.ma(134);
return-983891024===Ma.command&&O}executeCommand(O,Ma){O=Gf.TaskExtensions.vk();-983891024===Ma.command&&this.$pi();return O}$pi(){var O=new Wg(null);const Ma={};var Cb=zg.g(this.$).Xb(null).originalText;Cb=Object(Sa.a)(new Ni,{neighborhood:Cb,mentionStart:0,mentionLength:Cb?Cb.length:0});const lc=Object(Sa.a)(new Pi,{selection:Cb,entryPoint:0});O.eHh().then(dd=>{dd.applicationName=Ah.appName;dd.isFirstLaunch=this.isFirstLaunch;dd.themeId=5;Ma[Ah.smartLookupApplicationInterface]=JSON.stringify(lc);
Ma[Ah.cJg]=JSON.stringify(dd);this.isFirstLaunch=!1});O=new Sh.a("ExcelOnline","Web","en-Us");Cb=new Oi.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Dc=new Di.a;Dc.optionalProperties[wg.a.Zk]=nd.a.instance.ga(1802);Dc.optionalProperties[wg.a.taskPaneWidth]=350;Dc.optionalProperties[wg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Dc.Ip=Ma;Ei.a.instance.zMa(Cb,"Taskpane","SmartLookupSDXTaskpane",O,Dc)}}Ah.cJg="AppProperties";Ah.appName="Excel";Ah.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(e.a)(Ah,"SmartLookupCommandHandler",Ic.a,[188]);class Uh extends Bd.a{constructor(O){super(O)}Dd(){Ih.a(this.$,374,375,this.ib,O=>{this.ld([new Ci(this.$,null,null,null,null,O),new Ah(this.$)])})}static ka(O){Bd.a.Rd(76,new Uh(O))}}Object(e.a)(Uh,"AgaveCommandHandlerFactory",Bd.a,[]);var wh=a(1307),th=a(106);class $e{constructor(){this.oe=null;this.H$a=(O,Ma,Cb,lc,Dc)=>{if(2===Cb){O=Dc?Dc:{};Ma=O.callback;Cb=O.refresh?O.refresh:!1;if(!Ma)return 16;Fc.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=O.storeType?this.oe.WIf(Ma,Cb,O.storeType):this.oe.pca(Ma,Cb)}return 32};this.T7i=(O,Ma,Cb,lc,Dc)=>{2===Cb&&(O=Dc?Dc.callback:null)&&this.oe.KDg(O);return 32};this.Oai=(O,Ma,Cb,lc,Dc)=>{2===Cb&&this.oe.Fzd(null,OSF.AgaveHostAction.InsertAgave,Dc);return 32}}initialize(O){$e.initialized||(this.oe=O,this.Fg(),$e.initialized=!0)}Fg(){Fc.AFrameworkApplication.wb.Je(Ld.a.H$a,th.a.frame,this.H$a,96);Fc.AFrameworkApplication.wb.Ob(Ld.a.I6i,th.a.frame,this.T7i);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&Fc.AFrameworkApplication.wb.Je(Ld.a.T9e,th.a.frame,this.Oai,96)}static get instance(){$e.Ma||($e.Ma=new $e);return $e.Ma}}$e.Ma=null;$e.initialized=!1;Object(e.a)($e,"AgaveCommandActor",null,[]);var Mg=a(1349),bh=a(1296),Cg=a(112),Tg=a(350),Fi=a(346),ji=a(1229),Dg=a(19),Gi=a(341);class Vh{constructor(){this.TTd=this.cyc=null;this.vu=0;this.ayc=null}}Object(e.a)(Vh,"FirstPartyAddinTaskpaneOverrides",null,[]);class Dh{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(Dh,"IdeasSelectionContext",null,[]);class ki extends Dh{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(e.a)(ki,"IdeasTableSelectionContext",Dh,[]);class li{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(li,"AutoFilterRange",
null,[]);class Hi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Hi,"IdeasAutoFilterSource",null,[]);class Ii{constructor(O,Ma){this.selection=O;this.tables=Ma}}Object(e.a)(Ii,"IdeasXLIMTableBoundaries",null,[]);var Eg=a(62);const Ji=(O,Ma,Cb,lc,Dc,dd,kd=null)=>{kd=O.Na(9,kd);kd.sharedInfo=Ma;return Eg.g(O,"ShowAgaveTaskpane",kd,Cb,lc,Dc,dd,0)};var Xg=a(955),Eh=a(64),$i=a(131),Ug=a(42),Wh=a(510),mi=a(368),Lh=a(170),Xh=a(162),Ti=a(561),Pf=a(280),ni=
a(104),aj=a(132),pg=a(51),Yh=a(144),jh=a(178);class Ui extends Yh.a{constructor(){super();this.qea="calc(100% - 46px)";this.fCa="15px";this.rea="0";this.TFc="WACDialogPanel";this.YW=695;this.UFc=462;this.Yoa="80%";this.IDc=350;this.Hfb="100%";this.Sb=5;this.Ae="AppsForOfficeInsertionDialog";this.fGc=!!Fc.AFrameworkApplication.fa&&Fc.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Lz(){super.Lz();this.Jk.style.width=this.Hfb;this.Jk.style.height=this.qea;this.Jk.style.marginTop=
this.fCa;this.Jk.style.padding=this.rea}Nya(){this.Jk.style.width=this.Hfb;this.Jk.style.height=this.qea;this.Jk.style.marginTop=this.fCa;this.Jk.style.padding=this.rea;this.YW>jh.a.Cla?(this.vb.style.width=String.format("{0}px",jh.a.Cla),this.vb.style.overflowX="scroll",Fc.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0"):(this.vb.style.width=String.format("{0}px",this.YW),this.vb.style.overflowX="hidden");this.vb.offsetHeight>jh.a.Ala||this.UFc+50>jh.a.Ala?(this.vb.style.height=
String.format("{0}px",jh.a.Ala),this.vb.style.overflowY="scroll",this.vb.style.top="0",Fc.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0",this.fGc||(this.vb.style.marginTop="-48px"),this.Jk.style.minHeight=String.format("{0}px",this.IDc)):(this.vb.style.overflowY="hidden",this.vb.style.top="10%",this.vb.style.height=this.Yoa);this.Sra()}Sra(){if(this.vb){var O=this.vb.style.zIndex;this.vb.style.zIndex="-9999";if(this.YW>jh.a.Cla)Fc.AFrameworkApplication.isRtl?this.vb.style.marginRight=
"0":this.vb.style.marginLeft="0";else{const Ma=String.format("{0}px",Math.floor(-this.vb.offsetWidth/2));Fc.AFrameworkApplication.isRtl?this.vb.style.marginRight=Ma:this.vb.style.marginLeft=Ma;Fc.AFrameworkApplication.isRtl?this.vb.style.right="50%":this.vb.style.left="50%"}this.vb.style.zIndex=String(O)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}tI(){super.tI();const O=document.getElementById(this.ei(this.TFc));O.style.width=String.format("{0}px",this.YW);
O.style.height=this.Yoa}get ata(){return this.Jk}}Object(e.a)(Ui,"AppsForOfficeInsertionDialog",Yh.a,[773]);class oi extends Yh.a{constructor(){super();this.qea="calc(100% - 46px)";this.fCa="15px";this.rea="0";this.TFc="WACDialogPanel";this.YW=695;this.UFc=462;this.Yoa="80%";this.IDc=350;this.Hfb="100%";this.Sb=5;this.Ae="SDXDialog"}Lz(){super.Lz();this.Jk.style.width=this.Hfb;this.Jk.style.height=this.qea;this.Jk.style.marginTop=this.fCa;this.Jk.style.padding=this.rea}Nya(){this.Jk.style.width=this.Hfb;
this.Jk.style.height=this.qea;this.Jk.style.marginTop=this.fCa;this.Jk.style.padding=this.rea;this.YW>jh.a.Cla?(this.vb.style.width=String.format("{0}px",jh.a.Cla),this.vb.style.overflowX="scroll",Fc.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0"):(this.vb.style.width=String.format("{0}px",this.YW),this.vb.style.overflowX="hidden");this.vb.offsetHeight>jh.a.Ala||this.UFc+50>jh.a.Ala?(this.vb.style.height=String.format("{0}px",jh.a.Ala),this.vb.style.overflowY="scroll",
this.vb.style.top="0",Fc.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0",this.Jk.style.minHeight=String.format("{0}px",this.IDc)):(this.vb.style.overflowY="hidden",this.vb.style.top="10%",this.vb.style.height=this.Yoa);this.Sra()}Sra(){if(this.vb){var O=this.vb.style.zIndex;this.vb.style.zIndex="-9999";if(this.YW>jh.a.Cla)Fc.AFrameworkApplication.isRtl?this.vb.style.marginRight="0":this.vb.style.marginLeft="0";else{const Ma=String.format("{0}px",Math.floor(-this.vb.offsetWidth/
2));Fc.AFrameworkApplication.isRtl?this.vb.style.marginRight=Ma:this.vb.style.marginLeft=Ma;Fc.AFrameworkApplication.isRtl?this.vb.style.right="50%":this.vb.style.left="50%"}this.vb.style.zIndex=String(O)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}tI(){super.tI();const O=document.getElementById(this.ei(this.TFc));O.style.width=String.format("{0}px",this.YW);O.style.height=this.Yoa}get ata(){return this.Jk}}Object(e.a)(oi,"SDXDialog",Yh.a,[]);var Fg=a(956),
bj=a(182),Zh=a(570),ph;(function(O){O[O.Valid=2]="Valid";O[O.Invalid=4]="Invalid";O[O.All=6]="All"})(ph||(ph={}));Object(e.b)("MetadataState",ph);var pi=a(338);class yf extends Ic.a{constructor(O,Ma,Cb,lc,Dc){super();this.Pza={};this.h$c={};this.zya=this.sdxDialog=this.Dva=null;this.kab=!1;this.V1h=(dd,kd,sd,Gd,Vd)=>{if(2!==sd)return 32;dd=Vd[Fg.a.Fsb];kd=Vd[Fg.a.dha];sd=Vd[Fg.a.zla];Vd=new Mg.a;Vd.ndc=sd.optionalProperties.InstanceToken;Vd.sourceLocationOverrideResourceId=sd.optionalProperties[wg.a.sourceLocationOverrideResourceId];
Vd.sB=sd.Ip;Vd.dha=kd;kd=null!=Vd.ndc?Vd.ndc:(new ze.a(Th.a.create(),1)).toString();sd=null!=Vd.sB?Vd.sB:{};Gd={};Gd.id=kd;Gd.solutionId=dd.getId();Gd.version=dd.IBa;Gd.storeType=dd.getStoreType();Gd.storeId=dd.getStoreId();Gd.assetId=null;Gd.assetStoreId=null;Gd.settings=sd;Gd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Gd.osfControlType=OSF.OsfControlType.ContainerLevel;Gd.sourceLocationOverrideResourceId=Vd.sourceLocationOverrideResourceId;Gd.featureGates=Fc.AFrameworkApplication.fa.IXe(dd.getId());
this.Rhc(Vd,Gd);return 32};this.Rhc=(dd,kd)=>{this.sdxDialog=new oi;this.sdxDialog.initializeAndShow("",null,null);kd.div=this.sdxDialog.ata;dd={};dd.InstanceId=kd.id;dd.WebExtensionType=2;dd.PrimaryMarketplace={};dd.PrimaryMarketplace.SolutionId=kd.solutionId;dd.PrimaryMarketplace.MarketplaceType=kd.storeType;dd.PrimaryMarketplace.MarketplaceRef=kd.storeId;dd.PrimaryMarketplace.SolutionVersion=kd.version;dd.SrcLocationOverrideResourceId=kd.sourceLocationOverrideResourceId;dd.WebExtensionOsfControlType=
6;this.Pza[kd.solutionId]=kd.settings;dd.OsfPropertyBag=this.wjc([],kd.solutionId);this.oe.ZGa(dd);this.oe.Qh.insertOsfControl(kd)};this.h3h=(dd,kd,sd,Gd,Vd)=>{if(2!==sd)return 32;dd=Vd[Fg.a.Fsb];sd=Vd[Fg.a.dha];Vd=Vd[Fg.a.zla];kd=new Mg.a;kd.ndc=Vd.optionalProperties.InstanceToken;kd.Zk=Vd.optionalProperties[wg.a.Zk];kd.QR=Vd.optionalProperties[wg.a.QR];wg.a.taskPaneWidth in Vd.optionalProperties&&(kd.taskPaneWidth=Vd.optionalProperties[wg.a.taskPaneWidth]);kd.sourceLocationOverrideResourceId=Vd.optionalProperties[wg.a.sourceLocationOverrideResourceId];
kd.sB=Vd.Ip;kd.onTaskPaneClose=Vd.optionalProperties[wg.a.onTaskPaneClose];kd.dha=sd;sd=new ug.a(-859308420,0,2,0,"");Gd=dd.getStoreType()===OSF.StoreType.Sdx;const Pe=new Xg.a;Pe.I3=Vd.optionalProperties.HeaderCssClass||Dg.a.D1a;Pe.Hdb=Vd.optionalProperties.TitleCssClass;this.J6(sd,dd.getId(),kd,Gd,Pe);return 32};this.S2h=(dd,kd,sd,Gd,Vd)=>{if(2!==sd)return 32;dd=Vd[Fg.a.Fsb].getId();Vd=Vd[Fg.a.zla].optionalProperties[wg.a.sourceLocationOverrideResourceId];return dd?(this.oe.Qh.refreshOsfControl(dd,
Vd),32):8};this.VYi=dd=>{dd=dd.Result;if(dd=null===dd?null:dd.SolutionId)this.oe.Rje(dd),ni.a(this.$).zma(3,dd)};this.zGf=(dd,kd)=>{var sd;const Gd=(dd=dd.Result)?dd.AgaveData:null;if(Gd){var Vd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd.PrimaryMarketplace.SolutionId,Gd.PrimaryMarketplace.MarketplaceType,null===(sd=null===Gd||void 0===Gd?void 0:Gd.AssetMarketplace)||void 0===sd?void 0:sd.SolutionId,null,null,Gd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Gd.TaskpaneWidth===
yf.Xbh,`Taskpane width is ${Gd.TaskpaneWidth}, assetId is ${Vd}.`);if(sd=this.h$c[Gd.PrimaryMarketplace.SolutionId])sd.cyc&&(Gd.TaskpaneTitle=sd.cyc),sd.ayc&&(Gd.TaskpaneIconId=sd.ayc),sd.TTd&&(Gd.TaskpaneButtonTooltip=sd.TTd),0<sd.vu&&(Gd.TaskpaneWidth=sd.vu);kd&&(Gd.FocusOnIframeWhenLoaded=kd.focusOnIframeWhenLoaded,kd.width&&(Gd.TaskpaneWidth=kd.width),Gd.TaskpaneIconCssClass=kd.Sk,Gd.TaskpaneHeaderCssClass=kd.I3,Gd.TaskpaneTitleCssClass=kd.Hdb,Gd.IsFirstPartyOptOutAppContextOptmization=kd.isFirstPartyOptOutAppContextOptmization);
this.Pza[Gd.PrimaryMarketplace.SolutionId]&&(Gd.OsfPropertyBag=this.wjc(Gd.OsfPropertyBag,Gd.PrimaryMarketplace.SolutionId));Ti.a(Gd)||(Gd.WebExtensionOsfControlType=1);Gd&&(this.oe.Rje(dd.SolutionId),this.oe.ZGa(Gd))}else n.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.zxh=dd=>{dd&&(this.o9c.Hhf(dd),this.Fve())};this.DGf=dd=>{dd=dd.toDataURL("image/jpeg");const kd=this.oe.L$(yf.w6e+"."+yf.Xac),sd={};sd.screenshot=dd;
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(kd,"onScreenshot",sd,()=>{})};this.q1h=(dd,kd,sd,Gd,Vd)=>{if(2!==sd)return 32;if(Cg.a.kh(Vd)||Vd[Fg.a.Jze]!==bh.a.action)return 8;kd=Vd[Fg.a.zla];return kd?(dd=(dd=this.qSh(Vd))?this.oe.L$(dd):null)?(Vd=this.oe.j3g(Vd[Fg.a.dha],kd.optionalProperties[wg.a.GRc]),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(sd=this.oe.AY(dd),sd.TaskpaneTitle!==kd.optionalProperties[wg.a.Zk]&&(sd.TaskpaneTitle=kd.optionalProperties[wg.a.Zk],
sd.TaskpaneIconCssClass=kd.optionalProperties.IconCssClass,sd.TaskpaneIconUrl=kd.optionalProperties.TaskPaneIconUrl,sd.TaskpaneIconId=kd.optionalProperties.TaskPaneIconId,y.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(kd=this.oe.Qh,kd.changeIframeTitle(dd,sd.TaskpaneTitle),sd=kd.getOsfControl(dd),kd.raiseOsfControlStatusChange(sd)):(kd=this.oe.Qh.getOsfControl(dd),this.oe.Qh.raiseOsfControlStatusChange(kd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(dd,
Vd,this.jJb),32):8:8};this.jJb=(dd,kd)=>{this.oe.dAh(dd,kd)};this.HGd=()=>{Gf.TaskExtensions.Y9(qf.GetServiceTaskFactory.Ta(this.$.da,20,404,1),dd=>{dd.result.J3a()},this.$.la)};this.$=O;this.viewBlockContainerHelpers=Cb;this.oe=Ma;this.o9c=lc;this.$h=Dc;this.$h.Ob(Ld.a.h2f,th.a.frame,this.h3h);this.$h.Ob(Ld.a.BSf,th.a.frame,this.S2h);this.$h.Ob(Ld.a.FPe,th.a.frame,this.q1h);this.$h.Ob(Ld.a.Rhc,th.a.frame,this.V1h)}CEg(O){this.addHandler(yf.MAd,O)}Jaj(O){this.removeHandler(yf.MAd,O)}dispose(){Qh.a.Ia(this.Dva);
this.Dva=null;this.kab&&(this.$.ea.xn(this.HGd),this.kab=!1);super.dispose()}hYc(){this.Dva.hide()}RDj(O,Ma){if(O){this.raiseEvent(yf.MAd);const Cb=O.split("|");this.kui(O,Ma,Cb);this.Dva=new Ui;this.Dva.initializeAndShow("",null,null);this.oe.sqi(this.Dva.ata,Cb)}}pgd(O,Ma,Cb){var lc=Gf.TaskExtensions.vk();if(-515602470===Cb.command||-336193495===Cb.command||2086613372===Cb.command||-1444574190===Cb.command||-1336341324===Cb.command||451940422===Cb.command)lc=this.K1h(O,Ma,Cb);418618014===Cb.command&&
(Ma=new Mg.a,Ma.Zk=nd.a.instance.ga(1815),lc=this.J6(Cb,yf.Y4h,Ma,!0));if((Cb.tabName===this.$.Bb+Cd.a.ZSf||Cb.tabName===Cd.a.IV)&&2===Cb.Re||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),O[Hg.a.Oc])||O[Hg.a.Oc]===Cd.a.pQ)return this.m4e(O,Cb);if(7===Cb.Re&&O.SourceControlId===this.$.Bb+Cd.a.Vac)return O.MenuItemId=Cd.a.BFd,this.m4e(O,Cb);1221897806===Cb.command&&(lc=this.T1f(Cb,"Format"));if(1930653487===Cb.command||1172793074===Cb.command)lc=this.T1f(Cb,"Data");
-1753056834===Cb.command&&(lc=this.Izj(Cb));932597253===Cb.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),bj.c(932597253,!0),Ma=new Mg.a,Ma.Zk=nd.a.instance.ga(2157),Ma.sourceLocationOverrideResourceId=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?yf.dZi:yf.fZi,Ma.focusOnIframeWhenLoaded=!0,Ma.taskPaneWidth=yf.b8e,lc={},lc.LaunchSource=Object(L.a)(String,O.SourceControlId),lc.LaunchMode="Default",Ma.sB=lc,lc=this.J6(Cb,
yf.eZi,Ma,!0));301511274===Cb.command&&(lc=this.Rzj(Cb));515196233===Cb.command&&((Ma=this.$.da.za(465))&&Ma.C6e(),Ma=new Mg.a,Ma.Zk=nd.a.instance.ga(2229),lc={},lc.SourceUILocation=Tg.a[Cb.Re],Ma.sB=lc,lc=new Xg.a,lc.I3=Dg.a.D1a,lc=this.J6(Cb,yf.qUi,Ma,!0,lc,void 0,Ma.Zk));1723441034===Cb.command&&(Ma=new Mg.a,Ma.Zk=nd.a.instance.ga(2241),Ma.focusOnIframeWhenLoaded=!0,Ma.taskPaneWidth=yf.W0i,lc=new Xg.a,lc.I3=Dg.a.noh,lc=this.J6(Cb,Zh.a,Ma,!0,lc));y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&O.LoadDataFromPictureTaskpane&&(Ma={},lc=new Mg.a,lc.Zk=nd.a.instance.ga(2268),Ma.SessionID=O.SessionID,lc.sB=Ma,lc.focusOnIframeWhenLoaded=!0,lc=this.J6(Cb,O.DataFromPictureAssetId,lc,!0));return lc}insertAgave(O,Ma){var Cb=Gf.TaskExtensions.vk();const lc=this.$;let Dc;var dd=O[Nd.a.gra];Dc=O[Hg.a.Zf];let kd=null;Xg.a.key in O&&(kd=O[Xg.a.key]);this.Dva&&this.Dva.hide();if(!Dc||!dd)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Cb;this.$.r4&&Cd.a.yda in
O&&(Dc.EnabledInViewMode=O[Cd.a.yda]);O=this.PJh(Ma.command);if(!Dc.EnabledInViewMode&&!lc.oq(null,!1,O))return Cb;let sd=void 0===Dc.IsToBePersisted||null===Dc.IsToBePersisted||Dc.IsToBePersisted?0:16;if(1===Dc.TargetType)Cb=this.ibi(Dc,dd,Ma,kd,sd);else{dd=zg.g(lc);Cb=this.viewBlockContainerHelpers.Web(dd);const Gd=lc.ea.isNamedObjectViewMode?lc.oa.sheetName:lc.oa.name;let Vd,Pe,Se,ef;Cb?(dd=Cb.Me,Vd=dd.qf.top,Pe=dd.qf.left,Se=Cb.EI.x,ef=Cb.EI.y):(Vd=Pe=1,Cb=this.viewBlockContainerHelpers.SJa(dd),
Se=Cb.x,ef=Cb.y);const lg=this.$.pa.va.Qb();Cb=(bg,cg,Of)=>{var mg=lc.pa.va,Ng=Vd,Kg=Pe,Og=Se,Gh=ef;bg=Pf.b(bg,this.VYi);const gi=mg.Na(9,lg);gi.sharedInfo=Dc;gi.sheetName=Gd;gi.positionRow=Ng;gi.positionCol=Kg;gi.positionOffsetX=Og;gi.positionOffsetY=Gh;return Eg.g(mg,"InsertWebExtension",gi,bg,cg,Of,null,0)};y.EwaSettings.fc()?(sd|=64,Cb=mi.a(this.$.userOperationManager,Cb,bg=>new Lh.a(534,0,bg,sd),Ma)):Cb=mi.a(this.$.userOperationManager,Cb,bg=>new Wh.a(534,0,bg,sd),Ma)}return Cb}G0g(){var O=wc.a.instance.Vb("Common.App.ICustomerFeedbackUiWrapper");
if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Ma=wc.a.instance.Vb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.o9c?this.o9c.qib?this.Fve():Ma.instance.v5c(this.zxh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ma={};Fc.AFrameworkApplication.fa.kke(Ma);O=O.instance.getContext(Ma);Ma={};"telemetryGroup"in O&&(Ma=O.telemetryGroup);Ma.processSessionId=O.sessionId;Ma.officeBuild=O.build;O.telemetryGroup=
Ma;O.feedbackType=-1;O.userVoiceEnabled=!1;"disableIncludeScreenshot"in O||(O.disableIncludeScreenshot=!1);"screenshot"in O||(O.screenshot=!1);O.disableScreenshotPreview=!1;O.includeScreenshotSelectedDefault=!0;return O}sZi(O){if(!this.zya&&y.EwaSettings.getBooleanFeatureGate(yf.Q6h,!1)){var Ma=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ma=this.jte(Ma);const Cb=new Xg.a;Cb.Sk=Dg.a.Y6b;Cb.I3=Dg.a.sMe;Cb.Hdb=Dg.a.J7c;
this.zya=this.nLd(Ma,null,!1,null,Cb);aj.b(this.$).Cd($i.a.tZi,{["Location"]:Tg.a[O.Re],["InputMethod"]:Fi.a[O.method]},void 0,!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.MVd()}}kYf(O){const Ma=this.$.ea.Sg.get(17);wc.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Cb=>{Cb.isFeatureEnabled("mso_sendASmile",Ma).then(lc=>{O.FeedbackEnabled=Ma&&lc;return null})})}T1f(O,Ma){const Cb=zg.g(this.$),lc=new Mg.a;
var Dc={};Dc.ActiveTab=Ma;Dc.DatapaneFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Dc.RangePickerFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);Dc.AceFlighting=!0;Dc.ChartNewSDXRecording=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Dc.ThemeColorsFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");
Dc.UOMirror=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Dc.FormatTaskPaneAceButtonDark=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Dc.FormatTaskPaneBetterFeedbackButton=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Dc.FormatTaskPaneBetterScrollbar=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.kYf(Dc);Dc.startTimeMs=
Date.now();Dc.UserSessionId=this.$.ya.UserSessionId;(Ma=Cb.ha.Oa.Yn)&&(Dc.SubSelection=Ma);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Dc.UserSessionId}, UILocation: ${void 0===O.Re||null===O.Re?"Null":Tg.a[O.Re]}, SubSelection: ${Ma||"ChartRoot"}`);lc.sB=Dc;lc.Zk=nd.a.instance.ga(979);Dc=new Xg.a;Dc.I3=Dg.a.D1a;return this.J6(O,yf.DVg,lc,!0,Dc)}Izj(O){const Ma=new Mg.a;Ma.sB={};Ma.Zk=nd.a.instance.ga(1801);Ma.QR=yf.Bjf;const Cb=new Xg.a;Cb.I3=Dg.a.D1a;return this.J6(O,
yf.Bjf,Ma,!0,Cb,void 0,Ma.Zk)}Rzj(O){const Ma=new Mg.a;Ma.sB={};Ma.Zk=nd.a.instance.ga(2181);const Cb=new Xg.a;Cb.I3=Dg.a.Yph;Cb.Hdb=Dg.a.xMe;return this.J6(O,yf.KBi,Ma,!0,Cb)}m4e(O,Ma){const Cb=yf.w6e;var lc=O[Hg.a.Oc].toString();const Dc={},dd=new Mg.a;dd.Zk=nd.a.instance.ga(9);switch(lc){case "A0":Dc.query=(O[Hg.a.Zf]||"").split("|").slice(2,Gi.a.cS).join("|");break;case "A1":Dc.query=O.CommandValueId;break;case "Help":Dc.gwdropdownflightinfo=y.EwaSettings.ma(239);Dc.query="";break;case Cd.a.BFd:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(dd.Zk=nd.a.instance.ga(1767),dd.sourceLocationOverrideResourceId=yf.Xac,Dc.feedback=this.G0g()):Dc.query=lc;break;case "HelpArticle":Dc.query=O[Hg.a.Zf];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Dc.query=lc;break;default:return sh.Task.Ua(!0)}dd.sB=Dc;lc=new Xg.a;lc.I3=Dg.a.D1a;return this.J6(Ma,Cb,dd,!1,lc,O[Cd.a.yda]||!1)}jte(O){const Ma={Version:"0.0.0.0"};Ma.AssetId=yf.GKa;Ma.SolutionId=yf.GKa;Ma.AssetStoreId="";Ma.StoreType=OSF.StoreType.Sdx;Ma.Height=0;Ma.Width=0;
Ma.StoreId=OSF.StoreType.Sdx;Ma.TargetType=OSF.OsfControlTarget.TaskPane;Ma.IsToBePersisted=!1;Ma.SourceLocationOverrideResourceId=O;Ma.SharedRuntimeId=O;return Ma}K1h(O,Ma,Cb){function lc(){kd.LaunchMode="Default";y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Dc.Zk=nd.a.instance.ga(1814);Dc.QR=yf.BUc;Dc.Sk=Dg.a.Y6b;dd.Sk=Dg.a.Y6b}const Dc=new Mg.a,
dd=new Xg.a,kd={};this.zya&&this.kYf(kd);kd.LaunchSource="";kd.StartTimeMs=Date.now();kd.CorrelationId=Th.a.create().toString();Dc.sB=kd;Dc.focusOnIframeWhenLoaded=!0;Dc.taskPaneWidth=yf.b8e;dd.I3=Dg.a.sMe;dd.Hdb=Dg.a.J7c;switch(Cb.command){case -1444574190:let Vd;kd.LaunchMode="RecommendedPivotTables";kd.SelectionContext="";kd.LaunchSource="PivotTableHandRaise"===Object(L.a)(String,O.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
O.SourceSelection){var sd=O.SourceSelection.split(",")[0];Ma=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:sd,sKf:Vd,range:Gd}=Ug.Z(sd,this.$.xa)).returnValue&&!zg.g(this.$).Db.o4(Gd))O=this.$.xa.getItemByName(sd),kd.SelectionContext=JSON.stringify(Object(Sa.a)(new Dh,{address:Vd,addressWithSheet:sd+"!"+Gd.jz(!1),sheetId:Eh.d(O),sheetName:sd,isSheetEmpty:!1,columnCount:Gd.width,rowCount:Gd.height,columnIndex:Gd.left+Ma,rowIndex:Gd.top+Ma,selectionType:"Continuous"}));
else if((O=this.$.yb.getItemByName(Object(L.a)(String,O.SourceSelection)))&&Eh.n(O)){var Gd=Xh.a(O,!0);sd=this.$.xa.getItemByName(O.sheetName);kd.SelectionContext=JSON.stringify(Object(Sa.a)(new ki,{tableName:O.name,hasTableHeaders:Xh.d(O),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Gd.jz(!1),addressWithSheet:sd.name+"!"+Gd.jz(!1),sheetId:Eh.d(sd),sheetName:sd.name,isSheetEmpty:!1,columnCount:Gd.width,rowCount:Gd.height,columnIndex:Gd.left+Ma,rowIndex:Gd.top+Ma,selectionType:"Continuous"}))}}y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Dc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Dc.Zk=nd.a.instance.ga(1813);Dc.QR=yf.rXi;Dc.Sk=Dg.a.MOe;dd.Sk=Dg.a.MOe;break;case -336193495:kd.LaunchMode="RecommendedCharts";y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Dc.Zk=nd.a.instance.ga(1812);
Dc.QR=yf.l5i;Dc.Sk=Dg.a.NOe;dd.Sk=Dg.a.NOe;break;case -1336341324:if(!y.EwaSettings.ma(479))return sh.Task.Ua(!1);kd.LaunchMode="NL";Dc.QR=yf.BUc;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Dc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(y.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Dc.Zk=nd.a.instance.ga(1817);kd.NLLaunchModeBrandingCandidatesIndex=
1;break;case 2:Dc.Zk=nd.a.instance.ga(1818);kd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Dc.Zk=nd.a.instance.ga(1816),kd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!y.EwaSettings.ma(234))return sh.Task.Ua(!1);kd.LaunchMode="ChartDesigner";kd.LaunchSelectionMode=Ma.toString();y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
Dc.Zk=nd.a.instance.ga(1819);Dc.QR=yf.BUc;break;case 451940422:kd.LaunchSource="AutoFilter";Gd=JSON.parse(O.CommandValueId);kd.AutoFilterSource=JSON.stringify(Object.assign(new Hi,{autoFilterRange:{sheetName:Gd.AutoFilterRange.SheetName,firstColumn:Gd.AutoFilterRange.FirstColumn,lastColumn:Gd.AutoFilterRange.LastColumn,firstRow:Gd.AutoFilterRange.FirstRow,lastRow:Gd.AutoFilterRange.LastRow},autoFilterType:Gd.AutoFilterType,itemIndex:Gd.ItemIndex,id:Gd.Id}));lc();break;default:y.EwaSettings.ma(234)&&
(kd.LaunchSelectionMode=Ma.toString()),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(kd.XlimTableBoundaries=this.GXh()),lc()}y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.zya?this.zya.So(()=>this.hWf(kd,Dc)):this.n$h(Cb,Dc,dd,kd)}n$h(O,Ma,Cb,lc){this.zya=this.nLd(this.jte(Ma.sourceLocationOverrideResourceId),
Ma,!1,O,Cb,!1);return y.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(lc.NoActionMsgOnFirstInstance=!0,this.Pza[yf.GKa]=lc,this.zya):this.zya.So(()=>this.hWf(lc,Ma))}hWf(O,Ma){const Cb=this.oe.L$(this.oe.B2a(yf.GKa,Ma.sourceLocationOverrideResourceId));if(Cb){this.Pza[yf.GKa]=O;const lc=this.wjc(this.oe.AY(Cb).OsfPropertyBag,yf.GKa);this.oe.AY(Cb).OsfPropertyBag=lc}this.zMa(yf.GKa,"LaunchIdeasAction",O,Ma);return sh.Task.Ua(!0)}J6(O,Ma,Cb=null,lc=!1,Dc=null,dd=!1,
kd=null){Gf.TaskExtensions.vk();Cb||(Cb=new Mg.a);const sd={Version:"0.0.0.0"};sd.AssetId=Ma;sd.SolutionId=Ma;sd.AssetStoreId="";sd.StoreType=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;sd.Height=0;sd.Width=0;sd.StoreId=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;sd.TargetType=OSF.OsfControlTarget.TaskPane;sd.IsToBePersisted=!1;sd.SourceLocationOverrideResourceId=Cb.sourceLocationOverrideResourceId;if(Cb.Zk||kd)this.h$c[Ma]=Object(Sa.a)(new Vh,{cyc:Cb.Zk,TTd:kd,ayc:Cb.QR});y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)?(Cb.sB||(Cb.sB={}),Cb.sB.ShowFeedback=this.$.isFeedbackEnabled,this.Pza[Ma]=Cb.sB):Cb.sB&&(this.Pza[Ma]=Cb.sB);Ma={};Ma[Hg.a.Zf]=sd;kd={};kd.solutionId=sd.SolutionId;kd.version=sd.Version;kd.storeType=sd.StoreType;kd.storeId=sd.StoreId;kd.assetId=sd.AssetId;kd.assetStoreId=sd.AssetStoreId;kd.height=sd.Height;kd.targetType=sd.TargetType;kd.width=sd.Width;kd.isAddinCommands=!lc;Ma[Nd.a.gra]=kd;Dc||(Dc=new Xg.a);Dc.focusOnIframeWhenLoaded=Cb.focusOnIframeWhenLoaded;Dc.width=Cb.taskPaneWidth;Ma[Xg.a.key]=
Dc;Ma[Cd.a.yda]=dd;return this.insertAgave(Ma,O)}ibi(O,Ma,Cb,lc,Dc){const dd=(Vd,Pe)=>{var Se=Vd.SolutionId;var ef=OSF.OsfControl.isFirstPartyStoreString(Vd.StoreType);ef&&Vd.SourceLocationOverrideResourceId&&(Se=this.oe.B2a(Se,Vd.SourceLocationOverrideResourceId));var lg=this.oe.Awe(Se,null,Vd.SharedRuntimeId);ef&&(y.EwaSettings.ma(295)&&lg&&(ef=this.oe.L$(Se))&&(Se=null,Se=this.wjc(this.oe.AY(ef).OsfPropertyBag,Vd.SolutionId),(ef=this.oe.Qh.getOsfControl(ef))&&ef.setSettings(Se)),Vd.SharedRuntimeId&&
lg||this.oe.Qh.refreshOsfControl(Vd.SolutionId,Vd.SourceLocationOverrideResourceId));if(!lg){const bg=this.$.pa.va.Qb();let cg=519;lg=(Of,mg,Ng)=>{var Kg=this.$.pa.va;Of=Pf.b(Of,this.zGf);const Og=Kg.Na(9,bg);Og.sharedInfo=Vd;return Eg.g(Kg,"InsertAgaveTaskpane",Og,Of,mg,Ng,lc,0)};void 0===Vd.IsToBePersisted||null===Vd.IsToBePersisted||Vd.IsToBePersisted||(cg=538,lg=(Of,mg,Ng)=>{const Kg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.SolutionId,Vd.StoreType,Vd.AssetId,null,null,Vd.StoreId);n.ULS.sendTraceTag(537170442,
220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Vd.StoreType}, StoreId ${Vd.StoreId}, SolutionId ${Kg}.`);return Ji(this.$.pa.va,Vd,Pf.b(Of,this.zGf),mg,Ng,lc,bg)});return y.EwaSettings.fc()?(Dc|=64,mi.a(this.$.userOperationManager,lg,Of=>new Lh.a(cg,0,Of,Dc),Pe)):mi.a(this.$.userOperationManager,lg,Of=>new Wh.a(cg,0,Of,Dc),Pe)}return Gf.TaskExtensions.kaa()},kd=Vd=>{var Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.solutionId,Vd.storeType,Vd.assetId,null,null,Vd.storeId);n.ULS.sendTraceTag(537170440,
220,50,`Insert addincommands for ${Pe} from ${Vd.storeType}.`);Pe={};const Se=new l.a;Se.add(Vd);Pe[Nd.a.zmb]=Se;Pe[Nd.a.cP]=3;Vd=new ug.a(Ld.a.BAb,0,this.$.Mc,0,null);return this.$.Ka.Lb(Vd,Pe)};if(!y.EwaSettings.ma(53)||O.StoreId===OSF.StoreType.FirstParty)return dd(O,Cb,lc);if(Ma.isAddinCommands)return kd(Ma);const sd=new bd.a,Gd={};Gd.marketplaceId=O.SolutionId;Gd.marketplaceVersion=O.Version;Gd.storeType=O.StoreType;Gd.storeId=O.StoreId;Gd.targetData=O;y.EwaSettings.ma(93)&&(Gd.clearCache=!0);
this.oe.Qh.isAddinCommandsAsync(Gd,(Vd,Pe,Se)=>{sd.setResult(Pe);Vd||(Vd=Se.targetData,Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.SolutionId,Vd.StoreType,Vd.AssetId,null,null,Vd.StoreId),n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Pe} from ${Vd.StoreType} during addin inserting`))});return Gf.TaskExtensions.ts(sd.task,Vd=>Vd.result?kd(Ma):dd(O,Cb,lc),this.$.la)}wjc(O,Ma){if(!this.Pza[Ma])return O;const Cb={};if(O)for(const Dc of O)Cb[Dc[0]]=Dc[1];O=this.Pza[Ma];
for(var lc of Object.keys(O))lc===yf.Bxh&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Cb[lc]=Sys.Serialization.JavaScriptSerializer.serialize(O[lc]):Cb[lc]=Sys.Serialization.JavaScriptSerializer.serialize(O[lc].toString());lc=Object.keys(Cb).length;lc=Array(lc);O=0;for(const Dc of Object.keys(Cb))lc[O]=[Dc,Cb[Dc].toString()],O++;return lc}kui(O,Ma,Cb){const lc=this.$.ya.UserSessionId,Dc=this.$.ya.UICultureTag,dd=this.$.ya.UICultureTagLcid,kd=
this.$.ya.WacHostId;let sd="",Gd="";5<=Cb.length&&(sd=Cb[3],Gd=Cb[4]);this.lui(sd,Gd,O,Ma,Dc,dd,lc,kd)}lui(O,Ma,Cb,lc,Dc,dd,kd,sd){const Gd={};Gd.a=kd;Gd.b=Cb;Gd.c=lc;Gd.d=O;Gd.e=Ma;Gd.f=Dc;Gd.g=dd;Gd.h=sd;pg.b().Ie(36,Gd)}Fve(){if(ji.a.Wrf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.DGf);return}catch(O){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(O?O.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.DGf)}catch(O){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(O?O.toString():null))}}}nLd(O,Ma=null,Cb=!1,lc=null,Dc=null,dd=!0){var kd=O.SolutionId;let sd=sh.Task.Ua(!1);O&&kd&&O.SharedRuntimeId&&(lc=lc||new ug.a(-859308420,0,2,0,""),kd={},kd.solutionId=O.SolutionId,kd.version=O.Version,kd.storeType=O.StoreType,kd.storeId=O.StoreId,kd.assetId=O.AssetId,kd.assetStoreId=O.AssetStoreId,kd.height=O.Height,kd.targetType=O.TargetType,kd.width=0,kd.isAddinCommands=!1,
kd.sharedRuntimeId=O.SharedRuntimeId,O.Preload=dd,Dc=Dc?Dc:new Xg.a,Dc.width=0,Ma&&(Dc.focusOnIframeWhenLoaded=Ma.focusOnIframeWhenLoaded,dd=new Vh,Ma.Zk&&(dd.cyc=Ma.Zk),0<Ma.taskPaneWidth&&(dd.vu=Ma.taskPaneWidth),Ma.QR&&(dd.ayc=Ma.QR),this.h$c[O.SolutionId]=dd),Ma={},Ma[Hg.a.Zf]=O,Ma[Nd.a.gra]=kd,Ma[Xg.a.key]=Dc,Ma[Cd.a.yda]=Cb,sd=this.insertAgave(Ma,lc));return sd}zMa(O,Ma,Cb,lc=null){if(O&&Ma){O=new Oi.a(O,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const Dc=new Sh.a("ExcelOnline","Web",this.$.ya.UICultureTag),
dd=new Di.a;dd.optionalProperties[wg.a.GRc]=Cb;lc&&(lc.sourceLocationOverrideResourceId&&(dd.optionalProperties[wg.a.sourceLocationOverrideResourceId]=lc.sourceLocationOverrideResourceId),lc.Zk&&(dd.optionalProperties[wg.a.Zk]=lc.Zk),lc.Sk&&(dd.optionalProperties.IconCssClass=lc.Sk),lc.OTd&&(dd.optionalProperties.TaskPaneIconUrl=lc.OTd),lc.QR&&(dd.optionalProperties.TaskPaneIconId=lc.QR));Ei.a.instance.zMa(O,bh.a.action,Ma,Dc,dd)}}qSh(O){if(!Cg.a.kh(O)){var Ma=O[Fg.a.Fsb];if(Ma&&(Ma=Ma.getId(),O=
O[Fg.a.zla],Ma&&O))return this.B2a(Ma,O.optionalProperties[wg.a.sourceLocationOverrideResourceId])}return null}B2a(O,Ma=null){return O&&Ma?`${O}.${Ma}`:O}PJh(O){switch(O){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return y.EwaSettings.ma(234)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}MVd(){this.$.ea.Eg?this.HGd():(this.$.ea.ql(this.HGd),this.kab=!0)}GXh(){var O=this.$.da.za(20);if(!O)return this.MVd(),
"";O=O.J3a();if(!O)return this.MVd(),"";var Ma=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.oa.name);Ma=Eh.d(Ma);var Cb=zg.g(this.$).ha.sa.selectedRanges;const lc=[];for(const dd of Cb){Cb=new pi.a(dd,Ma);var Dc=O.hac(Cb,ph.Valid);Cb=[];if(Dc)for(const kd of Dc)(Dc=kd.table.nE)&&(Dc=Dc.range.toString())&&Cb.push(Dc);Cb=new Ii(dd.toString(),Cb);lc.push(Cb)}return JSON.stringify(lc)}}yf.Q6h="Microsoft.Office.Excel.IdeasXLOPreload";yf.MAd="IDS";yf.w6e="FA000000012";
yf.GKa="FA000000005";yf.Y4h="HelloWorld";yf.DVg="FA000000014";yf.Xac="Help.GiveFeedback.Url";yf.Bxh="feedback";yf.Bjf="FA000000066";yf.fZi="PowerBi.Url";yf.dZi="PowerBi.DevUrl";yf.eZi="FA000000054";yf.KBi="FA000000064";yf.qUi="FA000000075";yf.BUc="AnalyzeDataTaskPane";yf.l5i="RecommendedChartsTaskPane";yf.rXi="PivotTableTaskPane";yf.Xbh=350;yf.b8e=320;yf.W0i=320;Object(e.a)(yf,"AgaveCommandManager",Ic.a,[744,745]);class $h extends k.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da,
Ma=qf.GetServiceTaskFactory.create(O,106,this.la,this.ib),Cb=qf.GetServiceTaskFactory.create(O,104,this.la,this.ib),lc=Rh.a.loadScript(36,0,this.ib,void 0,void 0,375);Gf.TaskExtensions.Aa(Gf.TaskExtensions.Xd([Cb,Ma,lc],this.la),()=>{let Dc=null;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Dc=wc.a.instance.Vb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);$e.instance.initialize(Ma.result);const dd=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",
!0)?Object(Oh.c)(this.$.da,374,()=>new yf(this.$,Ma.result,Cb.result,Dc,Fc.AFrameworkApplication.wb)):new yf(this.$,Ma.result,Cb.result,Dc,Fc.AFrameworkApplication.wb);O.Ga(206,dd);this.qb(O.za(374)||O.Ga(374,dd))},this.la,3);wc.a.instance.register(wh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").uc().Gc(()=>new wh.a(this.$.aw))}static ka(O){O.da.Ga(375,new $h(O))}}Object(e.a)($h,"AgaveCommandManagerFactory",k.a,[]);var Ki=a(556);class qh{constructor(){this.initialized=!1;this.agaveCommandManager=
this.oe=this.t_a=null;this.ET={}}initialize(O){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.oij(O)}Pai(O,Ma){let Cb=Gf.TaskExtensions.vk();if(this.initialized&&O&&0<O.length){let lc=this.IGh(O);O in this.ET&&(Cb=this.agaveCommandManager.insertAgave(lc,Ma))}return Cb}pzg(O){this.initialized&&(O=O[Hg.a.Zf]||{},!O.SolutionId||O.SolutionId in this.ET||this.oe.pca(Ma=>{this.pca(Ma)},!0))}N2h(O){this.initialized&&
(O=O||"")&&0<O.length&&O in this.ET&&(delete this.ET[O],this.oe.pca(Ma=>{this.pca(Ma)},!0))}IGh(O){return O in this.ET?this.ET[O]:{}}pca(O){var Ma=!1;if(O&&!O.errorCode){if(O.value)for(const Cb of O.value)O=Cb[1],Cb[3]==OSF.OsfControlTarget.InContent&&O&&0<O.length&&!(O in this.ET)&&(Ma={NoReporting:!1,IsSystemInitiated:!1},Ma.description=Cb[2],Ma.iconUrl=Cb[9],Ma[Nd.a.gra]={solutionId:Cb[1],version:Cb[4],storeType:Cb[12],storeId:Cb[11],assetId:Cb[5],assetStoreId:Cb[6],targetType:Cb[3],width:Cb[7],
height:Cb[8],displayName:Cb[0],id:Cb[1]},Ma[Hg.a.Zf]={SolutionId:Cb[1],Version:Cb[4],StoreType:Cb[12],StoreId:Cb[11],AssetId:Cb[5],AssetStoreId:Cb[6],TargetType:Cb[3],Width:Cb[7],Height:Cb[8],Id:Cb[1]},this.ET[O]=Ma,Ma=!0);Ma&&this.D4g()}}D4g(){let O=[];for(const Ma in this.ET)O.push({id:Ma,controlType:0,title:this.ET[Ma][Nd.a.gra].displayName});if(0<O.length){for(const Ma in this.ET)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ma,this.ET[Ma].iconUrl);this.KWg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:qh.csf,
isOfficeTab:!0,groups:[{id:qh.d$e,title:qh.e$e,controls:O}]}]});for(const Ma in this.ET)this.t_a.addCommandToMaps(Object(Sa.a)(new af.a(Ma,"-1473679467"),{legacyControlId:Ma}))}}KWg(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:qh.csf,isOfficeTab:!0,groups:[{id:qh.d$e,title:qh.e$e,controls:[]}]}]})}oij(O){const Ma=qf.GetServiceTaskFactory.Ta(O.da,374,375,1),Cb=qf.GetServiceTaskFactory.create(O.da,106,O.la,1);Gf.TaskExtensions.Aa(Gf.TaskExtensions.Xd([Ma,Cb],O.la),()=>{this.agaveCommandManager=
Ma.result;this.t_a=wc.a.instance.uh("Common.IExternalUICommandDefinitionMapping")||new Ki.a(O.Bb,O);Fc.AFrameworkApplication.wb.Ob(Ld.a.FNf,th.a.frame,(lc,Dc,dd,kd,sd)=>{this.N2h(sd)});this.oe=Cb.result;this.oe.pca(lc=>{this.pca(lc)},!0);this.initialized=!0},O.la,3)}}qh.csf="tabinsert";qh.d$e="installedContentAddins";qh.e$e=nd.a.instance.ga(2276);Object(e.a)(qh,"AgaveCommandRibbon",null,[736]);class qi extends k.a{constructor(O){super();this.$=O;this.Fb()}create(){if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)){const O=this.$.da,Ma=new qh;Ma.initialize(this.$);this.qb(O.za(488)||O.Ga(488,Ma))}}static ka(O){O.da.Ga(489,new qi(O))}}Object(e.a)(qi,"AgaveCommandRibbonFactory",k.a,[]);var ai=a(1290),dg=a(730);class ri{constructor(){this.T4d=this.n4d=this.zea=null;this.Thb=0}get displayName(){return this.zea}set displayName(O){this.zea=O}get email(){return this.n4d}set email(O){this.n4d=O}get federationProvider(){return this.T4d}set federationProvider(O){this.T4d=O}get identityType(){return this.Thb}set identityType(O){this.Thb=
O}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(O){switch(O){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ma){switch(O){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,
0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ma){O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}static P5g(O){const Ma=new ri;Ma.displayName=O.displayName;Ma.email=O.email;switch(O.authority){case ai.a.zDf:Ma.identityType=1;break;default:Ma.identityType=0}Ma.federationProvider="";return Ma}}Object(e.a)(ri,"OfficeIdentityInfo",null,[]);class xh{static get FKe(){return xh.ong}static i$b(O){return O in xh.FKe?xh.FKe[O].toString():O}}xh.map=null;xh.ong={["GeneralException"]:dg.a.generalException,
["AccessDenied"]:dg.a.CRc,["ApiNotAvailable"]:dg.a.apiNotAvailable,["UserNotSignedIn"]:dg.a.userNotSignedIn,["UserAborted"]:dg.a.userAborted,["UnsupportedUserIdentity"]:dg.a.mPj,["InvalidResourceUrl"]:dg.a.invalidResourceUrl,["InvalidGrant"]:dg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:dg.a.$Gg,["ResourceNotAllowed"]:dg.a.ggj,["ClientError"]:dg.a.clientError,["ServerError"]:dg.a.serverError};Object(e.a)(xh,"SingleSignOnErrorCodeMap",null,[]);class si{constructor(O,Ma){this.JOb=O;this.Thb=Ma}get accessToken(){return this.JOb}set accessToken(O){this.JOb=
O}get tokenIdenityType(){return this.Thb}set tokenIdenityType(O){this.Thb=O}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(O){switch(O){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ma){switch(O){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}
Object(e.a)(si,"SingleSignOnToken",null,[]);class bi{constructor(){this.L0d=null;this.ree=this.jUb=this.SD="";this.Ffe=!0;this.options=null}get authChallenge(){return this.L0d}set authChallenge(O){this.L0d=O}get correlationId(){return this.SD}set correlationId(O){this.SD=O}get policy(){return null}set policy(O){}get resource(){return this.jUb}set resource(O){this.jUb=O}get scope(){return this.ree}set scope(O){this.ree=O}get silentLogin(){return this.Ffe}set silentLogin(O){this.Ffe=O}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(O){switch(O){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ma){switch(O){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(e.a)(bi,"TokenParameters",null,[539]);class ci{constructor(O,Ma){this.qgb=Ma;this.tA=O}get roamingSettings(){return null}getAccessToken(O){const Ma=this.qgb.getOsfControl(this.tA),
Cb=Ma.getManifest(),lc=Cb.getMarketplaceID();this.UMa(O,lc);return OfficeExtension.WacRuntime.Utility.createPromise((Dc,dd)=>{Ma.isFirstParty()&&this.qgb._enableFirstPartySSO?this.Mdi(Cb,O)?wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(O,lc).then(kd=>{Dc(kd)},kd=>{dd(kd)}):dd(dg.a.CRc):dd(dg.a.apiNotAvailable)}).then(Dc=>{let dd;switch(Dc.authority){case ai.a.zDf:dd=1;break;default:dd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new si(Dc.accessToken,
dd))},Dc=>{this.logErrorResponse(O,lc,Dc);return Dc?OfficeExtension.WacRuntime.Utility.createPromise((dd,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(Dc,xh.i$b(Dc)))}):OfficeExtension.WacRuntime.Utility.createPromise((dd,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,xh.i$b(dg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const O=this.qgb.getOsfControl(this.tA);O.getManifest();const Ma=O.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Cb,lc)=>{wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ma).then(Dc=>{Cb(Dc)},Dc=>{lc(Dc.toString())})}).then(Cb=>{Cb=ri.P5g(Cb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Cb)},Cb=>Cb?OfficeExtension.WacRuntime.Utility.createPromise((lc,Dc)=>{Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(Cb,xh.i$b(Cb)))}):OfficeExtension.WacRuntime.Utility.createPromise((lc,Dc)=>
{Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,xh.i$b(dg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(O){switch(O){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 1:return this.ZFh(Ma);case 3:return this.uHh();case 2:return this.vTh()}O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}ZFh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,bi);return this.getAccessToken(O)}uHh(){return this.getAuthContext()}vTh(){return this.getPrimaryIdentityInfo()}Mdi(O,
Ma){let Cb=!1;const lc=O.getWebApplicationAuthorizations();O=null;for(const Dc of lc)if(Dc.getResource().toLowerCase()===Ma.resource.toLowerCase()){O=Dc;Cb=!0;break}if(!Cb)return!1;Ma=Ma.scope.split(" ,+");for(const Dc of Ma)if(Dc&&Dc.length){Ma=!1;for(const dd of O.getScopes())Dc.toLowerCase()===dd.toLowerCase()&&(Ma=!0);if(!Ma)return!1}return!0}UMa(O,Ma){O=this.Prf(O.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ma,["resource"]:O})}logErrorResponse(O,Ma,Cb){O=this.Prf(O.resource);
n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ma,["resource"]:O,["error"]:Cb})}Prf(O){return O.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(ci,"AuthenticationService",null,[]);class ti{create(O,Ma){return new ci(O,Ma)}}Object(e.a)(ti,"AuthenticationServiceFactory",null,[]);var di=a(842),Mh=a(959),Q=a(942);class La{}La.generalException="generalException";La.invalidArgument="invalidArgument";La.notAllowed="notAllowed";La.apiNotAvailable="apiNotAvailable";
La.unresolvedPendingRequest="unresolvedPendingRequest";La.timeout="timeout";La.adalTimeout="adalTimeout";La.userNotSignedIn="userNotSignedIn";La.userAborted="userAborted";La.silentSignInFailed="silentSignInFailed";La.invalidResourceUrl="invalidResourceUrl";La.invalidGrant="invalidGrant";La.connectionLost="connectionLost";La.clientError="clientError";La.serverError="serverError";Object(e.a)(La,"WopiHostErrorCodes",null,[]);var kb=a(728);class Wb{}Object(e.a)(Wb,"OAuthCallerMetadata",null,[]);var oc=
a(27);class Kc{constructor(O){this.gxa=O;this.fng=Fc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}Cyg(O,Ma,Cb,lc,Dc,dd){if(!this.gxa)return lc=new Mh.a,lc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(lc);const kd=new Wb;kd.AddinName=Dc;kd.AddinTrustId=dd;let sd=-1;dd=null;if(lc&&this.ddf())dd=this.gxa.v$f(Nd.a.qyc,O,lc,Kc.Q_e(Dc),kd);else{const Gd=Date.now();dd=this.gxa.uO(Nd.a.qyc,O,kd).then(Vd=>{sd=Date.now()-
Gd;const Pe=(Ma||Cb)&&"login_required"===Vd.ErrorCode;return(Ma&&("interaction_required"===Vd.ErrorCode||"consent_required"===Vd.ErrorCode||"invalid_grant"===Vd.ErrorCode)||Pe)&&this.ddf()?this.gxa.v$f(Nd.a.qyc,O,null,Kc.Q_e(Dc),kd):Promise.resolve(Vd)})}return dd.then(Gd=>{const Vd=new Mh.a;Gd.IsSuccess?(Vd.token=Gd.Token,Gd.Telemetry&&(Vd.BSa=Gd.Telemetry.fromCache,Vd.expiresOn=Gd.Telemetry.expiresOn)):(Vd.errorCode=this.Dxi(Gd),Vd.XTd=this.AVi(Gd));return Vd}).catch(()=>{const Gd=new Mh.a;Gd.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Gd)}).then(Gd=>{Gd.rga="OauthManager";0<=sd&&(Gd.svb=sd);return Gd})}igi(O){const Ma=(Fc.AFrameworkApplication.fa.Va(Fc.AFrameworkApplication.Mda)||"").toLowerCase();return(oc.a.Bwa||"teams"===Ma&&kb.a.Bwb)&&!Kc.Mfi(O)||!this.gxa||!this.gxa.f5a()?!1:!0}ddf(){return this.fng||1!==Q.a.s9b()}Dxi(O){switch(O.ErrorCode){case "UserCancelled":case "interaction_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:O=
O.ErrorCode===La.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:O.ErrorCode===La.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:O.ErrorCode===La.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:O.ErrorCode===La.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:O.ErrorCode===La.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return O}AVi(O){let Ma=
"";(O=RegExp("AADSTS(\\d+)").exec(O.ErrorMessage))&&1<O.length&&(Ma=O[1]);return Ma}static Q_e(O){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,O)}static Mfi(O){if(!O)return!1;O=O.toLowerCase();for(const Ma of di.AppsForOfficeSingleSignOnManager.eSe)if(Ma===O)return!0;return!1}}Object(e.a)(Kc,"AppsforOfficeTokenFromOauthManager",null,[819]);class Cc{constructor(O){this.Kwi=O}static Lna(){if(Fc.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var O=
null;try{O=wc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ma){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ma)}O=new Kc(O);Cc.Ma=new Cc(O)}}static getInstance(){Cc.N6d||(Cc.Lna(),Cc.N6d=!0);return Cc.Ma}}Cc.Ma=null;Cc.N6d=!1;Object(e.a)(Cc,"AppsForOfficeOauthManagerFactory",null,[803]);var Bc=a(1289),qc=a(133);class Sc{constructor(O,Ma,Cb,lc){this.menuItemId=O;this.cG=Ma;this.mFj=Cb;this.nyh=lc}}Object(e.a)(Sc,"NewDocumentParameters",null,[]);const Xc=O=>
{var Ma=O.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Cb=Ma.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Cb.addParameter("shortcuts","String[]",1,null,0);Ma.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Cb=Ma.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Cb.addParameter("shortcuts","Object",1,null,0);Ma=O.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Cb=Ma.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Cb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ma=O.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Cb=Ma.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Cb.addParameter("base64File","String",1,null,0);Ma=O.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Cb=Ma.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Cb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ma=O.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ma.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Cb=Ma.addMethod("Register",1,"Void",0,0,"Register",0);Cb.addParameter("metadata","String",1,null,0);Cb.addParameter("javascript","String",1,null,0);Ma=O.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ma.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ma.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ma.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ma=O.addEnumType("Microsoft.Authentication.IdentityType");Ma.addEnumField("OrganizationAccount",
0);Ma.addEnumField("MicrosoftAccount",1);Ma=O.addEnumType("Microsoft.Authentication.AuthorityType");Ma.addEnumField("External",0);Ma.addEnumField("Msa",1);Ma.addEnumField("Aad",2);Ma=O.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ma.addProperty("DisplayName",4,"String",1,!1,null,0);Ma.addProperty("Email",3,"String",1,!1,null,0);Ma.addProperty("FederationProvider",2,"String",1,!1,null,0);Ma.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ma=O.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ma.addProperty("AppId",4,"String",1,!1,null,0);Ma.addProperty("Authority",2,"String",1,!1,null,0);Ma.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ma.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ma.addProperty("TenantId",6,"String",1,!1,null,0);Ma.addProperty("Upn",
1,"String",1,!1,null,0);Ma=O.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ma.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Cb=Ma.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Cb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ma.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ma.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ma=O.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ma.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ma.addProperty("CorrelationId",7,"String",1,!1,null,0);Ma.addProperty("Policy",4,"String",1,!1,null,0);Ma.addProperty("Resource",2,"String",1,!1,null,0);Ma.addProperty("Scope",
5,"String",1,!1,null,0);Ma.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ma=O.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ma.addProperty("AccessToken",2,"String",1,!1,null,0);Ma.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ma=O.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ma.addProperty("Id",1,"String",1,
!0,null,0);Ma.addProperty("Value",2,"Object",1,!1,null,0);Ma=O.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Cb=Ma.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Cb.addParameter("id","String",1,null,0);Cb=Ma.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Cb.addParameter("id","String",1,null,0);Ma=O.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Cb=Ma.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Cb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ma=O.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ma.addEnumField("Inactive",0);Ma.addEnumField("Background",1);Ma.addEnumField("Visible",2);Ma=O.addEnumType("Microsoft.AppRuntime.Visibility");
Ma.addEnumField("Hidden",1);Ma.addEnumField("Visible",2);Ma=O.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ma.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Cb=Ma.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Cb.addParameter("jsonCreate","String",1,null,0);Cb=Ma.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Cb.addParameter("jsonUpdate",
"String",1,null,0);Cb=Ma.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Cb.addParameter("id","String",1,null,0);Cb=Ma.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Cb.addParameter("id","String",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma=O.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ma.addProperty("Id",2,"String",1,!0,null,0);Cb=Ma.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Cb.addParameter("visibility","Boolean",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma=O.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ma.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ma.addProperty("Id",2,"String",1,!0,null,0);Ma.addProperty("Label",4,"String",1,!0,null,0);Cb=Ma.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Cb.addParameter("enabled","Boolean",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ma=O.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ma.addMethod("GetCount",3,"Int32",1,1,"Count",0);Cb=Ma.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Cb.addParameter("key","String",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ma=O.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ma.addEnumField("Unknown",0);Ma.addEnumField("Basic",
1);Ma.addEnumField("Premium",2);Ma=O.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Cb=Ma.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Cb.addParameter("feature","String",1,null,0);Cb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Cb=Ma.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Cb.addParameter("feature","String",1,null,0);Cb=Ma.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Cb.addParameter("feature","String",1,null,0);Cb.addParameter("fallbackValue","Boolean",1,null,0);Ma.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Cb=Ma.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Cb.addParameter("experienceId","String",1,null,0);Cb=Ma.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Cb.addParameter("feature","String",1,null,0);Ma=O.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ma.addProperty("Id",5,"String",1,!0,null,0);Ma.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ma.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ma=O.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ma.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ma=O.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ma.addMethod("Disable",3,"Void",0,1,"Disable",0);Ma.addMethod("Enable",2,"Void",0,1,"Enable",0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var jd=a(173);class Rd{constructor(O,Ma){this.Org=O;this.isg=Ma}createAndOpenWorkbook(O){if(O&&
O.length>this.Org)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",O.length),OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.invalidArgument,jd.a.ga(1761));const Ma=new Sc("blank","agave",O?"streamBase64":"streamEmpty",O);let Cb=null;return OfficeExtension.WacRuntime.Utility.createPromise((lc,Dc)=>{const dd=new qc.StandardDialog;dd.Sb=4;dd.yl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,kd=>{2===kd||0===kd?Dc("Cancelled"):
(Cb=window.open(""),this.isg.create(lc,Dc,Ma).V_a())})}).then(lc=>{if(!lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,jd.a.ga(1757));try{Cb.top.location.href=lc}catch(Dc){n.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",oc.a.fp,Dc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Cb.location.replace(lc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},lc=>{if("Cancelled"===lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.QAd,jd.a.ga(1760));Cb.close();this.qIj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 1:return this.C3g(Ma)}O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}C3g(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.createAndOpenWorkbook(O)}qIj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,
jd.a.ga(1757));}}Object(e.a)(Rd,"WacWorkbook",null,[]);const ce=(O,Ma)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof O+", objectId="+O+", value="+Ma);return null},we=O=>{O.add("InternalTest","PreviewExecutionMethod",ce)};var Be=a(248),Ie=a(729),Cf=a(735);class Hf{constructor(O){this.jb=O}get $(){return this.jb}}Object(e.a)(Hf,"RichApiPreviewExecutionContext",null,[]);var Ve=a(24),jg=a(862),Zf=a(36),Qf=a(208),sg=a(210),Ag=a(117),Yg=a(12);class rh extends sg.a{constructor(O,
Ma,Cb,lc){super(O,"Select Data");this.Tnb=null;this.LEe=Ma;this.X3c=Cb;this.callback=lc}get oc(){return"DdaBindingPrompt"}start(O,Ma){let Cb="<div class='"+Ag.a.Rmh+" "+Dg.a.Wo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Ag.a.RC+"' /></div>";Cb=String.format(Cb,of.a.Dg(this.X3c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Jb.innerHTML=Cb;this.Tnb=Yg.DOMElementExtensions.getElementById(this.Jb,"bindingText");O=Ma?O.W1a(Ma,this.X3c.DdaBindingsMethod.BindingId):
null;(null===O||void 0===O?0:O.IsValidRef)?(Ma=new Ve.Range(O.Reference.FirstRow+1,O.Reference.FirstColumn+1,O.Reference.LastRow+1,O.Reference.LastColumn+1,!1,!1),this.Tnb.value=O.Reference.SheetName+"!"+Ma):(O=zg.g(this.$).ha,this.Tnb.value=Eh.f(this.$.oa)||!O.sa.xg?"":O.sha);this.initialize();this.xf()}An(){this.EZc();this.addButton(0);this.addButton(1);super.An()}setFocus(){Yg.DOMElementExtensions.setFocus(this.Tnb)}validate(){return!0}commit(){let O=this.Tnb.value.trim();const Ma=O.indexOf("!");
-1!==Ma&&(O=this.uWh(O.substring(0,Ma))+O.substr(Ma));this.LEe.addBinding(this.X3c,O,0,this.callback);return!0}Ora(){this.LEe.UP.rf(Ie.a.internalError,this.callback);super.Ora()}uWh(O){O=lh.a.trimStart(O.trim(),"=");return O.length?O.startsWith("'")&&O.endsWith("'")?O:Nh.HelperMethods.w6b(O):""}}Object(e.a)(rh,"DdaBindingPrompt",sg.a,[]);class Af{constructor(O){this.ea=O}rf(O,Ma){if(Ma){const Cb={};Cb.Error=O;Cb.Version=this.ea.Le;Ma(Cb)}}aJa(O,Ma){this.rf(O,Ma)}kH(O,Ma){this.rf(Ie.a.GTe(O.Errors[0].MessageId),
Ma)}Zu(O){O&&O(this.AP())}AP(){const O={Error:0};O.Version=this.ea.Le;return O}}Object(e.a)(Af,"DdaErrorGenerator",null,[]);var We=a(281),vf=a(97);class Kf{constructor(O,Ma,Cb){this.$=O;this.UP=Ma;this.gA=Cb}Nvd(O,Ma){const Cb=O.DdaGoToByIdMethod.GoToType,lc=O.DdaGoToByIdMethod.SelectionMode,Dc=O.DdaGoToByIdMethod.Id.toString().trim(),dd=kd=>{const sd=this.$.xa.getItemByName(kd.SheetName);(null===sd||void 0===sd?0:sd.visible)?(zg.g(this.$).vg(kd,null,null,null,3,vf.a.cbh,void 0,void 0,void 0,void 0,
!0),this.UP.Zu(Ma)):this.UP.rf(Ie.a.lUg,Ma)};0===Cb?this.ABi(Dc,lc,O.DdaMethod.ControlId,dd,Ma):1===Cb?this.EBi(Dc,lc,dd,Ma):this.UP.rf(Ie.a.jPj,Ma)}ABi(O,Ma,Cb,lc,Dc){this.gA.ddaGetBinding(Cb,O,dd=>{if(!We.a(dd)&&dd.Result&&dd.Result.Reference){dd=dd.Result;var kd={};kd.SheetName=dd.Reference.SheetName;kd.FirstRow=dd.Reference.FirstRow;kd.FirstColumn=dd.Reference.FirstColumn;kd.LastRow=dd.Reference.LastRow;kd.LastColumn=dd.Reference.LastColumn;Kf.nUc(kd,Ma);1!==dd.BindingType?lc(kd):this.gA.ddaGetBindingData(Cb,
O,1,0,2,0,0,-1,-1,sd=>{We.a(sd)||!sd.Result?this.UP.kH(sd,Dc):(sd=sd.Result,2!==Ma&&(kd.FirstRow-=sd.Headers.length,0>kd.FirstRow&&(kd.FirstRow=0)),lc(kd))},Dc)}else this.UP.aJa(Ie.a.n4f,Dc)},Dc)}EBi(O,Ma,Cb,lc){var Dc=Ug.z(O);Dc?(Dc=Ug.v(Dc,this.$),Kf.nUc(Dc,Ma),Cb(Dc)):this.$.ea.isNamedObjectViewMode&&this.$.yb.qk(O)?this.$.yb.oa=this.$.yb.getItemByName(O):(Dc=dd=>{We.a(dd)||!dd.Result?this.$.xa.contains(O)?(dd={},dd.SheetName=O,dd.FirstRow=0,dd.FirstColumn=0,dd.LastRow=0,dd.LastColumn=0,Cb(dd)):
this.UP.aJa(Ie.a.n4f,lc):(dd=dd.Result,Kf.nUc(dd,Ma),Cb(dd))},this.$.xa.oa?this.gA.parseRangeForGoto(O,this.$.xa.oa.name,Dc,lc):this.gA.parseRange(O,Dc,lc))}static nUc(O,Ma){O.LastRow=2===Ma?O.FirstRow:O.LastRow;O.LastColumn=2===Ma?O.FirstColumn:O.LastColumn}}Object(e.a)(Kf,"DdaNavigator",null,[]);const qg=(O,Ma,Cb,lc,Dc,dd)=>{const kd=O.Na(1);kd.request=Ma;return Eg.g(O,"ExecuteRichApiRequest",kd,Cb,lc,Dc,dd,0)};var eg=a(292),Uf;(function(O){O[O.unsupported=0]="unsupported";O[O.surface=1]="surface";
O[O.combo=2]="combo";O[O.column=3]="column";O[O.column3D=4]="column3D";O[O.bar=5]="bar";O[O.bar3D=6]="bar3D";O[O.line=7]="line";O[O.line3D=8]="line3D";O[O.pie=9]="pie";O[O.pie3D=10]="pie3D";O[O.scatter=11]="scatter";O[O.bubble=12]="bubble";O[O.area=13]="area";O[O.area3D=14]="area3D";O[O.doughnut=15]="doughnut";O[O.radar=16]="radar";O[O.stock=17]="stock";O[O.waterfall=18]="waterfall";O[O.funnel=19]="funnel";O[O.treemap=20]="treemap";O[O.sunburst=21]="sunburst";O[O.boxWhisker=22]="boxWhisker";O[O.histogram=
23]="histogram";O[O.pareto=24]="pareto";O[O.regionMap=25]="regionMap";O[O.noVisibleSeries=26]="noVisibleSeries";O[O.complexDataSource=27]="complexDataSource";O[O.pivotChart=28]="pivotChart"})(Uf||(Uf={}));Object(e.b)("ChartCategory",Uf);class Rf{constructor(O,Ma){this.source=O;this.eventId=Ma}}Object(e.a)(Rf,"MacroRecorderEventData",null,[]);class If{constructor(O,Ma,Cb){this.parentName=O;this.$=Ma;this.request=Cb}MUh(O){var Ma;if(void 0===O||null===O||void 0===O.RequestBody||null===O.RequestBody)return null;
const Cb=JSON.parse(O.RequestBody);if(void 0!==O.ActiveChartId&&null!==O.ActiveChartId){Cb.ActiveChartId=O.ActiveChartId;const lc=zg.g(this.$).ha.Oa.$b;if(null===(Ma=null===lc||void 0===lc?void 0:lc.floatingObject)||void 0===Ma?0:Ma.Rc)Cb.ActiveChartType=Uf[lc.floatingObject.Rc.ChartCategory]}void 0!==O.SheetMultiRange&&null!==O.SheetMultiRange&&(Cb.SheetName=O.SheetMultiRange.SheetName);return Cb}ZUh(O){if(void 0===O||null===O||void 0===O.Result||null===O.Result)return null;O=O.Result;return void 0===
O.ResponseBody||null===O.ResponseBody||O.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(O.ResponseBody.join(""))}tki(O){return!!O&&!(void 0===O.eventId||null===O.eventId)&&0<O.eventId.length}hj(O){return()=>{if(this.$.Taa){const Ma=this.yQg(this.request);if(this.tki(Ma)){const Cb=this.MUh(this.request),lc=this.ZUh(O);if(Cb&&!Cg.a.isEmpty(Cb)&&lc&&!Cg.a.isEmpty(lc))return n.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new X(Ma,Cb,lc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Cb?"(not null)":"(null)"}; responseInfo: ${lc?"(not null)":"(null)"}`}`)}}return new X(null,null,null)}}yQg(O){const Ma=this.uki(O.SolutionId),Cb=If.tUh(O);if(Cb&&Ma)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Cb,["request.SolutionId"]:O.SolutionId})}`),new Rf(O.SolutionId,Cb);n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Cb,
["isRecorderAwareAddin"]:Ma,["request.SolutionId"]:O.SolutionId})}`);return null}uki(O){if(!O)return!1;O=O.toLowerCase();return If.x_h().contains(O)}static x_h(){If.Uya||(If.Uya=new u.a(R.a.Rk()),If.Uya.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),If.Uya.add("fa000000005"),If.Uya.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),If.Uya.add("fa000000014"),If.Uya.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return If.Uya}static tUh(O){let Ma=null;var Cb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',
"mi");if(Cb.test(O.RequestBody))Ma=Cb.exec(O.RequestBody)[1];else{O=O.RequestHeaders;if(!O)return Ma;Cb=jf.a.kEi.toLowerCase();for(let lc=0;lc<O.length;lc++)if(O[lc].Name.toLowerCase()===Cb){Ma=O[lc].Value;break}}return Ma}}If.Uya=null;Object(e.a)(If,"DdaRichApiRequestRecorder",null,[]);class Vf extends eg.a{constructor(O,Ma,Cb,lc,Dc,dd,kd,sd){super(10,0,Ma,sd);this.Pkb=Cb;this.jhb=lc;this.E2=Dc;this.xEa=dd;this.request=kd;this.FKd=new If("10",O,kd)}get KF(){return y.EwaSettings.fc()?super.KF:2}get MAc(){return this.xEa}get wt(){return this.Pkb}get G$(){return this.jhb}X1(O){return super.X1(O)||
this.hTg(O)}hj(){return this.FKd.hj(this.$c)}Jdb(){const O={OperationType:3};O.RichApiRequest=this.request;return O}hTg(O){return(Ma,Cb,lc)=>qg(O,this.request,Pf.b(Ma,this.Pkb),Pf.a(Cb,this.jhb),lc,this.E2)}}Object(e.a)(Vf,"DdaRichApiRequestBatchOperation",eg.a,[]);class tg extends Lh.a{constructor(O,Ma,Cb,lc){super(576,0,Cb,lc);this.FKd=new If("576",O,Ma)}get KF(){return y.EwaSettings.fc()?super.KF:0}hj(){return this.FKd.hj(this.$c)}}Object(e.a)(tg,"DdaRichApiRequestOperation",Lh.a,[]);class ch{constructor(O,
Ma){this.cI=(Cb,lc)=>{this.UP.aJa(Ie.a.internalError,lc)};this.$=O;this.UP=Ma}ddaAddBinding(O,Ma,Cb,lc,Dc,dd,kd){this.KJ((sd,Gd,Vd)=>{var Pe=this.$.pa.va,Se=this.Gia();sd=Pf.b(sd,dd);Gd=Pf.a(Gd,this.cI);const ef=Pe.Na(9);ef.controlId=O;ef.bindingId=Ma;ef.bindingType=Cb;ef.currentSheetName=Se;ef.formula=lc;ef.options=Dc;return Eg.g(Pe,"DdaAddBinding",ef,sd,Gd,Vd,kd,0)},kd,563)}ddaReleaseBinding(O,Ma,Cb,lc){this.KJ((Dc,dd,kd)=>{var sd=this.$.pa.va;Dc=Pf.b(Dc,Cb);dd=Pf.a(dd,this.cI);const Gd=sd.Na(9);
Gd.controlId=O;Gd.bindingId=Ma;return Eg.g(sd,"DdaReleaseBinding",Gd,Dc,dd,kd,lc,0)},lc,564)}ddaGetBinding(O,Ma,Cb,lc){this.KJ((Dc,dd,kd)=>{var sd=this.$.pa.va;Dc=Pf.b(Dc,Cb);dd=Pf.a(dd,this.cI);const Gd=sd.Na(1);Gd.controlId=O;Gd.bindingId=Ma;return Eg.g(sd,"DdaGetBinding",Gd,Dc,dd,kd,lc,0)},lc,565,16)}ddaGetAllBindings(O,Ma,Cb){this.KJ((lc,Dc,dd)=>{var kd=this.$.pa.va;lc=Pf.b(lc,Ma);Dc=Pf.a(Dc,this.cI);const sd=kd.Na(1);sd.controlId=O;return Eg.g(kd,"DdaGetAllBindings",sd,lc,Dc,dd,Cb,0)},Cb,566,
16)}ddaGetBindingData(O,Ma,Cb,lc,Dc,dd,kd,sd,Gd,Vd,Pe){this.KJ((Se,ef,lg)=>{var bg=this.$.pa.va,cg=this.Gia();Se=Pf.b(Se,Vd);ef=Pf.a(ef,this.cI);const Of=bg.Na(1);Of.controlId=O;Of.bindingId=Ma;Of.coerceType=Cb;Of.valueFormat=lc;Of.filterType=Dc;Of.startRow=dd;Of.startCol=kd;Of.rowCount=sd;Of.colCount=Gd;Of.currentSheetName=cg;return Eg.g(bg,"DdaGetBindingData",Of,Se,ef,lg,Pe,0)},Pe,567,16)}ddaSetBindingData(O,Ma,Cb,lc,Dc,dd,kd){this.KJ((sd,Gd,Vd)=>{var Pe=this.$.pa.va,Se=this.Gia();sd=Pf.b(sd,dd);
Gd=Pf.a(Gd,this.cI);const ef=Pe.Na(9);ef.controlId=O;ef.bindingId=Ma;ef.startRow=Cb;ef.startCol=lc;ef.currentSheetName=Se;ef.bindingData=Dc;return Eg.g(Pe,"DdaSetBindingData",ef,sd,Gd,Vd,kd,0)},kd,568)}ddaGetSelectedData(O,Ma,Cb,lc,Dc,dd,kd){this.KJ((sd,Gd,Vd)=>{var Pe=this.$.pa.va,Se=this.Gia();sd=Pf.b(sd,dd);Gd=Pf.a(Gd,this.cI);const ef=Pe.Na(1);ef.controlId=O;ef.coerceType=Ma;ef.valueFormat=Cb;ef.filterType=lc;ef.currentSheetName=Se;ef.formula=Dc;return Eg.g(Pe,"DdaGetSelectedData",ef,sd,Gd,Vd,
kd,0)},kd,569,16)}ddaSetSelectedData(O,Ma,Cb,lc,Dc){this.KJ((dd,kd,sd)=>{var Gd=this.$.pa.va,Vd=this.Gia();dd=Pf.b(dd,lc);kd=Pf.a(kd,this.cI);const Pe=Gd.Na(9);Pe.controlId=O;Pe.currentSheetName=Vd;Pe.formula=Ma;Pe.bindingData=Cb;return Eg.g(Gd,"DdaSetSelectedData",Pe,dd,kd,sd,Dc,0)},Dc,570)}ddaLoadSettings(O,Ma,Cb){this.KJ((lc,Dc,dd)=>{var kd=this.$.pa.va;lc=Pf.b(lc,Ma);Dc=Pf.a(Dc,this.cI);const sd=kd.Na(1);sd.controlId=O;return Eg.g(kd,"DdaLoadSettings",sd,lc,Dc,dd,Cb,0)},Cb,501,16)}ddaSaveSettings(O,
Ma,Cb,lc,Dc){this.KJ((dd,kd,sd)=>{var Gd=this.$.pa.va;dd=Pf.b(dd,lc);kd=Pf.a(kd,this.cI);const Vd=Gd.Na(9);Vd.controlId=O;Vd.settings=Ma;Vd.overwriteIfStale=Cb;return Eg.g(Gd,"DdaSaveSettings",Vd,dd,kd,sd,Dc,0)},Dc,571)}ddaAddRowsColumns(O,Ma,Cb,lc,Dc,dd){this.KJ((kd,sd,Gd)=>{var Vd=this.$.pa.va,Pe=this.Gia();kd=Pf.b(kd,Dc);sd=Pf.a(sd,this.cI);const Se=Vd.Na(9);Se.controlId=O;Se.bindingId=Ma;Se.isRow=Cb;Se.currentSheetName=Pe;Se.bindingData=lc;return Eg.g(Vd,"DdaAddRowsColumns",Se,kd,sd,Gd,dd,0)},
dd,572)}ddaDeleteAllDataValues(O,Ma,Cb,lc){this.KJ((Dc,dd,kd)=>{var sd=this.$.pa.va,Gd=this.Gia();Dc=Pf.b(Dc,Cb);dd=Pf.a(dd,this.cI);const Vd=sd.Na(9);Vd.controlId=O;Vd.bindingId=Ma;Vd.currentSheetName=Gd;return Eg.g(sd,"DdaDeleteAllDataValues",Vd,Dc,dd,kd,lc,0)},lc,573)}ddaClearBindingFormats(O,Ma,Cb,lc){this.KJ((Dc,dd,kd)=>{var sd=this.$.pa.va,Gd=this.Gia();Dc=Pf.b(Dc,Cb);dd=Pf.a(dd,this.cI);const Vd=sd.Na(9);Vd.controlId=O;Vd.bindingId=Ma;Vd.currentSheetName=Gd;return Eg.g(sd,"DdaClearBindingFormats",
Vd,Dc,dd,kd,lc,0)},lc,574)}ddaSetBindingFormats(O,Ma,Cb,lc,Dc,dd){this.KJ((kd,sd,Gd)=>{var Vd=this.$.pa.va,Pe=this.Gia();kd=Pf.b(kd,Dc);sd=Pf.a(sd,this.cI);const Se=Vd.Na(9);Se.controlId=O;Se.bindingId=Ma;Se.currentSheetName=Pe;Se.bindingData=Cb;Se.isSetFormats=lc;return Eg.g(Vd,"DdaSetBindingFormats",Se,kd,sd,Gd,dd,0)},dd,575)}parseRange(O,Ma,Cb){this.KJ((lc,Dc,dd)=>{const kd=this.$.pa.va.Qb();return Eg.w(this.$.pa.va,O,-1,Pf.b(lc,Ma),Pf.a(Dc,this.cI),dd,Cb,kd)},Cb,162,16)}parseRangeForGoto(O,Ma,
Cb,lc){this.KJ((Dc,dd,kd)=>{const sd=this.$.pa.va.Qb();return Eg.x(this.$.pa.va,O,Ma,Pf.b(Dc,Cb),Pf.a(dd,this.cI),kd,lc,sd)},lc,562,16)}executeRichApiRequest(O,Ma,Cb){y.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(O.RequestFlags&=8191);if(y.EwaSettings.ma(258))this.pwh(this.$.pa.va.Qb(),Ma,()=>{this.UP.aJa(Ie.a.internalError,Cb)},Cb,O);else{let lc=Jg.DdaFacade.Rdd(O);!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.rb.$x||lc&16?(y.EwaSettings.fc()&&(lc|=64),this.$.userOperationManager.$t(new tg(this.$,O,(Dc,dd,kd)=>qg(this.$.pa.va,O,Pf.b(Dc,Ma),Pf.a(dd,this.cI),kd,Cb),lc))):(this.UP.aJa(Ie.a.PBc,Cb),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Gia(){return this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.activeItemName}KJ(O,Ma,Cb,lc=0){!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.$x||lc&16?y.EwaSettings.fc()?
this.$.userOperationManager.$t(new Lh.a(Cb,0,O,lc|64)):this.$.userOperationManager.$t(new Wh.a(Cb,0,O,lc)):(this.UP.aJa(Ie.a.PBc,Ma),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}pwh(O,Ma,Cb,lc,Dc){let dd=Jg.DdaFacade.Rdd(Dc);if(!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.$x||dd&16){var kd=this.$.Hb.xc("UserAction","Rich Api request");y.EwaSettings.fc()&&(dd|=64);this.$.userOperationManager.Ub(new Vf(this.$,O,Ma,
Cb,lc,kd,Dc,dd),null)}else this.UP.aJa(Ie.a.PBc,lc),n.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(e.a)(ch,"DdaWebServiceHelper",null,[]);class Wf{constructor(O,Ma,Cb,lc){this.cyh=O;this.fileSize=Ma;this.KBj=lc}}Object(e.a)(Wf,"DocumentFile",null,[]);class kh{}kh.generalException="GeneralException";kh.SIg="ApiNotFound";kh.QAd="OperationCancelled";kh.invalidArgument="InvalidArgument";Object(e.a)(kh,"ErrorCodes",null,[]);class ui{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(e.a)(ui,"WacApiDelegates",null,[]);var cj=a(611);class ei extends ui{constructor(O,Ma){super();this.Sff=(Cb,lc)=>{Cb=ei.Y1g(Cb,lc);if(!cj.a(this.$,Cb))return!0;Cb=this.$.shortcutKeyManager.f1e(Cb);return!!Cb&&0<Cb.length};this.addinId=O;this.$=Ma}replaceShortcuts(O){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,O,this.Sff)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(O){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(O,
this.Sff)}static y6g(O,Ma){const Cb=document.createEvent("KeyboardEvent");if(oc.a.vF)Cb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(O&8),!!(O&32),!!(O&4),!!(O&256));else{const lc=[];O&4&&lc.push("Shift");O&8&&lc.push("Control");O&32&&lc.push("Alt");Cb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,lc.join(" "),!1,"en-US")}O=new Sys.UI.DomEvent(Cb);O.keyCode=Ma;return O}static Y1g(O,Ma){if(oc.a.Tf)switch(Ma){case 189:Ma=173;break;case 187:Ma=61;break;case 186:Ma=59}return ei.y6g(O,
Ma)}}Object(e.a)(ei,"ExcelWacApiDelegates",ui,[]);class Yf{constructor(O){this.NHa={};this.syi=O}jAg(O,Ma){this.Ebc(O)||(this.NHa[O]={});if(this.Lfi(O))return n.ULS.sendTraceTag(537163157,344,50,`App ${O} has reach the limit of number of cached files.`),Ie.a.$yi;this.NHa[O][Ma.cyh.toString()]=Ma;return Ie.a.success}aMh(O,Ma){let Cb=null;this.Ebc(O)&&(Cb=this.NHa[O][Ma.toString()]);Cb||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${O}, fileHandler:${Ma}] doesn't exist`);return Cb}Ebc(O){return O in
this.NHa}P8i(O,Ma){if(this.Ebc(O)){const Cb=this.NHa[O];delete Cb[Ma.toString()];1>Object.keys(Cb).length&&delete this.NHa[O];return Ma.toString()in Cb?Ie.a.internalError:Ie.a.success}return Ie.a.internalError}Lfi(O){return this.Ebc(O)?Object.keys(this.NHa[O]).length>=this.syi:!1}static getInstance(O){return O.da.za(200)||O.da.Ga(200,new Yf(Yf.tyi))}static nCi(){return++Yf.xSg}}Yf.Xxi=4194304;Yf.tyi=1;Yf.xSg=0;Object(e.a)(Yf,"GetFileApiHelper",null,[]);class Rg{constructor(O){this.tA=O}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.tA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.SCi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){O=this.invokeMethod(O,
Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}SCi(){this.notifyActionHandlerReady();return null}}Object(e.a)(Rg,"AddinInternalService",null,[]);class Zg{constructor(O,Ma){this.NI=Ma;this.tA=O}getAppRuntimeState(){return this.NI.getAppRuntimeState(this.tA)?2:1}setAppRuntimeState(O){switch(O){case 2:O=!0;break;case 1:O=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.invalidArgument,jd.a.ga(1761));}this.NI.setAppRuntimeState(this.tA,O)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Ma){switch(O){case 2:return this.gHh();case 1:return this.Onj(Ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,
Ma){O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}gHh(){return this.getAppRuntimeState()}Onj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");this.setAppRuntimeState(O);return null}}Object(e.a)(Zg,"AppRuntimeService",null,[]);var Xf=a(963);class Gg{constructor(O,Ma,Cb,lc){this.ex=O;this.M0=Cb;this.Gy=lc.Qh.getOsfControl(Ma)}disable(){try{if(!jd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.CBe();
if(!this.pff())return this.DBe();this.M0.qOj(this.ex)}catch(O){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",O.message||"Unknown"),this.ABe()}return null}enable(){try{if(!jd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.CBe();if(!this.pff())return this.DBe();this.M0.N6i(this.ex)}catch(O){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
O.message||"Unknown"),this.ABe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,
Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.CBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 3:return this.Heh();case 2:return this.Bjh()}O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Heh(){return this.disable()}Bjh(){return this.enable()}CBa(){this._OnAccess();return null}CBe(){return Xf.a(dg.a.notImplemented,
jd.a.ga(1762))}DBe(){return Xf.a(dg.a.sharedRuntimeNotAvailable,jd.a.ga(1766))}ABe(){return Xf.a(dg.a.generalException,jd.a.ga(1757))}pff(){const O=this.Gy.getSharedRuntimeId();return!!O&&0<O.length}}Object(e.a)(Gg,"BeforeDocumentCloseNotification",null,[]);class dh{constructor(){this.fge=this.oae=this.pA=!1}get enabled(){return this.pA}set enabled(O){this.pA=O}get nativeRuntime(){return this.oae}set nativeRuntime(O){this.oae=O}get streamingEnabled(){return this.fge}set streamingEnabled(O){this.fge=
O}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(O){switch(O){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ma){switch(O){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ma){O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(e.a)(dh,"CustomFunctionEngineStatus",null,[]);class yh{constructor(O,Ma,Cb){this.Upg=O;this.Vpg=Ma;this.Wtg=Cb}get status(){const O=new dh;O.enabled=this.Upg;O.streamingEnabled=this.Vpg;O.nativeRuntime=!1;return O}register(O){return OfficeExtension.WacRuntime.Utility.createPromise(this.Wtg(O))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(O){switch(O){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 1:return this.E7i(Ma)}O=this.invokeMethod(O,
Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}E7i(O){const Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"string");return this.register(Ma,O)}}Object(e.a)(yh,"CustomFunctionManager",null,[]);var Fh=a(941);class fi{constructor(O,Ma,Cb,lc){this.w1d="";this.WQb=0;this.GO=O;this._id=Ma;this.tA=Cb;this.NI=lc}get id(){return this._id}_RegisterStateChange(){this.WQb||this.GO.execute(O=>
{this.w1d=O.Yla(this._id,Ma=>{this.NI.gAh(this.tA,this._id,JSON.stringify(Ma))})});this.WQb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.WQb--;this.WQb||this.GO.execute(O=>{O.dHd(this._id,this.w1d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(O){switch(O){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 6:return this.jjg();case 7:return this.ljg()}O=
this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}jjg(){return this._RegisterStateChange()}ljg(){return this._UnregisterStateChange()}}Object(e.a)(fi,"LicenseFeature",null,[]);class dj{constructor(O,Ma){this.GO=wc.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.tA=O;this.NI=Ma;this.Lsg=this.NI.Qh.getOsfControl(this.tA)}getFeatureTier(O,Ma){return OfficeExtension.WacRuntime.Utility.createPromise(Cb=>{const lc=1===Ma?1:2===
Ma?2:0;this.GO.execute(Dc=>{Dc.getFeatureTier(O,lc).then(dd=>{Cb(this.kQh(dd))},()=>{Cb(Ma)})})})}getLicenseFeature(O){O=new fi(this.GO,O,this.tA,this.NI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}isFeatureEnabled(O,Ma){return OfficeExtension.WacRuntime.Utility.createPromise(Cb=>{this.GO.execute(lc=>{lc.isFeatureEnabled(O,Ma).then(Dc=>{Cb(Dc)},()=>{Cb(Ma)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(O=>{this.GO.execute(Ma=>{Ma=
Ma.isFreemiumUpsellEnabled();O(Ma)})})}launchUpsellExperience(O){if(this.Lsg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.GO.execute(Ma=>{Ma.launchUpsellExperience(O)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.CRc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Ma){switch(O){case 6:return this.kjg(Ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 2:return this.UMh(Ma);case 5:return this.jQh(Ma);
case 1:return this.ygi(Ma);case 3:return this.ehi();case 4:return this.Aqi(Ma)}O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}UMh(O){const Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"int");return this.getFeatureTier(Ma,O)}jQh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getLicenseFeature(O)}ygi(O){const Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"boolean");return this.isFeatureEnabled(Ma,O)}ehi(){return this.isFreemiumUpsellEnabled()}Aqi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.launchUpsellExperience(O)}kjg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");this._TestFireStateChangedEvent(O);return null}kQh(O){switch(O){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(dj,"License",
null,[]);var gj=a(152);const mj=(O,Ma,Cb)=>lc=>(Dc,dd)=>{Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(Ma.da,279,Ma.la,1),kd=>{kd=kd.result;let sd=!1;var Gd=Cb.Qh.getOsfControl(O);let Vd=null;Gd&&(Vd=Gd.getStoreType(),(Gd=Gd.getManifest())&&Gd.getSharedRuntimeForCustomFunctions("Workbook")&&(sd=!0));Gf.TaskExtensions.Aa(kd.b$e(O,Vd,lc,sd),Pe=>{gj.b(Pe)?Pe.result?Dc(null):dd(OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.invalidArgument,nd.a.instance.ga(1761))):dd(OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,
nd.a.instance.ga(1757)))},Ma.la,3)},Ma.la,3)};class hj{constructor(O){if(!O)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Ztd=O}areShortcutsInUse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ma,Cb)=>{this.Ztd.checkShortcutsInUse(O).then(lc=>{Ma(lc)}).catch(lc=>{Cb(lc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((O,Ma)=>{this.Ztd.getShortcuts().then(Cb=>{O(Cb)}).catch(Cb=>{Ma(Cb)})})}replaceShortcuts(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ma,
Cb)=>{this.Ztd.replaceShortcuts(O).then(()=>{Ma(null)}).catch(lc=>{Cb(lc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ma){switch(O){case 3:return this.AKg(Ma);case 1:return this.zWh();case 2:return this.ldj(Ma)}O=this.invokeMethod(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}AKg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"Array<string>");return this.areShortcutsInUse(O)}zWh(){return this.getShortcuts()}ldj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"any");return this.replaceShortcuts(O)}}Object(e.a)(hj,"ActionService",
null,[]);var nj=a(513);class ij{constructor(){this.Aqa=null}lWh(){this.Aqa||(this.Aqa=nj.a.Sq(wc.a.instance.Vb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Aqa}getSharedFilePickerResponse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ma,Cb)=>{try{const lc=this.lWh();sh.Task.WAA.call(null,lc).continueWith(()=>{const Dc=lc.result;if(Dc){let dd={};({Vt:dd}=rd.d(O)).returnValue?Dc.wcd(dd).then(kd=>{kd&&0<kd.length?Ma(kd):Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(kd=>{Cb(kd)}):Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(lc){Cb(lc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ma){this.invokePropertySet(O,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ma){switch(O){case 1:return this.kWh(Ma)}O=this.invokeMethod(O,
Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}kWh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getSharedFilePickerResponse(O)}}Object(e.a)(ij,"SharedFilePicker",null,[]);class jj{createInstance(O,Ma){switch(O){case "Microsoft.Office.ActionService":return new hj(Ma);case "Microsoft.Office.SharedFilePicker":return new ij}return null}}Object(e.a)(jj,"WacApiHost",null,[]);class kj{constructor(O,Ma,Cb,lc,Dc){this.hRc=null;this.ePb=
O;this.tA=Ma;this.NI=Cb;this.jb=lc;this.Uxg=Dc}hostName(){return"ExcelOnline"}appId(){return this.ePb}createInstance(O){switch(O){case "Microsoft.Authentication.AuthenticationService":return wc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.tA,this.NI.Qh);case "Microsoft.Authentication.TokenParameters":return new bi;case "Microsoft.ExcelServices.CustomFunctionManager":O=this.jb.ma(121);var Ma=this.jb.ma(122);return new yh(O,Ma,mj(this.ePb,
this.jb,this.NI));case "Microsoft.AppRuntime.AppRuntimeService":return new Zg(this.tA,this.NI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return O=Be.a(this.jb),new Gg(this.ePb,this.tA,O,this.NI);case "Microsoft.DynamicRibbon.DynamicRibbon":return O=Be.a(this.jb),new Fh.DynamicRibbon(this.ePb,this.tA,this.NI,O,O.en(this.tA).ml);case "Microsoft.Office.Licensing.License":return new dj(this.tA,this.NI);case "Microsoft.InternalService.AddinInternalService":return new Rg(this.tA);
default:if(this.hRc||(this.hRc=new jj),Ma=this.hRc.createInstance(O,this.Uxg))return Ma}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${O} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(dg.a.generalException,dg.a.generalException);}}Object(e.a)(kj,"RichApiHost",null,[]);var oj=a(380),lj=a(28),pj=a(118),ej=a(34),qj=a(100),rj=a(283),sj=a(43),tj=a(249),uj=a(6),vj=a(68),wj=a(199);class uf{constructor(O,Ma,Cb){this.rangePicker=
null;this.$=O;this.oe=Ma;this.ve=new Af(O.ea);this.gA=new ch(O,this.ve);this.Dqf=Cb;this.B7b=new Map}get UP(){return this.ve}dispose(){this.$=this.B7b=null}Qc(){return!1}Vc(){return!1}executeCommand(O,Ma,Cb){O=Ma.command;switch(O){case 451041795:this.ve.rf(Cb[Hg.a.Zf],Cb[Hg.a.E2]);break;case 974713501:this.a2h(Cb[Hg.a.Zf],Cb[Hg.a.E2]);break;case 1237877382:this.ve.Zu(Cb[Hg.a.E2]);break;default:return hi.a(O)}return sh.Task.Ua(!0)}Ec(O,Ma,Cb){if(O=!!Cb)switch(Ma.command){case 974713501:case 1237877382:case 451041795:break;
default:O=!1}return O}a2h(O,Ma){var Cb;const lc=O.DdaMethod;if("undefined"===typeof lc.DispatchId)this.ve.rf(Ie.a.internalError,Ma);else if(uf.Efi(O)||this.$.Bd&1){if(lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new rh(this.$,this,O,Ma)).start(this.oe,O.DdaMethod.ControlId):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.LVh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.ksj(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(O,this.Vbd(O.DdaMethod.ControlId),0,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.PHh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Znj(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.OHh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.O8i(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.LGh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.bsd(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(O.DdaAddRowsColumns.IsRow=!0,this.Oke(O,Ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(O.DdaAddRowsColumns.IsRow=!1,this.Oke(O,Ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.qch(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.YWg(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(O.DdaSetBindingFormats.IsSetFormats=!0,this.qXf(O,Ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(O.DdaSetBindingFormats.IsSetFormats=!1,this.qXf(O,Ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(O,O.DdaBindingsMethod.ItemName,O.DdaBindingsMethod.FailOnCollision?2:1,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.YMh(Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.Nvd(O,Ma):lc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.YLh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.ZLh(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Q8i(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(O.DdaMethod.ControlId,O),this.ve.Zu(Ma)):
lc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?y.EwaSettings.ma(23)?this.ve.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ma):this.vzi(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?y.EwaSettings.ma(23)?this.ve.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ma):this.rzi(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(O,Ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(O,Ma):this.ve.rf(Ie.a.UAd,Ma),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&lc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){O=this.oe.AY(O.DdaMethod.ControlId);Ma="";if(O){Ma=Jg.DdaFacade.getSolutionId(O,this.$);let Dc=O.PrimaryMarketplace.MarketplaceType;Dc===OSF.StoreType.InMemory?O.OwnerAddinSolutionId&&O.AssetMarketplace&&(Dc=O.AssetMarketplace.MarketplaceType):Dc===OSF.StoreType.WopiCatalog&&(Dc=OSF.StoreType.OMEX);
Ma=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma,Dc,null===(Cb=O.AssetMarketplace)||void 0===Cb?void 0:Cb.SolutionId,null,null,O.PrimaryMarketplace.MarketplaceRef)}n.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${lc.DispatchId}, AppID: ${Ma}`)}}else this.ve.rf(Ie.a.yHe,Ma)}PHh(O,Ma){O.DdaGetBindingData.CoerceType=uf.k1b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.FilterType=uf.mRe(O.DdaGetBindingData.FilterType);O.DdaGetBindingData.ValueFormat=uf.weg(O.DdaGetBindingData.ValueFormat);
if(this.Kgc(O.DdaGetBindingData.CoerceType,Ma)){if(O.DdaGetBindingData){const Cb=O.DdaGetBindingData;0===Cb.FilterType&&(Cb.FilterType=2);Cb.StartCol|=0;Cb.StartRow|=0;Cb.ColCount=void 0===Cb.ColCount?-1:Cb.ColCount;Cb.RowCount=void 0===Cb.RowCount?-1:Cb.RowCount}this.gA.ddaGetBindingData(O.DdaMethod.ControlId,O.DdaGetBindingData.BindingId,O.DdaGetBindingData.CoerceType,O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,O.DdaGetBindingData.StartRow,O.DdaGetBindingData.StartCol,O.DdaGetBindingData.RowCount,
O.DdaGetBindingData.ColCount,Cb=>{if(We.a(Cb)||!Cb.Result)this.ve.kH(Cb,Ma);else{const lc=this.ve.AP();lc.Data=uf.hte(Cb.Result);Ma(lc)}},Ma)}}Znj(O,Ma){O.DdaSetBindingData.CoerceType=uf.k1b(O.DdaSetBindingData.CoerceType);if(this.Kgc(O.DdaSetBindingData.CoerceType,Ma)){var Cb=uf.aXc(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data);uf.Mdc(Cb)?this.ve.rf(Ie.a.Azc,Ma):(1===Cb.CoerceType&&(Cb.CellFormat||(Cb.CellFormat=O.DdaSetBindingData.CellFormat),Cb.TableOptions||(Cb.TableOptions=O.DdaSetBindingData.TableOptions)),
O.DdaSetBindingData&&(O.DdaSetBindingData.StartCol|=0,O.DdaSetBindingData.StartRow|=0),this.gA.ddaSetBindingData(O.DdaMethod.ControlId,O.DdaSetBindingData.BindingId,O.DdaSetBindingData.StartRow,O.DdaSetBindingData.StartCol,Cb,lc=>{We.a(lc)?this.ve.kH(lc,Ma):this.ve.Zu(Ma)},Ma))}}LVh(O,Ma){O.DdaGetBindingData.CoerceType=uf.k1b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.ValueFormat=uf.weg(O.DdaGetBindingData.ValueFormat);O.DdaGetBindingData.FilterType=uf.mRe(O.DdaGetBindingData.FilterType);
if(this.Kgc(O.DdaGetBindingData.CoerceType,Ma)){var Cb=this.Vbd(O.DdaMethod.ControlId);Cb?this.gA.ddaGetSelectedData(O.DdaMethod.ControlId,O.DdaGetBindingData.CoerceType,O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,Cb,lc=>{if(We.a(lc))this.ve.kH(lc,Ma);else{const Dc=this.ve.AP();Dc.Data=uf.hte(lc.Result);Ma(Dc)}},Ma):this.ve.rf(Ie.a.O0e,Ma)}}YLh(O,Ma){const Cb=O[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],lc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],
Dc=O.DdaMethod.ControlId,dd=Yf.getInstance(this.$);if(0>=lc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.ve.rf(Ie.a.ici,Ma);else if(lc>Yf.Xxi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.ve.rf(Ie.a.QWe,Ma);else{var kd=null;switch(Cb){case 1:kd="Compressed";break;case 0:kd="Text";break;case 2:kd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Cb} is not supported.`);
this.ve.rf(Ie.a.aRe,Ma);return}if("Text"===kd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${kd} is not supported.`),this.ve.rf(Ie.a.aRe,Ma);else{y.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(O=new Sys.StringBuilder,O.append(jg.a(this.$,kd)),"Pdf"===kd&&Qf.a.Yg(O,jf.a.CEd,"WholeWorkbook"),O=O.toString()):O=jg.a(this.$,kd);var sd=null,Gd=new XMLHttpRequest;Gd.onreadystatechange=()=>{if(4===Gd.readyState)if(200===Gd.status){var Vd=Gd.response;
if(Vd){sd=new Uint8Array(Vd);Vd=this.ve.AP();var Pe=sd.length,Se=Yf.nCi(),ef={},lg=0;for(let bg=0;bg<Pe;bg+=lc){const cg=[],Of=bg+lc<Pe?bg+lc:Pe;for(let mg=0,Ng=bg;Ng<Of;mg++,Ng++)cg[mg]=sd[Ng];ef[(lg++).toString()]=cg}ef=new Wf(Se,Pe,lc,ef);ef=dd.jAg(Dc,ef);ef!==Ie.a.success?this.ve.rf(ef,Ma):(Vd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Se,Vd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Pe,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${kd}, the file size is ${Pe}`),
Ma(Vd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${kd}.`),this.ve.rf(Ie.a.internalError,Ma)}else 500===Gd.status?this.ve.rf(Ie.a.GTe(parseInt(Gd.statusText,10)),Ma):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${kd}.`),this.ve.rf(Ie.a.VBi,Ma))};Gd.open("GET",O,!0);Gd.responseType="arraybuffer";Gd.setRequestHeader("If-Modified-Since","0");Gd.send(null)}}}ZLh(O,Ma){var Cb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],
lc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];O=O.DdaMethod.ControlId;(Cb=Yf.getInstance(this.$).aMh(O,Cb))?(Cb=Cb.KBj,0>lc||lc>=Object.keys(Cb).length?this.ve.rf(Ie.a.P7h,Ma):(lc=Cb[lc.toString()],Cb=this.ve.AP(),Cb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=lc,Cb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=lc.length,Ma(Cb))):this.ve.rf(Ie.a.internalError,Ma)}Q8i(O,Ma){var Cb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];O=
O.DdaMethod.ControlId;Cb=Yf.getInstance(this.$).P8i(O,Cb);Cb===Ie.a.success?this.ve.Zu(Ma):this.ve.rf(Cb,Ma)}ksj(O,Ma){O.DdaSetBindingData.CoerceType=uf.k1b(O.DdaSetBindingData.CoerceType);if(this.Kgc(O.DdaSetBindingData.CoerceType,Ma)){var Cb=this.Vbd(O.DdaMethod.ControlId);if(Cb){var lc=uf.aXc(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data),Dc=zg.g(this.$).ha;1===lc.CoerceType&&(!lc.Data&&Dc.sa.w4&&(lc.Headers||(lc.Headers=[]),lc.Headers.length||lc.Headers.push([]),lc.Headers[0].length||
lc.Headers[0].push("")),uf.Mdc(lc)||(lc.CellFormat||(lc.CellFormat=O.DdaSetBindingData.CellFormat),lc.TableOptions||(lc.TableOptions=O.DdaSetBindingData.TableOptions)));if(uf.Mdc(lc))this.ve.rf(Ie.a.Azc,Ma);else{var dd=Dc.sa.Wc.clone(),kd=Dc.sa.activeCell.clone();this.gA.ddaSetSelectedData(O.DdaMethod.ControlId,Cb,lc,sd=>{var Gd;if(We.a(sd))this.ve.kH(sd,Ma);else{sd=dd.clone();const Vd=lc.Headers?lc.Headers[0].length:lc.Data[0].length;1!==lc.CoerceType||lc.Data?1===lc.CoerceType&&(null===(Gd=lc.TableOptions)||
void 0===Gd?0:Gd.length)&&0==lc.TableOptions[0]?(sd.top+=1,sd.bottom=sd.top+lc.Data.length-1):sd.bottom=sd.top+lc.Data.length-(1===lc.CoerceType?0:1):sd.bottom=sd.top+1;sd.right=sd.left+Vd-1;Gd=sd.contains(kd)?kd:sd.topLeft;Dc.updateSelection(sd,Gd,0);this.ve.Zu(Ma)}},Ma)}}else this.ve.rf(Ie.a.Bve,Ma)}}addBinding(O,Ma,Cb,lc){Ma?this.gA.ddaAddBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,O.DdaBindingsMethod.BindingType,Ma,Cb,Dc=>{if(We.a(Dc))this.ve.kH(Dc,lc);else{const dd=this.ve.AP();
dd.Bindings=Array(1);dd.Bindings[0]=this.oe.VZb(Dc.Result);lc(dd)}},lc):this.ve.rf(Ie.a.mlj,lc)}OHh(O,Ma){this.gA.ddaGetBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Cb=>{if(We.a(Cb)||!Cb.Result)this.ve.kH(Cb,Ma);else{const lc=this.ve.AP();lc.Bindings=Array(1);lc.Bindings[0]=this.oe.VZb(Cb.Result);Ma(lc)}},Ma)}YMh(O){const Ma=this.ve.AP(),Cb={};Cb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ma[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=
Cb;O(Ma)}O8i(O,Ma){this.gA.ddaReleaseBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Cb=>{We.a(Cb)?this.ve.kH(Cb,Ma):this.ve.Zu(Ma)},Ma)}LGh(O,Ma){this.gA.ddaGetAllBindings(O.DdaMethod.ControlId,Cb=>{if(We.a(Cb))this.ve.kH(Cb,Ma);else{const lc=this.ve.AP();if(Cb.Result){Cb=Cb.Result;lc.Bindings=Array(Cb.length);for(let Dc=0;Dc<Cb.length;Dc++)lc.Bindings[Dc]=this.oe.VZb(Cb[Dc])}else lc.Bindings=null;Ma(lc)}},Ma)}bsd(O,Ma){this.gA.ddaLoadSettings(O.DdaMethod.ControlId,Cb=>{if(We.a(Cb))this.ve.kH(Cb,
Ma);else{const lc=this.ve.AP();lc.Properties=Cb.Result;Ma(lc)}},Ma)}saveSettings(O,Ma){const Cb={Settings:[]};for(let lc=0;lc<O.DdaSettingsMethod.Properties.length;lc++){const Dc={};Dc.Name=O.DdaSettingsMethod.Properties[lc][0];Dc.Value=O.DdaSettingsMethod.Properties[lc][1];Cb.Settings[lc]=Dc}this.gA.ddaSaveSettings(O.DdaMethod.ControlId,Cb,O.DdaSettingsMethod.OverwriteIfStale,lc=>{We.a(lc)?this.ve.kH(lc,Ma):this.ve.Zu(Ma)},Ma)}Oke(O,Ma){const Cb=uf.aXc(1,O.DdaAddRowsColumns.Data);uf.Mdc(Cb)?this.ve.rf(Ie.a.Azc,
Ma):this.gA.ddaAddRowsColumns(O.DdaMethod.ControlId,O.DdaAddRowsColumns.BindingId,O.DdaAddRowsColumns.IsRow,Cb,lc=>{We.a(lc)?this.ve.kH(lc,Ma):this.ve.Zu(Ma)},Ma)}qch(O,Ma){this.gA.ddaDeleteAllDataValues(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Cb=>{We.a(Cb)?this.ve.kH(Cb,Ma):this.ve.Zu(Ma)},Ma)}YWg(O,Ma){this.gA.ddaClearBindingFormats(O.DdaMethod.ControlId,O.DdaClearBindingFormats.BindingId,Cb=>{We.a(Cb)?this.ve.kH(Cb,Ma):this.ve.Zu(Ma)},Ma)}qXf(O,Ma){const Cb={},lc=O.DdaSetBindingFormats.IsSetFormats;
lc?Cb.CellFormat=O.DdaSetBindingFormats.CellFormat:Cb.TableOptions=O.DdaSetBindingFormats.TableOptions;this.gA.ddaSetBindingFormats(O.DdaMethod.ControlId,O.DdaSetBindingFormats.BindingId,Cb,lc,Dc=>{We.a(Dc)?this.ve.kH(Dc,Ma):this.ve.Zu(Ma)},Ma)}executeRichApiRequest(O,Ma){var Cb;const lc=O.ArrayData,Dc={},dd=zg.g(this.$).ha;if(lc){if("WacPartition"===lc[0]){this.Vvh(O,Ma);return}const Se=Object(L.a)(Jg.DdaFacade,Be.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===lc[0]){var kd=Se.en(O.DdaMethod.ControlId);
kd&&(kd.Bfc=!0,kd.uIf())}Dc.HttpMethod=lc[1];Dc.PathAndQuery=lc[2];Dc.RequestHeaders=uf.kYe(lc[3]);Dc.RequestBody=lc[4];Dc.AppPermission=lc[5];kd=lc[6];Dc.RequestFlags=kd;var sd=0;if(Eh.i(this.$.oa))switch(dd.Ke){case 1:sd=2;break;case 2:sd=3;break;case 128:sd=4;break;default:sd=1}var Gd=null;dd.Oa.UA&&(Gd=dd.Oa.UA.aj);Dc.SheetMultiRange=Ug.r(dd.sa.selectedRanges,this.$);Dc.ActiveCell=Ug.v(dd.sa.activeCell,this.$);Dc.ActiveChartId=Gd;Dc.SelectionState=sd;sd=this.oe.AY(O.DdaMethod.ControlId);Dc.InstanceId=
sd?sd.InstanceId:"";if(sd&&sd.PrimaryMarketplace){Gd=Jg.DdaFacade.getSolutionId(sd,this.$);let ef=sd.PrimaryMarketplace.MarketplaceType;if(ef===OSF.StoreType.InMemory){if(!sd.OwnerAddinSolutionId){this.ve.rf(Ie.a.pxb,Ma);return}if(sd.AssetMarketplace)ef=sd.AssetMarketplace.MarketplaceType;else{this.ve.rf(Ie.a.pxb,Ma);return}}else ef===OSF.StoreType.WopiCatalog&&(ef=OSF.StoreType.OMEX);let lg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd,ef,null===(Cb=sd.AssetMarketplace)||void 0===Cb?void 0:Cb.SolutionId,
null,null,sd.PrimaryMarketplace.MarketplaceRef);Dc.CompliantSolutionId=lg;Dc.SolutionId=Gd;Dc.MarketplaceType=ef;Dc.SolutionVersion=sd.PrimaryMarketplace.SolutionVersion;Dc.StoreLocation=sd.PrimaryMarketplace.MarketplaceRef}else Dc.SolutionId=Dc.MarketplaceType="",Dc.CompliantSolutionId="";Dc.IsEventsEnabled=void 0===Se||null===Se||Se.Yi.fZb(Dc.InstanceId);Dc.RequestGuid=Th.a.create().toString();Cb=Dc.RequestBody.length;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
Cb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.ve.rf(Ie.a.Fej,Ma);n.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Cb} exceeded the limit`);return}y.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&kd&4096&&(Cb=new Hf(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Cb,we,lc),Dc.RequestBody=lc[4])}const Vd=uf.r0e(Dc.RequestHeaders);uf.NBd++;const Pe=lj.a.Wa.Nb;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Dc&&Dc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Dc.RequestBody.length}`);this.gA.executeRichApiRequest(Dc,Se=>{var ef;this.zWf(Pe,!0,Se.ServerCorrelationId);var lg=null;let bg=null;var cg=Se.ServerCorrelationId;if(null===(ef=null===Se||void 0===Se?void 0:Se.Errors)||void 0===ef?0:ef[0])lg=Se.Errors[0].MessageIdName,bg=Se.Errors[0].Description,y.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&vj.a(this.$).fd.fJ(Se.Errors[0].MessageId);
if(We.a(Se)||!Se.Result)this.TMa(cg,Vd,"Server error",lg,bg),this.ve.kH(Se,Ma);else{let mg=null;if(y.EwaSettings.ma(258))if((ef=Se.Result)&&ef.length){for(let Og=0;Og<ef.length;Og++)if(ef[Og].RequestGuid===Dc.RequestGuid){mg=ef[Og];break}mg||this.ve.kH(Se,Ma)}else mg=Se.Result;else mg=Se.Result;if(!lg&&mg&&mg.ResponseBody&&mg.ResponseBody[0])if(Se=mg.ResponseBody[0],Se.startsWith('{"Error":')){1<mg.ResponseBody.length&&(Se=Se.substring(0,Se.indexOf("}")+1),Se+="}");try{var Of=w.a.Uh(Se);Of.Error&&
this.TMa(cg,Vd,"Pipeline error",Of.Error.Code,Of.Error.Message)}catch(Og){this.TMa(cg,Vd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.TMa(cg,Vd);else this.TMa(cg,Vd,"Server error",lg,bg);const Ng=(Of=mg.SheetMultiRange)?Of.SheetName:null;Se=mg.ActiveChartId;const Kg=mg.SelectionState;lg=5===Kg&&!!Of||6===Kg||7===Kg||8===Kg;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.$x&&lg)this.ve.rf(Ie.a.PBc,Ma),n.ULS.sendTraceTag(537163211,
0,50,`${Kg.toString()} is not allowed`);else if(5===Kg&&Of){if(this.$.xa&&Ng)if(this.$.xa.qk(Ng))this.aSc(Ng);else{let Og=null;Og=()=>{this.$.xa.qk(Ng)&&(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.aSc(Ng),this.$.xa.vHb(Og))};this.$.xa.pmb(Og);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Gh=null;Gh=()=>{this.$.xa.qk(Ng)&&(this.aSc(Ng),this.$.xa.gma(Gh))};this.$.xa.dga(Gh)}}}else if(6===Kg||7===Kg||8===
Kg||9===Kg){if(Of){const Og=Ug.g(Of.Ranges);if(Ng&&Ug.cb(Og,!0))if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.xa.qk(Ng)){let Gh=null;Gh=()=>{this.Rcg(dd,Og,Ng,Kg);this.$.xa.gma(Gh)};this.$.xa.dga(Gh)}else this.Rcg(dd,Og,Ng,Kg)}7===Kg?(Se="38.{"+wj.e(Se)+"}",ni.a(this.$).zma(0,Se,!0)):8===Kg&&ni.a(this.$).zma(2,Se,!0);9===Kg&&(this.$.ya.ApiCallToSetPageLayout=!0)}mg.PostProcessActions?this.$.Jef?(cg=w.a.Uh(mg.PostProcessActions),this.$Yi(cg).then(()=>
{this.Hbb(mg,Ma);this.$9c(O.DdaMethod.ControlId,Dc);return Promise.resolve(null)},Og=>{this.Hbb(mg,Ma,Og);return Promise.reject(Og)})):(this.TMa(cg,Vd,"Promise not supported",null,"Promise is not supported on this browser."),this.ve.rf(Ie.a.internalError,Ma)):this.Hbb(mg,Ma)}},Se=>{this.zWf(Pe,!1,null);this.TMa(null,Vd,"Web service error");Ma(Se)})}$9c(O,Ma){const Cb=Object(L.a)(Jg.DdaFacade,Be.a(this.$));(null===Cb||void 0===Cb?0:Cb.EKd)&&Cb.en(O)&&uf.$vj(Ma.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,
0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${O}; SolutionId: ${Ma.SolutionId}.`),Cb.EKd.Gkh(O))}Vvh(O,Ma){var Cb=this.oe.AY(O.DdaMethod.ControlId);const lc=Jg.DdaFacade.getSolutionId(Cb,this.$);var Dc=null;Dc=Jg.DdaFacade.kua(Cb,this.$);Dc=new ei(Dc,this.$);Dc=new kj(lc,O.DdaMethod.ControlId,this.oe,this.$,Dc);const dd={ResponseHeaders:[]};dd.ResponseBody=Array(1);Cb=uf.kYe(O.ArrayData[3]);const kd=uf.r0e(Cb);Cb=new Rd(this.$.ya.CreateWorkbookMaxAllowedBase64Size,
this.Dqf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Dc,Xc,Cb,O.ArrayData).then(sd=>{if(!sd)return this.Rsd(!1,"The rich api executor call failed",kd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),dd.ResponseStatusCode=500,this.Hbb(dd,Ma),null;this.Rsd(!0,"The rich api executor call succeeded",kd);dd.ResponseStatusCode=sd[0];dd.ResponseBody[0]=sd[2];this.Hbb(dd,Ma);return null},sd=>{dd.ResponseStatusCode=400;dd.ResponseBody[0]=sd.toString();this.Rsd(!1,"The rich api executor call failed",
kd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${lc}`);this.Hbb(dd,Ma);return null})}zWf(O,Ma,Cb){uf.NBd--;O=pj.a(lj.a.Wa,O);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${O}, requests pending:${uf.NBd}, request result:${Ma?"success":"false"}, server correlationid: ${Cb}.`)}Hbb(O,Ma,Cb=null){const lc=Array(3);lc[0]=O.ResponseStatusCode;lc[1]=uf.fXh(O.ResponseHeaders);const Dc=[];var dd=!1;if(Cb&&O.ResponseBody){const kd=
w.a.Uh(O.ResponseBody.join(""));kd.Error||(dd={},dd.Error=Cb,dd.TraceIds=kd.TraceIds,dd.ProcessedResults={},dd.ProcessedResults.Results=kd.Results,Dc[0]=w.a.Ac(dd),dd=!0)}lc[2]=dd?Dc:O.ResponseBody;O=this.ve.AP();O.Data=lc;Ma(O)}Nvd(O,Ma){(new Kf(this.$,this.ve,this.gA)).Nvd(O,Ma)}vzi(O,Ma){n.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Cb=O[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],lc=O[Nd.a.$Tc],Dc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];O=this.$.da.za(232).H0a.wzi(O.DdaMethod.ControlId,
Cb,lc,Dc);O===Ie.a.success?this.ve.Zu(Ma):(n.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.ve.rf(O,Ma))}rzi(O,Ma){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Cb=O[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],lc=O[Nd.a.$Tc],Dc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).H0a.lmj(O.DdaMethod.ControlId,Cb,lc,Dc);this.ve.Zu(Ma)}getAccessToken(O,Ma){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Cb=(Dc,dd)=>
{var kd;if(Dc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Dc=this.ve.AP(),Dc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=dd.accessToken,Ma(Dc);else{dd=this.oe.AY(O.DdaMethod.ControlId);let sd=null!==dd.OwnerAddinStoreType?dd.OwnerAddinStoreType:dd.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Dc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Jg.DdaFacade.getSolutionId(dd,this.$),sd,null===(kd=dd.AssetMarketplace)||
void 0===kd?void 0:kd.SolutionId,null,null,dd.PrimaryMarketplace.MarketplaceRef),["storeType"]:sd})}.`);this.ve.rf(Dc,Ma)}},lc=!y.EwaSettings.ma(23);Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),Dc=>{const dd=this.oe.Qh,kd=Cc.getInstance();di.AppsForOfficeSingleSignOnManager.getInstance(dd,Dc.result,kd).getAccessToken(O.DdaMethod.ControlId,lc,O,Cb)},this.$.la)}getAuthContext(O,Ma){Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>
{var Cb=this.oe.Qh.getOsfControl(O.DdaMethod.ControlId);if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Cb.isFirstParty()){Cb=Cb.getManifest();var lc=Cb.getMarketplaceID(),Dc=Cb.getWebApplicationId(),dd=Cb.getWebApplicationMsaId();wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(lc).then(kd=>{const sd=this.ve.AP(),Gd={};Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Dc;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
dd||Dc;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=kd.upn;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=kd.userId;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=kd.authority;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Bc.a.xHh(kd.authorityType);Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=kd.isAnonymous;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=kd.tenantId;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
kd.supportsAuthToken;sd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Gd;Ma(sd)},kd=>{const sd=this.ve.AP(),Gd={},Vd=new Bc.a;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Dc;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=dd||Dc;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Vd.upn;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Vd.userId;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Vd.authority;
Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Vd.authorityType;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Vd.isAnonymous;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Vd.tenantId;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=kd;Gd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Vd.supportsAuthToken;sd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Gd;sd.Error=1;Ma(sd)})}},this.$.la)}sfi(O){const Ma=
zg.g(this.$).ha;return 16===Ma.Ke&&!!Ma.Oa.$b&&!!Ma.Oa.$b.floatingObject&&lh.a.equals(Ma.Oa.$b.floatingObject.id,O,!0)}Vbd(O){const Ma=zg.g(this.$).ha;return Ma.sa.xg?1===Ma.Ke||this.sfi(O)?Ma.sha:null:null}Kgc(O,Ma){return 1!==O&&2!==O&&3!==O?(this.ve.rf(Ie.a.Kye,Ma),!1):!0}Rsd(O,Ma,Cb){const lc={};lc.a=this.$.ya.UserSessionId;lc.b=O;lc.c=Ma;lc.d=null;lc.e=Cb;pg.b().Ie(37,lc)}TMa(O,Ma,Cb=null,lc=null,Dc=null){const dd={};O&&(dd.ServerCorrelationId=O);void 0!==Ma&&null!==Ma&&(dd.Source=Ma);Cb&&(dd.ErrorType=
Cb);lc&&(dd.MessageId=lc);Dc&&(dd.StatusDescription=Dc);y.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&lc&&"ExternalDataRefreshFailed"===lc&&(dd.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,w.a.Ac(dd))}$Yi(O){let Ma=new Promise(Cb=>{Cb(null)});for(let Cb=0;Cb<O.length;Cb++)Ma=this.ZYi(Ma,O[Cb]);return Ma}ZYi(O,Ma){if(!Ma)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),O.then(()=>Promise.reject(uf.C2a(kh.generalException,nd.a.instance.ga(1757),
null)));switch(Ma.actionType){case 1:case 2:O=O.then(()=>{const Cb=Object(L.a)(Jg.DdaFacade,Be.a(this.$));if(Cb.en(Ma.controlId))switch(Cb.Yi.p1h(Ma),Ma.messageType){case 14:case 100:Cb.DKd.CZb(Ma);break;case 11:case 12:Cb.uhj.znb(Ma);break;case 51:case 52:Cb.shj.znb(Ma);break;case 2101:case 2102:Cb.thj.znb(Ma);break;case 2E3:Cb.vhj.CZb(Ma);break;case 2201:this.$.Uja&&Cb.EKd.tLg(Ma);break;case 2203:Cb.whj.uLg(Ma);break;case 2700:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Cb.CKd.CZb(Ma)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ma.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:O=O.then(()=>{this.b1h(Ma);return Promise.resolve(null)});break;case 15:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(O=O.then(()=>{this.H2h(Ma);return Promise.resolve(null)}));break;case 4:O=O.then(()=>{if(y.EwaSettings.ma(104)){var Cb=zg.g(this.$).ha.sa.activeCell;Cb.top!==Ma.row+1&&Cb.left!==Ma.column+1&&(Cb=Ug.v(Ve.Range.Tc(Ma.row+
1,Ma.column+1),this.$),zg.g(this.$).vg(Cb,null,null,null,3,vf.a.abh));Ih.a(this.$,243,242,0,lc=>{lc.Jcb(Ma.row+1,Ma.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:O=O.then(()=>{Object(L.a)(Jg.DdaFacade,Be.a(this.$)).Yi.xJe(Ma.controlId,Ma.isEnableEvents);return Promise.resolve(null)});break;case 5:O=O.then(()=>this.v$g(Ma));break;case 6:O=O.then(()=>this.kUi(Ma));break;case 8:O=O.then(()=>{y.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(L.a)(Jg.DdaFacade,Be.a(this.$)).XWg();const Cb=new tj.a(uj.a.Jj,5,null);sj.a(this.$).ks(Cb);return Promise.resolve(null)});break;case 9:O=O.then(()=>this.coj(Ma));break;case 10:O=O.then(()=>this.eXj(Ma));break;case 11:O=O.then(()=>this.dXj());break;case 12:O=O.then(()=>this.aXj());break;case 13:O=O.then(()=>this.bXj(Ma));break;case 14:O=O.then(()=>this.cXj(Ma));break;case 16:O=O.then(()=>Promise.resolve(Ma));break;case 17:O=O.then(()=>this.lkj(Ma,Object(L.a)(Jg.DdaFacade,Be.a(this.$))));break;
case 18:zg.g(this.$).focus();break;case 19:this.F3e(Ma.entryType,!1,Ma.options);break;case 20:this.F3e(Ma.entryType,!0,Ma.options);break;default:O=O.then(()=>Promise.reject(uf.C2a(kh.SIg,nd.a.instance.ga(1758),null)))}return O}H2h(O){var Ma=Object(L.a)(Jg.DdaFacade,Be.a(this.$)).en(O.controlId);if(Ma&&!(0===O.operationType^!Ma.Rca)){zg.g(this.$).igc=!0;switch(O.operationType){case 0:var Cb=new rj.a(document.createElement("input"));Cb.text=O.range;Ma.W$h(zg.g(this.$).Cf.R8g(Cb,new oj.a(this.$)));Ma.Rca.startEdit(!0);
break;case 1:Ma.tOf();this.rangePicker=null;break;case 2:Ma.Rca.fdg(O.range);break;case 3:Ma.Rca.fdg(O.startingRange);Ma=O.expandSelection;Cb=O.getNextDataRegionCell;let lc=0;switch(O.keyboardDirectionValue){case 2:lc=38;O=Ma&&Cb?105288353:Ma?-31900117:Cb?542791952:137938150;break;case 3:lc=40;O=Ma&&Cb?-1297307319:Ma?-1603798598:Cb?1713663844:-798660877;break;case 0:lc=37;O=Ma&&Cb?-403586027:Ma?2039316657:Cb?-2012742350:-1470715894;break;case 1:lc=39;O=Ma&&Cb?784916030:Ma?589730764:Cb?1324884057:
-1231471547;break;default:O=1461300262}Ma=this.U2b("keydown",lc,Ma,Cb);zg.g(this.$).vIb(Ma,new ug.a(O,1,0,8,null))}zg.g(this.$).igc=!1}}U2b(O,Ma,Cb,lc){const Dc=document.createEvent("KeyboardEvent");if(oc.a.vF)Dc.initKeyboardEvent(O,!1,!1,window.self,"A",0,lc,!1,Cb,!1);else{let dd="";Cb&&(dd+="Shift");lc&&(dd+=0<dd.length?" Control":"Control");Dc.initKeyboardEvent(O,!1,!1,window.self,"A",0,dd,!1,"en-US")}O=new Sys.UI.DomEvent(Dc);O.keyCode=Ma;return O}b1h(O){switch(O.operationType){case 1:Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(this.$.da,
153,this.$.la,1),Ma=>{Ma.result.AJd()},this.$.la,3);break;case 2:if(O=Object(L.a)(Jg.DdaFacade,Be.a(this.$)).en(O.controlId))O.Bfc=!0,O.uIf()}}v$g(O){const Ma=O.fileBase64;return Ma&&Ma.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(uf.C2a(kh.invalidArgument,nd.a.instance.ga(1761),"Application.CreateWorkbook")):(new Promise((Cb,lc)=>{const Dc=new qc.StandardDialog;Dc.Sb=4;Dc.yl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,dd=>{2!==
dd&&0!==dd||lc(uf.C2a(kh.QAd,nd.a.instance.ga(1760),"Application.CreateWorkbook"));dd=new Sc("blank","agave",Ma?"streamBase64":"streamEmpty",Ma);this.Dqf.create(Cb,lc,dd).V_a()})})).then(Cb=>{this.B7b.set(O.fakeFileId,Cb);return Promise.resolve(null)},Cb=>Cb?Promise.reject(Cb):Promise.reject(uf.C2a(kh.generalException,nd.a.instance.ga(1757),"Application.CreateWorkbook")))}kUi(O){return new Promise((Ma,Cb)=>{if(this.B7b.has(O.fakeFileId)){const lc=this.B7b.get(O.fakeFileId);Cb=new qc.StandardDialog;
Cb.Sb=4;Cb.yl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Dc=>{1===Dc&&Nh.HelperMethods.Ve(lc,void 0,void 0,"DdaMethodHandler.fileUrl");Ma(null)})}else Cb(uf.C2a(kh.generalException,nd.a.instance.ga(1757),"Document.Open"))})}coj(O){return new Promise(Ma=>{Object(L.a)(Jg.DdaFacade,Be.a(this.$)).eTf=O.runtimeCalculationMode;const Cb=this.$.da.za(268);Cb&&Cb.Nwd(3===O.runtimeCalculationMode);Ma(null)})}eXj(O){Zf.a.Fzb(this.$)&&this.$.da.za(331).Ibb(0,
O.urlStr,!0,!0,null);return Promise.resolve(null)}dXj(){Zf.a.Fzb(this.$)&&this.$.da.za(331).Ibb(1,null,!0,!0,null);return Promise.resolve(null)}aXj(){Zf.a.Fzb(this.$)&&this.$.da.za(331).uJe();return Promise.resolve(null)}bXj(O){Zf.a.Fzb(this.$)&&this.$.da.za(331).Ibb(5,O.urlStr,!0,!0,null);return Promise.resolve(null)}cXj(O){if(Zf.a.Fzb(this.$)){const Ma=this.$.da.za(331);for(const Cb of Ma.D$)Cb.IsActive&&Cb.HostEditUrl&&Cb.UrlStr===O.hostEditUrlStr&&Nh.HelperMethods.Ve(Cb.HostEditUrl,"_blank")}return Promise.resolve(null)}lkj(O,
Ma){const Cb=Cf.a.bW;O=w.a.Uh(O.payload);const lc={};"eventId"in O&&"payload"in O&&(lc.eventId=O.eventId,lc.payload=O.payload);Ma.zM(2201,Cb,w.a.Ac(lc));return Promise.resolve(null)}F3e(O,Ma,Cb){const lc=this.$.da.za(5);lc&&(O=this.qIh(O))&&(Ma?lc.removeEntry(O):lc.Ake(O,Cb))}qIh(O){switch(O){case 0:return 65}}aSc(O){O=Object(L.a)(qj.a,this.$.xa.getItemByName(O));(null===O||void 0===O?0:O.visible)&&O.activate(!0)}Rcg(O,Ma,Cb,lc){var Dc=O.sa.Wr;const dd=Dc<Ma.length&&Ma[Dc].contains(O.sa.activeCell);
O=dd?O.sa.activeCell:Ma[0].topLeft;Dc=dd?Dc:0;zg.g(this.$).HU(Ma,Dc,Cb,null,O,null,null,3,vf.a.bbh,void 0,void 0,void 0,6===lc)}static get Xah(){uf.Toa||(uf.Toa={},uf.Toa[Microsoft.Office.WebExtension.CoercionType.Table]=1,uf.Toa[Microsoft.Office.WebExtension.CoercionType.Text]=2,uf.Toa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,uf.Toa[Microsoft.Office.WebExtension.CoercionType.Html]=4,uf.Toa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return uf.Toa}static get $ah(){uf.Egb||(uf.Egb=
{},uf.Egb[Microsoft.Office.WebExtension.FilterType.All]=1,uf.Egb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return uf.Egb}static get dbh(){uf.Fgb||(uf.Fgb={},uf.Fgb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,uf.Fgb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return uf.Fgb}static kYe(O){if(!O||!O.length)return null;const Ma=Array(O.length/2);for(let Cb=0;Cb<O.length/2;Cb++)Ma[Cb]={},Ma[Cb].Name=O[2*Cb],Ma[Cb].Value=O[2*Cb+1];return Ma}static fXh(O){if(!O||!O.length)return null;
const Ma=Array(2*O.length);for(let Cb=0;Cb<O.length;Cb++)Ma[2*Cb]=O[Cb].Name,Ma[2*Cb+1]=O[Cb].Value;return Ma}static o$c(O){if(!O||!O.length)return null;const Ma=Array(O.length);for(let Cb=0,lc=O.length;Cb<lc;Cb++){const Dc=O[Cb].length;if(Dc){Ma[Cb]=Array(Dc);for(let dd=0;dd<Dc;dd++)Ma[Cb][dd]=null==O[Cb][dd]?null:O[Cb][dd].toString()}else return null}return Ma}static k1b(O){return"string"===typeof O?ej.a.Yp(uf.Xah,O,0):O}static mRe(O){return"string"===typeof O?ej.a.Yp(uf.$ah,O,0):O}static weg(O){return"string"===
typeof O?ej.a.Yp(uf.dbh,O,0):O}static Efi(O){switch(O.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static aXc(O,Ma){const Cb={};Cb.CoerceType=O;1===Cb.CoerceType?(Cb.Data=uf.o$c(Ma.Rows),Cb.Headers=uf.o$c(Ma.Headers)):Cb.Data=uf.o$c(Ma);return Cb}static hte(O){return 1===O.CoerceType?{["Headers"]:O.Headers,["Rows"]:O.Data}:O.Data}static Mdc(O){return 1===O.CoerceType?!O.Data&&!O.Headers:!O.Data}static r0e(O){let Ma="Unknown";if(!O)return Ma;
for(let Cb=0;Cb<O.length;Cb++)if(O[Cb].Name.toLowerCase()===jf.a.xhj){Ma=O[Cb].Value;break}return Ma}static $vj(O){if(!O)return!1;const Ma=jf.a.lEi.toLowerCase();for(let Cb=0;Cb<O.length;Cb++)if(O[Cb].Name.toLowerCase()===Ma)return!0;return!1}static C2a(O,Ma,Cb){const lc={};lc.Code=O;lc.Message=Ma;lc.Location=Cb;lc.ActionIndex=0;return lc}}uf.Toa=null;uf.Egb=null;uf.Fgb=null;uf.NBd=0;Object(e.a)(uf,"DdaMethodHandler",null,[188,3]);class fj extends Bd.a{constructor(O){super(O)}Dd(){const O=qf.GetServiceTaskFactory.create(this.$.da,
106,this.la,this.ib),Ma=qf.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ib),Cb=vh(this.la,this.ib);Gf.TaskExtensions.Aa(Gf.TaskExtensions.Xd([O,Ma,Cb],this.la),()=>{const Dc=O.result,dd=wc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.ld([new uf(this.$,Dc,dd)])},this.la,3);const lc=wc.a.instance;Gf.TaskExtensions.Aa(qf.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.ib),()=>{lc.register(ti,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").uc().Gc(()=>
new ti)},this.$.la)}static ka(O){Bd.a.Rd(82,new fj(O))}}Object(e.a)(fj,"DdaCommandHandlerFactory",Bd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Di("");c.a.Di(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");
Object(b.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(d.a)();(()=>{f.a.Fa(O=>{zf.ka(O)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(rg.a)();Object(ng.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(O=>{y.EwaSettings.ma(53)&&xi.ka(O)})})();(()=>{f.a.Fa(O=>{y.EwaSettings.ma(121)&&Ph.ka(O)})})();f.a.Fa(Vg.ka);f.a.Fa(Bi.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(O=>{Uh.ka(O);$h.ka(O);qi.ka(O)})})();f.a.Fa(fj.ka)},1450:function(t,D,a){t=a(0);var c=a(184),b=a(95);class d{constructor(){this.tIe=this.displayName=this.Spb=this.Do=this.yB=null;this.isUpgraded=!1}qff(e,k){return this.yB.getStoreType().toLowerCase()===e.toLowerCase()&&this.yB.getSolutionId().toLowerCase()===k.toLowerCase()}}Object(t.a)(d,"AddinCommandsResourceItem",null,[]);a.d(D,"a",function(){return f});class f{constructor(){this.MCc=
null;this.AHc=0;this.gJc=!1;this.eb=new b.a;this.Opg=new c.a}cDg(e){this.eb.addHandler("AddinCommandsLoadingMessageChanged",e)}y$i(e){this.eb.removeHandler("AddinCommandsLoadingMessageChanged",e)}get $Xa(){return this.MCc}gcb(e){e!==this.MCc&&(this.MCc=e,this.eb.raiseEvent("AddinCommandsLoadingMessageChanged"))}Ynj(){this.AHc++;this.$Xa||this.gcb(CommonUIStrings.l_LoadingAddInsTitle)}fNd(){this.AHc--;this.esd()&&(this.gJc?this.$Xa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.gcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.gcb(null))}jYf(e=!1){this.gJc=!0;this.gcb(e?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}dxe(){this.gJc=!1;this.esd()?this.gcb(null):this.gcb(CommonUIStrings.l_LoadingAddInsTitle)}esd(){return 0>=this.AHc}get W4a(){return this.Opg}aia(e,k,l=0){for(let m of this.W4a)if(m.qff(e,k)&&(!m.Do||m.Do.NFh===l))return m;return null}tke(e,k,l,m){const v=new d;v.yB=e;v.Do=k;v.Spb=l;v.displayName=m;this.W4a.add(v)}fBg(e,k,l,m){const v=new d;v.yB=
e;v.Do=k;v.Spb=null;v.tIe=l;v.displayName=m;this.W4a.add(v)}X8i(e,k){let l=0;for(let m of this.W4a)m.yB.getStoreType()===e&&m.yB.getSolutionId()===k?this.W4a.removeAt(l):l++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(t.a)(f,"AddinCommandsResourceManager",null,[])},729:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);var c=a(34);class b{static get tzi(){return b.N$d||(b.N$d={["-2002156328"]:b.Kye,["-1954750170"]:b.O0e,["317650254"]:b.NYg,["-1005263101"]:b.bci,["1353664579"]:b.Elj,
["159671765"]:b.cci,["1446690022"]:b.QWe,["1150069548"]:b.Azc,["-1409306331"]:b.Bve,["338507772"]:b.CEe,["-457159301"]:b.ZUi,["-1037701970"]:b.yah,["-1893322318"]:b.hci,["965579896"]:b.Aah,["93287890"]:b.zah,["358088857"]:b.Noj,["-1223650923"]:b.CEe,["2007306190"]:b.PUg,["1549955423"]:b.nse,["-1275974171"]:b.gci,["382101082"]:b.nUi,["-898776235"]:b.eBi,["335464256"]:b.UAi,["1677378049"]:b.fci,["-261992848"]:b.jOj,["-980820954"]:b.nse,["-931375837"]:b.mUi,["929186550"]:b.hih,["-982144310"]:b.V0i,["-785741187"]:b.$bi,
["2125217573"]:b.jci,["299124955"]:b.aci,["1669853884"]:b.Mhj,["-1515932330"]:b.OYg,["314621024"]:b.eCh,["-300049690"]:b.TUg,["14766835"]:b.Ntj,["-1251992761"]:b.yHe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.MEa,["49173765"]:b.MEa,["-907155566"]:b.MEa,["-1201603824"]:b.MEa,
["1541165282"]:b.MEa,["-1347753427"]:b.MEa,["134912532"]:b.MEa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static GTe(d){return c.a.Yp(b.tzi,d.toString(),b.internalError)}}b.success=0;b.Kye=1E3;b.O0e=1001;b.NYg=1002;b.bci=1003;b.Elj=1004;b.cci=1005;b.QWe=1008;b.aRe=1009;b.invalidSheetName=1014;b.Azc=2E3;b.Bve=2001;b.CEe=2002;b.ZUi=2003;b.yah=2004;b.hci=2005;b.Aah=2007;b.zah=2008;b.Noj=2009;b.PUg=2014;b.mlj=3E3;b.nse=3002;b.gci=3004;b.nUi=3005;b.eBi=3006;b.UAi=3007;b.fci=3008;b.jOj=3009;b.mUi=
3010;b.Ntj=4002;b.UAd=5E3;b.internalError=5001;b.yHe=5002;b.pxb=5004;b.jPj=5007;b.P7h=5008;b.invalidOrTimedOutSession=5012;b.PBc=5016;b.MEa=5102;b.Fej=5103;b.responsePayloadSizeLimitExceeded=5104;b.lUg=7001;b.n4f=7002;b.hih=8E3;b.V0i=8001;b.$bi=8010;b.jci=8011;b.aci=8012;b.Mhj=8020;b.OYg=8021;b.eCh=8022;b.TUg=8023;b.$yi=11E3;b.VBi=11001;b.ici=11002;b.N$d=null;Object(t.a)(b,"DdaErrorIds",null,[])},730:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.CRc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.QAd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.mPj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.$Gg="AddinIsAlreadyRequestingToken";c.ggj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.K1g=
"ControlIdNotFound";c.Xgj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(t.a)(c,"ErrorCodes",null,[])},732:function(t,D,a){a.r(D);var c=a(0),b=a(7),d=a(15),f=a(1294),e=a(83),k=a(95);class l{constructor(I,xa,Ua){this._id=I;this.xjg=xa;this.Klg=Ua;this.K$e=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get ZGg(){return this.xjg}get rZg(){return this.Klg}execute(I,
xa,Ua){Ua=Ua||{};Ua.commandMode=this.K$e;xa.invokeAppCommand(this.ZGg,this.rZg,Ua,()=>{I.LNi(this.id)})}}Object(c.a)(l,"AddinNativeActionBase",null,[765]);class m extends l{constructor(I,xa){super(1,I,xa);this.K$e=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",l,[]);class v{n3g(I){return new l(3,I,this.uGh().getNativeActionName(3))}uGh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(v,"AddinNativeActionManager",null,[753]);var n=
a(144);class w{invokeAppCommand(I,xa,Ua,vb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,xa,Ua,vb)}static getInstance(){w.Ma||(w.Ma=new w);return w.Ma}}w.Ma=null;Object(c.a)(w,"OSFAddinCommandsRuntimeManager",null,[752]);var r=a(4),u=a(178),x=a(27);class z extends n.a{constructor(I,xa,Ua){super();this.z8=null;this.EQc="WACDialogTitleText";this.rea="0";this.fCa="15px";this.$lg="0px";this.qea="calc(100% - 30px)";this.Zlg="100%";this.nde=0;this.eb=new k.a;this.zjg=new v;this.Sb=5;this.Ae=
this.nCa=Ua;this.PFc=I;this.D3d=xa;this.fGc=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}mFg(I){this.eb.addHandler("OnDialogClosedEventKey",I)}Jqj(){this.vDa=null}Lz(){super.Lz();this.Jk.style.width="100%";this.Jk.style.height=this.Lbc?this.qea:this.Zlg;this.Jk.style.marginTop=this.Lbc?this.fCa:this.$lg;this.Jk.style.padding=this.rea}tI(){super.tI();this.vb.style.width=String.format("{0}px",this.PFc*window.innerWidth/100);this.vb.style.height=
String.format("{0}px",this.D3d*window.innerHeight/100);this.vb.style.minWidth="0px";this.fGc&&r.AFrameworkApplication.isRtl&&100===this.PFc&&(this.vb.style.right="0px",this.vb.style.marginRight="0px");this.z8=document.getElementById(this.ei(this.EQc));this.z8.style.position="absolute";this.z8.style.whiteSpace="nowrap";this.z8.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.z8.style.right="14px",this.z8.style.left="44px"):(this.z8.style.right="44px",this.z8.style.left="14px")}xv(I){super.xv(I);
this.z8&&this.z8.setAttribute("title",I)}get ata(){return this.Jk}GJd(){this.vb.style.width=String.format("{0}px",this.PFc*window.innerWidth/100);this.vb.style.height=String.format("{0}px",this.D3d*window.innerHeight/100);this.vb.style.overflowY="hidden";this.vb.style.overflowX="hidden";this.vb.style.marginTop="";this.vb.style.top="";x.a.g4&&r.AFrameworkApplication.isRtl?(this.vb.style.right="",this.vb.style.marginRight=""):(this.vb.style.left="",this.vb.style.marginLeft="")}hide(){this.zjg.n3g(this.nCa).execute(this,
w.getInstance(),{});this.nde=window.setTimeout(()=>{this.eb.raiseEvent("OnDialogClosedEventKey",this.nCa);u.a.prototype.hide.call(this)},500)}LNi(I){3===I&&(window.clearTimeout(this.nde),this.eb.raiseEvent("OnDialogClosedEventKey",this.nCa),super.hide())}}Object(c.a)(z,"AppsForOfficeDialog",n.a,[724,725]);class B{constructor(){this.dialog=this.Ae=null}}Object(c.a)(B,"DialogInfo",null,[]);class y{}y.url="url";y.height="height";y.width="width";y.c5c="displayInIframe";y.icc="hideTitle";Object(c.a)(y,
"DialogSettings",null,[]);class A{constructor(){this.height=this.width=0;this.Ae=this.controlId=this.pageUrl=null;this.icc=this.c5c=!1}}Object(c.a)(A,"DisplayDialogParams",null,[]);class K extends Sys.EventArgs{constructor(I,xa,Ua=null,vb="",cb=""){super();this.controlId=I;this.messageType=xa;this.messageContent=Ua;this.messageOrigin=vb;this.targetOrigin=cb}}Object(c.a)(K,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class G extends Sys.EventArgs{constructor(I,xa,Ua=null,vb="",cb=""){super();this.controlId=
I;this.messageType=xa;this.messageContent=Ua;this.messageOrigin=vb;this.targetOrigin=cb}}Object(c.a)(G,"OnMessageParentEventArgs",Sys.EventArgs,[]);var T=a(41),W=a(29),P=a(171),E=a(99);class H{constructor(I){this.eb=new k.a;this.Rm=I}uFg(I){this.eb.addHandler("OnMessageParentEventKey",I)}tFg(I){this.eb.addHandler("OnMessageDialogEventKey",I)}showDialog(I,xa,Ua,vb){if(H.r7.lb(xa))d.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ua(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const Zd=T.b(I),Xd=Zd[y.url];if(this.Rm.getOsfControl(xa).checkAppDomains(Xd)){var cb=new A;cb.width=Zd[y.width];cb.height=Zd[y.height];cb.pageUrl=Xd;cb.c5c=Zd[y.c5c];cb.icc=Zd[y.icc];cb.controlId=xa;cb.Ae=P.a.create().toString();var Xb=new B;Xb.Ae=cb.Ae;var rc=this.Rm.getOsfControl(cb.controlId).getManifest().getDefaultDisplayName(),Ec=this.Rm.getOsfControl(cb.controlId).getStoreType().toLowerCase();I=null;var ed=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);I=(4===r.AFrameworkApplication.ta.Pa.xj&&"hardcodedpreinstall"===Ec||ed&&"sdxcatalog"===Ec)&&cb.icc?this.createAndShowAppsForOfficeDialog(cb.width,cb.height,cb.Ae,!0,rc):this.createAndShowAppsForOfficeDialog(cb.width,cb.height,cb.Ae,!1,rc);var ud=this.Rm.getOsfControl(cb.controlId),Kd=ud.getManifest();ed={};ed.id=cb.Ae;ed.solutionId=ud.getSolutionId();ed.version=ud.getVersion();ed.storeType=Ec;ed.storeId=ud.getStoreId();ed.assetId=ud.getAssetId();ed.assetStoreId=ud.getAssetStoreId();ed.ownerAddinSolutionId=
ud.getOwnerAddinSolutionId();ed.ownerAddinStoreType=ud.getOwnerAddinStoreType();ed.appDomains=Kd.getAppDomains();ed.dialogUrl=Xd;ed.osfControlType=1;ed.agaveName=rc;ed.div=I.ata;d.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ed.solutionId,ed.ownerAddinStoreType||ed.storeType,ed.assetId,null,null,ed.storeId),W.a.Xv(cb.pageUrl));this.Rm.insertDialogControl(ed);I.mFg(Object(e.a)(this,this.ZHi,"onDialogClosed"));Xb.dialog=
I;H.r7.ia(cb.controlId,Xb);vb&&vb(ed);Ua(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else d.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ua(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Zd){d.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Zd.message),Ua(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}wzi(I,xa,Ua,vb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===vb&&(vb=Ua);try{const cb=this.kJa(I);cb&&this.eb.raiseEvent("OnMessageParentEventKey",new G(cb,OSF.DialogMessageType.DialogMessageReceived,xa,Ua,vb))}catch(cb){return d.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",cb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}opb(I,xa){if(H.r7.lb(I))try{const Ua=H.r7.na(I);Ua.dialog&&Ua.dialog.hide();this.Rm.purgeDialogControl(Ua.Ae);
H.r7.remove(I);xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ua){d.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ua.message),xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else d.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}lmj(I,xa,Ua,vb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===vb&&(vb=Ua);if(H.r7.lb(I)&&(I=H.r7.na(I),I.dialog))try{this.eb.raiseEvent("OnMessageDialogEventKey",new K(I.Ae,OSF.DialogMessageType.DialogParentMessageReceived,xa,Ua,vb))}catch(cb){d.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",cb.message)}}kJa(I){let xa=null;for(let Ua of H.r7)if(Ua.value.Ae===I){xa=Ua.key;break}return xa}ZHi(I,xa){if(I=this.kJa(xa))this.Rm.purgeDialogControl(xa),H.r7.remove(I),this.eb.raiseEvent("OnMessageParentEventKey",
new G(I,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(I,xa,Ua,vb,cb){I=new z(I,xa,Ua);cb=vb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,cb);vb&&(I.Lbc=!1,I.it=!1);I.initializeAndShow(cb,null,null);I.Jqj();return I}static g_h(){return H.r7}static getInstance(I){H.Ma||(H.Ma=new H(I));return H.Ma}}H.Ma=null;H.r7=new E.a;Object(c.a)(H,"AppsForOfficeDialogManager",null,[714]);var F=a(842),N=a(1306),J=a(1383),R=a(931),M=a(716),L=a(197),U=a(1307),
X=a(119),da=a(82),fa=a(86),S=a(636),ka=a(548),V=a(680),wa=a(84),ma=a(412),ab=a(156),ba=a(184),Ca=a(38),Na=a(5),za=a(858),la=a(1225),aa=a(78);class sa{constructor(){this.command=0;this.properties=null}}Object(c.a)(sa,"DdaRequestInfo",null,[]);var ea=a(729),Z=a(77);class ua extends aa.a{constructor(I,xa){super();this.requests=[];this.disposed=this.i0b=!1;this.Jf=()=>{if(!this.disposed){this.grid.Wb.Al(this.Jf);this.i0b=!1;const Ua=this.requests;this.requests=[];for(let vb of Ua)this.ddaFacade.aK(vb.command,
vb.properties)}};this.ddaFacade=I;this.grid=xa}hch(I,xa){this.disposed||(this.i0b||(this.grid.Wb.jm(this.Jf),this.i0b=!0),this.requests.push(Object(b.a)(new sa,{command:I,properties:xa})))}dispose(){if(!this.disposed){this.disposed=!0;this.i0b&&this.grid.Wb.Al(this.Jf);var I=this.requests;this.requests=null;for(let xa of I)(I=xa.properties?xa.properties[Z.a.E2]:null)&&this.ddaFacade.rf(ea.a.pxb,I);this.ddaFacade=this.grid=null;super.dispose()}}static uZg(I,xa){var Ua=!1;974713501===I&&(xa=(I=xa?xa[Z.a.Zf]:
null)?I.DdaMethod:null)&&xa.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Ua=I.ArrayData,Ua=!!Ua&&64===(Ua[6]&64));return Ua}}Object(c.a)(ua,"DdaCellEditDelayRequestHandler",aa.a,[]);var ya=a(761);class ha extends ya.a{constructor(I,xa,Ua,vb,cb,Xb,rc){super(I,xa,Ua);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=vb;this.messageContent=cb;this.messageOrigin=Xb;this.targetOrigin=rc}}Object(c.a)(ha,"DialogMessageReceivedEventArgs",
ya.a,[]);class Da extends ya.a{constructor(I,xa,Ua,vb,cb,Xb,rc){super(I,xa,Ua);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=vb;this.messageContent=cb;this.messageOrigin=Xb;this.targetOrigin=rc}}Object(c.a)(Da,"DialogParentMessageReceivedEventArgs",ya.a,[]);var nb=a(1),qa=a(21);class pa{constructor(I){this.Qh=this.aVc=null;this.ANi=(xa,Ua)=>{this.handlers.lb(Ua.controlId)&&(xa=new ha(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Ua.controlId,
null,Ua.messageType,Ua.messageContent,Ua.messageOrigin,Ua.targetOrigin),this.handlers.na(Ua.controlId)(xa),Ua.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Ua.controlId))};this.zNi=(xa,Ua)=>{this.yjc.lb(Ua.controlId)&&(xa=new Da(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ua.controlId,null,Ua.messageType,Ua.messageContent,Ua.messageOrigin,Ua.targetOrigin),this.yjc.na(Ua.controlId)(xa))};this.handlers=new E.a;this.yjc=new E.a;this.Kg=I;this.H0a.uFg(this.ANi);
this.H0a.tFg(this.zNi)}get H0a(){this.aVc||(this.aVc=H.getInstance(this.contextActivationMgr));return this.aVc}get contextActivationMgr(){!this.Qh&&this.Kg&&(this.Qh=this.Kg.Qh);return this.Qh}addHandler(I,xa,Ua,vb){if(nb.EwaSettings.ma(23))this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ua);else{d.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const cb=Xb=>{Xb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(I,xa),
this.Kg.Zu(Ua)):(d.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Kg.rf(Xb,Ua))};this.handlers.lb(I)?cb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(I,vb,cb)}}XAg(I,xa,Ua){nb.EwaSettings.ma(23)?this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ua):(d.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.yjc.ia(I,xa),this.Kg.Zu(Ua))}removeHandler(I,xa){nb.EwaSettings.ma(23)?
this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xa):this.handlers.lb(I)?(d.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.H0a.opb(I,Ua=>{this.handlers.remove(I);Ua===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Kg.Zu(xa):(d.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Kg.rf(Ua,xa))})):this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,xa)}T9i(I,xa){nb.EwaSettings.ma(23)?
this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xa):(d.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.yjc.remove(I),this.Kg.Zu(xa))}showDialog(I,xa,Ua){try{nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&qa.g(this.Kg.$).$a&&qa.g(this.Kg.$).Fo(!0),this.H0a.showDialog(xa,I,Ua,vb=>{this.Kg.oBg(this.rRg(vb))})}catch(vb){d.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${vb.message}`),
Ua(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}rRg(I){const xa={};xa.InstanceId=I.id;xa.WebExtensionType=I.osfControlType===OSF.OsfControlTarget.InContent?0:1;xa.PrimaryMarketplace={};xa.PrimaryMarketplace.SolutionId=I.solutionId;xa.PrimaryMarketplace.SolutionVersion=I.version;xa.PrimaryMarketplace.MarketplaceRef=I.storeId;xa.PrimaryMarketplace.MarketplaceType=I.storeType;return xa}static ka(I){if(!I.$.da.za(232)){const xa=new pa(I);I.$.da.Ga(232,xa)}}}Object(c.a)(pa,"DialogMessageReceivedEventManager",
null,[824]);class Ja{constructor(I,xa){this.VA=null;this.Gea=I;this.vwg=xa}TXb(I){I&&(this.VA||(this.VA=[]),this.VA.push(I))}Yqc(I){this.VA&&Array.remove(this.VA,I)}get eventId(){return this.Gea}get targetId(){return this.vwg}get e4h(){return 0<this.VA.length}Uxi(I){return this.eventId!==I.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===I.ddaBinding.Name:!0}P_b(I){this.VA&&Array.forEach(this.VA,
xa=>{xa(I)})}ama(){this.VA=[]}}Object(c.a)(Ja,"DdaEventRegistration",null,[]);class $a{constructor(I){this.PE=null;this.vva=!1;this.Uc=()=>{this.PE.forEach(xa=>{xa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&xa.P_b(new ya.a(xa.eventId,"",null))})};this.Kg=I}invokeDdaMethod(I,xa){const Ua={};Ua[Z.a.Zf]=I;Ua[Z.a.E2]=xa;this.Kg.aK(974713501,Ua)}registerDdaEventAsync(I,xa,Ua,vb,cb){$a.cyb(I)?($a.Eld(I)&&this.Yhd(),this.PE||(this.PE=[]),xa=this.Ssb(I,Ua),xa||(xa=new Ja(I,Ua),this.PE.push(xa)),
xa.TXb(vb),this.Kg.Zu(cb)):this.Kg.rf(-1,cb)}unregisterDdaEventAsync(I,xa,Ua,vb,cb){$a.cyb(I)?((I=this.Ssb(I,Ua))&&I.Yqc(vb),this.Kg.Zu(cb)):this.Kg.rf(-1,cb)}Yhd(){this.vva||(qa.g(this.Kg.$).ha.lE(this.Uc),this.vva=!0)}Ssb(I,xa){if(!this.PE)return null;for(let Ua=0;Ua<this.PE.length;Ua++){const vb=this.PE[Ua];if(vb.eventId===I&&vb.targetId===xa)return vb}return null}static cyb(I){return I===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Eld(I){return I===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}
Object(c.a)($a,"EmbeddingPage",null,[776]);var rb=a(176);class Pa extends ya.a{constructor(I,xa,Ua,vb,cb,Xb,rc,Ec){super(I,xa,Ua);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Xb-vb.Reference.FirstColumn;this.columnCount=Ec;I=Math.max(cb,vb.Reference.FirstRow);cb=Math.min(cb+rc-1,vb.Reference.LastRow);I>cb?this.startRow=this.rowCount=void 0:(this.startRow=I-vb.Reference.FirstRow,this.rowCount=cb-I+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(Pa,"DdaBindingSelectionEventArgs",ya.a,[]);var eb=a(198),Ob=a(24),tb=a(42),cc=a(50),Ib=a(413),Mb=a(36),Oa=a(37),Aa=a(561),Ba=a(109),ob=a(54),xb=a(90),Va=a(12),bb=a(11),ra=a(104);class Qa{}Qa.wrh="ewa-wx-disabled-div";Qa.vrh="ewa-wx-container-div";Qa.uMe="ewa-ptp-nov2-flex";Object(c.a)(Qa,"CssClassNames",null,[]);const qb=Qa.wrh,Wa=Qa.vrh;class ta extends rb.a{constructor(I,xa,Ua,vb=!1){super();this.Lbb=0;this.PE=null;this.vva=!1;this.Poc=null;this.$T=0;this.V3b=this.yUa=this.sFc=this.K0d=
null;this.k8d=!1;this.BMc=this.Rca=this.kZd=null;this.Uc=()=>{this.enabled&&(this.umj(),this.Poc=tb.d(qa.g(this.$).ha.sa.selectedRanges))};this.O3e=cb=>{cb.controlId===this.Ld.InstanceId&&Array.forEach(this.PE,Xb=>{Xb.Uxi(cb)&&Xb.P_b(cb)})};this.Ksf=cb=>{if((cb=Object(wa.a)(222,cb))&&!cb.Yr())if(!this.Ld||OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)||this.$.j9){cb.lf=this.Ld;cb.oj=this.Kg;this.kZd=cb;this.Huc(cb.pFa);const Xb=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&
Mb.a.zd(this.$)&&bb.HelperMethods.qw(this.Ld)&&this.Ld.Preload&&!this.Ld.TaskpaneVisible;Xb?cb.gzd():nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(cb.gzd(),(this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&cb.hg(!1)):((this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&cb.hg(!1),cb.gzd());this.e5a||(Mb.a.zd(this.$)?Xb||cb.K5():
Ib.a(this.$).result.WF(cb,!0));this.$.da.za(77).LOf(this.Ksf);this.n9=Object(wa.a)(251,cb)}else d.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(cb,Xb)=>{3===Xb.control.floatingObject.type&&Xb.control.floatingObject.ml.InstanceId===this.y0.WebExtensionId&&(this.n9=Object(wa.a)(251,Xb.control),this.Huc(Xb.control.Hd.firstChild),ra.a(this.$).Pqc(this.onFloatingObjectControlAdded))};this.jb=I.$;this.Kg=I;this.Ld=Ua;this.Ld.InstanceId=Ua.SrcLocationOverrideResourceId?
I.B2a(Ua.InstanceId,Ua.SrcLocationOverrideResourceId):Ua.InstanceId;this.di=xa;this.y0={};this.y0.WebExtensionId=Ua.InstanceId;this.hEf="osfControl_"+Ua.InstanceId;this.T4c="disabled_"+Ua.InstanceId;this.y0.BindingData=Ua.BindingData;this.e5a=this.Kg.e5a(Ua.InstanceId);this.Edc=this.Kg.Edc(Ua.InstanceId);this.Abe=Ua.WebExtensionOsfControlType;this.sHf=vb}get controlId(){return this.Ld.InstanceId}W$h(I){this.Rca||(this.Rca=I)}tOf(){this.Rca&&(this.Rca.dispose(),this.Rca=null)}get controlType(){return this.Ld.WebExtensionType}get ownerAddinSolutionId(){return this.Ld.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.$T}get ky(){return this.BMc}get JT(){return this.Ld.SrcLocationOverrideResourceId?
this.Kg.B2a(this.Ld.PrimaryMarketplace.SolutionId,this.Ld.SrcLocationOverrideResourceId):this.Ld.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Ld.SrcLocationOverrideResourceId}get ml(){return this.Ld}get n9(){return this.K0d}set n9(I){this.K0d=I}get osfControlType(){return this.Abe}get Msa(){return this.sFc}set Msa(I){this.sFc=I}get U3b(){return this.yUa}set U3b(I){this.yUa=I}get focusOnIframeWhenLoaded(){return this.Ld.FocusOnIframeWhenLoaded}get Bfc(){return this.k8d}set Bfc(I){this.k8d=
I}Bjd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)&&nb.EwaSettings.ma(186)){const xa=cc.GetServiceTaskFactory.Ta(this.$.da,5,4,0);Oa.TaskExtensions.Aa(xa,()=>{xa.result.Yf(36,null)},this.la,3);return this}if(1===this.Ld.WebExtensionType)Oa.TaskExtensions.Aa(Ib.a(this.$),xa=>{xa.result.mqb(this.$.da,77,6,this.Ksf,1)},this.la,3);else{var I=this.tRe();const xa=ra.a(this.$);I||(I={Type:3},I.Id=this.y0.WebExtensionId,I.WebExtensionData=this.Ld,I.ContentHtml=
"<div/>",I.Version=0,I.AbsoluteLeft=0,I.AbsoluteTop=0,I.AbsoluteRight=0,I.AbsoluteBottom=0,I.Width=0,I.Height=0,I.ZOrder=0,I.OriginDeltaX=0,I.OriginDeltaY=0,I=new eb.a(I),xa.D2b(I,null),I=xa.sq(I.Lg()));I?(this.Huc(I.Hd.firstChild),this.n9=Object(wa.a)(251,I)):xa.JXb(this.onFloatingObjectControlAdded)}return this}X8e(I){this.Huc(I);return this}llc(){this.sHf||this.Kg.Qh.purgeOsfControl(this.controlId,!1);this.mag(!0);const I=this.tRe();I&&ra.a(this.$).deleteFloatingObject(I);this.Kg.Yi.C9i(this.controlId);
this.Kg.Yi.xJe(this.controlId,!0);this.BMc=null}tzd(I){this.y0=I}invokeDdaMethod(I,xa){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Ua={};Ua[Z.a.Zf]=I;Ua[Z.a.E2]=xa;this.Kg.aK(974713501,Ua)}else this.Kg.rf(ea.a.pxb,xa)}V6i(I,xa,Ua,vb){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!ta.Hgh(I)||void 0!==xa&&null!==xa&&void 0!==this.W1a(xa)&&null!==this.W1a(xa))if(d.ULS.sendTraceTag(36444195,0,50,`eventId: ${I}, targetId: ${xa}`),
ta.rbf(I)&&this.Z5h(),ta.Eld(I)&&this.Yhd(),ta.pbf(I))nb.EwaSettings.ma(23)?this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,vb):this.Kg.$.da.za(232).addHandler(this.controlId,Ua,vb,xa);else if(ta.qbf(I))nb.EwaSettings.ma(23)?this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,vb):this.Kg.$.da.za(232).XAg(this.controlId,Ua,vb);else{ta.obf(I)&&this.Q3e(-1777565636,vb);this.PE||(this.PE=[]);var cb=this.Ssb(I,xa);cb||(cb=new Ja(I,xa),this.PE.push(cb));cb.ama();
cb.TXb(Ua);this.Kg.Zu(vb);I===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.yUa&&(this.V3b=Ua)}else this.Kg.rf(3002,vb);else this.Kg.rf(-1,vb)}tOj(I,xa,Ua,vb){ta.pbf(I)?nb.EwaSettings.ma(23)?this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,vb):this.Kg.$.da.za(232).removeHandler(this.controlId,vb):ta.qbf(I)?nb.EwaSettings.ma(23)?this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,vb):this.Kg.$.da.za(232).T9i(this.controlId,vb):(ta.obf(I)&&this.Q3e(1592314317,
vb),xa=this.Ssb(I,xa),this.enabled?(xa&&(xa.Yqc(Ua),xa.e4h||Array.remove(this.PE,xa),this.PE.length?ta.rbf(I)&&this.nag(!1):this.mag(!1)),this.Kg.Zu(vb)):this.Kg.rf(-1,vb))}ka(I){Va.DOMElementExtensions.getElementById(I,this.hEf)||I.appendChild(Va.DOMElementExtensions.nf(this.ky))}showHide(I){Va.DOMElementExtensions.setVisible(this.ky,I)}resize(I,xa){Va.DOMElementExtensions.Gv(this.ky,I);Va.DOMElementExtensions.CI(this.ky,xa)}vGe(I){if(!this.$T&&!Va.DOMElementExtensions.getElementById(this.ky,this.T4c)&&
this.ky){const xa=document.createElement("div");xa.id=this.T4c;xa.className=qb;xa.style.backgroundImage="url("+ob.a.current.Rn(102)+")";xa.style.opacity=I?"1":"0";xa.style.backgroundRepeat="no-repeat";xa.style.backgroundPosition="center";this.ky.insertBefore(xa,this.ky.firstChild)}this.$T++}yjh(){0<this.$T&&this.$T--;this.$T||(Va.DOMElementExtensions.nf(Va.DOMElementExtensions.getElementById(this.ky,this.T4c)),this.vva&&!tb.Q(this.Poc,qa.g(this.$).ha.sa.selectedRanges)&&this.Uc(null,null))}W1a(I){if(!this.y0||
!this.y0.BindingData)return null;for(let xa=0;xa<this.y0.BindingData.length;xa++)if(this.y0.BindingData[xa].Name===I)return this.y0.BindingData[xa];return null}getDefaultIconUrl(){const I=this.m_e();return I?I.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Ld.TaskpaneTitle)return this.Ld.TaskpaneTitle;const I=this.m_e();return I?I.getDefaultDisplayName():null}uIf(){if(this.yUa&&this.V3b){const I=new ya.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.yUa);this.V3b(I);
this.V3b=this.yUa=null}}hg(I){this.kZd&&this.kZd.hg(I)}zoj(){this.$.ea.isNamedObjectViewMode&&this.Sji()&&(this.$.da.za(34).yoj(this.ky),this.showHide(!1));if(this.Kg.tWj){if(!this.sHf){const I={};I.div=this.ky;I.id=this.Ld.InstanceId;I.solutionId=this.Ld.PrimaryMarketplace.SolutionId;I.version=this.Ld.PrimaryMarketplace.SolutionVersion;I.storeId=this.Ld.PrimaryMarketplace.MarketplaceRef;I.storeType=this.Ld.PrimaryMarketplace.MarketplaceType;I.ownerAddinSolutionId=this.Ld.OwnerAddinSolutionId;I.ownerAddinStoreType=
this.Ld.OwnerAddinStoreType;this.Ld.AssetMarketplace&&(I.assetId=this.Ld.AssetMarketplace.SolutionId,I.assetStoreId=this.Ld.AssetMarketplace.MarketplaceRef);I.settings=this.Ld.OsfPropertyBag;nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?I.reason=this.e5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Edc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:
I.reason=this.e5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;I.osfControlType=0===this.Ld.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;I.isForUILessAction=4===this.Ld.WebExtensionOsfControlType;I.sourceLocationOverrideResourceId=this.Ld.SrcLocationOverrideResourceId;I.focusOnIframeWhenLoaded=this.Ld.FocusOnIframeWhenLoaded;Aa.a(this.Ld)&&(I.featureGates=r.AFrameworkApplication.fa.IXe(I.solutionId));
I.hostInfoFlags=0;this.Msa&&(I.hostInfoFlags|=2);bb.HelperMethods.qw(this.Ld)&&(I.hostInfoFlags|=1);this.$.j9||(d.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),I.hostInfoFlags|=4);nb.EwaSettings.ma(633)&&(I.hostInfoFlags|=8);nb.EwaSettings.ma(53)&&nb.EwaSettings.ma(93)&&!this.sFc&&(I.virtualOsfControlActivationCallback=()=>{this.Kg.vAd(this.Ld)});I.sharedRuntimeId=this.Ld.SharedRuntime?this.Ld.SharedRuntime.Resid:this.Ld.SharedRuntimeId;!bb.HelperMethods.qw(this.Ld)||this.Ld.Preload||
Aa.a(this.Ld)||this.Kg.Qh.getOsfControl(a(732).DdaFacade.getSolutionId(this.Ld,this.$))||(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Kg.vAd(this.Ld):this.Kg.vAd(this.Ld));I.initialDisplayMode=this.Ld.TaskpaneVisible?2:1;nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(I.titleOverride=this.ml.TaskpaneTitle);this.Kg.Qh.insertOsfControl(I)}this.$T=0}else this.vGe(!0)}mag(I){this.nag(I);this.cOj()}Z5h(){this.Lbb||
this.di.TXb(this.O3e);this.Lbb++}nag(I){0<this.Lbb&&(I?this.Lbb=0:this.Lbb--,this.Lbb||this.di.Yqc(this.O3e))}Yhd(){if(!this.vva){const I=qa.g(this.$).ha;this.Poc=tb.d(qa.g(this.$).ha.sa.selectedRanges);I.lE(this.Uc);this.vva=!0}}cOj(){this.vva&&(qa.g(this.$).ha.fI(this.Uc),this.vva=!1)}nlj(I){var xa=new Ob.Range(I.Reference.FirstRow+1,I.Reference.FirstColumn+1,I.Reference.LastRow+1,I.Reference.LastColumn+1,!1,!1);1===I.BindingType&&(I.HasHeaders&&--xa.top,I.HasTotals&&(xa.bottom+=1));var Ua=qa.g(this.$).ha.sa.selectedRanges;
I=xa.oxb(this.Poc);Ua=xa.oxb(Ua);return(xa=xa.Fe(qa.g(this.$).ha.sa.activeRange))&&(Ba.e(I)&&!Ba.e(Ua)||!Ba.e(I)&&!Ba.e(Ua)&&!tb.Q(I,Ua))?xa:null}umj(){Array.forEach(this.PE,I=>{if(I.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&I.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Kg.Yi.fZb(this.controlId))if(I.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)I.P_b(new ya.a(I.eventId,this.controlId,null));else if(I.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const xa=
this.W1a(I.targetId);if((null===xa||void 0===xa?0:xa.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.yb.oa.sheetName:this.$.xa.oa.name)===xa.Reference.SheetName){const Ua=this.nlj(xa);Ua&&I.P_b(new Pa(I.eventId,this.controlId,this.Kg.VZb(xa),xa,Ua.top-1,Ua.left-1,Ua.height,Ua.width))}}})}Ssb(I,xa){if(!this.PE)return null;for(let Ua=0;Ua<this.PE.length;Ua++){const vb=this.PE[Ua];if(vb.eventId===I&&vb.targetId===xa)return vb}return null}tRe(){const I=ra.a(this.$).tU;for(let xa=I.length-1;0<=xa;--xa){const Ua=
I[xa];if(3===Ua.floatingObject.type&&Ua.floatingObject.ml.InstanceId===this.y0.WebExtensionId)return Ua}return null}Sji(){for(let I=0;I<this.$.yb.count;I++)if(this.$.yb.getItem(I).IKa===this.y0.WebExtensionId)return!0;return!1}Huc(I){this.BMc=I;this.ky.id=this.hEf;this.ky.className=Wa;this.ky.dir=this.$.isChromeRtl?"rtl":"ltr";this.zoj()}m_e(){if(!this.enabled)return null;const I=Aa.a(this.ml)?"":this.ml.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.ml.PrimaryMarketplace.SolutionId,
I)}Q3e(I,xa){if(nb.EwaSettings.ma(23))this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xa);else try{if(d.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Abe)this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,xa);else{const Ua={};Ua[M.a.Dmb]=this.controlId;const vb=new xb.a(I,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Lb(vb,Ua);this.Kg.Zu(xa)}}catch(Ua){d.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Ua.message}.`),
this.Kg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,xa)}}static Hgh(I){return I===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||I===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static rbf(I){return I===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||I===OSF.DDA.EventDispId.dispidSettingsChangedEvent||I===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static Eld(I){return I===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||I===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static pbf(I){return I===
OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static qbf(I){return I===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static obf(I){return I===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(ta,"OsfControl",rb.a,[823]);class ib{constructor(){this.cYa={}}add(I){this.cYa[I]=!0}remove(I){delete this.cYa[I]}clear(){for(const I of Object.keys(this.cYa))delete this.cYa[I]}f5e(){return 0<Object.keys(this.cYa).length}tGh(){return Object.keys(this.cYa)}}Object(c.a)(ib,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Bb=a(58);class Ub{constructor(I,xa,Ua){this.mNf=this.lNf=0;this.qKb=this.v$a=null;this.iGi=()=>{var vb=qa.g(this.$).ha.Oa.UA;if(this.nld(vb)&&(vb=this.D9b(vb))){var cb={};cb.chartId=vb;cb.worksheetId=this.Hia();cb=Bb.a.Ac(cb);this.dia(51,vb,cb);this.dia(51,this.Hia(),cb)}};this.jGi=()=>{if(this.v$a){var vb={};vb.chartId=this.v$a;vb.worksheetId=this.qKb;vb=Bb.a.Ac(vb);this.dia(52,this.v$a,vb);this.dia(52,this.qKb,vb)}vb=qa.g(this.$).ha.Oa.UA;
this.nld(vb)?(this.v$a=this.D9b(vb),this.qKb=this.Hia()):this.qKb=this.v$a=null};this.$=I;this.Yi=xa;this.di=Ua}znb(I){51===I.messageType?this.lNf=this.CFa(I.actionType,this.lNf,this.iGi):52===I.messageType&&(this.mNf=this.CFa(I.actionType,this.mNf,this.jGi))}CFa(I,xa,Ua){if(1===I)xa||qa.g(this.$).ha.Oa.rTc(Ua),xa++,this.jsj();else if(2===I){if(1>xa)return xa;1===xa&&qa.g(this.$).ha.Oa.RHd(Ua);xa--}return xa}dia(I,xa,Ua){xa&&this.Yi.mZ(I,xa)&&this.di.zM(I,xa,Ua)}D9b(I){return I&&I.floatingObject?
(I=I.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===I.length?I[0]:null:null}Hia(){const I=this.$.xa.oa;return I&&0===I.bG?I.sheetId:null}jsj(){const I=qa.g(this.$).ha.Oa.UA;this.nld(I)&&(this.v$a=this.D9b(I),this.qKb=this.Hia())}nld(I){return!!I&&!!I.floatingObject&&0===I.floatingObject.type}}Object(c.a)(Ub,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ta=a(735),mb=a(190),Qb=a(607),Lb=a(100),Jb=a(342),Ab=a(55);class pb extends aa.a{constructor(I,xa,
Ua){super();this.$T=this.$ya=0;this.Uc=(vb,cb)=>{if(this.enabled&&!(this.idf()||null!==cb&&void 0!==cb&&cb.xgf)&&(vb=Object(wa.a)(Lb.a,this.$.xa.oa))&&0===vb.bG){const Xb=vb.sheetId,rc=this.IWe();let Ec=null,ed=null;this.Yi.mgf()&&(Ec=this.grid.Db.Xj(this.grid.ha.sa.activeCell),ed=Xb in this.shc?this.shc[Xb]:null);this.vqe(Xb,rc)&&Oa.TaskExtensions.Aa(Ab.Task.Ua(!0),()=>{this.D3h(Xb,rc);this.p3h(Xb,rc,Ec,ed)},this.la);this.tHe(Xb,rc,Ec)}};this.$=I;this.Yi=xa;this.di=Ua;this.grid=qa.g(I);this.tMa=
{};this.shc={}}get enabled(){return!this.$T&&0<this.$ya}CZb(I){Object(wa.a)(Jb.a,this.$.xa);1===I.actionType?(this.$ya||this.grid.ha.lE(this.Uc),this.$ya++):2!==I.actionType||1>this.$ya||(1===this.$ya&&this.grid.ha.fI(this.Uc),this.$ya--)}suc(I){I?this.$T++:(0<this.$T&&this.$T--,this.$T||this.Uc(null,new Qb.a(!1)))}IWe(){return this.grid.ha.sa.selectedRanges}vqe(I,xa){return nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!I&&mb.e(this.tMa)||
I in this.tMa)&&!tb.Q(this.tMa[I],xa):I in this.tMa&&!tb.Q(this.tMa[I],xa)}tHe(I,xa,Ua){this.tMa[I]=tb.d(xa);this.shc[I]=Ua}idf(){return this.grid.$a||this.grid.vi}URe(I,xa){this.Yi.mZ(14,I)&&this.di.zM(14,I,xa);this.Yi.mZ(14,Ta.a.bW)&&this.di.zM(14,Ta.a.bW,xa)}D3h(I,xa){const Ua={};Ua.worksheetId=I;Ua.address=this.qed(xa);xa=Bb.a.Ac(Ua);this.URe(I,xa)}p3h(I,xa,Ua,vb){if(this.Yi.mgf()){var cb="";let Xb="";vb&&(cb=vb.aj);Ua&&(Xb=Ua.aj);vb?Ua?(xa=Ua.usedRange.oxb(xa),cb!==Xb&&this.i8b(cb,"",I),this.i8b(Xb,
this.qed(xa),I)):this.i8b(cb,"",I):Ua&&(cb=Ua.usedRange.oxb(xa),this.i8b(Xb,this.qed(cb),I))}}i8b(I,xa,Ua){if(this.Yi.mZ(100,I)){const vb={};vb.address=xa;vb.worksheetId=Ua;this.di.zM(100,I,Bb.a.Ac(vb))}}qed(I){return tb.i(I,",",this.$,!1)}dispose(){0<this.$ya&&this.grid.ha.fI(this.Uc);this.shc=this.tMa=null;this.$ya=0;this.di=this.Yi=this.$=this.grid=null}}Object(c.a)(pb,"RichApiEventSelectionChangedHandler",aa.a,[]);var va=a(338);class db extends pb{constructor(I,xa,Ua){super(I,xa,Ua);this.nif=
this.oif=null}IWe(){return va.a.wqb(this.grid.ha.rangePicker.KK)}vqe(I,xa){return this.oif!==I||!tb.Q(this.nif,xa)}tHe(I,xa){this.oif=I;this.nif=tb.d(xa)}idf(){return!this.grid.$a&&!this.grid.vi}URe(I,xa){this.Yi.mZ(2700,Ta.a.bW)&&this.di.zM(2700,Ta.a.bW,xa)}}Object(c.a)(db,"RichApiEventPickedRangesChangedHandler",pb,[]);class Ya{constructor(I,xa,Ua){this.mPa=this.lPa=0;this.WFa=this.Jga=null;this.bwf=()=>{var vb=qa.g(this.$).ha.Oa.UA;if(0<this.mPa&&this.Jga&&this.WFa){var cb={};cb.shapeId=this.Jga;
cb.worksheetId=this.WFa;cb=Bb.a.Ac(cb);this.fireEvent(2102,this.Jga,cb)}this.Cli(vb)?(this.Jga=this.GMj(vb),this.WFa=this.Hia(),this.Jga&&this.WFa)?0<this.lPa&&(vb={},vb.shapeId=this.Jga,vb.worksheetId=this.WFa,vb=Bb.a.Ac(vb),this.fireEvent(2101,this.Jga,vb)):d.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Jga}', or worksheet id: '${this.WFa}' from a Floating object or gridview.`):this.WFa=this.Jga=null};this.$=I;this.Yi=xa;this.di=Ua}znb(I){const xa=qa.g(this.$).ha;
1===I.actionType?(this.lPa||this.mPa||xa.Oa.rTc(this.bwf),2101===I.messageType?this.lPa++:2102===I.messageType&&this.mPa++):2===I.actionType&&(2101===I.messageType?this.lPa=0<this.lPa?this.lPa-1:0:2102===I.messageType&&(this.mPa=0<this.mPa?this.mPa-1:0),this.lPa||this.mPa||xa.Oa.RHd(this.bwf))}Cli(I){return!!I&&!!I.floatingObject&&(0===I.floatingObject.type||7===I.floatingObject.type||1===I.floatingObject.type||3===I.floatingObject.type||5===I.floatingObject.type)}GMj(I){if(!I||!I.floatingObject)return null;
I=I.floatingObject.id;var xa=I.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));xa=xa&&1===xa.length?xa[0]:null;return xa?xa:(d.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${I}', but we failed.`),null)}Hia(){const I=this.$.xa.oa;return I&&0===I.bG?I.sheetId:null}fireEvent(I,xa,Ua){xa&&this.Yi.mZ(I,xa)&&this.di.zM(I,xa,Ua)}}Object(c.a)(Ya,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class gb{constructor(I,xa,Ua){this.pNf=this.oNf=
this.qNf=this.nNf=0;this.wTi=(vb,cb)=>{vb=Object(wa.a)(Lb.a,cb.oa);this.L6a(vb)&&(cb={},cb.worksheetId=vb.sheetId,cb=Bb.a.Ac(cb),this.dia(11,vb.sheetId,cb))};this.zTi=(vb,cb)=>{vb=Object(wa.a)(Lb.a,cb.uD);this.L6a(vb)&&(cb={},cb.worksheetId=vb.sheetId,cb=Bb.a.Ac(cb),this.dia(12,vb.sheetId,cb))};this.xTi=(vb,cb)=>{vb=Object(wa.a)(Lb.a,cb.oa);this.L6a(vb)&&(cb={},cb.worksheetId=vb.sheetId,vb=Bb.a.Ac(cb),this.dia(11,null,vb,!0))};this.yTi=(vb,cb)=>{vb=Object(wa.a)(Lb.a,cb.uD);this.L6a(vb)&&(cb={},cb.worksheetId=
vb.sheetId,vb=Bb.a.Ac(cb),this.dia(12,null,vb,!0))};this.$=I;this.Yi=xa;this.di=Ua}znb(I){11===I.messageType?I.targetId===Ta.a.bW?this.wLg(I.actionType):this.vLg(I.actionType):12===I.messageType&&(I.targetId===Ta.a.bW?this.xLg(I.actionType):this.yLg(I.actionType))}vLg(I){this.nNf=this.CFa(I,this.nNf,this.wTi)}yLg(I){this.qNf=this.CFa(I,this.qNf,this.zTi)}wLg(I){this.oNf=this.CFa(I,this.oNf,this.xTi)}xLg(I){this.pNf=this.CFa(I,this.pNf,this.yTi)}CFa(I,xa,Ua){1===I?xa=this.KVc(xa,Ua):2===I&&(xa=this.F4c(xa,
Ua));return xa}KVc(I,xa){I||this.$.xa.Pf(xa);I++;return I}F4c(I,xa){if(1>I)return I;1===I&&this.$.xa.Ag(xa);I--;return I}L6a(I){return!!I&&0===I.bG}dia(I,xa,Ua,vb=!1){xa=vb?Ta.a.bW:xa;this.Yi.mZ(I,xa)&&this.di.zM(I,xa,Ua)}}Object(c.a)(gb,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Ka=a(235),ub=a(13),ac=a(221);class Ra extends Sys.EventArgs{constructor(I,xa,Ua,vb){super();this.sheet=I;this.MUg=xa;this.offsetX=Ua;this.offsetY=vb}}Object(c.a)(Ra,"ClickInActiveCellEventArgs",Sys.EventArgs,
[]);class na{constructor(I,xa,Ua){this.Y0b=null;this.Epd=!1;this.onPointerDown=vb=>{let cb;3===vb.tb?({d_a:cb}=this.gridView.A9b(vb.clientPoint),this.Epd=!!cb&&this.gridView.ha.sa.zHe(cb)):this.Epd=!1;this.Y0b=vb.clientPoint;return!1};this.dd=vb=>{if(this.gridView.inRangePicker||this.gridView.vi||this.Epd||vb.shiftKey||vb.ctrlKey||vb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Y0b||!vb.clientPoint||vb.clientPoint.x!==this.Y0b.x||vb.clientPoint.y!==this.Y0b.y)return!1;const cb=({d_a:vb}=this.gridView.A9b(vb.clientPoint)).returnValue,
Xb=Object(wa.a)(Lb.a,this.$.xa.oa);if(cb&&Xb&&0===Xb.bG){if(!this.gridView.ha.sa.l3.contains(vb))return!1;vb=new Ra(Xb,vb,bb.HelperMethods.iCd(cb.x),bb.HelperMethods.iCd(cb.y));this.ATi(vb)}return!1};this.$=I;this.gridView=qa.g(I);this.Yi=xa;this.di=Ua;this.u8i()}dispose(){this.POj()}u8i(){for(const I of this.gridView.sn){const xa=I.domElement;Ka.a.instance.ra(ub.a.pointerDown,xa,this.onPointerDown);ac.a.instance.ra(ub.a.click,xa,this.dd)}}POj(){for(const I of this.gridView.sn){const xa=I.domElement;
Ka.a.instance.Ba(ub.a.pointerDown,xa,this.onPointerDown);ac.a.instance.Ba(ub.a.click,xa,this.dd)}}ATi(I){var xa=I.sheet;if(this.L6a(xa)){var Ua={};Ua.worksheetId=xa.sheetId;Ua.address=I.MUg.toString();Ua.offsetX=I.offsetX;Ua.offsetY=I.offsetY;I=xa.sheetId;this.Yi.mZ(21,I)&&(xa=Bb.a.Ac(Ua),this.di.zM(21,I,xa));I=Ta.a.bW;this.Yi.mZ(21,I)&&(Ua=Bb.a.Ac(Ua),this.di.zM(21,I,Ua))}}L6a(I){return!!I&&0===I.bG}}Object(c.a)(na,"RichApiEventSingleClickedHandler",null,[]);class lb{constructor(I,xa,Ua){this.RGb=
0;this.m$a=this.s$a=null;this.kDf=()=>{const vb=qa.g(this.$).ha.Oa.UA;if(vb)if(this.Zgf(vb)){const cb=this.Hia();this.a$c(cb);this.s$a=vb.floatingObject.id;this.m$a=cb}else this.s$a&&(this.a$c(this.m$a),this.m$a=this.s$a=null);else this.s$a&&(this.a$c(this.m$a),this.m$a=this.s$a=null)};this.$=I;this.Yi=xa;this.di=Ua}CZb(I){2E3===I.messageType&&(1===I.actionType?(this.RGb||qa.g(this.$).ha.Oa.rTc(this.kDf),this.RGb++,this.Goj()):2===I.actionType&&this.RGb&&(1===this.RGb&&qa.g(this.$).ha.Oa.RHd(this.kDf),
this.RGb--))}a$c(I){var xa;const Ua={};Ua.worksheetId=I;Ua.revisionLoad=!1;if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(nb.EwaSettings.ma(710)||nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const vb=qa.g(this.$).ha.Oa.UA;(null===(xa=null===vb||void 0===vb?void 0:vb.floatingObject)||void 0===xa?0:xa.Rc)?Ua.selectedVisualId=vb.floatingObject.Rc.VisualID:Ua.selectedVisualId=null}xa=
Bb.a.Ac(Ua);I&&this.Yi.mZ(2E3,I)&&this.di.zM(2E3,I,xa)}Hia(){const I=this.$.xa.oa;return I&&0===I.bG?I.sheetId:null}Goj(){const I=qa.g(this.$).ha.Oa.UA;this.Zgf(I)&&(this.s$a=I.floatingObject.id,this.m$a=this.Hia())}Zgf(I){return!!I&&I.Ypd()}}Object(c.a)(lb,"RichApiEventVisualSelectionChangedHandler",null,[]);class jb{constructor(I,xa,Ua){this.SGb=0;this.Xfg=!0;this.z8b=0;this.zod=!0;this.Iwe=()=>{const vb=document.hasFocus();if(this.Xfg!==vb){if(vb){const cb=Bb.a.Ac({});this.di.zM(2203,Ta.a.bW,cb)}this.Xfg=
vb}};this.Jwe=vb=>{(0<vb.timeRemaining()||vb.didTimeout)&&this.Iwe();window.requestIdleCallback(this.Jwe)};this.$=I;this.Yi=xa;this.di=Ua;window.requestIdleCallback||(this.zod=!1)}uLg(I){1===I.actionType?(this.SGb||this.QLg(),this.SGb++):2!==I.actionType||1>this.SGb||(1===this.SGb&&this.rdh(),this.SGb--)}QLg(){if(this.Yi.mZ(2203,Ta.a.bW))if(this.zod){const I={};I.timeout=this.$.ya.CheckFocusTimeout;this.z8b=window.requestIdleCallback(this.Jwe,I)}else this.z8b=window.setInterval(this.Iwe,this.$.ya.CheckFocusTimeInterval)}rdh(){this.zod?
window.cancelIdleCallback(this.z8b):window.clearInterval(this.z8b)}}Object(c.a)(jb,"RichApiEventWorkbookActivatedHandler",null,[]);var Yb;(function(I){I[I.none=0]="none";I[I.registerEvent=1]="registerEvent";I[I.unregisterEvent=2]="unregisterEvent";I[I.customFunction=3]="customFunction";I[I.showCard=4]="showCard";I[I.createWorkbook=5]="createWorkbook";I[I.openWorkbook=6]="openWorkbook";I[I.enableEvents=7]="enableEvents";I[I.closeWorkbook=8]="closeWorkbook";I[I.setCalculationMode=9]="setCalculationMode";
I[I.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";I[I.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";I[I.workbookLinksEnableContent=12]="workbookLinksEnableContent";I[I.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";I[I.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";I[I.rangePicker=15]="rangePicker";I[I.enableRichApiRecording=16]="enableRichApiRecording";I[I.recordAction=17]="recordAction";I[I.focus=18]="focus";I[I.businessBarShow=19]="businessBarShow";
I[I.businessBarHide=20]="businessBarHide"})(Yb||(Yb={}));Object(c.b)("PostProcessActionType",Yb);var Gb=a(248);class wb{constructor(I,xa,Ua){this.iEf=null;this.Z9c=(vb,cb)=>{const Xb=Ta.a.bW,rc={};rc.eventId=vb;rc.payload=cb;this.Yi.mZ(2201,Xb)&&this.di.zM(2201,Xb,Bb.a.Ac(rc))};this.$=I;this.Yi=xa;this.di=Ua;this.x$h()}tLg(I){1===I.actionType?(this.$.Taa=!0,Object(wa.a)(a(732).DdaFacade,Gb.a(this.$)).$9c(!0)):2===I.actionType&&(this.$.Taa=!1);this.iEf=I.controlId;d.ULS.sendTraceTag(537170456,0,50,
`AttachOrDetachMacroRecorderEventHandler: actionType: ${Yb[I.actionType]}; controlId: ${this.iEf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Taa}.`)}Gkh(I){Object(wa.a)(a(732).DdaFacade,Gb.a(this.$)).XRe(I,this.$.Taa)}x$h(){this.$.Xaa&&Oa.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ta(this.$.da,297,298,1),I=>{(I=I.result)&&I.init(this.Z9c)},this.$.la,3)}}Object(c.a)(wb,"RichApiMacroRecorderEventHandler",null,[]);class dc{}Object(c.a)(dc,"SessionRecreationInfo",null,[]);class Jc{constructor(I,
xa,Ua){this.$=I;this.Yi=xa;this.runtimeCalculationMode=Ua}NBi(){return nb.EwaSettings.ma(259)?this.Yi.o4h()||0!==this.runtimeCalculationMode:!1}DQg(){var I={};I.eventRegistrationInfos=this.Yi.KMh();I.runtimeCalculationMode=this.runtimeCalculationMode;I=Object(b.a)(new dc,{runtimeState:I});const xa={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};xa.RequestBody=JSON.stringify(I);xa.RequestFlags=1;return xa}}Object(c.a)(Jc,"RichApiRuntimeStateHandler",null,[]);class Qc{constructor(I,
xa,Ua,vb,cb,Xb,rc,Ec,ed){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=I;this.processUtcTime=xa;this.dequeueUtcTime=Ua;this.inQueueDurationInMS=vb;this.executionDurationInMS=cb;this.operationCount=Xb;this.ServerCorrelationId=rc;this.UserOperationName=Ec;this.IsDocumentHidden=ed}}Object(c.a)(Qc,"UserOperationQueueItemsStatisticsData",
null,[]);var fd=a(324),Wc=a(30),Rb=a(19),Sb=a(291),mc=a(48),ec=a(590),Rc=a(64),Mc=a(59),bc=a(70);class ic extends fd.a{constructor(I,xa,Ua){super(Ua,I);this.Yua=this.hashCode=null;this.c2b=!1;this.Lm=(vb,cb)=>{cb.gd.hash===this.hashCode&&this.Yua&&Object(wa.a)(a(732).DdaFacade,this.$.da.za(35)).szj(this.Yua.InstanceId)};this.mf=(vb,cb)=>{switch(cb.gd.block.state){case 1:case 3:case 5:this.Oma(cb)}};this.Hi=()=>{this.hGb(!0)};this.yo=(vb,cb)=>{this.isVisible&&this.USa(cb.uD);this.clearCache()};this.re=
(vb,cb)=>{this.WRa(cb.oa,!!cb.uD)};this.sN=()=>{this.$.ea.vla()};this.xTa=xa;this.domElement.classList.add(Wc.a.Z6b);this.domElement.classList.add(Rb.a.Wo);Ua.tabIndex=0;this.WRa(this.$.oa,!1);this.Fc.ka("mousedown",this.sN);this.Fc.ka("contextmenu",vb=>{bc.g(vb)});this.$.xa.jJ(this.yo);this.$.yb.jJ(this.yo);this.$.yb.Pf(this.re);this.$.xa.Pf(this.re);this.Ea.Ms(this.mf);this.Ea.KG(this.Lm);this.Ea.ox(this.Hi);nb.EwaSettings.fc()&&this.Nu(this.Pxa)}get Ea(){return this.xTa}dispose(){this.$&&(this.$.xa.SK(this.yo),
this.$.yb.SK(this.yo),this.$.yb.Ag(this.re),this.$.xa.Ag(this.re));this.xTa&&(this.xTa.Mq(this.mf),this.xTa.eI(this.Lm),this.xTa.uv(this.Hi));nb.EwaSettings.fc()&&this.qy(this.Pxa);this.clearCache();fa.a.Ia(this.xTa);this.xTa=null;Va.DOMElementExtensions.nf(this.domElement);super.dispose()}yoj(I){Va.DOMElementExtensions.nf(Va.DOMElementExtensions.getElementById(this.domElement,I.id));this.domElement.appendChild(I)}Ojd(){if(this.Yua&&!this.c2b){var I=Object(wa.a)(a(732).DdaFacade,Gb.a(this.$)).en(this.Yua.InstanceId);
I&&(I.resize(this.Yua.Width,this.Yua.Height),I.ka(this.domElement),I.showHide(!0),this.c2b=!0)}}N6a(){return!0}Oma(I){this.Yua=I.gd.block.he;this.c2b=!1;this.Ojd()}USa(I){this.$.ea.kZ&&I&&(I.Bu||(I.Bu=new Sb.a),I.Bu.Oh=new mc.a(this.domElement.scrollLeft,this.domElement.scrollTop),I.Bu.AFb=20)}clearCache(){this.Ea.rPa(this.hashCode);this.Yua=this.hashCode=null;this.c2b=!1}WRa(I,xa){if(this.isVisible=!!I&&Rc.o(I))this.hashCode=this.Ea.Xqa(I,Mc.a.j4b,this.hashCode),this.Wuc(xa)}static DFa(I){if(!I.da.za(34)){const xa=
I.Bf;I.da.Ga(34,new ic(I,new ec.a(I,I.ea,I.pa.Ok,3,0),xa.appendChild(xa.ownerDocument.createElement("div"))))}}}Object(c.a)(ic,"WebExtensionView",fd.a,[804,192,3]);var Yc=a(223),md=a(510),id=a(368),xd=a(431),Lc=a(170),Pb=a(62),Gc=a(121),Nb=a(47),yc=a(45),Tc=a(152),gd=a(110),Ad=a(65),Od=a(28),Pd=a(31),Md=a(281),ge=a(22),pe=a(14),Qd=a(280),he=a(734),ue=a(51),je=a(146),Ge=a(861);const Ce=I=>{je.a.sendOtelEvent(Object.assign(new Ge.a,{otelEvent:I}))},pc=I=>{je.a.sendOtelCustomerContent(Object.assign(new Ge.a,
{otelEvent:I}))};var Uc=a(199),hd=a(860),yd=a(25);a.d(D,"DdaFacade",function(){return wd});class wd extends Ca.a{constructor(I,xa){super();this.di=this.Rm=this.ea=null;this.vf=[];this.$Ha=null;this.disposed=this.initialized=this.tOb=this.kEe=!1;this.pBa=null;this.pnc=[];this.fEe=[];this.wOa=[];this.v0a=null;this.$Bd=new S.a(ka.a.Rk());this.nYb=new V.a(ka.a.Rk());this.hFb=[];this.AFf=[];this.p4b=350;this.Jwa=this.mea=null;this.mRc=!1;this.Ude=this.Tde=this.Sde=this.Qde=this.Mde=this.Rde=this.Nde=this.Pde=
this.Lde=this.Ode=null;this.Uf=()=>{this.pBa=this.ea.to.WebExtensions;for(var Ua=this.vf.length-1;0<=Ua;--Ua){var vb=this.vf[Ua],cb;if(cb=!this.$zh(vb.controlId))cb=vb,cb=nb.EwaSettings.ma(121)?!cb.Msa:!0;cb&&(vb.llc(),this.vf.splice(Ua,1))}if(this.pBa)for(let Xb=0,rc=this.pBa.length;Xb<rc;Xb++)Ua=this.pBa[Xb],(vb=this.en(Ua.WebExtensionId))&&vb.tzd(Ua)};this.mmc=Ua=>{this.raiseEvent("csc",Ua.getID())};this.Fzd=(Ua,vb,cb)=>{if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&
vb===OSF.AgaveHostAction.KeyboardShortcuts){var Xb=Object(wa.a)(Object,cb);vb={};vb.keyCode=Xb.keyCode;vb.type="keydown";vb.ctrlKey=Xb.ctrlKey;vb.shiftKey=Xb.shiftKey;vb.altKey=Xb.altKey;vb.metaKey=Xb.metaKey;Xb=this.en(Ua);Ua=Xb.n9;vb.srcElement=Object(ma.a)(222,Ua)?Ua.pFa:qa.g(this.$).lc;Ua=new Sys.UI.DomEvent(vb);Xb=wd.kua(Xb.ml,this.$);vb={};vb.focusedAddinId=Xb;Xb=new xb.a(1461300262,1,this.$.Mc,6,null);qa.g(this.$).vIb(Ua,Xb,vb)}else if(vb===OSF.AgaveHostAction.Select)this.C3e(!0);else if(vb===
OSF.AgaveHostAction.UnSelect)this.C3e(!1);else if(vb===OSF.AgaveHostAction.CancelDialog)this.aK(-684355545,null);else if(vb===OSF.AgaveHostAction.InsertAgave)Ua={},cb&&(Ua[M.a.gra]=cb,Ua[Z.a.Zf]=wd.Aqb(cb),this.aK(-741808261,Ua));else if(vb===OSF.AgaveHostAction.InsertDevManifest)Ua={},cb&&(Ua[M.a.gra]=cb,Ua[Z.a.Zf]=wd.Aqb(cb),this.aK(-741808261,Ua));else if(vb===OSF.AgaveHostAction.InsertDevManifestError)Ua=Object(wa.a)(Object,cb),Ua={[M.a.ZTc]:this.Rm.getDevManifestInvalidUrlErrorString(Ua.manifestUrl)},
this.aK(-2025863019,Ua);else if(vb===OSF.AgaveHostAction.NotifyHostError)Ua={[M.a.ZTc]:this.Rm.getManifestInvaildErrorString()},this.aK(-2025863019,Ua);else if(vb===OSF.AgaveHostAction.RefreshAddinCommands)nb.EwaSettings.ma(53)&&this.aK(yd.a.refreshAddinCommands,null);else if(vb===OSF.AgaveHostAction.CtrlF6Exit||vb===OSF.AgaveHostAction.CtrlF6ExitShift){if(Xb=this.$.da.za(15)){(Ua=this.en(Ua).n9)&&Ua.ixc();x.a.Tf&&document.activeElement.blur();var rc={keyCode:117,type:"keydown",ctrlKey:!0};rc.shiftKey=
vb===OSF.AgaveHostAction.CtrlF6ExitShift;rc.srcElement=Object(ma.a)(222,Ua)?Ua.pFa:qa.g(this.$).lc;Ua=new Sys.UI.DomEvent(rc);Xb.nla(Ua)}}else if(vb===OSF.AgaveHostAction.PageIsReady){if((Ua=this.en(Ua).n9)&&Ua.jYa===OSF.OsfControlTarget.TaskPane&&(Ua=this.$.da.za(183))&&this.vf){vb=Mb.a.zd(this.$);for(Xb of this.vf)wd.hLa(Xb.JT)&&(vb?Ua.gg(!0,!1):Ua.setFocusOnToolbarFirstElement())}}else if(vb===OSF.AgaveHostAction.TabExit){vb=this.en(Ua);const ud=vb.n9;if(ud)if(ud.jYa===OSF.OsfControlTarget.InContent)ud.Shf();
else{if(ud.jYa===OSF.OsfControlTarget.TaskPane)if(Mb.a.zd(this.$))x.a.Tf&&document.activeElement.blur(),L.UISurfaces.Lj().then(Kd=>{const Zd=Object(ma.a)(222,ud)?ud:null;Zd?Zd.isResizable?Kd.focusResizeHandle():Kd.focusTabbedTaskPaneArea():Kd.focusTabbedTaskPaneArea();return null});else if(vb=this.$.da.za(183))x.a.Tf&&document.activeElement.blur(),(Ua=document.getElementById(this.$.Bb+Na.a.tkc))&&Va.DOMElementExtensions.isVisible(Ua)?Va.DOMElementExtensions.setFocus(Ua):vb.setFocusOnToolbarFirstElement()}else vb&&
4===vb.osfControlType&&this.Rm.notifyAgave(Ua,OSF.AgaveHostAction.TabIn)}else if(vb===OSF.AgaveHostAction.TabExitShift)(vb=this.en(Ua),Xb=vb.n9)?Xb.jYa===OSF.OsfControlTarget.InContent?Xb.Thf():Xb.jYa===OSF.OsfControlTarget.TaskPane&&(Ua=Object(ma.a)(222,Xb)?Xb:null)&&(x.a.Tf&&document.activeElement.blur(),Ua.rYf()):vb&&4===vb.osfControlType&&this.Rm.notifyAgave(Ua,OSF.AgaveHostAction.TabIn);else if(vb===OSF.AgaveHostAction.EscExit||vb===OSF.AgaveHostAction.ExitNoFocusable||vb===OSF.AgaveHostAction.ExitNoFocusableShift)if(Xb=
this.en(Ua).n9)Xb.ixc();else{if(vb===OSF.AgaveHostAction.EscExit){vb=null;for(rc of H.g_h())if(rc.value.Ae===Ua){rc.value.dialog.hide();vb=rc.key;break}vb&&(Ua=this.en(vb))&&4!==Ua.osfControlType&&this.Qh.notifyAgave(vb,OSF.AgaveHostAction.TabIn)}}else if(vb===OSF.AgaveHostAction.InstallCustomFunctions)if(nb.EwaSettings.ma(121)){Ad.a(this.$).bTe(()=>!1);var Ec=this.$.da;Oa.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ta(Ec,278,279,1),ud=>{ud=ud.result;Ec.za(278)||Ec.Ga(278,ud);const Kd=cb.osfControl.getStoreType();
ud.$9e(cb.osfControl.getSolutionId(),Kd,wd.$Kh(cb.osfControl),cb).uma()},this.la,3)}else d.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(vb===OSF.AgaveHostAction.UninstallCustomFunctions)if(nb.EwaSettings.ma(121)){Ad.a(this.$).bTe(()=>!1);var ed=this.$.da;Oa.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ta(ed,278,279,1),ud=>{ud=ud.result;ed.za(278)||ed.Ga(278,ud);ud.pag(cb.solutionId,cb.storeType).uma()},this.la,
3)}else d.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else vb===OSF.AgaveHostAction.SendTelemetryEvent?Ce(cb):vb===OSF.AgaveHostAction.SendCustomerContent?pc(cb):vb===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.bqi(cb):vb===OSF.AgaveHostAction.RefreshRibbonGallery?(Ua=this.$.da.za(352))&&Ua.Egd(cb):vb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.$9i(cb.solutionId),Mb.a.zd(this.$)||(Ua=this.$.da.za(183))&&
Ua.Vw(),nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&r.AFrameworkApplication.wb.ae(yd.a.FNf,2,cb.solutionId)):vb===OSF.AgaveHostAction.GetOriginalControlId&&(Ua=new N.a(this.$.Bb,cb.ownerAddinSolutionId,new za.a,!0),cb.originalControlId=Ua?Ua.vEe(cb.controlId):cb.controlId)};this.vmj=(Ua,vb)=>{const cb=Array(2);cb[0]=vb;cb[1]=null;this.di.iAh(Ua,JSON.stringify(cb))};this.fTi=()=>{this.$.oa&&Rc.o(this.$.oa)&&this.$.da.za(34).Ojd()};
this.Zc=()=>{this.Njf()};this.aR=(Ua,vb)=>{var cb,Xb;1===vb.Kq&&(Ua=vb.wf)&&(vb=new Qc(gd.toTimestamp(Ua.enqueueUtcTime),gd.toTimestamp(Ua.processUtcTime),gd.toTimestamp(Ua.dequeueUtcTime),gd.getElapsedMilliseconds(Ua.enqueueUtcTime,Ua.processUtcTime),gd.getElapsedMilliseconds(Ua.processUtcTime,Ua.dequeueUtcTime),Ua.operationCount,(null===(Xb=null===(cb=Ua.operation)||void 0===cb?void 0:cb.$c)||void 0===Xb?0:Xb.ServerCorrelationId)?Ua.operation.$c.ServerCorrelationId:null,Ua.operation?Enum.toString(xd.a,
Ua.operation.operationName):null,he.a.kB(gd.getElapsedMilliseconds(Ua.enqueueUtcTime,Od.a.Wa.Nb))),cb=Sys.Serialization.JavaScriptSerializer.serialize(vb),d.ULS.sendTraceTag(50872916,0,50,cb))};this.Xc=(Ua,vb)=>{!this.ea.hc&&Yc.a(vb)?(Array.forEach(this.vf,this.Tuf),this.vf.length=0,this.tOb=!1):(vb.zH&&(d.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.eSf()),this.VK(),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.tOb=!1))};this.Ao=()=>{nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(d.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.eSf());this.VK();nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.tOb=!1)};this.Tuf=Ua=>{Ua.llc();this.raiseEvent("cd",Ua.controlId)};this.jb=I;this.rUc=xa;this.initialize();pa.ka(this);this.eTf=0;(I=(I=!(x.a.jp||x.a.Qja))&&(!nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!x.a.Tf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.Ppg={}}get nZb(){return this.mea||(this.mea=new U.a(this.$.aw))}Ile(I){this.addHandler("cd",I)}Z$i(I){this.removeHandler("cd",I)}MDg(I){this.addHandler("csc",I)}aaj(I){this.removeHandler("csc",I)}JDg(I){this.addHandler("ca",I)}Y$i(I){this.removeHandler("ca",I)}KDg(I){this.addHandler("ci",I)}LDg(I){this.addHandler("ekros",I)}$$i(I){this.removeHandler("ekros",I)}CBd(I,xa){try{return JSON.parse(I)[xa].toLowerCase()}catch(Ua){return""}}avj(I){const xa=
this.CBd(I,"AudienceGroup"),Ua=this.CBd(I,"SessionOrigin");try{const vb=parseInt(this.CBd(I,"Ring"),10);if("automation"!==xa&&"bluechicken"!==Ua&&-2<=vb)return!0}catch(vb){if("automation"!==xa&&"bluechicken"!==Ua)return!0}return!1}get Qh(){if(!this.Rm){const I={},xa=!(this.$.Bd&1),Ua=ob.a.current.EN,vb=this.$.workbookContext,cb=X.a.kL+X.a.y1b;I.pageBaseUrl=Ua.LayoutsContentUrlPrefix;I.appName=OSF.AppName.ExcelWebApp;I.appVersion="16";I.appSettings=this.UOh();I.singleSignOnSettings=F.AppsForOfficeSingleSignOnManager.GWh();
I.clientMode=xa?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;I.appUILocale=this.$.ya.UICultureTag;I.dataLocale=this.$.ya.DataCultureTag;I.docUrl=vb.ClientUrl;I.hostControl=this;I.formFactor=OSF.FormFactor.Default;I.lcid=this.$.oG.toString();I.localizedScriptsUrl=X.a.kL+X.a.k0c;I.localizedImagesUrl=cb;I.localizedStylesUrl=X.a.kL+X.a.yze;I.localizedResourcesUrl=cb;I.osfOmexBaseUrl=Ua.OsfOmexBaseUrl;I.firstPartyManifestCDNUrl=Ua.FirstPartyAddInManifestCDN;I.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Va("SdxAssetsToPrefetchMapping");
I.sdxCdnUrl=Ua.SdxCdnUrl;I.sdxDmsUrl=Ua.SdxDmsUrl;I.devCatalogUrl=Ua.DevCatalogUrl;I.controlStatusChanged=this.mmc;I.notifyHost=this.Fzd;I.allowExternalMarketplace=this.$.ea.Sg.get(27)&&wd.k2b;I.enableAddinCommands=nb.EwaSettings.ma(53);I.enableBlackForestRedirect=nb.EwaSettings.ma(88);I.enableMyOrg=this.$.ea.Sg.get(33);I.enableMyApps=this.$.ea.Sg.get(34);I.enableDevCatalog=nb.EwaSettings.ma(44);I.enablePrivateCatalog=this.Tvj();I.enableTaskpaneUpgradeToAppCommand=nb.EwaSettings.ma(93);I.showSignOutFromPrivateCatalogMessage=
this.$.ea.Sg.get(36);I.enableUploadFileDevCatalog=nb.EwaSettings.ma(53)&&!nb.EwaSettings.ma(282);I.userNameHashCode=W.a.Xv(r.AFrameworkApplication.userName);I.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();I.enableSingleSignOnForAddin=!nb.EwaSettings.ma(23)&&r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;I.enableDisplayBlockedMinorError=nb.EwaSettings.ma(183);I.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;I.enableAnonymousUseLegacyCatalogService=
nb.EwaSettings.ma(173);I.enableInsertDialogAccessibilityFix=nb.EwaSettings.ma(180);I.disableAppsForOfficeThirdParty=nb.EwaSettings.ma(186);I.enableFirstPartySSO=nb.EwaSettings.ma(198);I.wacSessionId=this.$.ya.UserSessionId;I.disableLogging=!this.$.ya.AriaLoggingIsEnabled;I.enableFirstPartySDXErrorMessages=nb.EwaSettings.ma(211);I.enableRichApiCellEditDelay=nb.EwaSettings.ma(190);I.isHostDocumentDomain=nb.EwaSettings.ma(226);I.loggableUserId=r.AFrameworkApplication.fa.Va("LoggableUserId");I.sessionStartInfoJson=
r.AFrameworkApplication.fa.Va("SessionStartInfoJson");I.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;I.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Va("PostMessageOrigin");I.wacIsEmbedded=r.AFrameworkApplication.fa.qa("IsEmbedded");I.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");I.enableRemoveAppCommandsAddin=r.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");I.isHostFrameTrustCheckEnabledForAddIns=
r.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");I.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;I.agaveAddinUploadEnabled=nb.EwaSettings.ma(46);I.hostAllowedOfficeStore=r.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");I.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");I.hostInstallAddIns=r.AFrameworkApplication.fa.Va("HostInstallAddIns");I.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");
I.approvedAddIns=r.AFrameworkApplication.fa.Va("ApprovedAddIns");I.addinEnforceHttpsIsEnabled=this.avj(I.sessionStartInfoJson);I.hostFeatureGateFlag=0;I.isUpnCheckEnabled=r.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");I.wacUpn=r.AFrameworkApplication.fa.Va("UserPrincipalName");I.isReactRibbonEnabled=Mb.a.isReactRibbonEnabled();I.enableSetFocusOnTaskpaneOnUserAction=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);I.isSafariWithIndexedDBDisabled=
nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&x.a.PLa;I.isIndexedDBDisabled=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&x.a.PLa||nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&x.a.Tf;I.enableCustomShortcuts=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");I.changeGetModifierKeyStringOutputOrder=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
I.officeJsUrl=r.AFrameworkApplication.aL("OfficeJs/excel.js",5);I.enableOfficeJsUrlParam=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Rm=new OSF.ContextActivationManager(I);this.Rm.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Rm.setWSA(r.AFrameworkApplication.Dn);this.Rm&&"undefined"!==typeof this.Rm.hostCheckReadyHandler&&r.AFrameworkApplication.HEg(Object(e.a)(this.Rm,this.Rm.hostCheckReadyHandler,"hostCheckReadyHandler"));
try{const Xb=da.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Rm.setOAuthManager(Xb)}catch(Xb){}}return this.Rm}get tWj(){return this.mRc}get Yi(){return this.Ode}get qma(){return this.Lde}get DKd(){return this.Pde}get CKd(){return this.Nde}get uhj(){return this.Rde}get shj(){return this.Mde}get thj(){return this.Qde}get vhj(){return this.Sde}get whj(){return this.Tde}get EKd(){return this.Ude}get QU(){return this.Ppg}get $(){return this.jb}VZb(I){const xa={};xa.Name=I.Name;xa.BindingType=
I.BindingType;xa.HasHeaders=I.HasHeaders;I.IsValidRef&&(xa.ColCount=I.Reference.LastColumn-I.Reference.FirstColumn+1,xa.RowCount=I.Reference.LastRow-I.Reference.FirstRow+1);return xa}sqi(I,xa){this.Rm.launchInsertDialog(I,null,this.HPg(xa))}pca(I,xa){if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.WIf(I,xa,OSF.StoreTypeEnum.MarketPlace);else{const Ua={};Ua.callbackFunc=I;Ua.storeType=OSF.StoreTypeEnum.MarketPlace;Ua.fromInsertDialog=!1;Ua.refresh=
xa;this.Rm.queryEntitlementDetails(Ua)}}WIf(I,xa,Ua){const vb={};vb.callbackFunc=I;vb.storeType=Ua;vb.fromInsertDialog=!1;vb.refresh=xa;this.Rm.queryEntitlementDetails(vb)}invokeDdaMethod(I,xa){const Ua=this.en(I.DdaMethod.ControlId);Ua?Ua.invokeDdaMethod(I,xa):this.rf(ea.a.internalError,xa)}registerDdaEventAsync(I,xa,Ua,vb,cb){(xa=this.en(xa))?wd.cyb(I)?xa.V6i(I,Ua,vb,cb):this.rf(ea.a.UAd,cb):this.rf(ea.a.internalError,cb)}unregisterDdaEventAsync(I,xa,Ua,vb,cb){(xa=this.en(xa))?wd.cyb(I)?xa.tOj(I,
Ua,vb,cb):this.rf(ea.a.UAd,cb):this.rf(ea.a.internalError,cb)}dispose(){this.disposed||(this.$.Cl(this.Zc),this.ea.Hk(this.Xc),this.ea.oR(this.Ao),this.ea.Mw(this.Uf),this.rUc.detach(this),this.$.userOperationManager.Co(this.aR),this.pnc=this.vf=this.di=this.rUc=this.jb=null,this.$Ha&&(this.$Ha.dispose(),this.$Ha=null),fa.a.Ia(this.DKd),fa.a.Ia(this.CKd),this.v0a&&(this.v0a.dispose(),this.v0a=null),super.dispose(),this.disposed=!0,d.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}Ybd(I){return(I=
this.en(I))?I.getDefaultIconUrl():null}suc(I){if(this.kEe!==I){this.kEe=I;for(let xa=0,Ua=this.vf.length;xa<Ua;xa++){const vb=this.vf[xa];I?vb.vGe(!1):vb.yjh()}this.DKd.suc(I);this.CKd.suc(I)}}uLh(I){return(I=this.en(I))?I.getDefaultDisplayName():null}rf(I,xa,Ua=!0){const vb={};vb[Z.a.Zf]=I;vb[Z.a.E2]=xa;this.aK(451041795,vb,Ua)}Zu(I){const xa={};xa[Z.a.E2]=I;this.aK(1237877382,xa)}aK(I,xa,Ua=!0){const vb=new xb.a(I,0,this.$.Mc,0,null),cb=xa?xa[Z.a.E2]:null;this.v0a&&qa.g(this.$).$a&&ua.uZg(I,xa)?
this.v0a.hch(I,xa):(I=this.$.Ka.Lb(vb,xa),Ua&&Oa.TaskExtensions.Aa(I,Xb=>{Tc.a(Xb)?this.rf(ea.a.internalError,cb,!1):Xb.result||(qa.g(this.$).$a?this.rf(ea.a.pxb,cb,!1):this.rf(ea.a.internalError,cb,!1))},this.la,8))}W0g(I){return!!this.cia(xa=>wd.getSolutionId(xa.ml,this.$)===wd.getSolutionId(I,this.$)&&xa.ml.PrimaryMarketplace.MarketplaceType===I.PrimaryMarketplace.MarketplaceType&&xa.ml.PrimaryMarketplace.MarketplaceRef===I.PrimaryMarketplace.MarketplaceRef&&xa.ml.PrimaryMarketplace.SolutionVersion===
I.PrimaryMarketplace.SolutionVersion)}en(I){return this.cia(xa=>xa.controlId.startsWith(I))}Nzh(I){return this.cia(xa=>xa.Msa===I)}uRe(I){return this.cia(xa=>xa.JT===I&&!!xa.Msa)}MRe(I,xa,Ua,vb){return this.cia(cb=>cb.JT===I&&cb.ml.PrimaryMarketplace.MarketplaceRef.toLowerCase()===xa.toLowerCase()&&cb.ml.PrimaryMarketplace.MarketplaceType.toLowerCase()===Ua.toLowerCase()&&!!cb.ml.SharedRuntime&&!!cb.ml.SharedRuntime.Resid&&!!vb&&!!vb.Resid&&cb.ml.SharedRuntime.Resid.toLowerCase()===vb.Resid.toLowerCase())}iLg(I,
xa){if(I=this.en(I))I.ka(xa),I.showHide(!0)}szj(I){(I=this.en(I))&&I.showHide(!1)}ZGa(I){var xa;if(1!==I.WebExtensionType||this.$.Bd&8388608&&I.TaskpaneVisible||this.$.Bd&8388608&&!I.TaskpaneVisible&&bb.HelperMethods.qw(I)){let Ua=null;bb.HelperMethods.qw(I)&&(Ua=wd.kua(I,this.$),I.TaskpaneWidth||(I.TaskpaneWidth=this.p4b));const vb=(new ta(this,this.di,I)).Bjd();d.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(I.PrimaryMarketplace.SolutionId,
I.PrimaryMarketplace.MarketplaceType,null===(xa=I.AssetMarketplace)||void 0===xa?void 0:xa.SolutionId,null,null,I.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${I.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${bb.HelperMethods.qw(I)}`);Ua&&(vb.Msa=Ua);this.vf.push(vb);this.Jwa=null;this.e5a(I.InstanceId)||(I=String.format("{0}|{1}|{2}|{3}|{4}",I.PrimaryMarketplace.SolutionId,I.PrimaryMarketplace.SolutionVersion,I.PrimaryMarketplace.MarketplaceRef,I.PrimaryMarketplace.MarketplaceType,I.WebExtensionType),
this.raiseEvent("ci",I))}}XAj(I,xa){I.TaskpaneWidth=this.p4b;I.TaskpaneVisible=!0;const Ua={};Ua.SolutionId=I.PrimaryMarketplace.SolutionId;Ua.TargetType=I.WebExtensionType;Ua.Version=I.PrimaryMarketplace.SolutionVersion;Ua.StoreType=I.PrimaryMarketplace.MarketplaceType;Ua.StoreId=I.PrimaryMarketplace.MarketplaceRef;Ua.AssetId=I.PrimaryMarketplace.SolutionId;Ua.AssetStoreId=I.PrimaryMarketplace.MarketplaceRef;Ua.Width=I.TaskpaneWidth;const vb=new ta(this,this.di,I,!0);vb.Bjd();this.vf.push(vb);const cb=
()=>{this.tPa(vb.controlId);this.Qh.purgeOsfControl(vb.controlId,!1);xa()};let Xb=null;Xb=Nb.a.instance.HE(()=>{vb.ky&&(fa.a.Ia(Xb),Xb=null,this.Qh.insertBlankControlWithErrorUX(this.HFb(vb,Ua),cb))},100,yc.a.Zah)}Q4g(I){if(I&&I.length){var xa=[];I.forEach(Ua=>{if(Ua.ContainsCustomFunctions){const vb=wd.kua(Ua,this.$);this.$Bd.contains(vb)||(this.$Bd.add(vb),this.AFf.push(Ua));this.W0g(Ua)||xa.push(Ua)}});xa.length&&this.sBe(xa)}}rDe(I,xa){this.en(I.InstanceId)||(xa=xa(),I=(new ta(this,this.di,I)).X8e(xa),
this.vf.push(I),this.Jwa=null)}Nyj(I){wd.p0a.lb(I)&&wd.p0a.na(I).initializeAndShowWithTitle()}l5h(I){wd.p0a.lb(I)&&wd.p0a.na(I).hide()}lSh(I){var xa=null;let Ua,vb,cb=null;Ua=wd.Ifd(I,!0);if(!Ua)return d.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ab.Task.Ua(null);(vb=this.Rm.getOsfControl(wd.getSolutionId(Ua,this.$)))&&(xa=vb.getManifest())&&(cb=xa.getSharedRuntimeForCustomFunctions("Workbook"));if(xa=cb&&1===cb.LifeTime?this.MRe(Ua.PrimaryMarketplace.SolutionId,
Ua.PrimaryMarketplace.MarketplaceRef,Ua.PrimaryMarketplace.MarketplaceType,cb):this.Nzh(I))return Ab.Task.Ua(xa.controlId);const Xb=new ab.a;bb.HelperMethods.Ngc(cb)&&(Ua.SharedRuntime=cb);I=vb?vb.getNotificationParams():[];if(!I.length)return this.WBe(Ua);this.N1f(I,()=>{Oa.TaskExtensions.Aa(Xb.task,()=>{this.WBe(Ua)},this.la,3)},()=>{});return Xb.task}rGh(I){I=wd.Ifd(I,!1);if(!I)return d.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let xa=null;
var Ua=this.Rm.getOsfControl(wd.getSolutionId(I,this.$));Ua&&(Ua=Ua.getManifest())&&(xa=Ua.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return bb.HelperMethods.Ngc(xa)&&(I=this.MRe(I.PrimaryMarketplace.SolutionId,I.PrimaryMarketplace.MarketplaceRef,I.PrimaryMarketplace.MarketplaceType,xa))?I.controlId:null}m3g(I,xa){var Ua=wd.Ifd(I,!1);if(Ua){var vb=null,cb=this.Rm.getOsfControl(wd.getSolutionId(Ua,this.$));cb&&(cb=cb.getManifest())&&(vb=cb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(bb.HelperMethods.Ngc(vb)){Ua.SharedRuntime=vb;var Xb=Ua.PrimaryMarketplace.SolutionId;cb=Ua.PrimaryMarketplace.SolutionVersion;var rc=OSF.OsfManifestManager.getCachedManifest(Xb,cb);if(rc)if(this.nYb.lb(I))vb=this.nYb.na(I),Oa.TaskExtensions.Aa(vb,ud=>{(ud=ud.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ud,xa,this.di.jJb)},this.la,3);else{var Ec={};Ec.solutionId=Xb;Ec.version=cb;Ec.storeType=Ua.PrimaryMarketplace.MarketplaceType;Ec.storeId=Ua.PrimaryMarketplace.MarketplaceRef;
Ec.assetId=Xb;Ec.assetStoreId=null;Ec.targetType=OSF.OsfControlTarget.TaskPane;var ed=new ab.a;Ua=Oa.TaskExtensions.vk();Ua=new la.a(this.$,this,Ec,Ua);vb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Xb,vb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(rc,vb,cb);Ua.createUILessSandbox(Ec,rc,(ud,Kd)=>{ud&&!Kd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ud,xa,this.di.jJb),ed.setResult(ud)):ed.setResult(null);this.nYb.remove(I)});this.nYb.ia(I,
ed.task)}}}else d.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}xwe(I){(I=this.uRe(I))&&(I.ml.SharedRuntime||this.bHb(I.controlId))}bHb(I){(I=this.uRe(I))&&this.tPa(I.controlId)}cgh(I,xa){if(!this.vf||!I||!xa)return!1;if(I.toLowerCase()===xa.toLowerCase())return!0;let Ua=null,vb=null;for(let cb=0,Xb=this.vf.length;cb<Xb;cb++){const rc=this.vf[cb];if(rc.ownerAddinSolutionId&&(rc.controlId===I&&(Ua=rc.ownerAddinSolutionId.toLowerCase()),rc.controlId===
xa&&(vb=rc.ownerAddinSolutionId.toLowerCase()),Ua&&vb))break}return Ua&&Ua===vb?!0:!1}oBg(I){this.en(I.InstanceId)||(I=new ta(this,this.di,I),this.vf.push(I),this.Jwa=null)}jOf(I){if(this.vf&&0<=I&&I<this.vf.length){const xa=this.vf[I],Ua=xa.ky;this.vf.splice(I,1);this.Tuf(xa);Va.DOMElementExtensions.nf(Ua)}}tPa(I){if(this.vf)for(let xa=0,Ua=this.vf.length;xa<Ua;xa++)if(this.vf[xa].controlId===I){this.jOf(xa);break}}$9i(I){if(this.vf){I=I.toLowerCase();for(let xa=0,Ua=this.vf.length;xa<Ua;xa++)if(I===
this.vf[xa].ownerAddinSolutionId.toLowerCase()){this.jOf(xa);break}}}PLg(I){I.kn&&(this.en(I.floatingObject.ml.InstanceId)||(this.Edc(I.floatingObject.ml.InstanceId)||this.pnc.push(I.floatingObject.ml.InstanceId),this.ZGa(I.floatingObject.ml)),this.ea.isNamedObjectViewMode&&this.iLg(I.floatingObject.ml.InstanceId,I.Hd))}L$(I){if(this.vf)for(let xa=0,Ua=this.vf.length;xa<Ua;xa++)if(1===this.vf[xa].controlType&&ge.a.equals(this.vf[xa].JT,I,!0))return this.vf[xa].controlId;return null}ozh(I){const xa=
[];if(this.vf)for(let Ua=0,vb=this.vf.length;Ua<vb;Ua++)ge.a.equals(this.vf[Ua].JT,I,!0)&&xa.push(this.vf[Ua].controlId);return xa}Uzh(I,xa){if(!xa||!I)return null;if(this.vf)for(let Ua=0,vb=this.vf.length;Ua<vb;Ua++)if(1===this.vf[Ua].controlType&&ge.a.equals(this.vf[Ua].JT,I,!0)&&this.vf[Ua].ml.SharedRuntime&&ge.a.equals(this.vf[Ua].ml.SharedRuntime.Resid,xa.Resid,!0))return this.vf[Ua].controlId;return null}B2a(I,xa=null){return I?xa?`${I}.${xa}`:I:""}Awe(I,xa,Ua){if(this.Jwa===I)return!0;this.Jwa=
I;let vb=null,cb=!1;if(!vb&&this.vf)for(let Xb=0,rc=this.vf.length;Xb<rc;Xb++)if(1===this.vf[Xb].controlType&&ge.a.equals(this.vf[Xb].JT,I,!0)){let Ec=!1,ed=!1;xa?(Ec=!0,ed=!!this.vf[Xb].ml.SharedRuntime&&ge.a.equals(this.vf[Xb].ml.SharedRuntime.Resid,xa.Resid,!0)):Ua&&(Ec=!0,ed=ge.a.equals(this.vf[Xb].ml.SharedRuntimeId,Ua,!0));if(!Ec||ed){ed&&this.vf[Xb].hg(!0);vb=this.vf[Xb].controlId;cb=!0;this.Jwa=null;break}}vb&&this.raiseEvent("ca",vb);return cb}setAppRuntimeState(I,xa){var Ua;if(I){const vb=
this.en(I);if(vb&&bb.HelperMethods.qw(vb.ml))vb.hg(xa),xa&&(this.raiseEvent("ca",I),(null===(Ua=vb.ky)||void 0===Ua?0:Ua.firstChild)&&(I=vb.ky.firstChild.title)&&0<I.length&&this.nZb.nmj(I));else throw d.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(pe.a.instance.ga(2242));}else throw d.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(pe.a.instance.ga(2243));}getAppRuntimeState(I){if(I)if((I=
this.en(I))&&bb.HelperMethods.qw(I.ml))I=I.ml.TaskpaneVisible;else throw d.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(pe.a.instance.ga(2242));else throw d.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(pe.a.instance.ga(2243));return I}W1a(I,xa){return(I=this.en(I))?I.W1a(xa):null}e5a(I){return this.Cwe(this.pnc,I)}Edc(I){return this.Cwe(this.fEe,I)}Rje(I){this.fEe.push(I)}AY(I){return(I=
this.en(I))?I.ml:null}Pwd(I){this.raiseEvent("ekros",I,this)}vAd(I){if(I){var xa=this.en(I.InstanceId);xa&&(I.SharedRuntime||I.SharedRuntimeId||(this.tPa(xa.controlId),this.Qh.purgeOsfControl(xa.controlId,!1)),xa={},xa.SolutionId=I.PrimaryMarketplace.SolutionId,xa.TargetType=I.WebExtensionType,xa.Version=I.PrimaryMarketplace.SolutionVersion,xa.StoreType=I.PrimaryMarketplace.MarketplaceType,xa.StoreId=I.PrimaryMarketplace.MarketplaceRef,xa.AssetId=I.PrimaryMarketplace.SolutionId,xa.AssetStoreId=I.PrimaryMarketplace.MarketplaceRef,
xa.Width=I.TaskpaneWidth,xa.SharedRuntimeId=I.SharedRuntimeId,this.N9f(xa))}}Lha(){this.di.Lha()}zM(I,xa,Ua){this.di.zM(I,xa,Ua)}XRe(I,xa){xa=wd.A8g(xa);I=this.AY(I);this.di.h8b(I.InstanceId,2202,Ta.a.bW,xa)}$9c(I){for(let xa=0,Ua=this.vf.length;xa<Ua;xa++)this.XRe(this.vf[xa].controlId,I)}eAh(I,xa){xa=wd.S3g(xa);this.di.h8b(I,65539,"",xa)}gAh(I,xa,Ua){this.di.h8b(I,1,xa,Ua)}dAh(I,xa){this.di.hAh(I,xa)}j3g(I,xa){return[[2,1E3,"",JSON.stringify([I,xa]),0,!1]]}Sdi(){return!!this.qma&&this.qma.f5e()}XWg(){this.qma&&
this.qma.clear()}fAh(){if(this.qma&&this.qma.f5e()){var I=this.qma.tGh();for(const xa of I){I=this.ozh(xa);for(const Ua of I)this.di.h8b(Ua,65540,"","{}")}}}N6i(I){this.qma.add(I)}qOj(I){this.qma.remove(I)}cia(I){if(!this.vf)return null;for(const xa of this.vf)if(I(xa))return xa;return null}WBe(I){const xa=new ab.a,Ua=wd.kua(I,this.$);if(bb.HelperMethods.qw(I))d.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.xFf(I,vb=>{vb?(I.InstanceId=vb.InstanceId,I.WebExtensionOsfControlType=
3,I.TaskpaneVisible=!1,this.ZGa(I),xa.setResult(I.InstanceId)):(d.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(I.PrimaryMarketplace.SolutionId,I.PrimaryMarketplace.MarketplaceType,null,null,null,I.PrimaryMarketplace.MarketplaceRef)} failed`),xa.setException(Error.create("Null insert data")))});else{wd.p0a.ia(I.InstanceId,new J.a);const vb=wd.p0a.na(I.InstanceId).ata;this.P4g(I,vb,Ua);this.xFf(I,null);xa.setResult(I.InstanceId)}return xa.task}P4g(I,
xa,Ua){this.en(I.InstanceId)||(I=new ta(this,this.di,I),I.Msa=Ua,I.X8e(xa),this.vf.push(I),this.Jwa=null)}xFf(I,xa){const Ua=wd.kua(I,this.$);if(!this.$Bd.contains(Ua))this.hFb.push(I),1<=this.hFb.length&&this.yFf(I,xa);else if(xa)for(const vb of this.AFf)if(wd.kua(vb,this.$)===Ua){xa(vb,0);break}}yFf(I,xa){let Ua=null;const vb={};vb.SolutionId=wd.getSolutionId(I,this.$);vb.TargetType=I.WebExtensionType;vb.Version=I.PrimaryMarketplace.SolutionVersion;vb.StoreType=I.PrimaryMarketplace.MarketplaceType;
vb.StoreId=I.PrimaryMarketplace.MarketplaceRef;vb.AssetId=I.PrimaryMarketplace.SolutionId;vb.AssetStoreId=I.PrimaryMarketplace.MarketplaceRef;vb.Width=I.TaskpaneWidth;vb.ContainsCustomFunctions=!0;bb.HelperMethods.qw(I)&&(vb.SharedRuntimeId=I.SharedRuntime.Resid);const cb=this.$.pa.va;I=this.$.pa.va.Qb();const Xb=cb.Na(9,I);Xb.sharedInfo=vb;const rc=ed=>{ed=Gc.a.kf(ed.data);d.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Pd.a.zc(ed)}`)},
Ec=ed=>{ed&&!Md.a(ed)||d.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(vb.SolutionId,vb.StoreType,vb.AssetId,null,null,vb.StoreId)} finish with errors: ${Pd.a.zc(ed.Errors)}`);this.hFb.shift();0<this.hFb.length&&this.yFf(this.hFb[0],xa)};if(xa){const ed=ud=>{const Kd=ud.Result;(Ua=Kd?Kd.AgaveData:null)||xa(null,ud.Errors?ud.Errors[0].ErrorCause:5001);xa(Ua,0)};I=(ud,Kd,Zd)=>Pb.g(cb,"InsertAgaveTaskpane",Xb,Qd.b(ud,Ec,ed),Qd.a(Kd,rc),
Zd,null,0)}else I=(ed,ud,Kd)=>Pb.g(cb,"InsertAgaveTaskpane",Xb,Qd.b(ed,Ec),Qd.a(ud,rc),Kd,null,0);nb.EwaSettings.fc()?id.a(this.$.userOperationManager,I,ed=>new Lc.a(519,0,ed,64),null):id.a(this.$.userOperationManager,I,ed=>new md.a(519,0,ed),null)}Tvj(){return this.$.me.get(35)}vHd(I){I=this.en(I);(null===I||void 0===I?0:I.Rca)&&I.tOf()}XCi(I){var xa=this.cia(Ua=>wd.hLa(Ua.JT));xa&&(xa=this.Qh.getOsfControl(xa.controlId))&&xa.notifyAgave(OSF.AgaveHostAction.SendMessage,I)}Fei(){return!!this.cia(I=>
1===I.controlType&&wd.hLa(I.JT))}Eei(){const I=this.cia(xa=>wd.hLa(xa.JT));return I?I.ky?Va.DOMElementExtensions.isVisible(I.ky):!1:!1}Apj(){const I=this.cia(xa=>wd.hLa(xa.JT));I&&(I.hg(!0),this.raiseEvent("ca",I.controlId))}initialize(){const {DdaEventDispatch:I}=a(1353),xa=void 0===this.$||null===this.$||nb.EwaSettings.ma(259);void 0!==this.$&&null!==this.$||d.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");xa&&d.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+
this.initialized);this.initialized||(ic.DFa(this.$),this.ea=this.$.ea,this.di=new I(this.$),this.$.el(this.Zc),this.ea.hk(this.Xc),this.ea.ZL(this.Ao),this.ea.Ou(this.Uf),this.$.userOperationManager.Fr(this.aR),this.Njf(),this.iNi(),this.K9h(),this.$.da.Ga(35,this),this.rUc.ka(this),xa&&d.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Ode=new Ta.a,xa&&d.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Rde=new gb(this.$,
this.Yi,this.di),new na(this.$,this.Yi,this.di),this.Pde=new pb(this.$,this.Yi,this.di),this.Nde=new db(this.$,this.Yi,this.di),this.Mde=new Ub(this.$,this.Yi,this.di),this.Qde=new Ya(this.$,this.Yi,this.di),this.Sde=new lb(this.$,this.Yi,this.di),this.Tde=new jb(this.$,this.Yi,this.di),this.$.Xaa&&(this.Ude=new wb(this.$,this.Yi,this.di)),nb.EwaSettings.ma(190)&&(this.v0a=new ua(this,qa.g(this.$))),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.Lde=new ib),this.initialized=!0,d.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}$zh(I){if(!this.pBa)return null;for(let xa=0,Ua=this.pBa.length;xa<Ua;xa++)if(I.startsWith(this.pBa[xa].WebExtensionId))return this.pBa[xa];return null}Njf(){var I,xa=this.ea;if(xa.hc&&!this.tOb){if(xa.workbookContext){if(this.mRc=this.$.ea.Sg.get(22),null===(I=xa.workbookContext.WebExtensions)||void 0===I?0:I.length){I=xa.workbookContext.WebExtensions;xa=!1;for(let Ua=I.length-1;0<=Ua;Ua--){if(!this.ea.isNamedObjectViewMode){this.pnc.push(I[Ua].InstanceId);
if(1!==I[Ua].WebExtensionType){I.splice(Ua,1);continue}if(bb.HelperMethods.qw(I[Ua])&&0!==I[Ua].SharedRuntime.State)1===I[Ua].SharedRuntime.State?I[Ua].TaskpaneVisible=!1:2===I[Ua].SharedRuntime.State?I[Ua].TaskpaneVisible=!0:d.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!I[Ua].ContainsCustomFunctions&&!I[Ua].TaskpaneVisible&&!Aa.a(I[Ua])){I.splice(Ua,1);continue}}const vb=OSF.OsfControl.isFirstPartyStoreString(I[Ua].PrimaryMarketplace.MarketplaceType);if(nb.EwaSettings.ma(186)&&
!vb&&(I.splice(Ua,1),!xa)){xa=!0;const cb=cc.GetServiceTaskFactory.Ta(this.$.da,5,4,3);Oa.TaskExtensions.Aa(cb,()=>{cb.result.Yf(36,null)},this.la,3)}nb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&I[Ua].PrimaryMarketplace&&wd.hLa(I[Ua].PrimaryMarketplace.SolutionId)&&(d.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),I.splice(Ua,1))}this.sBe(I)}}else this.mRc=!1;this.tOb=!0}}C3e(I){const xa=qa.g(this.$),
Ua=xa.ha.Oa.$b;if(Ua&&I){I=!1;if(this.vf)for(const vb of this.vf)if(wd.hLa(vb.JT)||wd.Hhi(vb.JT)){I=!0;break}I||xa.ha.Oa.$G(Ua)}}iNi(){this.Qh&&this.ea.isNamedObjectViewMode&&this.$.oa&&Rc.o(this.$.oa)&&(this.$.da.za(34).vQ?this.$.da.za(34).Ojd():this.$.da.za(34).Nu(this.fTi))}sBe(I){let xa=null;xa=Ua=>{const vb=Ua.WebExtensionData,cb=Ua.IsTaskPane,Xb=Ua.RecordHandler,rc=()=>{this.wOa.shift();0<this.wOa.length&&xa(this.wOa[0])};if(this.L$(vb.PrimaryMarketplace.SolutionId))rc();else{cb&&(vb.WebExtensionOsfControlType=
1);var Ec=Aa.a(vb);if(!cb||vb.TaskpaneVisible||Ec||vb.SharedRuntime&&0!==vb.SharedRuntime.State||vb.ContainsCustomFunctions){var ed=new ta(this,this.di,vb,!cb);d.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(vb.PrimaryMarketplace.SolutionId,vb.PrimaryMarketplace.MarketplaceType,null,null,null,vb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${vb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${bb.HelperMethods.qw(vb)}`);
ed.Bjd();bb.HelperMethods.qw(vb)&&(ed.Msa=wd.kua(vb,this.$),vb.TaskpaneWidth=this.p4b);Ec&&(vb.WebExtensionToolTip="");cb&&vb.TaskpaneVisible&&!Ec&&(vb.TaskpaneWidth=this.p4b);this.vf.push(ed);var ud=this.Jwa=null;ud=Nb.a.instance.HE(()=>{ed.ky&&(fa.a.Ia(ud),ud=null,Xb&&Xb(Ua,ed),rc())},100,yc.a.Yah)}else rc()}};for(let Ua=0;Ua<I.length;Ua++)if(!this.en(I[Ua].InstanceId))if(1!==I[Ua].WebExtensionType)this.ZGa(I[Ua]);else if(!nb.EwaSettings.ma(53))this.wlb(I[Ua],xa);else if(this.$.Bd&8388608||I[Ua].TaskpaneVisible){const vb=
{};vb.marketplaceId=I[Ua].PrimaryMarketplace.SolutionId;vb.marketplaceVersion=I[Ua].PrimaryMarketplace.SolutionVersion;vb.storeType=I[Ua].PrimaryMarketplace.MarketplaceType;vb.storeId=I[Ua].PrimaryMarketplace.MarketplaceRef;vb.targetData=I[Ua];this.Qh.isAddinCommandsAsync(vb,(cb,Xb,rc)=>{if(cb){var Ec=rc.targetData;if(Xb){if(nb.EwaSettings.ma(87))if(vb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())cb=vb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Xb=vb.storeType.toLowerCase()===
OSF.StoreType.PrivateCatalog.toLowerCase(),(cb||Xb)&&bb.HelperMethods.qw(Ec)&&this.wlb(Ec,xa);else if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.m2h(rc,xa);else{let ed=!1;this.pca(ud=>{if(!ud.errorCode){if(ud.value)for(const Kd of ud.value){if(ed)break;ed=Uc.e(Kd[1])===Uc.e(Ec.PrimaryMarketplace.SolutionId)}ed?bb.HelperMethods.qw(Ec)&&this.wlb(Ec,xa):(ud={},ud.SolutionId=rc.marketplaceId,ud.TargetType=Ec.WebExtensionType,ud.Version=rc.marketplaceVersion,
ud.StoreType=Ec.PrimaryMarketplace.MarketplaceType,ud.StoreId=rc.storeId,ud.AssetId=rc.marketplaceId,ud.AssetStoreId=rc.storeId,ud.Width=Ec.TaskpaneWidth,Ec.TaskpaneVisible=!0,this.Eie(ud,Ec,xa))}},!0)}}else this.wlb(Ec,xa)}else cb=rc.targetData,d.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(cb.PrimaryMarketplace.SolutionId,cb.PrimaryMarketplace.MarketplaceType,null,null,null,cb.PrimaryMarketplace.MarketplaceRef)} from ${cb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}m2h(I,
xa){let Ua=!1;this.pca(vb=>{const cb=I.targetData;if(!vb.errorCode){if(vb.value)for(const Xb of vb.value){if(Ua)break;Ua=Uc.e(Xb[1])===Uc.e(cb.PrimaryMarketplace.SolutionId)}Ua?bb.HelperMethods.qw(cb)&&this.wlb(cb,xa):(vb={},vb.SolutionId=I.marketplaceId,vb.TargetType=cb.WebExtensionType,vb.Version=I.marketplaceVersion,vb.StoreType=cb.PrimaryMarketplace.MarketplaceType,vb.StoreId=I.storeId,vb.AssetId=I.marketplaceId,vb.AssetStoreId=I.storeId,vb.Width=cb.TaskpaneWidth,cb.TaskpaneVisible=!0,this.Eie(vb,
cb,xa))}},!0)}wlb(I,xa){const Ua={};Ua.WebExtensionData=I;Ua.IsTaskPane=!0;this.wOa.push(Ua);1===this.wOa.length&&xa(Ua)}Eie(I,xa,Ua){const vb={};vb.ActivationInfo=I;vb.WebExtensionData=xa;vb.IsTaskPane=!1;vb.RecordHandler=(cb,Xb)=>{const rc=cb.ActivationInfo;this.Qh.insertBlankControlWithErrorUX(this.HFb(Xb,rc),()=>{this.tPa(Xb.controlId);this.Qh.purgeOsfControl(Xb.controlId,!1);this.N9f(rc)})};this.wOa.push(vb);1===this.wOa.length&&Ua(vb)}N9f(I){var xa={};xa.solutionId=I.SolutionId;xa.version=I.Version;
xa.storeType=I.StoreType;xa.storeId=I.StoreId;xa.assetId=I.AssetId;xa.assetStoreId=I.AssetStoreId;xa.targetType=I.TargetType;xa.sharedRuntimeId=I.SharedRuntimeId;I=new ba.a;I.add(xa);xa={};xa[M.a.zmb]=I;xa[M.a.cP]=3;I=new xb.a(yd.a.BAb,0,this.$.Mc,0,null);this.$.Ka.Lb(I,xa)}HFb(I,xa){const Ua={};Ua.div=I.ky;Ua.id=I.controlId;Ua.solutionId=xa.SolutionId;Ua.version=xa.Version;Ua.storeId=xa.StoreId;Ua.storeType=xa.StoreType;Ua.osfControlType=OSF.OsfControlTarget.TaskPane;return Ua}eSf(){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const Ua=
[];for(var I=0;I<this.vf.length;I++){var xa=this.vf[I];0!==xa.osfControlType&&3!==xa.osfControlType&&4!==xa.osfControlType||Ua.push(xa)}I=!1;for(xa=0;xa<Ua.length;xa++){const vb=Ua[xa];this.tPa(vb.controlId);!I&&vb&&vb.ml&&(I=bb.HelperMethods.qw(vb.ml))}I&&this.aK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}nb.EwaSettings.ma(400)&&Oa.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ta(this.$.da,278,279,3),Ua=>{Ua&&(Ua=Ua.result)&&(this.$.da.za(278)||this.$.da.Ga(278,Ua),Ua.c$e().uma())},this.la,
3)}VK(){var I=new Jc(this.$,this.Yi,this.eTf);void 0===this.$||null===this.$?d.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):nb.EwaSettings.ma(259)&&d.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Yi||null===this.Yi));if(I.NBi()){const xa=()=>{},Ua=Xb=>{Xb=Gc.a.kf(Xb.data);d.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Pd.a.zc(Xb)}.`)},
vb=I.DQg();I=(Xb,rc,Ec)=>Pb.g(this.$.pa.va,"ExecuteRichApiRequest",this.EQg(vb),Qd.b(Xb,xa),Qd.a(rc,Ua),Ec,null,0);let cb=wd.Rdd(vb);nb.EwaSettings.fc()?(cb|=64,this.$.userOperationManager.$t(new Lc.a(507,0,I,cb))):this.$.userOperationManager.$t(new md.a(507,0,I,cb))}}EQg(I){const xa=this.$.pa.va.Na(1);xa.request=I;return xa}Cwe(I,xa){if(I)for(let Ua=0;Ua<I.length;Ua++)if(ge.a.equals(I[Ua],xa,!0))return!0;return!1}HPg(I){const xa={};xa.navigationMode=OSF.OsfNavigationMode.DefaultMode;xa.assetId=null;
xa.category=null;if(!I||3>I.length)return xa;if(I[0]){const Ua=parseInt(I[0],10);isNaN(parseInt(Ua,10))||(xa.navigationMode=Ua)}I[1]&&(xa.assetId=I[1]);I[2]&&(xa.category=I[2]);return xa}K9h(){if(nb.EwaSettings.ma(61)){var I=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(I&&"*"!==I.trim()){this.$Ha=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new $a(this),I,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.me.get(2));try{this.$Ha.init()}catch(xa){try{this.$Ha.dispose()}catch(Ua){}this.$Ha=
null;d.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+xa.message)}I={};I.a=this.$.ya.UserSessionId;ue.b().Ie(39,I)}}}N1f(I,xa,Ua){const vb=wd.UOg(I[0]),cb=vb.Gga,Xb=vb.yha;vb.Gga=()=>{cb&&cb();const rc=vb.NKa!==OSF.InfoType.Error?xa:null;I.shift();I.length?this.N1f(I,rc,Ua):rc&&rc()};vb.yha=()=>{Xb&&Xb();Ua&&vb.NKa!==OSF.InfoType.Error&&Ua()};R.a.nQd(vb)}UOh(){const I={};I.AddinRibbonControlsOverriddenByApi=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
I.AddinActionDefinitionHybridMode=nb.EwaSettings.ma(636).toString();I.UseActionIdForUILessCommand=nb.EwaSettings.ma(639).toString();I.AllowStorageAccessByUserActivationOnIFrame=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();I.RequirementSetRibbonApiOnePointTwo=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();I.flightingTreatmentVariables=r.AFrameworkApplication.fa.r8b;
I.ShortcutInfoArrayInUserPreferenceData=nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return I}static get k2b(){return wd.J2d}static set k2b(I){wd.J2d=I}static getSolutionId(I){let xa=I.PrimaryMarketplace.SolutionId;nb.EwaSettings.ma(293)&&I.OwnerAddinSolutionId&&(xa=I.OwnerAddinSolutionId);return xa}static Rdd(I){let xa=0;nb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?I.RequestFlags&1&&256!==(I.RequestFlags&
256)||(xa=16):xa=I.RequestFlags&1?0:16;return xa}static kua(I,xa){xa=wd.getSolutionId(I,xa);return wd.MWe(xa,I.PrimaryMarketplace.SolutionVersion,I.PrimaryMarketplace.MarketplaceType,I.PrimaryMarketplace.MarketplaceRef)}static A8g(I){return JSON.stringify({["recording"]:I})}static S3g(I){const xa={};xa.visibility=I?"Visible":"Hidden";return JSON.stringify(xa)}static $Kh(I){let xa=I.getSolutionId(),Ua=I.getVersion(),vb=I.getStoreType();I=I.getStoreId();return wd.MWe(xa,Ua,vb,I)}static MWe(I,xa,Ua,
vb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",I,xa,wd.dXh(Ua).toString(),vb)}static Ifd(I,xa){var Ua=I.split("|");if(7>Ua.length)return d.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Ua[0])return d.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Ua[0]}'.`),null;let vb=Ua[1];const cb=Ua[2],Xb=wd.eXh(Ua[3]),rc=Ua[4];Ua=Ua[5];vb&&vb.length||(vb=Ua);Ua=
{};Ua.InstanceId=String.format("{{{0}}}",P.a.create().toString());Ua.WebExtensionOsfControlType=4;Ua.WebExtensionType=1;Ua.PrimaryMarketplace={};Ua.PrimaryMarketplace.SolutionId=vb;Ua.PrimaryMarketplace.SolutionVersion=cb;Ua.PrimaryMarketplace.MarketplaceRef=rc;Ua.PrimaryMarketplace.MarketplaceType=Xb;Ua.ContainsCustomFunctions=xa?!0:!1;xa&&(Ua.OsfPropertyBag=[["customFunctionAddinId",I]]);return Ua}static eXh(I){I=parseInt(I,10);return I===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:I===OSF.StoreTypeEnum.Catalog?
OSF.StoreType.SPCatalog:I===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:I===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:I===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:I===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:I===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:I===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:I===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:I===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:
I===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static dXh(I){return I===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:I===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:I===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:I===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:I===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:I===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:I===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:I===OSF.StoreType.HardCodedPreinstall?
OSF.StoreTypeEnum.HardCodedPreinstall:I===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:I===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:I===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Aqb(I){const xa={};xa.Version=I.version;xa.AssetId=I.assetId;xa.AssetStoreId=null!==I.assetStoreId?I.assetStoreId.toString():null;xa.StoreType=I.storeType;xa.Height=I.height;xa.SolutionId=I.solutionId;xa.StoreId=I.storeId;xa.TargetType=I.targetType;xa.Width=
1===xa.TargetType?0:I.width;xa.SharedRuntimeId=I.sharedRuntimeId;return xa}static cyb(I){return I===OSF.DDA.EventDispId.dispidSettingsChangedEvent||I===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||I===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||I===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||I===OSF.DDA.EventDispId.dispidRichApiMessageEvent||I===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||I===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||I===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static UOg(I){return Object(b.a)(new hd.a,{NKa:I.infoType,id:I.id,title:I.title,description:I.description,buttonText:I.buttonTxt,Gga:I.buttonCallback,jcc:I.highPriority,yha:I.dismissCallback,errorCode:I.errorCode,e8e:I.iframeNotificationUrl})}static hLa(I){let xa="FA000000014"===I;xa||(xa="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===I);return xa}static Hhi(I){return"FA000000005"===I}}wd.p0a=new E.a;wd.J2d=!0;Object(c.a)(wd,"DdaFacade",
Ca.a,[200,774,742,775,776,3])},735:function(t,D,a){a.d(D,"a",function(){return d});t=a(0);var c=a(15),b=a(112);class d{constructor(){this.RGd=0;this.NV={};this.osa={}}rSh(f,e){return this.NV[d.dXc(f,e)]}xJe(f,e){e||void 0!==this.osa[f]&&null!==this.osa[f]?e&&void 0!==this.osa[f]&&null!==this.osa[f]&&delete this.osa[f]:this.osa[f]=1}fZb(f){return void 0===this.osa[f]||null===this.osa[f]}p1h(f){const e=d.dXc(f.messageType,f.targetId);1===f.actionType?this.M2h(f.controlId,f.messageType,e):2===f.actionType&&
this.w3h(f.controlId,f.messageType,e)}C9i(f){if(f){var e=Object.keys(this.NV);if(!(void 0===e||null===e||0>=e.length))for(const k of e)e=this.NV[k],e[f]&&(delete e[f],Object.keys(e).length||delete this.NV[k])}}mZ(f,e){f=d.dXc(f,e);f=this.NV[f];return!!f&&0<Object.keys(f).length}o4h(){return!b.a.isEmpty(this.NV)}mgf(){return 0<this.RGd}KMh(){const f=[],e=this.NV;for(let m in e){var k=m,l=e[m];for(let v in l){l=v;const n={};n.eventType=parseInt(k.split("#")[0],10);n.targetId=k.split("#")[1];n.addinId=
l;f.push(n)}}return f}M2h(f,e,k){if(this.NV[k])k=this.NV[k],k[f]=k[f]?k[f]+1:1;else{let l={};l[f]=1;this.NV[k]=l}100===e&&this.RGd++}w3h(f,e,k){if(this.NV[k]){const l=this.NV[k];if(f){const m=l[f];1===m?(delete l[f],Object.keys(l).length||delete this.NV[k]):l[f]=m-1;100===e&&this.RGd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${f}] doesn't register event with key[${k}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static dXc(f,
e){return String.format("{0}#{1}",f,e)}}d.bW="Workbook";Object(t.a)(d,"RichApiEventRegistration",null,[])},761:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=d;this.ddaBinding=f;this.ArrayData=e}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(t.a)(c,"DdaEventArgs",null,[])},805:function(t,D,a){t=a(0);class c{constructor(){this.title=
this.id=this.tabs=null}}Object(t.a)(c,"AddInDataTransferObject",null,[]);a.d(D,"a",function(){return b});class b{constructor(d,f,e){this.SOb=d;this.tjg=f;this.ujg=e}get Ks(){return this.SOb}get JAg(){return this.tjg}get KAg(){return this.ujg}static y2a(d){return(d=d.mV)?Object.assign(new c,{tabs:d.Ks.toArray(),id:d.JAg,title:d.KAg}):null}}Object(t.a)(b,"OneLineRibbonExtensibility",null,[])},842:function(t,D,a){a.r(D);t=a(0);var c=a(184),b=a(15),d=a(99);class f{constructor(){this.startTime=0;this.callback=
null}}Object(t.a)(f,"SSOCallbackInfo",null,[]);class e{constructor(){this.accessToken=null}}Object(t.a)(e,"AccessTokenInformation",null,[751]);var k=a(959);class l{constructor(){this.token=null;this.expiresOn=0;this.rga=this.authChallenge=null}}Object(t.a)(l,"CachedTokenInfo",null,[]);class m{constructor(){this.vPb=new c.a;this.e9=this.d9=!1;this.Ena=this.authChallenge=null;this.startTime=this.retryCount=0;this.nne=null}get callbacks(){return this.vPb}}Object(t.a)(m,"SSORequestInfo",null,[]);class v extends m{constructor(){super();
this.errorCode=0}}Object(t.a)(v,"SSOFailedRequestInfo",m,[]);var n=a(4);class w{constructor(T,W,P,E){this.GS=new c.a;this.AG=new c.a;this.Doa=null;this.Xjb=new c.a;this.x9d=Promise.resolve(null);this.Bfe=!1;this.jUb=W;this.kmg=T;this.ege=P;this.yjg=E}Rwj(T){if(this.Doa&&this.Doa.authChallenge===T.authChallenge){if(Date.now()/1E3+w.iyi>this.Doa.expiresOn)return this.Doa=null,!1;T=new k.a;T.token=this.Doa.token;T.expiresOn=this.Doa.expiresOn;T.rga=this.Doa.rga;T.BSa=!0;T.svb=0;this.Kvb(T);return!0}return!1}yvj(T){for(let W=
0;W<this.AG.count;W++)if(this.AG.na(W).authChallenge===T.authChallenge&&this.AG.na(W).Ena===T.Ena){let P;(P=this.AG.na(W)).retryCount=P.retryCount+1;T.retryCount=this.AG.na(W).retryCount;if(this.AG.na(W).retryCount<w.Hyi||!this.AG.na(W).d9&&T.d9||!this.AG.na(W).e9&&T.e9){if(!this.AG.na(W).d9&&T.d9||!this.AG.na(W).e9&&T.e9)T.retryCount=0;this.AG.removeAt(W);break}T=new k.a;T.errorCode=this.AG.na(W).errorCode;this.Kvb(T);return!0}return!1}CCg(T,W){for(let P=0;P<this.AG.count;P++)if(this.AG.na(P).Ena===
T.Ena&&this.AG.na(P).authChallenge===T.authChallenge)return;this.AG.add(Object.assign(new v,{d9:T.d9,e9:T.e9,authChallenge:T.authChallenge,Ena:T.Ena,errorCode:W,retryCount:T.retryCount}))}get resource(){return this.jUb}Tad(T,W,P,E,H,F){const {AppsForOfficeSingleSignOnManager:N}=a(842);""===P&&(P=null);if(this.Bfe)N.S4(F,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var J=null;for(let R of this.GS)if(R.d9===T&&R.e9===W&&R.authChallenge===P&&R.Ena===H){J=R;break}J||(J=Object.assign(new m,
{d9:T,e9:W,authChallenge:P,nne:E,Ena:H,retryCount:0,startTime:N.kw()}),this.GS.add(J));J.retryCount=0;J.callbacks.add(F);this.x9d=this.x9d.then(()=>{var {AppsForOfficeSingleSignOnManager:R}=a(842);if(0<this.GS.count){var M=this.GS.na(0);if(this.Rwj(M)||this.yvj(M))return null;for(let U=0;U<this.Xjb.count;)this.Xjb.na(U)+w.iIj<R.kw()?this.Xjb.removeAt(U):U++;if(this.Xjb.count>=w.Cyi||this.GS.count>=w.eyi)return M=new k.a,M.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.Kvb(M),
null;let L=null;n.AFrameworkApplication.ta&&(R=n.AFrameworkApplication.ta.LD)&&(L=R.xc("ComponentAttach",this.kmg+w.bwg));return M.Ena.Cyg(this.resource,M.d9,M.e9,M.authChallenge,this.yjg,M.nne).then(U=>{L&&L.stop();this.Kvb(U)},()=>{L&&L.stop();const U=new k.a;U.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.Kvb(U)})}return null})}}Kvb(T){const {AppsForOfficeSingleSignOnManager:W}=a(842);try{if(this.GS.count){var P=this.GS.na(0);this.GS.removeAt(0);var E=null;T.errorCode||(E=
new e,E.accessToken=T.token);T.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&T.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&T.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&T.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.CCg(P,T.errorCode);var H={};null!=T.svb&&(H.getTokenSilentTime=T.svb.toString());null!=T.nfd&&(H.getTokenPopupTime=T.nfd.toString());null!=T.bdd&&(H.getIDTokenTime=T.bdd.toString());null!=
T.BSa&&(H.tokenCached=T.BSa.toString());T.XTd&&(H.detailedError=T.XTd);T.rga&&(H.authLibrary=T.rga);P.retryCount&&(H.retryCount=P.retryCount);for(var F of P.callbacks)W.S4(F,T.errorCode,E,H);null!=T.BSa&&T.BSa||this.Xjb.add(P.startTime);if(!T.errorCode)for(null!=T.expiresOn&&(this.Doa=Object.assign(new l,{token:T.token,expiresOn:T.expiresOn,authChallenge:P.authChallenge,rga:T.rga})),this.AG.clear(),F=0;F<this.GS.count;)if(this.GS.na(F).authChallenge===P.authChallenge){for(let N of this.GS.na(F).callbacks)W.S4(N,
T.errorCode,E,H);this.GS.removeAt(F)}else F++}}catch(N){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",N.message)}}shutdown(){this.Bfe=!0;this.GS.clear()}}w.iIj=6E4;w.Cyi=6;w.eyi=6;w.Hyi=3;w.iyi=300;w.bwg="GetAccessToken";Object(t.a)(w,"SSOCallbackManager",null,[]);var r=a(716),u=a(728),x=a(124),z=a(80),B=a(27),y=a(29),A=a(146),K=a(339);a.d(D,"AppsForOfficeSingleSignOnManager",function(){return G});class G{constructor(T,W,P=null){this.KCc=new d.a;const E=new c.a;
W&&E.add(W.Kwi);P&&E.addRange(P);this.Rm=T;this.cxg=E}Uad(T,W,P,E,H,F,N,J,R,M){M=Object.assign(new f,{startTime:G.kw(),callback:M});try{const X=!!P&&""!==P;var L=M.startTime;const da=this.getOsfControl(T);let fa=da.getStoreType()||"",S=da.getOwnerAddinStoreType()||"",ka=da.getSolutionId()||"";const V=da.getVersion()||"";fa=fa.toLowerCase();S=S.toLowerCase();ka=ka.toLowerCase();var U=z.a.$cd(W)||"";const wa=z.a.$cd(da.getIframeUrl())||"",ma=U.toLowerCase()===wa.toLowerCase();U=fa;"inmemory"===fa&&
(U=S);const ab=Telemetry.PrivacyRules.GetPrivacyCompliantId(ka,U,da.getAssetId(),null,null,da.getStoreId()),ba={["callInstanceId"]:L.toString(),["controlAssetId"]:ab,["controlVersion"]:V,["storeType"]:fa,["ownerStoreType"]:S,["allowConsentPrompt"]:E.toString(),["forMSGraphAccess"]:H.toString(),["allowSignInPrompt"]:F.toString(),["hasAddinAuthChallenge"]:X.toString(),["securityOriginEqualsSourceLocation"]:ma.toString(),["singleSignOnEnabled"]:N.toString(),["accountTypeFilter"]:J||""};b.ULS.sendTraceTag(51401115,
344,50,"{0}",ba);A.a.sendTelemetryEvent(Object.assign(new K.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:x.a.Tj(ba)}));L=!0;const Ca=n.AFrameworkApplication.fa.Va("HostAuthType");switch(J){case "aad":L="aad"===Ca;break;case "msa":L="msa"===Ca;break;default:L=!J||"noFilter"===J}if(L){J=null;if(N)for(let Na of this.cxg)if(Na.igi(ka)){J=Na;break}J?this.isSSOAddin(T)?(N=!0,"omex"===U&&(N=!1),"spapp"===U||"spcatalog"===U?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),
G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):H&&!N?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(H&&"exchange"===U&&(E=!1),this.Tad(T,W,P,U,E,F,R,J,M))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(X){this.qic(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",X.message),G.S4(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(T,W,P,E){this.Uad(T,P[r.a.$Tc]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,W,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,E)}Tad(T,W,P,E,H,F,N,J,R){this.KCc.lb(T)?E=this.KCc.na(T):(E=new w(T,this.getWebApplicationResource(T).split(",")[0],E,this.getDefaultDisplayName(T)),this.KCc.add(T,E));const M=E.resource;T=G.XUh(M,this.getWebApplicationId(T));const L=OfficeExt.WACUtils.getHostSecure(W);
T&&L?T.toLowerCase()===L.toLowerCase()?E.Tad(H,F,P,N,J,R):(G.VMa('SSO Resource "'+M+'" cannot be used from "'+W+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),G.S4(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(T||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),L||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),G.S4(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))}qic(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(T){return this.Rm.getOsfControl(T)}isSSOAddin(T){return this.getOsfControl(T).getManifest().isSSOAddin()}getWebApplicationId(T){return this.getOsfControl(T).getManifest().getWebApplicationId()}getWebApplicationResource(T){return this.getOsfControl(T).getManifest().getWebApplicationResource()}getDefaultDisplayName(T){return this.getOsfControl(T).getManifest().getDefaultDisplayName()}static GWh(){try{const T=
{};B.a.Bwa&&u.a.Bwb&&(T.UiHostSupportsAuthTokenAddinList=G.eSe);T.UiHostSupportsAuthToken=u.a.Bwb;return T}catch(T){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",T.message)}return null}static getInstance(T,W,P=null){G.Ma||(G.Ma=new G(T,P));return G.Ma}static VMa(T){window.console.warn&&window.console.warn(T)}static XUh(T,W){if(!T)return"";W||(W="");let P=T.toLowerCase();var E=W.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(E)||
(G.VMa('SSO App Id "'+W+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));P.endsWith(E)||(G.VMa('SSO Resource "'+T+'" does not end with App Id "'+W+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!P.startsWith("https://")&&!P.startsWith("api://"))return G.VMa('SSO Resource "'+T+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(W=0;W<T.length;W++){E=T.charAt(W);const H=y.a.charCodeAt(T,W);if(33>H||126<H||"&"===E||"?"===E||"#"===E||"%"===E||"\\"===E)return G.VMa('SSO Resource "'+T+'" contains an invalid character "'+E+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+E+"' in resource URI."),""}if(0<=T.indexOf("::"))return G.VMa('SSO Resource "'+T+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
T.length)return G.VMa('SSO Resource "'+T+'" is '+T.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+T.length+"."),"";P.startsWith("api://")&&(P="https://"+P.substring(6,P.length));return 8===P.length?"":OfficeExt.WACUtils.getHostSecure(P)||""}static S4(T,W,P,E){var H=T.startTime;let F=0;0<H&&(F=G.kw()-H);H={["callInstanceId"]:H.toString(),["callDuration"]:F.toString(),["errorCode"]:W.toString()};if(E)for(let N in E)H[N]=
E[N];b.ULS.sendTraceTag(51401116,344,50,"{0}",H);A.a.sendTelemetryEvent(Object.assign(new K.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:x.a.Tj(H)}));T.callback(W,P)}static kw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(T){}return Date.now()}}G.eSe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");G.Ma=null;Object(t.a)(G,
"AppsForOfficeSingleSignOnManager",null,[715])},858:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);var c=a(14);class b{constructor(){this.APe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.zPe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1630),c.a.instance.ga(1634)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1631),c.a.instance.ga(1635)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1632),c.a.instance.ga(1636)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1633),c.a.instance.ga(1637)]};this.g7b=null}get fha(){return"SourceControlId"}get PM(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}PQh(){if(!this.g7b){this.g7b={};for(const d of Object.keys(this.APe))this.g7b[d]=this.APe[d];for(const d of Object.keys(this.zPe))this.g7b[d]=this.zPe[d][0]}}}Object(t.a)(b,"AddinCommandsStringProvider",null,[806])},860:function(t,D,a){a.d(D,"a",function(){return c});
t=a(0);class c{constructor(){this.NKa=0;this.Gga=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.jcc=!1;this.e8e=this.yha=null}}Object(t.a)(c,"AddInCommandsNotificationParameters",null,[])},931:function(t,D,a){t=a(0);var c=a(15),b=a(83),d=a(151),f=a(13),e=a(88);class k extends Sys.UI.Control{constructor(E,H,F,N){super(document.createElement("div"));this.lS=this.jS=this.Xw=this.xG=this.CG=this.yoa=this.cqa=null;this.Jhb=this.ppa=!1;this.content=this.Cp=null;this.z0=0;
this.Xre=null;this.lT=0;this.SBf=null;this.Bge=E;this.Nbe=H;this.QO=F;this.tJ=N;this.qg=H.ownerDocument;this.Kbc=this.it=this.bib=!1}get pV(){this.cqa||(this.cqa=this.qg.createElement("div"),this.cqa.id=this.ei("WACCalloutOuter"),this.cqa.className="WACCalloutOuter",this.cqa.setAttribute(e.a.Kd,e.a.DYa),this.cqa.style.width=this.z0+"px");return this.cqa}get Onb(){if(!this.yoa){this.yoa=this.qg.createElement("div");this.yoa.id=this.ei("WACCalloutBeakContainer");this.yoa.className="WACCalloutBeakContainer";
var E="CalloutBeakTopFilled_32x16x32";if(5===this.lT||6===this.lT||4===this.lT)E="CalloutBeakBottomFilled_32x16x32";E=d.createClusteredImage(32,16,E,"WACCalloutBeak",!0,"");this.yoa.appendChild(E)}return this.yoa}set Onb(E){this.yoa=E}get pLa(){return this.bib}get title(){return this.Cp}set title(E){this.Cp!==E&&(this.Cp=E,this.jS&&(this.jS.innerText=this.Cp))}get it(){return this.ppa}set it(E){this.ppa!==E&&(this.ppa=E,this.CG&&(this.CG.contains(this.Xw)&&!this.ppa?this.CG.removeChild(this.Xw):!this.CG.contains(this.Xw)&&
this.ppa&&this.Kje()))}get Kbc(){return this.Jhb}set Kbc(E){this.Jhb!==E&&(this.Jhb=E,this.CG&&(this.CG.contains(this.jS)&&!this.Jhb?this.CG.removeChild(this.jS):!this.CG.contains(this.jS)&&this.Jhb&&this.cle()))}show(){this.bib||(this.k5g(),this.io(),this.Nbe.appendChild(this.pV),this.pV.style.display="Block",this.vsj(),this.bib=!0,this.SBf&&this.SBf())}dismiss(){this.bib&&(this.E0a(),this.Nbe.removeChild(this.pV),this.bib=!1,this.tJ&&this.tJ())}dispose(){this.dismiss();this.jS=this.Xw=this.xG=this.yoa=
this.CG=this.cqa=null;Sys.Component.prototype.dispose.call(this)}ei(E){return this.get_element().id+E}k5g(){this.CG=this.qg.createElement("div");this.CG.id=this.ei("WACCalloutHeader");this.CG.className="WACCalloutHeader";this.it&&this.Kje();this.Kbc&&this.cle();this.xG=this.qg.createElement("div");this.xG.id=this.ei("WACCalloutContent");this.xG.className="WACCalloutContent";this.xG.style.width=190<this.z0?this.z0-26+"px":"164px";this.xG.appendChild(this.content);this.pV.appendChild(this.Onb);this.pV.appendChild(this.CG);
this.pV.appendChild(this.xG)}Kje(){this.Xw=this.qg.createElement("a");this.Xw.className="WACCalloutCloseAnchor";this.Xw.id=this.ei("WACCalloutCloseAnchor");this.Xw.href="#";this.CG.appendChild(this.Xw);const E=d.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Xw.appendChild(E)}cle(){this.jS=this.qg.createElement("div");this.jS.className="WACCalloutTitle UIFontBold";this.jS.style.width=190<this.z0?this.z0-30+"px":"160px";this.jS.id=
this.ei("WACCalloutTitle");this.jS.innerText=this.title;this.CG.contains(this.Xw)?this.CG.insertBefore(this.jS,this.Xw):this.CG.appendChild(this.jS)}vsj(){var E=this.Bge;let H;if(1===this.lT){var F=this.Xre.y+16;H=-16}else 2===this.lT||3===this.lT||0===this.lT?(F=E.y+E.height+15,H=-15):(F=E.y-this.pV.clientHeight-15-2,H=this.pV.clientHeight-1);this.pV.style.top=F+"px";this.Onb.style.top=H+"px";1===this.lT?(E=this.Xre.x-16,this.pV.style.left="50%",this.pV.style.marginLeft=-this.z0/2+"px",F=Sys.UI.DomElement.getBounds(this.pV),
this.Onb.style.left=E-F.x+"px"):(F=E.x+this.Bge.width/2,2===this.lT||5===this.lT?(E=20,F-=36):0===this.lT||4===this.lT?(E=this.z0/2-16,F-=this.z0/2):(E=this.z0-20-32,F=F-this.z0+36),this.pV.style.left=F+"px",this.Onb.style.left=E+"px")}io(){this.it&&!this.lS&&(this.lS=Object(b.a)(this,this.O9,"closeHandler"),this.QO.ra(f.a.click,this.Xw,this.lS,null))}E0a(){this.it&&this.lS&&(this.QO.Ba(f.a.click,this.Xw,this.lS),this.lS=null)}O9(){this.dismiss();return!0}}Object(t.a)(k,"Callout",Sys.UI.Control,[90]);
class l extends k{constructor(E,H,F,N,J,R=null){super(E,F,J.tW,R);this.W$d=0;this.z0=this.UQh(N);this.YWa=H;this.We=J;this.jJj=7;this.pl=this.YWa.ownerDocument.createElement("div");this.pl.className="ModalCalloutControlOverlay";this.pl.tabIndex=0;this.YWa.insertBefore(this.pl,this.YWa.firstChild)}show(){this.pLa||(this.We.Coc(),this.We.kP(!1),this.pl.style.zIndex=String(this.We.u1),super.show(),this.Bj(),this.W$d=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.jJj))}dismiss(){this.pLa&&
(this.We.vM(!1),this.ek(),this.YWa&&this.YWa.contains(this.pl)&&this.YWa.removeChild(this.pl),super.dismiss(),window.clearTimeout(this.W$d))}Bj(){this.We.cra(Object(b.a)(this,this.dismiss,"dismiss"));this.We.zy.ra(f.a.click,this.pl,Object(b.a)(this,this.dd,"onClick"))}ek(){this.We.Gab(Object(b.a)(this,this.dismiss,"dismiss"));this.We.zy.Ba(f.a.click,this.pl,Object(b.a)(this,this.dd,"onClick"))}dd(){this.dismiss();return!0}UQh(E){let H=0;switch(E){case 0:H=190;break;case 1:H=250;break;case 2:H=300;
break;case 3:H=360}return H}}Object(t.a)(l,"ModalCallout",k,[]);var m=a(560),v=a(197);class n extends l{constructor(E,H,F,N,J,R=null){super(E,H,F,N,J,R);this.$Sb=null}show(){if(!this.pLa){const E=Object.assign(new m.a,{onShow:()=>{l.prototype.show.call(this)}});v.UISurfaces.iQ().then(H=>{const F=H.externalNotification();this.$Sb=H.addNotification(F,E);return null},H=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null})}}dismiss(){this.pLa&&this.$Sb&&(v.UISurfaces.iQ().then(E=>
{E.removeNotification(this.$Sb);return this.$Sb=null},E=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null}),super.dismiss())}}Object(t.a)(n,"ReactManagedModalCallout",l,[]);var w=a(4);class r{static W6g(E,H,F){return w.AFrameworkApplication.ta.Pa.AQ?new n(E,H,F,3,w.AFrameworkApplication.ta,null):new l(E,H,F,3,w.AFrameworkApplication.ta,null)}}Object(t.a)(r,"ModalCalloutControlFactory",null,[]);var u=a(53),x=a(856),z=a(576),B=a(857),y=a(133),A=a(56),K=a(39),
G=a(82),T=a(805),W=a(691);a.d(D,"a",function(){return P});class P{static get nZb(){return P.mea||(P.mea=G.a.instance.uh("Common.Utils.IAriaNotifier"))}static zBe(E,H,F,N){P.XI&&P.XI.pLa&&P.XI.dismiss();P.XI=r.W6g(H,E,E);P.XI.content=F;W.b(N)||(P.XI.title=N,P.XI.Kbc=!0);E=new Sys.UI.Bounds(0,0,A.a.Iac(),A.a.Hac());P.XI.lT=P.NIh(E,H,P.XI.z0);P.XI.show();P.nZb&&P.nZb.sendNotification(F.innerText,!0)}static D1c(E,H,F,N=null){v.UISurfaces.iQ().then(J=>{let R=null;P.Ujb&&(J.removeNotification(P.Ujb),P.Ujb=
null);const M=J.callout(Object.assign(new x.a,{target:E,title:H,content:F,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:()=>{J.removeNotification(R)},directionalHint:null!=N?N:null})})),L=Object.assign(new m.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:()=>{J.removeNotification(P.Ujb)}})});R=P.Ujb=J.addNotification(M,L);return null},J=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
J);return null})}static lQd(E,H=null){P.XI&&P.XI.pLa&&P.XI.dismiss();const F=new y.StandardDialog;F.ARa=!1;F.Sb=0;F.Wz(u.a.Mpi,CommonUIStrings.l_DialogError,W.b(E)?P.VWe():E,H)}static nQd(E){P.XI&&P.XI.pLa&&P.XI.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",E.errorCode));const H=W.b(E.description)?P.VWe():E.description,F=new y.StandardDialog;let N=null;E.Gga?(F.Sb=1,F.sc(1,E.buttonText),F.P_(1)):F.Sb=0;N=J=>{1===J?E.Gga():E.yha&&E.yha()};
F.ARa=!1;0===E.NKa?F.Wz(E.errorCode,E.title?E.title:CommonUIStrings.l_DialogError,H,N):1===E.NKa?F.mW(E.title?E.title:CommonUIStrings.l_DialogWarning,H,N):F.$za(E.title?E.title:CommonUIStrings.l_DialogInfo,H,N)}static NIh(E,H,F){let N=4;const J=E.x+E.width-H.x-H.width;H.x-E.x+H.width/2<=F/2?N=5:J+H.width/2<=F/2&&(N=6);return N}static xyj(E,H,F,N=!1){(H=T.a.y2a(H))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(H,J=>{J&&(N||P.D1c(J,
F,E,5))})}static yyj(E,H,F=!1){P.xyj(H.startedNode?H.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,E),H,H.startedNode?H.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,E),F)}static wyj(E,H,F,N){if(P.Gdg)E=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,F,N,CommonUIStrings.l_InsertionDialogRefresh)),P.D1c(H,E,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{H=
K.a.$o(H);var J=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),R=document.createElement("span");R.innerText=J[0];var M=document.createElement("span");M.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,F,N,CommonUIStrings.l_InsertionDialogRefresh);M.className="UIFontBold";F=document.createElement("span");F.innerText=J[1];N=document.createElement("div");Sys.UI.DomElement.addCssClass(N,"ModalCalloutControl");N.appendChild(R);N.appendChild(M);N.appendChild(F);
P.zBe(E,H,N,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static Pzj(E,H){var F=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,N=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;P.Gdg?P.D1c(H,F,N):(H=K.a.$o(H),P.zBe(E,H,P.jRg(N),F))}static jRg(E){const H=document.createElement("div");Sys.UI.DomElement.addCssClass(H,"ModalCalloutControl");H.innerText=E;return H}static VWe(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Gdg(){return w.AFrameworkApplication.ta.Pa.Fi&&
w.AFrameworkApplication.ta.Pa.AQ}}P.XI=null;P.Ujb=null;P.mea=null;Object(t.a)(P,"AddInCommandsNotificationFactory",null,[])},941:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(1450),d=a(146),f=a(124),e=a(716),k=a(730),l=a(339);class m{constructor(u,x,z,B){this.pA=!1;this._id=u;this.ex=x;this.M0=z;this.Ld=B}get enabled(){return this.pA}set enabled(u){const {DynamicRibbon:x}=a(941);var z=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,y=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,z,null,null,null,B);z={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,z,y,null,null,B),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:u};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:x.eyc+"ControlUpdate",dataFields:f.a.Tj(z)}));this.pA=u;this.M0.aK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.ex,["PrivacyCompliantSolutionId"]:A,
["SourceControlId"]:this.id,["MethodData"]:this.pA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,
x){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,x){this.invokePropertySet(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,x){switch(u){case 5:return this.gpj(x);case 1:return this.CBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,x){u=this.invokeMethod(u,
x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}gpj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null}CBa(){this._OnAccess();return null}}Object(t.a)(m,"RibbonButton",null,[]);class v{constructor(u,x,z,B){this._id=u;this.ex=x;this.M0=z;this.Ld=B}get id(){return this._id}setVisibility(u){const {DynamicRibbon:x}=a(941),z=this.Ld.OwnerAddinStoreType;var B=this.Ld.PrimaryMarketplace.MarketplaceRef;const y=this.Ld.AssetMarketplace?
this.Ld.AssetMarketplace.SolutionId:null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,z,y,null,null,B);B={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,z,y,null,null,B),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:u};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:x.eyc+"ControlUpdate",dataFields:f.a.Tj(B)}));this.M0.aK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.ex,
["PrivacyCompliantSolutionId"]:A,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:u})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,x){this.invokePropertySet(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,x){switch(u){case 3:return this.Zsj(x);case 1:return this.CBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,x){u=this.invokeMethod(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}Zsj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);
return null}CBa(){this._OnAccess();return null}}Object(t.a)(v,"RibbonTab",null,[]);var n=a(963),w=a(173);a.d(D,"DynamicRibbon",function(){return r});class r{constructor(u,x,z,B,y){this.ex=u;this.NI=z;this.M0=B;this.Ld=y;this.qgb=this.NI.Qh;this.Gy=this.qgb.getOsfControl(x);this.Nrg=this.Gy.getManifest()}get buttons(){return null}executeRequestCreate(u){try{var x=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,y=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,x,y,null,null,B);const A={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,y,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.eyc+"ExecuteRequestCreate",dataFields:f.a.Tj(A)}));const K=w.a.Uh(u);u={};x={};x[e.a.UHa]=this.Gy;x[e.a.VHa]=K;x[e.a.M5c]=this.Ld;u[e.a.Mrb]=
3;u[e.a.S2]=this.ex;u[e.a.M5b]=z;u[e.a.R2]=x;this.M0.aK(-1014260128,u);let G=r.f9b("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,G)}catch(B){z=r.f9b("ExecuteRequestCreate",!1,B.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(u){try{var x=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,y=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ex,x,y,null,
null,B);const A={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,y,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.eyc+"ExecuteRequestUpdate",dataFields:f.a.Tj(A)}));const K=w.a.Uh(u);u={};x={};x[e.a.UHa]=this.Gy;x[e.a.VHa]=K;x[e.a.M5c]=this.Ld;u[e.a.Mrb]=3;u[e.a.S2]=this.ex;u[e.a.M5b]=z;u[e.a.R2]=x;this.M0.aK(-1014260128,
u);let G=r.f9b("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,G)}catch(B){z=r.f9b("ExecuteRequestUpdate",!1,B.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(u){let x=null;if(!this.Bbf())return this.BBe();if(u&&0<u.length){if(!this.Owe(u))return this.UBe(u);x=new m(u,this.ex,this.M0,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}getTab(u){let x=null;if(!this.Bbf())return this.BBe();if(this.Gy.getOwnerAddinControlRecreated())return this.j6g();
if(u&&0<u.length){if(!this.Owe(u))return this.UBe(u);x=new v(u,this.ex,this.M0,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,x){this.invokePropertySet(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u){switch(u){case 1:return this.CBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,x){switch(u){case 7:return this.jwh(x);case 6:return this.kwh(x);case 3:return this.sIh(x);case 5:return this.FXh(x)}u=this.invokeMethod(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}jwh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"string");return this.executeRequestCreate(u)}kwh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)}sIh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)}FXh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)}CBa(){this._OnAccess();return null}UBe(u){return n.a(k.a.K1g,w.a.ga(1763)+u)}BBe(){return n.a(k.a.Xgj,w.a.ga(1759))}j6g(){return n.a(k.a.hostRestartNeeded,
w.a.ga(1764))}Bbf(){var u=this.Gy.getSharedRuntimeId();u=!!u&&0<u.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u}Owe(u){const x=this.Nrg.getRibbonExtensionControlMap();return u in x||this.WVg(u)}WVg(u){var x=this.Qzh();if(x){x=x.tIe;for(const z of x.tabs){if(z.id===u)return!0;for(const B of z.groups)for(const y of B.controls){if(y.id===u)return!0;if("Menu"===y.type){x=y;for(const A of x.items)if(A.id===u)return!0}}}}return!1}Qzh(){return b.a.getInstance().aia(this.Ld.PrimaryMarketplace.MarketplaceType,
this.Ld.PrimaryMarketplace.SolutionId,1)}static f9b(u,x,z){const B={};B.methodName="DynamicRibbon."+u;B.result=x?"Succeeded":"Failed";B.message=z;return w.a.Ac(B)}}r.eyc="Office.Online.Extensibility.Ribbon.";Object(t.a)(r,"DynamicRibbon",null,[])},950:function(t,D,a){a.d(D,"a",function(){return b});var c=a(951);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},955:function(t,D,a){a.d(D,"a",function(){return c});
t=a(0);class c{constructor(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Hdb=this.I3=this.Sk=null;this.isFirstPartyOptOutAppContextOptmization=!1}}c.key="InsertAgaveClientSideParametersKey";Object(t.a)(c,"InsertAgaveClientSideParameters",null,[])},956:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.Fsb="extId";c.Jze="ComponentType";c.dha="ComponentId";c.iid="HostProps";c.zla="OptionalProps";Object(t.a)(c,"ActionPropertyNames",null,[])},958:function(t,D,a){a.d(D,"a",function(){return c});
const c=(b,d)=>{let f=!1;b&&(b=d.osfControl,(d=b.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},959:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.rga=this.BSa=this.bdd=this.nfd=this.svb=this.XTd=null}}Object(t.a)(c,"AppsForOfficeOauthResult",null,[])},963:function(t,D,a){a.d(D,"a",function(){return c});const c=(b,d)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
e)=>{e(OfficeExtension.WacRuntime.Utility.createRichApiException(b,d))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/0b495c9a844cba168fceb69add8626e1/EwaDSEsNext.agave.js.map