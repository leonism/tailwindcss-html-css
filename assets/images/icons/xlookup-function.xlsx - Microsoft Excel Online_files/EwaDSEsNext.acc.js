'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1114:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1115:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1116:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-svg-icon{height:100%;width:100%}")}},1117:function(t,D,a){function c(m,v){this.ID=m;this.type=v}function b(m,v){this.value=m;this.contextId=v}function d(m,v,n,w,r,u,x,z){this.type=m;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==w||void 0==w.value?new b(w,null):w;null!=r&&void 0!=r.value||new b(r,null);null!=u&&void 0!=u.value||new b(u,null);this.operationType=z}function f(m){this.ID=
m}function e(){this.Ie=[];this.Pmb=[];this.FUc=0;this.duration=this.startTime=null;this.T5b={};this.zud=this.dvd=this.bWc=-1}function k(m){var v;return(null!=document.body.style.msTransform?v=m.style.msTransform:null!=document.body.style.webkitTransform?v=m.style.webkitTransform:null!=document.body.style.mozTransform?v=m.style.lZj:null!=document.body.style.oTransform?v=m.style.nZj:null!=document.body.style.transform&&(v=m.style.transform),v)?(v=v.replace("rotate(",""),v=v.replace("deg)",""),parseFloat(v)):
0}a.d(D,"a",function(){return k});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),zZj:new b(0,null),RYj:new b(0,null),operationType:0};t=Array(1);t[0]=new b(0,0);new f(0,[new d(5,0,0,0,null,1,1,0)]);new f(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new f(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new f(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new f(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,1,1,0)]);new f(5,[new d(5,2,0,167,null,
0,1,0)]);new f(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new f(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new f(8,[new d(5,2,0,100,null,1,1,0)]);new f(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new f(10,[new d(5,2,0,100,null,0,1,0)]);new f(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new f(13,[new d(5,2,0,267,null,1,1,0)]);new f(14,[new d(5,2,0,0,null,0,2,0),new d(5,
2,0,267,null,1,1,0)]);new f(15,[new d(5,2,0,267,null,0,1,0)]);new f(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new f(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new f(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new f(19,[new d(5,2,0,750,null,1,1,0)]);new f(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new f(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new f(22,[new d(1,3,0,367,null,0,1,1),new d(2,3,0,367,null,0,
1,1)]);new f(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new f(24,[new d(5,2,0,367,null,1,1,0)]);new f(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new f(26,[new d(5,2,0,367,null,0,1,0)]);new f(27,[new d(6,2,0,t[0],null,0,1,1),new d(7,2,0,t[0],null,0,1,1)]);new f(28,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new f(29,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new f(30,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,
null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new f(31,[new d(2,0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new f(32,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new f(33,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,2,0),new d(5,2,101,267,null,1,1,0)]);new f(34,
[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,1)]);new f(35,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new f(36,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new f(37,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new f(38,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,267,null,0,1,1)]);new f(39,[new d(1,3,0,267,
null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(40,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new f(41,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(m,16)}}();e.prototype={Ie:null,NIg:5,Pmb:null,FUc:0,startTime:null,
duration:null,T5b:null,bWc:-1,dvd:-1,zud:-1};e.prototype.Start=function(){this.startTime=new Date;this.T5b={}};e.prototype.GetRecentAnimationStats=function(){var m,v=[],n=0;for(m=l.FUc;m<l.NIg;m++)null!=l.Pmb[m]&&(v[n]=l.Pmb[m],n++);for(m=0;m<l.FUc;m++)null!=l.Pmb[m]&&(v[n]=l.Pmb[m],n++);return v};e.prototype.GetAnimationSqmStats=function(){var m=[];return m[0]=0>l.bWc?0:l.bWc,m[1]=0>l.dvd?0:l.dvd,m[2]=0>l.zud?0:l.zud,m};var l=new e},1118:function(t,D,a){a.d(D,"a",function(){return l});t=a(0);D=a(38);
var c=a(214),b=a(357),d=a(183),f=a(42),e=a(604),k=a(1);class l extends D.a{constructor(m){super();this.ES=[];this.mf=(n,w)=>{var r,u=w.gd.block;n=!1;if(u.Ck&&u.state&1&&(r=this.view.Lf(w.gd.block.se.BlockCachePosition.PaneType).rG(w.gd.hash))){u=this.YEd(u.he);if(r=r.qf)for(let x=this.ES.length-1;0<=x;x--)r.contains(this.ES[x].bottomRight)&&(this.ES.splice(x,1),n=!0);if(u)for(let x=0,z=u.length;x<z;x++)this.rangeList.push(d.a.bQ(u[x])),n=!0;n&&(w=(k.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
this.view.Bnc(w.gd.block.se.BlockCachePosition.PaneType):this.view.ZX).rG(w.gd.hash),this.raiseEvent(l.ZEd,new e.a(w)))}};this.Lm=()=>{this.XGb()};this.yo=()=>{this.ES=[]};this.Qhe=m;var v=m.Ea;v.Ms(this.mf);v.bga(this.mf);v.AXb(this.mf);v.KG(this.Lm);m.$.xa.jJ(this.yo);m.$.yb.jJ(this.yo);for(const n of m.sn)for(let w of n)for(let r of w)v=m.Ea.tl(r.hashCode),this.mf(this,new b.a(new c.a(v,r.hashCode),null))}get rangeList(){return this.ES}get view(){return this.Qhe}dispose(){this.view&&(this.view.Ea.Mq(this.mf),
this.view.Ea.eI(this.Lm),this.view.Ea.wab(this.mf),this.view.Ea.oHb(this.mf),this.view.$.xa.SK(this.yo),this.view.$.yb.SK(this.yo));this.ES=this.Qhe=null;super.dispose()}tXb(m){m=this.YEd(m);const v=k.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.jH:this.view.lh;if(m&&0<m.length&&v)for(let n=0,w=m.length;n<w;n++)v.contains(this.ES[n])||this.ES.push(d.a.bQ(m[n]))}XGb(){const m=k.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
this.view.jH:this.view.lh;if(this.ES.length&&m)for(let v=this.ES.length-1;0<=v;v--)m.contains(this.ES[v])||this.ES.splice(v,1)}X_e(m){return this.q_e(m)}q_e(m){m=f.I(m,this.ES,!0);return 0<m.length?m[0]:null}}l.ZEd="lrc";Object(t.a)(l,"LoadedRangeCollection",D.a,[])},1119:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1133:function(t,D,a){var c=a(10),b=a(0),d=a(220),f=a(38);class e extends f.a{constructor(na){super();na.da.Ga(376,this)}zGg(na){this.addHandler("TAF",na)}kcj(na){this.removeHandler("TAF",na)}u2i(){this.raiseEvent("TAF")}}Object(b.a)(e,"GridHighlightBehaviorEventManager",f.a,[618,3]);class k extends d.a{constructor(na){super();this.$=na;this.Fb()}create(){this.qb(this.$.da.za(376)||new e(this.$))}static ka(na){na.da.Ga(377,new k(na))}}Object(b.a)(k,"GridHighlightBehaviorEventManagerFactory",d.a,[]);
var l=a(50),m=a(37),v=a(27),n=a(78),w=a(15),r=a(235),u=a(13),x=a(155),z=a(5),B=a(113),y=a(12);class A extends Sys.EventArgs{constructor(na,lb){super();this.start=na;this.P4a=lb}}Object(b.a)(A,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var K=a(36);class G extends f.a{constructor(na){super();this.fjc=[3];this.opa=void 0;this.gridView=na;this.hzc=K.a.c4(this.gridView.$);this.sz=K.a.sz(this.gridView.$)}get coloredReferencesManager(){const na=this.gridView.$.da.za(281);na||w.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return na}get hz(){if(this.opa)return this.opa;const na=this.gridView.$.da.za(464);na||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
na.hz||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.opa=na.hz}ZEg(na){this.addHandler("mrek",na)}Lw(na,lb,jb){for(const Yb of this.gridView.sn)r.a.instance.ra(u.a.zj,Yb.domElement,na);r.a.instance.ra(u.a.Mf,document.documentElement,lb);this.gridView.dc.$5b(!0);jb&&r.a.instance.ra(u.a.my,this.gridView.uj,lb)}HWd(na,lb,jb){for(const Yb of this.gridView.sn)r.a.instance.Ba(u.a.zj,Yb.domElement,na);r.a.instance.Ba(u.a.Mf,document.documentElement,
lb);this.gridView.dc.$5b(!1);jb&&r.a.instance.Ba(u.a.my,this.gridView.uj,lb)}v7i(na,lb){for(const jb of this.gridView.sn)x.a.instance.ra(u.a.Xf,jb.domElement,na);x.a.instance.ra(u.a.te,document.documentElement,lb)}COj(na,lb){for(const jb of this.gridView.sn)x.a.instance.Ba(u.a.Xf,jb.domElement,na);x.a.instance.Ba(u.a.te,document.documentElement,lb)}$Be(na,lb,jb,Yb){const Gb=document.createElement("div");Gb.className=lb;for(const wb of jb)Gb.classList.add(wb);na.appendChild(Gb);r.a.instance.ra(u.a.pointerDown,
Gb,Yb);return Gb}J0e(na){na=na.Cb.parentNode;if(!na)return w.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;na=parseInt(na.getAttribute(z.a.P4a),10);return isNaN(na)?(w.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.ob.ev(3,1,na)}$Jb(na,lb,jb=!0){na=jb&&(this.sz?!!this.hz&&this.hz.wii(na):!!this.coloredReferencesManager&&
this.coloredReferencesManager.vii(na));for(const Yb of lb)y.DOMElementExtensions.setVisible(Yb,na)}i9b(){return this.gridView.lj?B.a(this.gridView.$):this.gridView.Wb}DLf(){if(this.sz){var na=this.i9b();na&&this.hz?this.hzc?na.nG(null):this.hz.eeb(na,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.ob.Tg(this.fjc),this.gridView.ob.wi(null,this.fjc))}else this.b5i()}b5i(){const na=
this.i9b();na&&this.coloredReferencesManager?this.hzc?na.nG(null):this.coloredReferencesManager.nG(na,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.ob.Tg(this.fjc),this.gridView.ob.wi(null,this.fjc))}NJf(na,lb){this.raiseEvent("mrek",new A(na,lb))}}Object(b.a)(G,"BehaviorHelperMethods",f.a,[]);var T=a(86),W=a(39),P=a(93);class E extends P.a{constructor(na,lb=null){super(na,
lb)}dYa(){}}Object(b.a)(E,"HighlightFlyweightBehavior",P.a,[]);var H=a(19),F=a(456),N=a(77),J=a(11),R=a(116),M=a(221),L=a(44),U=a(234),X=a(8),da=a(71),fa=a(1),S=a(33);class ka extends U.a{constructor(na,lb,jb){super(document.createElement("div"));this.F3b=null;this.jOb=!1;this.onPointerDown=Yb=>{Yb=S.a(this.$)?S.a(this.$).Ud(Yb):Yb;this.jOb=!1;if(3===(N.a.Eb=Yb.tb)){const Gb=Yb.Ca.rawEvent,wb=Gb.srcElement||Gb.target;y.DOMElementExtensions.uf(this.domElement,wb)&&y.DOMElementExtensions.uf(Gb.currentTarget,
wb)&&(this.jOb=!0,this.F3b=Yb.clientPoint)}return!1};this.Kf=Yb=>{Yb=S.a(this.$)?S.a(this.$).Ud(Yb):Yb;this.raiseEvent("GrPointerUp",Yb);return this.jOb=!1};this.Fh=Yb=>{Yb=S.a(this.$)?S.a(this.$).Ud(Yb):Yb;3===Yb.tb&&this.jOb&&this.k4h(Yb.clientPoint)&&(this.raiseEvent("GrDrag"),this.jOb=!1);return!1};this.dd=Yb=>{S.a(this.$)&&S.a(this.$).Ud(Yb);return!0};this.$=jb;jb=!fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(jb?da.a.ZOe:da.a.YOe);this.domElement.classList.add(da.a.c7b);
na.appendChild(this.domElement);y.DOMElementExtensions.setVisible(this.domElement,!1);this.$Ja=document.createElement("div");this.$Ja.classList.add(da.a.b7b);this.$Ja.style.borderColor=lb;this.domElement.appendChild(this.$Ja);r.a.instance.ra(u.a.pointerDown,this.domElement,this.onPointerDown);r.a.instance.ra(u.a.Mf,this.domElement,this.Kf);x.a.instance.ra(u.a.te,this.domElement,this.Kf);r.a.instance.ra(u.a.zj,this.domElement,this.Fh);x.a.instance.ra(u.a.Xf,this.domElement,this.Fh);M.a.instance.ra(u.a.click,
this.domElement,this.dd)}$le(na){this.addHandler("GrDrag",na)}mPf(na){this.removeHandler("GrDrag",na)}Zle(na){this.addHandler("GrContxt",na)}lPf(na){this.removeHandler("GrContxt",na)}ame(na){this.addHandler("GrPointerUp",na)}nPf(na){this.removeHandler("GrPointerUp",na)}dispose(){L.a.ama(this.domElement);super.dispose()}Bcg(na){this.domElement.parentNode.removeChild(this.domElement);na.appendChild(this.domElement)}lXf(){this.domElement.classList.remove(da.a.c7b);this.$Ja.classList.remove(da.a.b7b);
this.$Ja.classList.add(da.a.$Oe)}Tag(){this.$Ja.classList.remove(da.a.$Oe);this.$Ja.classList.add(da.a.b7b);this.domElement.classList.add(da.a.c7b)}k4h(na){return!!this.F3b&&(3<Math.abs(na.x-this.F3b.x)||3<Math.abs(na.y-this.F3b.y))}static Vtb(na){return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(na=S.a(na.$)?S.a(na.$).zoom:X.a.XZ,Math.round(9/Math.max(na,1))):9}}ka.jud=0;Object(b.a)(ka,"TouchGrippie",U.a,[]);class V extends E{constructor(na,lb,jb,Yb){super(lb);this.Hpd=
this.eVc=this.anb=!1;this.wob=null;this.Qaa=this.Dpd=!1;this.Bw=()=>{this.anb&&this.Dpd?this.dna():this.J3()};this.Xwf=wb=>{3===wb.tb&&(this.Dpd=!0,this.dna());return!1};this.Ywf=wb=>{if(3===wb.tb){if(!wb.Cb||this.sgi(wb))return!1;this.Dpd=!1;this.J3()}return!1};this.zg=()=>{this.Qaa&&this.LWd();this.dna();this.Hpd=!1};this.rp=()=>{this.J3();this.Hpd=!0};this.aya=(wb,dc)=>{dc.N3===this.N3&&(dc.visible?this.Hpd||this.dna():this.J3())};this.NCf=()=>{this.Zwf(this.tO.domElement,!1)};this.ttf=()=>{this.Zwf(this.fM.domElement,
!0)};this.Ilc=(wb,dc)=>{this.ha.Lya(dc)};this.Jlc=(wb,dc)=>{this.ha.Lya(F.b(dc))};this.JDb=()=>{3===N.a.Eb?this.dna():this.J3();this.Qaa&&1===N.a.Eb&&this.LWd()};this.OCf=()=>{this.Unj()};this.xIe=()=>{this.J3()};this.rn=()=>{this.ha.Oa.$b&&this.J3()};this.htf=()=>{this.J3()};this.Qwf=(wb,dc)=>{this.LWd();3===dc.tb?this.dna():this.J3()};this.ypc=()=>{this.anb&&(this.J3(),this.dna())};const Gb=jb.$;this.$p=jb;this.ha=jb.ha;this.taa=na;this.plj=lb;this.paneType=Yb;na=this.domElement.currentStyle;lb=
"#000000";na&&(lb=na.borderTopColor);this.tO=new ka(this.T9c(),lb,Gb);this.fM=new ka(this.T9c(),lb,Gb);this.def=Gb.ea.isNamedObjectViewMode&&1===Gb.workbookContext.NovMode;this.tO.$le(this.NCf);this.tO.Zle(this.Ilc);this.tO.ame(this.Jlc);this.fM.$le(this.ttf);this.fM.Zle(this.Ilc);this.fM.ame(this.Jlc);for(const wb of this.gridView.sn)x.a.instance.ra(u.a.zf,wb.domElement,this.Ywf),x.a.instance.ra(u.a.te,wb.domElement,this.Xwf);jb.view.Ns(this.Bw);jb.Wb.Mk(this.xIe);jb.ob.vmb(this.aya);jb.iTc(this.htf);
Gb.GA(this.ypc);jb.Nu(this.ypc);this.ha.EX(this.zg);this.ha.K1(this.rp);jb.iC(this.rn);this.ha.EXb(this.Qwf);N.a.jme(this.JDb);m.TaskExtensions.Aa(l.GetServiceTaskFactory.Ta(Gb.da,376,377,0),wb=>{wb.result.zGg(this.OCf)},Gb.la,3)}get gridView(){return this.$p}dispose(){T.a.rc([this.tO,this.fM]);this.tO.mPf(this.NCf);this.tO.lPf(this.Ilc);this.tO.nPf(this.Jlc);this.fM.mPf(this.ttf);this.fM.lPf(this.Ilc);this.fM.nPf(this.Jlc);for(var na of this.gridView.sn)x.a.instance.Ba(u.a.zf,na.domElement,this.Ywf),
x.a.instance.Ba(u.a.te,na.domElement,this.Xwf);this.gridView.view.Oq(this.Bw);this.gridView.Wb.Gk(this.xIe);this.gridView.ob.CHb(this.aya);this.gridView.GHd(this.htf);this.gridView.$.AD(this.ypc);this.gridView.qy(this.ypc);this.ha.OV(this.zg);this.ha.i6(this.rp);this.gridView.BD(this.rn);this.ha.Kqc(this.Qwf);N.a.vPf(this.JDb);this.Qaa&&w.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(na=this.gridView.$.da.za(376))&&na.kcj(this.OCf);super.dispose()}mRa(){if(!this.taa.range||
!this.taa.range.equals(this.Dbb))return!1;const na=!this.gridView.FLa();return this.gridView.$a&&na&&(this.Dbb.isRow||this.Dbb.Ze)?!1:this.Qaa?!0:3===N.a.Eb}J3(){this.anb&&(this.tO.set_visible(!1),this.fM.set_visible(!1),this.anb=!1)}dna(){if(this.mRa()){this.cSj();var na=y.DOMElementExtensions.getBoundingClientRect(this.wob);na||w.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.def,this.eVc,this.gridView.uj,this.gridView.hb.Ti);var lb=y.DOMElementExtensions.getBoundingClientRect(this.plj),jb=new Sys.UI.Bounds(lb.x-na.x,lb.y-na.y,lb.width,lb.height),Yb=this.Dbb,Gb=Yb.topLeft,wb=Yb.bottomRight,dc=Yb.isRow||Yb.Ze;if(Yb.Ze){var Jc=this.Azh();Yb=jb.x-2*ka.Vtb(this.gridView);var Qc=Jc;var fd=jb.x+lb.width}else Yb.isRow?(Yb=fd=this.zzh(),Qc=jb.y-2*ka.Vtb(this.gridView),Jc=jb.y+lb.height):(Qc=jb.y,Jc=jb.y+lb.height,this.gridView.rtl?
(Yb=jb.x+lb.width,fd=jb.x):(Yb=jb.x,fd=jb.x+lb.width));lb=ka.jud+(dc?0:ka.Vtb(this.gridView));this.tO.style.left=J.HelperMethods.qc(Yb-lb);this.tO.style.top=J.HelperMethods.qc(Qc-lb);this.fM.style.left=J.HelperMethods.qc(fd-lb);this.fM.style.top=J.HelperMethods.qc(Jc-lb);this.tO.set_visible(this.Bcf(Qc,Yb,Gb,dc,na));this.fM.set_visible(this.Bcf(Jc,fd,wb,dc,na));this.anb=!0}}Bcf(na,lb,jb,Yb,Gb){const wb=y.DOMElementExtensions.getBoundingClientRect(this.gridView.Lf(this.paneType).domElement);Gb=new Sys.UI.Bounds(wb.x-
Gb.x-3,wb.y-Gb.y-3,wb.width+6,wb.height+6);return(this.gridView.hb.jj(jb)===this.paneType||Yb)&&W.a.WM(Gb,new Sys.UI.Point(lb,na))}cSj(){if(this.def!==this.eVc){this.wob=null;const na=this.T9c();this.tO.Bcg(na);this.fM.Bcg(na)}}Azh(){return(this.gridView.view.visibleArea.height+this.gridView.hb.height+ka.jud-ka.Vtb(this.gridView))/2}zzh(){return(this.gridView.view.visibleArea.width+this.gridView.hb.width+ka.jud-ka.Vtb(this.gridView))/2}YAf(){this.dna()}sgi(na){return y.DOMElementExtensions.sbb(na.Cb,
H.a.Wo)&&(this.phi(na)||this.qhi(na))}qhi(na){if(this.gridView.rtl)na=na.clientPoint.x;else{const lb=y.DOMElementExtensions.getBoundingClientRect(na.Cb);na=na.clientPoint.x-(lb.x+lb.width-R.a.qu)}return 0<na&&na<=R.a.qu}phi(na){const lb=y.DOMElementExtensions.getBoundingClientRect(na.Cb);na=na.clientPoint.y-(lb.y+lb.height-R.a.qu);return 0<na&&na<=R.a.qu}Zwf(na,lb){this.Qaa&&w.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.vYc(na,lb,this.Qaa);
this.J3()}Unj(){this.Qaa||(w.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Qaa=!0,this.tO.lXf(),this.fM.lXf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Wc,this.dna())}LWd(){this.Qaa&&(w.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Qaa=!1,this.tO.Tag(),this.fM.Tag())}T9c(){this.wob||(this.eVc=!1,this.wob=this.gridView.uj);return this.wob}}Object(b.a)(V,"SelectionTouchGrippiesBehaviorBase",E,[]);class wa extends V{constructor(na,
lb,jb,Yb){super(na,lb,jb,Yb)}get N3(){return 19}get Dbb(){return this.gridView.ha.sa.activeRange}mRa(){const na=this.gridView.vi||this.gridView.$a;return!this.gridView.ha.sa.xg&&!na&&super.mRa()}}Object(b.a)(wa,"DiscontinuousSelectionTouchGrippiesBehavior",V,[]);var ma=a(174);class ab extends E{constructor(na){super(na);const lb=document.createElement("div");lb.className=da.a.Huh;na.appendChild(lb)}}Object(b.a)(ab,"SelectionBorderBehavior",E,[]);class ba{}ba.muh="ewr-selection-draghandle";ba.ruh=
"ewr-selection-draghandle-grab";ba.Cuh="ewr-selection-draghandle-top-ie";ba.Duh="ewr-selection-draghandle-top-ie-enhanced";ba.Auh="ewr-selection-draghandle-top";ba.Buh="ewr-selection-draghandle-top-enhanced";ba.puh="ewr-selection-draghandle-bottom-ie";ba.quh="ewr-selection-draghandle-bottom-ie-enhanced";ba.nuh="ewr-selection-draghandle-bottom";ba.ouh="ewr-selection-draghandle-bottom-enhanced";ba.uuh="ewr-selection-draghandle-left-ie";ba.vuh="ewr-selection-draghandle-left-ie-enhanced";ba.suh="ewr-selection-draghandle-left";
ba.tuh="ewr-selection-draghandle-left-enhanced";ba.yuh="ewr-selection-draghandle-right-ie";ba.zuh="ewr-selection-draghandle-right-ie-enhanced";ba.wuh="ewr-selection-draghandle-right";ba.xuh="ewr-selection-draghandle-right-enhanced";ba.gPe="ewr-selection-dragtooltip";ba.hPe="ewr-selection-dragtooltip-updated";ba.Ouh="ewr_selection_rearrangeleft";ba.Puh="ewr_selection_rearrangeright";ba.Quh="ewr_selection_rearrangetop";ba.Nuh="ewr_selection_rearrangebottom";ba.selecting="selecting";ba.Ruh="ewr-selection-resizemarqueehandle";
ba.Uuh="ewr-selection-resizemarqueehandle-topleft";ba.Vuh="ewr-selection-resizemarqueehandle-topright";ba.Suh="ewr-selection-resizemarqueehandle-bottomleft";ba.Tuh="ewr-selection-resizemarqueehandle-bottomright";ba.cuh="ewr-marquee-thick";ba.guh="ewr-resizemarqueehandle-thick";Object(b.a)(ba,"CssClassNames",null,[]);var Ca=a(248),Na=a(21);class za extends ab{constructor(na,lb,jb,Yb){super(na);this.YRa=!1;this.Vie=this.Wie=null;this.Sqa=0;this.Th=fa.EwaSettings.getBooleanFeatureGate(ma.a.A5b,!1);this.Pfi=
fa.EwaSettings.getBooleanFeatureGate(ma.a.$gh,!1);this.dBc=this.qcc=this.CE=0;this.Ew=this.fb=this.sourceRange=this.Pla=null;this.Kf=Gb=>{Gb=S.a(this.$).Ud(Gb);return this.Ozd(Gb)};this.onPointerDown=Gb=>{Gb=S.a(this.$).Ud(Gb);if(2===Gb.tb&&Gb.Tn===Sys.UI.MouseButton.leftButton&&!this.YRa){var wb=this.oac(Gb);if(!wb)return w.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.fb=wb.clone();this.sourceRange=this.fb.clone();this.Pla=this.fb;
if(wb=this.fRh(Gb))this.ih=5,this.dBc=wb.top-this.sourceRange.top,this.qcc=wb.left-this.sourceRange.left,Na.g(this.$).Cf.Yl(this.Th?za.THa:za.y5c),this.tmc(Gb),this.YRa=!0,Ca.b(this.$,!0)}return!1};this.Fh=Gb=>{Gb=S.a(this.$).Ud(Gb);if(this.Th&&this.vmc(Gb))return!0;if(Gb=this.ha.Vn(Gb.clientPoint,Gb.Cb,5,void 0,void 0,!0)){Gb=this.Mga(Gb);if(this.fb.equals(Gb))return!0;this.fb=Gb;if(!this.By())return w.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.Lsb(!0),!1}return!0};this.Zc=(Gb,wb)=>{wb.ZM||this.ruc(this.$.isEditMode)};this.Nr=[];this.$=lb;this.ha=Na.g(this.$).ha;this.paneType=jb;this.jo=Yb;lb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");lb=this.Pfi?lb?[ba.Buh,ba.ouh,ba.tuh,ba.xuh]:[ba.Duh,ba.quh,ba.vuh,ba.zuh]:lb?[ba.Auh,ba.nuh,ba.suh,ba.wuh]:[ba.Cuh,ba.puh,ba.uuh,ba.yuh];for(const Gb of lb)lb=this.jo.$Be(na,Gb,this.Th?[ba.ruh]:[ba.muh],this.onPointerDown),this.Nr.push(lb);this.$.el(this.Zc);this.ruc(this.$.isEditMode)}get ob(){return Na.g(this.$).ob}get ih(){return this.ha.selectionType}set ih(na){this.ha.selectionType=
na}dispose(){this.Nr.forEach(na=>{r.a.instance.Ba(u.a.pointerDown,na,this.onPointerDown)});this.Nr.length=0;this.Pla=this.sourceRange=this.fb=null;w.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Sqa}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Cl(this.Zc),1===this.Sqa&&(w.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Vs(this.Vie,this.Wie,!1)));super.dispose()}Ozd(na){if(5!==
this.ih)return!1;(na=this.Zxa(na))||this.Lsb(!1);Ca.b(this.$,!1);return na}Lw(na,lb){w.ULS.shipAssertTag(537159377,0,!this.Sqa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Sqa+=1;this.Vie=na;this.Wie=lb;this.jo.Lw(na,lb,this.Vyc())}Mga(na){if(!na||!this.fb)return w.ULS.shipAssertTag(537159376,0,!!na,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),w.ULS.shipAssertTag(537159375,0,!!this.fb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),
null;const lb=this.fb.clone();1!==this.CE&&(lb.left=Math.max(na.left-this.qcc,1),lb.right=lb.left+this.sourceRange.width-1);2!==this.CE&&(lb.top=Math.max(na.top-this.dBc,1),lb.bottom=lb.top+this.sourceRange.height-1);return this.eYa(lb)}Vs(na,lb,jb=!0,Yb=!0){w.ULS.shipAssertTag(537159374,0,1===this.Sqa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Sqa;this.Th||Na.g(this.$).Cf.Yl(z.a.kQ);this.jo.HWd(na,lb,this.Vyc());jb&&this.BZc(Yb);this.CE=0;this.YRa=
!1}eYa(na){var lb=Na.g(this.$);let jb=na;if(lb.hb.D3){if(!lb.Xb(na.topLeft)){lb=lb.kk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",lb.jH,this.Pla.top!==na.top?1:2);try{lb.Dk=this.Pla.top<na.top||this.Pla.left<na.left,lb.ds(na.topLeft),jb=lb.$$cu().range}finally{lb&&lb.dispose()}}jb.right=jb.left+na.width-1;jb.bottom=jb.top+na.height-1}return this.Pla=jb}ruc(na){this.Nr.forEach(lb=>{y.DOMElementExtensions.setVisible(lb,na)})}fRh(na){const lb=na.Cb;na=na.clientPoint;if(!lb||!na)return w.ULS.shipAssertTag(537159373,
0,!!lb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159372,0,!!na,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;na.y+=lb===this.Nr[za.SHa]?2:lb===this.Nr[za.B5c]?-2:0;na.x+=lb===this.Nr[za.C5c]?2:lb===this.Nr[za.RHa]?-2:0;return this.ha.Vn(na,lb,5,void 0,void 0,!0)}}za.y5c="move";za.N_a="copy";za.THa="grabbing";za.SHa=0;za.B5c=1;za.C5c=2;za.RHa=3;Object(b.a)(za,"DragSelectionClickBehaviorBase",ab,[]);class la extends za{constructor(na,
lb,jb,Yb,Gb,wb){super(na,lb,jb,Gb);this.Ya=this.XF=null;this.q4e=()=>{this.Lsb(!0)};this.gridView=Na.g(this.$);this.AF=Yb;this.coloredReferencesManager=this.$.da.za(281);w.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.sz=K.a.sz(this.$))na=this.$.da.za(464),w.ULS.shipAssertTag(0,0,!!na,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),
this.hz=na.hz;for(const dc of this.Nr)r.a.instance.ra(u.a.wV,dc,this.AF.I7e),r.a.instance.ra(u.a.my,dc,this.AF.J7e);this.dYa(wb)}dYa(na){this.jo.$Jb(na,this.Nr);this.AF.mza()}tmc(na){w.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.LKa=!0;this.Ya.tE(!1);this.ih=5;this.AF.aIe(na.Cb);this.Ya.textBox.removeSelection();this.Ya.OXb(this.q4e);this.Lw(this.Fh,this.Kf);this.CE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:
0}Zxa(){const na=this.$F();this.ih=-1;this.Vs(this.Fh,this.Kf);return na}BZc(){this.gridView.LKa=!1;this.AF.bIe(this.Nr[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Vqc(this.q4e);this.jo.DLf()}Lsb(na){w.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");na&&this.Vs(this.Fh,this.Kf)}oac(na){this.Ya=this.jo.i9b();this.XF=this.jo.J0e(na);return this.Ya&&this.XF&&this.XF.range?this.XF.range:
(w.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),w.ULS.shipAssertTag(537159387,0,!!this.XF,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),w.ULS.shipAssertTag(537159386,0,!!this.XF.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}$F(){return this.XF?this.sz?this.hz.cCb(this.Ya,this.XF,this.fb):this.coloredReferencesManager.cCb(this.Ya,this.XF,this.fb):(w.ULS.shipAssertTag(537159385,
0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}By(){return this.$F()}Vyc(){return!0}vmc(){return!1}}Object(b.a)(la,"DragMarqueeClickBehavior",za,[]);var aa=a(85),sa=a(108),ea=a(171),Z=a(412),ua=a(14),ya=a(222),ha=a(24),Da=a(759),nb=a(42),qa=a(510),pa=a(170),Ja=a(703),$a=a(121),rb=a(31),Pa=a(280),eb=a(62);const Ob=(na,lb,jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=na.Na(41,Jc);Jc.sourceRange=lb;Jc.destinationRange=
jb;return eb.g(na,"RearrangeRowColumn",Jc,Yb,Gb,wb,dc,0)};class tb{constructor(na,lb){this.destinationRange=this.sourceRange=null;this.sourceRange=na;this.destinationRange=lb}}Object(b.a)(tb,"MacroRecorderTableRowColumnRearrangedPayload",null,[116]);var cc=a(43);class Ib extends za{constructor(na,lb,jb,Yb,Gb){super(na,lb,jb,Gb);this.Bha=ua.a.instance.ga(2261);this.Frb=ua.a.instance.ga(2262);this.Zma=ua.a.instance.ga(2263);this.vKb=ua.a.instance.ga(2264);this.Yz=this.Jh=null;this.Cq=this.Ze=this.isRow=
this.Dq=!1;this.cO=this.sM=null;this.Kn=this.Tzb=0;this.onKeyDown=wb=>{if(this.Th){if(this.Y3(wb)||wb.Ca.keyCode===aa.a.Zda)return this.h4||(sa.KeyInputManager.instance.ra(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=!0),!this.gu&&this.Y3(wb)&&(Na.g(this.$).Cf.Yl(Ib.N_a),this.gu=!0),this.hu||wb.Ca.keyCode!==aa.a.Zda||(Na.g(this.$).Cf.Yl(za.THa),this.hu=!0,2===this.Kn?(this.vx(!1),this.CE=0,this.Jh=this.Cq?[11]:[12],this.Dq=this.Cq,this.jPa(),this.DI()):3===this.Kn?(this.i2(!1),
this.CE=this.isRow?1:2,this.KN(),this.By()):1===this.Kn&&(this.Sga(!1),this.KN(),this.By())),!0}else if(!this.gu&&(wb.Ca.keyCode===aa.a.m7||v.a.isMac&&wb.Ca.keyCode===aa.a.Zna))return sa.KeyInputManager.instance.ra(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),Na.g(this.$).Cf.Yl(Ib.N_a),this.gu=!0;return!1};this.onKeyUp=wb=>{if(this.Th){if(this.Y3(wb)||wb.Ca.keyCode===aa.a.Zda)return this.Tzb=this.Y3(wb)?0:1,this.gp&&Na.g(this.$).Cf.Yl(za.THa),wb.Ca.keyCode===aa.a.Zda&&(2===this.Kn?(this.i2(!1),
this.CE=0,this.KN(!0),this.By(!0)):3===this.Kn?(this.vx(!1),this.CE=this.isRow?1:2,this.Jh=this.isRow?[11]:[12],this.jPa(!0),this.DI(!0)):1===this.Kn&&(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Yya(!0),this.DI(!0))),this.Qna(this.Tzb),!0}else if(wb.Ca.keyCode===aa.a.m7||v.a.isMac&&wb.Ca.keyCode===aa.a.Zna)return this.Qna(),this.gp&&Na.g(this.$).Cf.Yl(za.y5c),!0;return!1};this.EK=wb=>{wb=S.a(this.$).Ud(wb);5===this.ih?this.Ozd(wb):(this.gp=!1,this.ob.Tg(this.Jh),!this.$.oq([this.fb],!1)||this.FFd()||
this.Fyb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Th?this.dEd():this.Csb(),this.Zx()?this.fb.top>this.sourceRange.top&&(wb=this.fb.height,this.fb.top-=wb,this.fb.bottom-=wb):this.fb.left>this.sourceRange.left&&(wb=this.fb.width,this.fb.left-=wb,this.fb.right-=wb),this.$F()));this.Vs(this.DK,this.EK);this.tableRange=null;this.ih=-1;this.Th&&(this.Yz=null,this.Kn=0);return!0};this.y5=()=>{this.gp=!1;this.Kn=0;this.ob.Tg(this.Jh);if(!this.$.oq([this.fb],!1))return this.Vs(this.x5,this.y5),
this.ih=-1,!0;if(!(this.ha.sa.Wc.equals(this.fb)||this.Faa(this.fb)||this.Faa(this.sourceRange)||this.Fyb()||(this.$F(),this.ha.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.B5b]:!0,[z.a.D5b]:this.Dq,[z.a.dU]:this.ha.sourceRange,[z.a.cU]:this.ha.sa.Wc,[z.a.QHa]:this.hu}),this.gu))){if(this.fb.top>this.sourceRange.top&&(this.isRow||this.fb.left===this.sourceRange.left&&this.Dq)){var wb=this.fb.height;this.fb.top-=wb;this.fb.bottom-=wb}else this.fb.left>this.sourceRange.left&&
(this.Ze||this.fb.top===this.sourceRange.top&&!this.Dq)&&(wb=this.fb.width,this.fb.left-=wb,this.fb.right-=wb);this.$F()}this.Vs(this.x5,this.y5);this.Yz=this.tableRange=null;this.ih=-1;this.Dq=!1;return!0};this.DK=wb=>{var dc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");dc&&(wb=S.a(this.$).Ud(wb));var Jc=wb.clientPoint;dc||(wb=S.a(this.$).Ud(wb));this.Th&&(this.Ew=wb);if(wb=this.ha.Vn(Jc,wb.Cb,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){dc=
Na.g(this.$);const fd=dc.lg(wb);var Qc=dc.Lf(this.paneType);Jc=Ja.a.ys(Qc.view.Oh,this.domElement.parentNode,Jc,dc.rtl);Qc=!1;let Wc=2;this.Zx()&&Jc.y-fd.topLeft.y>fd.height/2?(Qc=!0,Wc=1):!this.Zx()&&Jc.x-fd.topLeft.x>fd.width/2&&(Qc=!0);if(Qc){dc=dc.kk("DragSelectionClickBehavior.OnPointerMoveRearrange",dc.jH,Wc);try{dc.ds(wb),dc.$$mn(),wb=dc.$$cu().range}finally{dc&&dc.dispose()}}this.fb=this.a2(wb);this.ha.sourceRange=this.fb;this.ob.wi(this.fb,this.Jh);this.ob.Bn(this.Jh);this.ob.Tg(this.eB());
if(6!==this.ih){for(wb=1;4>=wb;wb++)dc=this.Nh[wb.toString()],dc.parentNode.removeChild(dc),this.ob.ev(this.Zx()?11:12,wb).tf.appendChild(dc);this.ih=6}}else if(this.fb=this.Mga(wb),this.Th)this.Dvb(!1);else if(this.ob.wi(this.fb,this.eB()),this.ob.Bn(this.eB()),this.ob.Tg(this.Jh),5!==this.ih){for(wb=1;4>=wb;wb++)dc=this.Nh[wb.toString()],dc.parentNode.removeChild(dc),this.ob.ev(this.aaa(),wb).tf.appendChild(dc);this.ih=5}this.yy()}return!0};this.x5=wb=>{var dc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
dc&&(wb=S.a(this.$).Ud(wb));var Jc=wb.clientPoint;dc||(wb=S.a(this.$).Ud(wb));this.Ew=wb;if(dc=this.ha.Vn(Jc,wb.Cb,5,void 0,void 0,!0)){if(this.Svb(dc))return this.fb=this.Mga(dc),this.Cvb(!1),!0;var Qc=Na.g(this.$),fd=Qc.lg(dc),Wc=Qc.Lf(this.paneType);Jc=Ja.a.ys(Wc.view.Oh,this.domElement.parentNode,Jc,Qc.rtl);Wc=!1;let Rb=2;this.Dq=!1;if(this.isRow||this.Ze){this.isRow&&Jc.y-fd.topLeft.y>fd.height/2?(Wc=!0,Rb=1):this.Ze&&Jc.x-fd.topLeft.x>fd.width/2&&(Wc=!0);if(Wc){wb=Qc.kk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
Qc.jH,Rb);try{wb.ds(dc),wb.$$mn(),dc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.fb=this.Mga(dc)}else{Jc.x-fd.topLeft.x===fd.width?(this.Dq=!1,Wc=!0):Jc.y-fd.topLeft.y>fd.height/2&&(this.Dq=Wc=!0,Rb=1);this.Yz&&(this.Dq=this.Cq);if(Wc){Qc=Qc.kk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Qc.jH,Rb);try{Qc.ds(dc),Qc.$$mn(),dc=Qc.$$cu().range}finally{Qc&&Qc.dispose()}}this.ob.Tg(this.Jh);this.Jh=this.Dq?[11]:[12];for(Qc=1;4>=Qc;Qc++)(fd=this.Nh[Qc.toString()])&&fd.parentNode.removeChild(fd),
this.Nh[Qc.toString()]=null;this.Uz(wb.clientPoint,wb.Cb,this.Dq?11:12,!0);this.fb=this.a2(dc)}this.ha.sourceRange=this.fb;this.ob.wi(this.fb,this.Jh);this.ob.Bn(this.Jh);this.ob.Tg(this.eB());if(6!==this.ih){for(wb=1;4>=wb;wb++)dc=this.Nh[wb.toString()],dc.parentNode.removeChild(dc),this.ob.ev(this.isRow||this.Dq?11:12,wb).tf.appendChild(dc);this.ih=6}this.yy()}return!0};this.zg=()=>{this.domElement.classList.remove(ba.selecting)};this.rp=()=>{this.domElement.classList.add(ba.selecting)};this.Uc=
()=>{if(this.$.isEditMode){const wb=this.Kvc();this.ruc(wb)}};this.ZNa=()=>{this.Th?this.gp&&5<=this.ih&&(this.tableRange?this.hu?this.vx(!0):this.Sga(!0):this.hu?this.isRow||this.Ze?this.vx(!0):this.i2(!0):this.isRow||this.Ze?this.i2(!0):this.vx(!0)):this.gp&&5<=this.ih&&(this.tableRange?(this.ob.Tg(this.Jh),this.Vs(this.DK,this.EK)):(this.ob.Tg(this.eB()),this.Vs(this.Fh,this.Kf)))};this.tableManager=Yb;this.tableRange=null;this.Nh={};this.h4=this.hu=this.gu=this.gp=!1;this.ha.K1(this.rp);this.ha.EX(this.zg);
this.ha.eYb(this.ZNa);this.ha.lE(this.Uc)}dispose(){this.ha&&(this.ha.i6(this.rp),this.ha.OV(this.zg),this.ha.mId(this.ZNa),this.ha.fI(this.Uc));if(this.Nh)for(let na=1;4>=na;na++)y.DOMElementExtensions.nf(this.Nh[na.toString()]);this.Nh=this.Jh=null;this.gu&&this.Qna();this.Th&&this.hu&&this.Qna(1);super.dispose()}tmc(na){this.Th&&(this.Ew=na,this.Yz=null,this.Cq=this.isRow=this.Ze=this.Dq=!1,sa.KeyInputManager.instance.ra(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown));this.gp=!0;this.tableRange=
this.PXc(this.tableManager.Fm(this.sourceRange.topLeft));Na.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Th?(this.Yz=this.tableRange,this.Kn=1,this.Jh=(this.Cq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.ih=6,this.Lw(this.DK,this.EK),this.sM=this.Bha,this.cO=this.Zma,this.Uz(na.clientPoint,na.Cb,this.Cq?11:12,!0,!0),this.DI(!0)):(this.Jh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===
this.sourceRange.right)?[11]:[12],this.ih=6,this.Lw(this.DK,this.EK),this.Uz(na.clientPoint,na.Cb,this.isRow?11:12,!0)):(this.tableRange=null,this.Th?(this.isRow=this.sourceRange.isRow,this.Ze=this.sourceRange.Ze,this.isRow||this.Ze?(this.Kn=3,this.CE=this.isRow?1:2,this.ih=6,this.Jh=this.isRow?[11]:[12],this.Lw(this.x5,this.y5),this.sM=this.Bha,this.cO=this.Zma,this.Uz(na.clientPoint,na.Cb,this.isRow?11:12,!0,!0),this.DI(!0)):(this.Kn=2,this.CE=0,this.Lw(this.Fh,this.Kf),this.sM=this.Frb,this.cO=
this.vKb,this.Uz(na.clientPoint,na.Cb,this.aaa(),!1,!0),this.By(!0))):(this.Lw(this.Fh,this.Kf),sa.KeyInputManager.instance.ra(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown),this.CE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:0,this.Uz(na.clientPoint,na.Cb,this.aaa(),!1),this.By()))}Zxa(){this.gp=!1;this.Th&&(this.Kn=0);this.ob.Tg(this.eB());if(!this.$.oq([this.fb],!1))return this.Vs(this.Fh,this.Kf),this.ih=-1,!0;if(this.ha.sa.Wc.equals(this.fb)||this.Faa(this.fb)||this.Faa(this.sourceRange))this.ih=
-1;else{this.$F();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,lb=this.ha.sa.Wc;this.Th?this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.dU]:na,[z.a.cU]:lb,[z.a.QHa]:this.hu}):this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.dU]:na,[z.a.cU]:lb})}!this.Th&&this.tableRange||this.Vs(this.Fh,this.Kf);return!0}BZc(na){na&&(sa.KeyInputManager.instance.Ba(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown),this.Th&&Na.g(this.$).Cf.Yl(z.a.kQ),this.gp=!1);for(na=1;4>=na;na++){const lb=
this.Nh[na.toString()];lb&&lb.parentNode.removeChild(lb);this.Nh[na.toString()]=null}this.Jh=null}vmc(na){const lb=this.ha.Vn(na.clientPoint,na.Cb,5,void 0,void 0,!0);this.Ew=na;return this.Svb(lb)?(this.fb=this.a2(lb),this.Cvb(!0),!0):this.ahd(lb)?(this.fb=this.Mga(lb),this.Dvb(!0),!0):!1}Svb(na){return!!this.Yz&&1!==this.Kn&&!!na&&this.Yz.contains(na.topLeft)}ahd(na){return!!this.Yz&&1===this.Kn&&!!na&&!this.Yz.contains(na.topLeft)}Cvb(na){this.tableRange=this.Yz;this.Kn=1;const lb=!this.hu;na?
(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Yya(lb),this.DI(lb)):(this.i2(!1),this.KN(lb),this.By(lb))}Dvb(na){this.tableRange=null;this.Kn=2;const lb=!this.hu;na?(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Dq=this.Cq,this.jPa(lb),this.DI(lb)):(this.Sga(!1),this.KN(lb),this.By(lb))}oac(){return this.ha.sa.Wc}$F(){this.ha.updateSelection(this.fb,this.fb.topLeft,0);return!0}By(na=!1){this.ob.wi(this.fb,this.eB());this.ob.Bn(this.eB());this.yy(na);return!0}DI(na=!1){this.ob.wi(this.fb,this.Jh);this.ob.Bn(this.Jh);
this.yy(na)}Lsb(){w.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}Vyc(){return!1}Kvc(){if(!Na.g(this.$).ha.sa.xg)return!1;const na=Na.g(this.$).getRangeInformation(this.ha.sa.Wc);for(const lb of na)if(Object(Z.a)(ya.PivotTableRange,lb))return!1;return!0}PXc(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.qaa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===
na.top){const lb=new ha.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!lb.equals(na))return this.sourceRange=lb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Th?this.Cq=na.left===this.sourceRange.left&&na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.Zx())return na}return null}a2(na){const lb=
na.clone();this.Zx()?lb.left=Math.max(na.left-this.qcc,1):lb.top=Math.max(na.top-this.dBc,1);lb.right=lb.left+this.sourceRange.width-1;lb.bottom=lb.top+this.sourceRange.height-1;return this.eYa(lb)}Fyb(){const na=this.fb.topLeft.Ed(this.sourceRange);return na||this.Th&&!this.tableRange?na:this.Zx()?this.fb.top===this.sourceRange.bottom+1:this.fb.left===this.sourceRange.right+1}FFd(){if(this.Zx()&&this.fb.left!==this.tableRange.left||!this.Zx()&&this.fb.top!==this.tableRange.top){const na=rb.a.Yc(1,
1,0,913,0,2065438552,"RearrangeInvalidDest");cc.a(this.$).tr([na]);return!0}return!1}dEd(){const na=this.$.Hb.xc("UserAction","RearrangeRowColumnClientSide"),lb={["CopyPasteTargetType"]:1,["OperationId"]:ea.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.hu,["EncounteredDeploymentErrors"]:!1},jb=this.gu?2:1,Yb=this.$.da.za(254);(new Promise((Gb,wb)=>{this.Csb(dc=>{dc.Errors&&0<dc.Errors.length?wb(new Da.a(22,dc.Errors)):Gb(!0)},dc=>{dc=$a.a.kf(dc.data);wb(new Da.a(22,dc))})})).then(()=>
{w.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');Yb&&Yb.llf(lb,jb,this.sourceRange,this.fb);return Promise.resolve(!0)},Gb=>{w.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${Gb?copyPasteInfra.getStringifiedError(Gb):"null"}, copyPasteTargetType="${1}"`);return Yb?Yb.dAf(Gb,lb,jb,this.sourceRange,this.fb):Promise.reject(Gb)})}Csb(na=null,lb=null){const jb={};this.Zx()?(jb.FirstRow=this.fb.top-1,
jb.FirstColumn=0,jb.DeltaColumn=0,jb.DeltaRow=this.fb.bottom-this.fb.top+1):(jb.FirstRow=0,jb.FirstColumn=this.fb.left-1,jb.DeltaColumn=this.fb.right-this.fb.left+1,jb.DeltaRow=0);jb.LastRow=X.a.ay;jb.LastColumn=X.a.pv;jb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.yb.getItemByName(this.$.yb.oa.name).sheetName;const Yb=nb.v(this.sourceRange,this.$),Gb=(dc,Jc,Qc)=>Ob(this.$.pa.va,Yb,jb,na?Pa.b(dc,na):dc,lb?Pa.a(Jc,lb):Jc,Qc,null),wb=()=>new tb(Yb,jb);fa.EwaSettings.fc()?this.$.userOperationManager.Ub(new pa.a(514,
0,Gb,64,wb),null):this.$.userOperationManager.Ub(new qa.a(514,0,Gb,void 0,wb),null)}Faa(na){na=Na.g(this.$).getRangeInformation(na);for(let lb=0,jb=na.length;lb<jb;++lb)if(Object(Z.a)(ya.PivotTableRange,na[lb]))return na=rb.a.Yc(1,0,0,900,0,2105176604,"InsDelCellsPivotTable"),cc.a(this.$).tr([na]),!0;return!1}Uz(na,lb,jb,Yb,Gb=!1){var wb=y.DOMElementExtensions.getBoundingClientRect(lb);let dc=lb===this.Nr[za.SHa]||lb===this.Nr[za.B5c];if(this.Th){var Jc=lb===this.Nr[za.C5c]||lb===this.Nr[za.RHa];
this.isRow&&Jc||this.Ze&&dc?Jc="100px":(dc=this.isRow||dc,Jc=(dc?Gb?Ib.ZUd:Ib.eVd:Gb?Ib.YUd:Ib.bVd)+"px");lb=dc?lb===this.Nr[za.SHa]?"top":"bottom":lb===this.Nr[za.RHa]?"right":"left";na=100*(dc?na.x-wb.x:na.y-wb.y)/(dc?wb.width:wb.height);for(wb=1;4>=wb;wb++){Yb=document.createElement("div");var Qc=document.createElement("div");const fd=document.createElement("div");Yb.appendChild(Qc);Yb.appendChild(fd);Gb&&(Qc=document.createElement("div"),Yb.appendChild(Qc),fd.style.fontWeight="bold");Yb.className=
ba.hPe;this.Nh[wb.toString()]=Yb;this.ob.ev(jb,wb).tf.appendChild(Yb);Yb=this.Nh[wb.toString()];Yb.style[lb]=Jc;Yb.style[dc?"left":"top"]=na+"%"}}else for(Gb=(dc?-Ib.dVd:-Ib.aVd)+"px",Jc=dc?lb===this.Nr[za.SHa]?"top":"bottom":lb===this.Nr[za.RHa]||Yb?"right":"left",lb=100*(dc?Yb?0:na.x-wb.x:na.y-wb.y)/(dc?wb.width:wb.height),na=1;4>=na;na++)wb=document.createElement("div"),wb.className=ba.gPe,this.Nh[na.toString()]=wb,this.ob.ev(jb,na).tf.appendChild(wb),wb=this.Nh[na.toString()],wb.style[Jc]=Gb,
wb.style[dc?"left":"top"]=lb+"%"}yy(na=!1){const lb=this.fb.toString();if(this.Th)for(let jb=1;4>=jb;jb++)this.Nh[jb.toString()].childNodes[0].innerText=lb,this.Nh[jb.toString()].childNodes[1].innerText=this.sM,na&&(this.Nh[jb.toString()].childNodes[2].innerText=this.cO);else for(na=1;4>=na;na++)this.Nh[na.toString()].innerText=lb}Qna(na=0){0===na?this.gu=!1:1===na&&(this.hu=!1);this.Th&&(this.gu||this.hu)||(sa.KeyInputManager.instance.Ba(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=
!1)}vx(na){this.ob.Tg(this.eB());this.Vs(this.Fh,this.Kf,void 0,na)}i2(na){this.ob.Tg(this.Jh);this.Vs(this.x5,this.y5,void 0,na)}Sga(na){this.ob.Tg(this.Jh);this.Vs(this.DK,this.EK,void 0,na)}KN(na=!1){this.ih=5;this.Lw(this.Fh,this.Kf);this.sM=this.Frb;this.cO=this.vKb;this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.aaa(),!1,na)}jPa(na=!1){this.ih=6;this.Lw(this.x5,this.y5);this.sM=this.Bha;this.cO=this.Zma;this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.isRow||this.Cq?11:12,!0,na)}Yya(na=!1){this.ih=6;
this.Lw(this.DK,this.EK);this.sM=this.Bha;this.cO=this.Zma;this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.Zx()?11:12,!0,na)}Y3(na){return na.Ca.keyCode===aa.a.m7||v.a.isMac&&na.Ca.keyCode===aa.a.Zna}Zx(){return!this.Th&&this.isRow||this.Th&&this.Cq}aaa(){return this.Th?47:6}eB(){return this.Th?Ib.A5c:Ib.D5c}}Ib.aVd=50;Ib.dVd=25;Ib.bVd=-85;Ib.eVd=-40;Ib.YUd=-120;Ib.ZUd=-50;Ib.N_a="copy";Ib.D5c=[6];Ib.A5c=[47];Object(b.a)(Ib,"DragSelectionClickBehavior",za,[]);var Mb=a(82);class Oa extends za{constructor(na,
lb,jb,Yb){super(na,lb,jb,Yb);this.Jh=null;this.Ze=this.isRow=!1;this.zg=()=>{this.domElement.classList.remove(ba.selecting)};this.rp=()=>{this.domElement.classList.add(ba.selecting)};this.Uc=()=>{if(this.$.isEditMode){const Gb=this.Kvc();this.ruc(Gb)}};this.Nh={};this.gp=!1;this.ha.K1(this.rp);this.ha.EX(this.zg);this.ha.lE(this.Uc)}dispose(){this.ha&&(this.ha.i6(this.rp),this.ha.OV(this.zg),this.ha.mId(this.ZNa),this.ha.fI(this.Uc));if(this.Nh)for(let na=1;4>=na;na++)y.DOMElementExtensions.nf(this.Nh[na.toString()]);
this.Nh=this.Jh=null;super.dispose()}BZc(na){na&&(this.Th&&Na.g(this.$).Cf.Yl(z.a.kQ),sa.KeyInputManager.instance.Ba(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown),this.gp=!1);for(na=1;4>=na;na++){const lb=this.Nh[na.toString()];lb&&lb.parentNode.removeChild(lb);this.Nh[na.toString()]=null}this.Jh=null}oac(){return this.ha.sa.Wc}$F(){this.ha.updateSelection(this.fb,this.fb.topLeft,0);return!0}By(na=!1){this.ob.wi(this.fb,this.eB());this.ob.Bn(this.eB());this.yy(na);return!0}DI(na=!1){this.ob.wi(this.fb,
this.Jh);this.ob.Bn(this.Jh);this.yy(na)}Lsb(){w.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}Vyc(){return!1}Uz(na,lb,jb,Yb,Gb=!1){var wb=y.DOMElementExtensions.getBoundingClientRect(lb);let dc=lb===this.Nr[za.SHa]||lb===this.Nr[za.B5c];if(this.Th){var Jc=lb===this.Nr[za.C5c]||lb===this.Nr[za.RHa];this.isRow&&Jc||this.Ze&&dc?Jc="100px":(dc=this.isRow||dc,Jc=(dc?Gb?Oa.ZUd:Oa.eVd:Gb?Oa.YUd:Oa.bVd)+"px");
lb=dc?lb===this.Nr[za.SHa]?"top":"bottom":lb===this.Nr[za.RHa]?"right":"left";na=100*(dc?na.x-wb.x:na.y-wb.y)/(dc?wb.width:wb.height);for(wb=1;4>=wb;wb++){Yb=document.createElement("div");var Qc=document.createElement("div");const fd=document.createElement("div");Yb.appendChild(Qc);Yb.appendChild(fd);Gb&&(Qc=document.createElement("div"),Yb.appendChild(Qc),fd.style.fontWeight="bold");Yb.className=ba.hPe;this.Nh[wb.toString()]=Yb;this.ob.ev(jb,wb).tf.appendChild(Yb);Yb=this.Nh[wb.toString()];Yb.style[lb]=
Jc;Yb.style[dc?"left":"top"]=na+"%"}}else for(Gb=(dc?-Oa.dVd:-Oa.aVd)+"px",Jc=dc?lb===this.Nr[za.SHa]?"top":"bottom":lb===this.Nr[za.RHa]||Yb?"right":"left",lb=100*(dc?Yb?0:na.x-wb.x:na.y-wb.y)/(dc?wb.width:wb.height),na=1;4>=na;na++)wb=document.createElement("div"),wb.className=ba.gPe,this.Nh[na.toString()]=wb,this.ob.ev(jb,na).tf.appendChild(wb),wb=this.Nh[na.toString()],wb.style[Jc]=Gb,wb.style[dc?"left":"top"]=lb+"%"}ucg(na,lb,jb){const Yb=Na.g(this.$),Gb=Yb.lg(na);var wb=Yb.Lf(this.paneType);
jb=Ja.a.ys(wb.view.Oh,this.domElement.parentNode,jb,Yb.rtl);wb=!1;let dc=2;lb&&jb.y-Gb.topLeft.y>Gb.height/2?(wb=!0,dc=1):!lb&&jb.x-Gb.topLeft.x>Gb.width/2&&(wb=!0);if(wb){lb=Yb.kk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Yb.jH,dc);try{lb.ds(na),lb.$$mn(),lb.$$cu()}finally{lb&&lb.dispose()}}}Sga(na){this.ob.Tg(this.Jh);this.Vs(this.DK,this.EK,void 0,na)}vx(na){this.ob.Tg(this.eB());this.Vs(this.Fh,this.Kf,void 0,na)}aaa(){return this.Th?47:6}eB(){return this.Th?Oa.A5c:Oa.D5c}Y3(na){return na.Ca.keyCode===
aa.a.m7||v.a.isMac&&na.Ca.keyCode===aa.a.Zna}Faa(na){na=Na.g(this.$).getRangeInformation(na);for(let lb=0,jb=na.length;lb<jb;++lb)if(Object(Z.a)(ya.PivotTableRange,na[lb]))return na=rb.a.Yc(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),cc.a(this.$).tr([na]),!0;return!1}}Oa.aVd=50;Oa.dVd=25;Oa.bVd=-85;Oa.eVd=-40;Oa.YUd=-120;Oa.ZUd=-50;Oa.D5c=[6];Oa.A5c=[47];Object(b.a)(Oa,"DragSelectionClickBehaviorTemporary",za,[]);class Aa extends Oa{constructor(na,lb,jb,Yb,Gb){super(na,lb,jb,Gb);this.Yz=null;
this.Cq=this.Dq=!1;this.Tzb=0;this.cO=this.sM=null;this.Kn=0;this.Bha=ua.a.instance.ga(2261);this.Frb=ua.a.instance.ga(2262);this.Zma=ua.a.instance.ga(2263);this.vKb=ua.a.instance.ga(2264);this.ssd=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");this.onKeyDown=wb=>{if(this.Th){if(this.Y3(wb)||wb.Ca.keyCode===aa.a.Zda)return this.h4||(sa.KeyInputManager.instance.ra(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=!0),!this.gu&&this.Y3(wb)&&(Na.g(this.$).Cf.Yl(za.N_a),
this.gu=!0),this.hu||wb.Ca.keyCode!==aa.a.Zda||(Na.g(this.$).Cf.Yl(za.THa),this.hu=!0,2===this.Kn?(this.vx(!1),this.CE=0,this.Jh=this.Cq?[11]:[12],this.Dq=this.Cq,this.jPa(),this.DI()):3===this.Kn?(this.i2(!1),this.CE=this.isRow?1:2,this.KN(),this.By()):1===this.Kn&&(this.Sga(!1),this.KN(),this.By())),!0}else if(!this.gu&&(wb.Ca.keyCode===aa.a.m7||v.a.isMac&&wb.Ca.keyCode===aa.a.Zna))return sa.KeyInputManager.instance.ra(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),Na.g(this.$).Cf.Yl(za.N_a),
this.gu=!0;return!1};this.onKeyUp=wb=>{if(this.Th){if(this.Y3(wb)||wb.Ca.keyCode===aa.a.Zda)return this.Tzb=this.Y3(wb)?0:1,this.gp&&Na.g(this.$).Cf.Yl(za.THa),wb.Ca.keyCode===aa.a.Zda&&(2===this.Kn?(this.i2(!1),this.CE=0,this.KN(!0),this.By(!0)):3===this.Kn?(this.vx(!1),this.CE=this.isRow?1:2,this.Jh=this.isRow?[11]:[12],this.jPa(!0),this.DI(!0)):1===this.Kn&&(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Yya(!0),this.DI(!0))),this.Qna(this.Tzb),!0}else if(wb.Ca.keyCode===aa.a.m7||v.a.isMac&&wb.Ca.keyCode===
aa.a.Zna)return this.Qna(),this.gp&&Na.g(this.$).Cf.Yl(za.y5c),!0;return!1};this.EK=wb=>{wb=S.a(this.$).Ud(wb);5===this.ih?this.Ozd(wb):(this.gp=!1,this.ob.Tg(this.Jh),!this.$.oq([this.fb],!1)||this.FFd()||this.Fyb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Th?this.dEd():this.Csb(),this.Zx()?this.fb.top>this.sourceRange.top&&(wb=this.fb.height,this.fb.top-=wb,this.fb.bottom-=wb):this.fb.left>this.sourceRange.left&&(wb=this.fb.width,this.fb.left-=wb,this.fb.right-=wb),this.$F()),this.ssd&&
this.rsd());this.Vs(this.DK,this.EK);this.tableRange=null;this.ih=-1;this.Th&&(this.Yz=null,this.Kn=0);return!0};this.y5=()=>{this.gp=!1;this.Kn=0;this.ob.Tg(this.Jh);if(!this.$.oq([this.fb],!1))return this.Vs(this.x5,this.y5),this.ih=-1,!0;if(!(this.ha.sa.Wc.equals(this.fb)||this.Faa(this.fb)||this.Faa(this.sourceRange)||this.Fyb()||(this.$F(),this.ha.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.B5b]:!0,[z.a.D5b]:this.Dq,[z.a.dU]:this.ha.sourceRange,[z.a.cU]:this.ha.sa.Wc,
[z.a.QHa]:this.hu}),this.gu))){if(this.fb.top>this.sourceRange.top&&(this.isRow||this.fb.left===this.sourceRange.left&&this.Dq)){var wb=this.fb.height;this.fb.top-=wb;this.fb.bottom-=wb}else this.fb.left>this.sourceRange.left&&(this.Ze||this.fb.top===this.sourceRange.top&&!this.Dq)&&(wb=this.fb.width,this.fb.left-=wb,this.fb.right-=wb);this.$F()}this.Vs(this.x5,this.y5);this.Yz=this.tableRange=null;this.ih=-1;this.Dq=!1;this.ssd&&this.rsd();return!0};this.DK=wb=>{const dc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
dc&&(wb=S.a(this.$).Ud(wb));var Jc=wb.clientPoint;dc||(wb=S.a(this.$).Ud(wb));this.Th&&(this.Ew=wb);if(wb=this.ha.Vn(Jc,wb.Cb,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){if(this.ucg(wb,this.Zx(),Jc),this.fb=this.a2(wb),this.ha.sourceRange=this.fb,this.ob.wi(this.fb,this.Jh),this.ob.Bn(this.Jh),this.ob.Tg(this.eB()),6!==this.ih){for(Jc=1;4>=Jc;Jc++)wb=this.Nh[Jc.toString()],wb.parentNode.removeChild(wb),this.ob.ev(this.Zx()?11:12,Jc).tf.appendChild(wb);this.ih=6}}else if(this.fb=
this.Mga(wb),this.Th)this.Dvb(!1);else if(this.ob.wi(this.fb,this.eB()),this.ob.Bn(this.eB()),this.ob.Tg(this.Jh),5!==this.ih){for(Jc=1;4>=Jc;Jc++)wb=this.Nh[Jc.toString()],wb.parentNode.removeChild(wb),this.ob.ev(this.aaa(),Jc).tf.appendChild(wb);this.ih=5}this.yy()}return!0};this.x5=wb=>{var dc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");dc&&(wb=S.a(this.$).Ud(wb));var Jc=wb.clientPoint;dc||(wb=S.a(this.$).Ud(wb));this.Ew=wb;if(dc=this.ha.Vn(Jc,wb.Cb,5,
void 0,void 0,!0)){if(this.Svb(dc))return this.fb=this.Mga(dc),this.Cvb(!1),!0;var Qc=Na.g(this.$),fd=Qc.lg(dc),Wc=Qc.Lf(this.paneType);Jc=Ja.a.ys(Wc.view.Oh,this.domElement.parentNode,Jc,Qc.rtl);Wc=!1;let Rb=2;this.Dq=!1;if(this.isRow||this.Ze){this.isRow&&Jc.y-fd.topLeft.y>fd.height/2?(Wc=!0,Rb=1):this.Ze&&Jc.x-fd.topLeft.x>fd.width/2&&(Wc=!0);if(Wc){wb=Qc.kk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Qc.jH,Rb);try{wb.ds(dc),wb.$$mn(),dc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.fb=
this.Mga(dc)}else{Jc.x-fd.topLeft.x===fd.width?(this.Dq=!1,Wc=!0):Jc.y-fd.topLeft.y>fd.height/2&&(this.Dq=Wc=!0,Rb=1);this.Yz&&(this.Dq=this.Cq);if(Wc){Qc=Qc.kk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Qc.jH,Rb);try{Qc.ds(dc),Qc.$$mn(),dc=Qc.$$cu().range}finally{Qc&&Qc.dispose()}}this.ob.Tg(this.Jh);this.Jh=this.Dq?[11]:[12];for(Qc=1;4>=Qc;Qc++)(fd=this.Nh[Qc.toString()])&&fd.parentNode.removeChild(fd),this.Nh[Qc.toString()]=null;this.Uz(wb.clientPoint,wb.Cb,this.Dq?11:
12,!0);this.fb=this.a2(dc)}this.ha.sourceRange=this.fb;this.ob.wi(this.fb,this.Jh);this.ob.Bn(this.Jh);this.ob.Tg(this.eB());if(6!==this.ih){for(wb=1;4>=wb;wb++)dc=this.Nh[wb.toString()],dc.parentNode.removeChild(dc),this.ob.ev(this.isRow||this.Dq?11:12,wb).tf.appendChild(dc);this.ih=6}this.yy()}return!0};this.ZNa=()=>{this.Th?this.gp&&5<=this.ih&&(this.tableRange?this.hu?this.vx(!0):this.Sga(!0):this.hu?this.isRow||this.Ze?this.vx(!0):this.i2(!0):this.isRow||this.Ze?this.i2(!0):this.vx(!0)):this.gp&&
5<=this.ih&&(this.tableRange?(this.ob.Tg(this.Jh),this.Vs(this.DK,this.EK)):(this.ob.Tg(this.eB()),this.Vs(this.Fh,this.Kf)))};this.tableManager=Yb;this.tableRange=null;this.h4=this.gu=this.hu=!1;this.ha.eYb(this.ZNa)}dispose(){this.gu&&this.Qna();this.Th&&this.hu&&this.Qna(1);super.dispose()}tmc(na){this.Th&&(this.Ew=na,this.Yz=null,this.Cq=this.isRow=this.Ze=this.Dq=!1,sa.KeyInputManager.instance.ra(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown));this.gp=!0;this.tableRange=this.PXc(this.tableManager.Fm(this.sourceRange.topLeft));
Na.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Th?(this.Yz=this.tableRange,this.Kn=1,this.Jh=(this.Cq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.ih=6,this.Lw(this.DK,this.EK),this.sM=this.Bha,this.cO=this.Zma,this.Uz(na.clientPoint,na.Cb,this.Cq?11:12,!0,!0),this.DI(!0)):(this.Jh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.ih=
6,this.Lw(this.DK,this.EK),this.Uz(na.clientPoint,na.Cb,this.isRow?11:12,!0)):(this.tableRange=null,this.Th?(this.isRow=this.sourceRange.isRow,this.Ze=this.sourceRange.Ze,this.isRow||this.Ze?(this.Kn=3,this.CE=this.isRow?1:2,this.ih=6,this.Jh=this.isRow?[11]:[12],this.Lw(this.x5,this.y5),this.sM=this.Bha,this.cO=this.Zma,this.Uz(na.clientPoint,na.Cb,this.isRow?11:12,!0,!0),this.DI(!0)):(this.Kn=2,this.CE=0,this.Lw(this.Fh,this.Kf),this.sM=this.Frb,this.cO=this.vKb,this.Uz(na.clientPoint,na.Cb,this.aaa(),
!1,!0),this.By(!0))):(this.Lw(this.Fh,this.Kf),sa.KeyInputManager.instance.ra(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown),this.CE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:0,this.Uz(na.clientPoint,na.Cb,this.aaa(),!1),this.By()))}Zxa(){this.gp=!1;this.Th&&(this.Kn=0);this.ob.Tg(this.eB());if(!this.$.oq([this.fb],!1))return this.Vs(this.Fh,this.Kf),this.ih=-1,!0;if(this.ha.sa.Wc.equals(this.fb)||this.Faa(this.fb)||this.Faa(this.sourceRange))this.ih=-1;else{this.$F();this.ha.sourceRange=
this.sourceRange.clone();const na=this.ha.sourceRange,lb=this.ha.sa.Wc;this.Th?this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.dU]:na,[z.a.cU]:lb,[z.a.QHa]:this.hu}):this.$.xd(-694765314,2,30,{[z.a.n$]:this.gu,[z.a.dU]:na,[z.a.cU]:lb})}!this.Th&&this.tableRange||this.Vs(this.Fh,this.Kf);this.ssd&&this.rsd();return!0}vmc(na){const lb=this.ha.Vn(na.clientPoint,na.Cb,5,void 0,void 0,!0);this.Ew=na;return this.Svb(lb)?(this.fb=this.a2(lb),this.Cvb(!0),!0):this.ahd(lb)?(this.fb=this.Mga(lb),this.Dvb(!0),
!0):!1}yy(na=!1){const lb=this.fb.toString();if(this.Th)for(let jb=1;4>=jb;jb++)this.Nh[jb.toString()].childNodes[0].innerText=lb,this.Nh[jb.toString()].childNodes[1].innerText=this.sM,na&&(this.Nh[jb.toString()].childNodes[2].innerText=this.cO);else for(na=1;4>=na;na++)this.Nh[na.toString()].innerText=lb}Svb(na){return!!this.Yz&&1!==this.Kn&&!!na&&this.Yz.contains(na.topLeft)}ahd(na){return!!this.Yz&&1===this.Kn&&!!na&&!this.Yz.contains(na.topLeft)}Cvb(na){this.tableRange=this.Yz;this.Kn=1;const lb=
!this.hu;na?(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Yya(lb),this.DI(lb)):(this.i2(!1),this.KN(lb),this.By(lb))}Dvb(na){this.tableRange=null;this.Kn=2;const lb=!this.hu;na?(this.vx(!1),this.Jh=this.Cq?[11]:[12],this.Dq=this.Cq,this.jPa(lb),this.DI(lb)):(this.Sga(!1),this.KN(lb),this.By(lb))}Kvc(){if(!Na.g(this.$).ha.sa.xg)return!1;const na=Na.g(this.$).getRangeInformation(this.ha.sa.Wc);for(const lb of na)if(Object(Z.a)(ya.PivotTableRange,lb))return!1;return!0}PXc(na){if(na&&na.contains(this.sourceRange)&&
!na.equals(this.sourceRange)){if(na.qaa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const lb=new ha.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!lb.equals(na))return this.sourceRange=lb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Th?this.Cq=na.left===this.sourceRange.left&&na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;
if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.Zx())return na}return null}a2(na){const lb=na.clone();this.Zx()?lb.left=Math.max(na.left-this.qcc,1):lb.top=Math.max(na.top-this.dBc,1);lb.right=lb.left+this.sourceRange.width-1;lb.bottom=lb.top+this.sourceRange.height-1;return this.eYa(lb)}Fyb(){const na=this.fb.topLeft.Ed(this.sourceRange);return na||this.Th&&!this.tableRange?na:this.Zx()?this.fb.top===this.sourceRange.bottom+1:this.fb.left===this.sourceRange.right+1}FFd(){if(this.Zx()&&
this.fb.left!==this.tableRange.left||!this.Zx()&&this.fb.top!==this.tableRange.top){const na=rb.a.Yc(1,1,0,913,0,2065438552,"RearrangeInvalidDest");cc.a(this.$).tr([na]);return!0}return!1}dEd(){const na=this.$.Hb.xc("UserAction","RearrangeRowColumnClientSide"),lb={["CopyPasteTargetType"]:1,["OperationId"]:ea.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.hu,["EncounteredDeploymentErrors"]:!1},jb=this.gu?2:1,Yb=this.$.da.za(254);(new Promise((Gb,wb)=>{this.Csb(dc=>{dc.Errors&&
0<dc.Errors.length?wb(new Da.a(22,dc.Errors)):Gb(!0)},dc=>{dc=$a.a.kf(dc.data);wb(new Da.a(22,dc))})})).then(()=>{w.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Yb&&Yb.llf(lb,jb,this.sourceRange,this.fb);return Promise.resolve(!0)},Gb=>{w.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Gb?copyPasteInfra.getStringifiedError(Gb):"null"}, copyPasteTargetType="${1}"`);
return Yb?Yb.dAf(Gb,lb,jb,this.sourceRange,this.fb):Promise.reject(Gb)})}Csb(na=null,lb=null){const jb={};this.Zx()?(jb.FirstRow=this.fb.top-1,jb.FirstColumn=0,jb.DeltaColumn=0,jb.DeltaRow=this.fb.bottom-this.fb.top+1):(jb.FirstRow=0,jb.FirstColumn=this.fb.left-1,jb.DeltaColumn=this.fb.right-this.fb.left+1,jb.DeltaRow=0);jb.LastRow=X.a.ay;jb.LastColumn=X.a.pv;jb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.yb.getItemByName(this.$.yb.oa.name).sheetName;const Yb=nb.v(this.sourceRange,this.$),Gb=
(dc,Jc,Qc)=>Ob(this.$.pa.va,Yb,jb,na?Pa.b(dc,na):dc,lb?Pa.a(Jc,lb):Jc,Qc,null),wb=()=>new tb(Yb,jb);fa.EwaSettings.fc()?this.$.userOperationManager.Ub(new pa.a(514,0,Gb,64,wb),null):this.$.userOperationManager.Ub(new qa.a(514,0,Gb,void 0,wb),null)}Qna(na=0){0===na?this.gu=!1:1===na&&(this.hu=!1);this.Th&&(this.gu||this.hu)||(sa.KeyInputManager.instance.Ba(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=!1)}KN(na=!1){this.ih=5;this.Lw(this.Fh,this.Kf);this.sM=this.Frb;this.cO=this.vKb;
this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.aaa(),!1,na)}jPa(na=!1){this.ih=6;this.Lw(this.x5,this.y5);this.sM=this.Bha;this.cO=this.Zma;this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.isRow||this.Cq?11:12,!0,na)}Yya(na=!1){this.ih=6;this.Lw(this.DK,this.EK);this.sM=this.Bha;this.cO=this.Zma;this.Uz(this.Ew.clientPoint,this.Ew.Cb,this.Zx()?11:12,!0,na)}Zx(){return!this.Th&&this.isRow||this.Th&&this.Cq}i2(na){this.ob.Tg(this.Jh);this.Vs(this.x5,this.y5,void 0,na)}rsd(){const na=Mb.a.instance.Vb("Common.ISystemInitiatedFeedback");
na&&na.execute(lb=>{lb.logActivity("DragDrop",null)})}}Object(b.a)(Aa,"DragSelectionClickBehaviorCellRangeAndTable",Oa,[]);const Ba=(na,lb,jb,Yb,Gb,wb,dc=null)=>{dc=na.Na(1,dc);dc.moveRange=lb;return eb.g(na,"MoveLineItems",dc,jb,Yb,Gb,wb,0)};var ob=a(314),xb=a(145);class Va extends Oa{constructor(na,lb,jb,Yb,Gb){super(na,lb,jb,Gb);this.ZNa=()=>{this.gp&&this.Sga(!0);5===this.ih&&this.vx(!0)};this.EK=wb=>{S.a(this.$).Ud(wb);this.gp=!1;this.ob.Tg(this.Jh);this.ha.sourceRange=this.sourceRange.clone();
this.Qff?this.$.xd(927125067,N.a.Eb,30,null):this.p5a?(this.$F(),this.ha.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[z.a.n$]:!0,[z.a.dU]:this.ha.sourceRange,[z.a.cU]:this.ha.sa.Wc,[z.a.QHa]:!1}),Na.g(this.$).Cf.Yl(z.a.kQ),this.p5a=!1):this.n0i();this.Vs(this.DK,this.EK);this.ih=-1;return!0};this.DK=wb=>{wb=S.a(this.$).Ud(wb);const dc=wb.clientPoint;this.Ew=wb;let Jc=this.ha.Vn(dc,wb.Cb,5,void 0,void 0,!0);if(Jc){if(!this.mod(Jc))return this.f1h(wb),!0;this.ucg(Jc,this.isRow,dc);
if(this.isRow||this.Ze)this.fb=this.a2(Jc);this.ha.sourceRange=this.fb;this.ob.wi(this.fb,this.Jh);this.ob.Bn(this.Jh);this.ob.Tg(this.eB());this.yy()}return!0};this.onKeyDown=wb=>this.Y3(wb)?(this.h4||(sa.KeyInputManager.instance.ra(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=!0),this.p5a||(Na.g(this.$).Cf.Yl(za.N_a),this.p5a=!0),!0):!1;this.onKeyUp=wb=>{this.Y3(wb)&&(sa.KeyInputManager.instance.Ba(u.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.h4=!1,this.gp?Na.g(this.$).Cf.Yl(za.THa):
Na.g(this.$).Cf.Yl(z.a.kQ),this.p5a=!1);return!0};this.Kyf=wb=>{wb.Errors&&0<wb.Errors.length?(w.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${rb.a.zc(wb.Errors)}]`),this.fb.left=this.sourceRange.left,this.fb.right=this.sourceRange.right,this.fb.top=this.sourceRange.top,this.fb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.fb.top&&this.sourceRange.bottom>=this.fb.top-1?(this.fb.top=this.sourceRange.top,this.fb.bottom=
this.sourceRange.bottom):(this.sourceRange.top>this.fb.top||(this.fb.top-=this.sourceRange.height),this.fb.bottom=this.fb.top+this.sourceRange.height-1):this.sourceRange.left<=this.fb.left&&this.sourceRange.right>=this.fb.left-1?(this.fb.left=this.sourceRange.left,this.fb.right=this.sourceRange.right):(this.sourceRange.left>this.fb.left||(this.fb.left-=this.sourceRange.width),this.fb.right=this.fb.left+this.sourceRange.width-1);this.$F();this.ih=-1};this.Jyf=wb=>{wb=$a.a.kf(wb.data);w.ULS.sendTraceTag(521410184,
0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${rb.a.zc(wb)}]`)};this.tableManager=Yb;this.ha.eYb(this.ZNa);this.p5a=this.h4=!1}tmc(na){this.Ew=na;this.isRow=this.Ze=!1;this.gp=!0;sa.KeyInputManager.instance.ra(u.a.Mb,this.domElement.ownerDocument.body,this.onKeyDown);this.nc=this.tableManager.Sia(this.sourceRange);this.Qff=(new xb.a(this.$.xa)).ii;Na.g(this.$);Na.g(this.$).Cf.Yl(za.THa);this.mod(this.fb)?(this.isRow=this.Vki(),this.Ze=this.Wei(),this.isRow||this.Ze?
(this.Y5a=!1,this.Yya(na),this.fb=this.a2(this.fb),this.DI()):(this.Y5a=!0,this.KN(na),this.By())):(this.Y5a=!0,this.KN(na),this.By())}Zxa(){return this.Qff?(this.$.xd(927125067,N.a.Eb,30,null),this.vx(!0),this.Y5a=!1,this.ih=-1,!0):this.p5a?(this.$F(),this.ha.sourceRange=this.sourceRange.clone(),this.$.xd(-694765314,2,30,{[z.a.n$]:!0,[z.a.dU]:this.ha.sourceRange,[z.a.cU]:this.ha.sa.Wc,[z.a.QHa]:!1}),Na.g(this.$).Cf.Yl(z.a.kQ),this.vx(!0),this.gp=this.Y5a=!1,this.ih=-1,!0):5===this.ih?(this.vx(!0),
this.Y5a=!1,this.Uyj(),this.ih=-1,!0):!1}vmc(na){const lb=this.ha.Vn(na.clientPoint,na.Cb,5,void 0,void 0,!0);this.Ew=na;return this.Y5a?!1:this.mod(lb)?(this.g1h(na),!0):!1}yy(){let na=new ha.Range(this.fb.top,this.fb.left,this.fb.bottom,this.fb.right,!1,!0);6===this.ih&&(this.isRow?(--na.top,na.bottom=na.top+this.fb.height-1):(--na.left,na.right=na.left+this.fb.width-1));for(let lb=1;4>=lb;lb++)this.Nh[lb.toString()].childNodes[0].innerText=na.toString()}Kvc(){if(!Na.g(this.$).ha.sa.xg)return!1;
var na=Na.g(this.$).getRangeInformation(this.ha.sa.Wc);for(var lb of na)if(Object(Z.a)(ya.PivotTableRange,lb)&&(na=this.tableManager.Sia(lb)))return lb=!na.isOlap||!na.dMa(!0),na.isActionable&&lb;return!1}a2(na){na=na.clone();this.isRow?(na.left=this.sourceRange.left,na.right=this.nc.right,na.bottom=na.top+this.sourceRange.height-1):this.Ze?(na.top=this.sourceRange.top,na.bottom=this.nc.ZK.bottom,na.right=na.left+this.sourceRange.width-1):w.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");
return this.eYa(na)}n0i(){const na={},lb=nb.v(this.sourceRange,this.$);Na.g(this.$).getRangeInformation(this.fb);if(this.isRow){lb.FirstColumn=na.FirstColumn=this.fb.left-1;lb.LastColumn=na.LastColumn=this.fb.right-1;if(this.sourceRange.top<=this.fb.top&&this.sourceRange.bottom>=this.fb.top-1){w.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.fb.top?na.LastRow=na.FirstRow=this.fb.top-1:(na.FirstRow=this.fb.top-
this.sourceRange.height-1,na.LastRow=na.FirstRow+this.sourceRange.height-1)}else{na.FirstRow=this.fb.top;na.LastRow=this.fb.bottom-1;if(this.sourceRange.left<=this.fb.left&&this.sourceRange.right>=this.fb.left-1){w.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}na.LastColumn=this.sourceRange.left>this.fb.left?na.FirstColumn=this.fb.left-1:na.FirstColumn=this.fb.left-this.sourceRange.width-1}const jb={};jb.SheetName=this.$.xa.oa?this.$.xa.oa.name:
this.$.yb.getItemByName(this.$.yb.oa.name).sheetName;jb.Ranges=Array(2);jb.Ranges[0]=lb;jb.Ranges[1]=na;this.gwh(jb)}gwh(na){const lb=(jb,Yb,Gb)=>Ba(this.$.pa.va,na,this.Kyf?Pa.b(jb,this.Kyf):jb,this.Jyf?Pa.a(Yb,this.Jyf):Yb,Gb,null);fa.EwaSettings.fc()?this.$.userOperationManager.Ub(new pa.a(265,0,lb,64),null):this.$.userOperationManager.Ub(new qa.a(265,0,lb,void 0),null)}mod(na){return(null===this.nc.ZK||na.left>=this.nc.ZK.left)&&(null===this.nc.BE||na.right<=this.nc.BE.right)&&(null===this.nc.BE||
na.top>=this.nc.BE.top)&&(null===this.nc.ZK||na.bottom<=this.nc.ZK.bottom)}Vki(){return null!==this.nc.ZK&&this.nc.ZK.top<=this.fb.top&&this.nc.ZK.left<=this.fb.left&&this.nc.ZK.right>=this.fb.left}Wei(){return null!==this.nc.BE&&this.nc.BE.top===this.fb.top&&this.nc.BE.left<=this.fb.left&&this.nc.BE.right>=this.fb.right}Yya(na){this.ih=6;this.Jh=this.isRow?[11]:[12];this.Lw(this.DK,this.EK);this.Uz(na.clientPoint,na.Cb,this.isRow?11:12,!0,!1)}KN(na){this.ih=5;this.Lw(this.Fh,this.Kf);this.Uz(na.clientPoint,
na.Cb,this.aaa(),!1,!1)}g1h(na){this.vx(!1);this.Yya(na);this.fb=this.a2(this.fb);this.DI()}f1h(na){this.Sga(!1);this.KN(na);this.By()}Uyj(){if(!this.Faa(this.fb)){var na=rb.a.Yc(1,0,903,902,0,2069074184,"PivotTableInvalidMove");na.HelpTopicId=ob.a.yCj;na.HelpDescription=ua.a.instance.ga(908);cc.a(this.$).tr([na])}}}Object(b.a)(Va,"DragSelectionClickBehaviorPivotTableRange",Oa,[]);var bb=a(369);class ra extends ab{constructor(na,lb){super(na);this.zg=()=>{this.domElement.classList.remove(ba.selecting);
bb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.rp=()=>{this.domElement.classList.add(ba.selecting)};this.onPointerDown=jb=>{2===jb.tb&&jb.Tn===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.sa.Wc,bb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Mba=()=>{this.gridView.$.xd(1983983164,2,30,null);return!0};this.Zc=()=>{y.DOMElementExtensions.setVisible(this.J$,this.gridView.$.isEditMode)};
this.I5=()=>{y.DOMElementExtensions.setVisible(this.J$,!1)};this.H5=()=>{y.DOMElementExtensions.setVisible(this.J$,!0)};this.Swf=()=>{y.DOMElementExtensions.setVisible(this.J$,!1)};this.Rwf=()=>{y.DOMElementExtensions.setVisible(this.J$,!0)};this.pDb=(jb,Yb)=>{y.DOMElementExtensions.setVisible(this.J$,!Yb.Zie)};this.gridView=lb;lb=document.createElement("div");lb.className=da.a.Guh;this.J$=lb;this.Zc(null,null);na.appendChild(lb);r.a.instance.ra(u.a.pointerDown,this.J$,this.onPointerDown);M.a.instance.ra(u.a.nk,
this.J$,this.Mba);this.gridView.ha.K1(this.rp);this.gridView.ha.EX(this.zg);this.gridView.$.el(this.Zc);this.gridView.$.rb.mYb(this.I5);this.gridView.$.rb.lYb(this.H5);this.gridView.Cle(this.pDb);this.gridView.dc.Mk(this.Swf);this.gridView.dc.jm(this.Rwf)}dispose(){r.a.instance.Ba(u.a.pointerDown,this.J$,this.onPointerDown);M.a.instance.Ba(u.a.nk,this.J$,this.Mba);this.gridView.$&&(this.gridView.ha.i6(this.rp),this.gridView.ha.OV(this.zg),this.gridView.$.Cl(this.Zc),this.gridView.$.rb.prc(this.I5),
this.gridView.$.rb.orc(this.H5),this.gridView.UOf(this.pDb),this.gridView.dc.Gk(this.Swf),this.gridView.dc.Al(this.Rwf));super.dispose()}}Object(b.a)(ra,"FillHandleClickBehavior",ab,[]);class Qa extends E{constructor(na,lb){super(na);this.yQi=jb=>{const Yb=J.HelperMethods.Qn(jb);var Gb=this.$ua.TYd(jb.clientPoint);if(!Gb)return!1;var wb=Gb.Me,dc=this.$ua.Ea.wub(wb.hashCode).sua(Gb.EI);if(!dc)return!1;jb=wb.rj.domElement;Gb=J.HelperMethods.Gke(J.HelperMethods.Sub(wb.domElement,jb),Gb.EI);wb=0;dc=this.$ua.Xb(dc.getRange());
for(let Qc=0,fd=Qa.Vve.length;Qc<fd;++Qc){const Wc=Qa.Vve[Qc];if((128===Wc||64===Wc)&&this.$ua.$.isEditMode)continue;var Jc=dc.yJa(Wc);if(!Jc||!Jc.Y4a||"none"===Jc.Y4a.style.display)continue;Jc=Jc.Y4a;const Rb=J.HelperMethods.Sub(Jc,jb);Jc=new Sys.UI.Bounds(Rb.x,Rb.y,Jc.offsetWidth,Jc.offsetHeight);if(W.a.WM(Jc,Gb)){wb=Wc;break}}return 0!==wb?(dc.invoke(wb,Yb),!0):!1};this.Sog=lb;M.a.instance.ra(u.a.click,na,this.yQi)}get $ua(){return this.Sog}}Qa.Vve=[1,2,32,256,128,64];Object(b.a)(Qa,"IPadSelectionClickThroughBehavior",
E,[]);var qb=a(22);class Wa{constructor(na){this.I7e=lb=>{this.Vzc(lb.Cb,1);return!0};this.J7e=lb=>{this.Vzc(lb.Cb,-1);return!0};this.zg=()=>{this.Qmd=!1};this.rp=()=>{this.Qmd=!0};this.gridView=na;this.y4a=0;this.Qmd=this.Xec=!1;this.I4=Number.NaN;this.gridView.ha.K1(this.rp);this.gridView.ha.EX(this.zg);this.gridView.ha.eYb(this.zg)}dispose(){this.gridView.ha.i6(this.rp);this.gridView.ha.OV(this.zg);this.gridView.ha.mId(this.zg)}mza(){this.y4a=0;this.Xec=!1;this.I4=Number.NaN}aIe(na){this.Xec=!0;
this.Vzc(na,1)}bIe(na){this.Xec=!1;this.Vzc(na,-1)}Vzc(na,lb){if(na)if(na.parentNode)if(this.Qmd)isNaN(this.I4)||(this.iAc(this.I4,!1),this.I4=Number.NaN);else if(na=parseInt(na.parentNode.getAttribute(z.a.P4a),10),isNaN(na))w.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.I4)&&na!==this.I4){if(this.Xec)return;this.iAc(this.I4,!1)}if(isNaN(this.I4)||na!==this.I4)this.I4=na,this.y4a=0;!this.y4a&&0<lb&&
this.iAc(na,!0);this.y4a=Math.max(this.y4a+lb,0);!this.y4a&&0>lb&&(this.iAc(na,!1),this.I4=Number.NaN)}else w.ULS.shipAssertTag(537159367,0,!!na.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else w.ULS.shipAssertTag(537159368,0,!!na,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}iAc(na,lb){for(let Yb=1;4>=Yb;Yb++){var jb=this.gridView.ob.ev(3,Yb,na).tf;y.DOMElementExtensions.toggleCssClass(jb,ba.cuh,lb);for(jb=jb.firstChild;jb;jb=jb.nextSibling)qb.a.contains(jb.className,
"resizemarqueehandle",!0)&&y.DOMElementExtensions.toggleCssClass(jb,ba.guh,lb)}}}Object(b.a)(Wa,"MarqueeHoveringManager",null,[]);var ta=a(187),ib=a(84),Bb=a(816),Ub=a(1227);class Ta extends E{constructor(na,lb){super(na);this.Dzf=()=>{if(!this.gv)return w.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.gv.dKf(this.vH,!1);this.gv.SJe(this.vH,!1);if(3===this.gv.model.state)return!0;this.gv.F7e(!0);return!0};this.Qba=()=>
{if(!this.gv)return!1;this.gv.o2i();this.gv.NJd(this.vH,!1);if(3===this.gv.model.state)return!0;this.gv.F7e(!1);return!0};this.onPointerDown=jb=>this.gv?2===jb.tb&&jb.Tn===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.ODb=()=>{if(!this.gv)return!1;this.gv.NJd(this.vH,!0);this.gv.dKf(this.vH,!0);this.gv.SJe(this.vH,!0);this.gv.dJb(!0);return!0};this.onDoubleClick=jb=>{if(jb.Ca)return jb.Ca.stopPropagation(),!0;w.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};this.gv=Object(ib.a)(Ub.a,lb.metadata);this.bK=document.createElement("div");this.bK.id=`${na.id}-${z.a.Lve}`;this.bK.className=Bb.a.DUg;this.vH=document.createElement("div");this.vH.id=`${na.id}-${z.a.IYc}`;this.vH.className=Bb.a.IYc;this.bK.appendChild(this.vH);na.appendChild(this.bK);w.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");r.a.instance.ra(u.a.wV,this.bK,this.Dzf);r.a.instance.ra(u.a.my,
this.bK,this.Qba);r.a.instance.ra(u.a.pointerDown,this.bK,this.onPointerDown);ta.a.instance.ra(u.a.click,this.bK,this.ODb);ta.a.instance.ra(u.a.nk,this.bK,this.onDoubleClick)}dispose(){r.a.instance.Ba(u.a.wV,this.bK,this.Dzf);r.a.instance.Ba(u.a.my,this.bK,this.Qba);r.a.instance.Ba(u.a.pointerDown,this.bK,this.onPointerDown);ta.a.instance.Ba(u.a.click,this.bK,this.ODb);ta.a.instance.Ba(u.a.nk,this.bK,this.onDoubleClick);y.DOMElementExtensions.nf(this.vH);this.vH=null;y.DOMElementExtensions.nf(this.bK);
this.gv=this.bK=null;super.dispose()}dYa(na){this.gv=Object(ib.a)(Ub.a,na.metadata)}}Object(b.a)(Ta,"RangeCatchUpActivityHighlightBehavior",E,[]);class mb extends V{constructor(na,lb,jb,Yb){super(na,lb,jb,Yb)}get N3(){return 16}get Dbb(){return this.gridView.ha.rangePicker.$ad(!1)}mRa(){return(this.gridView.inRangePicker||this.gridView.vi)&&super.mRa()}}Object(b.a)(mb,"RangePickerTouchGrippiesBehavior",V,[]);class Qb extends E{constructor(na,lb){super(na);const jb=document.createElement("div"),Yb=
document.createElement("div");jb.className=lb?ba.Ouh:ba.Quh;Yb.className=lb?ba.Puh:ba.Nuh;na.appendChild(jb);na.appendChild(Yb)}}Object(b.a)(Qb,"RearrangeHighlightBehavior",E,[]);var Lb;(function(na){na[na.topLeft=0]="topLeft";na[na.topRight=1]="topRight";na[na.bottomLeft=2]="bottomLeft";na[na.bottomRight=3]="bottomRight";na[na.error=4]="error"})(Lb||(Lb={}));Object(b.b)("Corner",Lb);class Jb extends E{constructor(na,lb,jb,Yb,Gb){super(na);this.Ya=this.XF=null;this.y2=0;this.fb=this.sourceRange=null;
this.YRa=!1;this.onPointerDown=wb=>{wb=S.a(this.$).Ud(wb);if(this.O0f(wb)&&!this.YRa){this.Blf();this.Ya=this.jo.i9b();this.XF=this.jo.J0e(wb);if(!this.Ya||!this.XF||!this.XF.range)return w.ULS.shipAssertTag(537159361,0,!!this.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),w.ULS.shipAssertTag(537159360,0,!!this.XF,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),w.ULS.shipAssertTag(537159331,0,!!this.XF.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),
!1;this.fb=this.XF.range.clone();this.sourceRange=this.fb.clone();this.y2=this.GXe(wb);if(4===this.y2)return w.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const dc=this.wZe(wb,!0);if(!dc)return w.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.OCe(dc))return w.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;this.gridView.LKa=!0;this.Ya.tE(!1);this.AF.aIe(wb.Cb);this.jo.NJf(!0,this.taa.yT);this.Ya.textBox.removeSelection();this.Ya.OXb(this.r4e);this.cNf();this.YRa=!0;Ca.b(this.$,!0)}return!0};this.Fh=wb=>{wb=S.a(this.$).Ud(wb);wb=this.wZe(wb,!1);if(!wb)return!0;wb=this.OCe(wb);if(!wb)return w.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.d8b(!0),!1;if(this.fb.equals(wb))return!0;this.fb=wb;wb=this.By();wb||(w.ULS.shipAssertTag(537159326,0,
!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.d8b(!0));return wb};this.Kf=wb=>{S.a(this.$).Ud(wb);wb=this.$F();w.ULS.shipAssertTag(537159325,0,wb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.d8b(!wb);return wb};this.r4e=()=>{this.d8b(!0)};this.gridView=lb;this.$=lb.$;this.WK=[];this.ha=this.gridView.ha;this.AF=jb;this.jo=Yb;this.taa=Gb;this.coloredReferencesManager=this.$.da.za(281);w.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,
"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.sz=K.a.sz(this.$))lb=this.$.da.za(464),w.ULS.shipAssertTag(0,0,!!lb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.hz=lb.hz;for(const wb of this.kSf())lb=this.jo.$Be(na,wb,this.pne(),this.onPointerDown),this.WK.push(lb);for(const wb of this.WK)r.a.instance.ra(u.a.wV,wb,this.AF.I7e),
r.a.instance.ra(u.a.my,wb,this.AF.J7e);this.dYa(Gb)}dispose(){this.WK.forEach(na=>{r.a.instance.Ba(u.a.pointerDown,na,this.onPointerDown)});this.WK.length=0;super.dispose()}dYa(na){this.taa=na;this.yne(na);this.jo.$Jb(na,this.WK,this.YPd());this.AF.mza()}wZe(na,lb){const jb=na.Cb;na=na.clientPoint;if(!jb||!na)return w.ULS.shipAssertTag(537159324,0,!!jb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159323,0,!!na,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;lb&&(na=this.Ipf(na));lb=this.ha.Vn(na,jb,0,!0,!1,!0);lb||(na=this.Ipf(na),lb=this.ha.Vn(na,jb,0,!0,!1,!0));return lb}Ipf(na){na.y+=0===this.y2||1===this.y2?2:-2;na.x+=0===this.y2||2===this.y2?2:-2;return na}OCe(na){if(!na||!this.sourceRange)return w.ULS.shipAssertTag(537159322,0,!!na,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),w.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.y2)return new ha.Range(na.top,
na.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.y2)return new ha.Range(na.top,this.sourceRange.left,this.sourceRange.bottom,na.right,!0,!1);if(2===this.y2)return new ha.Range(this.sourceRange.top,na.left,na.bottom,this.sourceRange.right,!0,!1);if(3===this.y2)return new ha.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,na.right,!0,!1);w.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Lb[this.y2]}`);
return null}$F(){return this.sz?this.hz.cCb(this.Ya,this.XF,this.fb):this.coloredReferencesManager.cCb(this.Ya,this.XF,this.fb)}By(){return this.$F()}d8b(na){na&&w.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.AF.bIe(this.WK[0]);this.jo.NJf(!1,this.taa.yT);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Vqc(this.r4e);this.Mag();this.YRa=this.gridView.LKa=!1;Ca.b(this.$,!1);this.jo.DLf()}}
Object(b.a)(Jb,"ResizeMarqueeBehaviorBase",E,[]);class Ab extends Jb{constructor(na,lb,jb,Yb,Gb){super(na,lb,jb,Yb,Gb)}kSf(){return[ba.Uuh,ba.Vuh,ba.Suh,ba.Tuh]}pne(){return[ba.Ruh]}GXe(na){na=na.Cb;if(na===this.WK[0])return 0;if(na===this.WK[1])return 1;if(na===this.WK[2])return 2;if(na===this.WK[3])return 3;w.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}cNf(){this.jo.Lw(this.Fh,this.Kf,!0)}Mag(){this.jo.HWd(this.Fh,
this.Kf,!0)}O0f(na){return 2===(N.a.Eb=na.tb)&&na.Tn===Sys.UI.MouseButton.leftButton}YPd(){return!0}Blf(){w.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}yne(na){for(const lb of this.WK)lb.style.backgroundColor=na.tf.style.borderColor}}Object(b.a)(Ab,"ResizeMarqueeMouseBehavior",Jb,[]);class pb extends Jb{constructor(na,lb,jb,Yb,Gb){super(na,lb,jb,Yb,Gb);this.JDb=()=>{const wb=3===N.a.Eb;this.Pqd&&!wb?this.jo.$Jb(this.taa,
this.WK,!1):!this.Pqd&&wb&&this.jo.$Jb(this.taa,this.WK,!0);this.Pqd=wb};this.EPi=(wb,dc)=>{dc.P4a===this.taa.yT&&this.jo.$Jb(this.taa,this.WK,!dc.start&&this.YPd())};N.a.jme(this.JDb);this.Pqd=3===N.a.Eb;this.jo.ZEg(this.EPi)}dispose(){N.a.vPf(this.JDb);super.dispose()}kSf(){return[da.a.Wth,da.a.Vth]}pne(){const na=!fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[na?da.a.ZOe:da.a.YOe,da.a.c7b,na?da.a.Uth:da.a.b7b]}GXe(na){na=na.Cb;if(na===this.WK[0])return 0;if(na===
this.WK[1])return 3;w.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}cNf(){v.a.lv?this.jo.Lw(this.Fh,this.Kf,!1):this.jo.v7i(this.Fh,this.Kf)}Mag(){v.a.lv?this.jo.HWd(this.Fh,this.Kf,!1):this.jo.COj(this.Fh,this.Kf)}O0f(na){return 3===(N.a.Eb=na.tb)}YPd(){return 3===N.a.Eb}Blf(){w.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}yne(){}}Object(b.a)(pb,
"ResizeMarqueeTouchBehavior",Jb,[]);class va extends E{constructor(na,lb){super(na);va.hqb(na,H.a.luh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.horizontal);va.hqb(na,H.a.kuh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.vertical);va.hqb(na,H.a.huh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.horizontal);va.hqb(na,H.a.juh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.vertical);va.hqb(na,da.a.iuh)}static hqb(na,lb,jb){const Yb=document.createElement("div");Yb.className=lb;jb&&(Yb.style.backgroundImage=
`url("${jb}")`);na.appendChild(Yb)}}Object(b.a)(va,"SelectionCutCopyBehavior",E,[]);class db extends E{constructor(na){super(na);appChrome.renderSpinner(na)}}Object(b.a)(db,"SelectionPasteBehavior",E,[]);class Ya extends E{constructor(na,lb){super(na);Ya.xqb(na,H.a.Muh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.horizontal);Ya.xqb(na,H.a.Luh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.vertical);Ya.xqb(na,H.a.Iuh+" "+da.a.Kta,null===lb||void 0===lb?void 0:lb.horizontal);Ya.xqb(na,H.a.Kuh+" "+da.a.Kta,
null===lb||void 0===lb?void 0:lb.vertical);Ya.xqb(na,da.a.Juh)}static xqb(na,lb,jb){const Yb=document.createElement("div");Yb.className=lb;jb&&(Yb.style.backgroundImage=`url("${jb}")`);na.appendChild(Yb)}}Object(b.a)(Ya,"SelectionRangePickerBehavior",E,[]);class gb extends V{constructor(na,lb,jb,Yb){super(na,lb,jb,Yb)}get N3(){return 0}get Dbb(){return this.gridView.ha.sa.Wc}mRa(){const na=this.gridView.vi||this.gridView.$a;return this.gridView.ha.sa.xg&&!na&&super.mRa()}}Object(b.a)(gb,"SelectionTouchGrippiesBehavior",
V,[]);var Ka=a(54);class ub extends n.a{constructor(na,lb){super();this.wnb=(jb,Yb)=>{jb=Yb.N3;const Gb=this.gridView;Yb=Yb.U5h;const wb=Yb.tf,dc=Yb.s9;v.a.Zg&&dc.push(new Qa(wb,Gb));switch(jb){case 24:Yb.s9.push(new Ta(wb,Yb));break;case 0:Yb.s9.push(new ra(wb,Gb));v.a.jp||(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(dc.push(new Aa(wb,this.gridView.$,Yb.paneType,this.tableManager,this.jo)),fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&dc.push(new Va(wb,this.gridView.$,Yb.paneType,this.tableManager,this.jo))):dc.push(new Ib(wb,this.gridView.$,Yb.paneType,this.tableManager,this.jo)));dc.push(new gb(Yb,wb,Gb,Yb.paneType));break;case 3:dc.push(new ab(wb));v.a.jp||(dc.push(new la(wb,this.gridView.$,Yb.paneType,this.AF,this.jo,Yb)),dc.push(new Ab(wb,this.gridView,this.AF,this.jo,Yb)),dc.push(new pb(wb,this.gridView,this.AF,this.jo,Yb)));break;case 4:case 5:dc.push(new va(wb,this.Goe));break;case 30:dc.push(new db(wb));break;case 16:dc.push(new Ya(wb,
this.Goe));dc.push(new mb(Yb,wb,Gb,Yb.paneType));break;case 11:case 12:dc.push(new Qb(wb,11===jb));break;case 17:dc.push(new ab(wb));break;case 19:dc.push(new ab(wb)),dc.push(new wa(Yb,wb,Gb,Yb.paneType))}Yb.TZb=!0};this.$=na;this.gridView=Na.g(na);this.tableManager=lb;this.AF=new Wa(this.gridView);this.jo=new G(this.gridView);this.gridView.ob&&(this.gridView.ob.wEg(this.wnb),this.gridView.ob.update(!1));na.da.Ga(64,this)}get Goe(){fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.Foe&&(this.Foe={vertical:Ka.a.current.Rn(104),horizontal:Ka.a.current.Rn(105)});return this.Foe}dispose(){this.gridView.ob.Daj(this.wnb);this.AF&&(this.AF.dispose(),this.AF=null);super.dispose()}}Object(b.a)(ub,"GridHighlightsBehaviorManager",n.a,[]);class ac extends d.a{constructor(na){super();this.$=na;this.Fb()}create(){m.TaskExtensions.Aa(l.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ib),na=>{this.qb(this.$.da.za(64)||new ub(this.$,na.result))},this.la,3)}static ka(na){na.da.Ga(149,
new ac(na))}}Object(b.a)(ac,"GridHighlightsBehaviorManagerFactory",d.a,[]);a.d(D,"a",function(){return Ra});const Ra=()=>{c.a.Fa(ac.ka);c.a.Fa(k.ka)}},1140:function(t,D,a){var c=a(10);t=a(0);var b=a(690),d=a(50),f=a(37),e=a(181),k=a(55);class l{constructor(Ka){this.thh=Ka}Qc(){return!1}executeCommand(Ka,ub){Ka=ub.command;ub=null;switch(Ka){case 1243860697:this.thh.SJj();break;default:ub=e.a(Ka)}return ub||k.Task.Ua(!0)}Ec(Ka,ub){return 1243860697===ub.command}Vc(){return!1}}Object(t.a)(l,"SheetDropdownMenuCommandHandler",
null,[188]);class m extends b.a{constructor(Ka){super(Ka)}Dd(){this.$.kz(Ka=>{Ka.Scc().then(()=>{f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,32,33,this.ib),ub=>{this.ld([new l(ub.result.Huj)])},this.$.la)})})}static ka(Ka){b.a.Rd(392,new m(Ka))}}Object(t.a)(m,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var v=a(220),n=a(5),w=a(75),r=a(36),u=a(1),x=a(15),z=a(27),B=a(187),y=a(13),A=a(86),K=a(44),G=a(235),T=a(155),W=a(108),P=a(39),E=a(412),H=a(84),F=a(14),N=a(34);class J{constructor(){this.IGe=
new N.a(!0);this.QFc=0}get U4c(){return this.QFc}get navigationButtonsDisabled(){return!!(this.U4c&1)}get operationButtonsDisabled(){return!!(this.U4c&2)}NJg(Ka,ub){this.IGe.add(Ka,ub);this.YR()}YR(){this.QFc=0;N.a.forEach(this.IGe.ju,Ka=>{this.QFc=this.U4c|Ka.value})}}Object(t.a)(J,"SheetTabBarDisabledStateManager",null,[]);var R=a(234),M=a(30);class L{}L.frh="ewa-stb-uir";L.DMe="ewa-stb-drag";L.Qqh="ewa-stb-navarea";L.Rqh="ewa-stb-navarea-dimensions";L.Tqh="ewa-stb-navbutton";L.MT="cui-disabled";
L.Sqh="ewa-stb-navareaextra";L.pha="cui-img-container";L.Nqh="ewa-stb-contentarea";L.EMe="ewa-stb-left-scrollable";L.PMe="ewa-stb-right-scrollable";L.drh="ewa-stb-tabarea";L.crh="ewa-stb-sheettabmoveindicator";L.RMe="ewa-stb-tabs";L.BGj="tab-active";L.JGj="tab-inactive";L.IGj="tab-hover";L.erh="ewa-stb-tabs-ghost";L.DGj="tab-anchor-text";L.dark="dark";L.light="light";L.CGj="tab-active-text";L.GGj="tab-content-container";L.LGj="tab-text";L.Wqh="ewa-stb-nsv-inactive";L.Xqh="ewa-stb-nsv-inactive-svg";
L.Uqh="ewa-stb-nsv-active";L.Vqh="ewa-stb-nsv-active-svg";L.Cph="ewa_nsv_margin";L.Oqh="ewa-stb-disable-scrollbar";L.Hqi="leave-size-fixed-on-tab-hover-old";L.Gqi="leave-size-fixed-on-tab-hover";L.IMe="ewa-stb-locked-sheet";L.JMe="ewa-stb-locked-sheet-svg-16px";L.Pqh="ewa-stb-dropdown-menu-button";L.Blh="ewa-active-sheet-menu-item";Object(t.a)(L,"CssClassNames",null,[]);var U=a(550),X=a(19),da=a(258),fa=a(102),S=a(510),ka=a(170),V=a(245),wa=a(45),ma=a(284),ab=a(54),ba=a(12),Ca=a(70),Na=a(313),za=
a(11),la=a(100),aa=a(342),sa=a(21),ea=a(188),Z=a(369),ua=a(366),ya=a(43),ha=a(221),Da=a(85);class nb extends R.a{constructor(Ka,ub,ac=!1){super(Ka);this.p$a=this.Kra=null;this.$=ub;this.WW=ac}get disabled(){return this.WW}dispose(){this.p$a=this.Kra=this.$=null;super.dispose()}wW(Ka){this.WW=Ka;this.domElement.setAttribute(n.a.tra,Ka.toString());ba.DOMElementExtensions.toggleCssClass(this.domElement,U.a.MT,Ka)}}Object(t.a)(nb,"SheetBarButton",R.a,[]);var qa=a(708);class pa extends nb{constructor(Ka,
ub,ac,Ra=!1){super(document.createElement("a"),ub,Ra);this.dd=na=>{this.disabled||this.$.xd(-1935155518,na.tb,30,null);return!0};this.QDb=na=>{na="mouseover"===na.type||"focus"===na.type;const lb=Z.a(this.$)?this.p$a:this.Kra;za.HelperMethods.MUd(lb,this.Hga,this.Hga+n.a.xcc,na&&!sa.g(this.$).inRangePicker)};this.Lh=()=>{this.wW(!0)};this.Jf=()=>{this.wW(!1)};this.Hga=u.EwaSettings.ma(500)?X.a.M7c:X.a.yNe;this.Kra=ac.pb(this.domElement,F.a.instance.ga(514),0,this.Hga,F.a.instance.ga(515),qa.a.h0c,
Ra);Ka.appendChild(this.domElement);this.Fc.ka("contextmenu",na=>{Ca.g(na)});u.EwaSettings.ma(500)||(this.Fc.ka("mouseover",this.QDb),this.Fc.ka("mouseout",this.QDb));ha.a.instance.ra(y.a.click,this.domElement,this.dd);this.jMa=W.KeyInputManager.instance.ls(this.domElement,this.dd,Da.a.Zh,Da.a.w0);u.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(sa.g(this.$).dc.Mk(this.Lh),sa.g(this.$).dc.jm(this.Jf))}dispose(){ha.a.instance.Ba(y.a.click,this.domElement,this.dd);
W.KeyInputManager.instance.Ev(this.domElement,this.jMa);u.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&sa.g(this.$)&&sa.g(this.$).dc&&(sa.g(this.$).dc.Gk(this.Lh),sa.g(this.$).dc.Al(this.Jf));super.dispose()}wW(Ka){const ub=pa.M0f(this.$);super.wW(Ka||ub)}static M0f(Ka){return!Ka.isEditMode||!Ka.xa.count}}Object(t.a)(pa,"InsertSheetButton",nb,[]);class Ja extends nb{constructor(Ka,ub,ac){super(document.createElement("a"),ub);this.dd=Ra=>{this.$.xd(-684145703,
Ra.tb,0,null);return!0};this.QDb=Ra=>{za.HelperMethods.MUd(this.Nte,this.Hga,this.Hga+n.a.xcc,("mouseover"===Ra.type||"focus"===Ra.type)&&!sa.g(this.$).inRangePicker)};this.$=ub;this.Hga=u.EwaSettings.ma(500)?X.a.M7c:X.a.yNe;this.Nte=ac.pb(this.domElement,F.a.instance.ga(516),0,this.Hga,F.a.instance.ga(517),qa.a.h0c);Ka.appendChild(this.domElement);this.Fc.ka("contextmenu",Ra=>{Ca.g(Ra)});this.Fc.ka("mouseover",this.QDb);this.Fc.ka("mouseout",this.QDb);ha.a.instance.ra(y.a.click,this.domElement,this.dd);
this.jMa=W.KeyInputManager.instance.ls(this.domElement,this.dd,Da.a.Zh,Da.a.w0)}dispose(){ha.a.instance.Ba(y.a.click,this.domElement,this.dd);W.KeyInputManager.instance.Ev(this.domElement,this.jMa);this.Nte=null;super.dispose()}}Object(t.a)(Ja,"InsertTemplateButton",nb,[]);class $a{constructor(Ka,ub){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Ka;this.newSheetIndex=ub}getSheetName(){return this.sheetName}}Object(t.a)($a,"MacroRecorderSheetReorderedPayload",null,[116]);var rb=a(90);class Pa extends R.a{constructor(Ka,
ub){super(document.createElement("div"));this.bR=()=>{x.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.uQf(!1,"OnSheetsChanged")};this.rIi=()=>{this.Bj()};this.qIi=()=>{this.ek()};this.$=Ka;this.iHj=ub;this.oU=!1;this.BMb=0}dispose(){this.ek();super.dispose()}SJj(){this.uQf(!0,"TogglerSheetDropdownMenu")}uQf(Ka,ub){x.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${ub}, toggle: ${Ka}, toggleStateId: ${this.BMb}`);Ka&&(this.BMb+=
1);const ac=this.$.Hb.xc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${ub}, toggle: ${Ka}, toggleStateId: ${this.BMb}, sheetCount: ${this.$.xa.count}`);Ka=this.k9g();appChrome.renderSheetDropdownMenu(this.domElement,this.iHj,Ka,this.BMb,this.rIi,this.qIi,()=>{ac.stop()},Z.a(this.$))}k9g(){const Ka=this.$.xa,ub=[];for(let Ra=0;Ra<Ka.count;Ra++){var ac=Object(H.a)(la.a,Ka.getItem(Ra));0===ac.xy&&(ac=this.j9g(ac),ub.push(ac))}return ub}j9g(Ka){const ub={};ub.key=Ka.name;ub.text=
Ka.name;ub.onClick=this.l9g(Ka);Ka.active&&(ub.className=Z.a(this.$)?"ewa-active-sheet-menu-item-present-mode":L.Blh);return ub}l9g(Ka){return()=>{const ub=new rb.a(-1876836819,0,this.$.Mc,30,null);this.$.Ka.Lb(ub,{[n.a.cPd]:Ka.name})}}Bj(){if(!this.oU){const Ka=this.$.xa;Ka.Pf(this.bR);Ka.mTc(this.bR);Ka.DX(this.bR);Ka.dga(this.bR);Ka.XEa(this.bR);Ka.gme(this.bR);Ka.RXa(this.bR);this.oU=!0}}ek(){if(this.oU){const Ka=this.$.xa;Ka.Ag(this.bR);Ka.JHd(this.bR);Ka.h6(this.bR);Ka.gma(this.bR);Ka.wPa(this.bR);
Ka.tPf(this.bR);Ka.uHb(this.bR);this.oU=!1}}}Object(t.a)(Pa,"SheetDropdownMenu",R.a,[637,3]);var eb=a(346);class Ob extends nb{constructor(Ka,ub,ac){super(document.createElement("a"),Ka,!0);this.yg=()=>{this.wW(!1);this.$.ea.xn(this.yg)};this.dd=Ra=>{this.X8f(Ra.tb);return!0};this.onKeyDown=Ra=>13===Ra.Ca.keyCode||32===Ra.Ca.keyCode?(this.X8f(Ra.tb),!0):!1;this.Kra=ub.pb(this.domElement,F.a.instance.ga(518),0,X.a.Mqh,F.a.instance.ga(518),qa.a.D0h,this.disabled);this.domElement.classList.add(L.Pqh);
ac.appendChild(this.domElement);this.$.ea.ql(this.yg);this.d7i()}dispose(){this.yOj();super.dispose()}wW(Ka){super.wW(Ka||!this.$.ea.Tva)}X8f(Ka){this.disabled||(x.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${eb.a[Ka]}`),this.$.Ka.Lb(new rb.a(1243860697,Ka,this.$.Mc,30,null)))}d7i(){ha.a.instance.ra(y.a.click,this.domElement,this.dd);W.KeyInputManager.instance.ra(y.a.Mb,this.domElement,this.onKeyDown)}yOj(){ha.a.instance.Ba(y.a.click,this.domElement,this.dd);
W.KeyInputManager.instance.Ba(y.a.Mb,this.domElement,this.onKeyDown)}}Object(t.a)(Ob,"SheetDropdownMenuAnchor",nb,[]);var tb=a(62);const cc=(Ka,ub,ac,Ra,na,lb,jb,Yb=null)=>{Yb=Ka.Na(9,Yb);Yb.sheetName=ub;Yb.newSheetIndex=ac;return tb.g(Ka,"ReorderSheets",Yb,Ra,na,lb,jb,0)};var Ib=a(197),Mb=a(128),Oa=a(184),Aa=a(131),Ba=a(59),ob=a(209),xb=a(196),Va=a(166),bb=a(132);class ra{constructor(Ka,ub,ac){this.qm=ub;this.tw=ac;this.sheet=Ka;this.altText=F.a.instance.ga(1988)}YM(){return this.sheet.active}Jmd(){return this.sheet.isLockPausedInSession}Zra(){return this.qm?
X.a.HMe:this.YM()?X.a.GMe:X.a.FMe}tna(){return this.sheet.ii?qa.a.MIf:qa.a.kOj}tTd(){return 16}Rga(){return null}$ra(){return this.qm?this.tw?L.JMe:L.IMe:null}WUd(){return null}xs(){return null}Tid(){return 0}NUc(){return!0}}Object(t.a)(ra,"LockPausedSheetIconDataSource",null,[639]);class Qa{constructor(Ka,ub,ac){this.qm=ub;this.tw=ac;this.sheet=Ka;this.altText=F.a.instance.ga(1987)}YM(){return this.sheet.active}Jmd(){return this.sheet.ii}Zra(){return this.qm?X.a.HMe:this.YM()?X.a.GMe:X.a.FMe}tna(){return qa.a.MIf}tTd(){return 16}Rga(){return null}$ra(){return this.qm?
this.tw?L.JMe:L.IMe:null}WUd(){return null}xs(){return null}Tid(){return 0}NUc(){return!0}}Object(t.a)(Qa,"LockedSheetIconDataSource",null,[639]);class qb{constructor(Ka,ub,ac,Ra){this.sheet=Ka;this.altText=F.a.instance.ga(1900);this.fKj=ub;this.I1f=ac;this.tw=Ra}YM(){return this.sheet.active}Jmd(){return this.sheet.Fd.mv}Rga(){return this.tw?this.YM()?L.Vqh:L.Xqh:this.YM()?L.Uqh:L.Wqh}Zra(){return!this.YM()&&this.I1f()?X.a.Lsh:X.a.Ksh}tna(){return!this.YM()&&this.I1f()?qa.a.Ruj:qa.a.Quj}tTd(){return 14}$ra(){return L.Cph}WUd(){return this.sheet.Fd.Glb}xs(){return this.fKj}Tid(){return 8}NUc(){return!1}}
Object(t.a)(qb,"NamedSeetViewSheetIconDataSource",null,[639]);var Wa=a(156),ta=a(127);class ib{constructor(Ka,ub){this.Lpa=this.O0=this.pAa=this.wl=null;this.Eef=!1;this.GPc=this.tna=this.$ra=this.Rga=this.Zra=null;this.uN=()=>{this.dataSource.YM()&&f.TaskExtensions.Aa(this.XAb,()=>{dialogControls.renderToolTip(this.dataSource.xs(),"SheetIconTooltip",this.dataSource.WUd(),this.vI,10,!1,!1,1)},this.$.la,3)};this.tN=()=>{this.dataSource.YM()&&this.clearToolTip()};this.$=Ka;this.dataSource=ub;this.tw=
r.a.Eod()}get Fc(){return this.O0||(this.O0=ta.a.instance.Vd(this.vI))}get XAb(){if(this.Lpa)return this.Lpa;const Ka=new Wa.a;this.$.kz(ub=>{f.TaskExtensions.Aa(ub.Vrd(),()=>{Ka.setResult(!0)},this.$.la,3)});return this.Lpa=Ka.task}get vI(){return this.GPc}hcg(){if(this.vI&&(this.wl||this.pAa)){if(this.tw){var Ka=this.dataSource.tna();this.tna!==Ka&&(this.pAa&&this.pAa.parentNode.removeChild(this.pAa),this.P9e(),this.tna=Ka)}else Ka=this.dataSource.Zra(),this.Zra!==Ka&&(this.OId(this.wl,this.Zra,
Ka),this.Zra=Ka);Ka=this.dataSource.Rga();this.Rga!==Ka&&(this.tw?this.$cj(this.pAa,this.Rga,Ka):this.OId(this.wl,this.Rga,Ka),this.Rga=Ka);Ka=this.dataSource.$ra();this.$ra!==Ka&&(this.OId(this.vI,this.$ra,Ka),this.$ra=Ka);this.dataSource.xs()&&!this.dataSource.YM()&&this.clearToolTip()}}tzj(Ka,ub,ac){this.dai(Ka,ub,ac);ba.DOMElementExtensions.setVisible(this.vI,this.dataSource.Jmd())}clearToolTip(){f.TaskExtensions.Aa(this.XAb,()=>{dialogControls.clearToolTip(this.dataSource.xs())},this.$.la,3)}dai(Ka,
ub,ac){this.vI&&this.Eef!==Ka&&(this.vI.parentNode.removeChild(this.vI),this.$ra=this.Rga=this.tna=this.Zra=this.GPc=null,this.dataSource.xs()&&(this.Fc.detach("mouseover",!0),this.Fc.detach("mouseout",!0)));this.vI||(this.GPc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.vI,U.a.pha),Sys.UI.DomElement.addCssClass(this.vI,X.a.RA),u.EwaSettings.ma(500)?Ka===this.dataSource.NUc()?ub.appendChild(this.vI):ub.insertBefore(this.vI,ac):Ka?ub.insertBefore(this.vI,ac):ub.appendChild(this.vI),
this.tw?this.P9e():(this.wl=document.createElement("img"),this.wl.tabIndex=-1,this.wl.alt=this.dataSource.altText,this.vI.appendChild(this.wl),this.wl.src=ab.a.gf(this.dataSource.Tid())),this.dataSource.xs()&&(this.Fc.ka("mouseover",this.uN,!0),this.Fc.ka("mouseout",this.tN,!0)),this.Eef=Ka)}$cj(Ka,ub,ac){Ka&&(Sys.UI.DomElement.removeCssClass(Ka,ub),Sys.UI.DomElement.addCssClass(Ka,ac))}OId(Ka,ub,ac){ub&&Sys.UI.DomElement.removeCssClass(Ka,ub);ac&&Sys.UI.DomElement.addCssClass(Ka,ac)}dispose(){A.a.Ia(this.O0)}P9e(){const Ka=
this.$.da.za(388);Ka?(this.pAa=Ka.Tua(this.dataSource.tna(),this.dataSource.tTd()))?this.vI.appendChild(this.pAa):x.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.tna()} was not found.`):x.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(t.a)(ib,"SheetIcon",null,[3]);var Bb=a(347),Ub=a(93),Ta=a(152);class mb extends Ub.a{constructor(Ka,ub){super(Ka.domElement);this.onKeyDown=ac=>
{121===ac.keyCode&&ac.shiftKey&&!this.Yma.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Yma.anchor),Ca.g(ac))};this.Mba=ac=>{if(!this.$.isEditMode||this.Yma.disabled)return!0;this.rename(!1,ac.tb);return!0};this.Sl=ac=>this.Yma.disabled?!0:this.showContextMenu(ac.clientPoint,ac.tb,ac.Cb);this.kfe=Ka;this.$=ub;ha.a.instance.ra(y.a.nk,Ka.domElement,this.Mba);Bb.a.instance.ra(Ka.domElement,this.Sl);this.Fc.ka("keydown",this.onKeyDown)}get Yma(){return this.kfe}dispose(){this.Yma&&(ha.a.instance.Ba(y.a.nk,
this.Yma.domElement,this.Mba),Bb.a.instance.Ba(this.Yma.domElement,this.Sl),this.kfe=null);this.$=null;super.dispose()}showContextMenu(Ka,ub,ac){this.Yma.activate(ub,r.a.rpd());ub=new rb.a(-1075099431,ub,this.$.Mc,30,null);let Ra;return!Ta.a(Ra=this.$.Ka.Lb(ub,{[n.a.p0f]:Ka,[mb.Iuj]:this.Yma.sheet,[n.a.q0f]:ac}))&&(6!==Ra.status||Ra.result)}rename(Ka,ub){this.$.xd(817296323,ub,Ka?19:0,null)}}mb.Iuj="Sheet";Object(t.a)(mb,"SheetOpsSheetClickHelper",Ub.a,[]);var Qb=a(41);class Lb extends nb{constructor(Ka,
ub,ac,Ra,na,lb,jb){super(document.createElement("li"),Ka);this.I_c=this.H_c=this.m0f=this.l0f=0;this.b3c=.5;this.oU=this.aPd=!1;this.color=this.CFc=this.DE=this.nCb=this.pO=null;this.Ofc=this.wdf=!1;this.K3b="#BEBBB8";this.$Cc=null;this.onKeyDown=Yb=>13!==Yb.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Fz=Yb=>32!==Yb.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.uN=()=>{this.disabled||(this.HR.$Qi(this),this.HR.tF||this.Qma(!0,void 0,"OnMouseOver"))};this.tN=()=>{this.disabled||
this.Qma(!1,void 0,"OnMouseOut")};this.PDb=()=>{this.HR.tF||(this.NDj(),this.sheet.X_||sa.g(this.$).YHb(this.sheet.sheetName));return!1};this.v5=()=>{this.HJe(!1);return!1};this.dd=Yb=>{if(this.disabled)return!0;const Gb=sa.g(this.$);this.sheet.active||3!==Yb.tb?this.qm?this.activateSheet(Yb.tb):r.a.rpd()&&Gb.focus():(!r.a.bMa(this.$)&&!this.Dzb||Gb.$a||Gb.vi||Gb.orb(),this.activateSheet(Yb.tb));return 3!==Yb.tb};this.onPointerDown=Yb=>{if(this.disabled)return!0;this.HJe(!0);sa.g(this.$).inRangePicker&&
x.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Gb=3===Yb.tb;if(2===Yb.tb||Gb&&this.swa)this.qm?(this.Qma(!0,!Gb,"OnPointerDown"),Gb=k.Task.delay(Gb?this.m0f:this.l0f).So(()=>!0)):Gb=this.activateSheet(Yb.tb),this.Zyb&&(this.Ofc=!0,this.HR.zrc=f.TaskExtensions.Aa(Gb,()=>{this.Ofc&&this.HR.bRi(this,Yb)},this.la,11));return!1};this.Kf=Yb=>{if(this.disabled||!this.Zyb&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;
const Gb=this.HR.tF&&!r.a.Pdf();this.Ofc=!1;this.qm&&this.Qma(2===Yb.tb,void 0,"OnPointerUp");this.HR.zrc&&(f.TaskExtensions.Aa(this.HR.zrc,()=>{this.HR.aRi(this)},this.la,11),this.HR.zrc=null);return Gb};this.zN=()=>{this.Ofc=!1;this.aPd||this.Qma(!1,void 0,"OnTouchMove");return!1};this.Nxe=new mb(this,Ka);this.qm=lb;this.tw=jb;this.Dzb=r.a.Dzb(Ka);this.Fld=u.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.tw;this.qm?(this.l0f=Ka.ya.SheetDragReorderDelayInMilliseconds,
this.m0f=Ka.ya.SheetDragReorderDelayInMillisecondsForTouch,this.H_c=18,this.I_c=20):(this.H_c=19,this.I_c=22);this.$=Ka;this.SUb=Ra;this.HR=na;this.Zyb=na.coe();this.v9g();this.r3g();this.nid=Ka.Hb.Ng("UserAction",this.name);this.Imd=!1;ba.DOMElementExtensions.ru(this.domElement,n.a.Qs,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.DE);this.Wma=new Oa.a;Ka=new Qa(this.sheet,this.qm,this.tw);this.Wma.add(new ib(this.$,Ka));this.$.ea.rKb&&(Ka=new ra(this.sheet,this.qm,
this.tw),this.Wma.add(new ib(this.$,Ka)));this.Fld||(Ka=new qb(this.sheet,this.HR.fvc,()=>this.color?Lb.jQd(this.color):!1,this.tw),this.nCb=new ib(this.$,Ka),this.Wma.add(this.nCb));this.swa=this.HR.swa;this.Geb();this.t8i();this.Xse=new ma.a(this.domElement,1);ub.insertBefore(this.domElement,ac);Z.a(this.$)&&this.Xcg(!0)}get Wbh(){return this.CFc||(this.CFc=xb.a.Zo("#F5F5F5"))}get name(){return this.pO.innerText}set name(Ka){this.pO&&(this.pO.innerText=Ka,this.Jzc(),this.Ycg())}get sheet(){return this.SUb}get anchor(){return this.$Cc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Ka){this.anchor.tabIndex=
Ka}HNh(){return ba.DOMElementExtensions.jf(this.anchor)?this.anchor:null}dispose(){if(this.oU){G.a.instance.Ba(y.a.pointerDown,this.domElement,this.onPointerDown);W.KeyInputManager.instance.Ba(y.a.Mb,this.domElement,this.onKeyDown);W.KeyInputManager.instance.Ba(y.a.lp,this.domElement,this.Fz);ha.a.instance.Ba(y.a.click,this.domElement,this.dd);G.a.instance.Ba(y.a.wV,this.domElement,this.PDb);G.a.instance.Ba(y.a.my,this.domElement,this.v5);if(this.Zyb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))G.a.instance.Ba(y.a.Mf,
this.domElement,this.Kf),this.swa&&(T.a.instance.Ba(y.a.te,this.domElement,this.Kf),T.a.instance.Ba(y.a.Xf,this.domElement,this.zN));this.oU=!1;this.K3b="#BEBBB8"}A.a.rc([this.Nxe,this.Xse]);this.pO=this.DE=this.$Cc=this.HR=this.Xse=this.Nxe=null;if(this.Wma){for(let Ka of this.Wma)Ka.dispose();this.Wma=null}this.color=this.SUb=null;super.dispose()}wW(Ka){Ka&&this.Qma(!1,!1);super.wW(Ka)}SQd(Ka){if(Ba.a.tg.AQ){this.PGe();var ub=d.GetServiceTaskFactory.Ta(this.$.da,322,323,1);f.TaskExtensions.Aa(ub,
ac=>{Ib.UISurfaces.iQ().then(Ra=>{const na=ac.result;na.Rqj(Ra);na.show(Ka);return null},Ra=>{x.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Ra}`);return null})},this.la,3)}}Kke(){if(this.sheet.active&&this.$.$q){var Ka=this.$.$q,ub=sa.g(this.$),ac=ub.Nj;if(this.sheet.Fd.mv){if(!this.nCb){var Ra=new qb(this.sheet,this.HR.fvc,()=>this.color?Lb.jQd(this.color):!1,this.tw);this.nCb=new ib(this.$,Ra);this.Wma.add(this.nCb)}ac?ub.veb(1):
Ka.classList.add(X.a.cPe);Ka=Lb.Fdd(n.a.lqf);ub=Lb.Fdd(n.a.Lvd);ac=Lb.Fdd(n.a.cqf);Ra=this.sheet.Fd.WPd;this.sheet.Fd.WPd=!1;"true"===ac&&Ra&&this.$.ea.ZPd?(Mb.a.Rw(n.a.cqf,"false",Mb.a.fV),this.$.ea.ZPd=!1,this.SQd(3)):"true"===Ka&&"true"===ub&&"true"===ac?this.$.ea.$Pd&&this.$.ea.JKb&&(this.sheet.Fd.KH?(Ka=1,Mb.a.Rw(n.a.Lvd,"false",Mb.a.fV),this.$.ea.JKb=!1):Ka=0,Mb.a.Rw(n.a.lqf,"false",Mb.a.fV),this.$.ea.$Pd=!1,this.SQd(Ka)):this.sheet.Fd.KH&&"true"===ub&&"true"===ac&&this.$.ea.JKb&&(Mb.a.Rw(n.a.Lvd,
"false",Mb.a.fV),this.$.ea.JKb=!1,this.SQd(2))}else this.PGe(),ac?ub.veb(0):Ka.classList.remove(X.a.cPe)}}PGe(){const Ka=this.$.da.za(322);Ka&&Ka.dismiss()}Geb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.W5a()?L.BGj:L.JGj;u.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.pO.parentNode.classList.add(L.Gqi):this.pO.parentNode.classList.add(L.Hqi);this.Ycg();this.Fld&&this.Kke();this.uzj();this.ddg();this.Jzc();this.Fld||this.Kke()}YQi(){this.aPd=
!0;this.Qma(!0,!0,"OnSheetReorderStarted")}XQi(){this.aPd=!1;this.Qma(!1,void 0,"OnSheetReorderEnded")}activate(Ka=0,ub=!1){this.B0b()||(this.sheet.activate(),ub&&sa.g(this.$).focus(),Ka={["InputMethod"]:eb.a[Ka],["AppMode"]:this.$.Mc,["Location"]:"canvas"},bb.b(this.$).Cd(Aa.a.Euj,Ka))}Xcg(Ka){this.K3b=Ka?"#797775":"#BEBBB8";this.b3c=Ka?-.5:.5;this.CFc=Ka?xb.a.Zo("#3B3A39"):xb.a.Zo("#F5F5F5");this.ddg()}Knj(Ka){this.Zyb=Ka}lyd(Ka){Ka.w0c();this.ewe(Ka)}ewe(Ka){Ka.z_a();this.sheet.activate()}Vyg(Ka){Ka=
new rb.a(-1876836819,Ka,this.$.Mc,30,null);return this.$.Ka.Lb(Ka,{[n.a.cPd]:this.sheet.name})}Ycg(){this.pO.parentNode.setAttribute("sheet-title",this.pO.innerText)}Jzc(){const Ka=this.mHh();this.anchor.setAttribute(n.a.Nt,Ka);this.anchor.setAttribute(n.a.oga,this.sheet.active.toString())}mHh(){const Ka=this.sheet.Fd.mv,ub=this.sheet.Fd.Glb,ac=this.sheet.ii,Ra=this.sheet.isLockPausedInSession;return Ka&&ac?String.format(F.a.instance.mb(20),this.name,ub):Ka&&Ra?String.format(F.a.instance.mb(22),this.name,
ub):Ka?String.format(F.a.instance.mb(19),this.name,ub):ac?String.format(F.a.instance.mb(18),this.name):Ra?String.format(F.a.instance.mb(21),this.name):this.name}activateSheet(Ka=0){if(r.a.rpd()){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.B0b())return k.Task.Ua(!1);Va.a.current.zR="ActivateSheet";this.sheet.activate();return k.Task.Ua(!0)}return this.Vyg(Ka)}ddg(){const Ka=this.sheet.tabColor;this.color=Ka?xb.a.Zo(Ka):this.Wbh;this.wdf=Lb.jQd(this.color);
this.Qma(!1,void 0,"UpdateTabColor")}Qma(Ka,ub=!1,ac=null){if(this.sheet){ac=this.sheet.active;var Ra=this.W5a(),na=!!this.sheet.tabColor,lb=xb.a.iG(ac||Ra?ob.a.white:this.color);this.DE.style.background="";ac||Ra?(na?u.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.uKa?this.Hsj():this.qm?this.Gsj():this.Fsj():this.qm||(this.DE.style.backgroundColor=lb),this.DE.style.height=this.H_c.toString()+"px"):(this.DE.style.filter="",this.DE.style.backgroundColor=
lb,this.DE.style.height=this.I_c.toString()+"px");this.pO.className=ac?L.CGj:Ra?L.dark:this.wdf?L.light:L.dark;for(let jb of this.Wma)jb.hcg();this.qm&&(Ka&&!na&&(this.DE.style.backgroundColor="#E1DFDD"),ba.DOMElementExtensions.toggleCssClass(this.domElement,L.IGj,Ka),ub?(na||(this.DE.style.backgroundColor=this.K3b),this.domElement.style.backgroundColor=this.K3b):(na||(this.DE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.pO.style.fontWeight=ac||Ra||!this.qm&&Ka?this.qm?
"600":"bold":""}else x.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${ac}`)}Gsj(){const Ka=this.DE.style,ub=xb.a.iG(Lb.VYc(this.color,this.b3c));Ka.background=ub}Fsj(){const Ka=this.DE.style,ub=xb.a.iG(Lb.VYc(this.color,1)),ac=xb.a.iG(Lb.VYc(this.color,this.b3c));Ka.background=`$linear-gradient(${ub}, ${ac})`}Hsj(){this.DE.style.background="transparent"}r3g(){this.$Cc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=L.DGj;ba.DOMElementExtensions.ru(this.anchor,n.a.jnb,null,null);this.tabIndex=-1}v9g(){this.DE=document.createElement("span");this.DE.className=L.GGj;this.pO=document.createElement("span");this.pO.className=L.LGj;this.pO.dir=this.sheet.rtlName?"rtl":"ltr";this.DE.appendChild(this.pO)}uzj(){const Ka=this.$.eJ;for(let ub of this.Wma)ub.tzj(Ka,this.DE,this.pO)}W5a(){return sa.g(this.$).W5a(this.sheet)}NDj(){this.nid.start();this.Imd=!0}HJe(Ka){this.Imd&&
(this.nid.stop(),x.ULS.sendTraceTag(537153686,0,50,Qb.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.nid.tc,["Has been clicked"]:Ka})),this.Imd=!1)}t8i(){G.a.instance.ra(y.a.pointerDown,this.domElement,this.onPointerDown);W.KeyInputManager.instance.ra(y.a.Mb,this.domElement,this.onKeyDown);W.KeyInputManager.instance.ra(y.a.lp,this.domElement,this.Fz);this.Fc.ka("mouseover",this.uN);this.Fc.ka("mouseout",this.tN);G.a.instance.ra(y.a.wV,this.domElement,
this.PDb);G.a.instance.ra(y.a.my,this.domElement,this.v5);if(this.Zyb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))G.a.instance.ra(y.a.Mf,this.domElement,this.Kf),this.swa&&(T.a.instance.ra(y.a.te,this.domElement,this.Kf),T.a.instance.ra(y.a.Xf,this.domElement,this.zN));ha.a.instance.ra(y.a.click,this.domElement,this.dd);this.oU=!0}B0b(){const Ka=this.$.da.za(65);return Ka&&Ka.Hja()?(Ka.Usc(),this.ewe(Ka),!0):!1}static Fdd(Ka){let ub=Mb.a.get(Ka);ub||(Mb.a.Rw(Ka,
"true",Mb.a.fV),ub=Mb.a.get(Ka));return ub}static VYc(Ka,ub){if(1<ub||-1>ub)return Ka;let ac=Ka.r,Ra=Ka.g;Ka=Ka.b;0<ub?(ac=ac*(1-ub)+255*ub,Ra=Ra*(1-ub)+255*ub,Ka=Ka*(1-ub)+255*ub):(ac*=1+ub,Ra*=1+ub,Ka*=1+ub);return ob.a.xtb(Math.round(ac),Math.round(Ra),Math.round(Ka))}static jQd(Ka){return 128>=(222*Ka.r+707*Ka.g+71*Ka.b)/1E3}}Object(t.a)(Lb,"SheetTabButton",nb,[]);class Jb extends nb{constructor(Ka,ub,ac){super(document.createElement("a"),ub);this.Hga=u.EwaSettings.ma(500)?X.a.M7c:X.a.csh;ac.pb(this.domElement,
F.a.instance.ga(718),0,this.Hga,F.a.instance.ga(718),qa.a.h0c,!0);Ka.appendChild(this.domElement);this.Fc.ka("contextmenu",Ra=>{Ca.g(Ra)})}}Object(t.a)(Jb,"WorkbookProtectionButton",nb,[]);var Ab=a(51),pb=a(46),va=a(57);class db extends R.a{constructor(Ka,ub,ac=null){super(ub);this.sheetTabActivatePreviousHidden=F.a.instance.ga(727);this.sheetTabActivateNextHidden=F.a.instance.ga(729);this.svgIconProvider=null;this.sh=[];this.zK=Array(6);this.Vvd=Array(6);this.dRa=this.kxb=this.yH=this.ivc=this.qcb=
this.kvc=this.hPd=this.Yk=null;this.isRtl=!1;this.oK=this.Wu=0;this.w5b=this.yrc=!1;this.joc=this.xma=0;this.tM=this.P2=this.p$=this.F5b=null;this.Uac=this.WC=0;this.SLb=null;this.$zb=-1;this.jY=null;this.rnc=0;this.$wc=-1;this.Tla=0;this.dta=new J;this.GJc=!1;this.zrc=this.jPd=this.iPd=this.gfe=this.TZ=null;this.u8d=!1;this.tjd=null;this.nvd=!1;this.ffe=null;this.nD=(Ra,na)=>{this.KBf(na.item)};this.dya=(Ra,na)=>{Ra=this.$.xa.oa.index;for(let lb=0,jb=this.sh.length;lb<jb;lb++){const Yb=this.jQ(lb);
if(Yb.name===na.oldName){Yb.name=na.newName;this.t_();lb===Ra&&this.F_(6);break}}};this.PBf=(Ra,na)=>{(Ra=this.X1a(na.item))&&Ra.Geb()};this.QBf=(Ra,na)=>{na.visible?(this.VQa(!1),this.MBf(na.item)):this.KBf(na.item)};this.oN=Ra=>{this.tF?(this.jY=Ra,this.nNb()):(this.jY&&(this.joc+=this.jY.clientPoint.x-Ra.clientPoint.x),this.jY=Ra,Math.abs(this.joc)>=this.fhh&&this.nNb());return!0};this.zN=Ra=>{Ra.Ca.preventDefault();return!1};this.BVf=Ra=>{this.xVf(Ra,!0)};this.AVf=Ra=>{this.xVf(Ra,!1)};this.r5=
Ra=>{if(this.tF&&(this.vz||this.Rff(Ra)))if(this.w5b=this.Obf(Ra),this.vz){let na;Ra=(na=this.jQ(this.WC+1))?na.sheet:null;this.reorderSheets(Ra,this.WC+1===this.fPd,!0)}else Ra=this.nvd?null:this.tjd,this.reorderSheets(Ra,this.nvd,!0);this.SP();return!0};this.Eh=(Ra,na)=>{na.uD&&this.RXd(na.uD);this.quc(!1);this.t_();na.oa&&(this.RXd(na.oa),this.F_(6),this.ea.vla())};this.zsf=(Ra,na)=>{this.zAc(na.item)};this.Asf=(Ra,na)=>{this.zAc(na.item)};this.Bsf=(Ra,na)=>{this.zAc(na.item)};this.RNa=(Ra,na)=>
{this.zAc(na.item)};this.Nxa=()=>{this.VZc()};this.Zc=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.VZc();this.O2c();u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(va.d(this.$)||va.e(this.$))&&(pb.PageLoadTrackingInfo.instance.TV(n.a.Sza,["sheetTabBar"]),pb.PageLoadTrackingInfo.instance.SV(n.a.Sza,["sheetTabBar"]));this.w2c();this.t_();this.VQa(!0);this.F_(6)};this.Wi=()=>{this.isVisible&&(this.t_(),this.F_(6))};this.Uf=()=>{Object(E.a)(pa,this.yH)===
fa.k(this.$.pg)&&this.w2c();for(const Ra of this.sh)Ra.Knj(!fa.k(this.$.pg))};this.OBf=(Ra,na)=>{this.Rcj(na.item,na.isUserOperation)};this.jEb=(Ra,na)=>{this.MBf(na.item)};this.onKeyDown=Ra=>{switch(Ra.keyCode){case 9:var na=this.domElement.querySelectorAll(ba.DOMElementExtensions.lr);const lb=ba.DOMElementExtensions.Ll(na);na=ba.DOMElementExtensions.iz(na);ba.DOMElementExtensions.Kma(Ra,lb,na);break;case 39:case 37:ba.DOMElementExtensions.AYf(Ra,this.domElement.querySelectorAll(ba.DOMElementExtensions.lr),
39===Ra.keyCode?!this.isRtl:this.isRtl)}x.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Ra.keyCode}`)};this.onScroll=()=>{this.Yk.scrollLeft!==this.xma&&this.lIj()};this.wN=Ra=>{if(Ra.ctrlKey||Ra.m2)return!1;this.Yk.scrollLeft+=Math.floor(30*Ra.uBa);if(this.vz&&this.tF){const na=this.$Xe("OnMouseWheel");na&&this.wTd(0<Ra.uBa,na.x+na.width/2)}return!0};this.GF=(Ra,na)=>{if(this.dta)this.G4e("PartialInteractivity",na.UL?3:0);else{this.SP(!1);this.KNd(na.UL);for(const lb of this.Ure)lb&&
lb.wW(na.UL);for(const lb of this.sh)lb&&lb.wW(na.UL)}};this.pDb=(Ra,na)=>{Ra=0;na.Zie&&(Ra=2|(na.Juj?1:0));this.G4e("ComponentRangePicker",Ra)};this.$=Ka;this.ea=this.$.ea;this.N5b=(this.vz=r.a.Pdf())&&!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.qm=u.EwaSettings.ma(500);this.tw=r.a.Eod();this.Off=this.qm&&!this.$.uz;this.vz&&(this.u8d=this.qm&&!z.a.lv);this.wBi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.vBi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
this.fhh=this.$.ya.SheetTabDragStartPixelThreshold;this.AOa=this.BOa=-1;this.T0c=!1;this.tw&&(this.svgIconProvider=ac);this.oC=new ma.a(this.domElement,3);this.qm&&this.domElement.classList.add(L.frh);this.e7g();this.E4g();this.f7g();this.i8g();this.quc(!0);this.Zc(null,null);Ka=this.$.xa;Ka.Pf(this.Eh);Ka.mTc(this.Nxa);Ka.DX(this.nD);Ka.dga(this.jEb);Ka.XEa(this.dya);Ka.gme(this.OBf);Ka.RXa(this.QBf);Ka.IEg(this.PBf);Ka.xTc(this.zsf);Ka.dme(this.Asf);Ka.eme(this.Bsf);Ka.fme(this.RNa);this.$.el(this.Zc);
this.$.GA(this.Wi);da.a(this.$).Xh(this);this.$.da.Ga(32,this);u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Ou(this.Uf);this.jvc=this.pe.Vd(this.domElement);this.jvc.ka("keydown",this.onKeyDown);ya.a(this.$).Qp()&&this.GF(null,new ua.a(!0));ya.a(this.$).Vf.U8(this.GF);sa.g(this.$).Cle(this.pDb);u.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&this.jvc.ka("mousedown",Ra=>{Ra.preventDefault()});B.a.instance.ra(y.a.hD,
this.domElement,this.wN);this.gPd=this.pe.Vd(this.Yk);this.gPd.ka("scroll",this.onScroll);this.lIj=Na.a(()=>{this.t_()},200,this.$.la,wa.a.Ouj,!0);this.$.YC(n.a.uBj);this.Off&&(this.ffe=new Pa(this.$,this.dRa.domElement));u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&pb.PageLoadTrackingInfo.instance.k6(n.a.Sza,["sheetTabBar"])}get lc(){return this.domElement}get jf(){return this.isVisible}get Zd(){return V.a.ePd}get tF(){return this.GJc}get fPd(){return this.sh.length}get fvc(){return this.gfe}get swa(){return this.u8d}get navigationButtonsDisabled(){return!!this.dta&&
this.dta.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.dta&&this.dta.operationButtonsDisabled}get Uvd(){return this.qm?this.$.eJ?[X.a.L6b,X.a.MMe,X.a.OMe,X.a.K6b,X.a.Hta,X.a.Hta]:[X.a.K6b,X.a.OMe,X.a.MMe,X.a.L6b,X.a.Hta,X.a.Hta]:this.$.eJ?[X.a.L6b,X.a.LMe,X.a.NMe,X.a.K6b,X.a.Hta,X.a.Hta]:[X.a.K6b,X.a.NMe,X.a.LMe,X.a.L6b,X.a.Hta,X.a.Hta]}get Wvd(){return this.$.eJ?[null,qa.a.wze,qa.a.uze]:[null,qa.a.uze,qa.a.wze]}get kHf(){return this.$.eJ?[null,qa.a.xze,qa.a.vze]:[null,qa.a.vze,
qa.a.xze]}get IAb(){if(this.isRtl){if(z.a.vF)return 0;if(z.a.Tf)return-1*(this.Yk.scrollWidth-this.Yk.clientWidth);if(z.a.lv)return this.Yk.scrollWidth-this.Yk.clientWidth;x.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get rIb(){if(this.isRtl){if(z.a.vF)return this.Yk.scrollWidth-this.Yk.clientWidth;if(z.a.Tf||z.a.lv)return 0;x.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Yk.scrollWidth-
this.Yk.clientWidth}get Ure(){return this.dta?[this.yH,this.kxb]:[this.yH,this.kxb,this.dRa]}get KGj(){return this.sh.concat(this.dRa)}get Huj(){return this.ffe}pb(Ka,ub,ac,Ra,na,lb,jb=!1){Ka.removeAttribute("Href");Ka.setAttribute(n.a.Kd,n.a.Ps);Ka.className=L.Tqh;Ka.title=ub;Ka.tabIndex=0;this.tw&&lb?ac=this.svgIconProvider.Aaa(lb,12,12,Ka,24,24):(ub=document.createElement("span"),ub.className=this.qm?X.a.$Xg:X.a.RA,ub.classList.add(U.a.pha),ub.tabIndex=-1,Ka.appendChild(ub),lb=document.createElement("img"),
lb.src=ab.a.gf(ac),lb.className=Ra,lb.alt=na,lb.tabIndex=-1,ub.appendChild(lb),ac=lb);jb&&Ka.classList.add(U.a.MT);return ac}dispose(){if(this.$){var Ka=this.$.xa;Ka.Ag(this.Eh);Ka.JHd(this.Nxa);Ka.h6(this.nD);Ka.gma(this.jEb);Ka.wPa(this.dya);Ka.tPf(this.OBf);Ka.uHb(this.QBf);Ka.Kaj(this.PBf);Ka.WHd(this.zsf);Ka.qPf(this.Asf);Ka.rPf(this.Bsf);Ka.sPf(this.RNa);this.$.Cl(this.Zc);this.$.AD(this.Wi);ya.a(this.$)&&ya.a(this.$).Vf.Gca(this.GF);this.dta&&sa.g(this.$).UOf(this.pDb);B.a.instance.Ba(y.a.hD,
this.domElement,this.wN)}A.a.rc(this.Vvd);this.Vvd=null;if(this.zK)for(Ka=0;Ka<this.zK.length;Ka++){const ub=ba.DOMElementExtensions.UJ(this.zK[Ka],this.domElement,!1,"a");ub&&K.a.ama(ub)}A.a.Ia(this.oC);A.a.Ia(this.jvc);A.a.Ia(this.gPd);this.gPd=this.jvc=this.kxb=this.yH=this.oC=null;this.$&&this.vz&&this.SP(!1);this.p$=null;this.cNd(null,"Dispose");this.SLb=this.tM=this.F5b=null;this.VZc();this.qcb=this.kvc=this.hPd=this.Yk=this.zK=this.$=this.ea=null;super.dispose()}gg(Ka,ub){if(!ub){x.ULS.shipAssertTag(537153760,
0,0<this.sh.length,"There is no sheet tab button.");if(!this.sh.length)return!1;Ka=null;for(const ac of this.sh)if(Ka=ac.HNh())break;if(!Ka)return x.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ba.DOMElementExtensions.setFocus(Ka)}return!ub}hh(Ka){return ba.DOMElementExtensions.uf(this.lc,Ka)}kj(){}Mj(){}reorderSheets(Ka,ub,ac){if(this.TZ&&this.TZ!==Ka){const Ra=this.TZ.index;this.Qcj(this.TZ,Ka,ub);Ka=Ka?Ka.index-1:ub?this.$.xa.count-1:0;Ra!==Ka&&(this.Zui(Ra,Ka,ac),
this.$jh(this.TZ.name,Ka))}}NZh(Ka){Ka=this.bia(Ka);return-1!==Ka&&this.Wu<=Ka&&Ka<=this.oK?this.sh[Ka].domElement:null}MSj(Ka){if(this.tw){for(var ub=0;ub<this.zK.length;ub++){const ac=this.zK[ub];if(ac&&this.svgIconProvider){const Ra=ac.parentNode;this.wOf(ac);Ra&&(this.zK[ub]=this.svgIconProvider.Aaa(Ka?this.kHf[ub]:this.Wvd[ub],12,12,Ra,24,24))}}for(ub=0;ub<this.sh.length;ub++)this.sh[ub].Xcg(Ka);this.dRa&&this.dRa.Kra&&this.Wcg(qa.a.E0h,this.dRa,Ka);this.yH&&this.yH.Kra&&this.Wcg(qa.a.g_g,this.yH,
Ka)}}Wcg(Ka,ub,ac){ub.p$a||(ub.p$a=this.svgIconProvider.Aaa(Ka,12,12,ub.Kra.parentNode,24,24));ub.p$a&&(ba.DOMElementExtensions.setVisible(ub.Kra,!ac),ba.DOMElementExtensions.setVisible(ub.p$a,ac))}bRi(Ka,ub){var ac=sa.g(this.$);const Ra=ac.inRangePicker,na=za.HelperMethods.Qn(ub);if(ac.$a&&!Ra){const lb=ac.lj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let jb=void 0;u.EwaSettings.Z5a&&(jb=[Object(ea.a)(ac.dc.textBox.wAa)]);ea.b(this.$).IAa(na.rawEvent,lb,jb);ac.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}ac=this.swa&&3===ub.tb;!(2===ub.tb&&na.button===Sys.UI.MouseButton.leftButton||ac)||Ra||this.tF||ya.a(this.$).Qp()||(ac&&Ka.YQi(),this.$zb=ub.clientPoint.x,this.jY=ub,this.jNg(Ka))}$Qi(Ka){!this.vz&&this.tF&&this.aRd(Ka.sheet,!1)}aRi(Ka){this.vz||(this.tF&&this.reorderSheets(Ka.sheet,!1,!0),this.SP());this.t_()}coe(){return this.$.isEditMode&&!fa.k(this.$.pg)}t_(){const Ka=za.HelperMethods.Cba(()=>{this.KQj();this.qm&&this.hsj();this.KNd()});x.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Ka}`)}hsj(){const Ka=this.oK===this.sh.length-1;ba.DOMElementExtensions.toggleCssClass(this.qcb,this.$.eJ?L.PMe:L.EMe,!!this.Wu);ba.DOMElementExtensions.toggleCssClass(this.qcb,this.$.eJ?L.EMe:L.PMe,!Ka)}KNd(Ka=!1){const ub=!this.Wu,ac=this.oK===this.sh.length-1;this.fZf(4,this.sheetTabActivatePreviousHidden,!ub);this.fZf(5,this.sheetTabActivateNextHidden,!ac);this.Euc(0,ub||Ka);this.Euc(1,ub||Ka);this.Euc(2,ac||Ka);this.Euc(3,
ac||Ka)}fZf(Ka,ub,ac){if(Ka=this.zK[Ka]){ba.DOMElementExtensions.setVisible(Ka,ac);var Ra=this.GZe(Ka);Ra.title="img"===Ka.nodeName?Ka.alt=0<this.sh.length&&ac?ub:"":Ka.title=0<this.sh.length&&ac?ub:"";Ra.tabIndex=ac?0:-1}}GZe(Ka){return this.tw?Ka.parentNode:Ka.parentNode.parentNode}Euc(Ka,ub){if(Ka=this.zK[Ka])Ka=this.GZe(Ka),void 0!==Ka&&null!==Ka&&(!this.sh.length||ub?(Ka.classList.add(U.a.MT),Ka.setAttribute(n.a.tra,"true")):(Ka.classList.remove(U.a.MT),Ka.setAttribute(n.a.tra,"false")))}VQa(Ka){const ub=
this.$.eJ?this.sh.length-1:0;let ac=this.a1e(this.$.eJ?0:this.sh.length-1);ac&&(ac.borderRightWidth=Ka?"1px":"0");this.Wu!==this.oK&&(ac=this.a1e(ub))&&(ac.borderRightWidth="0")}Xke(Ka,ub){this.sh||(this.sh=[]);-1===ub?this.sh.push(Ka):this.sh.splice(ub,0,Ka)}b3b(Ka,ub){let ac=-1,Ra=null;ub||(ac=this.HRh(Ka.index),-1!==ac&&(Ra=this.OJa(ac)));Ka=new Lb(this.$,this.Yk,Ra,Ka,this,this.qm,this.tw);this.Xke(Ka,ac);ba.DOMElementExtensions.setVisible(Ka.domElement,!0)}aRd(Ka,ub){var ac=this.X1a(Ka);if(ac){this.tjd=
Ka;this.nvd=ub;Ka=ac.domElement;ac=this.isRtl?Ka.offsetLeft+(this.Yk.scrollWidth-this.Yk.clientWidth-this.Yk.scrollLeft):Ka.offsetLeft-this.Yk.scrollLeft;if(!this.isRtl&&ub||this.isRtl&&!ub)ac+=Ka.offsetWidth;this.ivc.style.left=za.HelperMethods.qc(ac-4);ba.DOMElementExtensions.setVisible(this.ivc,!0)}}T6e(){ba.DOMElementExtensions.setVisible(this.ivc,!1)}F_(Ka){const ub=za.HelperMethods.Cba(()=>{switch(Ka){case 0:this.htc(0);break;case 1:this.htc(this.Wu-1);break;case 2:this.htc(this.Wu+1);break;
case 3:this.scrollIntoView(this.sh.length-1);break;case 4:this.Wu&&1<=this.sh.length&&(this.Kie(this.Wu-1),this.ALd());break;case 5:this.oK!==this.sh.length-1&&1<=this.sh.length&&(this.Kie(this.oK+1),this.ALd());break;case 6:this.ALd()}});this.N5b&&this.tF&&this.nNb();x.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Ka}, duration = ${ub}`)}Kie(Ka){(Ka=this.jQ(Ka))&&Ka.activate()}Zzh(Ka){if(0===Ka.xy){const ub=this.$.xa;let ac=0;for(let Ra=0,na=ub.count;Ra<na;Ra++){const lb=
Object(H.a)(la.a,ub.getItem(Ra));if(lb===Ka)return ac;0===lb.xy&&ac++}}return-1}Mzh(Ka){const ub=this.$.xa;for(let ac=Ka.index+1,Ra=ub.count;ac<Ra;ac++)if(Ka=Object(H.a)(la.a,ub.getItem(ac)),0===Ka.xy)return Ka;return null}bia(Ka){for(let ub=0;ub<this.sh.length;ub++){const ac=this.jQ(ub);if(!ac)x.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${ub}] is null even though index is not out of bounds!`);else if(ac.sheet===Ka)return ub}return-1}X1a(Ka){Ka=
this.bia(Ka);return this.jQ(Ka)}Zui(Ka,ub,ac){const Ra={};Ra.a=this.$.ya.UserSessionId;Ra.b=ac;Ra.c=this.w5b;Ra.d=Ka;Ra.e=ub;Ra.f=this.$.xa.count;Ab.b().Ie(2,Ra,ac)}Qcj(Ka,ub,ac){const Ra=Object(H.a)(aa.a,this.$.xa);ub?(ub=ub.index,ub=Ka.index<ub?ub-1:ub):ub=ac?Ra.count-1:0;Ra.reorderSheet(Ka,ub,!0)}EYf(Ka){sa.g(this.$).Cf.Yl(Ka)}jNg(Ka){if(!this.yrc){const ub=this.domElement.ownerDocument.body;this.vz?(G.a.instance.ra(y.a.zj,document.documentElement,this.oN),this.swa&&(T.a.instance.ra(y.a.Xf,document.documentElement,
this.oN),T.a.instance.ra(y.a.Xf,this.domElement,this.zN))):(G.a.instance.ra(y.a.zj,ub,this.oN),T.a.instance.ra(y.a.Xf,ub,this.oN));G.a.instance.ra(y.a.Mf,document.documentElement,this.r5);T.a.instance.ra(y.a.te,ub,this.r5);this.yrc=!0}this.TZ=Ka.sheet;this.w5b=!1;this.vz?(this.tM=null,this.F5b=Ka,this.p$=Ka.domElement,this.cNd(ba.DOMElementExtensions.getBoundingClientRect(this.p$),"BeginSheetTabButtonDrag")):(x.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(L.DMe),this.domElement.style.cursor="",this.EYf("pointer"))}SP(Ka=!0){if(this.yrc){this.EYf(n.a.kQ);const ub=this.domElement.ownerDocument.body;this.vz?(G.a.instance.Ba(y.a.zj,document.documentElement,this.oN),this.swa&&(T.a.instance.Ba(y.a.Xf,document.documentElement,this.oN),T.a.instance.Ba(y.a.Xf,this.domElement,this.zN))):(G.a.instance.Ba(y.a.zj,ub,this.oN),T.a.instance.Ba(y.a.Xf,ub,this.oN));G.a.instance.Ba(y.a.Mf,document.documentElement,this.r5);T.a.instance.Ba(y.a.te,
ub,this.r5);this.GJc=this.yrc=!1}this.joc=0;this.w5b=!1;this.tjd=this.TZ=null;this.vz?(this.p$&&(this.p$.style.visibility="visible",this.p$=null),this.F5b=null,this.cNd(null,"EndSheetTabButtonDrag"),this.tM&&(this.tM.parentNode&&this.tM.parentNode.removeChild(this.tM),this.tM=null),this.afj(Ka)):(this.domElement.classList.remove(L.DMe),this.T6e())}afj(Ka){this.LSd(Ka);this.WC=this.$zb=-1}$jh(Ka,ub){var ac=this.$.pa;const Ra=ac?ac.va:null;ac=()=>new $a(Ka,ub);const na=(lb,jb,Yb)=>cc(Ra,Ka,ub,lb,jb,
Yb,null);u.EwaSettings.fc()?this.$.userOperationManager.Ub(new ka.a(557,0,na,64,ac),null):this.$.userOperationManager.Ub(new S.a(557,0,na,void 0,ac),null)}jQ(Ka){return 0<=Ka&&Ka<this.sh.length?this.sh[Ka]:null}$0e(Ka){return(Ka=this.jQ(Ka))?Ka.sheet:null}OJa(Ka){return(Ka=this.jQ(Ka))?Ka.domElement:null}a1e(Ka){return(Ka=this.OJa(Ka))?Ka.style:null}HRh(Ka){const ub=this.$.xa;Ka+=1;let ac=-1;const Ra=this.sh?this.sh.length:0;for(;Ka<ub.count;){const na=Object(H.a)(la.a,ub.getItem(Ka));if(0===na.xy){for(ac=
0;ac<Ra&&this.$0e(ac)!==na;ac++);break}Ka++}return-1===ac||ac===Ra?-1:ac}KBf(Ka){var ub=this.X1a(Ka);ub&&(this.vz&&this.tF&&(x.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.SP()),this.Yk.removeChild(ub.domElement),ub=Array.indexOf(this.sh,ub),this.sh.splice(ub,1),this.t_(),(!this.isRtl&&ub===this.sh.length||
this.isRtl&&!ub)&&this.VQa(!0),this.N5b&&this.tF?Ka===this.TZ?(this.SP(),this.F_(6)):this.nNb():this.F_(6))}MBf(Ka){const ub=Object(H.a)(la.a,Ka);this.vz&&this.tF&&(x.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.SP());if(0===ub.xy){this.VQa(!1);var ac=this.bia(Ka);-1===ac&&
(x.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.b3b(ub,!1),ac=this.bia(Ka));this.P4e(ac,!0)}}Rcj(Ka,ub){const ac=this.X1a(Ka);ac&&(this.vz&&this.tF&&!ub&&(x.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.SP()),Ka=this.xGj(Ka,ac),!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.vz&&Ka&&ub&&Ka.XQi())}xGj(Ka,ub){var ac=Array.indexOf(this.sh,ub);const Ra=this.Zzh(Object(H.a)(la.a,Ka));if(-1===Ra||-1===ac)return null;ac!==Ra||this.vz?(this.VQa(!1),{yAh:this.Wu,Gpi:this.oK}=db.Ncj(ac,Ra,this.Wu,this.oK),ub&&ub.domElement.parentNode===this.Yk&&(this.Yk.removeChild(ub.domElement),this.sh.splice(ac,1)),ub=this.Mzh(Ka),ac=this.bia(ub),ub=new Lb(this.$,
this.Yk,this.OJa(ac),Object(H.a)(la.a,Ka),this,this.qm,this.tw),this.Xke(ub,ac),ac=this.bia(Ka),this.P4e(ac,!1,!this.qm)):ub=null;return ub}Lkh(){const Ka=this.sh?this.sh.length:0,ub=this.Wu,ac=this.oK;for(let Ra=0;Ra<Ka;Ra++){const na=this.jQ(Ra),lb=Ra>=ub;na&&(na.tabIndex=lb&&Ra<=ac?0:-1)}}vPj(){const Ka=this.sh?this.sh.length:0;for(let ub=0;ub<Ka;ub++){const ac=this.jQ(ub);ac&&ac.Geb()}}P4e(Ka,ub,ac=!0){ub&&Ka<=this.Wu&&this.Wu++;this.Lkh();this.VQa(!0);this.t_();this.N5b&&this.tF?this.nNb():ac&&
this.F_(6)}quc(Ka){const ub=this.$.eJ;if(Ka||this.isRtl!==ub)this.isRtl=ub,this.domElement.classList.remove(this.isRtl?X.a.KMe:X.a.QMe),this.domElement.classList.add(this.isRtl?X.a.QMe:X.a.KMe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.vPj();Ka||this.VQa(!0);for(Ka=0;Ka<this.zK.length;Ka++)0!==Ka&&3!==Ka&&(!this.qm||4!==Ka&&5!==Ka)&&this.gZf(Ka)}e7g(){const Ka=this.hPd=document.createElement("div");Ka.className=L.Qqh;this.qm&&Ka.classList.add(L.Rqh);this.domElement.appendChild(Ka);this.W2b(Ka,
1,722,721);this.W2b(Ka,2,724,723);this.Off&&(this.dRa=new Ob(this.$,this,Ka));this.qm||this.W2b(Ka,4,728,727)}f7g(){const Ka=this.kvc=document.createElement("div");Ka.className=L.Sqh;this.domElement.appendChild(Ka);this.qm||this.W2b(Ka,5,730,729);this.w2c()}i8g(){var Ka=document.getElementById(n.a.Fuj),ub=document.getElementById(n.a.Guj);Ka&&!ub&&x.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Ka.parentNode.id}. progressBar div has child: ${!!Ka.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.YOd)}`);
if(r.a.Vff(this.$)&&Ka&&ub)this.domElement.appendChild(Ka),this.iPd=Ka.firstChild,this.jPd=document.getElementById(n.a.YOd),ub.style.visibility="visible";else{Ka=document.createElement("div");ub=document.createElement("div");Ka.className=X.a.arh;ub.className=X.a.Zqh;ub.style.display="none";const ac=document.createElement("div");ac.className=X.a.brh;const Ra=document.createElement("div");Ra.className=X.a.$qh;const na=document.createElement("div");na.className=X.a.Yqh;ub.appendChild(ac);ub.appendChild(Ra);
ub.appendChild(na);Ka.appendChild(ub);this.domElement.appendChild(Ka);this.iPd=ub;this.jPd=Ra}}gZf(Ka){var ub=this.zK[Ka];if(ub)if(this.tw){const ac=ub.parentNode;this.wOf(ub);ub=Z.a(this.$)?this.kHf[Ka]:this.Wvd[Ka];this.zK[Ka]=this.svgIconProvider.Aaa(ub,12,12,ac,24,24)}else ub.className=this.Uvd[Ka]}wOf(Ka){(null===Ka||void 0===Ka?0:Ka.parentNode)&&Ka.parentNode.removeChild(Ka)}E4g(){const Ka=this.qcb=document.createElement("div");Ka.className=L.Nqh;this.domElement.appendChild(Ka);this.m9g(Ka)}m9g(Ka){const ub=
document.createElement("div");ub.className=L.drh;ub.classList.add(L.Oqh);this.$.printingEnabled||ub.classList.add(M.a.XOe);Ka.appendChild(ub);this.Yk=document.createElement("ul");ba.DOMElementExtensions.ru(this.Yk,n.a.rVc,null,null);this.Yk.className=M.a.RMe;ub.appendChild(this.Yk);this.Y6g();this.gfe=document.createElement("div");this.fvc.id="SheetIconTooltipContainer";ub.appendChild(this.fvc)}Y6g(){const Ka=document.createElement("div"),ub="<div class='"+X.a.dYg+"'>{0}</div>",ac=ab.a.Cbd(X.a.bsh,
0,"55_16_N","");Ka.innerHTML=String.format(ub,ac);Ka.className=L.crh;ba.DOMElementExtensions.setVisible(Ka,!1);this.ivc=Ka;this.Yk.appendChild(Ka)}O2c(){const Ka=this.$.xa;for(let ub=0,ac=Ka.count;ub<ac;ub++){const Ra=Object(H.a)(la.a,Ka.getItem(ub));0===Ra.xy&&(this.b3b(Ra,!0),Ra.active&&Ra.activate())}}VZc(){A.a.rc(this.sh);this.sh=[];this.oK=this.Wu=0}W2b(Ka,ub,ac,Ra){const na=document.createElement("a");Ka.appendChild(na);Ka=this.Wvd[ub];this.zK[ub]=this.pb(na,F.a.instance.ga(Ra),0,this.Uvd[ub],
F.a.instance.ga(ac),Ka);if(5===ub||4===ub)ba.DOMElementExtensions.UJ(this.zK[ub],na,!1,"span").style.marginTop="10px";this.gZf(ub);ac=this.Vvd[ub]=this.pe.Vd(na);G.a.instance.ra(y.a.pointerDown,na,jb=>jb.ctrlKey&&this.JHi(ub)?!0:this.Ryf(ub));G.a.instance.ra(y.a.Mf,na,()=>this.Syf());T.a.instance.ra(y.a.te,na,()=>this.Syf());G.a.instance.ra(y.a.pointerOut,na,()=>this.NZc());W.KeyInputManager.instance.ra(y.a.Mb,na,jb=>13!==jb.Ca.keyCode&&32!==jb.Ca.keyCode||this.T0c?!1:(this.T0c=!0,this.Ryf(ub)));
W.KeyInputManager.instance.ra(y.a.Gd,na,jb=>13===jb.Ca.keyCode||32===jb.Ca.keyCode?(this.T0c=!1,this.NZc()):!1);const lb=this.coe();Ra=jb=>{"mouseup"===jb.type&&this.vz&&this.tF||Ca.g(jb);na.classList.contains(U.a.MT)||(lb?this.MNi(jb,ub):this.qm||this.Tyf(jb,ub))};ac.ka("mouseover",Ra);ac.ka("mouseout",Ra);ac.ka("focus",Ra);ac.ka("blur",Ra);lb&&ac.ka("mouseup",Ra)}Obf(Ka){let ub=!1;const ac=this.$.Bf;ac&&(ub=P.a.WM(ba.DOMElementExtensions.getBoundingClientRect(ac),Ka.clientPoint));return ub}Rff(Ka){return P.a.WM(ba.DOMElementExtensions.getBoundingClientRect(this.domElement),
Ka.clientPoint)||this.Obf(Ka)}Vzh(Ka){let ub=null;const ac=Ka.clientPoint;let Ra=this.Wu;if(this.Rff(Ka))for(Ra=this.Wu;Ra<=this.oK;Ra++)if(ub=this.jQ(Ra))if(Ka=ba.DOMElementExtensions.getBoundingClientRect(ub.domElement),!this.isRtl&&ac.x<Ka.x+Ka.width||this.isRtl&&ac.x>Ka.x)break;return{returnValue:ub,iyj:Ra>this.oK}}nNb(){if(this.vz){if(!this.tM){x.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.tM=this.p$.cloneNode(!0);
if(!this.$Tf(this.tM,this.p$,!0,"UpdateDragAndDropState"))return;this.p$.style.visibility="hidden";this.tM.classList.add(L.erh);this.tM.style.borderRightWidth="";this.Uac=this.jY.clientPoint.x-this.P2.width/2;this.tM.style.left=this.Uac+"px";this.WC=this.bia(this.TZ);0>this.WC&&x.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.N5b&&(this.WC=this.bia(this.TZ));var Ka=ba.DOMElementExtensions.getBoundingClientRect(this.Yk),ub=Ka.x;Ka=Ka.x+Ka.width;let ac=
this.jY.clientPoint.x-this.P2.width/2;ac=Math.min(ac,Ka-this.P2.width);ac=Math.max(ac,ub);this.tM.style.transform="translateX("+Math.abs(ac-this.Uac)*(this.Uac<ac?1:-1)+"px)";const Ra=this.jY.clientPoint.x>this.$zb;let na=this.jY.clientPoint.x;ac>=Ka-this.P2.width?(na=Ka-this.P2.width/2,this.xLd()||this.Tla||(x.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.rnc=this.Yk.scrollLeft,this.Tla=window.requestAnimationFrame(this.BVf))):
ac<=ub?(na=ub+this.P2.width/2,this.wLd()||this.Tla||(x.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.rnc=this.Yk.scrollLeft,this.Tla=window.requestAnimationFrame(this.AVf))):this.Tla&&(x.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.LSd());this.jY.clientPoint.x!==this.$zb&&(this.wTd(Ra,na),this.$zb=this.jY.clientPoint.x)}else(Ka=
({iyj:ub}=this.Vzh(this.jY)).returnValue)?this.aRd(Ka.sheet,ub):this.T6e();this.GJc=!0}wTd(Ka,ub){let ac;for(;({b0b:ac}=this.ghh(ub,Ka)).returnValue;)this.SLb=ac,this.HIg(Ka)}HIg(Ka){if(this.SLb){var ub=(Ka?1:-1)*this.P2.width;if(Ka&&!this.$.eJ||!Ka&&this.$.eJ){var ac=this.p$;var Ra=this.WC+1;var na=!0}else ac=(Ra=this.jQ(this.WC+1))?Ra.domElement:null,Ra=this.WC-1,na=!1;if(this.$Tf(this.SLb,ac,na,"AnimateSheetSwap")){x.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.WC} and other sheet-index ${Ra}. amount of sheets in the bar: ${this.fPd} isMovingRight: ${Ka}`);
0<=this.WC&&this.WC<this.sh.length&&0<=Ra&&Ra<this.sh.length?(Ka=this.sh[Ra],this.sh[Ra]=this.sh[this.WC],this.sh[this.WC]=Ka):(x.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.sh.length}, ghostIndex: ${this.WC}, swappedSheetIndex: ${Ra}`),this.SP());this.WC=Ra;var lb=this.SLb;lb.style.transform="translateX("+ub+"px)";window.requestAnimationFrame(()=>{lb.style.transform="translateX(0px)"})}}}$Tf(Ka,ub,ac,Ra){const na=lb=>lb?`Node ID: ${lb.id} , Node class: ${lb.className}, Node name: ${lb.nodeName},`:
null;try{return this.Yk.insertBefore(Ka,ub),!0}catch(lb){return Ka=this.X1a(this.TZ),x.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Ka?Ka!==this.F5b?"Changed":"NoChange":"Removed",Ra,na(ub),
na(ub.parentNode),na(this.Yk),ac,this.WC,this.fPd,lb),this.SP(),!1}}ghh(Ka,ub){var ac=this.$.eJ===ub?this.jQ(this.WC-1):this.jQ(this.WC+1);if(!ac)return{returnValue:!1,b0b:null};ac=ac.domElement;const Ra=ba.DOMElementExtensions.getBoundingClientRect(ac);return this.P2?ub?{returnValue:Ka+this.P2.width/2>=Ra.x+.5*Ra.width,b0b:ac}:{returnValue:Ka-this.P2.width/2<=Ra.x+.5*Ra.width,b0b:ac}:(x.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.SP(),{returnValue:!1,b0b:ac})}xVf(Ka,ub){let ac;ac=ub?this.BVf:this.AVf;if(-1===this.$wc)this.$wc=Ka,this.Tla=window.requestAnimationFrame(ac);else{Ka=Math.floor((Ka-this.$wc)/1E3*300);var Ra=this.rIb>this.IAb?1:-1;this.scrollLeft(Math.abs(this.Yk.scrollLeft-(ub?this.rnc+Ka*Ra:this.rnc-Ka*Ra))*(ub?-1:1));if(Ka=this.$Xe("ScrollStep"))this.wTd(ub,Ka.x+Ka.width/2),ub&&!this.xLd()||!ub&&!this.wLd()?this.Tla=window.requestAnimationFrame(ac):(x.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.LSd())}}xLd(){const Ka=this.rIb>this.IAb;return Ka&&this.xma>=this.rIb||!Ka&&this.xma<=this.rIb}wLd(){const Ka=this.rIb>this.IAb;return Ka&&this.xma<=this.IAb||!Ka&&this.xma>=this.IAb}LSd(Ka=!0){this.Yk&&(this.xma=this.Yk.scrollLeft);window.cancelAnimationFrame(this.Tla);this.Tla=0;this.$wc=-1;Ka&&this.t_()}cNd(Ka,ub){Ka||x.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${ub}`);this.P2=Ka}JHi(Ka){return 2===Ka?(this.F_(3),
!0):1===Ka?(this.F_(0),!0):!1}Ryf(Ka){x.ULS.shipAssertTag(537153732,0,-1===this.BOa&&-1===this.AOa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.BOa&&(window.clearTimeout(this.BOa),this.BOa=-1);-1!==this.AOa&&(window.clearInterval(this.AOa),this.AOa=-1);this.F_(Ka);this.BOa=window.setTimeout(()=>{this.cEj(Ka)},this.wBi);return!0}cEj(Ka){this.AOa=window.setInterval(()=>{this.F_(Ka)},this.vBi)}Syf(){this.NZc();
return!this.vz||!this.tF}NZc(){window.clearTimeout(this.BOa);window.clearInterval(this.AOa);this.AOa=this.BOa=-1;return!0}Tyf(Ka,ub){const ac=this.Uvd[ub];za.HelperMethods.MUd(this.zK[ub],ac,ac+n.a.xcc,"mouseover"===Ka.type||"focus"===Ka.type)}MNi(Ka,ub){const ac=this.Vec(ub),Ra=5===ub;if("mouseup"===Ka.type){if(Ra||4===ub)ac||this.reorderSheets(null,Ra,!1),this.SP()}else!this.vz&&this.tF?(ac||this.aRd(this.$0e(Ra?this.oK:this.Wu),Ra),this.F_(Ra?2:1)):this.qm||this.Tyf(Ka,ub)}Vec(Ka){return!!ba.DOMElementExtensions.ycd(this.zK[Ka],
"a").title}zAc(Ka){this.RXd(Ka);this.t_()}RXd(Ka){(Ka=this.X1a(Ka))&&Ka.Geb()}ALd(){var Ka=this.$.xa;if(Ka.oa&&(!va.e(this.$)||Ka.count))if(Ka=this.bia(Ka.oa),-1===Ka)x.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ub=this.OJa(Ka);Ka<this.Wu?this.htc(Ka):Ka>this.Wu&&!this.spd(ub)&&this.scrollIntoView(Ka)}}KQj(){this.Wu=0;this.oK=this.sh.length-1;let Ka=!1;for(let ub=0;ub<this.sh.length;ub++){const ac=this.jQ(ub);if(!ac)break;
const Ra=this.spd(ac.domElement);ac.tabIndex=Ra?0:-1;if(!Ka&&Ra)this.Wu=ub,Ka=!0;else if(Ka&&!Ra){this.oK=ub-1;break}}}htc(Ka){this.$.xa.count&&(this.sh.length||this.O2c(),this.pXf(this.OJa(Math.max(0,Math.min(Ka,this.sh.length-1)))),this.t_())}scrollIntoView(Ka){x.ULS.shipAssertTag(537153697,0,Ka>=this.Wu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.sh.length||this.O2c();var ub=this.OJa(Math.max(0,Math.min(Ka,
this.sh.length-1))),ac=this.OJa(this.Wu);if(!this.spd(ub)){ub=ba.DOMElementExtensions.getBoundingClientRect(ub);var Ra=ba.DOMElementExtensions.getBoundingClientRect(this.qcb);ub=this.isRtl?Ra.x-ub.x:ub.x+ub.width-(Ra.x+Ra.width);for(Ra=0;ac&&Ra<ub;){const na=ba.DOMElementExtensions.getBoundingClientRect(ac);Ra+=na.width;ac=ac.nextSibling}ac?this.pXf(ac):x.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.Wu}, lastVisibleSheetTabIndex = ${this.oK}, scroll to index: ${Ka}`)}this.t_()}}pXf(Ka){const ub=
ba.DOMElementExtensions.getBoundingClientRect(this.Yk);Ka=ba.DOMElementExtensions.getBoundingClientRect(Ka);this.isRtl?this.scrollLeft(Math.floor(ub.x+ub.width-(Ka.x+Ka.width+.5))):this.scrollLeft(Math.ceil(ub.x-Ka.x-.5))}scrollLeft(Ka){(0>Ka&&this.xLd()||0<Ka&&this.wLd())&&x.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const ub=this.Yk.scrollLeft;if(this.isRtl){if(z.a.vF||z.a.Tf){this.Yk.scrollLeft=this.xma=ub-Ka;
return}if(z.a.FH){this.Yk.scrollLeft=this.xma=ub+Ka;return}x.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Yk.scrollLeft=this.xma=ub-Ka}spd(Ka){Ka=ba.DOMElementExtensions.getBoundingClientRect(Ka);const ub=ba.DOMElementExtensions.getBoundingClientRect(this.qcb);return Ka&&ub?Ka.x>=ub.x-1&&Ka.x+Ka.width<=ub.x+ub.width+1:(x.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}z7g(){const Ka=
this.kvc;if(pa.M0f(this.$))this.qm?(A.a.Ia(this.yH),this.yH=new pa(Ka,this.$,this,!0)):(A.a.Ia(this.yH),this.yH=null);else if(!this.yH||this.qm)A.a.Ia(this.yH),fa.k(this.$.pg)?this.yH=new Jb(Ka,this.$,this):this.yH=new pa(Ka,this.$,this)}UCe(Ka,ub){var ac=this.$.xa;if(!this.$.isEditMode||!ac.count)A.a.Ia(ub),ub=null;else if(!ub)if(ac=this.qm?this.hPd:this.kvc,fa.k(this.$.pg))ub=new Jb(ac,this.$,this);else switch(Ka){case 0:ub=new pa(ac,this.$,this);break;case 1:ub=new Ja(ac,this.$,this);break;default:x.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ub}w2c(){u.EwaSettings.ma(424)?(this.yH=this.UCe(0,this.yH),this.kxb=this.UCe(1,this.kxb)):this.z7g()}$Xe(Ka){const ub=ba.DOMElementExtensions.getBoundingClientRect(this.tM);ub||(x.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Ka}: GetBoundingClientRect returned null for the dragged sheet.`),
this.SP());return ub}G4e(Ka,ub){this.dta.NJg(Ka,ub);this.SP(!1);this.KNd(this.navigationButtonsDisabled);for(const ac of this.KGj)ac&&ac.wW(this.navigationButtonsDisabled);for(const ac of this.Ure)ac&&ac.wW(this.operationButtonsDisabled)}static Ncj(Ka,ub,ac,Ra){Ka<ac?(ub>ac&&ac--,ub>Ra&&Ra--):Ka>Ra?(ub<ac&&ac++,ub<Ra&&Ra++):ub<ac&&ac++;return{yAh:ac,Gpi:Ra}}}Object(t.a)(db,"SheetTabBarControl",R.a,[614,3,110]);class Ya extends v.a{constructor(Ka){super();this.$=Ka;this.Fb()}create(){const Ka=this.$.Bb;
if(w.a(this.$.ya,1))pb.PageLoadTrackingInfo.instance.Jca(n.a.Sza,["sheetTabBar"]);else{var ub=document.getElementById(Ka+n.a.U3c);ub?(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&pb.PageLoadTrackingInfo.instance.Gza(n.a.Sza),r.a.Eod()?f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,388,387,this.ib),ac=>{this.qb(this.$.da.za(32)||new db(this.$,ub,ac.result))},this.$.la,3):this.qb(this.$.da.za(32)||new db(this.$,ub))):pb.PageLoadTrackingInfo.instance.Jca(n.a.Sza,
["sheetTabBar"])}}static ka(Ka){Ka.da.Ga(33,new Ya(Ka))}}Object(t.a)(Ya,"SheetTabBarFactory",v.a,[]);a.d(D,"a",function(){return gb});const gb=()=>{c.a.Fa(Ka=>{Ya.ka(Ka);m.ka(Ka)})}},1142:function(t,D,a){var c=a(10);t=a(0);var b=a(690),d=a(50),f=a(37),e=a(15),k=a(4),l=a(30),m=a(5),v=a(24),n=a(77),w=a(58);class r{constructor(rb,Pa){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=rb;this.sortType=Pa}yU(){return this.autoFilterOptions}}Object(t.a)(r,"MacroRecorderRangeColumnSortedOrFilteredPayload",
null,[116]);class u{constructor(rb){this.autoFilterOptions=null;this.autoFilterOptions=rb}yU(){return this.autoFilterOptions}}Object(t.a)(u,"MacroRecorderRangeItemFilteredPayload",null,[116]);var x=a(923),z=a(42),B=a(368),y=a(170),A=a(62),K=a(162),G=a(239),T=a(47),W=a(45),P=a(12),E=a(281),H=a(1),F=a(181),N=a(22),J=a(280),R=a(21);class M{constructor(rb,Pa){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=rb;this.tableRange=z.l(rb.Ranges[0],rb.SheetName);this.styleIndex=Pa}}
Object(t.a)(M,"MacroRecorderTableStyleAppliedPayload",null,[116]);class L extends M{constructor(rb,Pa,eb,Ob){super(rb,eb);this.isCreation=this.hasHeaders=!1;this.hasHeaders=Pa;this.isCreation=Ob}}Object(t.a)(L,"MacroRecorderRangeFormatedAsTablePayload",M,[]);class U{constructor(rb,Pa,eb){this.description=this.title=this.tableRange=null;this.tableRange=rb;this.title=Pa;this.description=eb}Fm(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(t.a)(U,
"MacroRecorderTableAltTextEditedPayload",null,[116]);class X{constructor(rb,Pa){this.newName=this.oldName=null;this.oldName=rb;this.newName=Pa}}Object(t.a)(X,"MacroRecorderTableRenamedPayload",null,[116]);class da{constructor(rb){this.originalRange=null;this.originalRange=rb}}Object(t.a)(da,"MacroRecorderTableResizedPayload",null,[116]);class fa{constructor(rb,Pa,eb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=rb;this.optionType=Pa;this.isPivotTable=eb}}Object(t.a)(fa,
"MacroRecorderTableStyleOptionToggledPayload",null,[116]);class S{constructor(rb,Pa){this.tableRange=null;this.templateId=-1;this.tableRange=rb;this.templateId=Pa}Fm(){return this.tableRange}}Object(t.a)(S,"MacroRecorderSampleTableCreatedPayload",null,[116]);var ka=a(31),V=a(43);class wa{constructor(rb){this.tableName=null;this.tableName=rb}}Object(t.a)(wa,"MacroRecorderTableConvertedToRangePayload",null,[116]);var ma=a(740);class ab{constructor(rb,Pa,eb){this.hod=!1;this.sharedSheetRange=Pa;this.$=
rb;this.Yh=this.$.Hb.Ng("UserAction","ConvertToRangeManager");this.tableName=eb}b$a(){this.Yh.start();const rb=this.$.pa.va.Qb();return ma.i(this.$.pa.va,this.sharedSheetRange,Pa=>{this.showDialog(Pa)},null,null,null,rb)}showDialog(rb){e.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.Yh.tc} milliseconds`);rb&&!E.a(rb)&&((this.hod=rb.Result)?(rb=ka.a.Yc(3,2,0,743,0,-66108047,"ConvertToRange"),f.TaskExtensions.Aa(V.a(this.$).nj(rb),
Pa=>{e.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.Yh.tc} milliseconds`);0===Pa.result&&this.w2g()},this.$.la,11)):this.x2g());this.Yh.stop();e.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.Yh.tc} milliseconds`)}gte(){const rb={};rb.IsQueryTable=this.hod;rb.Range=this.sharedSheetRange;return rb}w2g(){const rb=this.$.pa.va;e.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");
this.R$e(194,(Pa,eb,Ob)=>ma.d(rb,this.gte(),Pa,eb,Ob,null));e.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}x2g(){const rb=this.$.pa.va;e.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.R$e(193,(Pa,eb,Ob)=>ma.c(rb,this.gte(),Pa,eb,Ob,null),()=>new wa(this.tableName));e.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}R$e(rb,Pa,eb=null){B.a(this.$.userOperationManager,Pa,Ob=>new y.a(rb,0,Ob,void 0,eb),
null)}}Object(t.a)(ab,"ConvertToRangeManager",null,[]);var ba=a(1121),Ca=a(1120),Na=a(1253),za=a(14);class la extends Na.a{constructor(rb,Pa){super(rb,za.a.instance.ga(737));this.sAa=Pa}get oc(){return"FormatAsTableDialog"}get Hv(){return 215}hj(){const rb=z.s(this.DC.TableRange);return()=>new L(rb,this.i4a.checked,this.sAa,!0)}Ry(){const rb=z.s(this.DC.TableRange);return(Pa,eb,Ob)=>ma.h(this.$.pa.va,rb,this.i4a.checked,!1,this.DC.HasTotalRow,this.sAa,Pa,eb,Ob,null)}fy(rb,Pa,eb){super.fy(rb,Pa,eb)}}
Object(t.a)(la,"FormatAsTableDialogDeprecated",Na.a,[]);Na=a(944);class aa extends Na.a{constructor(rb,Pa){super(rb);this.sAa=Pa}get oc(){return"FormatAsTableDialog"}get Hv(){return 215}get Il(){return za.a.instance.ga(737)}hj(){const rb=z.s(this.DC.TableRange);return()=>new L(rb,this.hasHeaders,this.sAa,!0)}Ry(){const rb=z.s(this.DC.TableRange),Pa=this.DC.HasTotalRow;return(eb,Ob,tb)=>ma.h(this.$.pa.va,rb,this.hasHeaders,!1,Pa,this.sAa,eb,Ob,tb,null)}}Object(t.a)(aa,"FormatAsTableReactDialog",Na.a,
[]);Na=a(282);var sa=a(96);class ea extends Na.a{constructor(rb){super(rb);this.ZGj=(Pa,eb)=>{1===Pa&&this.JLj(z.D(this.UEf(eb[ea.qKf])))};this.Dub=Pa=>{Pa=this.kdd(Pa);return this.Had(Pa)};this.gridView=R.g(rb);this.sa=this.gridView.ha.sa;this.snc=this.gridView.Db.Xj(this.sa.activeCell).usedRange;rb=this.IM(this.snc.toString());this.initializeAndShow(za.a.instance.ga(738),this.ZGj,rb)}get oc(){return"ResizeTableDialog"}UEf(rb){rb=rb.startsWith("=")?rb.substring(1,rb.length):rb;if(({sheetName:rb,
range:Pa}=z.Z(rb,this.$.xa)).returnValue&&Pa){var Pa=z.v(Pa,this.$);Pa.SheetName=N.a.equals(rb,"",!0)?this.$.oa.name:rb;return Pa}return null}IM(rb){return{[ea.P3]:"ResizeTableDialog",[ea.qKf]:rb,["getInputErrorIfInvalid"]:this.Dub}}kdd(rb){rb=this.UEf(rb);if(!rb)return 1;const Pa=z.D(rb);return N.a.equals(rb.SheetName,this.$.oa.sheetName,!0)&&this.snc.top===Pa.top&&this.snc.Ed(Pa)?0:2}Had(rb){let Pa="";switch(rb){case 1:Pa=za.a.instance.ga(75);break;case 2:Pa=sa.a.zh(za.a.instance.ga(74))}return Pa}JLj(rb){this.$.xd(-1400250766,
n.a.Eb,8,{["ResizeTableRange"]:rb,["OriginalTableRange"]:this.snc})}}ea.P3="id";ea.qKf="range";Object(t.a)(ea,"ResizeTableDialog",Na.a,[]);class Z extends Na.a{constructor(rb){super(rb);rb=R.g(this.$);rb=rb.Db.Xj(rb.ha.sa.activeCell);N.a.kh(rb.kSa)?this.ZAd="":this.ZAd=rb.kSa;N.a.kh(rb.lSa)?this.XAd="":this.XAd=rb.lSa;rb=this.IM(this.ZAd,this.XAd);this.initializeAndShow(za.a.instance.ga(747),this.PGj,rb)}get oc(){return"TableAltTextDialog"}PGj(rb,Pa){1===rb&&(rb=Pa[Z.rJj],Pa=Pa[Z.Tch],rb===this.ZAd&&
Pa===this.XAd||this.$.xd(868579142,n.a.Eb,8,{["Title"]:rb,["Description"]:Pa}))}IM(rb,Pa){return{["id"]:"AltTextDialog",["title"]:rb,["description"]:Pa}}}Z.P3="id";Z.rJj="title";Z.Tch="description";Object(t.a)(Z,"TableAltTextDialog",Na.a,[]);var ua=a(767),ya=a(768),ha=a(111),Da=a(68),nb=a(55),qa=a(36);class pa{constructor(rb,Pa,eb,Ob){this.menuId=null;this.sQa=-1;this.uCf=()=>{this.yca()};this.tSi=tb=>{if(!(this.sa.YKa()||(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
E.a(tb)||this.oLa())&&E.a(tb)&&this.oLa())){tb=this.sa.activeCell;var cc=this.sa.activeRange;const Ib=this.tableManager.Jg.usedRange;2===this.sQa&&K.g(this.tableManager.Jg)&&tb.bottom===Ib.bottom&&(cc=cc.x4?new v.Range(cc.top-1,cc.left,cc.bottom-1,cc.right,!1,!0):new v.Range(cc.top,cc.left,cc.bottom-1,cc.right,!1,!0),tb=cc.contains(tb)?tb:v.Range.Tc(cc.bottom,tb.left),R.g(this.$).ha.updateSelection(cc,tb,0,3))}};this.LRi=tb=>{E.a(tb)?(e.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.pf()):e.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.KRi=()=>{e.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.pf()};this.MRi=(tb,cc)=>{cc&&this.sL(cc);E.b(tb,-569193796)&&(Da.a(this.$).fd.fJ(-569193796),this.vqi(tb.Errors[0]))};this.$=rb;this.tableManager=Pa;this.namedSheetViewPublic=eb;this.frame=this.$.frame;this.ha=R.g(this.$).ha;this.sa=this.ha.sa;this.Xx=H.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.tableStyleManager=Ob;this.tableStyleManager.WFg(this.uCf)}Qc(rb,Pa){switch(Pa){case -544558380:return!(this.tableManager&&this.sa.AH()&&!this.oLa()&&K.d(this.tableManager.Jg));case 1544516694:return!(this.tableManager&&(this.sa.AH()?!this.oLa():this.sa.YKa()));case -697806646:case 323142015:return!this.sa.AH();case 341449783:case 2128797448:return H.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.AH()?!this.oLa():this.sa.YKa())):
!(this.tableManager&&this.tableManager.upd(this.sa.activeCell));case -123538519:return!(this.sa.AH()&&this.tableStyleManager&&this.tableStyleManager.vpd());case 756677940:return!(H.EwaSettings.ma(407)&&this.Zci());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.$ci());case 844144422:return!this.sa.AH();case -723113214:return!(H.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&this.sa.AH());case 1371713064:case -605127244:return this.sa.AH()}return!1}executeCommand(rb,
Pa,eb){var Ob;rb=f.TaskExtensions.vk();const tb=this.$.pa.va;let cc=null,Ib=1;const Mb=Pa.command,Oa=this.$.pa.va.Qb();let Aa=null;switch(Mb){case -2058042992:const ob=w.a.Uh(eb[n.a.Zf]);H.EwaSettings.isChangeGateEnabled("OfficeVSO:6709953_Fix_MacroRecording_ClearFilterInAFMenu")&&(ob.CriteriaType=0);pa.mXf(this.$,ob);cc=(pb,va,db)=>ma.a(tb,ob,null,null,!1,!1,!1,ua.a.Sua(ha.a.Ara,ya.a.clearAutoFilter,pb),va,db,null);Ib=176;Aa=()=>new u(ob);break;case 504133448:case -798968736:case 477776686:const xb=
w.a.Uh(eb[n.a.Zf]),Va=eb.TopCellAddress;pa.mXf(this.$,xb);const bb=504133448===Pa.command?1:-798968736===Pa.command?2:3;if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&Va){eb=this.tableManager.Fm(Va);if(!eb&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var Ba=this.$.xa.oa;(null===(Ob=z.D(Ba.W_))||void 0===Ob?0:Ob.contains(Va))?eb=z.D(Ba.W_):e.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
eb&&!this.$.hVc([eb],!0,1))break}else if(eb&&!this.$.oq([eb],!0,1))break}cc=(pb,va,db)=>A.I(tb,xb,bb,J.b(pb,this.MRi),va,db,Va,Oa);Ib=177;Aa=()=>new r(xb,bb);break;case 341449783:case 2128797448:this.sQa=341449783===Mb?0:2;({qBa:cc,operationName:Ib,hj:Aa}=this.toggleTableStyleOption(tb,Oa));break;case -712419744:this.Xx?this.C$e(eb[m.a.event]):this.C$e(null);break;case 1371713064:Ob=eb[n.a.Oc];let ra=z.r(this.sa.selectedRanges,this.$);if(!Ob||!ra)break;const Qa=Number.parseInvariant(Ob);cc=(pb,va,
db)=>ma.e(tb,ra,Qa,pb,va,db,null,Oa);Aa=()=>new S(ra,Qa);Ib=1025;break;case 1868184698:if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({Lxb:Ob,qBa:cc,hj:Aa}=this.f$f(null,Oa),Ob)){Ib=206;break}H.EwaSettings.isChangeGateEnabled("OfficeVSO:6690600_FlightRemovalTableDialogMigration")?new Ca.a(this.$):(Ob=new ba.a(this.$),Ob.initialize(),Ob.xf());break;case 844144422:new ea(this.$);break;case 1544516694:case -544558380:if(Ob=eb[n.a.Oc])this.sQa=this.NXh(Ob),-1!==this.sQa&&
({qBa:cc,operationName:Ib,hj:Aa}=this.toggleTableStyleOption(tb,Oa));break;case 756677940:if(this.oLa()&&this.Fef()){e.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}const qb=eb.Text,Wa=this.SPh();if(Wa){cc=(va,db,Ya)=>ma.j(tb,qb,Wa,J.b(va,this.LRi),J.a(db,this.KRi),Ya,Oa);Ib=217;let pb=null;this.tableManager.Jg?pb=this.tableManager.Jg.name:this.tableManager.FDd?
pb=this.tableManager.FDd.name:e.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");pb&&(Aa=()=>new X(pb,qb))}else return e.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),nb.Task.Ua(!1);break;case 323142015:if(this.oLa())break;return(new ab(this.$,this.Yad(),this.tableManager.Jg.name)).b$a();case -1400250766:Ib=
211;cc=this.Qfj(eb,tb,Oa);const ta=z.m(eb.OriginalTableRange,this.$.xa.oa);Aa=()=>new da(ta);break;case 1872288872:this.tableManager.g2i();break;case -123538519:const ib=this.MXh(eb);Ob=N.a.contains(eb[n.a.Oc],m.a.MFb,!0)||N.a.contains(eb[m.a.cG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";e.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${Ob} with style index ${ib.toString()}`);let Bb=this.N0e();Bb&&(cc=(pb,va,db)=>ma.b(tb,
Bb,ib,pb,va,db,null,Oa),Aa=()=>new M(Bb,ib),Ib=212);break;case 753331043:Ob=eb[n.a.Oc];if(!Ob)break;const Ub=Number.parseInvariant(Ob);if(this.sa.AH()){e.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${Ub}`);let pb=this.N0e();pb&&(cc=(va,db,Ya)=>ma.h(tb,pb,!1,!1,!1,Ub,va,db,Ya,null,Oa),Aa=()=>new L(pb,!1,Ub,!1),Ib=215);break}if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({Lxb:eb,qBa:cc,hj:Aa}=this.f$f(Ub,
Oa),eb)){Ib=215;break}e.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${Ub}`);H.EwaSettings.isChangeGateEnabled("OfficeVSO:6690600_FlightRemovalTableDialogMigration")?new aa(this.$,Number.parseInvariant(Ob)):(Ob=new la(this.$,Number.parseInvariant(Ob)),Ob.initialize(),Ob.xf());break;case 71074531:const Ta=eb.HasHeader,mb=eb.TableRange;cc=(pb,va,db)=>ma.f(tb,mb,Ta,!1,!1,pb,va,db,null);Aa=()=>new x.a(Ta,mb);Ib=206;break;case -723113214:new Z(this.$);
break;case 868579142:e.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Ib=1022;const Qb=eb.Title,Lb=eb.Description,Jb=this.Yad();cc=(pb,va,db)=>ma.g(tb,Qb,Lb,Jb,pb,va,db,null);let Ab;this.tableManager.Jg&&(Ba=N.a.kh(this.tableManager.Jg.kSa)?"":this.tableManager.Jg.kSa,Ab=N.a.kh(this.tableManager.Jg.lSa)?"":this.tableManager.Jg.lSa);Aa=Qb==Ba?()=>new U(Jb,void 0,Lb):Lb==Ab?()=>new U(Jb,Qb,void 0):()=>new U(Jb,Qb,Lb);break;default:return F.a(Mb)}if(cc){const ob=xb=>new y.a(Ib,0,xb,void 0,
Aa);rb=!this.namedSheetViewPublic||-2058042992!==Mb&&504133448!==Mb&&-798968736!==Mb&&477776686!==Mb?B.a(this.$.userOperationManager,cc,ob,Pa):this.namedSheetViewPublic.aAa().continueWith(xb=>{xb.result&&B.a(this.$.userOperationManager,cc,ob,Pa)})}return rb}toggleTableStyleOption(rb,Pa){const eb=this.sa.YKa();e.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${eb?"PivotTable":"table"} style option ${this.sQa} was toggled.`);const Ob=this.Yad();return{qBa:(tb,cc,Ib)=>ma.l(rb,Ob,this.sQa,
J.b(tb,this.tSi),cc,Ib,null,Pa),operationName:196,hj:()=>new fa(Ob,this.sQa,eb)}}Qfj(rb,Pa,eb){const Ob=rb.OriginalTableRange,tb=z.m(rb.ResizeTableRange,this.$.xa.oa),cc=()=>{this.tableManager.j7f(Ob)},Ib=Mb=>{Mb.Errors&&this.tableManager.j7f(Ob)};return(Mb,Oa,Aa)=>ma.k(Pa,tb,J.b(Mb,Ib),J.a(Oa,cc),Aa,null,eb)}MXh(rb){var Pa=-1;rb[n.a.Oc]&&(Pa=rb[n.a.Oc],Pa=N.a.contains(Pa,m.a.MFb,!0)?this.tableStyleManager.Cub(Pa):Number.parseInvariant(rb[n.a.Oc]));return Pa}Ec(rb,Pa){rb=!1;switch(Pa.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:rb=
!0;break;case 756677940:rb=H.EwaSettings.ma(407);break;case -723113214:case 868579142:rb=H.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText");break;case 1371713064:rb=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTable",!1)}return rb}Vc(rb,Pa,eb){rb=!1;switch(Pa){case "PopulateTableMoreStylesMenu":this.menuId=eb.MenuId;this.tableStyleManager.vpd()||this.tableStyleManager.K3a("formatAsTableMenu");rb=this.tableStyleManager.oGf(Pa,eb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=
eb.MenuId,this.tableStyleManager.vpd()||this.tableStyleManager.K3a("accessibilityTab"),rb=this.tableStyleManager.oGf(Pa,eb)}return rb}dispose(){this.tableStyleManager.Ibj(this.uCf)}yca(){(N.a.contains(this.menuId,"Format",!0)||N.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Ww(this.menuId)}Yad(){return z.v(this.sa.activeCell,this.$)}SPh(){const rb=this.tableManager.Iqd;return rb?z.v(rb,this.$):null}C$e(rb){if(this.tableManager){var Pa=R.g(this.$),eb=this.sa.activeCell,Ob=this.tableManager.Fm(eb),
tb=null;if(!Ob||Ob.MRa)for(let cc of Pa.ZX)for(let Ib of cc)Pa=Ib.Sn,eb.left>=Pa[0]&&eb.left<=Pa[Pa.length-1]&&(tb=(Pa=Ib.Rr(eb).UJ())?P.DOMElementExtensions.Kj(Pa,l.a.Pne):null);else{const cc=Pa.Xb(v.Range.Tc(Ob.top,eb.left));if(this.Xx){T.a.instance.create(()=>{cc.invoke(8,rb)},0,W.a.a7f,!0,!0);return}tb=cc.yJa(56).Y4a}tb&&T.a.instance.create(()=>{P.DOMElementExtensions.wdc(tb,null)},0,W.a.a7f,!0,!0)}}NXh(rb){rb=Number.parseInvariant(rb);return-1<rb&&8>=rb?rb:-1}oLa(){return!this.tableManager.Jg}Fef(){return this.tableManager.FDd?
!1:(e.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}$ci(){const rb=this.sa.AH(),Pa=this.sa.xg&&!R.g(this.$).Db.q4(this.sa.Wc);return rb||Pa}Zci(){return this.sa.AH()||!this.Fef()}PXh(rb){const Pa=[];for(const eb of rb)if(rb=G.b(this.$,eb),null===rb||void 0===rb?0:rb.length)for(const Ob of rb)Ob.usedRange&&!Pa.includes(Ob.usedRange)&&Pa.push(Ob.usedRange);return Pa}N0e(){const rb=this.sa.selectedRanges;let Pa=[];if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Pa=
this.PXh(rb);else for(const eb of rb)R.g(this.$).Db.q4(eb)&&Pa.push(eb);return Pa&&Pa.length?z.r(Pa,this.$):null}sL(rb){qa.a.Yaa(this.$)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,430,431,1),Pa=>{Pa.result.b7(rb);e.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}vqi(rb){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,446,447,0),Pa=>{Pa.result.u9g(this.$,rb)},this.$.la,3)}static mXf(rb,Pa){Pa.SheetName=
rb.oa.name;Pa.NamedObjectView=rb.ea.isNamedObjectViewMode}f$f(rb,Pa){let eb,Ob;if(!this.sa.xg||1!=this.sa.Wc.TG)return{Lxb:!1,qBa:eb,hj:Ob};let tb=z.v(this.sa.Wc,this.$);tb.LastColumn=tb.FirstColumn+3-1;tb.LastRow=tb.FirstRow+4-1;const cc=z.D(tb),Ib=R.g(this.$);if(!cc.yz||!Ib.Db.qwa(cc))return{Lxb:!1,qBa:eb,hj:Ob};k.AFrameworkApplication.zF("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{Lxb:!1,qBa:eb,hj:Ob};if(null==rb)eb=(Mb,Oa,Aa)=>ma.f(this.$.pa.va,tb,!1,!1,!1,Mb,Oa,Aa,Pa),Ob=()=>new x.a(!1,tb);else{const Mb=z.s(tb);eb=(Oa,Aa,Ba)=>ma.h(this.$.pa.va,Mb,!1,!1,!1,rb,Oa,Aa,Ba,Pa);Ob=()=>new L(Mb,!1,rb,!0)}return{Lxb:!0,qBa:eb,hj:Ob}}}Object(t.a)(pa,"TableCommandHandler",null,[188]);class Ja extends b.a{constructor(rb){super(rb)}dispose(){super.dispose()}Dd(){const rb=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ib),Pa=d.GetServiceTaskFactory.create(this.$.da,
330,this.la,this.ib),eb=d.GetServiceTaskFactory.Ta(this.$.da,309,310,this.ib);f.TaskExtensions.Aa(nb.Task.zL(rb,eb,Pa),()=>{this.ld([new pa(this.$,rb.result,eb.result,Pa.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(rb){b.a.Rd(86,new Ja(rb))}}Object(t.a)(Ja,"TableCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return $a});const $a=()=>{c.a.Fa(rb=>{Ja.ka(rb)})}},1148:function(t,D,a){var c=a(10),b=a(1);t=a(0);var d=a(220),f=a(15),e=
a(30),k=a(5),l=a(12),m=a(22),v=a(14),n=a(253),w=a(21),r=a(29);class u{constructor(aa){this.Psc=aa||""}static get qJe(){return u.t4d||(u.t4d=new u(""))}static get itd(){return u.o$d||(u.o$d=u.oad(2).Psc)}static r2a(aa){aa=r.a.Dg(aa||"");return new u(aa)}static T8b(aa){return u.r2a(v.a.instance.ga(aa))}static oad(aa){return new u(v.a.instance.Xa(aa))}static YCh(aa,...sa){return u.XCh(v.a.instance.mb(aa),...sa)}static XCh(aa,...sa){const ea=sa.length,Z=Array(ea);for(let ua=0;ua<ea;ua++)Z[ua]=(sa[ua]||
u.qJe).Psc;return new u(String.format(aa,Z))}}u.t4d=null;u.o$d=null;Object(t.a)(u,"SafeHtml",null,[634]);const x=(aa,sa)=>{sa&&(aa.append(sa),aa.append(u.itd))};class z{constructor(aa,sa,ea){this.luf=(Z,ua)=>{this.YKf(ua.Jd.command)};this.$=aa;this.kea=document.createElement("div");this.kea.setAttribute(k.a.gP,k.a.jk);this.kea.className=e.a.E7c;sa.insertBefore(this.kea,ea);this.vfa=document.createElement("div");this.vfa.setAttribute(k.a.gP,k.a.jk);this.vfa.className=e.a.E7c;sa.insertBefore(this.vfa,
this.kea);this.Irg=v.a.instance.Xa(2);this.uga=document.createElement("div");this.uga.setAttribute(k.a.Kd,k.a.sra);this.uga.setAttribute(k.a.ura,k.a.fnb);this.uga.className=e.a.E7c;sa.insertBefore(this.uga,this.vfa);this.register();this.$.da.Ga(211,this)}get bxa(){return this.Irg}get isActive(){return!0}get activeCell(){return w.g(this.$).Xb(null)}dispose(){this.$&&this.unregister();l.DOMElementExtensions.nf(this.uga);l.DOMElementExtensions.nf(this.kea);l.DOMElementExtensions.nf(this.vfa);this.vfa=
this.kea=this.uga=this.$=null}setEnabled(aa){this.dYf(this.vfa,aa)}epj(){this.dYf(this.kea,!0)}readText(aa){this.tGb(u.r2a(aa),!0)}YOa(aa){this.tGb(u.r2a(aa),!1)}aLf(aa,sa){if(1>sa||!aa)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ea=new Sys.StringBuilder;aa=String.format(v.a.instance.mb(34),sa,aa);x(ea,aa);x(ea,v.a.instance.ga(857));this.tGb(u.r2a(ea.toString()),!1)}}H4i(aa,sa,ea){if(1>ea||1>sa||sa>ea||!aa)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");
else{var Z=new Sys.StringBuilder;x(Z,aa);Z.append(String.format(v.a.instance.mb(55),sa,ea));this.tGb(u.r2a(Z.toString()),!1)}}YKf(aa){aa=this.dVh(aa);this.tGb(aa,!1)}tGb(aa,sa){if(aa=aa?aa.Psc:null)sa=sa?this.vfa:this.kea,m.a.equals(sa.innerHTML,aa,!1)&&(aa+=u.itd),sa.innerHTML=aa}X$a(aa,sa){this.uga.getAttribute(k.a.ura)!==sa&&this.uga.setAttribute(k.a.ura,sa);aa=aa?u.r2a(aa).Psc:"";this.uga.innerHTML=aa}I4i(aa,sa,ea,Z){const ua=v.a.instance.mb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===aa||
null===aa));f.ULS.shipAssertTag(537153948,0,!(void 0===sa||null===sa));f.ULS.shipAssertTag(537153947,0,!(void 0===ea||null===ea));f.ULS.shipAssertTag(537153946,0,!(void 0===Z||null===Z));f.ULS.shipAssertTag(537153945,0,!(void 0===ua||null===ua));aa=String.format(ua,aa||"",sa||"",ea||"",Z||"");this.X$a(aa,k.a.FYa)}zPj(aa){var sa=this.vfa.style;aa?(aa=n.a.s_b(aa.cell,sa),sa=aa.KB,sa.top=sa.left=sa.bottom=sa.right=null,aa.N1()):sa.cssText=""}dVh(aa){switch(aa){case -1985798686:return u.T8b(12);case -911352779:return u.T8b(11);
case 237279923:return u.T8b(13);case -1502853784:return u.oad(81);case -111689794:return u.oad(78);case -287251124:return this.yed(1331,sa=>sa.bold);case -1925065947:return this.yed(1332,sa=>sa.italic);case 1764140053:return this.yed(1333,sa=>sa.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.WEa(this.luf))}unregister(){this.$&&
this.$.Ka.dza(this.luf)}dYf(aa,sa){const ea=aa===this.kea;sa?(aa.setAttribute(k.a.ura,k.a.FYa),ea&&aa.setAttribute(k.a.Kd,k.a.sra),aa.setAttribute(k.a.gP,k.a.cr),aa.removeAttribute(k.a.gP),aa.innerHTML+=" "):(aa.removeAttribute(k.a.ura),ea&&aa.removeAttribute(k.a.Kd),aa.setAttribute(k.a.gP,k.a.jk))}yed(aa,sa){const ea=this.activeCell;if(!ea)return null;sa=sa(ea)?7:8;return u.YCh(sa,u.T8b(aa))}}Object(t.a)(z,"AriaLiveNotifier",null,[622,582,3]);class B extends d.a{constructor(aa){super();this.$=aa;
this.Fb()}create(){this.qb(this.$.da.za(211)||new z(this.$,this.$.aw,this.$.Bf))}static ka(aa){aa.da.Ga(212,new B(aa))}}Object(t.a)(B,"AriaLiveNotifierFactory",d.a,[]);var y=a(27),A=a(212),K=a(137),G=a(67);class T{constructor(aa,sa){this.s_=this.LV=this.IN=null;this.nia=sa;this.z8g(aa);this.FZi();b.EwaSettings.xb()&&aa.da.Ga(244,this)}get isActive(){return!!this.nia&&document.activeElement===this.nia}readText(aa){aa=String.format(v.a.instance.mb(30),aa);this.IN.setAttribute(k.a.Nt,aa);this.LV.setAttribute(k.a.Nt,
aa);this.uGj()}dispose(){this.s_&&this.s_.parentNode&&this.s_.parentNode.removeChild(this.s_);this.LV=this.IN=this.s_=this.nia=null}z8g(aa){var sa=aa.Bb+"readoutElementWrapper";const ea=aa.Bb+"readoutElement1",Z=aa.Bb+"readoutElement2";this.s_=document.getElementById(sa);this.s_||(this.s_=document.createElement(A.a.div),this.s_.id=sa,this.IN=document.createElement(A.a.label),this.IN.id=ea,this.IN.setAttribute(K.a.contentEditable,G.a.aOb),this.IN.setAttribute(k.a.Kd,k.a.GYa),this.LV=document.createElement(A.a.label),
this.LV.id=Z,this.LV.setAttribute(K.a.contentEditable,G.a.aOb),this.LV.setAttribute(k.a.Kd,k.a.GYa),this.IN.style.width="0px",this.IN.style.height="0px",this.LV.style.width="0px",this.LV.style.height="0px",this.IN.tabIndex=-1,this.LV.tabIndex=-1,this.s_.appendChild(this.IN),this.s_.appendChild(this.LV),aa=aa.Bb+k.a.a2b,sa=document.getElementById(aa),f.ULS.shipAssertTag(537153942,3,!!sa,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${aa}`),sa&&sa.appendChild(this.s_))}FZi(){this.nia&&
this.IN&&this.LV&&(this.nia.setAttribute(k.a.R1,this.IN.id),this.nia.setAttribute(k.a.oVc,`${this.IN.id} ${this.LV.id}`))}uGj(){if(this.isActive){let aa="";l.DOMElementExtensions.hasAttribute(this.nia,k.a.R1)&&(aa=this.nia.getAttribute(k.a.R1).toString());this.nia.setAttribute(k.a.R1,aa===this.IN.id?this.LV.id:this.IN.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static B5a(){if(null==T.ktb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!y.a.PLa)T.ktb=!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(T.ktb=!1,y.a.FH||y.a.Tf)T.ktb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return T.ktb}static ka(aa){T.B5a()&&aa.da.Ga(244,new T(aa,w.g(aa).dc.textBox.Se))}}T.ktb=null;Object(t.a)(T,"FocusBasedReadout",null,[582,3]);class W extends d.a{constructor(aa){super();
this.$=aa;this.Fb()}create(){T.B5a()?w.g(this.$).dc.textBox.sT(()=>{const aa=this.$.da.za(244)||new T(this.$,w.g(this.$).dc.textBox.Se);this.qb(aa)}):this.qb(null)}static ka(aa){aa.da.Ga(315,new W(aa))}}Object(t.a)(W,"FocusBasedReadoutFactory",d.a,[]);var P=a(50),E=a(37),H=a(7),F=a(86),N=a(84);const J=aa=>{switch(aa){case 1:return 1454;case 2:return 1455;case 3:return 1456;case 4:return 1457;case 5:return 1458;case 6:return 1459;case 7:return 1460;case 8:return 1461;case 9:return 1462;case 10:return 1463;
case 11:return 1464;case 12:return 1465;case 13:return 1466;case 14:return 1467;case 15:return 1468;case 16:return 1469;case 17:return 1470;case 18:return 1471;case 19:return 1472;case 20:return 1473;case 21:return 1474;case 22:return 1477;case 23:return 1475;case 24:return 1476;case 25:return 1478;case 26:return 1479;case 27:return 1480;case 28:return 1481;default:return 1482}};var R=a(24),M=a(42),L=a(239),U=a(47),X=a(45),da=a(122);class fa{static get x3i(){return fa.Wce||(fa.Wce=RegExp("([A-Z]+)",
"g"))}static get w3i(){return fa.Vce||(fa.Vce=RegExp("([A-Z])","g"))}static get gWg(){return fa.S1d||(fa.S1d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static ned(aa){return fa.U_e(aa.toString())}static U_e(aa){return fa.gWg.test(aa)?aa.replace(fa.x3i,"$1 ").replace(fa.w3i,' "$1"').trim():aa}static jdj(aa){const sa=aa.lastIndexOf("!");return aa.substring(0,-1<sa?sa+1:0)+fa.U_e(aa.substring(-1<sa?sa+1:0,aa.length))}}
fa.Wce=null;fa.Vce=null;fa.S1d=null;Object(t.a)(fa,"RangeAriaExtensions",null,[]);class S{constructor(){this.activeItemName=null;this.Bff=!1;this.tableName=null;this.p_a=0;this.Pxc=!1}}Object(t.a)(S,"SelectionReadoutState",null,[]);a(64);var ka=a(77);class V{constructor(aa,sa,ea,Z,ua){this.gridReadoutNotifier=null;this.S$a=!1;this.Mra=this.qnb=null;this.rca=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
w.g(this.$).$a||this.sZb.Qq()};this.MEi=()=>{if(!w.g(this.$).ha.Oa.Nnd){var ya,ha=({activeCell:ya}=this.hGh()).returnValue;this.readText(ha,ya)}};this.qp=()=>{const ya=this.activeCell;this.readText("Editing",ya);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||ya&&ya.Hbc&&!w.g(this.$).o5e||this.sZb.cancel()};this.Uc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.rca(),this.S$a&&w.g(this.$).inRangePicker&&1===ka.a.Eb&&(null===this.qnb?this.qnb=U.a.instance.create(this.xFd,V.SRc,"readSelectedRanges"):this.qnb.Qq()))};this.$=sa;this.ariaLiveNotifier=aa;this.sparklineManager=Z;this.tableManager=ea;this.wD=new S;this.B5a=T.B5a();this.S$a=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.B5a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=ua:this.gridReadoutNotifier=sa.da.za(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),V.SRc=700);this.sZb=U.a.instance.create(this.MEi,V.SRc,X.a.Flj,!1);this.Bj()}get activeCell(){return w.g(this.$).Xb(null)}dispose(){this.$&&this.ek();F.a.Ia(this.sZb);this.sparklineManager=this.$=this.sZb=null}IVe(aa,sa,ea=!0){if(!aa)return"";var Z=this.$.da;const ua=new Sys.StringBuilder;this.CJg(ua,aa,sa);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var ya=this.tableManager.Sia(aa.range);(null===
ya||void 0===ya?0:ya.vQd)&&this.dpe(ua,ya);ya=this.tableManager.Fm(aa.range);(null===ya||void 0===ya?0:ya.qaa)&&this.dpe(ua,ya)}ya=aa.paa?this.wYe(aa):aa.text;x(ua,ya);ya=this.$.activeItemName;this.wD.activeItemName!==ya&&(x(ua,ya),this.wD.activeItemName=ya);ya=1===sa.length?M.K(sa).isSingle?"":v.a.instance.ga(853):String.format(v.a.instance.mb(31),sa.length);x(ua,ya);for(var ha of sa)x(ua,fa.ned(ha)),1===sa.length&&V.Umi(ha)&&(ya=w.g(this.$).Ea.Qr(ha.bottomRight),void 0!==ya&&null!==ya&&ya.text&&
(ya=ya.paa?this.vYe(ya,ya.text):ya.text,x(ua,ya)));ha=aa.cell;ha=this.ySh(ha.Phj,ha.gZg);x(ua,ha);this.lJg(ua,aa);ea&&(aa.c6a?x(ua,v.a.instance.ga(841)):aa.pwa&&x(ua,v.a.instance.ga(842)));if(aa.hasAutoFilter||aa.E3)this.DJg(ua,aa.hasAutoFilter?aa.cell.autoFilterType:aa.cell.gXi),ea&&x(ua,v.a.instance.ga(844));L.c(this.$,aa.range)&&x(ua,v.a.instance.ga(848));this.iJg(ua,aa);ea=(ea=Z.za(14))?ea.lHh():"";x(ua,ea);aa.fF&&(ea=w.g(this.$).Ea.Qr(aa.range),ea=!!ea&&ea.E5e,V.dvj(aa)?V.jJg(ua,aa):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
ea?x(ua,v.a.instance.ga(846)):x(ua,v.a.instance.ga(845)));aa.oaa&&(x(ua,v.a.instance.ga(847)),aa.Rvb&&x(ua,String.format(v.a.instance.mb(16),aa.Mah)),x(ua,aa.iconName));aa.hasRichValueIcon&&(ha=this.$.da.za(271),ea="",ha&&aa.cell.wjf&&(ha=ha.NP(aa.cell.wjf))&&ha.DomainId.Id!==V.IWj&&(ea=ha.Name),aa.cell.Fdi?(x(ua,String.format(v.a.instance.mb(186),ea)),x(ua,v.a.instance.ga(1804))):(x(ua,String.format(v.a.instance.mb(184),ea)),x(ua,v.a.instance.ga(1803))));this.Y3h(aa)&&x(ua,V.bOh(aa));(Z=Z.za(231))&&
x(ua,Z.LYe(sa,!0));1===sa.length&&sa[0].isSingle&&V.cvj(aa,sa[0],this.$)&&(sa=this.$.da.za(271))&&x(ua,sa.yHh());aa.EMb&&aa.FMb&&x(ua,aa.FMb);(sa=aa.cell.XUg)&&x(ua,sa);aa.ELa&&aa.pFb&&(aa=aa.bCd)&&(x(ua,v.a.instance.ga(1979)),x(ua,aa));return ua.toString()}aue(aa){this.Mra=this.wD;this.wD=Object(H.a)(new S,{activeItemName:this.Mra.activeItemName,Pxc:aa?this.Mra.Pxc:!1,tableName:aa?this.Mra.tableName:"",p_a:aa?this.Mra.p_a:-1})}DSf(){this.Mra&&(this.wD=this.Mra,this.Mra=null)}ySh(aa,sa){return 2===
aa||2===sa?v.a.instance.ga(874):1===aa||1===sa?v.a.instance.ga(875):""}wYe(aa){return this.vYe(aa.cell,aa.text)}CJg(aa,sa,ea){if(ea&&1===ea.length&&ea[0].isSingle){ea="";var Z=this.tableManager.Sia(sa.range);if(Z){ea=Z.pivotTableName;this.OUc(aa,ea);var ua=Z.zec?v.a.instance.ga(836):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(ua+=(Z.altText?Z.altText+" . ":"")+(Z.altTextSummary?Z.altTextSummary:""));this.fpe(aa,!0,ea,ua);x(aa,this.tableManager.Tki(Z,
sa.range)?v.a.instance.ga(838):"");x(aa,this.tableManager.Vei(Z,sa.range)?v.a.instance.ga(837):"")}else if(Z=this.tableManager.Fm(sa.range)){ea=(ua=w.g(this.$).Db.Xj(sa.range))?ua.name:"";this.OUc(aa,ea);let ya="";ua&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(ya=(ua.kSa?ua.kSa+" . ":"")+(ua.lSa?ua.lSa:""));this.fpe(aa,!1,ea,ya);x(aa,this.tableManager.Dcf(Z,sa.range)?v.a.instance.ga(837):"")}else this.OUc(aa,ea),this.wD.tableName="",this.wD.p_a=-1}}OUc(aa,sa){sa!==
this.wD.tableName&&this.wD.tableName&&(aa.append(v.a.instance.ga(this.wD.Pxc?835:834)),x(aa," "+this.wD.tableName))}fpe(aa,sa,ea,Z){ea!==this.wD.tableName&&(aa.append(v.a.instance.ga(sa?833:832)),x(aa," "+ea),x(aa,Z),this.wD.tableName=ea,this.wD.Pxc=sa,this.wD.p_a=-1)}dpe(aa,sa){const ea=w.g(this.$).ha.sa.activeCell;if(ea.top!==sa.top&&ea.left!==this.wD.p_a){aa.append(v.a.instance.ga(837));sa=new R.Range(sa.top,ea.left,sa.top,ea.left,!0,!0);x(aa,fa.ned(sa));if(sa=w.g(this.$).Xb(sa))sa=sa.paa?this.wYe(sa):
sa.text,x(aa,sa);this.wD.p_a=ea.left}}vYe(aa,sa){const ea=aa.A4a;return aa.Tvb?String.format(v.a.instance.mb(14),sa,ea):String.format(v.a.instance.mb(13),sa,fa.jdj(ea))}Bj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var aa=w.g(this.$);f.ULS.shipAssertTag(537153929,0,!!aa,"Can't register to grid's events");aa&&(aa.Wb.Mk(this.qp),aa.Ea.ox(this.rca),aa.iC(this.rca),this.S$a&&aa.Wb.jm(this.Jf.bind(this)),aa=aa.ha,f.ULS.shipAssertTag(537153928,0,!!aa,
"Can't register to selectionManager's events"),aa&&(aa.LG(this.Uc),aa.iJ(this.rca),aa.Oa.I1(this.rca),this.S$a&&(this.xFd=this.xFd.bind(this))))}}ek(){if(this.$){var aa=w.g(this.$);aa&&(aa.Wb.Gk(this.qp),aa.Ea.uv(this.rca),aa.BD(this.rca),this.S$a&&aa.Wb.Al(this.Jf),aa=aa.ha)&&(aa.RF(this.rca),aa.RK(this.rca),aa.Oa.fma(this.rca))}}readText(aa,sa){this.B5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(aa):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(aa),this.S$a&&!sa||this.ariaLiveNotifier.zPj(sa))}Jf(){this.qnb&&this.qnb.cancel()}xFd(){this.readText(this.PVh())}PVh(){let aa="";w.g(this.$).ha.rangePicker.KK.forEach(()=>{aa+=void 0});return aa+=" selected"}hGh(){let aa;aa=null;var sa=w.g(this.$).ha;if(1!==sa.Ke&&!sa.Oa.$b)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${sa.Ke} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",
activeCell:aa};switch(sa.Ke){case 2:return{returnValue:this.iJh(sa),activeCell:aa};case 64:var ea=sa.Oa.$b.floatingObject,Z="";if(sa=sa.Oa.$b.As||sa.Oa.$b.Hd)Z=(Z=sa.firstChild)?l.DOMElementExtensions.getTextContent(Z):"";return{returnValue:String.format(v.a.instance.mb(53),V.g9b(ea.altText,ea.altTextDescription,ea.name),Z,ea.altTextDescription),activeCell:aa};case 4:return{returnValue:V.uIg(sa.Oa.$b.floatingObject),activeCell:aa};case 512:return{returnValue:da.a.gXe(sa.Oa.$b.floatingObject.O5c),
activeCell:aa};case 8:return ea=sa.Oa.$b.floatingObject,{returnValue:String.format(v.a.instance.mb(51),ea?ea.name:""),activeCell:aa};case 1:return aa=this.activeCell,{returnValue:this.IVe(aa,sa.sa.selectedRanges),activeCell:aa}}return{returnValue:"",activeCell:aa}}iJh(aa){const sa=new Sys.StringBuilder;sa.append(V.AVg(aa));const ea=this.$.da.za(231);ea&&x(sa,ea.LYe(aa.Oa.$b.floatingObject,!1));return sa.toString()}Y3h(aa){aa=aa.Haf();let sa=!1;this.wD.Bff!==aa&&(this.wD.Bff=aa,sa=!0);return sa}lJg(aa,
sa){if(sa.cwb)if(sa=this.sparklineManager.OWh(sa)){var ea=v.a.instance,Z=ea.ga;a:switch(sa.type){case 0:var ua=829;break a;case 1:ua=830;break a;default:ua=831}ea=Z.call(ea,ua);x(aa,String.format(v.a.instance.mb(25),ea));sa=String.format(v.a.instance.mb(24),fa.ned(sa.QCj));x(aa,sa)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),x(aa,String.format(v.a.instance.mb(25),""))}DJg(aa,sa){switch(sa){case 1:case 11:x(aa,v.a.instance.ga(849));break;case 6:x(aa,
v.a.instance.ga(849));x(aa,v.a.instance.ga(851));break;case 7:x(aa,v.a.instance.ga(849));x(aa,v.a.instance.ga(852));break;case 2:x(aa,v.a.instance.ga(850));x(aa,v.a.instance.ga(851));break;case 3:x(aa,v.a.instance.ga(850));x(aa,v.a.instance.ga(852));break;default:x(aa,v.a.instance.ga(850))}}iJg(aa,sa){var ea;const Z=this.$.da.za(65);sa=Z?Z.iJa(sa.range):null;let ua="";const ya=Object(N.a)(619,sa);if(sa)ua=!sa.K5a&&ya&&ya.wmi?String.format(v.a.instance.mb(29),ya.kHj):String.format(v.a.instance.mb(23),
sa.author);else if(null===(ea=null===Z||void 0===Z?void 0:Z.Km)||void 0===ea?0:ea.gF)ua=String.format(v.a.instance.mb(28),Z.Km.iN.author);x(aa,ua)}static uIg(aa){return String.format(v.a.instance.mb(52),V.g9b(aa.altText,aa.altTextDescription,aa.name),aa.altTextDescription)}static bOh(aa){return v.a.instance.ga(aa.Haf()?839:840)}static g9b(aa,sa,ea){return aa||sa?aa:ea}static AVg(aa){var sa=aa.Oa.$b;aa=sa.floatingObject;const ea=aa.Rc,Z=ea.ChartTitle,ua=aa.altText,ya=aa.altTextDescription,ha=!!(ea.Attributes&
4);return(sa=sa.getSelectionDescription())?sa:ea.DataRangeForDisplay?String.format(v.a.instance.mb(ha?49:47),V.g9b(ua,ya,aa.name),ya,Z,v.a.instance.ga(J(ea.ChartCategory)),ea.DataRangeForDisplay):String.format(v.a.instance.mb(ha?50:48),V.g9b(ua,ya,aa.name),ya,Z,v.a.instance.ga(J(ea.ChartCategory)))}static dvj(aa){return b.EwaSettings.ma(102)&&(aa.u5a||aa.xec)}static jJg(aa,sa){sa.RRa?sa.u5a?x(aa,String.format(v.a.instance.mb(26),sa.RRa.topLeft.toString())):sa.xec&&(sa=sa.RRa.VR(),x(aa,String.format(v.a.instance.mb(27),
(sa.LastColumn-sa.FirstColumn+1).toString(),(sa.LastRow-sa.FirstRow+1).toString()))):f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static cvj(aa,sa,ea){return aa.fF||!b.EwaSettings.ma(138)?!1:(aa=ea.da.za(271))?aa.Wdc(sa):!1}static Umi(aa){return aa.top===aa.bottom&&aa.left+1===aa.right||aa.top+1===aa.bottom&&aa.left===aa.right}}V.IWj=268435712;V.SRc=500;Object(t.a)(V,"SelectionReadoutHandler",
null,[620,3]);var wa=a(55),ma=a(695);class ab extends d.a{constructor(aa){super();this.$=aa;this.Fb()}create(){const aa=this.$.da,sa=P.GetServiceTaskFactory.Ta(aa,211,212,this.ib),ea=P.GetServiceTaskFactory.Ta(aa,66,134,this.ib),Z=P.GetServiceTaskFactory.Ta(aa,240,239,this.ib);let ua=wa.Task.Ua(null);b.EwaSettings.xb()&&(ua=P.GetServiceTaskFactory.Ta(aa,244,315,this.ib));E.TaskExtensions.Aa(E.TaskExtensions.Xd([sa,ea,Z,ua],this.la),()=>{const ya=Object(ma.a)(this.$.da,226,()=>new V(sa.result,this.$,
ea.result,Z.result,ua.result));this.qb(ya)},this.$.la,3)}static ka(aa){aa.da.Ga(227,new ab(aa))}}Object(t.a)(ab,"SelectionReadoutHandlerFactory",d.a,[]);class ba{constructor(aa,sa){this.$=sa;this.ariaLiveNotifier=aa}gLf(){const aa=this.nHh();this.ariaLiveNotifier.X$a(aa,k.a.fnb)}nHh(){const aa=new Sys.StringBuilder;this.$.workbookContext&&x(aa,this.$.workbookContext.WorkbookFileName);x(aa,v.a.instance.ga(855));x(aa,this.pHh());x(aa,this.oHh());x(aa,v.a.instance.ga(856));return aa.toString()}pHh(){return this.$.isEditMode?
v.a.instance.ga(860):v.a.instance.ga(861)}oHh(){var aa=this.UVj();const sa=this.$.xa.oa;aa=1!==aa?String.format(v.a.instance.mb(32),aa):v.a.instance.ga(854);aa=new Sys.StringBuilder(aa);sa&&sa.sheetName&&(aa.append(u.itd),aa.append(String.format(v.a.instance.mb(33),sa.sheetName)));return aa.toString()}UVj(){let aa=0;for(const sa of this.$.xa.items)sa.visible&&aa++;return aa}}Object(t.a)(ba,"WorkbookReadout",null,[]);class Ca{constructor(aa,sa,ea){this.Nxf=()=>{this.FZd.gLf();this.ariaLiveNotifier.setEnabled(!0)};
this.$=sa;this.ariaLiveNotifier=aa;this.FZd=new ba(aa,sa);this.A8b=ea.Vdd(this.$);this.A8b.OEg(this.Nxf)}dispose(){this.A8b&&this.A8b.Qaj(this.Nxf);this.A8b=this.ariaLiveNotifier=this.$=null}}Object(t.a)(Ca,"EmbeddedWorkbookReadoutHandler",null,[3]);class Na{constructor(aa,sa){this.lV=()=>{this.Ad||this.Coe()};this.Ad=!1;this.lY=sa.NT;this.ariaLiveNotifier=aa;this.FZd=new ba(aa,sa);this.lY&&this.lY.vQ?this.Coe():this.Bj()}dispose(){this.ek();this.ariaLiveNotifier=this.lY=null;this.Ad=!0}Bj(){if(this.lY){this.lY.Nu(this.lV);
this.lY.Ea.ox(this.lV);this.lY.iC(this.lV);var aa=Object(N.a)(203,this.lY);aa&&(aa.Wb.Mk(this.lV),aa.ha.LG(this.lV),aa.ha.iJ(this.lV),aa.ha.Oa.I1(this.lV))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}ek(){if(this.lY){this.lY.Ea.uv(this.lV);this.lY.BD(this.lV);const aa=Object(N.a)(203,this.lY);aa&&(aa.Wb.Gk(this.lV),aa.ha.RF(this.lV),aa.ha.RK(this.lV),aa.ha.Oa.fma(this.lV))}}Coe(){this.FZd.gLf();this.ariaLiveNotifier.setEnabled(!0);
this.ariaLiveNotifier.epj();this.dispose()}}Object(t.a)(Na,"WorkbookReadoutHandler",null,[3]);class za extends d.a{constructor(aa){super();this.$=aa;this.Fb()}create(){const aa=P.GetServiceTaskFactory.Ta(this.$.da,211,212,this.ib);if(this.$.jK){const sa=P.GetServiceTaskFactory.Ta(this.$.da,12,477,this.ib);E.TaskExtensions.Aa(E.TaskExtensions.Xd([aa,sa],this.$.la),()=>{const ea=Object(ma.b)(this.$.da,228,()=>new Ca(aa.result,this.$,sa.result));this.qb(ea)},this.$.la,3)}else E.TaskExtensions.Aa(aa,
sa=>{const ea=Object(ma.b)(this.$.da,228,()=>new Na(sa.result,this.$));this.qb(ea)},this.$.la,3)}static ka(aa){aa.da.Ga(229,new za(aa))}}Object(t.a)(za,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(D,"a",function(){return la});const la=()=>{c.a.Fa(aa=>{B.ka(aa);b.EwaSettings.xb()?W.ka(aa):T.ka(aa);ab.ka(aa);za.ka(aa)})}},1155:function(t,D,a){t=a(0);var c=a(83),b=a(547),d=a(15);class f{constructor(){this.BCc={}}Myg(ba){this.BCc[ba.id.toString()]=ba}TCi(ba){const Ca=this.BCc;for(let Na in Ca)Ca[Na].notify(ba,
!1);this.BCc={}}u1i(ba,Ca){Ca&&this.Myg(Ca);return this.zAf(ba,Ca)}l6c(ba){this.TCi(ba)}lJe(ba,Ca){ba.notify(Ca,!0)}}Object(t.a)(f,"AEventEmitter",null,[626]);var e;(function(ba){ba[ba.notStarted=0]="notStarted";ba[ba.waiting=1]="waiting";ba[ba.shouldRetry=2]="shouldRetry";ba[ba.complete=3]="complete"})(e||(e={}));Object(t.b)("EventResultState",e);class k{constructor(){this._state=0}get state(){return this._state}set state(ba){d.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:e[this._state],
["NewState"]:e[ba]},"ResultType",this.p0e());this._state=ba}}Object(t.a)(k,"AEventResult",null,[644]);class l extends k{constructor(){super();this.SPc=this.Gjb=null;this.state=0;this.LIc=this.a7d=!1}get eR(){return this.Gjb}get pna(){return this.SPc}get vbi(){return this.a7d}p0e(){return"GetMoreInfo Result"}}Object(t.a)(l,"GetMoreInfoResult",k,[643,644]);var m=a(4),v=a(80),n=a(39),w=a(683),r=a(370),u=a(163),x=a(639),z=a(572),B=a(106),y=a(25);class A{constructor(ba,Ca,Na,za,la,aa,sa,ea){this.La=ba;
this.Xg=Ca;this.$jg=Na;this.C0=za;this.ee=la;this.pHc=aa;this.Xog=sa;this.wVb=ea}R6i(){this.s8a.Ob(y.a.openUrlInNewTab,B.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.s8a.Ob(y.a.iOa,B.a.frame,Object(c.a)(this,this.iOa,"openDocumentUrl"));m.AFrameworkApplication.rM?this.alf():this.s8a.Je(y.a.v5b,B.a.frame,Object(c.a)(this,this.v5b,"documentLoaded"),96)}openUrlInNewTab(ba,Ca,Na,za,la){la&&la.MenuItemId&&(d.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:la.SourceControlId,
["AppType"]:z.a[this.Fba]}),n.a.Ve(la.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}iOa(ba,Ca,Na,za,la){if(la&&la.MenuItemId){const aa=m.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),sa=m.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");d.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",aa,sa);if(aa&&sa){d.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:la.SourceControlId,
["AppType"]:z.a[this.Fba]});ba=la.MenuItemId.toString();const ea={};ea[r.a.bPa]="1";ea[r.a.documentUrl]=ba;ea[r.a.reason]=x.a.open;d.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");m.AFrameworkApplication.GU().execute(Z=>{Z.Fj(u.a.kta,ea)})}else this.openUrlInNewTab(ba,Ca,Na,za,la)}return 32}v5b(){this.alf();return 32}tba(ba,Ca,Na=""){if(Ca&&Ca.nF){const za=w.a[Ca.status];Ca=Ca.nF.getTime();const la=this.kw()-Ca;d.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",
{["Caller"]:ba,["RequestStatus"]:za,["ElapsedMs"]:la,["StartTime"]:Ca,["Notes"]:Na})}else d.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:ba})}alf(){var ba=m.AFrameworkApplication.fa.qa("QPGVCI"),Ca=v.a.gB(document.URL,"wdNewAndOpenCt",ba);if(Ca){Ca=parseInt(Ca);var Na=v.a.gB(document.URL,"wdPreviousSession",ba);ba=v.a.gB(document.URL,"wdPreviousCorrelation",ba);var za=m.AFrameworkApplication.fa.qa("NAOPLP");if(m.AFrameworkApplication.rM){var la=
m.AFrameworkApplication.rM.getTime();!Ca||Ca>la?d.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Ca,["DocumentLoadedTime"]:la,["SessionId"]:Na,["Correlation"]:ba}):d.ULS.sendTraceTag(5849683,202,za?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:la-Ca,["ClickTimestamp"]:Ca,["SessionId"]:Na,["Correlation"]:ba})}else d.ULS.sendTraceTag(5849681,202,za?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:Ca,["SessionId"]:Na,["Correlation"]:ba})}}get s8a(){return this.La.value}get tCb(){return this.Xg.value}get zqf(){return this.$jg.value}get Fba(){return this.C0.value}get dkc(){return this.ee.value}get kw(){return this.pHc}get gV(){return this.Xog.value}get supportsGetMoreInfoForPersonalStorage(){return this.wVb.value}static get instance(){return A.Ma||(A.Ma=A.CM())}static CM(){return new A(new b.a(()=>m.AFrameworkApplication.wb),new b.a(()=>m.AFrameworkApplication.rd),new b.a(()=>
m.AFrameworkApplication.ta),new b.a(()=>m.AFrameworkApplication.ta.Pa.xj),new b.a(()=>m.AFrameworkApplication.Ji),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.ta.Pa.gV),new b.a(()=>m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}A.Ma=null;Object(t.a)(A,"NewAndOpenCommonHelpers",null,[625]);var K=a(107);class G{constructor(ba,Ca,Na){this.JUb=this.Ni=null;this.eOc=0;this.Uug=ba;this.ee=Ca;this.y3d=Na}HHg(){this.eOc=this.jbb+1}RJd(ba){this.Ni&&(this.ee.Hp(this.Ni),this.Ni=
null);ba&&(this.eOc=0)}XDj(ba){const Ca=this.gJj;0<=Ca?(this.HHg(),this.RJd(!1),this.Ni=new K.a(4,1,Ca,ba,107),this.ee.Hg(this.Ni)):(this.RJd(!0),d.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.y3d}))}get jbb(){return this.eOc}get gJj(){return this.jbb>=this.QWf.length?-1:this.QWf[this.jbb]}get QWf(){if(!this.JUb){const ba=(this.Uug.value||"0").split(",");this.JUb=[];for(let Ca=0;Ca<ba.length;Ca++){const Na=parseInt(ba[Ca]);isNaN(Na)?d.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.y3d,["Entry"]:ba[Ca]}):Array.add(this.JUb,Na)}}return this.JUb}}Object(t.a)(G,"RetryHelper",null,[]);var T=a(41),W=a(29);class P extends f{constructor(ba,Ca){super();this.c1=ba;this.hkb=new G(Ca,this.ZBb.dkc,"GetMoreInfo");this.Ko=new l}$wi(){this.aud("Document opened")}O6g(ba){return()=>{this.aud(ba,!0)}}zAf(ba,Ca=null){d.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:ba});3===this.Ko.state?(Ca&&this.lJe(Ca,this.Ko),d.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:ba})):this.aud(ba);return this.Ko}aud(ba,Ca=!1){this.hkb.RJd(!Ca);1===this.Ko.state?d.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:ba,["RetryIndex"]:this.hkb.jbb}):(d.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:ba,["RetryIndex"]:this.hkb.jbb}),this.Ko.state=1,Ca=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.ZBb.gV,m.AFrameworkApplication.gj),
this.ZBb.tCb.O8(Ca,1,null,null,[P.fce,P.dge],!1,5,this.S5g(),this.R5g(ba),null))}S5g(){return ba=>{var Ca=!1;let Na=!1;var za=!1,la;m.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(ba.data.Td?({Vt:la}=T.d(ba.data.Td)).returnValue?la?(za=!0,this.Ko.SPc=la.StorageServiceDisplayName,this.Ko.Gjb=P.Wgf(la.PersonalFileStorageUrl)?la.PersonalFileStorageUrl:"",""===this.Ko.eR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Va("FileSource")&&(this.Ko.Gjb=v.a.Aca(m.AFrameworkApplication.breadcrumbFolderUrl)),
Ca=""===this.Ko.eR&&""!==this.Ko.pna):d.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));za||((la=ba.data.responseHeaders)?
(this.Ko.SPc=(la[P.dge]||"").toString(),Ca=(la[P.fce]||"").toString(),this.Ko.Gjb=P.Wgf(Ca)?Ca:"",""===this.Ko.eR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Va("FileSource")?(this.Ko.Gjb=v.a.Aca(m.AFrameworkApplication.breadcrumbFolderUrl),Ca=""===this.Ko.eR&&""!==this.Ko.pna):Ca=""===Ca&&""!==this.Ko.pna):(d.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Na=!0));za=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.hkb.jbb,Na,Ca,za);this.ZBb.tba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ba.data,za);this.gXf(3,Ca,Na)}}R5g(ba){return Ca=>{this.ZBb.tba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ca.data,"Failure");this.gXf(2);this.hkb.XDj(this.O6g(ba))}}gXf(ba,Ca=!1,Na=!1){this.Ko.state=ba;this.Ko.a7d=Ca;this.Ko.LIc=Na;this.l6c(this.Ko)}get ZBb(){return this.c1.value}static get instance(){return P.Ma||(P.Ma=P.CM())}static CM(){return new P(new b.a(()=>A.instance),new b.a(()=>
m.AFrameworkApplication.dRh))}static Wgf(ba){if(!ba)return d.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(W.a.ll(ba).startsWith("https://"))return!0;d.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}P.fce="PersonalFileStorageUrl";P.dge="StorageServiceDisplayName";P.Ma=null;Object(t.a)(P,"GetMoreInfoActor",f,[]);var E=a(103),H=a(95);class F{constructor(ba,Ca,Na,za,la){this.Dpg=6E4;this.y8e="inactive";this.Oie=
"active";this.wS=!0;this.ee=ba;this.yog=Ca;this.pHc=Na;this.JVb=za;this.eb=new H.a;la&&this.PDj();this.Z8d=this.WYe()}tSc(ba){this.eb.addHandler(this.Oie,ba)}iBg(ba){this.eb.addHandler(this.y8e,ba)}PDj(){const ba=new K.a(5,2,this.Dpg,Object(c.a)(this,this.x7h,"inactiveLoop"),108);this.y7h.Hg(ba)}x7h(){const ba=this.WYe(),Ca=this.kw()-ba;Ca>this.wyc&&this.wS&&(d.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ca}),this.wS=!1,this.eb.raiseEvent(this.y8e));ba-this.Z8d>
this.wyc&&(this.wS=!0,this.eb.raiseEvent(this.Oie));this.Z8d=ba}get y7h(){return this.ee.value}get WYe(){return this.yog}get kw(){return this.pHc}get wyc(){return this.JVb.value}static get instance(){return F.Ma||(F.Ma=F.CM())}static CM(){return new F(new b.a(()=>E.a.instance),()=>m.AFrameworkApplication.ird.getTime(),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.wyc),!0)}}F.Ma=null;Object(t.a)(F,"InactivityManager",null,[]);var N=a(84),J=a(901);class R extends k{constructor(){super();
this.fae=this.hae=this.gae=null;this.state=this.Xge=0;this.LIc=!1}get wvd(){return this.gae}get Mpf(){return this.hae}get vvd(){return this.fae}get mJj(){return this.Xge}p0e(){return"MruActor Result"}}Object(t.a)(R,"MruResult",k,[645,644]);var M=a(236);class L{constructor(ba,Ca,Na){this.task=null;this.Ycc=ba;this.Eyi=Ca;this.taskManager=Na;this.retryCount=this.nxb=0;this.mNc=this.iAb=null}Aji(ba,Ca){return ba===M.a.N$c||20===Ca||18===Ca||3===Ca}Lki(ba){return 3===ba||5===ba||6===ba||7===ba||9===ba||
10===ba||11===ba||12===ba||13===ba||14===ba||15===ba||16===ba||23===ba||26===ba||27===ba||28===ba}get Toc(){return this.mNc}reset(){this.nxb=this.retryCount=0;this.mNc=this.iAb=null;this.task&&(this.taskManager.Hp(this.task),this.task=null)}yai(ba,Ca,Na,za){this.mNc=String.format("{0}_{1}",Na,za);if(this.retryCount>=this.Eyi)return d.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Aji(Na,za))return d.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.Lki(za)&&1<=this.nxb)return this.iAb=Na,!1;Ca=Math.max(Ca,this.Ycc*Math.pow(2,this.nxb));if(26===za)Ca=Math.max(Ca,3E4);else if(27===za||28===za)Ca=Math.max(Ca,6E4);9===za||412===Na&&(null==this.iAb||412!==this.iAb)?Ca=500:this.nxb+=1;this.iAb=Na;this.retryCount+=1;this.task&&this.taskManager.Hp(this.task);d.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Ca);this.task=new K.a(2,1,Ca,ba,107);this.taskManager.Hg(this.task);return!0}}Object(t.a)(L,"RetryManager",null,
[]);var U=a(98),X=a(134),da=a(160);class fa{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(fa,"WriteOptions",null,[]);var S=a(551),ka=a(185);class V extends f{constructor(ba,Ca,Na,za,la,aa,sa){super();this.c1=ba;this.yrg=Ca;this.mqa=new L(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.Cw.dkc);this.Pqa=new L(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Cw.dkc);this.Rtg=Na;this.iie=za;this.dyg={};this.AS=new R;this.uog=la;this.VSb="";this.Lv=aa;this.w4d=sa;this.Stg=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get NBc(){return this.dyg}I8i(){this.Cw.s8a.Ob(y.a.renameMostRecentlyUsedFileEntry,
B.a.frame,Object(c.a)(this,this.Acj,"renameMruEntry"))}Acj(){return this.MZd("Rename")}jxi(){this.Jnf("File Opened")}kxi(){this.Jnf("IntervalUpdate")}Jnf(ba){d.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:ba});this.MZd(ba)}o3(ba){(ba=W.a.o3(ba))&&ba.startsWith(".")&&(ba=ba.substring(1,ba.length));return ba}eVe(){switch(this.Cw.Fba){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}wZh(ba){var Ca=
this.uog();if(!Ca)return null;const Na=new fa;Na.documentUrl=this.w4d.value?encodeURI(Ca):Ca;Na.mruItemId=this.VSb;Na.app=this.eVe();if(Ca=this.Lv())Na.folderName=Ca.breadcrumbFolderName,Ca=Ca.Ym,Na.documentName=W.a.rq(Ca),Na.documentExt=this.o3(Ca);ba&&(Na.documentName?Na.documentName.length?255<=Na.documentName.length?ba.set("DocumentNameLength","Long"):2084<=Na.documentName.length&&ba.set("DocumentNameLength","VeryLong"):ba.set("DocumentNameLength","0"):ba.set("DocumentNameLength","Null"));return JSON.stringify(Na)}MZd(ba,
Ca=!1){if(4===this.Cw.Fba&&!m.AFrameworkApplication.jta)return 2;var Na=X.a.Kr();Na&&(Na.set("Trigger",ba),Na.set("IsRetry",Ca?"true":"false"),Na.set("MruIdSent",this.VSb?"true":"false"),Na.set("URLEncoded",this.w4d.value?"true":"false"));U.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Na);ba=this.wZh(Na);if(!ba)return Ca=!m.AFrameworkApplication.webEditingEnabled,Na&&(Na.set("WebEditingIsEnabled",m.AFrameworkApplication.webEditingEnabled?"true":"false"),Na.set("ProtectedFile",m.AFrameworkApplication.epc?
"true":"false")),U.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ca,!1,Object.assign(new ka.a,{extendedProperties:Na})),2;this.Pqa&&!Ca&&this.Pqa.reset();Na=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Cw.gV,this.localeName);this.iie?this.NBc["X-FileId"]=m.AFrameworkApplication.gj:Na+=String.format("&{0}",m.AFrameworkApplication.gj);m.AFrameworkApplication.Rb&&(this.NBc["X-Office-AudienceGroup"]=Object(N.a)(String,m.AFrameworkApplication.Rb.AudienceGroup)||"");this.NBc["X-Timeout"]=
15E3;return this.Cw.tCb.hm(Na,2,ba,this.NBc,!0,5,Object(c.a)(this,this.pXj,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.w$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}pXj(ba){this.w4e(ba.data)}w4e(ba){const Ca=X.a.Kr();this.Pqa&&(Ca&&this.Pqa.Toc&&(Ca.set("LastError",this.Pqa.Toc),Ca.set("NumRetries",this.Pqa.retryCount.toString())),this.Pqa.reset());const Na=J.c(ba.Td);Na&&Na.diagnostics_data&&(this.VSb=Na.diagnostics_data.mru_id);ba=
+ba.p2-+ba.nF;Ca&&Ca.set("RequestDuration",ba.toString());U.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ka.a,{extendedProperties:Ca}))}w$g(ba){if(ba.data.httpStatus===M.a.Cqb)this.w4e(ba.data);else{var Ca=ba.data.httpStatus===M.a.FFb,Na=X.a.Kr();this.J4e(this.Pqa,ba,this.k$g(),Na);Na&&(Na.set("StatusCode",ba.data.httpStatus.toString()),Ca||this.BSc(ba.data,Na));U.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",ba.data.httpStatus),Ca,!1,Object.assign(new ka.a,
{extendedProperties:Na}))}}k$g(){return()=>{this.MZd("Retry",!0)}}kRh(){this.T7a("Polling")}jRh(){this.T7a("Retry",!0)}dxi(){this.T7a("Open")}cxi(){this.T7a("Activity")}bxi(){this.T7a("OpenRecentLinks",!1,!0)}axi(){this.T7a("ActivityRecentLinks",!1,!0)}T7a(ba,Ca=!1,Na=!1){d.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:ba});const za=X.a.Kr();za&&(za.set("Trigger",ba),za.set("IsRetry",Ca?"true":"false"),Na&&za.set("RecentLinks","true"));U.Health.instance.recordKpiUsage("GetMru",
0,"smartfio",za);this.mqa&&!Ca&&this.mqa.reset();Na?this.tCe(Object(c.a)(this,this.lRh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(c.a)(this,this.hRh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.tCe(Object(c.a)(this,this.mRh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.iRh,"getMruFromServerFailureCallback"))}BSc(ba,Ca){ba&&ba.responseHeaders&&(ba=ba.responseHeaders["X-CorrelationId"])&&Ca.set("ServerCorrelationId",ba)}Tti(ba,Ca){ba&&(Ca&&Ca.set("RequestDuration",
(+ba.p2-+ba.nF).toString()),U.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ka.a,{extendedProperties:Ca})))}mRh(ba){this.yZe(ba)}yZe(ba,Ca=!1){var Na="";let za=null,la=null,aa=null;const sa=J.c(ba.data.Td);sa&&(za=sa.places?sa.places.items:[],la=sa.documents?sa.documents.items:[],(aa=J.a(sa,Ca))&&(Na=T.c(aa)));m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pa.vZ&&da.c()&&!Ca&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Na,!0));Na=X.a.Kr();this.mqa&&(Na&&this.mqa.Toc&&
(Na.set("LastError",this.mqa.Toc),Na.set("NumRetries",this.mqa.retryCount.toString())),this.mqa.reset());Ca&&Na&&Na.set("RecentLinks","true");aa||za||la?(Ca?this.Cw.tba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",ba.data,"Success"):this.Cw.tba("MruActor.GetMruV2FromServerSuccessCallback",ba.data,"Success"),this.oAc(3,aa,za,la),this.Tti(ba.data,Na)):(Ca?this.Cw.tba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",ba.data,"Failure: Invalid JSON"):this.Cw.tba("MruActor.GetMruV2FromServerSuccessCallback",
ba.data,"Failure: Invalid JSON"),Na&&this.BSc(ba.data,Na),U.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ka.a,{extendedProperties:Na})),this.oAc(3,null,null,null,!0));this.l6c(this.AS)}lRh(ba){this.yZe(ba,!0)}J4e(ba,Ca,Na,za){let la=0,aa=0;const sa=J.c(Ca.data.Td);sa&&(null!=sa.response_code&&(la=sa.response_code,za&&za.set("MruResponseCode",la.toString()),9===la&&(this.VSb="")),sa.error_data&&null!=sa.error_data.retry_after_ms&&(aa=sa.error_data.retry_after_ms,
za&&za.set("ExpectedRetryAfter",aa.toString())));ba&&(Ca=ba.yai(Na,aa,Ca.data.httpStatus,la),za&&(za.set("CurrentRetryCount",ba.retryCount.toString()),za.set("RetryScheduled",Ca?"true":"false")))}iRh(ba){this.xZe(ba)}xZe(ba,Ca=!1){const Na=ba.data.httpStatus===M.a.FFb,za=X.a.Kr();za&&(za.set("StatusCode",ba.data.httpStatus.toString()),Ca&&za.set("RecentLinks","true"),Na||this.BSc(ba.data,za));Ca?this.Cw.tba("MruActor.GetMruForRecentLinksFromServerFailureCallback",ba.data,"Failure"):this.Cw.tba("MruActor.GetMruFromServerFailureCallback",
ba.data,"Failure");this.oAc(2);this.J4e(this.mqa,ba,Object(c.a)(this,this.jRh,"getMruFromServerRetryTask"),za);U.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",ba.data.httpStatus),Na,!1,Object.assign(new ka.a,{extendedProperties:za}));this.l6c(this.AS);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pa.vZ&&da.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Ca||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}hRh(ba){this.xZe(ba,
!0)}oAc(ba,Ca=null,Na=null,za=null,la=!1){if(3!==this.AS.state||3===ba)this.AS.gae=Ca,this.AS.hae=Na,this.AS.fae=za,this.AS.state=ba,this.AS.LIc=la,this.AS.Xge=this.Cw.kw()}zAf(ba,Ca){d.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:ba,["ResultState"]:this.AS.state});Ca&&3===this.AS.state&&this.lJe(Ca,this.AS);return this.AS}tCe(ba,Ca,Na=!1){this.oAc(1);let za;const la={};za=Na?String.format(this.Cw.gV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.Stg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Cw.gV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.eVe(),this.localeName);this.Rtg.value||(za+="&entity=docs");m.AFrameworkApplication.Rb&&(la["X-Office-AudienceGroup"]=Object(N.a)(String,m.AFrameworkApplication.Rb.AudienceGroup)||"");Na&&(la["X-Office-Application"]="147");this.iie?la["X-FileId"]=m.AFrameworkApplication.gj:za+=String.format("&{0}",m.AFrameworkApplication.gj);this.Cw.tCb.hm(za,1,null,la,
!0,5,ba,Ca,null)}get Cw(){return this.c1.value}get localeName(){return this.yrg.value}static get instance(){return V.Ma||(V.Ma=V.CM())}static CM(){return new V(new b.a(()=>A.instance),new b.a(()=>S.a.mH(m.AFrameworkApplication.lcid).name),new b.a(()=>m.AFrameworkApplication.ta.Pa.nv),m.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>m.AFrameworkApplication.ta.Pa.xx,()=>m.AFrameworkApplication.lm,new b.a(()=>m.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}V.Ma=null;Object(t.a)(V,
"MruActor",f,[]);class wa{constructor(){this.elb=this.ede=this.gb=null;this.zm=!1}get name(){return"Common.App.NewAndOpen.Core"}ai(ba){this.gb=ba;ba.register(625,"Common.INewAndOpenCommonHelpers").uc().Gc(()=>A.instance);ba.register(626,"Common.IEventEmitter<Common.IGetMoreInfoResult>").uc().Gc(()=>P.instance);ba.register(626,"Common.IEventEmitter<Common.IMruResult>").uc().Gc(()=>V.instance)}init(){m.AFrameworkApplication.fa.hv(()=>{this.Zwb()})}Zwb(){this.gb.resolve("Common.INewAndOpenCommonHelpers");
this.gb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.gb.resolve("Common.IEventEmitter<Common.IMruResult>");var ba=!1;A.instance.R6i();m.AFrameworkApplication.Lka&&(ba=!0);m.AFrameworkApplication.$Kf&&(V.instance.dxi(),m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&V.instance.bxi(),0<m.AFrameworkApplication.Npf&&this.hke(),this.Xtj(),ba=!0);m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&ba&&P.instance.$wi();
m.AFrameworkApplication.JRj&&(ba=V.instance,ba.I8i(),ba.jxi(),E.a.instance.Hg(this.KRj))}Xtj(){F.instance.tSc(Object(c.a)(V.instance,V.instance.cxi,"makeGetMruRequestActivityTrigger"));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&F.instance.tSc(Object(c.a)(V.instance,V.instance.axi,"makeGetMruForRecentLinksRequestActivityTrigger"));F.instance.tSc(Object(c.a)(this,this.hke,"addGetMruFromServerTask"));F.instance.iBg(Object(c.a)(this,this.zch,
"deleteGetMruFromServerTask"))}zch(){E.a.instance.Hp(this.Opf)}hke(){E.a.instance.Hg(this.Opf)}get Opf(){return this.ede||(this.ede=new K.a(5,2,m.AFrameworkApplication.Npf,Object(c.a)(V.instance,V.instance.kRh,"getMruFromServerTask"),109))}get KRj(){return this.elb||(this.elb=new K.a(2,2,6E4*m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(V.instance,V.instance.kxi,"makeUpdateMruTask"),197))}dispose(){this.zm||(this.zm=!0,this.elb&&
(E.a.instance.Hp(this.elb),this.elb=null))}}Object(t.a)(wa,"CorePackageManager",null,[4,5,3]);var ma=a(246);a.d(D,"a",function(){return ab});const ab=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");ma.a.instance.Ii(new wa)}},1159:function(t,D,a){t=a(0);var c=a(4),b=a(220),d=a(15),f=a(83),e=a(53),k=a(192);class l{constructor(){this.Vee=this.WOc=!1;const Ja=c.AFrameworkApplication.gk;0>=Ja||(this.gk=Ja,d.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.gk,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Aga}),k.a.instance.QTc(Object(f.a)(this,this.$Na,"onSessionExpiredDetected")),k.a.instance.OTc(Object(f.a)(this,this.vBf,"onSessionExpiringDetected")))}$Na(){k.a.instance.qId(Object(f.a)(this,this.$Na,"onSessionExpiredDetected"));d.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.b3h()}vBf(){k.a.instance.pId(Object(f.a)(this,this.vBf,"onSessionExpiringDetected"));this.Vee||this.WOc||(d.ULS.sendTraceTag(20492680,
217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Vee=!0,this.IAj())}b3h(){this.WOc||(c.AFrameworkApplication.UF(e.a.Vtc),this.WOc=!0,this.HAj())}}Object(t.a)(l,"ASessionExpirationManager",null,[]);var m=a(86),v=a(38),n=a(31),w=a(14),r=a(43),u=a(249),x=a(6),z=a(81),B=a(252),y=a(68);class A extends l{constructor(Ja){super();this.Qa=new v.a;this.dH=this.alb=!1;this.$=Ja}Dme(Ja){this.Qa.addHandler("SessionExpired",Ja)}VXb(Ja){this.Qa.addHandler("TokenRefreshed",Ja)}dId(Ja){this.Qa.removeHandler("TokenRefreshed",
Ja)}get accessTokenExpiringMessage(){const Ja=(new Date(this.gk)).format(this.$.ya.ShortTimeFormat);return String.format(w.a.instance.mb(78),Ja)}get tokenExpired(){return this.alb}get vcb(){return!1}get dba(){return!1}get mGd(){return!1}get G4(){return!1}Jbc(){return k.a.instance.CQ(c.AFrameworkApplication.gk)}dispose(){m.a.Ia(this.Qa);this.$=null}IAj(){this.$.isEditMode&&this.jbc(!1)}HAj(){this.alb=!0;this.jbc(!0);this.Qa.raiseEvent("SessionExpired")}jbc(Ja){d.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${Ja}, GotDeploymentOrTimedOutError ${this.$.ea.x3}`);
const $a=this.$.rb.To;Ja&&$a&&$a.isVisible&&1299163859===$a.error.MessageId&&this.$.rb.To.Rt();const rb=this.Yc(Ja);r.a(this.$).ks(new u.a(x.a.Ox,5,()=>{const Pa=y.a(this.$),eb=Pa.fd.activityState;eb[z.a.w1]=this.$.fob(this.$.isEditMode);eb[z.a.WL]=z.a.q8a;eb[B.a.lq]=x.a.accessTokenExpiringWarning;Pa.fd.Kt([rb])}))}Yc(Ja){return Ja?n.a.wDe():this.g9g()}g9g(){const Ja=n.a.Yc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");Ja.Description=this.accessTokenExpiringMessage;return Ja}}Object(t.a)(A,
"EwaAccessTokenExpirationManager",l,[443,173,3]);var K=a(7),G=a(171),T=a(80),W=a(637),P=a(28);class E{constructor(Ja,$a){this.JGb=!1;this.correlationID=Ja;this.X2c=$a;this.Hyc=!1;this.creationTime=P.a.Wa.Nb}}Object(t.a)(E,"RefreshAccessTokenContext",null,[]);var H=a(58),F=a(62),N=a(172),J=a(45),R=a(110),M=a(118),L=a(1),U=a(22),X=a(140),da=a(35),fa=a(115);class S{}Object(t.a)(S,"Error",null,[]);class ka{}Object(t.a)(ka,"NamedResult",null,[]);class V extends ka{}Object(t.a)(V,"ErrorInfo",ka,[]);class wa{constructor(Ja,
$a){this.MVb=Ja;this.tS=$a}get tokens(){return this.MVb}get errors(){return this.tS}}Object(t.a)(wa,"TokenRefreshArgs",null,[471]);class ma{constructor(Ja,$a){this.documentVisibilityObserver=null;this.Qa=new v.a;this.tx=null;this.gdb=this.$jb=!1;this.Zpc=null;this.QGb=!1;this.etd=!0;this.j9d=this.J8d=this.dH=this.alb=!1;this.mS=null;this.x4e=()=>{if(!this.q8b||this.q8b&&this.$.ea.hc)this.Y4e(!1);else if(this.etd){this.etd=!1;const rb=y.a(this.$);d.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${rb.oi?
rb.oi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.A8f()}]`)}};this.Xc=(rb,Pa)=>{this.context&&(rb=this.$.ea,Pa.zH&&this.context.JGb&&!this.context.Hyc?(this.context.Hyc=!0,Pa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Pa.IsUserActive=rb.hf.$r,Pa.RefreshAccessTokenCorrelationID=this.context.correlationID,Pa=H.a.Ac(Pa),d.ULS.sendTraceTag(537170708,0,50,Pa)):this.q8b&&this.$jb&&!rb.hc&&!this.context.X2c&&(Pa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
this.tx&&(this.tx.cancel(),Pa.Aborted=!0,L.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(Pa.ResetStopRefreshRetriesUntilTokenExpired=!0,this.gdb=!1)),Pa.TimeUntilTokenExpirationInMin=this.A8f(),Pa.RefreshAccessTokenCorrelationID=this.context.correlationID,Pa=H.a.Ac(Pa),d.ULS.sendTraceTag(572019856,0,50,Pa)))};this.Yxa=()=>{if(this.context&&this.context.JGb&&!this.context.Hyc){var rb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};rb.CreatedForExpired=
this.context.X2c;rb.RefreshAccessTokenCorrelationID=this.context.correlationID;rb.OpenWorkbookErrors=n.a.zc(this.$.ea.JF);rb.ExecutionContextErrors=n.a.zc(y.a(this.$).fd.errors);rb.accesstokenTTL=c.AFrameworkApplication.gk;rb=H.a.Ac(rb);d.ULS.sendTraceTag(537170707,0,15,rb)}};this.X4e=()=>{this.gdb=!1;this.Y4e(!0)};this.yAd=()=>{this.QGb&&(this.$.ea.hf.zPa(this.yAd),this.QGb=!1);this.V4f()};this.$=Ja;this.QUd=$a;this.kGd=Ja.Hb.Ng("WebServiceCall","refreshToken");this.q8b=L.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
k.a.instance.QTc(this.X4e);k.a.instance.OTc(this.x4e);$a=this.$.ea;$a.hk(this.Xc);$a.XXb(this.Yxa);this.Izi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.t0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.mMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.gdg(Ja.ea.uEf,c.AFrameworkApplication.gk);Ja={["AccessTokenTtl"]:c.AFrameworkApplication.gk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Aga,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.AZd,
["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.CZd};d.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${Ja}`);this.$.da.Za(291,rb=>{this.documentVisibilityObserver=rb})}Dme(Ja){this.Qa.addHandler("SessionExpired",Ja)}VXb(Ja){this.Qa.addHandler("TokenRefreshed",Ja)}dId(Ja){this.Qa.removeHandler("TokenRefreshed",Ja)}get tokenExpired(){return this.alb}get dba(){return this.J8d}get G4(){return this.j9d}get context(){return this.mS}get vcb(){return this.G4?
!1:this.$.ea.hf.$r?1>fa.a.i5:6>fa.a.j5}get mGd(){return this.$jb}Jbc(){return k.a.instance.CQ(c.AFrameworkApplication.gk)}dispose(){k.a.instance.qId(this.X4e);k.a.instance.pId(this.x4e);const Ja=this.$.ea;Ja&&(Ja.Hk(this.Xc),Ja.drc(this.Yxa));m.a.Ia(this.Qa);this.documentVisibilityObserver=this.$=null}A8f(){return this.Jbc()?0:(c.AFrameworkApplication.gk-(new Date).getTime())/6E4}gdg(Ja,$a){if(0<$a&&!this.Jbc()){const rb=c.AFrameworkApplication.fa.nd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.uX),
Pa=($a-Ja.getTime())/6E4;d.ULS.shipAssertTag(537170713,0,0<=Pa,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${$a}] creationTime [${Ja.getTime()}] tokenLifetimeInMin [${Pa}]`);Pa<this.Izi?(d.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.t0f}] tokenLifetimeInMin [${Pa}]`),c.AFrameworkApplication.uX=this.t0f):
c.AFrameworkApplication.uX!==rb&&(d.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${rb}] tokenLifetimeInMin [${Pa}]`),c.AFrameworkApplication.uX=rb)}}A3g(Ja){return!this.context||this.context.JGb||this.context.X2c!==Ja?(Ja=new E(G.a.create().toString(),Ja),this.context&&!this.context.Hyc&&d.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${Ja.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.JGb}] `),
this.mS=Ja,!0):!1}bfj(Ja){Ja&&this.dH&&!this.dba&&this.$.ea.hf.$r&&!this.G4&&(this.dH=!1)}Y4e(Ja){this.bfj(Ja);if(!(this.$jb||this.gdb&&!Ja||this.dH)&&this.vcb){this.$jb=!0;var $a=this.context?this.context.creationTime:null,rb=this.A3g(Ja);this.etd=!0;var Pa=this.$.ea,eb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};eb.newContextCreated=rb;eb.IsUserActive=Pa.hf.$r;eb.IsSessionActive=Pa.hc;eb.ContainsChangesWorkbookOperations=this.$.userOperationManager.GGa();eb.isSessionExpired=
Ja;eb.stopRefreshRetriesUntilTokenExpired=this.gdb;eb.FailedToRefreshExpiredToken=this.dH;eb.numOfFailuresWhileUserIsActive=fa.a.i5;eb.numOfFailuresWhileUserIsInActive=fa.a.j5;eb.numOfFailuresWhileOffline=fa.a.Fxa;eb.RefreshAccessTokenCorrelationID=this.context.correlationID;rb&&$a&&(eb.TimeInMinFromPreviosContextCreation=Math.round(M.b(P.a.Wa,$a)/60));$a=H.a.Ac(eb);d.ULS.sendTraceTag(40416199,0,50,$a);this.kGd.start();this.J8d=Pa.hf.$r;this.tx=new W.a;this.iri(Ja);var Ob=this.QUd.z6i(!Ja,this.tx?
this.tx.token:null);Ob.continueWith(()=>{this.eXg();const tb=this.QUd.E0i(Ob);this.kGd.stop();const cc=this.Jbc();if(!tb||L.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&cc){const Ib=Ob.result.errors;tb&&cc&&this.pAg(Ib);this.J2h(Ib,Ja)}else this.gdb=!1,this.L2h(Ob.result.tokens,Ja);this.$jb=!1},this.q8b?8:0)}}pAg(Ja){const $a=[Object(K.a)(new S,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];Ja.add(Object(K.a)(new V,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:$a}))}iri(Ja){Ja&&(this.$.ea.hf.$r?this.V4f():(this.$.ea.hf.dra(this.yAd),this.QGb=!0))}V4f(){this.Zpc=N.AsyncMethodContext.hr(()=>{this.y6i()},1E3*this.mMf,J.a.f6i,this.Zpc)}eXg(){this.Zpc&&this.Zpc.cancel();this.QGb&&(this.$.ea.hf.zPa(this.yAd),this.QGb=!1);this.tx=null}y6i(){d.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.mMf}]`);this.tx.cancel()}J2h(Ja,$a){this.gdb=!0;$a&&(this.dH||(this.alb=this.dH=
!0),this.QUd.Hfc(Ja)&&(this.j9d=!0));const rb=!$a||this.vcb&&!fa.a.Dvc?40380379:39982555;$a=this.YBe($a);$a.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";$a.FailedToRefreshExpiredToken=this.dH;$a.LastErrorIsPermanent=this.G4;if(0<Ja.count){var Pa=Ja.na(0);$a.errorName=Pa.Name;0<Pa.Errors.length&&($a.ErrorId=Pa.Errors[0].Id,Pa=Pa.Errors[0].Details,$a.ErrorDetails=this.Ggh(Pa.toString())?"PiiScrubbed":Pa)}$a=H.a.Ac($a);d.ULS.sendTraceTag(rb,0,15,$a);this.Qa.raiseEvent("TokenRefreshed",
new wa(null,Ja))}Ggh(Ja){return U.a.contains(Ja,"makes the internet safe for businesses",!0)}YBe(Ja){const $a={},rb=this.$.ea;$a.Name="";$a.IsUserActive=rb.hf.$r;$a.IsSessionActive=rb.hc;$a.GotDeploymentOrTimedOutError=rb.x3;$a.TimeInSecFromLastStatefulSuccessfulRequest=rb.k0;$a.TimeFromLastUserActivityInMs=rb.hf.rMb;$a.calledFromSessionExpiredFlow=Ja;$a.RefreshTokenDurationInMS=this.kGd.tc;$a.numOfFailuresWhileUserIsActive=fa.a.i5;$a.numOfFailuresWhileUserIsInActive=fa.a.j5;$a.numOfFailuresWhileOffline=
fa.a.Fxa;$a.RefreshAccessTokenCorrelationID=this.context.correlationID;$a.accessTokenTTL=c.AFrameworkApplication.gk;$a.ContainsChangesWorkbookOperations=this.$.userOperationManager.GGa();$a.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Ei.toString():"Unknown";$a.TimeFromFirstOpenInHr=Math.floor(M.b(P.a.Wa,R.toUtc(rb.uEf))/3600);return $a}L2h(Ja,$a){this.dH=!1;this.oTj();this.gdg(new Date,c.AFrameworkApplication.gk);const rb=this.$.ea,Pa=!$a&&rb.hf.$r,eb=!this.$.isEditMode&&
rb.$$a;$a=this.YBe($a);$a.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";$a.shouldTriggerSilentReloadAfterExpiring=Pa;$a.WopiTokenTaskItemPriority=c.AFrameworkApplication.CZd;$a.isDirtyViewSession=eb;$a=H.a.Ac($a);d.ULS.sendTraceTag(39982556,0,15,$a);this.Qa.raiseEvent("TokenRefreshed",new wa(Ja,null));eb?rb.hf.$r&&(d.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
rb.S$c()):rb.hf.$r?Pa&&(Ja=y.a(this.$).fd.activityState,Ja[fa.a.Ydb]=!0,Ja[X.a.yX]=!0,Ja[da.a.Dr]=this.$.isEditMode,r.a(this.$).ks(new u.a(x.a.Hma,2,null))):rb.hc&&F.j(this.$.pa.va,!0,!1,!1,null,null,null,null,null)}oTj(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=T.a.YS(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.ZO,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=
T.a.YS(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.vX,c.AFrameworkApplication.gk.toString()),this.$.ea.fnc()):d.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.gk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
T.a.YS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.ZO,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=T.a.YS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.vX,c.AFrameworkApplication.gk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=T.a.YS(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.ZO,c.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=T.a.YS(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.vX,c.AFrameworkApplication.gk.toString()));this.context.JGb=!0}}Object(t.a)(ma,"EwaAccessTokenExpirationRefreshManager",null,[443,173,3]);var ab=a(184),ba=a(156);class Ca{}Ca.QWb="ActivityDuration";Ca.error="Error";Ca.elh="Errors";Ca.failed="Failed";Ca.lAh="FirstActivity";Ca.initialized="Initialized";Ca.rpi="LastActivity";Ca.Rgj="RetryOverride";Ca.Cej="RequestGroups";Ca.requests="Requests";Ca.ASf="Responses";
Ca.Wtc="SessionDuration";Ca.status="Status";Ca.success="Success";Ca.rna="Successful";Ca.tokens="Tokens";Object(t.a)(Ca,"SessionExpirationStrings",null,[]);var Na=a(107);class za{constructor(Ja){this.Jo={};this.OW={};this.mtg={};this.Vkf=15;this.E8d=!1;this.Yug=new Date;this.tSb=new Date;this.ee=Ja;this.CVb=new Na.a(2,2,6E4*this.Vkf,Object(f.a)(this,this.$fg,"writeMeasures"),135,"SL",!1);this.ee.Hg(this.CVb);this.y$h()}$fg(){d.ULS.sendTraceTag(41964821,217,50,d.ULS.Ac({["Aggregate"]:this.OW,["Current"]:this.Jo}))}y$h(){this.OW[Ca.Cej]=
0;this.OW[Ca.requests]=0;this.OW[Ca.ASf]=0;this.OW[Ca.status]=Ca.initialized;this.OW[Ca.lAh]=new Date;this.OW[Ca.Wtc]=0;this.OW[Ca.QWb]=0;this.OW[Ca.Wtc]=0;this.Jo[Ca.Wtc]=0;this.OW[Ca.QWb]=0;this.Jo[Ca.QWb]=0}mjd(Ja,$a){var rb=Ja[$a];rb=rb?rb:0;rb++;Ja[$a]=rb;this.zNd(Ja)}zNd(Ja){const $a=new Date;Ja[Ca.QWb]=+$a-+this.tSb;this.tSb=$a;Ja[Ca.Wtc]=+this.tSb-+this.Yug;Ja[Ca.rpi]=this.tSb}$bb(Ja,$a){this.Jo[Ja]=$a;this.zNd(this.Jo)}RXf(Ja,$a){this.Jo[Ja]=$a;this.zNd(this.Jo)}incrementCounter(Ja){this.mjd(this.Jo,
Ja);this.mjd(this.OW,Ja);this.mjd(this.mtg,Ja)}flush(){this.E8d||(this.OW[Ca.status]=this.Jo[Ca.status],this.$fg(this.CVb),this.ee.nma(this.CVb,6E4*this.Vkf))}stop(){d.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.E8d=!0;this.ee.Hp(this.CVb)}}Object(t.a)(za,"SessionLogger",null,[530]);var la=a(98),aa=a(638),sa=a(370),ea=a(163),Z=a(934),ua=a(185),ya=a(165);class ha{constructor(Ja,$a,rb,Pa=null,eb=!1,Ob=null,tb=!1){this.qqa=0;this.Ffa=this.Ni=null;this.MVb=
new ab.a;this.tS=new ab.a;this.fm=null;this.nSb=!1;this.ee=Ja;this.uce=$a;this.uce.execute(cc=>{cc.Vl(ea.a.jid,Object(f.a)(this,this.OLi,"onHostResponseReceived"))});this.s8=rb;this.Yge=new Z.a("WebServiceCall","TokenRefresh");this.ej=Pa||new za(Ja);this.Tug=eb;this.LS=Ob?Ob:aa.SessionStatusManager.instance;this.v4d=tb}OLi(Ja){if(Ja.MessageId!==ea.a.jid)ya.a(39408099,306,15,"Unexpected message.");else{var $a=new ab.a,rb=new ab.a;this.ej.incrementCounter(Ca.ASf);var Pa=Ja.Values[sa.a.WWf];if(!Pa||
0>=Pa.length)ya.a(40122317,306,15,"Found no tokens in the dictionary"),Pa=Ja.Values;ya.a(40122318,306,100,"The Tokens array contains {0} tokens",Pa.length);this.ej.$bb("Correlation",Ja.CorrelationId);var eb="";for(let cc=0;cc<Pa.length;cc++){this.ej.RXf(Ca.tokens,Pa.length);var Ob=Pa[cc],tb=Ob;if(!tb||!tb.Name)continue;this.ej.incrementCounter(tb.Name);const Ib=Ob;if(Ib&&Ib.Value)ya.a(39408128,306,100,"Received token with name: {0}",Ib.Name),$a.add(Ib),this.MVb.add(Ib),this.ej.$bb(Ca.status,Ca.success),
this.v4d&&this.LS&&this.LS.Cfj();else if(Ob=this.IVh(Ob),ya.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",tb.Name,JSON.stringify(Ob),this.Ffa),rb.add(Ob),this.tS.add(Ob),eb=JSON.stringify(Ob),this.ej.$bb(Ca.error,JSON.stringify(Ob)),this.ej.$bb(Ca.status,Ca.failed),this.v4d)for(const Mb of Ob.Errors)tb=this.CMh(Mb),this.LS&&this.LS.JCg(tb)}0<rb.count&&""!==eb?(Pa=Object.assign(new ua.a,{extendedProperties:new Map}),Pa.extendedProperties.set("Errors",
eb),la.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Pa)):la.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ya.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",$a.count,rb.count,Ja.CorrelationId,this.Ffa);0<rb.count&&!this.Hfc(rb)?(Ja=this.s8.bVh(rb),Ja!==this.s8.uKd&&(this.ej.RXf(Ca.Rgj,Ja),this.ee.nma(this.Ni,Ja))):(this.ej.flush(),this.Ni&&(ya.a(39408131,306,100,"Deleting task {0} from task manager",
this.Ni.name),this.ee.Hp(this.Ni)),this.fm&&!this.fm.task.isCompleted&&this.fm.setResult(new wa($a,rb)))}}IVh(Ja){if(!Ja)return null;const $a=Object.assign(new V,{Name:Ja.Name,Errors:[]});for(const rb of Ja.Errors)Ja=new S,Ja.Id=rb.Id,Ja.Details=this.HVh(rb.Details),$a.Errors.push(Ja);return $a}HVh(Ja){if(!Ja)return"";const $a=Ja.toString().toLowerCase();return 0<$a.indexOf("<!doctype")?this.ted("Seems to contain HTML - Contains <!DOCTYPE"):0<$a.indexOf("<html")?this.ted("Seems to contain HTML - Contains <html>"):
500<$a.length?this.ted(String.format("Error details content too long: Length: {0}",$a.length)):Ja}ted(Ja){return String.format("{0} - Reason: [{1}]","### REDACTED ###",Ja)}requestTokensOnce(){this.JRf()}JRf(){c.AFrameworkApplication.Aic("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.qqa>=this.s8.Gyi?(ya.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Ffa),this.dCe(this.fm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):
(la.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Jlj())}Jlj(){const Ja={};Ja[sa.a.WWf]=this.s8.tokens;const $a=G.a.create().toString();ya.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.s8.tokens),this.qqa+1,$a,this.Ffa);this.uce.execute(rb=>{rb.Fj(ea.a.Toe,Ja,$a)});this.qqa++;this.ej.incrementCounter(Ca.requests)}dCe(Ja,$a,rb){const Pa=new ab.a;for(let eb=0;eb<this.s8.tokens.length;eb++){const Ob=Object.assign(new V,
{Name:this.s8.tokens[eb],Errors:[Object.assign(new S,{Id:$a,Details:rb})]});Pa.add(Ob);this.tS.add(Ob)}this.ee.Hp(this.Ni);this.ej.$bb(Ca.elh,JSON.stringify(this.tS));this.ej.$bb(Ca.status,Ca.failed);Ja&&!Ja.task.isCompleted&&Ja.setResult(new wa(new ab.a,this.tS))}z6i(Ja,$a=null){this.Yge.start();this.nSb=Ja;this.Ffa=G.a.create().toString();ya.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Ffa,this.nSb);this.qqa=0;this.tS.clear();this.MVb.clear();const rb=new ba.a;
this.fm=rb;$a&&$a.R(()=>{const Pa=!!rb&&!rb.task.isCompleted;ya.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.Ffa,this.nSb,Pa);Pa&&this.dCe(rb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Ni=new Na.a(this.s8.priority,2,this.s8.uKd,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ea.a.Toe,!0);this.Tug&&this.JRf();this.ee.Hg(this.Ni);return this.fm.task}E0i(Ja){this.Yge.stop();const $a=this.U3h(Ja.result.errors);
d.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!$a,this.Ffa,this.nSb,this.qqa,this.tS.count,0<Ja.result.errors.count?Ja.result.errors.na(0).Name:"",0<Ja.result.errors.count&&0<Ja.result.errors.na(0).Errors.length?Ja.result.errors.na(0).Errors[0].Id:"",0<Ja.result.errors.count&&0<Ja.result.errors.na(0).Errors.length?Ja.result.errors.na(0).Errors[0].Details:
"");return $a?!1:this.D0i(Ja.result.tokens)}Hfc(Ja){return this.s8.Hfc(Ja)}D0i(Ja){for(let $a=0;$a<Ja.count;$a++){const rb=Ja.na($a);if(rb.Name===sa.a.accessToken){const Pa=(new Date).getTime();rb.Expiry>c.AFrameworkApplication.gk?(d.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:rb.Expiry,["NowGetTime"]:Pa,["BootTime"]:c.AFrameworkApplication.Aga},"PreviousAccessTokenTtl",c.AFrameworkApplication.gk),c.AFrameworkApplication.accessToken=rb.Value,c.AFrameworkApplication.gk=
Math.floor(rb.Expiry),c.AFrameworkApplication.BZd=Pa,c.AFrameworkApplication.jXa=Math.floor(rb.Expiry)):d.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:rb.Expiry,["NowGetTime"]:Pa,["BootTime"]:c.AFrameworkApplication.Aga},"PreviousAccessTokenTtl",c.AFrameworkApplication.gk)}}return!0}U3h(Ja){let $a=!1;for(let rb=0;rb<Ja.count;rb++){$a=!0;const Pa=Ja.na(rb);d.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
Pa.Name,JSON.stringify(Pa.Errors),this.Ffa)}return $a}CMh(Ja){let $a=e.a.Vtc;Ja=parseInt(Ja.Id);if(isNaN(Ja))$a=e.a.MWj;else{switch(Ja){case 401:$a=e.a.PWj;break;case 403:$a=e.a.KWj;break;case 500:$a=e.a.LWj;break;case 503:$a=e.a.OWj}$a===e.a.Vtc&&($a=500<Ja?e.a.NWj:e.a.JWj)}return $a}}Object(t.a)(ha,"TokenRefreshManager",null,[445]);class Da{constructor(){this.uKd=c.AFrameworkApplication.SWj;this.Gyi=c.AFrameworkApplication.QWj;this.tokens=c.AFrameworkApplication.E_h();this.priority=c.AFrameworkApplication.CZd;
this.Gde=this.Erj();this.rRc=c.AFrameworkApplication.D_h()}Hfc(Ja){Ja=JSON.stringify(Ja);if(this.rRc&&0<this.rRc.length)for(const $a of this.rRc)if(0<$a.length&&0<=Ja.indexOf($a))return!0;return!1}bVh(Ja){try{if(Ja)for(let $a of Ja)if($a.Errors)for(const rb of $a.Errors)if(rb.Id in this.Gde)return Number.parseInvariant(this.Gde[rb.Id].toString())}catch($a){d.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",$a.toString())}return this.uKd}Erj(){const Ja=
{};try{if(!c.AFrameworkApplication.Tac()||0>=c.AFrameworkApplication.Tac().length||""===c.AFrameworkApplication.Tac()[0])return Ja;for(const $a of c.AFrameworkApplication.Tac())0<$a.length&&(Ja[$a]=c.AFrameworkApplication.RWj)}catch($a){d.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",$a.toString())}return Ja}}Object(t.a)(Da,"TokenRefreshPolicy",null,[444]);class nb extends b.a{constructor(Ja){super();this.$=Ja;this.Fb()}create(){c.AFrameworkApplication.dN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.qb(this.u5g()):this.qb(this.$.da.za(38)||this.$.da.Ga(38,new A(this.$)))}u5g(){var Ja=this.$.da.za(38);if(Ja)return Ja;Ja=new ha(c.AFrameworkApplication.Ji,c.AFrameworkApplication.GU(),new Da);return this.$.da.Ga(38,new ma(this.$,Ja))}static ka(Ja){Ja.da.Ga(39,new nb(Ja))}}Object(t.a)(nb,"AccessTokenExpirationManagerFactory",b.a,[]);var qa=a(10);a.d(D,"a",function(){return pa});const pa=()=>{qa.a.Fa(nb.ka)}},1191:function(t,D,a){t=a(0);
var c=a(83),b=a(144);class d extends b.a{constructor(y){super(!1,!1,!0);this.LOb=y}start(){const y={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.LOb.pid}};this.initializeAndShow("",Object(c.a)(this,this.Bgj,"resultHandler"),y)}Bgj(y,A){1===y&&(this.LOb.pid=A.tooltipPersistenceEnabled)}}Object(t.a)(d,"AccessibilitySettingsDialog",b.a,[]);var f=a(106),e=a(25);class k{constructor(y,A){this.La=y;this.LOb=A}Fg(){this.La.Ob(e.a.eyj,f.a.frame,Object(c.a)(this,
this.fyj,"showAccessibilitySettingsDialogHandler"))}fyj(){(new d(this.LOb)).start();return 32}}Object(t.a)(k,"AccessibilitySettingsDialogActor",null,[252]);var l=a(156),m=a(4);const v=y=>{const A=new l.a;m.AFrameworkApplication.rd.hm(n(y),1,null,null,!0,2,K=>{200===K.data.httpStatus?A.setResult("true"===K.data.Td.toLowerCase()):A.setResult(!1)},()=>{A.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return A.task},n=y=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||
"",y,m.AFrameworkApplication.gj);var w=a(160);class r{constructor(){this.gVa=null}get pid(){return!!this.gVa}set pid(y){y!==this.gVa&&(this.gVa=y,w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(y),this.mff()&&m.AFrameworkApplication.rd.hm(n("saveHoverableRibbonTooltipIsEnabled"),2,y.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Ori(){const y=new l.a;if(this.gVa)y.setResult(this.gVa);else if(this.mff()){const A=v("getHoverableRibbonTooltipIsEnabled");
A.continueWith(()=>{this.gVa=A.result;w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A.result);y.setResult(A.result)},8)}else y.setResult(!1)}mff(){const y=m.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),A=m.AFrameworkApplication.fa.qa("IsAnonymousUser");return y&&!A}}Object(t.a)(r,"AccessibilitySettingsInfo",null,[242]);var u=a(246),x=a(165);class z{constructor(){this.gb=null}get name(){return"Common.App.AccessibilitySettings"}ai(y){this.gb=y;this.gb.register(r,
"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Gc(()=>new r).uc();this.gb.register(k,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Gc(()=>new k(m.AFrameworkApplication.wb,this.gb.uh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).uc()}init(){const y=this.gb.uh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),
A=this.gb.uh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");y&&A?(A.Fg(),y.Ori()):x.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){u.a.instance.Ii(new z)}}Object(t.a)(z,"AccessibilitySettingsPackage",null,[4,5]);a.d(D,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");z.main()}},1192:function(t,D,a){var c=a(10);
t=a(0);var b=a(220),d=a(15),f=a(86),e=a(27),k=a(412),l=a(1118),m=a(516),v=a(183),n=a(222),w=a(24),r=a(64),u=a(42),x=a(162),z=a(239),B=a(47),y=a(45),A=a(12),K=a(70),G=a(127),T=a(1),W=a(11),P=a(21),E=a(338),H=a(235),F=a(13),N=a(155),J=a(93),R=a(5),M=a(248),L=a(77),U=a(97),X=a(43),da=a(33);class fa extends J.a{constructor(ua,ya,ha,Da){super(ua);this.k7f=[6];this.c7f=[26];this.Ir=null;this.Eyb=this.Hgc=!1;this.Xr=this.naa=null;this.k4=!1;this.onPointerDown=nb=>{if(1!==this.$.Ka.nH())return!0;nb=da.a(this.$).Ud(nb);
if(this.mB)return!0;var qa=X.a(this.$).Mmd||X.a(this.$).Qp();if(this.Uod||qa)return this.Yab(),!0;this.Xr=this.Zl;this.cHd();this.Thd();qa=2===nb.tb&&nb.Tn===Sys.UI.MouseButton.leftButton;const pa=3===nb.tb;if(qa||pa)nb=this.ha.Vn(nb.clientPoint,nb.Cb,5,void 0,void 0,!0),nb||(nb=this.Xr),this.Eyb=qa,this.Hgc=pa,this.Xr=this.m2e(nb),this.Thd(),qa?this.L7i():pa&&this.B8i(),M.b(this.$,!0);return!0};this.Fh=nb=>{nb=da.a(this.$).Ud(nb);if(!this.mB)return!1;let qa=this.Eyb?this.ha.Vn(nb.clientPoint,nb.Cb,
5,void 0,void 0,!0):this.ha.Vn(nb.clientPoint,nb.Cb,5,!0,!1,!0);this.k4&&!qa&&(qa=this.ha.Ymb(nb.clientPoint,nb.Cb,5));qa&&(nb=this.m2e(this.eYa(qa)),this.k_b(nb.bottomRight),this.Xr.equals(nb)||(this.Xr=nb,this.dHb(!1),this.cHd(!1),this.Thd(!1),this.N5h(),this.ob.update(!1)),this.rQj(this.Xr));return!0};this.Kf=nb=>{da.a(this.$).Ud(nb);if(!this.mB)return!1;this.resizeTable();this.Yab();return!0};this.tEb=nb=>{da.a(this.$).Ud(nb);if(!this.mB)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),
!1;this.resizeTable();this.Yab();return!0};this.Qba=nb=>{da.a(this.$).Ud(nb);this.Yab();return!0};this.Ctf=()=>{this.mB&&this.Yab()};this.gridView=ya;this.$=ya.$;this.tableManager=Da;this.ha=ya.ha;this.ob=ya.ob;this.parentElement=ua;this.$Qg();e.a.jp||e.a.Qja||H.a.instance.ra(F.a.pointerDown,this.naa,this.onPointerDown);this.Zl=ha;this.TJc=this.Uod=!1;this.tableManager.qDg(this.Ctf);this.k4=T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewTableResizeExperience",!1)}get mB(){return this.Eyb||
this.Hgc}get lgf(){return this.TJc}dispose(){this.Yab();this.tableManager.G$i(this.Ctf);this.lgf||e.a.jp||e.a.Qja||H.a.instance.Ba(F.a.pointerDown,this.naa,this.onPointerDown);if(this.mB){M.b(this.$,!1);try{this.Fv()}catch(ua){d.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ua}`)}}this.parentElement&&this.parentElement.contains(this.naa)&&this.parentElement.removeChild(this.naa);this.naa=this.parentElement=null;super.dispose()}m2e(ua){const ya=
ua.bottom-this.Zl.topLeft.bottom-1;return 0<=ua.right-this.Zl.topLeft.right+1&&0<=ya&&ua.bottom>=this.Zl.top&&ua.right>=this.Zl.left?new w.Range(this.Zl.top,this.Zl.left,ua.bottom,ua.right,!1,!1):this.Xr}Thd(ua=!0){this.yuc([this.Xr],6,ua);this.ob.Bn(this.k7f)}dHb(ua=!0){this.ob.Tg(this.k7f);this.yuc([null],6,ua)}cHd(ua=!0){this.ob.Tg(this.c7f);this.yuc([null],26,ua)}N5h(){const ua=this.YGj();0<ua.length&&(this.yuc(ua,26,!1),this.ob.Bn(this.c7f))}YGj(){const ua=[];this.Zl.contains(this.Xr)&&(this.Zl.right!==
this.Xr.right&&ua.push(new w.Range(this.Zl.top,this.Xr.right+1,this.Xr.bottom,this.Zl.right,!1,!1)),this.Zl.bottom!==this.Xr.bottom&&ua.push(new w.Range(this.Xr.bottom+1,this.Zl.left,this.Zl.bottom,this.Zl.right,!1,!1)));return ua}resizeTable(){if(!this.Xr.equals(this.Zl)){const ua=new w.Range(this.Zl.top,this.Zl.left,this.Xr.bottom,this.Xr.right,!1,!1);this.PLj(ua);this.Uod=!0}}onKeyDown(ua){da.a(this.$).Ud(ua);return!0}V8a(){this.lgf&&(e.a.jp||e.a.Qja||(H.a.instance.ra(F.a.pointerDown,this.naa,
this.onPointerDown),this.naa.classList.remove("ewr-table-resize-default-cursor"),this.TJc=this.naa.disabled=!1),this.TJc=!1)}$Qg(){const ua=document.createElement("div");ua.className="ewr-table-resize-handle";const ya=document.createElement("div");ya.className="ewr-table-resize-fillhandle-higher";const ha=document.createElement("div");ha.className="ewr-table-resize-fillhandle-broader";ua.appendChild(ya);ua.appendChild(ha);this.naa=ua;this.parentElement.appendChild(this.naa)}k_b(ua){const ya=this.k4?
2:5;let ha=60;const Da=this.Xr.contains(ua);let nb=ua.top,qa=ua.bottom,pa=ua.left,Ja=ua.right,$a=null;if(Da){if(this.gridView.kK(this.Zl.topLeft)&&!this.Zl.MRa)return;this.k4?ua.bottom<this.Xr.bottom?(nb=Math.max(1,qa-ya,this.Zl.top),ha=16):(pa=Math.max(1,Ja-ya,this.Zl.left),ha=4):(nb=Math.max(1,qa-ya,this.Zl.top),pa=Math.max(1,Ja-ya,this.Zl.left));qa=nb;Ja=pa;$a=new w.Range(nb,pa,nb,pa,!1,!1)}else this.k4?ua.right>=this.Zl.right?(Ja+=ya,ha=8):ua.bottom>=this.Zl.bottom&&(qa+=ya,ha=32):(qa+=ya,Ja+=
ya),nb=qa,pa=Ja,$a=new w.Range(qa,Ja,qa,Ja,!1,!1),ha=16;this.gridView.kK($a)||(this.Ir?this.Ir.zq||(this.Ir=B.a.instance.create(()=>{this.gridView.Sr($a,ha,U.a.h7f)},40,y.a.i7f)):this.Ir=B.a.instance.create(()=>{this.gridView.Sr($a,ha,U.a.h7f)},40,y.a.i7f))}eYa(ua){let ya=ua;if(this.gridView.hb.D3){if(!this.gridView.Xb(ua.topLeft)){const ha=this.gridView.kk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.jH,this.Xr.top!==ua.top?1:2);try{ha.Dk=this.Xr.top<ua.top||this.Xr.left<ua.left,ha.ds(ua.topLeft),
ya=ha.$$cu().range}finally{ha&&ha.dispose()}}ya.right=ya.left+ua.width-1;ya.bottom=ya.top+ua.height-1}return ya}yuc(ua,ya,ha=!0){const Da=[];for(const nb of ua)Da.push(new E.a(nb,r.d(this.$.oa)));this.ob.yv(Da,[ya],!0,void 0,ha)}L7i(){this.k4&&H.a.instance.ra(F.a.zj,document.documentElement,this.Fh);for(const ua of this.gridView.sn)H.a.instance.ra(F.a.zj,ua.domElement,this.Fh);H.a.instance.ra(F.a.Mf,document.documentElement,this.Kf);this.BGe()}B8i(){this.k4&&N.a.instance.ra(F.a.Xf,document.documentElement,
this.Fh);for(const ua of this.gridView.sn)N.a.instance.ra(F.a.Xf,ua.domElement,this.Fh);N.a.instance.ra(F.a.te,document.documentElement,this.tEb);this.BGe()}Fv(){this.Eyb&&this.GOj();this.Hgc&&this.ROj()}GOj(){this.k4&&H.a.instance.Ba(F.a.zj,document.documentElement,this.Fh);for(const ua of this.gridView.sn)H.a.instance.Ba(F.a.zj,ua.domElement,this.Fh);H.a.instance.Ba(F.a.Mf,document.documentElement,this.Kf);this.kMf()}ROj(){this.k4&&N.a.instance.Ba(F.a.Xf,document.documentElement,this.Fh);for(const ua of this.gridView.sn)N.a.instance.Ba(F.a.Xf,
ua.domElement,this.Fh);N.a.instance.Ba(F.a.te,document.documentElement,this.tEb);this.kMf()}BGe(){this.k4||H.a.instance.ra(F.a.my,document.documentElement,this.Qba);this.gridView.dc.$5b(!0)}kMf(){this.k4||H.a.instance.Ba(F.a.my,document.documentElement,this.Qba);this.gridView.dc.$5b(!1)}PLj(ua){this.$.xd(-1400250766,L.a.Eb,30,{["ResizeTableRange"]:ua,["OriginalTableRange"]:this.Zl})}rQj(ua){if(!this.Zl.contains(ua)){ua=this.XGj();for(const ya of ua)if(this.tableManager.upd(ya)){this.gridView.Cf.Yl(R.a.ICi);
return}}this.gridView.rtl?this.gridView.Cf.Yl(R.a.PBi):this.gridView.Cf.Yl(R.a.XDi)}Yab(){if(this.mB){M.b(this.$,!1);try{this.Fv()}catch(ua){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ua}`)}}this.Ir&&(this.Ir.cancel(),this.Ir.dispose());this.Hgc=this.Eyb=!1;this.dHb();this.cHd();M.b(this.$,!1);this.gridView.Cf.Yl(R.a.kQ)}XGj(){const ua=[];this.Zl.right!==this.Xr.right&&ua.push(new w.Range(this.Zl.top,this.Zl.right+1,this.Xr.bottom,
this.Xr.right,!1,!1));this.Zl.bottom!==this.Xr.bottom&&ua.push(new w.Range(this.Zl.bottom+1,this.Zl.left,this.Xr.bottom,this.Zl.right,!1,!1));return ua}static createInstance(ua,ya,ha,Da){if(!ya)return null;const nb=ua.ob;nb.yv(ha,[27],!0);nb.Bn(fa.SGj);ha=nb.ev(27,ua.hb.jj(ya.bottomRight),fa.ULh(ya,ha)).tf;return new fa(ha,ua,ya,Da)}static ULh(ua,ya){var ha;for(let Da=0;Da<ya.length;Da++)if((null===(ha=ya[Da])||void 0===ha?0:ha.range)&&ya[Da].range.equals(ua))return Da;return 0}}fa.SGj=[27];Object(t.a)(fa,
"TableResizeBehavior",J.a,[]);var S=a(7);J=a(234);class ka{}ka.qrh="ewa-ttrd-buttonarea";Object(t.a)(ka,"CssClassNames",null,[]);var V=a(48),wa=a(131),ma=a(90),ab=a(22),ba=a(14),Ca=a(253),Na=a(132),za=a(261);class la extends J.a{constructor(ua){super(document.createElement("div"));this.VRc=this.Rld=this.PEf=this.mQ=!1;this.gJb=null;this.Dh=()=>{z.c(this.$,this.gridView.ha.sa.activeCell)?(this.ZKa=!0,this.dqb(!1)):(this.lZ=this.ZKa=!1,this.Zag())};this.mt=()=>{this.ZKa?this.dqb(!0):this.lZ=!1};this.Gtf=
()=>{this.VRc=!0;this.ZKa&&(this.lZ=!1)};this.onContentReady=()=>{this.$.isEditMode?z.c(this.$,this.gridView.ha.sa.activeCell)&&(this.ZKa=!0,this.dqb(!1)):this.lZ=!1};this.Mxa=()=>{this.VRc=!1;this.ZKa?this.dqb(!1):this.lZ=!1};this.mf=(ya,ha)=>{this.ZKa&&(ya=this.gridView.Bnc(ha.gd.block.se.BlockCachePosition.PaneType).rG(ha.gd.hash))&&(ya.vId(this.lKa),ya.XTc(this.lKa))};this.lKa=()=>{this.pQf()};this.$=ua;this.gridView=P.g(this.$);this.parentElement=this.domElement;this.parentElement.className=
ka.qrh;this.VJa=this.gridView.uj;this.ZKa=!0;this.f$h();this.rLg();this.dqb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get lZ(){return this.Rld}set lZ(ua){this.Rld!==ua&&(this.Rld=this.isVisible=ua)}get wzb(){return!!(this.$.Bd&16)}get iii(){const ua=this.gridView.ha.sa.activeCell;return ua.right===ua.maxColumns}get Alb(){const ua=this.gridView.Xb(null);return ua&&this.gridView.p4(ua.range)?this.Kua(ua):(ua&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),
null)}dispose(){this.$&&this.ndh();this.$=this.gridView=this.parentElement=this.VJa=null;super.dispose()}MJh(ua){const ya=this.KYh(this.gridView.Xb(null).range);return ya?`=SUBTOTAL(${ua},${ya})`:null}KYh(ua){var ya=P.g(this.$).Db.Xj(ua);if(!ya)return null;ya=x.a(ya,!1);ya.right=ya.left=ua.left;return ya.toString()}f$h(){la.bM={};la.bM["100"]=ba.a.instance.ga(1099);la.bM["101"]=ba.a.instance.ga(1102);la.bM["102"]=ba.a.instance.ga(1101);la.bM["103"]=ba.a.instance.ga(1106);la.bM["104"]=ba.a.instance.ga(1103);
la.bM["105"]=ba.a.instance.ga(1104);la.bM["109"]=ba.a.instance.ga(1100);la.bM["107"]=ba.a.instance.ga(1107);la.bM["110"]=ba.a.instance.ga(1109);la.bM["111"]=ba.a.instance.ga(1160)}zVi(){var ua=this.gridView.Xb(null);if(ua&&(ua=ua.fF?ua.formulaBarText:null))if("=SUBTOTAL("===ua.substring(0,10)){if(ua=ua.substring(10,13),ua in la.bM)return ua}else return"111";return"100"}rLg(){this.gridView.Ea.Ms(this.mf);this.gridView.ha.iJ(this.Dh);this.gridView.Nu(this.onContentReady);this.gridView.dc.Mk(this.Gtf);
this.gridView.dc.jm(this.Mxa)}ndh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.RK(this.Dh),this.gridView.Ea.Mq(this.mf)),this.gridView.qy(this.onContentReady),this.gridView.dc&&(this.gridView.dc.Gk(this.Gtf),this.gridView.dc.Al(this.Mxa)),this.Zag())}dqb(ua){this.CQj(ua);this.wzb&&(this.xFj(),this.Alb?(this.PEf||this.CLg(),this.VRc?this.lZ=!1:(this.lZ=!0,this.pQf())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.lZ=!1))}pQf(){appChrome.renderTableTotalRowOptions(this.parentElement,la.bM,la.bM[this.zVi()].toString(),Math.round(da.a(this.$).ni(17)),ua=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ua}`);let ya={["SelectedOption"]:la.bM[ua],["FunctionKeyCode"]:ua,["Location"]:"canvas"};Na.b(this.$).Cd(wa.a.bHj,ya,null,!0);if("111"===ua)return this.Eci(),!0;if("100"!==ua){this.gJb=this.MJh(ua);if(!this.gJb)return d.ULS.sendTraceTag(537151197,0,
50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.GQa(this.gJb)}else this.GQa("");A.DOMElementExtensions.setFocus(this.gridView.Wb.textBox.domElement);return!0})}Eci(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const ua=new ma.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(ua)}Kua(ua){if(!ua)return null;var ya=this.gridView.dc.textBox.domElement;var ha=0<A.DOMElementExtensions.getHeight(ya)&&
0<A.DOMElementExtensions.getWidth(ya)&&0<=ya.offsetTop&&0<=ya.offsetLeft;if(ha)ya=A.DOMElementExtensions.Kua(ya,this.gridView.uj);else{ya=this.gridView.getCellBounds(ua.cell);var Da=A.DOMElementExtensions.getBoundingClientRect(this.gridView.uj);ya=new Sys.UI.Bounds(ya.x-Da.x,ya.y-Da.y,ya.width,ya.height)}if(ya)if(ha)2<ya.height&&2<ya.height&&(ya.x+=1,ya.y+=1,ya.height-=2,ya.width-=2);else if(ha=P.g(this.$).SJ(ua.cell))ha=ha.width,Da=ab.a.equals(Ca.a.cub(ua.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&
Da&&(ya.x=ya.x+ya.width-ha),ua.bka&&this.gridView.rtl===Da&&(ya.width=ha);else return null;return ya}CQj(ua){var ya=this.Alb;if(ya){var ha=17>=ya.height?ya.y:ya.y+ya.height-17-2;ya=this.iii?this.gridView.rtl?ya.x:ya.x+ya.width-(17<ya.height?17:ya.height):this.gridView.rtl?ya.x-(17<ya.height?17:ya.height):ya.x+ya.width;var Da=da.a(this.$).Uia(new Sys.UI.Point(ya,ha));this.parentElement.style.top=W.HelperMethods.qc(Da.y);this.parentElement.style.left=W.HelperMethods.qc(Da.x);da.a(this.$).Zqj(this.parentElement);
ua&&(this.lZ=this.gridView.Pgc(new V.a(ya,ha)))}else this.lZ=!1}CLg(){this.VJa.insertBefore(this.parentElement,this.VJa.firstChild);this.PEf=!0}xFj(){this.mQ||(this.gridView.view.Ns(this.mt),this.mQ=!0)}Zag(){this.mQ&&this.gridView.view&&(this.gridView.view.Oq(this.mt),this.mQ=!1)}GQa(ua){const ya=this.gridView.Wb,ha=this.gridView.Xb(null);ha&&(ua=Object(S.a)(new za.a,{Text:ua}),this.gridView.setCell(ua,ha.range,0,127,null),ya.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}la.aHj="TableTotalRowDropDownIconButtonId";
la.bM=null;Object(t.a)(la,"TableTotalRowOptions",J.a,[3]);class aa extends l.a{constructor(ua){super(P.g(ua));this.Aob=this.h0=this.Sxc=this.yob=null;this.Loe=!1;this.Y8d=null;this.hQb=0;this.M3b=null;this.EZb=()=>{const ya={},ha=this.sed();for(let nb in ha){const qa=ha[nb];if(!qa)continue;const pa=this.KXh(qa);if(pa){if(pa in this.LEa){var Da=this.LEa[pa];if(Da.mB){Da.Zl.equals(qa)||(Da.Zl=qa);delete this.LEa[pa];ya[pa]=Da;continue}}(Da=fa.createInstance(P.g(this.$),qa,this.KGh(),this))?ya[pa]=Da:
d.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${qa.jz(!1)}`)}}this.G0b(null,null);this.POb=ya};this.G0b=()=>{const ya=this.LEa;for(let nb in ya){var ha=nb,Da=ya[nb];Da&&(Da.dispose(),delete this.LEa[ha])}this.POb={}};this.vKf=()=>{this.G0b(null,null);this.EZb(null,null)};this.onFocus=()=>{this.Y8d=P.g(this.$).ha.sa.activeCell};this.WQ=()=>{this.$.isEditMode&&this.Dh(null,null)};this.Dh=()=>{!this.Loe&&z.c(this.$,this.gridView.ha.sa.activeCell)&&
this.$ri()};this.iV=()=>{this.exb(1);this.$.ea.xn(this.iV)};this.BFb=()=>{this.Loe=!0;this.Sxc=new la(this.$)};this.$=ua;this.gridView=P.g(this.$);this.$.da.Ga(66,this);this.POb={};this.EZb(null,null);this.$.xa&&this.$.xa.Pf(this.vKf);this.Gme(this.EZb);this.$.ea.CX(this.WQ);this.gridView.ha.iJ(this.Dh);this.$.isEditMode&&this.Dh(null,null)}Gme(ua){this.addHandler(l.a.ZEd,ua)}GPf(ua){this.removeHandler(l.a.ZEd,ua)}qDg(ua){this.addHandler("tce",ua)}G$i(ua){this.removeHandler("tce",ua)}get LEa(){return this.POb}get Iqd(){return this.Y8d}get qHa(){return this.hQb}get Jg(){const ua=
P.g(this.$);return ua.Db.Xj(ua.ha.sa.activeCell,!1)}get FDd(){return this.Iqd?P.g(this.$).Db.Xj(this.Iqd,!1):null}upd(ua){return!!this.q_e(ua)}Fm(ua){return this.fUh(this.X_e(ua))}Mtb(ua){return this.X_e(ua)}y8i(ua){ua?(this.Aob?this.Aob!==ua&&(f.a.Ia(this.h0),this.h0=null,this.Aob=ua):this.Aob=ua,this.h0||(this.h0=G.a.instance.Vd(this.Aob)),this.h0.kn("focusin")||this.h0.ka("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Dcf(ua,
ya){return ua?ua.qaa&&ua.top===ya.top:(d.ULS.shipAssertTag(537151244,0,!!ua,"autofilterRange can't be null"),!1)}Sia(ua){ua=this.yob?u.I(ua,this.yob):this.view.getRangeInformation(ua);return 0<ua.length&&Object(k.a)(n.PivotTableRange,ua[0])?ua[0]:null}Vei(ua,ya){return ua?!ua.zec&&!!ua.BE&&ua.BE.Ed(ya):(d.ULS.shipAssertTag(537151243,0,!!ua,"Pivot table can't be null"),!1)}Tki(ua,ya){return ua?!ua.zec&&!!ua.ZK&&ua.ZK.Ed(ya):(d.ULS.shipAssertTag(537151242,0,!!ua,"Pivot table can't be null"),!1)}tXb(ua){super.tXb(ua);
if((ua=W.HelperMethods.B_e(ua))&&0<ua.length){this.yob=Array(ua.length);for(let ya=0;ya<ua.length;ya++)this.yob[ya]=v.a.bQ(ua[ya])}}XGb(){super.XGb();this.yob=null}X2g(ua,ya){return this.hBe(ua,ya).returnValue}hBe(ua,ya){var ha=!1;if(!ua||!ya)return{returnValue:!1,NX:ha};ua=ua.clone();ua.right+=1;ua.left=ua.right;return!ua.yz||ua.top<ya.hb.Ri&&(ha=ua.clone(),ha.bottom>=ya.hb.Ri&&(ha.bottom=ya.hb.Ri-1),!({NX:ha}=this.gBe(ha,ya)).returnValue)||ua.bottom>=ya.hb.Ri&&(ha=ua.clone(),ha.top<=ya.hb.Ri&&(ha.top=
ya.hb.Ri),!({NX:ha}=this.gBe(ha,ya)).returnValue)?{returnValue:!1,NX:ha}:{returnValue:!0,NX:ha}}j7f(ua){(ua=this.Fm(ua.topLeft))&&ua.toString()in this.LEa&&(this.LEa[ua.toString()].Uod=!1)}g2i(){this.raiseEvent("tce")}Sh(ua,ya){if(!this.Sxc)return!1;switch(ya){case -569786022:case 541421805:if(this.Sxc.lZ){const ha=document.getElementById(la.aHj);ha&&B.a.instance.create(()=>{A.DOMElementExtensions.wdc(ha,null)},0,y.a.VGj,!0,!0)}return!0;default:return!1}}dispose(){this.G0b(null,null);this.GPf(this.EZb);
this.$.xa.Ag(this.vKf);this.$.Bl(this.G0b);this.POb=null;this.$.ea&&this.$.ea.x_(this.WQ);this.gridView.ha.RK(this.Dh);this.Sxc=null;T.EwaSettings.ma(407)&&this.h0&&(f.a.Ia(this.h0),this.h0=null);super.dispose()}q3h(ua,ya,ha,Da){const nb=this.gridView.Db.Xj(new w.Range(ya,ha,ya,ha,!1,!1));if(this.M3b=nb){var qa=nb.usedRange,pa=ua.ctrlKey||e.a.isMac&&K.b(ua),Ja=!ua.shiftKey&&pa;ua=ua.shiftKey&&!pa;T.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(P.g(this.$).ha.selectionType=
3);switch(Da){case 0:this.hQb=0;T.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ya=this.T2c(ua,qa.top,ha,qa.bottom,ha),this.bOd(ya,Ja,ua)):this.cOd(qa.top,ha,qa.bottom,ha,x.d(nb),x.g(nb),Ja);break;case 1:this.hQb=1;T.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ya=this.T2c(ua,ya,qa.left,ya,qa.right),this.bOd(ya,Ja,ua)):this.cOd(ya,qa.left,ya,qa.right,!1,!1,Ja);break;case 2:this.hQb=2;T.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ya=this.T2c(ua,qa.top,qa.left,qa.bottom,qa.right),this.bOd(ya,Ja,ua)):this.cOd(qa.top,qa.left,qa.bottom,qa.right,x.d(nb),x.g(nb),Ja);break;default:d.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Da.toString()}`);return}T.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(P.g(this.$).ha.selectionType=3);d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}Bvj(ua){const ya=this.M3b.usedRange;return this.Lef(ua)||1!==this.qHa&&this.Lef(new w.Range(ya.top,ua.left,ya.bottom,ua.right,!1,!1))?!0:!1}YEd(ua){return ua.Autofilters}gBe(ua,ya){let ha;ha=!1;const Da=ya.hb.jj(ua),nb=ya.Lf(Da).lh;if(!nb)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Da}`),{returnValue:!1,NX:ha};if(!nb.Fe(ua))return{returnValue:!0,
NX:ha};ua=ya.kk("TableManager.CouldExpandImpl",ua,2);try{for(;ua.$$mn();){if(ua.$$cu().text||ua.Jn.F5e)return ha=!0,{returnValue:!1,NX:ha};if(ua.$$cu().GH)return{returnValue:!1,NX:ha}}}finally{ua&&ua.dispose()}return{returnValue:!0,NX:ha}}fUh(ua){if(!ua)return null;const ya=new m.AutofilterRange(ua.top,ua.left,ua.bottom,ua.right,null,null,null,ua.id,ua.qaa);ya.MRa=ua.MRa;const ha=this.gridView.Db.Xj(ua,!0);if(!ha)return null;for(let Da=0,nb=this.rangeList.length;Da<nb;Da++){const qa=this.rangeList[Da],
pa=this.gridView.Db.Xj(qa,!0);pa&&pa.name===ha.name&&qa!==ua&&this.$ji(qa)&&(ya.union(qa),qa.MRa&&(ya.MRa=!0))}return ya}$ji(ua){return!!P.g(this.$).Db.Xj(ua)}KGh(){const ua=[];for(const ya of this.rangeList){const ha=new E.a(this.Fm(ya.topLeft),r.d(this.$.oa));ua.push(ha)}return ua}sed(){const ua={};for(const ya of this.rangeList){if(!ya)continue;const ha=this.Fm(ya.topLeft);ha&&(ua[ha.toString()]=this.Fm(ya.topLeft))}return ua}$ri(){this.$.ea.Eg?this.exb(0):this.$.ea.ql(this.iV)}exb(ua){this.$.kz(ya=>
{ya.T$(ua).then(this.BFb)})}KXh(ua){const ya=this.gridView.Db.Xj(ua);return ya?ya.name:ua.toString()}cOd(ua,ya,ha,Da,nb,qa,pa){const Ja=ua+(nb?1:0),$a=ha-(qa?1:0),rb=this.gridView.inRangePicker||this.gridView.vi;let Pa=!1;const eb=new w.Range(Ja,ya,$a,Da,!1,!1);if(nb||qa){nb=rb?E.a.wqb(this.gridView.ha.rangePicker.KK):this.gridView.ha.sa.selectedRanges;for(const Ob of nb){Pa=this.Dpb(Ob,Ja,ya,$a,Da);nb=this.Dpb(Ob,ua,ya,ha,Da);if(rb&&Pa)break;if(!rb&&(Pa||nb)){this.gridView.ha.updateSelection(Ob,
Ob.topLeft,0,1);if(pa&&nb)return;break}}}Pa&&(eb.top=ua,eb.bottom=ha);ua=eb.topLeft;pa?this.gridView.ha.updateSelection(eb,ua,0,1):rb?this.gridView.ha.Qw([eb],0,ua,0):this.gridView.ha.updateSelection(eb,ua,0,3)}bOd(ua,ya,ha){ua&&(ha=ha?P.g(this.$).ha.sa.activeCell:ua.topLeft,ya?this.gridView.ha.updateSelection(ua,ha,0,1):this.gridView.ha.Qw([ua],0,ha,0))}T2c(ua,ya,ha,Da,nb){const qa=x.d(this.M3b),pa=x.g(this.M3b),Ja=ya+(1!==this.qHa&&qa?1:0),$a=Da-(1!==this.qHa&&pa?1:0),rb=this.gridView.inRangePicker||
this.gridView.vi;if(ua){var Pa=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&rb&&!E.a.wqb(this.gridView.ha.rangePicker.KK).length?new w.Range(Ja,ha,$a,nb,!1,!1):rb?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;Pa=new w.Range(Pa.top<Ja?Pa.top:Ja,Pa.left<ha?Pa.left:ha,Pa.bottom>$a?Pa.bottom:$a,Pa.right>nb?Pa.right:nb,!1,!1)}else Pa=new w.Range(Ja,ha,$a,nb,!1,!1);if(1!==this.qHa&&(qa||pa)&&(!ua||ua&&this.Dpb(Pa,Ja,ha,$a,nb))){ua=rb?E.a.wqb(this.gridView.ha.rangePicker.KK):
this.gridView.ha.sa.selectedRanges;for(const eb of ua)if(this.Dpb(eb,Ja,ha,$a,nb)){Pa.top=ya;Pa.bottom=Da;break}}return Pa}Lef(ua){const ya=this.gridView.inRangePicker||this.gridView.vi?E.a.wqb(this.gridView.ha.rangePicker.KK):this.gridView.ha.sa.selectedRanges;for(const ha of ya)if(this.Dpb(ha,ua.top,ua.left,ua.bottom,ua.right))return!0;return!1}Dpb(ua,ya,ha,Da,nb){return!!ua&&ua.top===ya&&ua.bottom===Da&&ua.left===ha&&ua.right===nb}}Object(t.a)(aa,"TableManager",l.a,[612,3]);class sa extends b.a{constructor(ua){super();
this.tableManager=null;this.$=ua;this.Fb()}create(){this.qb(this.tableManager||(this.tableManager=new aa(this.$)))}}Object(t.a)(sa,"TableManagerFactory",b.a,[]);var ea=a(1207);a.d(D,"a",function(){return Z});const Z=()=>{c.a.Fa(ua=>{ua.da.Ga(134,new sa(ua));ua.da.Ga(330,new ea.a(ua))})}},1207:function(t,D,a){t=a(0);var c=a(220),b=a(50),d=a(37),f=a(7),e=a(15),k=a(112),l=a(810),m=a(1449),v=a(721),n=a(1381),w=a(38),r=a(5),u=a(161),x=a(77),z=a(62),B=a(162),y=a(47),A=a(45),K=a(110);a(28);var G=a(190),
T=a(31),W=a(281),P=a(1),E=a(22),H=a(14);a(29);class F{}Object(t.a)(F,"TableStyleElement",null,[]);var N=a(747),J=a(209),R=a(87),M=a(521);class L{static bmf(ka,V){return L.m7f[ka.Type]-L.m7f[V.Type]}static k3a(ka,V){try{return appChrome.buildTableStyleGalleryIconNew(L.qAa,L.wna,ka,V)}catch(wa){return null}}static ngf(ka){return ka&&x.a.Oc in ka&&(ka=ka[x.a.Oc])?E.a.jL(ka,r.a.MFb):!1}static qsa(ka){const V=[];let wa=0;for(const ma of ka){V[wa]={};V[wa].backgroundColor="white";V[wa].color="black";for(let ab in ma)switch(ka=
ma[ab],ab){case "background-color":V[wa].backgroundColor=ka;break;case "color":V[wa].color=ka;break;case "font-size":V[wa].fontSize=ka;break;case "border-bottom":V[wa].borderBottom=ka;break;case "border-right":V[wa].borderRight=ka;break;case "border-left":V[wa].borderLeft=ka;break;case "border-top":V[wa].borderTop=ka}wa++}return V}static o2b(ka,V){const wa=[];if(null===ka||void 0===ka?0:ka.TableStyleElementsList){var ma=0===ka.Category;for(let ab=0;ab<L.wna;ab++)wa.push(...L.IKh(ka,V,ma,ab))}else{if(L.r4c)return L.r4c;
ka={color:"black","background-color":"white"};for(V=0;V<L.wna;V++)for(ma=0;ma<L.qAa;ma++)wa.push(ka);L.r4c=wa}return wa}static LXh(ka,V){if(!ka.TableStyleElementsList)return"";let wa="";for(const ma of ka.TableStyleElementsList)if(ma.BackgroundColor&&"#000000"!==ma.BackgroundColor)switch(ma.Type){case 0:wa=ma.BackgroundColor;break;case 5:case 7:if(V.Zga||V.wR)wa=ma.BackgroundColor;break;case 3:case 4:if(V.firstCol||V.lastCol)wa=ma.BackgroundColor;break;case 2:V.totalRow&&(wa=ma.BackgroundColor);break;
case 1:V.headerRow&&(wa=ma.BackgroundColor)}return wa}static o1b(ka){ka=new J.a(parseInt(String("0x"+ka.substr(1,2)),16),parseInt(String("0x"+ka.substr(3,2)),16),parseInt(String("0x"+ka.substr(5,2)),16));return N.a.BJa(ka)}static J1e(ka,V){if(!ka||!V)return"";V=(V=L.LXh(ka,V))?L.o1b(V)+", ":H.a.instance.ga(2064)+", ";switch(ka.Index){case 0:return V+H.a.instance.ga(1998);case 1:return V+H.a.instance.ga(1999);case 2:return V+H.a.instance.ga(2E3);case 3:return V+H.a.instance.ga(2001);case 4:return V+
H.a.instance.ga(2002);case 5:return V+H.a.instance.ga(2003);case 6:return V+H.a.instance.ga(2004);case 7:return V+H.a.instance.ga(2005);case 8:return V+H.a.instance.ga(2006);case 9:return V+H.a.instance.ga(2007);case 10:return V+H.a.instance.ga(2008);case 11:return V+H.a.instance.ga(2009);case 12:return V+H.a.instance.ga(2010);case 13:return V+H.a.instance.ga(2011);case 14:return V+H.a.instance.ga(2012);case 15:return V+H.a.instance.ga(2013);case 16:return V+H.a.instance.ga(2014);case 17:return V+
H.a.instance.ga(2015);case 18:return V+H.a.instance.ga(2016);case 19:return V+H.a.instance.ga(2017);case 20:return V+H.a.instance.ga(2018);case 21:return V+H.a.instance.ga(2019);case 22:return V+H.a.instance.ga(2020);case 23:return V+H.a.instance.ga(2021);case 24:return V+H.a.instance.ga(2022);case 25:return V+H.a.instance.ga(2023);case 26:return V+H.a.instance.ga(2024);case 27:return V+H.a.instance.ga(2025);case 28:return V+H.a.instance.ga(2026);case 29:return V+H.a.instance.ga(2027);case 30:return V+
H.a.instance.ga(2028);case 31:return V+H.a.instance.ga(2029);case 32:return V+H.a.instance.ga(2030);case 33:return V+H.a.instance.ga(2031);case 34:return V+H.a.instance.ga(2032);case 35:return V+H.a.instance.ga(2033);case 36:return V+H.a.instance.ga(2034);case 37:return V+H.a.instance.ga(2035);case 38:return V+H.a.instance.ga(2036);case 39:return V+H.a.instance.ga(2037);case 40:return V+H.a.instance.ga(2038);case 41:return V+H.a.instance.ga(2039);case 42:return V+H.a.instance.ga(2040);case 43:return V+
H.a.instance.ga(2041);case 44:return V+H.a.instance.ga(2042);case 45:return V+H.a.instance.ga(2043);case 46:return V+H.a.instance.ga(2044);case 47:return V+H.a.instance.ga(2045);case 48:return V+H.a.instance.ga(2046);case 49:return V+H.a.instance.ga(2047);case 50:return V+H.a.instance.ga(2048);case 51:return V+H.a.instance.ga(2049);case 52:return V+H.a.instance.ga(2050);case 53:return V+H.a.instance.ga(2051);case 54:return V+H.a.instance.ga(2052);case 55:return V+H.a.instance.ga(2053);case 56:return V+
H.a.instance.ga(2054);case 57:return V+H.a.instance.ga(2055);case 58:return V+H.a.instance.ga(2056);case 59:return V+H.a.instance.ga(2057);default:return ka.Name?ka.Name:""}}static IRh(ka){return(ka+1)%L.H6h}static pvb(ka,V,wa=""){return ka||!wa?`${L.X7e}, ${ka.Index.toString()}, -version, ${V.toString()}`:`${L.X7e}, ${wa}, -version, ${V.toString()}`}static IKh(ka,V,wa,ma){const ab=[];for(let ba=0;ba<L.qAa;ba++)ab.push(L.Sbd(ka,V,wa,ma,ba));return ab}static Sbd(ka,V,wa,ma,ab){ka=ka.TableStyleElementsList;
let ba=new F;const Ca={};if(!ka)return Ca;for(var Na of ka)if(0===Na.Type){ba=Na;break}Na=!!ba.BackgroundColor;let za="";!wa&&ba.TableStyleBorderFromatList&&0<ba.TableStyleBorderFromatList.length&&(za=ba.TableStyleBorderFromatList[0].Color);Ca["background-color"]=Na?ba.BackgroundColor:"#FFFFFF";ba.FontColor||(ba.FontColor="#000000");Ca.color=ba.FontColor;L.vwe(ma,ab,Ca,ba,za,wa,Na);for(const la of ka)la&&0!==la.Type&&(2!==la.Type||Na||(la.BackgroundColor=ba.BackgroundColor),L.kpd(la,ma,ab,V)&&(la.BackgroundColor&&
(Ca["background-color"]=la.BackgroundColor),Ca.color=la.FontColor||ba.FontColor,L.vwe(ma,ab,Ca,la,za,wa,Na)));return Ca}static CU(ka,V,wa,ma,ab,ba){wa&&(wa.Color&&!wa.Style&&(wa.Style=1),wa.Style&&!wa.Color&&(wa.Color=ab?"#000000":ma?ma:ba?"#FFFFFF":"#000000"),V[L.borders[ka]]="1px "+L.bV[wa.Style]+" "+wa.Color)}static kpd(ka,V,wa,ma){return-1===ka.Type?!1:L.mpd(ka,V,wa,ma)||L.cmi(ka,V,wa,ma)||L.npd(ka,V,wa,ma)}static cmi(ka,V,wa,ma){return!V&&ma.headerRow||V===L.wna-1&&ma.totalRow?!1:1===V%2&&5===
ka.Type&&ma.wR&&ma.headerRow||1<V&&!!((V-1)%(ka.BandSize+1))&&6===ka.Type&&ma.wR&&ma.headerRow||!(V%2)&&5===ka.Type&&ma.wR&&!ma.headerRow||!!(V%(ka.BandSize+1))&&6===ka.Type&&ma.wR&&!ma.headerRow||!(wa%2)&&7===ka.Type&&ma.Zga||!!(wa%(ka.BandSize+1))&&8===ka.Type&&ma.Zga}static npd(ka,V,wa,ma){return V===L.wna-1&&2===ka.Type&&ma.totalRow||wa===L.qAa-1&&V===L.wna-1&&12===ka.Type&&ma.totalRow&&ma.lastCol||!wa&&V===L.wna-1&&11===ka.Type&&ma.totalRow&&ma.firstCol||wa===L.qAa-1&&4===ka.Type&&ma.lastCol}static mpd(ka,
V,wa,ma){return!V&&1===ka.Type&&ma.headerRow||!wa&&3===ka.Type&&ma.firstCol||!wa&&!V&&9===ka.Type&&ma.headerRow&&ma.firstCol||wa===L.qAa-1&&!V&&10===ka.Type&&ma.headerRow&&ma.lastCol}static vwe(ka,V,wa,ma,ab,ba,Ca){if(ma.TableStyleBorderFromatList)for(const Na of ma.TableStyleBorderFromatList)if(Na.Style)switch(Na.Position){case 0:ka&&12!==ma.Type&&11!==ma.Type&&2!==ma.Type&&5!==ma.Type&&6!==ma.Type||L.CU(0,wa,Na,ab,ba,Ca);break;case 1:ka!==L.wna-1&&1!==ma.Type&&10!==ma.Type&&9!==ma.Type&&5!==ma.Type&&
6!==ma.Type||L.CU(1,wa,Na,ab,ba,Ca);break;case 2:V&&12!==ma.Type&&10!==ma.Type&&7!==ma.Type&&8!==ma.Type&&4!==ma.Type||L.CU(2,wa,Na,ab,ba,Ca);break;case 3:V!==L.qAa-1&&9!==ma.Type&&11!==ma.Type&&3!==ma.Type&&7!==ma.Type&&8!==ma.Type||L.CU(3,wa,Na,ab,ba,Ca);break;case 5:V!==L.qAa-1&&3!==ma.Type&&4!==ma.Type&&7!==ma.Type&&8!==ma.Type&&L.CU(3,wa,Na,ab,ba,Ca);break;case 6:ka!==L.wna-1&&2!==ma.Type&&1!==ma.Type&&5!==ma.Type&&6!==ma.Type&&L.CU(1,wa,Na,ab,ba,Ca)}}static OXh(){const ka=Array(12);ka[0]=0;
ka[7]=1;ka[8]=2;ka[5]=3;ka[6]=4;ka[4]=5;ka[3]=6;ka[1]=7;ka[2]=8;ka[9]=9;ka[10]=10;ka[11]=11;ka[12]=13;return ka}}L.wna=5;L.qAa=5;L.H6h=5;L.X7e="TableStyleIcon";L.bV=[null,R.a.solid,R.a.dashed,R.a.dotted,R.a.dashed,R.a.dotted,R.a.dashed,R.a.double];L.borders=[M.a.borderTop,M.a.borderBottom,M.a.borderLeft,M.a.borderRight];L.m7f=L.OXh();L.r4c=null;Object(t.a)(L,"TableStyleHelper",null,[]);class U{constructor(ka,V,wa,ma,ab,ba){this.headerRow=ka;this.totalRow=V;this.firstCol=wa;this.lastCol=ma;this.wR=
ab;this.Zga=ba}equals(ka){return ka?this.headerRow===ka.headerRow&&this.totalRow===ka.totalRow&&this.firstCol===ka.firstCol&&this.lastCol===ka.lastCol&&this.Zga===ka.Zga&&this.wR===ka.wR:!1}}Object(t.a)(U,"TableStyleOptions",null,[]);var X=a(787);class da extends w.a{constructor(ka,V,wa){super();this.r_i={["height"]:"100%"};this.OGb={};this.gHa=this.ffd=0;this.lastSyncTime=new Date;this.$ca=-1;this.FN=null;this.Ola={};this.lL=null;this.fG={};this.mSa={};this.Xpc=null;this.rzb=this.F5a=this.isInitialized=
this.Cef=!1;this.ctc=null;this.qxc=this.FLb=this.hTe=!1;this.Lwf=(ma,ab,ba)=>{let Ca=!1;const Na=P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(W.a(ma))-315732528!==ma.Errors[0].MessageId&&(e.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${T.a.zc(ma.Errors)}`),this.Xyd(null,ab,ba));else if(e.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),
(ma=ma.Result)&&ma.TableStyleItems.length){ba=60<ma.TableStyleItems.length;var za=!1,la=!1;if(this.lL)for(var aa=0;60>aa;++aa){const sa=ma.TableStyleItems[aa],ea=this.lL.TableStyleItems[aa];if(Na&&sa.HasStyleViolations!==ea.HasStyleViolations){Ca=la=!0;break}for(let Z=0;9>Z&&!(Z>=sa.TableStyleElementsList.length);Z++)if(!E.a.equals(sa.TableStyleElementsList[Z].BackgroundColor,ea.TableStyleElementsList[Z].BackgroundColor,!1)){Ca=za=!0;break}}else{this.gHa=0;for(aa of ma.TableStyleItems)aa.TableStyleElementsList&&
aa.TableStyleElementsList.sort(L.bmf),this.fG[aa.Name]=aa}if(za||la)for(za=0;60>za;++za)la=ma.TableStyleItems[za],this.fG[la.Name]=la;if(ba&&this.lL)for(e.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${ma.TableStyleItems.length-60}`),Ca=!0,ba=60;ba<ma.TableStyleItems.length;++ba)za=ma.TableStyleItems[ba],za.Name in this.fG||za.TableStyleElementsList&&za.TableStyleElementsList.sort(L.bmf),this.fG[za.Name]=za;if(X.a(this.fG).length!==ma.TableStyleItems.length)for(Ca=
!0,za=ba=60;za<this.lL.TableStyleItems.length;)ba>=ma.TableStyleItems.length?delete this.fG[this.lL.TableStyleItems[za].Name]:ba>=ma.TableStyleItems.length||!E.a.equals(ma.TableStyleItems[ba].Name,this.lL.TableStyleItems[za].Name,!1)?delete this.fG[this.lL.TableStyleItems[za].Name]:++ba,++za;this.lL=ma;this.GMf(Ca);Ca&&this.lXc();Na&&ab&&("accessibility"===ab?(this.FLb=!1,this.qxc=!0):this.qxc=!1);this.Cef||(this.smi()&&this.$.pf(),this.Cef=!0);this.ffd=0;this.rzb||this.hTe?Na&&this.qxc&&this.raiseEvent("RefreshTableStyleGallery"):
(this.raiseEvent("RefreshTableStyleGallery"),this.hTe=!0)}};this.Xyd=()=>{e.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.ffd++;5>this.ffd&&y.a.instance.create(()=>{this.K3a("getTableStylesFailed")},1E3,A.a.l7f,!0,!0)};this.tCf=()=>{this.rzb&&(this.rzb=!1,this.ctc&&this.ctc(),y.a.instance.create(()=>{this.K3a("galleryMenuClosed")},1E3,A.a.l7f,!0,!0))};this.$=ka;this.Sa=V;this.tableManager=wa;this.$.da.Ga(329,this);this.IXc=this.fub();this.$.Ka.SXa(this.tCf)}U4e(ka){const V=
this.tableManager.Jg;if(!V)return!1;ka=ka[x.a.Oc];if(!ka)return!1;switch(Number.parseInvariant(ka)){case 0:return B.d(V);case 1:return B.c(V);case 2:return B.g(V);case 3:return B.e(V);case 4:return B.f(V);case 5:return B.b(V);case 6:return V.hasAutoFilter}return!1}oGf(ka,V){if(k.a.isEmpty(this.fG))return!0;if("PopulateTableMoreStylesMenu"!==ka&&"PopulateTableAccessibleStylesMenu"!==ka)return!1;if(P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===
ka&&!this.qxc)return this.FLb||(this.FLb=!0,this.K3a("accessibilityTab")),!0;this.rzb=!0;const wa=this.Sa.pq("TableStylesMenu"),ma=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),ab=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),ba=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Ca=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Na=-123538519,za;if(V.MenuId)if(E.a.contains(V.MenuId,"FormatAsTable",
!0))Na=753331043,this.F5a=!0;else{za=H.a.instance.ga(1997);var la=L.pvb(null,1,"-1");P.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ca.Lt("-1",Na,"QueryTableStyle",0,"-1",la,void 0,void 0,za):Ca.Lt("-1",Na,"QueryTableStyle",0,"-1",void 0,void 0,void 0,za);this.F5a=!1}la=0;const aa=this.fG;for(let sa in aa){const ea=aa[sa];if(P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===ka&&ea.HasStyleViolations)continue;
let Z;za=L.J1e(ea,this.fub());Z=L.pvb(ea,this.gHa);if(ea)switch(ea.Category){case 0:ma.Lt(ea.Index.toString(),Na,"QueryTableStyle",0,ea.Index.toString(),Z,void 0,void 0,za);la++;break;case 3:ab.Lt(ea.Index.toString(),Na,"QueryTableStyle",0,ea.Index.toString(),Z,void 0,void 0,za);break;case 2:ba.Lt(ea.Index.toString(),Na,"QueryTableStyle",0,ea.Index.toString(),Z,void 0,void 0,za);break;case 1:Ca.Lt(ea.Index.toString(),Na,"QueryTableStyle",0,ea.Index.toString(),Z,void 0,void 0,za)}}0<la&&this.D1(wa,
ma,1965);this.D1(wa,Ca,1966);this.D1(wa,ba,1967);this.D1(wa,ab,1968);V.MenuItems=wa.rE();this.isInitialized||(this.isInitialized=!0);return!0}Ngd(ka){ka[l.a.On]=!1;let V=ka[x.a.Oc];if(V&&!k.a.isEmpty(this.fG)){E.a.contains(ka.ParentMenuId,"FormatAsTable",!0)?this.F5a=!0:this.F5a=!1;this.F5a||this.Kbg();L.ngf(ka)&&(V=this.Cub(V).toString());var wa=this.fub();ka[l.a.Alt]="-1"===V?H.a.instance.ga(1997):L.J1e(this.efd(V),wa);if(V in this.mSa&&wa.equals(this.IXc))this.qGf(ka,V,wa,!0);else{if(!this.Xpc||
this.Xpc&&!this.Xpc.zq)this.Ola={},this.Xpc=y.a.instance.create(()=>{this.GMf();this.IXc=this.fub()},0,A.a.$Gj,!0,!0);this.yCd(wa,ka,V)}}}getTableStyleIndexFromName(ka){if(!ka||k.a.isEmpty(this.fG))return-1;if(ka in this.fG)return this.fG[ka].Index;this.K3a("getTableStyleIndexFromName");return-1}vpd(){return!!this.lL}Cub(ka){this.FN||this.lXc();return ka in this.FN?this.FN[ka]:-1}K3a(ka){if(this.$.isEditMode)if(P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){let wa=
new Date;if(30<K.getElapsedSeconds(this.lastSyncTime,wa)||k.a.isEmpty(this.fG)||this.FLb){var V=this.$.pa.va.Qb();this.lastSyncTime=wa;ka=this.FLb&&"accessibilityTab"===ka||"galleryMenuClosed"===ka;z.n(this.$.pa.va,ka,this.Lwf,this.Xyd,null,ka?"accessibility":"normal",V)}}else if(V=new Date,30<K.getElapsedSeconds(this.lastSyncTime,V)||k.a.isEmpty(this.fG))ka=this.$.pa.va.Qb(),this.lastSyncTime=V,z.m(this.$.pa.va,this.Lwf,this.Xyd,null,null,ka)}dispose(){this.FN=this.mSa=this.lL=this.fG=null;this.$.Ka.xHb(this.tCf);
super.dispose()}WFg(ka){this.addHandler("RefreshTableStyleGallery",ka)}Ibj(ka){this.removeHandler("RefreshTableStyleGallery",ka)}lXc(){const ka={};this.tableManager.Jg&&(this.$ca=this.getTableStyleIndexFromName(this.tableManager.Jg.Rxc));for(let V=1;7>=V;V++)ka["preview"+V]=this.MQh(V);this.FN=ka}MQh(ka){var V=this.lL.TableStyleItems.length;V=4>=this.$ca?this.$ca+ka-1:4<this.$ca&&this.$ca<V-4?4===ka?this.$ca:Math.floor(this.$ca+ka-4):this.$ca+ka-1;-1===V||V.toString()in this.mSa||(V=ka-3);return V}Kbg(){if(this.tableManager.Jg){let ka=
!1;const V=this.getTableStyleIndexFromName(this.tableManager.Jg.Rxc);if(V!==this.$ca){if(this.FN){const wa=this.FN;for(let ma in wa)wa[ma]===V&&(ka=!0)}this.$ca=V;ka||k.a.isEmpty(this.mSa)||this.lXc()}}}D1(ka,V,wa){const ma=this.Sa.Bc();ma.Jp="Thin";ma.title=H.a.instance.ga(wa);ma.buttons.push(V);ka.pc.push(ma)}fub(){const ka=this.tableManager.Jg;return this.F5a||!ka?new U(!0,!1,!1,!1,!0,!1):new U(B.d(ka),B.g(ka),B.c(ka),B.e(ka),B.f(ka),B.b(ka))}GMf(ka=!1){const V={},wa={},ma=this.fub();if(!k.a.isEmpty(this.fG)&&
(this.tableManager.Jg&&this.Kbg(),!ma.equals(this.IXc)||ka||k.a.isEmpty(this.mSa))){this.gHa=L.IRh(this.gHa);ka=this.fG;for(var ab in ka){const ba=ka[ab],Ca=L.pvb(ba,this.gHa);V[ba.Index.toString()]=L.k3a(L.qsa(L.o2b(ba,ma)),Ca);wa[Ca]=V[ba.Index.toString()];this.NGb(wa)}ab=L.pvb(null,this.gHa,"-1");V["-1"]=L.k3a(L.qsa(L.o2b(null,ma)),ab);wa[ab]=V["-1"];this.NGb(wa);G.c(this.mSa,V,!1)}}smi(){const ka=u.a(this.$);return ka?ka.Xl.Tz===r.a.Pya:!1}yCd(ka,V,wa){Number.parseInvariant(wa);"-1"===wa&&E.a.contains(V.ParentMenuId,
"FormatAsTable",!0)||this.qGf(V,wa,ka,!1)}qGf(ka,V,wa,ma){const ab=L.pvb(null,this.gHa,V);L.ngf(ka)?(ab in this.Ola?wa=this.Ola[ab]:(wa=L.qsa(L.o2b(this.efd(V),wa)),this.Ola[ab]=wa),ka[l.a.GalleryButtonProps]=Object(f.a)(new m.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ab,Alt:ka[l.a.Alt],MenuItemId:V,TableCellStyles:wa,TableStyles:this.r_i})):(ka[v.a.Icon]=ab,ka[l.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ab,Alt:ka[l.a.Alt],MenuItemId:V}),
ma||(ma=[],this.efd(V),"-1"===V||E.a.contains(ka.ParentMenuId,"FormatAsTable",!0)||(ma=L.o2b(this.lL.TableStyleItems[Number.parseInvariant(V)],wa)),this.mSa[V]=L.k3a(L.qsa(ma),ab)))}NGb(ka){if(this.rzb)this.ctc=()=>{this.NGb(ka)};else{this.ctc=null;var V=[];for(let ma in ka){var wa=ma;wa in this.OGb?V.push(wa):this.OGb[wa]=!0}try{0<V.length&&appChrome.api.unregisterIcons(V),k.a.isEmpty(ka)||appChrome.api.registerIconProvider(()=>ka)}catch(ma){}}}efd(ka){ka=Number.parseInvariant(ka);if(-1===ka||!this.lL)return null;
if(60<ka)for(let V=60;V<this.lL.TableStyleItems.length;++V){const wa=this.lL.TableStyleItems[V];if(wa.Index===ka)return wa}return this.lL.TableStyleItems[ka]}}Object(t.a)(da,"TableStyleManager",w.a,[256,3]);var fa=a(55);a.d(D,"a",function(){return S});class S extends c.a{constructor(ka){super();this.tableStyleManager=null;this.$=ka;this.Fb()}create(){const ka=b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib),V=b.GetServiceTaskFactory.Ta(this.$.da,66,134,this.ib);d.TaskExtensions.Aa(fa.Task.zL(ka,
V),()=>{this.qb(this.tableStyleManager||(this.tableStyleManager=new da(this.$,ka.result,V.result)))},this.$.la,8)}}Object(t.a)(S,"TableStyleManagerFactory",c.a,[])},1222:function(t,D,a){t=a(0);var c=a(220),b=a(15),d=a(163),f=a(245),e=a(370),k=a(4),l=a(640),m=a(88),v=a(93),n=a(258),w=a(161),r=a(75),u=a(373),x=a(50),z=a(37),B=a(90),y=a(70),A=a(1),K=a(569),G=a(21);class T extends v.a{constructor(R,M){super(R);this.zS=[];this.T8d=null;this.iIb=L=>{let U="forward";L.Values[e.a.direction]?U=L.Values[e.a.direction].toLowerCase():
b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");L=0;let X=!0;"backward"===U?(L=this.Fqd.length-1,X=!1):"forward"===U?(L=0,X=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${U}`);this.Gpf(X,L,!1)};this.Mxf=()=>{this.zS=[]};this.SNa=L=>{-411645385===this.$.shortcutKeyManager.$s(L,!0)&&this.jdf()&&(this.$.Ka.Lb(new B.a(-411645385,1,this.$.Mc,6,null),{["event"]:L},L),L.stopPropagation())};this.LMi=L=>{this.nla(L)};this.jb=M;this.$p=G.g(this.jb);
this.Fc.ka("keydown",this.LMi);this.Fc.ka("keyup",this.SNa);n.a(M).hGg(this.Mxf);r.a(M.ya,27)&&z.TaskExtensions.Aa(x.GetServiceTaskFactory.Ta(M.da,21,137,1),L=>{L=L.result;L.fo(d.a.m7e);L.Vl(d.a.m7e,this.iIb)},M.la)}get $(){return this.jb}get Fqd(){this.zS.length||(this.zS=this.SYe());return this.zS}get kka(){return this.T8d}set kka(R){this.T8d=R;this.zS=this.SYe()}dispose(){this.$&&n.a(this.$).Wbj(this.Mxf);this.jb=null;this.zS.length=0;super.dispose()}g0i(R){this.nla(R)}Gpf(R,M,L=!0,U=null){var X=
this.pGj(R,M,L,U);if(!X){L=M;var da=R?1:-1,fa=this.Fqd;do{X=!1;if(r.a(this.$.ya,27)){if(L+=da,L>=fa.length||0>L)X=!0}else L=(L+da+fa.length)%fa.length;if(X){this.Zvi(R,M,U);break}else if(X=this.Q6f(R,M,L,!1,U))break}while(L!==M)}}pGj(R,M,L=!0,U=null){let X=null;0<=M&&(X=this.zS[M]);return(null===X||void 0===X?0:X.jf)&&X.gg(R,L)?(U&&y.g(U),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${X.Zd} into a sub region`),X.kj(),!0):!1}Q6f(R,M,L,U,X=null){L=this.zS[L];if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)){const da=n.a(this.jb).hB(f.a.KIa),fa=n.a(this.jb).hB(f.a.yvb),S=this.$p.ha.Oa.nZ;if(L===fa&&S||L===da&&!U&&!S)return!1}if((null===L||void 0===L?0:L.jf)&&L.gg(R,!1)){X&&y.g(X);L.kj();if(R=this.zS[M])R.Mj(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${R.Zd} to ${L.Zd}`);return!0}return!1}Zvi(R,M,L=null){L&&y.g(L);if(M=this.zS[M])M.Mj(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${M.Zd}`);z.TaskExtensions.Aa(x.GetServiceTaskFactory.Ta(this.$.da,21,137,0),U=>{U.result.Fj(d.a.nlb,
{[e.a.direction]:R?"forward":"backward"})},this.$.la)}nla(R){var M=this.$.isEditMode?w.a(this.$):null;if(!this.$.rb.lwa||T.Mhi(M))if(117===R.keyCode&&(R.ctrlKey||y.b(R))){M=this.F0e(R.target);var L=!R.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${M}`);if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var U=n.a(this.jb).hB(f.a.nIb);U=this.zS.indexOf(U);k.AFrameworkApplication.ta.Pa.sw&&
this.$.wZ&&-1!==U&&M===U&&1===this.$.Rcb&&l.ShyRibbon.pJ(1,0)}else k.AFrameworkApplication.ta.Pa.sw&&this.$.wZ&&1===M&&1===this.$.Rcb&&l.ShyRibbon.pJ(1,0);this.Gpf(L,M,!0,R)}else 117!==R.keyCode||T.tQe?-411645385===this.$.shortcutKeyManager.$s(R)?this.jdf()&&(this.$.Ka.Lb(new B.a(-411645385,1,this.$.Mc,6,null),{["event"]:R},R),R.stopPropagation()):1588554917===this.$.shortcutKeyManager.$s(R)?0===this.mode?(K.a(this.$)||this.$.Ka.Lb(new B.a(1588554917,1,this.$.Mc,6,null),{["event"]:R},R),R.preventDefault(),
R.stopPropagation()):3===this.mode&&(R.preventDefault(),R.stopPropagation()):A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.$s(R)?(M=this.F0e(R.target),U=n.a(this.jb).hB(f.a.nIb),L=n.a(this.jb).hB(f.a.KIa),U=this.zS.indexOf(U),L=this.zS.indexOf(L),k.AFrameworkApplication.ta.Pa.sw&&this.$.wZ&&-1!==U&&M===U&&1===this.$.Rcb&&l.ShyRibbon.pJ(1,0),-1!==L&&M!==L&&this.Q6f(!0,M,L,!0,R)):this.x1h(R):(R=u.a.EA.notificationBar.c$(m.a.OMh(),
!1),R.image=0,u.a.EA.notificationBar.hE(R),T.tQe=!0)}F0e(R){const M=this.Fqd;for(let L=0,U=M.length;L<U;++L){const X=M[L];if(X&&X.hh(R))return L}return-1}SYe(){const R=[];for(let M=0,L=this.kka.length;M<L;M++){const U=n.a(this.$).hB(this.kka[M]);U&&R.push(U)}return R}jdf(){return 0===this.mode||4===this.mode}static Mhi(R){return R?R.inKeytipMode:!1}}T.tQe=!1;Object(t.a)(T,"AccessibilityManager",v.a,[636,3]);var W=a(148),P=a(22),E=a(14);class H extends T{constructor(R){super(document.documentElement,
R);this.YB=0;this.TMg=[f.a.WAe,f.a.Lwd,f.a.Rbc,f.a.UUd,f.a.nIb,f.a.nXc,f.a.bad,f.a.p3e,f.a.uWc,f.a.Xxc,f.a.DBj,f.a.yvb,f.a.DYc,f.a.KIa,f.a.ePd,f.a.LYc,f.a.g5f,f.a.Fjf,f.a.RWc];this.uVj=[f.a.Rbc,f.a.Keg,f.a.Jeg,f.a.Leg];this.H_i=[f.a.Rbc,f.a.PHf,f.a.QHf,f.a.THf];this.RUg=[f.a.sTe,f.a.o3e,f.a.Z$c,f.a.W$c];this.i_i=[f.a.WAe,f.a.Lwd,f.a.nXc,f.a.bad,f.a.uWc,f.a.Xxc,f.a.yvb,f.a.DYc,f.a.KIa,f.a.ePd,f.a.mHf,f.a.LYc,f.a.RWc];this.s_i=[f.a.yvb,f.a.yTe];const M=E.a.instance.Xa(252);this.Kpj=this.$.shortcutKeyManager.wJa(M);
this.mode=0;R.da.Ga(15,this);z.TaskExtensions.Aa(x.GetServiceTaskFactory.Ta(R.da,21,137,1),L=>{L=L.result;L.fo(d.a.nlb);L.Vl(d.a.nlb,this.iIb)},R.la)}get mode(){return this.YB}set mode(R){this.YB=R;switch(R){case 0:this.kka=this.TMg;break;case 2:this.kka=this.uVj;break;case 3:this.kka=this.H_i;break;case 4:this.kka=this.RUg;break;case 5:this.kka=this.i_i;break;case 6:this.kka=this.s_i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}nla(R){this.$.Bd&
65536&&super.nla(R)}x1h(R){if(P.a.equals(this.Kpj,this.$.shortcutKeyManager.Ucd(R),!1)){const M=W.b(this.$);if(null===M||void 0===M?0:M.jf)y.g(R),M.gg(!0,!1)}}}Object(t.a)(H,"EwaAccessibilityManager",T,[]);class F extends c.a{constructor(R){super();this.$=R;this.Fb()}create(){this.qb(this.$.da.za(15)||new H(this.$))}static ka(R){R.da.Ga(157,new F(R))}}Object(t.a)(F,"AccessibilityManagerFactory",c.a,[]);var N=a(10);a.d(D,"a",function(){return J});const J=()=>{N.a.Fa(F.ka)}},1223:function(t,D,a){var c=
a(10);t=a(0);var b=a(15),d=a(220),f=a(37),e=a(54),k=a(1),l=a(287),m=a(212);class v{}v.SMe="ewa-svg-icon";Object(t.a)(v,"CssClassNames",null,[]);var n=a(50),w=a(12),r=a(310),u=a(195);class x{constructor(y){this.yg=()=>{this.Kjf();this.$.ea.xn(this.yg)};this.$=y;this.P6f={};this.uTd={};const A=k.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",K=this.yYe(A);K?(this.ale(K),this.$.ea.Eg?this.Kjf():y.ea.ql(this.yg),this.$.da.Ga(388,
this)):b.ULS.sendTraceTag(537151263,0,15,`window[${A}].icons returned null.`)}dispose(){this.uTd=null;this.$.ea.xn(this.yg)}Tua(y,A,K=null,G=null){let T;(T=this.uTd[y])||(this.uTd[y]=T=this.aWi(this.P6f[y]));if(!T)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${y} was not found in loaded SVG sprites.`),null;const W=T.cloneNode(!0);if(!W.style){const P=r.b(T),E=r.b(W),H={};H.iconId=y;H.isOriginalNodeStyleNull=void 0===T.style||null===T.style;H.isOriginalNodeCurrentStyleNull=
void 0===T.currentStyle||null===T.currentStyle;H.isClonedNodeCurrentStyleNull=void 0===W.currentStyle||null===W.currentStyle;H.originalNode=P.substring(0,P.indexOf(">")+1);H.clonedNode=E.substring(0,E.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(H)}`)}W.setAttribute("style",`height: ${A}px; width: ${A}px;`);G&&(y=document.createElement("title"),y.innerHTML=G,W.insertBefore(y,W.childNodes[0]));if(K)for(const P of K)Sys.UI.DomElement.addCssClass(W,
P);return W}Aaa(y,A,K,G,T=0,W=0,P=null,E=null){T&&W||(W=w.DOMElementExtensions.getBoundingClientRect(G),T=W.height,W=W.width);if(P=this.Tua(y,A,P,E))G.appendChild(P),(G=w.DOMElementExtensions.GY(P,"style",null))?P.setAttribute("style",G+` margin: ${(T-A)/2}px ${(W-K)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${y}`);return P}Kjf(){f.TaskExtensions.Aa(n.GetServiceTaskFactory.Ta(this.$.da,283,284,0),
y=>{y=u.c(y.result.$n.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(y,()=>{const A=this.yYe("excelUiSlice20Sprite");A?this.ale(A):b.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.la,3)},this.$.da.la,3)}ale(y){for(const A of y)A.type===m.a.sTd&&(this.P6f[A.id]=A)}aWi(y){if(!y)return null;const A=y.viewBox;y=y.children;const K=document.createElementNS(l.a.vTd,m.a.sTd);Sys.UI.DomElement.addCssClass(K,v.SMe);K.setAttribute("focusable","false");
K.setAttribute("viewBox",A);this.qCg(K,y);return K}qCg(y,A){for(const G of A){const T=document.createElementNS(l.a.vTd,G.type);for(let W in G){A=W;var K=G[W];"className"===A?T.setAttribute("class",K):T.setAttribute(A,K)}y.appendChild(T)}}yYe(y){return(y=window[y])?y.icons:null}}Object(t.a)(x,"SvgIconProvider",null,[615,3]);class z extends d.a{constructor(y){super();this.$=y;this.Fb()}create(){f.TaskExtensions.Aa(e.a.KQ([129],4,this.ib,void 0,void 0,void 0,387),()=>{const y=k.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?
"excelInitialAppSprite":"excelAppSprite";window[y]?this.qb(this.$.da.za(388)||new x(this.$)):b.ULS.sendTraceTag(537151258,0,50,`window.[${y}] returned null.`)},this.la,3)}static ka(y){y.da.Ga(387,new z(y))}}Object(t.a)(z,"SvgIconProviderFactory",d.a,[]);a.d(D,"a",function(){return B});const B=()=>{c.a.Fa(z.ka)}},1247:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(21),f=a(1118);class e extends f.a{constructor(m,v){super(m);v.Ga(240,this)}OWh(m){for(const v of this.rangeList)if(m.range.contains(v))return v;
return null}YEd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null}}Object(t.a)(e,"SparklineManager",f.a,[617]);class k extends b.a{constructor(m){super();this.sparklineManager=null;this.$=m;this.Fb()}create(){this.qb(this.sparklineManager||(this.sparklineManager=new e(d.g(this.$),this.$.da)))}static ka(m){m.da.Ga(239,new k(m))}}Object(t.a)(k,"SparklineManagerFactory",b.a,[]);a.d(D,"a",function(){return l});const l=
()=>{c.a.Fa(k.ka)}},1268:function(t,D,a){t=a(0);var c=a(142),b=a(595);class d extends b.a{constructor(){super()}dispose(){c.WacAirSpace.Nkd()&&c.WacAirSpace.Byc()}animate(k,l,m,v,n){l&&c.WacAirSpace.cL(k.element,l);c.WacAirSpace.animate(k,v,n);m&&c.WacAirSpace.e9i(k.element,m)}}Object(t.a)(d,"AnimationManager",b.a,[3]);var f=a(101);a.d(D,"a",function(){return e});const e=()=>{f.a.ul.Ga(141,new d)}},1441:function(t,D,a){a.r(D);t=a(1191);D=a(1155);var c=a(1114),b=a(1115),d=a(1116),f=a(1119);a(1117);
var e=a(1222),k=a(1268),l=a(10),m=a(0),v=a(220),n=a(184),w=a(547),r=a(15),u=a(804),x=a(513),z=a(82),B=a(4),y=a(78),A=a(901);class K extends y.a{constructor(H){super();this.Ard=null;this.$=H;r.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Lgj(){const H=new n.a,F=x.a.Sq(z.a.instance.Vb("Common.IEventEmitter<Common.IMruResult>")),N=new w.a(()=>F.result);this.Ard=new w.a(()=>new u.a(N.value,null));if(!this.Ard)return H;var J=this.Ard.value.SY("NewAndOpenCoreManager",!1);if(!J||3!==
J.state||!J.vvd)return J?r.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${J.state}, mruResult MruDocuments is null: ${!J.vvd}`):r.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;J=J.vvd;const R=["xlsx","xlsb","xlsm"];for(let L=0;L<J.length;L++){var M=J[L];if(0>Array.indexOf(R,M.extension))continue;const U=`${M.title}.${M.extension}`,X=A.b(M,B.AFrameworkApplication.isRtl);M=M.url;U&&X&&M?H.add({[K.fileName]:U,
[K.friendlyPath]:X,[K.section]:"mru",[K.absoluteUrl]:M}):M||r.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return H}dispose(){super.dispose()}}K.fileName="FileName";K.friendlyPath="FriendlyPath";K.section="Section";K.absoluteUrl="AbsoluteUrl";Object(m.a)(K,"NewAndOpenCoreManager",y.a,[621,3]);class G extends v.a{constructor(H){super();this.$=H;this.Fb()}create(){this.qb(this.$.da.za(451)||this.$.da.Ga(451,new K(this.$)))}static ka(H){H.da.Ga(164,
new G(H))}}Object(m.a)(G,"NewAndOpenCoreFactory",v.a,[]);m=a(1148);v=a(1247);y=a(1223);var T=a(1192),W=a(1142),P=a(1140),E=a(1159);a=a(1133);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(t.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(D.a)();Object(c.a)();Object(b.a)();Object(d.a)();Object(e.a)();l.a.Fa(G.ka);Object(k.a)();Object(m.a)();Object(v.a)();Object(y.a)();Object(f.a)();Object(T.a)();Object(W.a)();Object(P.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(E.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/1558ce02e9d6ea05f030df4c084d08e0/EwaDSEsNext.acc.js.map