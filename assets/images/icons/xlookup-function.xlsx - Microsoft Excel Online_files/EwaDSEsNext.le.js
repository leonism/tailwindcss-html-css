'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1226:function(t,D,a){t=a(0);var c=a(7),b=a(15),d=a(27),f=a(86),e=a(13),k=a(84),l=a(412),m=a(78),v=a(8),n=a(67),w=a(453);class r{constructor(fa,S){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=S;this.parentElement=fa}Z3g(){const fa=this.$3g();w.a(this.$,243,242,0,S=>{this.cardViewManager=S;S.a2f(this.parentElement,2,fa)})}B6e(){this.cardViewManager&&
this.cardViewManager.sKa(-1,-1,this.parentElement)}$3g(){const fa={layoutId:"AutoDetectTooltip"};fa.description=this.longDescription;fa.convertToDomainName=this.convertToDomainName;fa.longDescription=this.longDescription;fa.urlValue=this.urlValue;fa.imageAltText=this.imageAltText;fa.helpText=this.helpText;fa.helpId=this.helpId;return fa}}Object(t.a)(r,"AutoDetectCardManager",null,[]);var u=a(30),x=a(211),z=a(29),B=a(221),y=a(19),A=a(54);class K extends m.a{constructor(fa,S){super();this.dd=ka=>{if(ka.Cb.id===
this.PHa.firstChild.id){ka=this.Cre;const V={};V.Id=ka.Enb;this.convertToLinkedEntityManager.b1c(V,!0,ka);this.PHa.removeChild(this.PHa.firstChild);return!0}return!1};this.Cre=fa;this.convertToLinkedEntityManager=S;this.PHa=document.createElement("div");this.PHa.className="clip16x16";this.Cva=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.Dg("autodetectid"+this.Cre.left),y.a.b8c,A.a.gf(11));this.PHa.innerHTML=this.Cva;
fa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.ra(e.a.click,fa,this.dd)}get domElement(){return this.PHa}dispose(){if(this.PHa){const fa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.Ba(e.a.click,fa,this.dd)}super.dispose()}static get ERg(){return"clip16x16"}}Object(t.a)(K,"AutoDetectColumnHeaderButton",m.a,[]);var G=a(1),T=a(1082),W=a(11),P=a(21),E=a(164);class H extends m.a{constructor(fa,S){super();this.$=fa;this.gridView=
P.g(fa);this.convertToLinkedEntityManager=S;this.P_c=new E.a}dispose(){super.dispose()}kfh(fa){for(let S of this.gridView.ZX)for(let ka of S){const V=ka,wa=V.Sn,ma=T.a(V.G3);this.Uzg(fa,ma,wa);V.tNd(ma)}}Uzg(fa,S,ka){if(S.length){var V=ka.length;ka[V-1]<fa.left||(ka=W.HelperMethods.qx(new x.a(ka),0,V,fa.left,W.HelperMethods.iD),0>ka||!(S=S[ka]))||(this.gridView.rtl?S.classList.add(u.a.kth):S.classList.add(u.a.jth),this.P_c.lb(fa.left)||this.P_c.add(fa.left,new K(fa,this.convertToLinkedEntityManager)),
fa=this.P_c.na(fa.left).domElement,!S.getElementsByClassName(K.ERg).length&&this.NCj(S)&&S.appendChild(fa))}}NCj(fa){const S=parseInt(fa.style.width,10),ka=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";fa=gridRenderer.CanvasRendererGlobals.measureTextWidth(fa.firstChild.innerHTML,H.J5g(ka),!0,G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<S-(S/2+fa/2)?!0:!1}static J5g(fa){return`${"normal"} ${"normal"} ${fa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}
Object(t.a)(H,"AutoDetectColumnHeaderManager",m.a,[]);var F=a(420),N=a(24),J=a(64),R=a(145),M=a(12),L=a(14),U=a(182),X=a(69);a.d(D,"a",function(){return da});class da extends m.a{constructor(fa,S,ka,V){super();this.isMac=d.a.isMac;this.sXa=-1;this.s3b=null;this.Dsa=-1;this.cN=this.bhc=this.jRd=this.FZ=this.Dre=!1;this.jT=null;this.zg=()=>{this.Mva&&this.gridView&&this.kW()};this.Dc=()=>{this.Sx()};this.dd=()=>{this.OGa();P.g(this.$).gg(!0,!1)};this.u5=(ma,ab)=>{ab?(this.obg(this.s3b),this.Pcb()):
(ma=[29],this.gridView.ob.Tg(ma),this.gridView.ob.wi(null,ma),this.jT&&this.jT.B6e())};this.Wi=()=>{this.T5a()&&this.Vh.hide();1===this.gridView.ha.Ke&&this.kW()};this.YQ=()=>{const ma=this.gridView.ha.Ke;this.gridView.ha.sa.activeCell&&1===ma&&this.kW()};this.onKeyUp=ma=>this.DAb?this.FZ?!1:17===ma.Ca.keyCode&&this.jRd?(this.cN?(this.Pcb(),this.Nca()):this.VJb(),!0):!1:this.FZ=!1;this.onKeyDown=ma=>{if(!this.DAb)return this.FZ=!1;this.jRd=!1;this.FZ=ma.ctrlKey;switch(ma.Ca.keyCode){case 27:return this.cN?
(this.u5(null,!1),this.Nca()):this.jT&&(this.jT.B6e(),this.VJb()),!0;case 13:if(this.cN)return this.cN=!1,this.OGa(),!0;break;case 17:return this.jRd=!0}return!1};const {AutoDetectActionButton:wa}=a(1334);this.$=fa;this.Fnb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);S||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=V;V.zFb();this.Vh=new wa(fa,S,this.dd,ka,
"");this.fMg=new H(this.$,V);this.gridView=P.g(this.$);this.gridView.ha.cT(this.zg);this.gridView.Wb.KXa(this.zg);this.gridView.Nu(this.YQ);fa.ik(this.Dc);fa.GA(this.Wi);this.gridBlockManager=Object(k.a)(420,this.gridView.Ea);this.Eq=fa.frame.xt;this.kW()}get lc(){return this.Vh.domElement(1)}get DAb(){const fa=this.Vh.domElement(da.Uda);return fa?M.DOMElementExtensions.isVisible(fa):!1}get Mva(){return this.$.isEditMode&&G.EwaSettings.ma(135)&&G.EwaSettings.ma(138)&&(new R.a(this.$.xa)).ii?!1:-1!==
this.Dsa}dispose(){this.gridView&&this.gridView.ha.qR(this.zg);if(this.$){const fa=this.$;fa.Bl(this.Dc);fa.AD(this.Wi);P.g(fa).qy(this.YQ)}f.a.Ia(this.Vh);this.Eq=this.$=this.gridView=this.Vh=null;super.dispose()}Sx(){this.u5(null,!1);this.sXa=-1;this.Vh.hide();this.XNj();this.cN=!1}Nca(){this.Vh.getButton(da.Uda).Zab();this.cN=!1}VJb(){this.Vh.getButton(da.Uda).tFb();this.obg(this.s3b);this.cN=!0;this.$.da.Za(211,fa=>{fa.YOa(L.a.instance.ga(1743))})}onAutoDetectUIShown(){if(this.Mva&&-1!==this.sXa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}gMg(fa){var S=
new N.Range(1===fa.top?1:fa.top-1,fa.left,fa.bottom,fa.right,!0,!1);S=this.gridView.getRangeInformation(S);for(const ka of S)if(Object(l.a)(F.AutoDetectRange,ka)&&this.Wdc(fa,!1,ka))return!0;return!1}OGa(){if(this.Mva&&-1!==this.sXa){this.Vh.getButton(da.Uda).tFb();var fa={};fa.Id=this.Dsa;fa.StringId=null;this.convertToLinkedEntityManager.b1c(fa,!0,this.s3b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");fa=[Object(c.a)(new X.a,{name:"Domain",
int64:this.Dsa})];U.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,fa);this.Dsa=-1}}rIh(){let fa=L.a.instance.ga(1739);if(-1!==this.Dsa){fa+=" ";try{fa+=this.convertToLinkedEntityManager.Wzb(this.Dsa.toString())}catch(S){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Dsa}`)}}fa+=" ";return fa=this.Fnb?fa+L.a.instance.ga(1742):fa+L.a.instance.ga(this.isMac?1741:1740)}Pcb(){this.Fnb&&(this.jT||(this.jT=new r(this.lc,
this.$),this.jT.convertToDomainName=L.a.instance.ga(1744),this.jT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.jT.imageAltText=L.a.instance.ga(1746),this.jT.helpId="HID_DataTypes_Wolfram",this.jT.helpText=L.a.instance.ga(1745)),this.jT.longDescription=this.convertToLinkedEntityManager.$Ud(this.sXa.toString()),this.jT.Z3g())}Wdc(fa,S,ka){if((new N.Range(ka.top,ka.left,ka.bottom===v.a.mh?ka.bottom:ka.bottom+1,ka.right,!0,!1)).Ed(fa)){if(S){if(ka&&
ka.Enb!==this.sXa){this.sXa=ka.Enb;fa=ka.Enb.toString();S=this.Fnb?"":this.convertToLinkedEntityManager.$Ud(fa);const V=this.convertToLinkedEntityManager.F6h(fa);this.Vh.Geb(this.convertToLinkedEntityManager.Wzb(fa),S,V,da.Uda)}this.Dsa=ka.Enb;this.s3b=ka}return!0}return!1}kW(){if(this.convertToLinkedEntityManager){var fa=this.gridView.ha.Ke;if(this.gridBlockManager&&this.gridBlockManager.Tgd){var S=this.gridView.ha.sa.activeCell,ka=!this.gridBlockManager.Qr(S),V=this.gridView.getRangeInformation(this.gridView.lh);
for(const wa of V)if(Object(l.a)(F.AutoDetectRange,wa))switch(V=wa,V.JWg){case 3:if(this.Wdc(S,!0,V)){if(1!==fa||ka){this.Sx();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.BGd();this.Vh.Yza(S,this.u5);this.Dre||(this.Dre=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(G.EwaSettings.ma(471)||G.EwaSettings.ma(472))&&this.fMg.kfh(V);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Sx()}}obg(fa){const S=
[29];this.gridView.ob.wi(fa,S);this.gridView.ob.Bn(S)}T5a(){return this.$.ea.isNamedObjectViewMode&&J.f(this.$.oa)}BGd(){this.Fnb&&!this.bhc&&this.Eq&&(this.Eq.pt(e.a.Mb,this.$.domElement,this.onKeyDown,!0),this.Eq.pt(e.a.Gd,this.$.domElement,this.onKeyUp,!0),this.bhc=!0)}XNj(){this.Fnb&&this.bhc&&this.Eq&&(this.Eq.At(e.a.Mb,this.$.domElement,this.onKeyDown,!0),this.Eq.At(e.a.Gd,this.$.domElement,this.onKeyUp,!0),this.bhc=!1)}static get Uda(){return 1}static wKh(fa){return L.a.instance.ga(1800)+n.a.space+
fa}}Object(t.a)(da,"AutoDetectManager",m.a,[])},1334:function(t,D,a){a.r(D);a.d(D,"AutoDetectActionButton",function(){return e});t=a(0);D=a(78);var c=a(1226),b=a(54),d=a(14),f=a(21);class e extends D.a{constructor(k,l,m,v,n){super();this.$=k;this.Fp=v.Y2b(k,l,m,"",b.a.gf(11),n,"AutoDetectPointerDown",d.a.instance.ga(1800)+"...")}get mz(){return this.Fp.mz}dispose(){this.Fp.dispose();this.$=null;super.dispose()}domElement(k){return this.Fp.domElement(k)}getButton(k){return this.Fp.getButton(k,!1)}Geb(k,
l,m,v){this.Fp.bTa(c.a.wKh(k),l,v);this.Fp.icg(m,l,v)}Yza(k,l){const m=f.g(this.$),v=m.hb.jj(k);k=m.lg(k,v);const n=m.Lf(v).tn;if(k&&0<=k.x&&0<=k.y&&n.width>k.width+160){let w=k.bottomRight.x+this.mz,r=k.topLeft.y+this.mz,u=!1;w+160>n.bottomRight.x&&(w=k.topLeft.x-this.mz,u=!0);if(r<n.topLeft.y+this.mz){if(m.hb.GSa){this.hide();return}r=n.topLeft.y+this.mz}this.Fp.Z5b(l,v);this.xp(w,r,m.rtl,v,u)}else this.hide()}xp(k,l,m,v,n){this.Fp.xp(k,l,m,v,!1,n)}hide(){this.Fp.hide()}}Object(t.a)(e,"AutoDetectActionButton",
D.a,[])},1440:function(t,D,a){a.r(D);t=a(0);var c=a(690),b=a(15),d=a(5),f=a(77),e=a(37),k=a(1),l=a(181),m=a(21),v=a(182);class n{constructor(J,R){this.$=R;this.convertToLinkedEntityManager=J}Qc(J,R){switch(R){case -1203788282:case 48568533:case -1662108744:return J=m.g(this.$),R=this.convertToLinkedEntityManager.Uyi||7E3,(null===J||void 0===J?0:J.ha)&&J.ha.sa.Wc.TG>R?!0:!1;default:return!1}}executeCommand(J,R,M){J=e.TaskExtensions.vk();R=R.command;switch(R){case -1203788282:this.convertToLinkedEntityManager.t2g(M[f.a.Oc].toString());
break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(M[f.a.Oc].toString());break;case 1266950951:this.convertToLinkedEntityManager.Ypi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();
break;case -1081442996:k.EwaSettings.ma(649)&&this.convertToLinkedEntityManager.zJe();break;case 1702917262:k.EwaSettings.ma(649)&&this.convertToLinkedEntityManager.showHelpArticle(d.a.nPj);break;case -90814711:k.EwaSettings.ma(649)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===R||M[f.a.fjf]&&"ConvertToLinkedEntityGallery"===M[f.a.fjf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),
v.a("ExpandDataTypeGallery");break;default:J=l.a(R)}return J}Ec(J,R){switch(R.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return k.EwaSettings.ma(130);case -1081442996:case 1702917262:case -90814711:return k.EwaSettings.ma(649);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Vc(J,R,M){return"PopulateConvertToLinkedEntityMenu"===R&&k.EwaSettings.ma(130)?this.convertToLinkedEntityManager.Vc(J,R,M):!1}}Object(t.a)(n,
"ConvertToLinkedEntityCommandHandler",null,[188]);var w=a(453);class r extends c.a{constructor(J){super(J)}Dd(){w.a(this.$,271,272,this.ib,J=>{this.ld([new n(J,this.$)])})}static ka(J){c.a.Rd(273,new r(J))}}Object(t.a)(r,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);D=a(220);var u=a(756),x=a(50),z=a(413),B=a(695);class y extends D.a{constructor(J){super();this.$=J;this.Fb()}create(){const J=x.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.ib),R=x.GetServiceTaskFactory.Ta(this.$.da,
5,4,this.ib),M=x.GetServiceTaskFactory.Ta(this.$.da,388,387,this.ib);if(this.$.Ol)e.TaskExtensions.Aa(e.TaskExtensions.Xd([J,R,M],this.la),()=>{const L=Object(B.a)(this.$.da,271,()=>new u.ConvertToLinkedEntityManager(this.$,J.result,M.result,null,null,R.result));this.qb(L)},this.$.la,3);else{const L=x.GetServiceTaskFactory.Ta(this.$.da,257,258,this.ib),U=z.a(this.$);e.TaskExtensions.Aa(e.TaskExtensions.Xd([J,L,U,R,M],this.la),()=>{this.qb(this.$.da.za(271)||new u.ConvertToLinkedEntityManager(this.$,
J.result,M.result,L.result,U.result,R.result))},this.$.la,3)}}static ka(J){J.da.Ga(272,new y(J))}}Object(t.a)(y,"ConvertToLinkedEntityManagerFactory",D.a,[]);var A=a(234),K=a(258),G=a(36),T=a(245),W=a(12),P=a(699);const E=a(19).a.Tsh;class H extends A.a{constructor(J,R,M){super(J);this.vu=0;this.yp=!1;this.Dc=()=>{this.hg(!1)};this.$=R;this.taskPaneManager=M;K.a(R).Xh(this);this.$.ik(this.Dc);G.a.zd(this.$)&&(this.isVisible=!1)}bP(J){this.get_events().addHandler("EnrichmentTaskPaneRemoved",J)}pR(J){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",
J)}mE(J){this.addHandler("EnrichmentTaskPaneVilibilityChanged",J)}SF(J){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",J)}nFg(J){this.addHandler("EnrichmentTaskPaneOnFocus",J)}kbj(J){this.removeHandler("EnrichmentTaskPaneOnFocus",J)}get isVisible(){return super.isVisible}set isVisible(J){super.isVisible=J;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get jf(){return this.isVisible}get Zd(){return T.a.dkh}get Wg(){return 10}get Sk(){return E}get QM(){return this.titleText}get titleText(){return"Enrichment"}get wo(){return 300}get isResizable(){return!1}get lc(){return this.domElement}get height(){return this.taskPaneManager.mO.offsetHeight}get LB(){return this.taskPaneManager.iua(this.lc,
this.titleText,this.wo,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.wo)}xH(){}hp(){return this.yp}Yr(){return this.yp}cR(){}dispose(){this.$&&this.$.Bl(this.Dc);this.taskPaneManager=this.$=null;super.dispose()}gg(J,R){R||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!R}hh(J){return W.DOMElementExtensions.uf(this.lc,J)}kj(){}Mj(){}hg(J){this.yp=J;const R=this.taskPaneManager;this.isVisible=J;G.a.zd(this.$)?J?this.taskPaneManager.K5("EnrichmentTaskPane",
this.LB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(J&&0<R.aA.length&&(!R.Bg||10!==R.Bg.taskPane.Wg||R.isCollapsed)&&R.WF(this,!0),R.Vw());J||(m.g(this.$).gg(!0,!1),this.$.pf())}nQ(){return!1}static ka(J,R){var M=J.Bb;let L=document.getElementById(M+d.a.XJe);L||(L=P.a("div",J.Bb+d.a.XJe,"cui-taskpane"),G.a.zd(J)||(M=document.getElementById(M+d.a.VQ),void 0!==M&&null!==M?M.appendChild(L):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${J.aD}`)));
M=J.da;return M.za(257)||M.Ga(257,new H(L,J,R))}}Object(t.a)(H,"EnrichmentTaskPane",A.a,[419,3,247,110]);class F extends D.a{constructor(J){super();this.$g=this.mi=null;this.$=J;this.Fb()}get qD(){this.mi||(this.mi=e.TaskExtensions.Aa(z.a(this.$),J=>{this.$g=H.ka(this.$,J.result)},this.la,3));return this.mi}create(){const J=x.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ib),R=x.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib);e.TaskExtensions.Aa(e.TaskExtensions.ts(e.TaskExtensions.Xd([J,
R],this.la),()=>this.qD,this.la),()=>{this.qb(this.$g)},this.la,3)}dispose(){this.$g=this.mi=this.$=null;super.dispose()}static ka(J){J.da.Ga(258,new F(J))}}Object(t.a)(F,"EnrichmentTaskPaneFactory",D.a,[]);var N=a(10);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{N.a.Fa(J=>{F.ka(J);y.ka(J);r.ka(J)})})()},756:function(t,D,a){a.r(D);var c=a(0),b=a(15),d=a(86),f=a(262),e=a(4),k=a(29),l=a(810),m=a(136),v=a(82),n=a(84),w=a(38),r=a(19),u=a(5),x=a(161),z=a(1226),B=
a(1229),y=a(171),A=a(551),K=a(341),G=a(62);const T=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"GetRichDataClassificationLabels",Jc,Yb,Gb,wb,dc,4)},W=(jb,Yb,Gb,wb,dc,Jc,Qc,fd,Wc=null)=>{Wc=jb.Na(1,Wc);Wc.selectedRanges=Yb;Wc.domainId=Gb;Wc.autodetect=wb;return G.g(jb,"ConvertToLinkedEntity",Wc,dc,Jc,Qc,fd,4)},P=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"OnAutoDetectUIShown",Jc,Yb,Gb,wb,dc,4)},E=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"GetLinkedEntityMetadata",
Jc,Yb,Gb,wb,dc,4)},H=(jb,Yb,Gb,wb,dc,Jc,Qc=null)=>{Qc=jb.Na(1,Qc);Qc.selectedRanges=Yb;return G.g(jb,"ConvertLinkedEntityToText",Qc,Gb,wb,dc,Jc,4)},F=(jb,Yb,Gb,wb,dc,Jc,Qc=null)=>{Qc=jb.Na(1,Qc);Qc.selectedRanges=Yb;return G.g(jb,"RefreshLinkedEntitiesInRange",Qc,Gb,wb,dc,Jc,4)},N=(jb,Yb,Gb,wb,dc,Jc,Qc,fd,Wc,Rb,Sb=null)=>{Sb=jb.Na(1,Sb);Sb.selectedRanges=Yb;Sb.isChangeObject=Gb;Sb.isFloodgateEnabled=wb;Sb.isStarterData=dc;Sb.starterDataDomainId=Jc;return G.g(jb,"GetDataSelectorPaneData",Sb,Qc,fd,
Wc,Rb,4)},J=(jb,Yb,Gb,wb,dc,Jc,Qc,fd=null)=>{fd=jb.Na(9,fd);fd.activeCell=Yb;fd.selectionIndex=Gb;return G.g(jb,"SelectLinkedEntityForDisambiguation",fd,wb,dc,Jc,Qc,4)},R=(jb,Yb,Gb,wb,dc,Jc,Qc,fd,Wc,Rb,Sb,mc=null)=>{mc=jb.Na(1,mc);mc.searchCell=Yb;mc.searchQuery=Gb;mc.isFloodgateEnabled=wb;mc.isStarterData=dc;mc.starterDataDomainId=Jc;mc.starterDataDomainIdString=Qc;return G.g(jb,"LinkedEntitySearch",mc,fd,Wc,Rb,Sb,4)},M=(jb,Yb,Gb,wb,dc,Jc,Qc,fd,Wc=null)=>{Wc=jb.Na(1,Wc);Wc.cell=Yb;Wc.starterDataDomainId=
Gb;Wc.starterDataDomainIdString=wb;return G.g(jb,"InsertStarterDataTable",Wc,dc,Jc,Qc,fd,4)},L=(jb,Yb,Gb,wb,dc,Jc,Qc,fd=null)=>{fd=jb.Na(1,fd);fd.activeCell=Yb;fd.isBackward=Gb;return G.g(jb,"MoveToNextAmbiguousLinkedEntity",fd,wb,dc,Jc,Qc,4)},U=(jb,Yb,Gb,wb,dc,Jc,Qc=null)=>{Qc=jb.Na(9,Qc);Qc.activeCell=Yb;return G.g(jb,"CancelSearchLinkedEntity",Qc,Gb,wb,dc,Jc,4)},X=(jb,Yb,Gb,wb,dc,Jc,Qc,fd=null)=>{fd=jb.Na(1,fd);fd.selectedRanges=Yb;fd.letyDomainId=Gb;return G.g(jb,"GetDataTypeSelectorData",fd,
wb,dc,Jc,Qc,4)},da=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"GetErrorMessageForLinkedDataTypeRefresh",Jc,Yb,Gb,wb,dc,4)},fa=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"GetHasUntrustedImageUrls",Jc,Yb,Gb,wb,dc,4)},S=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"LinkedEntitiesEnableUntrustedImages",Jc,Yb,Gb,wb,dc,0)},ka=(jb,Yb,Gb,wb,dc,Jc=null)=>{Jc=jb.Na(1,Jc);return G.g(jb,"LinkedEntityTryAutoRefresh",Jc,Yb,Gb,wb,dc,0)};var V=a(83),wa=a(699),ma=a(785);class ab{}
ab.z6h="EnrichmentContentFrame";ab.width=320;Object(c.a)(ab,"EnrichmentConstants",null,[]);class ba{constructor(jb){this.messageType=0;this.messageType=jb}}Object(c.a)(ba,"EnrichmentResponseMessage",null,[]);class Ca extends ba{constructor(jb,Yb){super(jb);this.messageContent=null;this.messageContent=Yb}}Object(c.a)(Ca,"EnrichmentResponseMessageWithContent",ba,[]);class Na extends Ca{constructor(jb,Yb,Gb){super(jb,Yb);this.telemetryJson=null;this.telemetryJson=Gb}}Object(c.a)(Na,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ca,[]);var za=a(259),la=a(13),aa=a(94),sa=a(44),ea=a(85),Z=a(108),ua=a(41),ya=a(80),ha=a(27),Da=a(106),nb=a(691),qa=a(25);class pa{constructor(jb,Yb,Gb,wb,dc){this.Uq=this.fk=this.Q6d=this.P6d=this.Nv=this.Gu=null;this.$w=!1;this.xi=jb;this.Yd=Yb;this.MO=Gb;this.Yb=wb;this.La=dc;this.dpa=Z.KeyInputManager.vl(ea.a.iBa,0)}get yKb(){return!0}get asb(){return e.AFrameworkApplication.fa.Va("EnrichmentPaneUrl")}dispose(){this.yKb&&this.Uq&&(this.xi.Ba(la.a.click,this.Uq,Object(V.a)(this,this.$j,"onClosePaneClick")),
this.Yd.Ba(la.a.Gd,this.Uq,Object(V.a)(this,this.Lxf,"onKeyHide")));this.Uq=null;this.Nv&&(this.DOj(),this.Nv.parentNode.removeChild(this.Nv),this.Nv=null);this.Yb.ti("EnrichmentPaneId").tk(this.dpa)}show(jb,Yb,Gb){this.Gu=jb;this.$w||(this.fk=this.T_a(),this.Sca.appendChild(this.fk),this.B7i(),this.La.Ob(qa.a.fye,Da.a.frame,Object(V.a)(this,this.n1h,"handleEscapeKeyAction")),this.bRa(),this.$w=!0);this.Nv.src=this.asb&&this.asb.length?this.asb+"?culture="+Yb.market+"&appName="+Yb.applicationName+
"&themeId="+Yb.themeId+"&featuresBitMask="+Yb.featuresBitMask:pa.Arf;this.P6d=Yb;this.Q6d=Gb;this.Kcb()}aAc(jb,Yb){jb=new Na(2,jb,Yb);this.uoc(jb)}bRa(){const jb=this.Yb.ti("EnrichmentPaneId");jb.parent=za.AFrame.eNa;this.xi.Ylb("EnrichmentPaneId",this.fk);jb.bindAction(this.dpa,qa.a.fye)}vYf(){if(this.Nv){aa.FocusManager.Kna(this.Nv.contentWindow);const jb=new Na(4,null,null);this.uoc(jb)}}$j(){this.d1b();return!0}Lxf(jb){jb=jb.Ca.keyCode;return jb===Sys.UI.Key.enter||jb===Sys.UI.Key.space?(this.d1b(),
!0):!1}d1b(){this.hide();if(this.Gu)this.Gu.onPaneClosed()}T_a(){const jb=wa.a("div","EnrichmentPaneId","EnrichmentPane");this.yKb&&jb.appendChild(this.c2c());this.l$h(jb);return jb}c2c(){const jb=wa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Yb=wa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Yb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;Yb.title=CommonUIStrings.l_EnrichmentPaneTitle;const Gb=ma.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",
CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.xi.ra(la.a.click,Gb,Object(V.a)(this,this.$j,"onClosePaneClick"));this.Yd.ra(la.a.Gd,Gb,Object(V.a)(this,this.Lxf,"onKeyHide"));jb.appendChild(Yb);jb.appendChild(Gb);this.Uq=Gb;return jb}l$h(jb){this.Nv=wa.b("iframe","","EnrichmentFrame");jb.appendChild(this.Nv);this.Nv.id=ab.z6h;this.Nv.setAttribute("role","presentation")}B7i(){sa.a.addHandler(this.Nv,"load",Object(V.a)(this,this.mxf,"onIFrameLoad"));sa.a.addHandler(this.Nv,"error",Object(V.a)(this,
this.Klc,"onIFrameError"));$addHandler(window,"message",Object(V.a)(this,this.nxf,"onIFrameMessage"))}DOj(){sa.a.removeHandler(this.Nv,"load",Object(V.a)(this,this.mxf,"onIFrameLoad"));sa.a.removeHandler(this.Nv,"error",Object(V.a)(this,this.Klc,"onIFrameError"));$removeHandler(window,"message",Object(V.a)(this,this.nxf,"onIFrameMessage"))}ibh(){this.Nv.src=pa.Arf}hide(){this.dcc();this.ibh()}n1h(jb,Yb,Gb){if(1!==Gb&&(this.hide(),this.Gu))this.Gu.onPaneClosed();return 32}mxf(){}Klc(){}nxf(jb){jb=
jb.rawEvent;if(!this.Nv||-1!==this.Nv.src.indexOf(jb.origin)){try{var Yb=ua.a(jb.data)}catch(Gb){return}if(!nb.c(Yb.messageType)){jb=window.g_badCastCallback;window.g_badCastCallback=null;switch(Yb.messageType){case 2:this.uoc(new Na(1,ua.c(this.P6d),this.Q6d));break;case 1:this.uoc(new Ca(0,this.QGh()));break;case 3:this.Gu&&this.Gu.selectEntity(Yb.messageContent);break;case 5:this.Gu&&this.Gu.dCb(Yb.messageContent);break;case 8:this.Gu&&(Yb=ua.a(Yb.messageContent),0<Yb.DomainId?this.Gu.DLd(Yb.Query,
Yb.TelemetryJson,Yb.DomainId,Yb.DomainIdString):this.Gu.searchEntity(Yb.Query,Yb.TelemetryJson));break;case 6:this.Gu&&this.Gu.cancelSearch();break;case 11:Yb=ua.a(Yb.messageContent);Yb=pa.U2b("keydown","f6",ea.a.jCc,!0,!1,Yb,!0,!1);this.Nv&&this.Nv.dispatchEvent(Yb);break;case 12:if(ua.a(Yb.messageContent).keyCode===ea.a.uL&&(Yb=pa.U2b("keydown","esc",ea.a.uL,!0,!1,!1,!1,!1),this.Nv&&(this.Nv.dispatchEvent(Yb),this.hide(),this.Gu)))this.Gu.onPaneClosed();break;case 13:this.Gu&&this.Gu.selectDataType(Yb.messageContent);
break;case 14:this.Gu&&this.Gu.showHelpArticle(Yb.messageContent);break;case 15:this.Gu&&this.Gu.showSurveyDialog(Yb.messageContent);break;case 16:this.Gu&&(Yb=ua.a(Yb.messageContent),this.Gu.insertTable(Yb.DomainId,Yb.DomainIdString))}window.g_badCastCallback=jb}}}QGh(){return ua.c([2,1,3,5,8,6])}uoc(jb){jb=ua.c(jb);this.Nv.contentWindow.postMessage(jb,ya.a.gaa(this.asb))}static U2b(jb,Yb,Gb,wb,dc,Jc,Qc,fd){ha.a.lv?(Jc=String.format("{0} {1} {2}",Jc?"Shift":"",Qc?"Control":"",fd?"Alt":""),Jc.trim(),
Gb=document.createEvent("KeyboardEvent"),Gb.initKeyboardEvent(jb,wb,dc,window.self,Yb,0,Jc,!1,"en-US")):(Yb={},Yb.keyCode=Gb,Yb.ctrlKey=Qc,Yb.shiftKey=Jc,Yb.altKey=fd,Yb.bubbles=wb,Yb.cancelable=dc,Gb=new KeyboardEvent(jb,Yb));return Gb}}pa.Arf="about:blank";Object(c.a)(pa,"EnrichmentPane",null,[562,3]);class Ja extends pa{constructor(jb){super(e.AFrameworkApplication.ta.zy,e.AFrameworkApplication.ta.xt,e.AFrameworkApplication.ta.Dda,e.AFrameworkApplication.ta.Ee,e.AFrameworkApplication.wb);this.taskPane=
jb;this.taskPane.nFg(this.vYf)}get Sca(){return this.taskPane.lc}set Sca(jb){this.taskPane.lc.innerHTML=jb.innerHTML}Kcb(){this.taskPane.isVisible||this.taskPane.hg(!0)}dcc(){this.taskPane.hg(!1)}dispose(){this.taskPane&&(this.taskPane.kbj(this.vYf),this.taskPane=null);super.dispose()}}Object(c.a)(Ja,"EnrichmentTaskPaneWrapper",pa,[]);class $a{constructor(jb){this.Hy=null;this.Fea=jb}aqi(jb,Yb){this.Hy=jb;this.Fea&&this.Fea.show(this,Yb,null)}aAc(jb,Yb){this.Fea&&this.Fea.aAc(jb,Yb)}vwb(){this.Fea&&
this.Fea.hide()}dispose(){this.Fea&&(this.Fea.dispose(),this.Fea=null)}selectEntity(jb){return this.Hy?this.Hy.selectEntity(jb):!1}searchEntity(jb,Yb){this.Hy&&this.Hy.searchEntity(jb,Yb)}DLd(jb,Yb,Gb,wb){this.Hy&&this.Hy.DLd(jb,Yb,Gb,wb)}dCb(jb){return this.Hy?this.Hy.dCb(jb):!1}onPaneClosed(){if(this.Hy)this.Hy.onPaneClosed()}cancelSearch(){this.Hy&&this.Hy.cancelSearch()}selectDataType(jb){this.Hy&&this.Hy.selectDataType(jb)}showHelpArticle(jb){this.Hy&&this.Hy.showHelpArticle(jb)}showSurveyDialog(jb){this.Hy&&
this.Hy.showSurveyDialog(jb)}insertTable(jb,Yb){this.Hy&&this.Hy.insertTable(jb,Yb)}}Object(c.a)($a,"EnrichmentManager",null,[563,3]);class rb extends $a{constructor(jb){super(jb)}dispose(){super.dispose()}}Object(c.a)(rb,"ExcelEnrichmentManager",$a,[]);var Pa=a(14);class eb{constructor(jb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=
null;this.campaignId=jb;this.commentQuestion=Pa.a.instance.mb(198);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Pa.a.instance.mb(194);this.ratingValuesAscending=[Pa.a.instance.mb(195),Pa.a.instance.mb(196),Pa.a.instance.mb(197)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Pa.a.instance.mb(193)}}Object(c.a)(eb,"FloodgateSurvey",null,[]);var Ob=a(24),tb=a(77),cc=a(415),Ib=a(42),Mb=a(368),Oa=a(170),Aa=a(36),Ba=a(90),ob=a(31),xb=a(1),
Va=a(280),bb=a(21);class ra{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(ra,"EnrichmentMessageContentAppProperties",null,[]);class Qa{constructor(jb,Yb,Gb,wb,dc){this.eta=this.JGe=!1;this.Fbb=this.dwa=!0;this.DEb=this.FKb=!1;this.Vcb=null;this.Enc=0;this.YQ=()=>{(this.Fbb||this.eta)&&2!==this.Enc&&(this.DEb||this.rrd(!1))};this.Xc=
()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.zHi=Jc=>{ob.a.rg(Jc.Errors)?(Jc=ob.a.zc(Jc.Errors),Jc.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Jc}`)):Jc.Result&&(this.$.ea.Hk(this.Xc),this.$.ea.hk(this.Xc),Jc=Jc.Result,this.Vcb=Jc.SkydanceFeatureBitmask,this.tvd(Jc),this.FKb=
!0)};this.zg=()=>{(this.Fbb||this.eta)&&this.rrd(!1)};this.Elc=(Jc,Qc)=>{ob.a.rg(Jc.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${ob.a.zc(Jc.Errors)}`):Jc.Result&&(Jc=Jc.Result,Jc.DisambiguationJson?(this.FKb=!1,this.tZf(Qc),this.Vcb=Jc.SkydanceFeatureBitmask,Qc=Jc.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.DEb=!1,this.djf(Qc)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.ZJi=(Jc,Qc)=>{ob.a.rg(Jc.Errors)?(Qc=ob.a.zc(Jc.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${Qc}`)):Jc.Result&&(Jc=Jc.Result,Jc.DisambiguationJson?(this.tZf(Qc),this.Vcb=Jc.SkydanceFeatureBitmask,Qc=Jc.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.DEb=!0,this.djf(Qc)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.GNi=Jc=>{ob.a.rg(Jc.Errors)?(Jc=ob.a.zc(Jc.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Jc}`),this.Fbb=!0):Jc.Result&&(Jc=Jc.Result,this.Vcb=Jc.SkydanceFeatureBitmask,this.tvd(Jc),this.FKb=!0)};this.wQi=Jc=>{if(ob.a.rg(Jc.Errors)){const Qc=ob.a.zc(Jc.Errors);b.ULS.sendTraceTag(36975691,
0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${Qc}`)}Jc.Result?(this.tvd(Jc.Result),this.FKb=!0):this.csa()};this.fBf=Jc=>{ob.a.rg(Jc.Errors)?(Jc=ob.a.zc(Jc.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Jc}`)):Jc.Result?this.g6b.aAc(Jc.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.csa())};
this.mMi=Jc=>{ob.a.rg(Jc.Errors)?(Jc=ob.a.zc(Jc.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Jc}`)):this.csa()};this.$=jb;this.gridView=bb.g(this.$);this.gridView.ha.cT(this.zg);this.gridView.Nu(this.YQ);this.wKe=wb;this.convertToLinkedEntityManager=dc;Aa.a.zd(this.$)||Gb.tQ(Yb);jb=new Ja(Yb);this.g6b=new rb(jb);v.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Jc=>{Jc.isFeatureEnabled("mso_sendASmile",!0).then(Qc=>
{this.dwa=Qc;return null})})}dispose(){this.$&&(this.gridView.ha.qR(this.zg),this.gridView.qy(this.YQ))}selectEntity(jb){const Yb=Ib.o(this.gridView.ha.sa.activeCell,this.$),Gb=()=>new cc.a;Mb.a(this.$.userOperationManager,(wb,dc,Jc)=>J(this.$.pa.va,Yb,jb,Va.b(wb,this.wQi),dc,Jc,null),wb=>new Oa.a(109,0,wb,void 0,Gb),null);return!0}searchEntity(jb,Yb,Gb=!1,wb=0,dc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Yb}`);const Jc=
Ib.o(this.gridView.ha.sa.activeCell,this.$);Mb.a(this.$.userOperationManager,(Qc,fd,Wc)=>R(this.$.pa.va,Jc,jb,this.dwa,Gb,wb,dc,Va.b(Qc,this.fBf),fd,Wc,null),Qc=>new Oa.a(110,0,Qc,16),null)}dCb(jb){const Yb=Ib.o(this.gridView.ha.sa.activeCell,this.$);this.Fbb=!1;Mb.a(this.$.userOperationManager,(Gb,wb,dc)=>L(this.$.pa.va,Yb,jb,Va.b(Gb,this.GNi),wb,dc,null),Gb=>new Oa.a(111,0,Gb,16),null);return!0}onPaneClosed(){this.eta=!1;this.JGe=!0;this.Enc=0;this.DEb=!1}cancelSearch(){const jb=this.VLd();jb&&
Mb.a(this.$.userOperationManager,(Yb,Gb,wb)=>U(this.$.pa.va,jb,Va.b(Yb,this.fBf),Gb,wb,null),Yb=>new Oa.a(112,0,Yb,16),null)}selectDataType(jb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.csa();if(jb&&jb.length)if(jb=JSON.parse(jb))if(null==jb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Yb={};Yb.Id=jb.domainId;Yb.StringId=jb.stringId;
this.convertToLinkedEntityManager.convertToLinkedEntity(Yb)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(jb){const Yb=new Ba.a(-859308420,tb.a.Eb,this.$.Mc,9,null);this.$.Ka.Lb(Yb,{[tb.a.Zf]:"HelpID="+jb,["InputMethod"]:tb.a.Eb,["ShouldCanvasTakeFocus"]:!0,[tb.a.Oc]:u.a.pQ})}showSurveyDialog(jb){B.a.fLb(new eb(jb))}insertTable(jb,
Yb){const Gb=this.VLd();Gb&&Mb.a(this.$.userOperationManager,(wb,dc,Jc)=>M(this.$.pa.va,Gb,jb,Yb,Va.b(wb,this.mMi),dc,Jc,null),wb=>new Oa.a(259,0,wb,1),null)}rrd(jb){this.launchOrCloseDisambiguationPane(jb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const jb=this.klj();jb&&Mb.a(this.$.userOperationManager,(Yb,Gb,wb)=>N(this.$.pa.va,jb,!0,this.dwa,!1,null,
Va.b(Yb,this.ZJi),Gb,wb,1),Yb=>new Oa.a(114,0,Yb,16),null)}launchLinkedEntityDataTypeSelectorPane(jb,Yb){Mb.a(this.$.userOperationManager,(Gb,wb,dc)=>X(this.$.pa.va,jb,Yb,Va.b(Gb,this.Elc),wb,dc,2),Gb=>new Oa.a(233,0,Gb,16),null)}Vpi(jb,Yb){jb&&Mb.a(this.$.userOperationManager,(Gb,wb,dc)=>N(this.$.pa.va,jb,!1,!1,!0,Yb,Va.b(Gb,this.Elc),wb,dc,2),Gb=>new Oa.a(257,0,Gb,16),null)}tZf(jb){jb&&(this.Enc=jb)}djf(jb){if(xb.EwaSettings.ma(649)){var Yb=new Ba.a(-90814711,tb.a.Eb,0,10,null);this.$.Ka.Lb(Yb,
null)}this.eta?this.g6b.aAc(jb,null):(Yb=3,null!=this.Vcb?Yb=this.Vcb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(jb=this.AMh(jb,Yb))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.wKe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.g6b.aqi(this.wKe,jb),this.eta=!0)}csa(){this.eta&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),
this.g6b.vwb(),this.eta=!1,this.Enc=0,this.DEb=!1)}tvd(jb){var Yb=jb.Row+1;jb=jb.Column+1;0>Yb||0>jb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.csa(),this.$.ea.Hk(this.Xc)):(Yb=new Ob.Range(Yb,jb,Yb,jb,!0,!1),this.gridView.ha.updateSelection(Yb,Yb,60),this.Fbb=!0)}AMh(jb,Yb){const Gb=new ra;Gb.applicationVersion=e.AFrameworkApplication.buildVersion;Gb.applicationName="ExcelWac";Gb.anid="00000000-0000-0000-0000-000000000000";
Gb.sessionId=e.AFrameworkApplication.userSessionId;Gb.appCorrelationId=y.a.create().toString();var wb=A.a.mH(e.AFrameworkApplication.lcid);wb=wb?wb.name:null;Gb.uiLanguage=wb;Gb.market=this.V9b(wb);Gb.themeId=0;Gb.disambiguationJson=jb;Yb<=K.a.cS?Gb.featuresBitMask=Yb:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Gb}V9b(jb){jb=jb.split("-");return jb[jb.length-1]}launchOrCloseDisambiguationPane(jb){const Yb=this.gridView.ha.sa.activeCell;
if(this.VLd()&&Yb)if(this.gridView.Db.Fdc(Yb)){if((!this.JGe||jb||this.FKb)&&!this.gridView.$a){jb&&(this.Fbb=!0);var Gb=Ib.q(Yb,this.$);Mb.a(this.$.userOperationManager,(wb,dc,Jc)=>N(this.$.pa.va,Gb,!1,this.dwa,!1,null,Va.b(wb,this.Elc),dc,Jc,1),wb=>new Oa.a(114,0,wb,16),null)}}else this.csa();else this.csa()}m6i(){if(this.eta){var jb=this.gridView.ha.sa.activeCell;if(jb){var Yb=Ib.q(jb,this.$);Mb.a(this.$.userOperationManager,(Gb,wb,dc)=>N(this.$.pa.va,Yb,!1,this.dwa,!1,null,Va.b(Gb,this.Elc),wb,
dc,1),Gb=>new Oa.a(114,0,Gb,16),null)}else this.csa()}}VLd(){const jb=this.gridView.ha.sa;return jb.aba()?Ib.o(jb.activeCell,this.$):null}klj(){const jb=this.gridView.ha.sa;return jb.aba()?Ib.q(jb.activeCell,this.$):null}}Object(c.a)(Qa,"ConvertToLinkedEntityDisambiguationPane",null,[3]);var qb=a(7),Wa=a(372),ta=a(1381),ib=a(54),Bb=a(708);class Ub{constructor(jb,Yb,Gb){this.zjf=2;this.yjf="Size64by48";this.$=jb;this.Sa=Yb;this.convertToLinkedEntityManager=Gb;this.xwa=xb.EwaSettings.ma(669)}JEh(jb,
Yb){var {ConvertToLinkedEntityManager:Gb}=a(756);this.aRj();Yb=this.Sa.pq(Yb).rE();let wb=0,dc=0,Jc=!1;for(var Qc of jb.Categories){const fd=this.pFh(Qc,wb);fd&&(this.xwa&&dc===Gb.w7a&&(Jc=!0),Yb.MenuSectionList.push(fd),++wb);++dc}this.xwa&&Jc&&wb<=Gb.Ajf&&Yb.MenuSectionList.splice(Gb.w7a,1);Gb=this.Sa.Bc().r_b();Qc=ib.a.gf(11);for(const fd of jb.LongButtons)this.convertToLinkedEntityManager.qxj(fd)&&this.TBg(Gb,fd,Qc);0<Gb.ControlList.length&&Yb.MenuSectionList.push(Gb);return Yb}TBg(jb,Yb,Gb){if(Yb){var wb=
"Data.ConvertToLinkedEntityMenuItem_"+Yb.Name,dc=this.convertToLinkedEntityManager.NP(Yb.DomainId);dc&&(Yb=Object(qb.a)(new Wa.a,{Id:wb,ExternalId:wb,Command:"-1662108744",LabelText:Yb.Name,Alt:Yb.SuperTip,Visible:!0,MenuItemId:a(756).ConvertToLinkedEntityManager.T0a(Yb.DomainId),Image16by16:Gb,Image16by16Class:this.g7h(dc.FontLocator)}),jb.ControlList.push(Yb))}}jFh(jb,Yb){return Object(qb.a)(new ta.a,{Id:a(756).ConvertToLinkedEntityManager.sIe+jb.toString(),ExternalId:a(756).ConvertToLinkedEntityManager.sIe+
jb.toString(),MenuItemId:a(756).ConvertToLinkedEntityManager.N5c+jb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.W7e(Yb.FontLocator),LabelText:Yb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.$bd(Yb)})}hMg(jb){switch(jb){case "Animal":return Bb.a.CIg;case "Apple":return Bb.a.FJg;case "Atom":return Bb.a.aLg;case "Beaker":return Bb.a.ZMg;case "Bridge":return Bb.a.zOg;case "Cat":return Bb.a.zUg;case "City":return Bb.a.GWg;
case "Constellation":return Bb.a.D0g;case "Dog":return Bb.a.Mgh;case "Finance":return Bb.a.SMg;case "GradCap":return Bb.a.W_h;case "HumanAnatomy":return Bb.a.w6h;case "LocationPointer":return Bb.a.Bsi;case "Map":return Bb.a.bUi;case "MedicineNeedle":return Bb.a.Yyi;case "Mountain":return Bb.a.pAi;case "Movie":return Bb.a.KAi;case "Music":return Bb.a.XAi;case "OuterSpace":return Bb.a.EUi;case "Planet":return Bb.a.BXi;case "Satellite":return Bb.a.Gij;case "WolframGeneric":return Bb.a.yhj;default:return Bb.a.s2g}}g7h(jb){if("PowerBIRibbon"!==
jb)return r.a.b8c;switch(jb){case "AnimalRibbon":return r.a.ish;case "AppleRibbon":return r.a.jsh;case "AtomRibbon":return r.a.ksh;case "BeakerRibbon":return r.a.lsh;case "BridgeRibbon":return r.a.msh;case "CenterMapRibbon":return r.a.nsh;case "CityRibbon":return r.a.osh;case "CurrencyRibbon":return r.a.psh;case "ExerciseRibbon":return r.a.qsh;case "FinanceRibbon":return r.a.uOe;case "FirstAidRibbon":return r.a.rsh;case "GlobeLightningRibbon":return r.a.ssh;case "GradCapRibbon":return r.a.tsh;case "HumanAnatomyRibbon":return r.a.ush;
case "LeafRibbon":return r.a.vsh;case "LocationPointerRibbon":return r.a.xsh;case "MapRibbon":return r.a.sOe;case "MountainRibbon":return r.a.ysh;case "MovieRibbon":return r.a.zsh;case "MusicRibbon":return r.a.Ash;case "NotablePeopleRibbon":return r.a.Bsh;case "OuterSpaceRibbon":return r.a.Csh;case "PartlySunnyWeatherRibbon":return r.a.Dsh;case "PowerBIRibbon":return r.a.tOe;case "SatelliteRibbon":return r.a.Esh;case "WolframGenericRibbon":return r.a.wsh;case "YogaRibbon":return r.a.Gsh;default:return r.a.rOe}}W7e(jb){switch(jb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";
case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";
case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";
case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}pFh(jb,Yb){Yb=this.Sa.FC("ConvertToLinkedEntitySection_"+Yb,this.zjf,this.yjf);var Gb=!1;for(var wb of jb.DomainIds){const dc=
this.convertToLinkedEntityManager.NP(wb);if(!dc||dc.DomainBlocked||!dc.ShowInRibbon)continue;Gb=dc.Name;const Jc=a(756).ConvertToLinkedEntityManager.T0a(wb);Yb.Lt("Data.ConvertToLinkedEntityMenuItem_"+Jc,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Jc,this.W7e(dc.FontLocator),void 0,void 0,this.$bd(dc),Gb);Gb=!0}if(!Gb)return null;wb=Yb.o_b(!0);Yb=this.Sa.Bc();Yb.title=jb.Name;jb=Yb.r_b();jb.ControlList.push(wb);return jb}aRj(){this.zjf=5;this.yjf="Size112by64"}$bd(jb){return jb.RibbonTooltipHeader?
jb.RibbonTooltipHeader+"\n\n"+jb.RibbonTooltip:jb.RibbonTooltip}}Object(c.a)(Ub,"ConvertToLinkedEntityMenuRenderer",null,[457]);var Ta=a(58),mb=a(247),Qb=a(121),Lb=a(182),Jb=a(69);class Ab{constructor(jb,Yb){this.khd=this.nhd=!1;this.jPi=Gb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.nhd=!0;if(ob.a.rg(Gb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${ob.a.zc(Gb.Errors)}`);else{var wb=0,dc=[],Jc=!1;try{if(!Gb.Result)return;
const Qc=Gb.Result;if(!Qc){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}dc=this.SVi(Qc);if(!dc||!dc.length)return;wb=dc.length;this.mzi(dc);this.rza.URf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.rza.cab.length}`);if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const fd of this.rza.cab)if(1===(fd.Id&1048320)>>8){Jc=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Jc}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${wb} data types.`),Gb=[],Gb.push(Object(qb.a)(new Jb.a,{name:"MruCount",int64:wb})),Gb.push(Object(qb.a)(new Jb.a,{name:"MruWolframAvailable",bool:Jc})),Lb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Gb)}this.khd&&(this.agg(this.rza.cab),this.khd=!1)}};this.BTi=Gb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");ob.a.rg(Gb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${ob.a.zc(Gb.Errors)}`):
Gb.Result&&(Gb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.KAf=(Gb,wb,dc)=>{Gb=Qb.a.kf(Gb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${dc}. Errors: ${ob.a.zc(Gb)}.`)};this.$=jb;this.rza=Yb}sUh(){this.nhd||xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.hc||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
mb.v(this.$.pa.va,0,this.jPi,this.KAf,null,null))}agg(jb){jb&&jb.length?this.nhd?(jb=this.Ymj(jb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),mb.B(this.$.pa.va,0,jb,this.BTi,this.KAf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.khd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}Ymj(jb){if(!jb||
!jb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Yb=[];for(const Gb of jb)jb={},jb.Id=Gb.Id,Gb.StringId&&(jb.StringId=Gb.StringId),Yb.push(jb);Yb="<DataTypes>"+Ta.a.Ac(Yb)+"</DataTypes>";return 1906<Yb.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Yb}SVi(jb){if(!jb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!jb.startsWith("<DataTypes>")||!jb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;jb=jb.substring(11,jb.length-12);if(!jb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Yb=[];try{Yb=Ta.a.Uh(jb)}catch(Gb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Gb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Yb.length} data types.`);return Yb}mzi(jb){const Yb=this.rza.cab,Gb=this.rza.j5i;if(Yb.length!==Gb){for(let wb=0;wb<jb.length&&Yb.length<Gb;++wb){const dc=jb[wb];this.rza.NP(dc)&&!Yb.includes(dc)&&Yb.push(dc)}this.rza.cab=Yb}}}Object(c.a)(Ab,"LinkedDataTypeRoamingHandler",null,[]);var pb=a(510),va=a(59),db=a(50),Ya=a(238),gb=a(37),Ka=a(47),ub=a(28),ac=a(281),Ra=a(22),na=a(99);a.d(D,"ConvertToLinkedEntityManager",function(){return lb});
class lb extends w.a{constructor(jb,Yb,Gb,wb,dc,Jc){super();this.cgf=this.ipd=this.cqd=this.Znd=this.Ynd=this.d6a=this.Qkd=null;this.GCb=this.Pgd=0;this.pba=null;this.$kd=!1;this.qad=this.Mn=this.GKd=null;this.cs=0;this.PX=null;this.dKa=8;this.bYc=this.xjf=this.dcf=this.J9a=!1;this.tya=this.EUe=this.rRe=null;this.YVc=0;this.tMg=5;this.KZb=3E4;this.C9f=!1;this.q9=null;this.Dha=Array(5);this.ebg=this.SWd=!1;this.fTf=this.Prd=0;this.D$d=null;this.p3f=!0;this.Xc=(Qc,fd)=>{fd.hc&&!fd.jzb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.ZKi=Qc=>{if(Qc.Result){var fd=Qc.Result;if(fd&&fd.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${fd.length} labels`);var Wc=db.GetServiceTaskFactory.Ta(this.$.da,274,275,0);gb.TaskExtensions.Aa(Wc,()=>{Wc.result.PVc(fd,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.Uf=()=>{this.xyb&&(this.pMj(),this.X1h(this.$.ea.to.LinkedEntityAsyncRefreshStateId));this.l6a?this.Z2h(this.$.ea.to.RichDataClassificationLabelStateId):this.w5a&&this.dWd(!0)};this.DIi=()=>{this.SWd=!0;this.Mn&&this.Mn.m6i()};this.sKi=Qc=>{if(Qc&&!ac.a(Qc))try{Qc.Result.HasUntrustedImageUrl&&(this.businessBar.Yf(59,null),this.ebg=!0)}catch(fd){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${fd}.`)}};
this.ajf=()=>{if(!this.xjf&&this.Pxb()&&!this.Old())if(Lb.a("DataTabActive"),va.a.tg.AQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Qc=this.I2b();if(Qc){var fd={};fd.InputMethod=tb.a.Eb;fd.CalloutName=8;fd.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Lb(Qc,fd);this.xjf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.AHi=Qc=>{ob.a.rg(Qc.Errors)||(this.l6a||this.dWd(!1),this.raiseEvent("LinkedEntityConverted"))};this.CRi=()=>{this.$.da.Za(211,Qc=>{Qc.readText(Pa.a.instance.ga(1805))})};this.Zc=(Qc,fd)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");fd.YU?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.Gwe():this.efj(),xb.EwaSettings.ma(649)&&this.SWd&&this.zJe())};this.AKi=Qc=>{this.M0b();if(Qc.Result){var fd=Qc.Result;Qc=fd.DomainDataArray;this.pba=fd.Ribbon;if(this.xwa&&this.pba){var Wc={};Wc.Name=Pa.a.instance.ga(1795);Wc.DomainIds=this.pK;this.pba.Categories.splice(lb.w7a,0,Wc)}0<fd.MaximumCellsToConvert&&(this.D$d=fd.MaximumCellsToConvert);this.cs=2;fd=!1;if(Qc){b.ULS.sendTraceTag(39949271,
0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Qc.length} domains`);this.GMa||(this.GMa=[]);Wc=Pa.a.instance.ga(1792);const Rb=Pa.a.instance.ga(1794);for(const Sb of Qc)Sb.DomainId?(this.GMa.push(Sb),Sb.DomainBlocked?(Qc=!!Sb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${Qc?Sb.DomainId.Id.toString():Sb.Name} is telemetry only, do not show in menu (Has String ID: ${Qc})`)):(this.aU.ia(lb.T0a(Sb.DomainId),Sb),Sb.Name===Wc||268435456===Sb.DomainId.Id?this.rRe=Sb.DomainId.Id.toString():
Sb.Name===Rb||536870912===Sb.DomainId.Id?this.EUe=Sb.DomainId.Id.toString():268435712===Sb.DomainId.Id&&Sb.ShowInRibbon&&(this.bYc=!0),fd=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}fd||(this.GMa=null);this.Rbg();this.ood&&this.GKd.sUh();this.C9f||(this.lMj(),this.C9f=!0)}else this.GMa=null,this.cs=3,-1<this.dKa&&window.setTimeout(()=>{this.zFb()},100*(8-this.dKa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.jGd();this.CCe();this.bYc&&this.ydf&&Ya.b(this.ajf,this.$.la,500);this.w5a&&!this.l6a&&this.dWd(!0)};this.zKi=Qc=>{Qc=Qb.a.kf(Qc.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${ob.a.zc(Qc)}].`);this.GMa=null;this.cs=3;this.J9a=!0;this.jGd()};this.onContentReady=()=>{this.O$f()&&this.gridView.qy(this.onContentReady);this.p3f&&this.$.workbookContext.Options&1048576&&(this.businessBar.eBj(),this.p3f=!1)};this.Wi=()=>{this.M0b()};this.eNi=Qc=>{if(ac.a(Qc)){const fd=
db.GetServiceTaskFactory.Ta(this.$.da,5,4,0);gb.TaskExtensions.Aa(fd,()=>{let Rb=null;if(null===Qc||void 0===Qc?0:Qc.Errors)Rb=Qc.Errors[0];fd.result.W2f(Rb,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ob.a.zc(Qc.Errors)}].`);const Wc=ob.a.QF(Qc.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.vp(Wc)}};
this.TXc=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.KZb} millisecond interval`);this.I$e("Periodic auto-refresh check",this.TFi,this.SFi)};this.TFi=Qc=>{ac.a(Qc)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ob.a.zc(Qc.Errors)}].`),++this.YVc):this.YVc=0;d.a.Ia(this.tya);this.YVc>=this.tMg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.tya=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.tya=Ka.a.instance.create(this.TXc,this.KZb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.SFi=Qc=>{Qc=Qb.a.kf(Qc.data);f.a.kh(Qc)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${ob.a.zc(Qc)}].`);d.a.Ia(this.tya);this.tya=Ka.a.instance.create(this.TXc,this.KZb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.gOi=Qc=>{Qc=!!Qc.Result&&Qc.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Qc.toString()}`);Qc?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${ub.a.Wa.je.m-
this.Pgd} ms, retry count = ${this.GCb}`),this.zFb()):this.Zwc()};this.fOi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.Zwc()};this.cKi=Qc=>{Qc.Result?(Qc=Qc.Result)?(this.wHd(),this.businessBar.W2f(null,Qc)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=jb;this.businessBar=Jc;this.svgIconProvider=
Gb;this.GMa=[];this.pK=[];this.gridView=bb.g(this.$);this.Bbc=-1;this.tii=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.w5a=this.$.ma(440)&&this.$.ma(291);this.l6a=this.$.ma(670);this.xyb=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.ood=(this.xwa=this.$.ma(669))&&xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);this.ydf=
xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.aU=new na.a;this.c8a=new Ub(jb,Yb,this);wb&&(this.Mn=new Qa(jb,wb,dc,this,this));this.$.el(this.Zc);x.a(this.$)&&x.a(this.$).Aoj(this);this.Gwe();(this.xyb||this.w5a||this.l6a)&&this.$.ea.Ou(this.Uf);xb.EwaSettings.ma(130)&&xb.EwaSettings.ma(138)&&(this.O$f()||this.gridView.Nu(this.onContentReady));this.$.GA(this.Wi);xb.EwaSettings.ma(649)&&(this.$.ea.hk(this.Xc),this.showUntrustedImageBusinessBarIfNecessary());
this.ood&&(this.GKd=new Ab(this.$,this))}dispose(){(this.xyb||this.w5a||this.l6a)&&this.$.ea.Mw(this.Uf);xb.EwaSettings.ma(649)&&this.$.ea.Hk(this.Xc);!this.q9&&xb.EwaSettings.ma(130)&&xb.EwaSettings.ma(138)&&this.gridView.qy(this.onContentReady);this.Mn&&this.Mn.dispose();this.$.AD(this.Wi);this.$.Cl(this.Zc);this.w5a&&(this.Qkd=null);d.a.Ia(this.tya)}TEg(jb){this.addHandler("LinkedEntityConverted",jb)}wPf(jb){this.removeHandler("LinkedEntityConverted",jb)}get j5i(){return 5}get cab(){return this.pK}set cab(jb){this.pK=
jb}selectEntity(jb){return this.Mn?this.Mn.selectEntity(jb):!1}searchEntity(jb,Yb){this.Mn&&this.Mn.searchEntity(jb,Yb)}DLd(jb,Yb,Gb,wb){this.Mn&&this.Mn.searchEntity(jb,Yb,!0,Gb,wb)}dCb(jb){return this.Mn?this.Mn.dCb(jb):!1}onPaneClosed(){if(this.Mn)this.Mn.onPaneClosed()}cancelSearch(){this.Mn&&this.Mn.cancelSearch()}selectDataType(jb){this.Mn&&this.Mn.selectDataType(jb)}showHelpArticle(jb){this.Mn&&this.Mn.showHelpArticle(jb)}showSurveyDialog(jb){this.Mn&&this.Mn.showSurveyDialog(jb)}insertTable(jb,
Yb){this.Mn&&this.Mn.insertTable(jb,Yb)}Z2h(jb){this.$.isEditMode&&this.fTf!==jb&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&(this.fTf=jb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),T(this.$.pa.va,this.ZKi,null,null,null))}zJe(){const jb=(Yb,Gb,wb)=>S(this.$.pa.va,Va.b(Yb,this.DIi),Gb,wb,null);xb.EwaSettings.fc()?this.$.userOperationManager.Ub(new Oa.a(589,0,jb,80),null):this.$.userOperationManager.Ub(new pb.a(589,
0,jb,16),null)}showUntrustedImageBusinessBarIfNecessary(){this.SWd||this.ebg||!this.$.ea.hc||this.cmj()}cmj(){const jb=(Yb,Gb,wb)=>fa(this.$.pa.va,Va.b(Yb,this.sKi),Gb,wb,null);xb.EwaSettings.fc()?this.$.userOperationManager.Ub(new Oa.a(588,0,jb,80),null):this.$.userOperationManager.Ub(new pb.a(588,0,jb,16),null)}dWd(jb){if(this.w5a&&null==this.Qkd&&!this.l6a&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.d6a&&this.d6a&&(!jb||this.$.workbookContext.Options&262144)){var Yb=db.GetServiceTaskFactory.Ta(this.$.da,
274,275,0);gb.TaskExtensions.Aa(Yb,()=>{this.Qkd=Yb.result.NMf(2)},this.$.la,3)}}get iNa(){return this.Dha.length}get Uyi(){return this.D$d}t2g(jb){(jb=this.Qgh(jb))?this.convertToLinkedEntity(jb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(jb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${jb.Id}].`);if(this.gridView){var Yb=this.gridView.ha.sa.Wc,Gb=Yb.Fe(this.gridView.jH);
this.xwa&&this.$kd&&this.FCg(jb);if(Gb){Gb=this.gridView.Db.qwa(Gb);if(!this.q5e(jb)&&this.zef(jb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(va.a.tg.AQ){Yb=this.sbd();if(!Yb){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Gb=this.I2b();if(!Gb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var wb=
{["InputMethod"]:tb.a.Eb,CalloutName:3};wb.Target=Yb;wb.RibbonButtonLabel=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.VSf(jb):this.Wzb(jb.Id.toString());wb.ExampleEntities=this.vPe(jb);this.$.Ka.Lb(Gb,wb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.zef(jb.Id)&&!jb.StringId)this.launchLinkedEntityDataTypeSelectorPane(lb.T0a(jb));
else{if(Gb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.dGj(jb)){Yb=Ib.r(this.gridView.ha.sa.selectedRanges,this.$);this.Mn.Vpi(Yb,jb);return}if(va.a.tg.AQ){Yb=this.sbd();if(!Yb){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Gb=this.I2b();if(!Gb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}wb={["InputMethod"]:tb.a.Eb,CalloutName:2};wb.Target=Yb;wb.RibbonButtonLabel=this.VSf(jb);wb.ExampleEntities=this.vPe(jb);wb.BlankCellResourceId=this.ANg(jb);wb.HasBlankCellWalkthrough=this.K3h(jb);wb.ServiceDomain=jb.Id;this.$.Ka.Lb(Gb,wb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.b1c(jb,!1,Yb)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.q9&&this.q9.OGa()}onAutoDetectUIShown(){const jb=(Yb,Gb,wb)=>P(this.$.pa.va,Yb,Gb,wb,null);xb.EwaSettings.fc()?Mb.a(this.$.userOperationManager,jb,Yb=>new Oa.a(230,0,Yb,80),null):Mb.a(this.$.userOperationManager,jb,Yb=>new pb.a(230,0,Yb,16),null)}b1c(jb,Yb,Gb){const wb=Ib.q(Gb,this.$),dc=()=>new cc.a;Mb.a(this.$.userOperationManager,(Jc,Qc,fd)=>W(this.$.pa.va,wb,jb,Yb,Va.b(Jc,this.AHi,this.CRi,this.Mn.zHi),Qc,fd,null),
Jc=>new Oa.a(115,0,Jc,void 0,dc),null)}FCg(jb){if(this.xwa&&this.$kd){var Yb={};Yb.Id=jb.Id;jb.StringId&&(Yb.StringId=jb.StringId);if(!(0<this.pK.length&&this.pK[0].Id===Yb.Id&&this.pK[0].StringId===Yb.StringId)){jb=!1;this.pK.splice(0,0,Yb);for(let Gb=1;Gb<this.pK.length;++Gb)if(this.pK[Gb].Id===Yb.Id&&this.pK[Gb].StringId===Yb.StringId){this.pK.splice(Gb,1);jb=!0;break}for(;5<this.pK.length;)this.pK.splice(this.pK.length-1,1);this.pba.Categories[lb.w7a].DomainIds=this.pK;this.URf();this.ood&&!jb&&
this.GKd.agg(this.pK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var jb=Ib.q(this.gridView.ha.sa.Wc,this.$);Mb.a(this.$.userOperationManager,(Yb,Gb,wb)=>H(this.$.pa.va,jb,Yb,Gb,wb,null),Yb=>new Oa.a(116,0,Yb),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");
if(bb.g(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.wHd();var jb=Ib.r(this.gridView.ha.sa.selectedRanges,this.$);Mb.a(this.$.userOperationManager,(Yb,Gb,wb)=>F(this.$.pa.va,jb,Yb,Gb,wb,null),Yb=>new Oa.a(248,0,Yb),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}qxj(jb){jb=this.NP(jb.DomainId);if(!jb||jb.DomainBlocked||xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!jb.HasCuratedData)return!1;if(this.tii){for(let Yb of this.aU)if(Yb.value.DomainId.Id===jb.DomainId.Id&&Yb.value.ShowInRibbon)return!0;return!1}return jb.ShowInRibbon}gwj(jb){return 2!==this.cs||!this.Dha[jb]}launchDisambiguationPaneForSearch(){this.Mn&&this.Mn.launchDisambiguationPaneForSearch()}Vc(jb,Yb,Gb){if("PopulateConvertToLinkedEntityMenu"!==Yb)return!1;this.qad=Gb.MenuId;if(0===this.cs||3===this.cs)return this.cYi(),!0;if(!this.pba)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.aU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.PX=this.PX||this.c8a.JEh(this.pba,Gb.MenuId);Gb.MenuItems=this.PX;return this.$kd=!0}cYi(){-1===this.Bbc&&(this.zFb(),this.Bbc=window.setInterval(()=>{this.zFb()},2E3))}zFb(){this.$.ea.hc&&2!==this.cs&&(this.dKa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.cs=1,E(this.$.pa.va,this.AKi,this.zKi,null,null))}Old(){return this.$.isEditMode&&
2!==this.cs&&(0<=this.dKa||!this.J9a)}CXd(jb){e.AFrameworkApplication.Mg?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):x.a(this.$)?(this.ARj(),jb&&this.$.pf()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}efj(){this.GCb=0;this.dKa=8;this.J9a=!1;this.cs=this.Bbc=0;this.GMa=this.pba=null;this.M0b();for(let jb=0;jb<this.iNa;++jb)this.Dha[jb]=null;this.Pxb()&&this.CXd(!0)}M0b(){this.PX=null}Pxb(){const jb=
u.a.rGb,Yb=x.a(this.$);return!!Yb&&Yb.Xl.Tz===jb}Rbg(){if(this.pba){let wb=0;if(this.xwa){let dc=-1,Jc=-1,Qc=0,fd=0,Wc=0;var jb=0,Yb=[null,null,null,null,null];for(var Gb of this.pba.Categories){let Rb=!1;for(const Sb of Gb.DomainIds){let mc=this.NP(Sb);mc&&!mc.DomainBlocked&&mc.ShowInRibbon&&(wb<this.iNa?(this.Dha[wb]=Sb,fd===lb.w7a&&(-1===dc&&(dc=wb),Jc=wb,jb=Jc-dc+1),++wb):wb===this.iNa&&Qc<jb&&fd!==lb.w7a&&(Yb[Qc]=Sb,++Qc),Rb=!0)}Rb&&++Wc;++fd}if(-1<dc&&Wc<=lb.Ajf){for(Gb=Jc;Gb>=dc;--Gb)this.Dha.splice(Gb,
1);for(Gb=0;Gb<jb;++Gb)this.Dha.splice(wb+Gb,0,Yb[Gb])}}else for(jb of this.pba.Categories){for(Yb of jb.DomainIds)if((Gb=this.NP(Yb))&&!Gb.DomainBlocked&&Gb.ShowInRibbon&&(this.Dha[wb]=Yb,++wb,wb>=this.iNa))break;if(wb>=this.iNa)break}for(;wb<this.iNa;)this.Dha[wb]=null,++wb}}O$f(){var jb=Object(n.a)(420,bb.g(this.$).Ea);const Yb=this.gridView.ha.Ke;return jb&&jb.Tgd&&1===Yb&&this.gridView.ha.sa.activeCell?(jb=db.GetServiceTaskFactory.Ta(this.$.da,12,477,1),this.q9=new z.a(this.$,this.svgIconProvider,
jb.result,this),!0):!1}Ypi(){this.Mn&&this.Mn.rrd(!0)}launchLinkedEntityDataTypeSelectorPane(jb){if(this.Mn)if(jb=this.u5c(jb))if(jb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Yb=Ib.r(this.gridView.ha.sa.selectedRanges,this.$);this.Mn.launchLinkedEntityDataTypeSelectorPane(Yb,jb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}H0g(jb){const Yb=this.f7h(jb),
Gb=k.a.Dg(this.Wzb(jb));jb=k.a.Dg(this.$Ud(jb));return lb.lEh(Yb,ib.a.gf(11),Gb,jb)}$Ud(jb){try{return this.FHe(parseInt(jb,10)).Description}catch(Yb){}return Pa.a.instance.ga(1789)}Wzb(jb){try{return this.FHe(parseInt(jb,10)).Name}catch(Yb){}return Pa.a.instance.ga(1775)}VSf(jb){try{return this.NP(jb).Name}catch(Yb){}return this.Wzb(jb.Id.toString())}ANg(jb){try{return this.NP(jb).BlankCellResourceId}catch(Yb){}return null}K3h(jb){try{return this.NP(jb).HasBlankCellWalkthrough}catch(Yb){}return!1}q5e(jb){try{const Yb=
lb.T0a(jb);if(this.aU.lb(Yb))return this.aU.na(Yb).HasCuratedData}catch(Yb){}return!1}dGj(jb){try{return this.NP(jb).SupportsStarterData}catch(Yb){}return!1}zef(jb){return 268435968===jb}sbd(){return 2===x.a(this.$).tR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}I2b(){return new Ba.a(-847286761,tb.a.Eb,this.$.Mc,0,u.a.IV)}CCe(){if(this.Pxb()&&!this.Old()&&!this.dcf&&xb.EwaSettings.ma(440)&&this.q5e({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
va.a.tg.AQ){const Gb=this.sbd();if(Gb){var jb=this.I2b();if(jb){var Yb={["InputMethod"]:tb.a.Eb,CalloutName:6};Yb.Target=Gb;Yb.ShouldCanvasTakeFocus=!0;this.$.Ka.Lb(jb,Yb);this.dcf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}F6h(jb){jb=
this.u5c(jb);return jb?this.c8a.hMg(jb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Wdc(jb){return this.q9?this.q9.gMg(jb):!1}yHh(){return this.q9?this.q9.rIh():""}Ndi(){return this.q9?this.q9.DAb:!1}jMh(jb,Yb){const Gb=this.H8e(jb);if(0>Gb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${jb}`);else if(jb=(jb=this.GHe(jb))?this.NP(jb):
null)Yb[l.a.GalleryButtonProps]=this.c8a.jFh(Gb,jb),Yb[l.a.Alt]=this.c8a.$bd(jb)}URf(){this.Rbg();this.Pxb()&&this.CXd(!0);this.M0b()}f7h(jb){return jb===this.rRe?r.a.uOe:jb===this.EUe?r.a.sOe:r.a.rOe}vPe(jb){try{return this.NP(jb).ExampleEntities}catch(Yb){}return Pa.a.instance.ga(1797)}jGd(){(0>this.dKa||this.J9a)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.cs||0>this.dKa||this.J9a)&&window.clearInterval(this.Bbc);this.Old()?
this.qad&&this.$.frame.Ww(this.qad):this.CXd(this.Pxb())}Gb(jb){return this.$.Bb+jb}ARj(){var jb=!0;const Yb=Array(this.iNa),Gb=x.a(this.$)?x.a(this.$).Xl:null;if(Gb){for(let wb=0;wb<Yb.length;++wb)this.gwj(wb)?Yb[wb]=!0:jb=Yb[wb]=!1;Gb.TNd(["ConvertToLinkedEntityGallery"],jb);if(!jb)for(jb=0;jb<Yb.length;++jb)Yb[jb]&&Gb.TNd([this.iMh(jb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}NP(jb){const Yb=lb.T0a(jb);if(this.aU.lb(Yb))return this.aU.na(Yb);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${jb.Id} (Has String ID: ${!!jb.StringId})`);return null}iMh(jb){return"ConvertToLinkedEntityPreview"+jb.toString()}tXd(){m.a.get_instance().pk(10,()=>{this.CCe();this.bYc&&this.ydf&&Ya.b(this.ajf,this.$.la,500)})}qbc(jb,Yb){switch(jb){case "QueryLinkedEntityGalleryButtons":if(!Yb[l.a.InnerHTML]){jb=Yb[tb.a.Oc].toString();const Gb=Ra.a.equals(jb,Pa.a.instance.ga(1792),!0)||Ra.a.equals(jb,Pa.a.instance.ga(1793),!0),wb=Ra.a.equals(jb,Pa.a.instance.ga(1794),
!0);Gb||wb||this.jMh(jb,Yb)}break;case "QueryLinkedEntityMenuGalleryButtons":Yb[l.a.InnerHTML]||(Yb[l.a.InnerHTML]=this.H0g(Yb[tb.a.Oc]))}return Yb}Qgh(jb){var Yb=this.GHe(jb);if(Yb)return Yb;if(Yb=this.u5c(jb))return Yb.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${jb}`);return null}FHe(jb){const Yb={};Yb.Id=jb;return this.NP(Yb)}u5c(jb){return this.aU.lb(jb)?this.aU.na(jb):null}H8e(jb){if(!jb.startsWith(lb.N5c))return-1;const Yb=parseInt(jb.substr(lb.N5c.length),
10);return isNaN(Yb)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${jb}`),-1):Yb}GHe(jb){jb=this.H8e(jb);return 0>jb?null:this.Dha[jb]}I$e(jb,Yb,Gb){this.xyb&&this.aU&&this.aU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${jb})`),jb=this.$.pa.va.Qb(),this.$.ea.hc&&ka(this.$.pa.va,Va.b(this.eNi,Yb),Gb,null,null,jb))}lMj(){this.I$e("Auto-refresh on load",null,null)}pMj(){this.xyb&&this.aU&&this.aU.count&&
(this.tya?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.to.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.tya=Ka.a.instance.create(this.TXc,this.KZb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}Zwc(){if(this.$.ea.hc&&null!=this.d6a&&null!=this.Ynd&&null!=this.Znd&&null!=this.cqd&&null!=this.ipd)if(++this.GCb,12>=this.GCb){1===this.GCb&&(this.Pgd=ub.a.Wa.je.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const jb=this.$.pa.va.Qb();
mb.t(this.$.pa.va,this.cri,this.dri(),this.gOi,this.fOi,null,jb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${ub.a.Wa.je.m-this.Pgd} ms`),this.J9a=!0,this.jGd()}Gwe(){if(this.$.isEditMode)if(null!=this.d6a)this.Zwc();else{var jb=ub.a.Wa.je.m,Yb=[];v.a.instance.Vb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{Gb.isFeatureEnabled("ExcelPowerBiPro",!1).then(wb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${wb}]`);return this.d6a=wb}).then(()=>{Yb.push(Gb.isFeatureEnabled("ExcelWolframAlpha",!1).then(wb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${wb}]`);return this.cqd=wb}))}).then(()=>{Yb.push(Gb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(wb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${wb}]`);
let dc;const Jc=[(dc=new Jb.a,dc.name="IsRestrictedByLicense",dc.bool=wb,dc)];Lb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Jc);this.cgf=wb&&xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return wb}))}).then(()=>{Yb.push(Gb.isFeatureEnabled("StockHistory",!1).then(wb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${wb}]`);return this.ipd=wb}))}).then(()=>{Yb.push(Gb.isFeatureEnabled("ExcelPowerBiFree",!1).then(wb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${wb}]`);return this.Ynd=wb}))}).then(()=>
{Yb.push(Gb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(wb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${ub.a.Wa.je.m-jb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${wb}]`);return this.Znd=wb}))}).then(()=>{Promise.all(Yb).then(()=>{this.Zwc()})})})}}get cri(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}dri(){return[this.d6a,
this.cqd,this.ipd,this.Ynd,this.Znd,this.cgf]}wHd(){this.businessBar&&this.businessBar.sLa(58)&&this.businessBar.removeEntry(58)}X1h(jb){this.Prd!==jb&&this.businessBar&&((this.Prd=jb)?da(this.$.pa.va,this.cKi,null,null,null):this.wHd())}static lEh(jb,Yb,Gb,wb){jb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',jb,Yb,wb);Gb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Gb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',jb,Gb)}static T0a(jb){return jb.StringId?jb.Id.toString()+"."+jb.StringId:jb.Id.toString()}}lb.sIe="ConvertToLinkedEntityPreview";lb.N5c="PreviewGalleryButtonIndex.";lb.w7a=0;lb.Ajf=2;Object(c.a)(lb,"ConvertToLinkedEntityManager",w.a,[421,422,3,423])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/2327a12d835c4db88786820b2a4e3574/EwaDSEsNext.le.js.map