var formulaAssistance=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[15],{1247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef"}(t.CompletionItemKind||(t.CompletionItemKind={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(t.SuggestionKind||(t.SuggestionKind={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(t.DiagnosticSeverity||(t.DiagnosticSeverity={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(t.DiagnosticTag||(t.DiagnosticTag={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(t.CodeActionKind||(t.CodeActionKind={}))},1248:function(e,t,n){"use strict";n(649),n(456)},1249:function(e,t,n){"use strict";n(652)},1829:function(e,t,n){"use strict";n.r(t);var a=n(221);n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return a.FormulaAssistanceUIFactoryGlobal}))},221:function(e,t,n){"use strict";var a=n(1247);n.o(a,"CompletionItemKind")&&n.d(t,"CompletionItemKind",(function(){return a.CompletionItemKind})),n.o(a,"SuggestionKind")&&n.d(t,"SuggestionKind",(function(){return a.SuggestionKind}));var r=n(302);n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return r.d}));n(1248),n(1249),n(297)},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),r=a.createContext({isFeedbackAllowed:!1,zoomLevel:1})},302:function(e,t,n){"use strict";var a,r,o,i=n(1),c=n(649),l=n(652),s=n(111),u=n(268),d=n(60),m=n(39),f=n(0),p=n(297),g=n(456),b=n(189),v=n(421),h=n(1312),x=n(657),E=n(245),C=n(2182),y=n(116),S=n(319),O={subText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontFamily:'Consolas, "Courier New", monospace'}},j=f.memo((function(e){var t=e.isLoaded,n=e.value,a=Object(i.__rest)(e,["isLoaded","value"]),r=t?n||void 0:f.createElement(C.a,{type:"AppSpinnerProps",id:"ValuePreviewSpinner",appColors:Object(y.a)(),spinnerSize:S.a.small});return f.createElement(E.a,null,(function(e){return f.createElement(x.a,Object(i.__assign)({},a,{calloutProps:{styles:Object(h.a)(e),beakWidth:10},content:r,styles:O,directionalHint:d.a.topCenter}))}))})),_=function(){function e(e){this.context={isFeedbackAllowed:!1,zoomLevel:1},this.lastProps=new Map,this.isFormulaAssistanceDragEnabled=!1,this.isDisableItemReadoutEnabled=!1,e&&(this.context=Object(i.__assign)(Object(i.__assign)({},this.context),e)),this.argumentAssistanceCardRef=f.createRef(),this.autoCompleteMenuRef=f.createRef(),this.isFormulaAssistanceDragEnabled=Object(b.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceDrag",!1),this.isDisableItemReadoutEnabled=Object(b.isChangeGateEnabled)("OfficeVSO:6312266_RedesignListBoxEvents")}return e.prototype.renderArgumentAssistanceCard=function(e,t,n){if(e&&t&&n){var a=this.isFormulaAssistanceDragEnabled&&this.target?this.target:t;m.render(f.createElement(p.a.Provider,{value:this.context},f.createElement(c.a,Object(i.__assign)({target:a},n,{ref:this.argumentAssistanceCardRef,hidden:!1}))),e),this.lastProps.set(e,Object(i.__assign)(Object(i.__assign)({type:r.ArgumentAssistanceCard,target:a},n),{rendered:!0}))}},e.prototype.renderAutoCompleteMenu=function(e,t,n){if(e&&t&&n){var a=this.isFormulaAssistanceDragEnabled&&this.target?this.target:t;m.render(f.createElement(p.a.Provider,{value:this.context},f.createElement(l.a,Object(i.__assign)({target:a},n,{ref:this.autoCompleteMenuRef,disableItemReadout:this.isDisableItemReadoutEnabled}))),e),this.lastProps.set(e,Object(i.__assign)(Object(i.__assign)({type:r.AutoCompleteMenu,target:a},n),{rendered:!0}))}},e.prototype.renderValuePreview=function(e,t,n){e&&t&&n&&m.render(f.createElement(j,Object(i.__assign)({},n,{targetElement:t})),e)},e.prototype.dismiss=function(e){if(e)if(this.lastProps.has(e)){var t=this.lastProps.get(e);if(t&&t.rendered)switch(t.rendered=!1,t.type){case r.ArgumentAssistanceCard:return void m.render(f.createElement(p.a.Provider,{value:this.context},f.createElement(c.a,Object(i.__assign)({},t,{hidden:!0}))),e);case r.AutoCompleteMenu:return void m.render(f.createElement(p.a.Provider,{value:this.context},f.createElement(l.a,Object(i.__assign)({},t,{hidden:!0}))),e)}}else m.unmountComponentAtNode(e)},e.prototype.focus=function(e){var t=this.getRootElement(e);return!!t&&(Object(s.c)(t),!0)},e.prototype.getRootElement=function(e){switch(e){case r.ArgumentAssistanceCard:return this.argumentAssistanceCardRef.current;case r.AutoCompleteMenu:return this.autoCompleteMenuRef.current;default:return null}},e.prototype.getCalloutElement=function(e){var t;switch(e){case r.ArgumentAssistanceCard:return null===(t=document.getElementById(g.a.callout))||void 0===t?void 0:t.parentElement;default:return null}},e.prototype.getDraggableElement=function(e){switch(e){case r.ArgumentAssistanceCard:return document.getElementById(g.a.collapsedPart);default:return null}},e.prototype.setZoomLevel=function(e){this.context.zoomLevel=e},e.prototype.updateContext=function(e){this.context=Object(i.__assign)(Object(i.__assign)({},this.context),e)},e.prototype.setOverrideTarget=function(e){this.target=e?new u.a(e.left,e.left,e.top,e.top):void 0},e.prototype.getDirectionalHint=function(e){if(e)switch(Object(v.a)(new u.a(e.left,e.left,e.top,e.top))[0]){case d.a.topLeftEdge:return o.Top;case d.a.bottomLeftEdge:return o.Bottom}return o.None},e.prototype.getWindowEdgeBuffer=function(){return v.c},e}(),k=n(447),F=function(){function e(){}return e.prototype.create=function(e){return k.a.registerUiSlice20Icons(),new _(e)},e}();n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return w})),function(e){e[e.Expanded=0]="Expanded",e[e.Collapsed=1]="Collapsed",e[e.Hidden=2]="Hidden"}(a||(a={})),function(e){e[e.ArgumentAssistanceCard=0]="ArgumentAssistanceCard",e[e.AutoCompleteMenu=1]="AutoCompleteMenu",e[e.ValuePreview=2]="ValuePreview"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(o||(o={}));var w=new F},344:function(e,t,n){"use strict";var a=n(1),r=n(3),o=n(110),i=n(116),c=Object(a.__assign)(Object(a.__assign)({},r.b.fadeIn100),{animationTimingFunction:r.c.easeFunction1}),l={root:Object(a.__assign)({borderRadius:4},c),calloutMain:{borderRadius:4}},s={root:{color:Object(i.a)().primary,fontSize:r.j.size12,fontWeight:r.k.semibold,lineHeight:r.j.size16,userSelect:"none",selectors:{"&:active, &:hover, &:active:hover, &:focus":{color:Object(i.a)().primary}}}},u={scrollbarWidth:"thin",scrollbarColor:"#808080 #FFF","-ms-scrollbar-base-color":"#808080","-ms-scrollbar-track-color":"#FFF",selectors:{"::-webkit-scrollbar":{width:14},"::-webkit-scrollbar-thumb":{borderRadius:20,backgroundColor:o.a.gray110,border:"solid 4px transparent",backgroundClip:"content-box"},"::-webkit-scrollbar-thumb:hover":{backgroundColor:o.a.gray120},"::-webkit-scrollbar-button:vertical":{height:4}}};t.a={calloutStyle:l,linkStyle:s,scrollBarStyle:u}},421:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(0),r=n(268),o=n(60),i=n(297),c=function(e){var t,n=a.useContext(i.a).zoomLevel;if(e instanceof HTMLElement){var o=e.getBoundingClientRect();t=new r.a(o.x*n,o.right*n,o.y*n,o.bottom*n)}else t=e;var c=l(t),d=c[0],m=c[1],f=c[2];return{targetRect:t,maxDimensions:{maxHeight:Math.min(s.maxHeight,(f?m.top:m.bottom)-u),maxWidth:Math.min(s.maxWidth,window.innerWidth-2*u)},directionalHint:d}},l=function(e){var t={left:e.left,right:window.innerWidth-e.right,top:e.top,bottom:window.innerHeight-e.bottom},n=t.top>t.bottom&&t.bottom<s.minHeight+u;return[n?o.a.topLeftEdge:o.a.bottomLeftEdge,t,n]},s={minHeight:300,maxHeight:415,maxWidth:500},u=8},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={callout:"aa-callout",collapsedPart:"aa-header"}},649:function(e,t,n){"use strict";var a,r,o,i=n(0),c=n(508),l=n(13),s=n(456),u=n(1),d=n(40),m=n(60),f=n(1232),p=n(23),g=n.n(p),b=n(3),v=n(11),h=n(110),x=n(344),E=5,C=7,y=20,S=20,O=4,j=340,_=Object(l.c)((function(e,t){return Object(b.cb)({cardPart:{padding:"".concat(E,"px ").concat(C,"px")},root:{display:"flex",cursor:"default",flexDirection:"column"},collapsedCard:{direction:"ltr",flexShrink:0,selectors:{":after":A(e)}},expandedCard:Object(u.__assign)(Object(u.__assign)({overflowY:t?"auto":"hidden",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)"},x.a.scrollBarStyle),{":before":A(!e)})})})),k=Object(l.c)((function(){var e;return{root:{width:S,height:y,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(u.__assign)({},v.o),e)},icon:{height:16,width:16}}})),F=Object(l.c)((function(e){return Object(b.cb)(k(),{icon:{transform:e?"scaleY(-1)":""},flexContainer:{marginLeft:1}})})),w=Object(b.cb)(x.a.calloutStyle,{calloutMain:{overflow:"hidden"}}),A=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(C,"px 0px ").concat(C,"px"),height:1,backgroundColor:h.a.gray40}},R=n(2141),I=n(302),H=n(62),P=n(64),T=n(233),D=n(421),N=i.forwardRef((function(e,t){var n=e.target,a=e.renderCompactCard,r=e.renderExpandedCard,o=e.onCardModeChange,l=e.onDismissClick,s=e.cardMode,p=e.collapsedId,b=e.showDismissButton,v=Object(u.__rest)(e,["target","renderCompactCard","renderExpandedCard","onCardModeChange","onDismissClick","cardMode","collapsedId","showDismissButton"]),h=i.useState(s),x=h[0],E=h[1],y=i.useState(!1),A=y[0],N=y[1],z=i.createRef(),M=i.createRef(),L=i.createRef(),B=i.createRef(),K=Object(D.b)(n),W=K.targetRect,G=K.maxDimensions,V=K.directionalHint,U=b&&!!l;i.useEffect((function(){requestAnimationFrame((function(){if(z.current&&M.current&&L.current&&B.current){var e=x===I.b.Expanded,t=G.maxWidth>j?Math.max(M.current.scrollWidth+S+(U?S+O:0)+2*C,j):G.maxWidth;L.current.style.width=t+"px";var n=e?Math.min(B.current.scrollHeight,G.maxHeight-z.current.scrollHeight):0;L.current.style.height=n+"px",N(!!e&&B.current.scrollHeight>n)}else H.a.sendTraceTag(554246626,P.a.msoulscat_ES_EWAJS,T.a.Warning,"ExpandingCard: Unexpected refs, collapsed:".concat(!!z.current," collapsedContent:").concat(!!M.current," expanded:").concat(!!L.current," expandedContent:").concat(!!B.current))}))}));var J=_(x===I.b.Expanded,A),Y=function(e){return null==l?void 0:l()},Z=function(){return x===I.b.Expanded?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand},Q=x===I.b.Expanded&&V===m.a.bottomLeftEdge||x===I.b.Collapsed&&V===m.a.topLeftEdge;return i.createElement(f.a,Object(u.__assign)({onKeyDownCapture:function(e){var t,n,a=null!==(t=e.keyCode)&&void 0!==t?t:e.which;x!==I.b.Expanded||a!==d.a.up&&a!==d.a.down||null===(n=L.current)||void 0===n||n.scrollBy({top:a===d.a.up?-100:100,left:0,behavior:"smooth"}),a===d.a.escape&&Y()},target:W,isBeakVisible:!1,directionalHint:V,directionalHintForRTL:V,styles:w,minPagePadding:D.c,focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},v),i.createElement("div",{ref:t,className:J.root,style:G},i.createElement("div",{id:p,className:J.collapsedCard,ref:z},i.createElement(c.a,{className:J.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},i.createElement(c.a,{horizontal:!0,tokens:{childrenGap:O}},i.createElement(R.a,{id:"toggleCardStateButtonId",iconProps:{iconName:g.a.CommonControlChevronDown_16},ariaLabel:Z(),customTooltip:Z(),onClick:function(e){var t=x===I.b.Expanded?I.b.Collapsed:I.b.Expanded;null==o||o(t),E(t)},styles:F(Q)}),U&&i.createElement(R.a,{id:"dismissCardButtonId",iconProps:{iconName:g.a.CmdBarClose_16},ariaLabel:ExcelRibbonStrings.FormulaArgumentAssistanceDismiss,customTooltip:ExcelRibbonStrings.FormulaArgumentAssistanceDismiss,onClick:Y,styles:k()})),i.createElement("div",{ref:M},a()))),i.createElement("div",{className:J.expandedCard,ref:L,onPointerDown:function(e){e.preventDefault()}},i.createElement("div",{className:J.cardPart,ref:B},r(x===I.b.Expanded)))))})),z=n(1866),M=n(286),L=n(1154),B=n(116),K=Object(l.c)((function(e){return{display:"block",content:"attr(".concat(e,")"),fontSize:b.j.size12,fontWeight:b.k.semibold,height:0,overflow:"hidden",visibility:"hidden"}})),W={label:{root:{fontSize:b.j.size12,fontWeight:b.k.semibold,lineHeight:b.j.size16,paddingBottom:4,paddingTop:0}},formula:{root:{color:h.a.gray180,fontSize:b.j.size12,fontWeight:b.k.semibold,lineHeight:b.j.size16,selectors:(a={},a[b.l]={color:"WindowText"},a)}},text:{root:{color:h.a.gray180,fontSize:b.j.size12,lineHeight:b.j.size16,selectors:(r={},r[b.l]={color:"WindowText"},r)}},param:{root:{color:Object(B.a)().shade20,fontSize:b.j.size12,fontWeight:b.k.semibold,lineHeight:b.j.size16,selectors:(o={},o[b.l]={color:"Highlight"},o)}},parametersContainer:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:1,color:h.a.gray180,fontSize:b.j.size12,lineHeight:b.j.size16},expandedCardPart:{root:{paddingTop:4}}},G=Object(l.c)((function(e){var t,n;return e?Object(b.cb)({root:{selectors:(n={},n[b.l]={border:"2px solid Highlight"},n)}}):Object(b.cb)({root:{cursor:"pointer",opacity:.5,selectors:(t={},t[b.l]={opacity:1},t)}})})),V=Object(l.c)((function(e){var t={":after":K("formula-text")};return e?Object(b.cb)({root:t}):Object(b.cb)({root:Object(u.__assign)(Object(u.__assign)({},t),{textAlign:"unset",borderBottom:"0px","&:active, &:hover, &:active:hover, &:focus":{color:h.a.gray180}})})})),U={root:{direction:"ltr"}},J=Object(l.c)((function(e){var t;return Object(b.cb)({param:Object(u.__assign)({backgroundColor:Y(e),padding:"2px 5px 4px 5px",transition:"background-color 150ms linear",cursor:"default"},e?v.o:{}),paramName:{fontWeight:e?b.k.semibold:b.k.regular,":after":K("param-name")}},{param:{selectors:(t={},t[b.l]={transition:"none",border:"1px solid WindowText"},t)}})})),Y=function(e){return e?"rgb(202, 234, 216, 0.6)":"rgb(245, 245, 245)"},Z=function(e){var t=e.description;return i.createElement(c.a,null,i.createElement(M.a,{styles:W.label},ExcelRibbonStrings.FormulaArgumentAssistanceDescription),i.createElement(L.a,{styles:W.text},t))},Q=function(e){var t=e.functionName,n=e.params,a=e.selected,r=e.functionNameStyle,o=e.textStyle,c=e.selectedStyle,l=e.listSeparator,s=e.styles,u=e.onClick;return i.createElement(L.a,{styles:Object(b.cb)(U,o,s),onClick:u},i.createElement(L.a,{styles:r},t),i.createElement(i.Fragment,null,"(",n.length>0&&n.map((function(e,t){var n=t===a?c:o;return i.createElement(i.Fragment,{key:t},i.createElement(L.a,{styles:n},e))})).reduce((function(e,t){return[e,"".concat(l," "),t]})),")"))},q=function(e){var t=e.functionName,n=e.parameters,a=e.listSeparator,r=e.description;return n?i.createElement(c.a,null,i.createElement(M.a,{styles:W.label},ExcelRibbonStrings.FormulaArgumentAssistanceExample),i.createElement(Q,{functionName:"=".concat(t),params:n.params,selected:n.activeParam,functionNameStyle:W.text,textStyle:W.text,selectedStyle:W.param,listSeparator:a}),r&&i.createElement(L.a,{styles:W.text},r)):null},X=function(e){var t=e.parameters,n=e.descriptions;return i.createElement(i.Fragment,null,t.params&&t.params.length>0&&i.createElement("div",{style:W.parametersContainer},t.params.map((function(e,a){var r=a===t.activeParam,o=J(r);return i.createElement(i.Fragment,{key:a},i.createElement("div",{className:[o.param,o.paramName].join(" "),"param-name":e},e),i.createElement("div",{className:o.param},n[a]))}))))},$=n(1052),ee=function(e){var t=e.functionName,n=e.signatures,a=e.activeSignature,r=e.listSeparator,o=e.onFormulaClick;return i.createElement(c.a,null,n.map((function(e,n){var c=n===a,l=e.signatureParams.params,s="".concat(t,"(").concat(l.join("".concat(r," ")),")");return c?i.createElement("div",{className:V(c).root,"formula-text":s,id:"aa_function_".concat(n)},i.createElement(Q,{functionName:t,params:l,selected:e.signatureParams.activeParam,functionNameStyle:W.formula,textStyle:W.text,selectedStyle:W.param,listSeparator:r,styles:G(c)})):i.createElement($.a,{styles:V(c),key:n,onClick:o(n),"formula-text":s,id:"aa_function_".concat(n)},i.createElement(Q,{functionName:t,params:l,selected:e.signatureParams.activeParam,functionNameStyle:W.formula,textStyle:W.text,selectedStyle:W.param,listSeparator:r,styles:G(c)}))})))},te=n(903),ne=n(297),ae=function(e){var t=e.functionName,n=e.isExpanded,a=e.onHelpClick,r=e.onFeedback,o=i.useContext(ne.a).isFeedbackAllowed;return i.createElement(c.a,{horizontal:!0,horizontalAlign:"space-between"},i.createElement($.a,{"data-test-id":"learnMoreLinkId",disabled:!n,styles:x.a.linkStyle,onClick:a},"".concat(ExcelRibbonStrings.FormulaArgumentAssistanceLearnMore," ").concat(t)),o&&i.createElement(te.a,{disabled:!n,onClick:r}))},re=n(189);n.d(t,"a",(function(){return oe}));var oe=i.forwardRef((function(e,t){var n=e.target,a=e.functionRenderingInfo,r=e.callbacks,o=e.cardMode,l=e.hidden,u=a,d=u.functionName,m=u.functionDescription,f=u.signatures,p=u.activeSignature,g=u.listSeparator,b=i.useState(null!=p?p:0),v=b[0],h=b[1],x=f[v],E=function(e){return function(t){h(e)}},C=function(e){var t;null===(t=null==r?void 0:r.onHelpLink)||void 0===t||t.call(r)},y=function(e){var t;null===(t=null==r?void 0:r.onFeedback)||void 0===t||t.call(r,a)};return i.createElement(z.a,null,i.createElement(N,{target:n,renderCompactCard:function(){return i.createElement(ee,{functionName:d,signatures:f,activeSignature:v,listSeparator:g,onFormulaClick:E})},renderExpandedCard:function(e){return i.createElement(c.a,{styles:W.expandedCardPart,tokens:{childrenGap:12}},i.createElement(Z,{description:m}),i.createElement(q,{functionName:d,parameters:x.exampleParams,listSeparator:g,description:x.exampleDescription}),i.createElement(X,{parameters:x.descriptionParams,descriptions:x.descriptions}),i.createElement(ae,{functionName:d,isExpanded:e,onHelpClick:C,onFeedback:y}))},cardMode:o,onCardModeChange:null==r?void 0:r.onCardModeChange,onDismissClick:null==r?void 0:r.onDismissClick,onPointerDown:function(e){ie()||e.preventDefault()},ref:t,key:o,hidden:l,id:s.a.callout,collapsedId:s.a.collapsedPart,showDismissButton:!ie(),doNotLayer:ce(),layerProps:!ce()&&le()?{eventBubblingEnabled:!0}:void 0}))})),ie=Object(l.c)((function(){return Object(re.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)})),ce=Object(l.c)((function(){return Object(re.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)})),le=Object(l.c)((function(){return Object(re.isChangeGateEnabled)("OfficeVSO:6184552_FAEventBubblingEnabled")}))},652:function(e,t,n){"use strict";var a=n(1),r=n(0),o="ac-callout",i=n(60),c=n(40),l=n(340),s=n(582),u=n(251),d=n(669),m=n(679),f=n(13),p=n(221),g=n(1104),b=n(3),v=n(731),h=n(110),x=n(11),E=n(241),C=n(23),y=n.n(C),S=n(344),O=E.b.getInstance().getTheme(),j=Object(b.W)(0,b.s),_="svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m'])",k=Object(f.c)((function(){var e,t;return Object(b.db)({"&:hover":(e={},e[b.l]=(t={},t[_]={fill:"HighlightText"},t),e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),F=Object(f.c)((function(e,t){var n,r;return Object(b.cb)(Object(v.b)(O),{linkContent:Object(a.__assign)({color:h.a.gray180,minHeight:28,padding:"0px ".concat(12,"px 0px ").concat(12,"px"),cursor:"pointer",userSelect:"none",backgroundColor:e?"#F5F5F5":"","&:hover":Object(a.__assign)({backgroundColor:"#F0F0F0"},x.o)},e?x.o:{}),icon:{alignSelf:"center",width:16,height:16,selectors:(n={},n[j]={fontSize:"",width:""},n[b.l]={selectors:(r={},r[_]={fill:e?"HighlightText":""},r)},n)},label:{fontSize:b.j.size12,lineHeight:b.j.size16,flexGrow:"",overflow:t?"hidden":"",textOverflow:t?"elipsis":"",alignSelf:"center",margin:"0px 0px 0px 6px",display:t?"-webkit-box":void 0,whiteSpace:t?"normal":void 0,wordBreak:t?"break-all":void 0,"-webkit-line-clamp":t?"2":void 0,"-webkit-box-orient":t?"vertical":void 0},secondaryText:Object(a.__assign)({color:h.a.gray130,fontSize:b.j.size10,lineHeight:b.j.size12,textAlign:"left",whiteSpace:"normal",padding:"2px 0px 2px 8px",alignSelf:"center"},I(e))})})),w=Object(f.c)((function(e,t,n,r){var o,i=t?9:0,c=Math.min(228+i,n.maxHeight);return Object(b.cb)({root:{width:e?230:340,maxWidth:n.maxWidth,paddingTop:4},subComponentStyles:{menuItem:{divider:{height:1,margin:4,selectors:(o={},o[b.l]={backgroundColor:"WindowText"},o)}}},simpleSection:Object(a.__assign)({maxHeight:c-(4+28*r+i),overflowY:"auto"},S.a.scrollBarStyle)})})),A={footer:{root:{padding:"4px ".concat(12,"px 8px ").concat(12,"px")}},feedback:{root:{float:"right",fontSize:b.j.size10,lineHeight:b.j.size14}}},R=function(e){switch(e.kind){case p.CompletionItemKind.Function:return e.type===p.SuggestionKind.Simple?y.a.FormulaBar_16:y.a.Intelligence_16;case p.CompletionItemKind.RichEntity:return y.a.Tag_16;case p.CompletionItemKind.LetVariable:return y.a.FormulaLet_16;case p.CompletionItemKind.NamedRange:return y.a.NameRange_16;case p.CompletionItemKind.Table:return y.a.Table_16;case p.CompletionItemKind.TableHeader:return y.a.SelectColumn_16;case p.CompletionItemKind.RichEntityEmptyCellRef:return y.a.AbsoluteReference_16;default:return""}},I=function(e){var t;return{selectors:(t={},t[b.l]={color:e?"HighlightText":"WindowText"},t)}},H=n(508),P=n(903),T=n(297),D=function(e){var t=e.onFeedback,n=r.useContext(T.a).isFeedbackAllowed;return r.createElement(H.a,{styles:A.footer,tokens:{childrenGap:8}},n&&r.createElement("div",null,r.createElement(P.a,{styles:A.feedback,disabled:!1,onClick:t})))},N=n(421),z=n(189);n.d(t,"a",(function(){return M}));var M=r.forwardRef((function(e,t){var n,m=e.target,f=e.completionItems,b=e.callbacks,v=e.activeItemIndex,h=e.hidden,x=e.disableItemReadout,E=r.useRef(null);r.useLayoutEffect((function(){E.current&&E.current.scrollIntoView({block:"nearest"})}));var C=r.useMemo((function(){return Object(g.a)(f)}),[f]),y=r.useMemo((function(){return C.reduce((function(e,t){return e[t.type]=!0,e}),{})}),[C]),O=y[p.SuggestionKind.Smart],j=O&&!y[p.SuggestionKind.Simple],_=O&&y[p.SuggestionKind.Simple],A=Object(N.b)(m),I=A.targetRect,H=A.maxDimensions,P=A.directionalHint;j&&(P=i.a.bottomLeftEdge);var T=w(j,_,H,C.filter((function(e){return e.type===p.SuggestionKind.Smart})).length),z=function(e){return function(t){var n;e!==v&&(null===(n=null==b?void 0:b.onCompletionItemSelected)||void 0===n||n.call(b,C[e],e),W()&&t.target.offsetHeight<t.target.scrollHeight&&t.target.setAttribute("title",C[e].label))}},M=function(e){return function(t){var n;t.preventDefault(),null===(n=null==b?void 0:b.onCompletionItemCommitted)||void 0===n||n.call(b,C[e])}},G=function(e){return function(t){var n;t.nativeEvent.keyCode===c.a.enter&&(t.preventDefault(),null===(n=null==b?void 0:b.onCompletionItemCommitted)||void 0===n||n.call(b,C[e]))}},V=function(e){return function(t){var n,a;e!==v&&(t.stopPropagation(),null===(n=null==b?void 0:b.onCompletionItemSelected)||void 0===n||n.call(b,C[e],e),null===(a=t.currentTarget)||void 0===a||a.focus())}},U=r.useCallback((function(e,n){var o=Object(a.__assign)(Object(a.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"smart-section"===e.key}))}),i=Object(a.__assign)(Object(a.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"simple-section"===e.key}))});return r.createElement("div",{ref:t},r.createElement(s.a,{disabled:h},n(o),r.createElement("div",{className:T.simpleSection},n(i))),O&&r.createElement(D,{onFeedback:function(e){var t;null===(t=null==b?void 0:b.onFeedback)||void 0===t||t.call(b)}}))}),[O,b,T.simpleSection,t,h]),J=r.useCallback((function(e){return function(t,n){return r.createElement(r.Fragment,null,n.renderItemIcon(t),r.createElement("span",{id:e?"ac_selected_function":void 0,className:t.classNames.label},t.item.text),e&&n.renderSecondaryText(t))}}),[]),Y=C.map((function(e,t){return{key:e.label+e.kind,text:e.label,secondaryText:e.detail,iconProps:{iconName:R(e)},onRender:(n=t,function(e,t){var a=n===v,o=C[n].type===p.SuggestionKind.Smart,i=a&&!j;return r.createElement("div",{className:k(),"data-test-id":"menuItemId".concat(n),onMouseMove:z(n),onMouseDown:M(n),onKeyDown:G(n),onFocus:V(n),ref:a?E:void 0,"data-is-focusable":!0,tabIndex:a?0:-1,"aria-label":x?" ":void 0},r.createElement(l.a,{classNames:F(i,W()&&o),hasIcons:!0,index:n,item:e}))}),onRenderContent:J(!j&&t===v),data:e.type};var n})),Z={key:"smart-section",itemType:u.a.Section,sectionProps:{items:Y.filter((function(e){return e.data===p.SuggestionKind.Smart})),bottomDivider:_}},Q={key:"simple-section",itemType:u.a.Section,sectionProps:{items:Y.filter((function(e){return e.data===p.SuggestionKind.Simple})),bottomDivider:!1}},q=null!==(n=null==b?void 0:b.onRestoreFocus)&&void 0!==n?n:void 0,X=[Z,Q];return r.createElement(d.a,{target:I,items:X,styles:T,onRenderMenuList:U,isBeakVisible:!1,shouldFocusOnMount:!1,directionalHint:P,directionalHintForRTL:P,hidden:h,calloutProps:{id:o,styles:S.a.calloutStyle,minPagePadding:N.c,layerProps:!B()&&K()?{eventBubblingEnabled:!0}:void 0},focusZoneAs:L,focusZoneProps:{disabled:h},onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===c.a.escape&&(null===(n=null==b?void 0:b.onDismiss)||void 0===n||n.call(b))},doNotLayer:B(),onRestoreFocus:q})})),L=function(e){return r.createElement(m.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)},B=Object(f.c)((function(){return Object(z.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)})),K=Object(f.c)((function(){return Object(z.isChangeGateEnabled)("OfficeVSO:6184552_FAEventBubblingEnabled")})),W=Object(f.c)((function(){return Object(z.isChangeGateEnabled)("OfficeVSO:6385514_FormulaAutoCompleteMenuFixes")}))},903:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1),r=n(1052),o=n(3),i=n(0),c=n(344),l=function(e){var t=e.disabled,n=e.onClick,l=Object(a.__rest)(e,["disabled","onClick"]);return i.createElement(r.a,{disabled:t,styles:Object(o.cb)(c.a.linkStyle,l.styles),onClick:n},ExcelRibbonStrings.FormulaAuthoringGiveFeedback)}}},[[1829,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/formulaAssistance.min.js.map/727b29677f66e76baa30f3c1537dec40/formulaAssistance.min.js.map