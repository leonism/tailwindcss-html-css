'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1190:function(t,D,a){t=a(0);var c=a(83),b=a(15),d=a(160),f=a(39);class e{constructor(y){this.qfa=this.kfa=this.ufa=this.tfa=null;this.X5d=this.l9d=this.$w=this.ML=!1;this.SNc=this.B9d=null;this.t9d=0;this.nb=this.z9d=null;this.P0=y;this.jA=3;this.$hb=!0}initialize(y,A,K){this.tfa=this.Bed(y,A);this.ufa=CommonUIStrings.l_SavingStatus;this.kfa=CommonUIStrings.l_ReadOnlyStatus;this.qfa=CommonUIStrings.l_ReviewModeStatus;
this.P0&&this.P0.execute(G=>{G.CTc(Object(c.a)(this,this.DNb,"updateToSavingStatus"))});this.$w=!0;this.nb=K;return!0}Sda(y,A){this.ML=y;this.jA=A;this.XR(this.$hb)}XR(y){!this.$hb&&y&&(this.z9d=new Date);this.$hb=y;y=null;3===this.jA&&(y=this.$hb?this.tfa:this.ufa);this.hfh(y)}Bed(y,A){return y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}DNb(){this.XR(!1)}VQh(){switch(this.jA){case 1:return this.kfa;
case 2:return this.qfa;default:return null}}Kfi(y){return this.l9d===this.ML&&this.t9d===this.jA&&this.B9d===y}a5c(y){appChrome.getHeaderApi().then(A=>{A.updateDocumentTitleStatus(this.ML,y,this.VQh(),this.z9d,this.$hb);this.X5d=!0;return null});this.SNc=null}hfh(y){this.$w&&d.c()&&!this.Kfi(y)&&(!this.X5d&&this.nb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.a5c(y):f.a.DRf()?(this.SNc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.SNc=window.requestIdleCallback(()=>{this.a5c(y)})):window.requestAnimationFrame(()=>{this.a5c(y)}),this.l9d=this.ML,this.B9d=y,this.t9d=this.jA)}}Object(t.a)(e,"ReactSaveStatusUIHandler",null,[270]);var k=a(163);class l{constructor(y,A){this.Vr=null;this.tfa=CommonUIStrings.l_SavedStatus;this.ufa=CommonUIStrings.l_SavingStatus;this.kfa=CommonUIStrings.l_ReadOnlyStatus;this.qfa=CommonUIStrings.l_ReviewModeStatus;this.yRb=A;this.P0=y;this.jA=3;this.sqa=!0}tv(){this.P0&&this.P0.execute(y=>{y.CTc(Object(c.a)(this,
this.DNb,"updateToSavingStatus"))});this.yRb.execute(y=>{this.Vr=y})}Sda(y,A){this.jA=A;3===A?this.XR(this.sqa):2===A?this.mWd(this.qfa):this.mWd(this.kfa)}DNb(){this.XR(!1)}XR(y){this.sqa=y;this.mWd(this.sqa?this.tfa:this.ufa)}mWd(y){this.Vr&&this.Vr.Fj(k.a.yNj,this.L0g(y))}L0g(y){const A={};A.StatusText=y;return A}}Object(t.a)(l,"SaveStatusPostMessageHandler",null,[270]);var m=a(92),v=a(123),n=a(56);class w{constructor(y,A,K,G){this.qfa=this.kfa=this.ufa=this.tfa=null;this.qDa=0;this.cE=this.FOc=
this.GBa=this.iDc=this.oEa=null;this.Md=y;this.X7=A;this.P0=K;this.dj=G;this.L7d=!0;this.ML=!1;this.jA=3;this.sqa=!0}initialize(y,A){if(!this.Md)return!1;this.tfa=this.Bed(y,A);this.ufa=CommonUIStrings.l_SavingStatus;this.kfa=CommonUIStrings.l_ReadOnlyStatus;this.qfa=CommonUIStrings.l_ReviewModeStatus;this.tv();return!0}Bed(y,A){return y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}tv(){this.X7&&
this.X7.execute(y=>{y.EFg(Object(c.a)(this,this.CDe,"createStatusAndModeElements"));y.vFg(Object(c.a)(this,this.wzj,"showHideSaveStatusElement"));y.mKj&&this.CDe(null,null)});this.P0&&this.P0.execute(y=>{y.CTc(Object(c.a)(this,this.DNb,"updateToSavingStatus"))})}Fv(){this.cE&&this.Md&&this.Md.pG(this.cE)}wzj(y,A){this.Sda("true"===A,this.jA)}Sda(y,A){this.ML=y;this.jA=A;this.iDc&&(this.iDc.style.display=this.ML||3===this.jA||!this.oEa?"none":"");this.GBa&&(this.GBa.style.display=this.ML||3===this.jA?
"none":"",this.GBa.innerText=1===this.jA?this.kfa:this.qfa,this.GBa.title=1===this.jA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.FOc&&(this.FOc.style.display=this.ML||1===this.jA||!this.oEa&&!this.GBa?"none":"");this.cE&&(this.cE.style.display=this.ML||1===this.jA?"none":"",this.XR(this.sqa),this.cE.title=CommonUIStrings.l_SaveStatusTooltip)}CDe(y,A){y=document.getElementById(m.CuiHelper.i6e);A&&A.HWj||!y||""===this.tfa||""===this.ufa||""===this.kfa||""===
this.qfa||(this.oEa=document.getElementById(m.CuiHelper.j_b),this.iDc=m.CuiHelper.wsa(y,"BreadcrumbAppModeDash","-",null,!1),this.GBa=m.CuiHelper.wsa(y,"BreadcrumbAppModeStatus",1===this.jA?this.kfa:this.qfa,null,!1),this.Tbg(this.GBa),this.FOc=m.CuiHelper.wsa(y,"BreadcrumbSaveStatusDash","-",null,!1),this.cE=m.CuiHelper.wsa(y,"BreadcrumbSaveStatus",this.tfa,null,!1),this.Tbg(this.cE),this.Sda(this.ML,this.jA))}DNb(){this.XR(!1)}XR(y){this.sqa=y;this.ASj(this.sqa?this.tfa:this.ufa)}ASj(y){!this.cE||
3!==this.jA&&2!==this.jA||(this.L7d&&!this.sqa?(this.qDa=this.cE.offsetWidth<this.qDa?this.qDa:this.cE.offsetWidth,this.xPj(this.ufa),this.L7d=!1):this.cE.innerText=y)}Tbg(y){y.style.direction=this.dj?"rtl":"ltr";y.style.width="auto";y.style.textAlign=this.dj?"right":"left";y.style.display=this.ML?"none":"";y.setAttribute("Unselectable","on")}xPj(y){this.cE&&(this.cE.style.width="",this.cE.innerText=y,this.qDa=this.cE.offsetWidth<this.qDa?this.qDa:this.cE.offsetWidth,y=v.a.dB(this.cE),this.cE.style.width=
this.qDa-n.a.rD(y.paddingLeft)-n.a.rD(y.paddingRight)+1+"px")}}Object(t.a)(w,"SaveStatusUIHandler",null,[270]);var r=a(4),u=a(91);class x{constructor(){this.GOc=this.GNc=this.okb=this.gb=null}get name(){return"Common.App.SaveStatus"}ai(y){this.gb=y;r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.gb.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").uc().Gc(()=>new l(this.gb.Vb("Common.App.HostNotification.EditNotificationEventSource"),
this.gb.Vb("Postmessage.IHostPostmessenger"))):r.AFrameworkApplication.ta.Pa.jgf||(r.AFrameworkApplication.ta.Pa.Zr?this.gb.register(e,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").uc().Gc(()=>new e(this.gb.Vb("Common.App.HostNotification.EditNotificationEventSource"))):this.gb.register(w,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").uc().Gc(()=>new w(u.EventHandlerManager.instance,this.gb.Vb("Common.App.Header.HeaderEventSource"),
this.gb.Vb("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)))}init(){r.AFrameworkApplication.fa.hv(Object(c.a)(this,this.vB,"onFullAppSettingsReady"))}vB(){const y=r.AFrameworkApplication.fa,A=!!r.AFrameworkApplication.ta.Pa&&4===r.AFrameworkApplication.ta.Pa.xj;if(y.qa("WordEditorAutoSaveImprovementIsEnabled")||y.qa("PptEditorSaveStatusInHeaderEnabled")||A&&y.qa("SimplifiedReactRibbonUxIsEnabled")||y.qa("ExcelSaveStatusInHeaderEnabled")||y.qa("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
r.AFrameworkApplication.hideHeaderEmbedded?(this.GOc=this.gb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.GOc.tv():r.AFrameworkApplication.ta.Pa.jgf||(r.AFrameworkApplication.ta.Pa.Zr?(this.GNc=this.gb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.GNc.initialize(y.qa("IsSkyDrive"),y.Va("HostNameToIncludeInSavedStatus"),r.AFrameworkApplication.fa):(this.okb=this.gb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.okb.initialize(y.qa("IsSkyDrive"),
y.Va("HostNameToIncludeInSavedStatus")))}dispose(){this.okb&&this.okb.Fv()}}Object(t.a)(x,"PackageManager",null,[4,5]);var z=a(246);a.d(D,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.SaveStatus");z.a.instance.Ii(new x)}},1245:function(t,D,a){var c=a(10);t=a(0);var b=a(82),d=a(220),f=a(223),e=a(31),k=a(21);class l{constructor(w,r){this.mee=this.SIc=!1;this.fya=(u,x)=>{(null===x||void 0===x?0:x.cH)&&e.a.yKg([x.cH])&&(this.MIb=!0)};this.Ao=()=>{this.MIb=!1};this.Xc=(u,x)=>
{f.b(x)&&this.Sda(!0);this.MIb=!1};this.Zc=()=>{this.SM=this.$.SM;this.Sda()};this.NAf=()=>{this.XR()};this.Pzf=()=>{this.SM=this.$.SM};this.Vxd=()=>{k.g(this.$).Ea.uv(this.Vxd);this.SM=this.$.SM};this.GUf=r;this.$=w;this.$.userOperationManager.Fr(this.Pzf);this.$.el(this.Zc);this.$.ea.eGg(this.NAf);this.$.ea.hk(this.Xc);this.$.WXb(this.fya);this.$.ea.ZL(this.Ao);this.Sda()}get Cpi(){return this.$.ea?this.$.ea.Jif:!1}get SM(){return this.SIc}set SM(w){w?this.SIc=!0:k.g(this.$)&&k.g(this.$).Ea&&(k.g(this.$).Ea.iZ()?
this.SIc=!1:k.g(this.$).Ea.ox(this.Vxd));this.XR()}get MIb(){return this.mee}set MIb(w){this.mee=w;this.XR()}dispose(){this.$&&(this.$.Cl(this.Zc),this.$.crc(this.fya),this.$.userOperationManager&&this.$.userOperationManager.Co(this.Pzf),this.$.ea&&(this.$.ea.Tbj(this.NAf),this.$.ea.Hk(this.Xc),this.$.ea.oR(this.Ao)),k.g(this.$)&&k.g(this.$).Ea&&k.g(this.$).Ea.uv(this.Vxd))}Sda(w=!1){w=!this.$.isEditMode||w;this.GUf.Sda(w,this.$.isEditMode?3:1);this.XR()}XR(){this.$.isEditMode&&this.GUf.XR(!this.SM&&
!this.Cpi&&!this.MIb)}}Object(t.a)(l,"SaveStatusManager",null,[3]);var m=a(695);class v extends d.a{constructor(w){super();this.Hc=w;this.Fb()}create(){const w=b.a.instance;w.Vb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(r=>{const u=new l(this.Hc,r);w.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").uc().Gc(()=>u);r=Object(m.b)(this.Hc.da,300,()=>w.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.qb(r)})}static ka(w){w.da.Ga(299,
new v(w))}}Object(t.a)(v,"SaveStatusFactory",d.a,[]);a.d(D,"a",function(){return n});const n=()=>{c.a.Fa(v.ka)}},1389:function(t,D,a){a.r(D);t=a(1190);a=a(1245);Type.registerNamespace("_Ewa");Object(t.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/a2d79d136b3382f02eef392d5bd957ae/EwaDSEsNext.savestatus.js.map