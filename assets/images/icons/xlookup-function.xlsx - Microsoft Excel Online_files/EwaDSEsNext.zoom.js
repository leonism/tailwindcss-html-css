'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1123:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1439:function(t,D,a){a.r(D);var c=a(10);t=a(0);var b=a(690),d=a(15),f=a(818),e=a(8),k=a(77),l=a(181),m=a(369),v=a(33),n=a(55);class w{constructor(ma){this.$=ma}Qc(){return!1}executeCommand(ma,ab,ba){let Ca=!1;ma=ab.command;const Na=v.a(this.$);11!==ab.Re&&7!==ab.Re&&6!==ab.Re&&2!==ab.Re&&14!==ab.Re&&15!==ab.Re&&16!==ab.Re&&d.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${ab.Re}`);const za=6===ab.Re;switch(ab.command){case -1365094462:case -1441674458:Na.XBc(Math.floor(10*
Na.zoom)/10+.1,za);Ca=!0;break;case 1056010365:case 1664364901:Na.XBc(Math.ceil(10*Na.zoom)/10-.1,za);Ca=!0;break;case 346087880:Na.XBc(e.a.XZ,za);Ca=!0;break;case -1918142559:case 1517993347:k.a.Oc in ba?(ba=parseFloat(ba[k.a.Oc]),ba!==Na.zoom&&Na.WBc(ba,1517993347===ab.command),Ca=!0):d.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:ab=parseFloat(ba[f.a.Value]);isNaN(ab)||Na.WBc(ab/100,!0);Ca=!0;break;case 1409187195:Na.zoomFitToScreen();
Ca=!0;break;case -1836771825:Na.zoomFitToScreenUndo(),Ca=!0}return Ca?n.Task.Ua(!0):l.a(ma)}Ec(ma,ab){switch(ab.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return v.a(this.$).GW();case -1365094462:case 1056010365:case -2096586688:return m.a(this.$);default:return!1}}Vc(){return!1}}Object(t.a)(w,"ZoomCommandHandler",null,[188]);class r extends b.a{constructor(ma){super(ma)}Dd(){this.ld([new w(this.$)])}static ka(ma){b.a.Rd(370,
new r(ma))}}Object(t.a)(r,"ZoomCommandHandlerFactory",b.a,[]);D=a(220);var u=a(86),x=a(27),z=a(82),B=a(539),y=a(48),A=a(5),K=a(161),G=a(64),T=a(289),W=a(131),P=a(42),E=a(36),H=a(12),F=a(11),N=a(104),J=a(97),R=a(21),M=a(304),L=a(132);class U{constructor(ma){this.R4a=this.$cc=0;this.o0b=null;this.kcf=!1;this.$=ma;this.kcf=ma.Rgc}jhi(){return R.g(this.$).$a?(d.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.rb.$x?(d.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}LJi(ma){this.o0b=new Sys.UI.Point(Math.round(ma.jua.center.x),Math.round(ma.jua.center.y));this.$cc=v.a(this.$).zoom;this.R4a=ma.jua.scale;let ab={["InitialZoom"]:this.$cc,["Location"]:"canvas",["InputMethod"]:ma.tb};L.b(this.$).Cd(W.a.eXi,ab);d.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.o0b.x},${this.o0b.y}), initial zoom ${this.$cc}, initial scale ${this.R4a}`);
this.U7a(ma,"onGestureStart");return!0}KJi(ma){if(!this.R4a)return d.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.U7a(ma,"OnGestureEvent"),!0;if(!isFinite(this.R4a))return d.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.R4a}`),this.U7a(ma,"OnGestureEvent"),!0;const ab=ma.jua.scale/this.R4a*this.$cc;v.a(this.$).lgg(ab,this.o0b);d.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ab}. Current scale ${ma.jua.scale}`);this.U7a(ma,"OnGestureEvent");return!0}JJi(ma){v.a(this.$).mgg();d.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.U7a(ma,"OnGestureEnd")}IJi(ma){d.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.U7a(ma,"OnGestureCancel")}U7a(ma,ab){var ba,Ca,Na;this.kcf&&(d.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ab},        eventArgs non-null: ${isNullOrUndefined(ma)}, gestureData non-null: ${isNullOrUndefined(null===
ma||void 0===ma?void 0:ma.jua)},        srcEvent non-null: ${isNullOrUndefined(null===(ba=null===ma||void 0===ma?void 0:ma.jua)||void 0===ba?void 0:ba.srcEvent)}`),null===(Na=null===(Ca=null===ma||void 0===ma?void 0:ma.jua)||void 0===Ca?void 0:Ca.srcEvent)||void 0===Na?void 0:Na.preventDefault())}}Object(t.a)(U,"PinchToZoomAdapter",null,[290]);var X=a(38);class da extends X.a{constructor(){super()}ene(ma){this.addHandler("ZCIEK",ma)}ZPf(ma){this.removeHandler("ZCIEK",ma)}dne(ma){this.addHandler("ZCUIK",
ma)}YPf(ma){this.removeHandler("ZCUIK",ma)}UGg(ma){this.addHandler("ZCEK",ma)}ycj(ma){this.removeHandler("ZCEK",ma)}t3i(){this.raiseEvent("ZCIEK")}s3i(){this.raiseEvent("ZCUIK")}u3i(){this.raiseEvent("ZCEK")}}Object(t.a)(da,"ZoomEventManager",X.a,[289]);var fa=a(22);class S extends X.a{constructor(ma){super();this.statusBarManager=null;this.ATe=!1;this.$=ma;this.$.da.Za(29,ab=>{this.statusBarManager=ab;ab.hJ(this)})}nq(ma){this.addHandler("Zoom",ma)}Nq(ma){this.removeHandler("Zoom",ma)}Dz(){this.mn("QueryZoomStatus")&&
this.raiseEvent("Zoom")}Pr(ma,ab){return"QueryZoomStatus"!==ma?!1:this.G2h(ab)}mn(){return v.a(this.$).GW()}dispose(){this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.$=null;super.dispose()}H2e(ma){ma=this.a_h(ma);if(!ma)return null;ma=ma.getElementsByClassName("cui-ctl-mediumlabel");return 1!==ma.length?(d.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):ma[0]}G2h(ma){if(!this.$)return!1;const ab=
v.a(this.$).wOb,ba=this.H2e("HandleQueryZoomStatusCommand");ba?fa.a.equals(ma.LabelText.toString(),ab,!1)||(ba.innerText="",this.YYf(ma,ab)):this.YYf(ma,ab);return!0}YYf(ma,ab){ma.LabelText=ab}a_h(ma){var ab=H.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ab)return ab=(ab=this.$.ea.jc)?ab.inEmbedView:!1,x.a.jp||ab||d.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${ma}`),null;
this.ATe||(this.ATe=!0,d.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${ma}`));return ab}}Object(t.a)(S,"ZoomStatusBarManager",X.a,[3,184,185]);class ka extends B.a{constructor(ma){super(ma);this.zoomEventManager=this.Pwa=this.sAb=null;this.xAb=-1;this.fcf=!1;this.Uc=()=>{this.xAb=-1};d.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.ffb=new S(ma);this.fXi()&&(d.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.pLg());this.J8i()}dispose(){this.ffb&&(u.a.Ia(this.ffb),this.ffb=null);this.zoomEventManager&&(this.$.da.YT(419),this.zoomEventManager=null);this.fcf&&this.Odh();super.dispose()}GW(){return!0}lgg(ma,ab){ma=this.Wta(ma);if(R.g(this.$).rtl){const ba=Math.round(H.DOMElementExtensions.getBounds(this.$.Bf).width*v.a(this.$).zoom);this.sAb=new Sys.UI.Point(ba-ab.x,ab.y)}else this.sAb=ab;this.Mza(ma,!1,"ZoomWithPinch")}VBc(){return!0}UBc(ma,ab){var ba=x.a.isMac?.07:.15;ma=this.zoom+(ma?ba:-ba);ma=this.Wta(ma);
R.g(this.$).rtl?(ba=Math.round(H.DOMElementExtensions.getBounds(this.$.Bf).width*v.a(this.$).zoom),this.Pwa=new Sys.UI.Point(ba-ab.x,ab.y)):this.Pwa=ab;ab=this.zoom;this.Mza(ma,!0,"ZoomWithMouse");ab={["InitialZoom"]:ab,["FinalZoom"]:ma,["Location"]:"canvas"};L.b(this.$).Cd(W.a.PXj,ab)}mgg(){this.sAb=null}WBc(ma,ab){this.Mza(this.Wta(ma),!1,ab?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}ngg(ma){isNaN(ma)?d.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.Mza(this.Wta(ma),!1,"ZoomToLevelInExcelLive")}ogg(ma){this.Mza(this.Wta(ma),!1,"ZoomWithActionPen")}XBc(ma,ab){this.Mza(this.Wta(ma),!0,ab?"ZoomWithShortcuts":"ZoomWithButtons")}B0e(ma,ab){const ba=R.g(this.$).rtl,[Ca,Na]=this.Zdd(ba),[za,la]=this.Gfd(ma,Na);return this.Pwa?(ma=this.Hdd(this.Pwa,ma,ab,Na,Ca,"ZoomWithMouse"),this.Pwa=null,ma):this.sAb?this.Hdd(this.sAb,ma,ab,Na,Ca,"ZoomWithPinch"):R.g(this.$).ha.Oa.nZ?this.OXj(ma,ab,Na,Ca,za,la,R.g(this.$).rtl):this.QXj(ma,ab,Na,Ca,za,la,R.g(this.$).rtl)}yVf(ma,
ab,ba){if(ma){d.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${ma.x} ${ma.y}) (new top-left) from zoom:${ab} to zoom:${ba}`);ma=new y.a(ma.x,ma.y);ba=R.g(this.$).rtl;[,ba]=this.Zdd(ba);const [Ca,Na]=this.Gfd(ab,ba);R.g(this.$).Jne(ma,Ca,Na,J.a.Xpe)}else d.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ab} to zoom:${ba}`)}zoomFitToScreen(){const ma=this.zoom;var ab=R.g(this.$).rtl;const [ba,Ca]=this.Zdd(ab),[Na,za]=this.Gfd(ma,Ca);var la=R.g(this.$).ha.Oa.nZ;(ab=la?this.LXe(this.H9a,
Na,za,!1):this.K0e(this.H9a,Ca,ba,Na,za,ab,!1))?(ab=Math.min(Na/(ab.width+100),za/(ab.height+100)),ab=this.FAh(ab),this.Mza(ab,!0,"ZoomWithFitToScreen"),la?R.g(this.$).ha.Oa.Vra(R.g(this.$).ha.Oa.$b,!1):(la=P.v(R.g(this.$).ha.sa.activeRange,this.$),R.g(this.$).vg(la,null,null,null,3,J.a.igg)),this.xAb=ma,this.fcf||this.mLg()):d.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${la}`)}zoomFitToScreenUndo(){this.Mza(this.xAb,!1,"ZoomWithFitToScreen")}dQd(){return-1!==
this.xAb}mLg(){const ma=R.g(this.$);ma&&(ma.ha.LG(this.Uc),ma.iC(this.Uc))}Odh(){const ma=R.g(this.$);ma&&(ma.ha.RF(this.Uc),ma.BD(this.Uc))}FAh(ma){ma=Math.min(ma,e.a.Ryi);ma=Math.max(ma,e.a.Jzi);return Math.round(100*ma)/100}Mza(ma,ab,ba){if(this.RBc()){var Ca=R.g(this.$).view.visibleArea.toString();ma=this.Wta(ma);var Na=G.d(this.$.xa.oa);Na||(Na=B.a.Wqf);R.g(this.$).Ci.O6(5,M.a.QBc,ba);R.g(this.$).Ci.Cka(M.a.QBc,this.$.ea.Le);d.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${ma} to sheet ${Na} origin ${ba} prevZoom ${this.zoom}`);
this.htj(Na,ma);this.zoomEventManager.u3i();this.wLj(ba);this.HLj(ab);this.xAb=-1;m.b(this.$,ba);ma=R.g(this.$).view.visibleArea.toString();d.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Ca}, NewGridVisibleArea: ${ma}, IsShyRibbonActive: ${this.$.wZ}`)}}eKh(ma){return(ma=F.HelperMethods.VC(this.$.Bf,this.$.domElement,ma))?ma:new Sys.UI.Point(0,0)}Zdd(ma){const ab=this.eKh(ma);ma=this.POh(ab,ma);return[ab,ma]}Gfd(ma,ab){const ba=H.DOMElementExtensions.getBounds(this.$.Bf);
return[Math.round((ba.width-ab.x)*ma),Math.round((ba.height-ab.y)*ma)]}POh(ma,ab){ab=F.HelperMethods.VC(R.g(this.$).domElement,this.$.domElement,ab);return ab?(ma=new Sys.UI.Point(Math.round(ab.x-ma.x),Math.round(ab.y-ma.y)),ma):new Sys.UI.Point(0,0)}QXj(ma,ab,ba,Ca,Na,za,la){return(la=this.K0e(ma,ba,Ca,Na,za,la))?this.D_e(la,ma,ab,ba,Ca,Na,za):null}K0e(ma,ab,ba,Ca,Na,za,la=!0){var aa=P.F(R.g(this.$).ha.sa.selectedRanges);if(la&&(aa=aa.Fe(P.F(R.g(this.$).Kac())),!aa))return d.ULS.sendTraceTag(537149777,
0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const sa=R.g(this.$).Xb(aa.topLeft);aa=R.g(this.$).Xb(aa.bottomRight);if(!sa||!aa)return d.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;ma=sa.cell.eK===aa.cell.eK&&sa.cell.dK===aa.cell.dK?this.XIh(ma,aa,ab,ba,Ca,za):this.RYh(ma,sa,aa,ab,ba,Ca,za);return ma?la?this.qSe(ma,Ca,Na):ma:(d.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}qSe(ma,ab,ba){if(0>ma.x||ma.x>ab)ma.x=0;if(0>ma.y||ma.y>ba)ma.y=0;ma.x+ma.width>ab&&(ma.width=ab-ma.x);ma.y+ma.height>ba&&(ma.height=ba-ma.y);return ma}RYh(ma,ab,ba,Ca,Na,za,la){ab=R.g(this.$).getCellBounds(ab.cell);if(!ab)return null;const aa=R.g(this.$).getCellBounds(ba.cell);if(!aa)return null;let sa=Na.x;la&&(sa=0,ab.x=Math.round(za/ma)-ab.x-Math.round(ab.width),aa.x=Math.round(za/ma)-aa.x-Math.round(aa.width));ma=new Sys.UI.Bounds(Math.round((ab.x-
Ca.x)*ma)-sa,Math.round((ab.y-Ca.y)*ma-Na.y),Math.round((aa.x+aa.width-ab.x)*ma),Math.round((aa.y+aa.height-ab.y)*ma));ba=ba.cell.getRange();d.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${ba.top}, b:${ba.bottom}, r:${ba.right}, l:${ba.left}) in bounds (${ma.x}, ${ma.y}, ${ma.width}, ${ma.height})`);return ma}XIh(ma,ab,ba,Ca,Na,za){const la=R.g(this.$).getCellBounds(ab.cell);if(!la)return null;let aa=Ca.x;
za&&(aa=0,la.x=Math.round(Na/ma)-la.x-Math.round(la.width));ma=new Sys.UI.Bounds(Math.round((la.x-ba.x)*ma)-aa,Math.round((la.y-ba.y)*ma-Ca.y),Math.round(la.width*ma),Math.round(la.height*ma));ab=ab.cell.getRange();d.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ab.top}, l:${ab.left}) in bounds (${ma.x}, ${ma.y}, ${ma.width}, ${ma.height})`);return ma}OXj(ma,ab,ba,Ca,Na,za){const la=this.LXe(ma,Na,za);return la?this.D_e(la,ma,
ab,ba,Ca,Na,za):null}D_e(ma,ab,ba,Ca,Na,za,la){ma=new Sys.UI.Point(this.f0e(za,ma.x,ma.width),this.f0e(la,ma.y,ma.height));return this.Hdd(ma,ab,ba,Ca,Na)}f0e(ma,ab,ba){return ma===ba?(d.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),ma/2):ma*ab/(ma-ba)}LXe(ma,ab,ba,Ca=!0){const Na=R.g(this.$).ha.Oa.$b.domElement;var za=F.HelperMethods.VC(Na,R.g(this.$).domElement,R.g(this.$).rtl);if(!za)return d.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const la=R.g(this.$).uvb();za=new Sys.UI.Point(Math.round((za.x-la.topLeft.x)*ma),Math.round((za.y-la.topLeft.y)*ma));ma=new Sys.UI.Bounds(za.x,za.y,Math.round(Na.offsetWidth*ma),Math.round(Na.offsetHeight*ma));return Ca?this.qSe(ma,ab,ba):ma}srf(){this.ffb.Dz()}qDi(ma){"ZoomToLevelInExcelLive"===ma?this.zoomEventManager.t3i():this.zoomEventManager.s3i()}J8i(){this.zoomEventManager=this.$.da.Ga(419,new da)}Hdd(ma,
ab,ba,Ca,Na,za=""){var la=R.g(this.$).rtl?0:Na.x;Na="ZoomWithPinch"===za||"ZoomWithMouse"===za?new Sys.UI.Point(ma.x-la-Math.round(Ca.x*ab),ma.y-Na.y-Math.round(Ca.y*ab)):ma;Na=new Sys.UI.Point(Math.round(Na.x/ab),Math.round(Na.y/ab));d.ULS.shipAssertTag(537149770,0,!!ab,"Original zoom level must be different than 0");la=ba/ab;Na=new Sys.UI.Point(Math.round(Na.x*(1-1/la)),Math.round(Na.y*(1-1/la)));"ZoomWithMouse"===za||"ZoomWithPinch"===za?(Na.x+=Math.round((Ca.x-R.g(this.$).mI)*(la-1)),Na.y+=Math.round((Ca.y-
R.g(this.$).vJ)*(la-1))):(la=Math.round(Ca.x*(ba-ab)),0<la&&Na.x>la&&(Na.x+=la),ab=Math.round(Ca.y*(ba-ab)),0<ab&&Na.y>ab&&(Na.y+=ab));"ZoomWithMouse"===za&&(ma.x||(Na.x=0),ma.y||(Na.y=0));ma=R.g(this.$).uvb();return new Sys.UI.Point(Na.x+ma.topLeft.x,Na.y+ma.topLeft.y)}pLg(){const ma=[];z.a.instance.Vb("Common.IGestureInputManager").execute(ab=>{0===ab.oOh()&&ab.p7i(document.body,new U(this.$),ma)})}fXi(){return this.RBc()&&(x.a.fp&&x.a.iLa(67)||this.$.Rgc)}htj(ma,ab){m.a(this.$)?this.setZoomLevel(ma,
ab,this.RZd,e.a.jHf):this.setZoomLevel(ma,ab,this.zoomPerSheetId,this.H9a)}setZoomLevel(ma,ab,ba,Ca){ba.remove(ma);ab!==Ca&&ba.add(ma,ab)}wLj(ma){this.NZf();this.$.Kya(T.a.MY("TriggerImmediateZoomOperations"));this.zTj();this.qDi(ma)}zTj(){this.Nki()?this.$.pf():this.ffb.Dz();const ma=this.ffb.H2e("UpdateZoomStatusBar");ma&&(ma.innerText=this.wOb)}Nki(){const ma=K.a(this.$);return ma?ma.Xl.Tz===(E.a.rwa(this.$)?A.a.Cpc:this.$.Bb+A.a.dTf):!1}HLj(ma){R.g(this.$).NXj(ma);this.CHg()}CHg(){const ma=N.a(this.$);
if(ma)for(const ab of R.g(this.$).Ea.bF()){if(!ab){d.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!ab.Ck)continue;const ba=ab.Bi;if(ba)for(let Ca=0;Ca<ba.count;Ca++)if(2===ba.dg(Ca).type){const Na=ma.sq(ba.dg(Ca).Lg());Na?(Na.Oda(!1),d.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):d.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else d.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(t.a)(ka,"ZoomManager",B.a,[]);var V=a(1);class wa extends D.a{constructor(ma){super();this.$=ma;this.Fb()}create(){const ma=new ka(this.$);this.BTj(ma);V.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&this.$.da.Ga(368,ma);this.qb(ma)}BTj(ma){const ab=v.a(this.$);if(ab){var ba=ab.Lfd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");ma.mOd(ba);ma.Ysc(ab.Czc)}else d.ULS.shipAssertTag(537149765,
0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(ma){ma.da.Ga(369,new wa(ma))}}Object(t.a)(wa,"ZoomManagerFactory",D.a,[]);a=a(1123);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(ma=>{wa.ka(ma);r.ka(ma)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/1ccd5122e5069253a5fc4059f03a6743/EwaDSEsNext.zoom.js.map