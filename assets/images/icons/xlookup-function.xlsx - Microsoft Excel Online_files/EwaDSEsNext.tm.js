'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1271:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(98),d=a(78),f=a(11),e=a(220);class k extends e.a{constructor(v){super();this.$=v;this.Fb()}create(){const {RenderingFidelityTracker:v}=a(1271);let n=this.$.da.za(462);n||(n=this.$.da.Ga(462,new v));this.qb(n)}}Object(t.a)(k,"RenderingFidelityTrackerFactory",e.a,[]);var l=a(46);a.d(D,"RenderingFidelityTracker",function(){return m});class m extends d.a{constructor(){super();
this.Nzi=3E4;this.Qdb={};this.PYd={};this.wse={};b.Health.instance.addQosPillar("Fidelity")}static ka(v){v.da.Ga(463,new k(v))}AIg(v,n,w,r){if(!(l.PageLoadTrackingInfo.instance.HJa(new Date)<this.Nzi)){var u=f.HelperMethods.Cba(()=>{var x=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(n),z=Object.keys(x),B=this.wse[v];for(var y=0;y<z.length;y++){var A=z[y];this.PYd[A]||(null===B||void 0===B?0:B[A])&&this.Qdb[A]&&(this.Qdb[A]-=B[A])}this.wse[v]=x;for(y=0;y<z.length;y++)if(B=z[y],!this.PYd[B])if(A=
x[B],this.Qdb[B]&&(A+=this.Qdb[B]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(B,A)){this.PYd[B]=!0;x=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(B);z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(B);x&&z&&b.Health.instance.recordQosError(x,[z],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+B+", isHC:"+w+", scaleFactor:"+r+"}");break}else this.Qdb[B]=A});1<u&&c.ULS.sendTraceTag(527472323,
1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${u}`)}}}Object(t.a)(m,"RenderingFidelityTracker",d.a,[570,3])},1414:function(t,D,a){function c(Ea){var Fa=Ea.replace(/-.*/g,()=>"");Fa=Qc.get(Fa);return null!==Fa&&void 0!==Fa?Fa:Jc&&Ea.startsWith("ooux")?"ooux":"other"}a.r(D);var b=a(0),d=a(15);class f{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(b.a)(f,"BrowserInfo",null,[]);class e{constructor(){this.Version=
this.Name=null}}Object(b.a)(e,"PluginInfo",null,[]);var k=a(4),l=a(27);class m{static $ti(){if(k.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var Ea=m.IDh();try{const Fa=JSON.stringify(Ea);d.ULS.sendTraceTag(6903563,102,50,Fa)}catch(Fa){d.ULS.sendTraceTag(6903564,102,15,Fa.message)}}else d.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static ZSh(){const Ea=window.navigator.plugins;if(!Ea||!Ea.length)return null;const Fa=[];for(let vc=0;vc<Ea.length;vc++){const rd=
Ea[vc].name,de=Ea[vc].version;Array.add(Fa,Object.assign(new e,{Name:rd,Version:de}))}return Fa}static IDh(){const Ea=new f,Fa=new Sys.StringBuilder;m.ft(vc=>{Ea.DocElemClientHeight=vc},()=>document.documentElement.clientHeight,Fa);m.ft(vc=>{Ea.DocElemClientWidth=vc},()=>document.documentElement.clientWidth,Fa);m.ft(vc=>{Ea.DocElemOffsetHeight=vc},()=>document.documentElement.offsetHeight,Fa);m.ft(vc=>{Ea.DocElemOffsetWidth=vc},()=>document.documentElement.offsetWidth,Fa);m.ft(vc=>{Ea.ScreenAvailHeight=
vc},()=>window.screen.availHeight,Fa);m.ft(vc=>{Ea.ScreenAvailWidth=vc},()=>window.screen.availWidth,Fa);m.ft(vc=>{Ea.ScreenWidth=vc},()=>window.screen.width,Fa);m.ft(vc=>{Ea.ScreenHeight=vc},()=>window.screen.height,Fa);m.ft(vc=>{Ea.ScreenLogicalXdpi=vc},()=>window.screen.logicalXDPI,Fa);m.ft(vc=>{Ea.ScreenLogicalYdpi=vc},()=>window.screen.logicalYDPI,Fa);m.ft(vc=>{Ea.ScreenDeviceXdpi=vc},()=>window.screen.deviceXDPI,Fa);m.ft(vc=>{Ea.ScreenDeviceYdpi=vc},()=>window.screen.deviceYDPI,Fa);m.ft(vc=>
{Ea.WinInnerHeight=vc},()=>window.self.innerHeight,Fa);m.ft(vc=>{Ea.WinInnerWidth=vc},()=>window.self.innerWidth,Fa);m.ft(vc=>{Ea.WinOuterHeight=vc},()=>window.self.outerHeight,Fa);m.ft(vc=>{Ea.WinOuterWidth=vc},()=>window.self.outerWidth,Fa);m.ft(vc=>{Ea.WinOrientation=vc},()=>window.self.orientation,Fa);m.ft(vc=>{Ea.WinDevicePixelRatio=vc},()=>window.self.devicePixelRatio,Fa);m.ft(vc=>{Ea.SupportsTouch=vc},()=>l.a.Hxc,Fa);m.ft(vc=>{Ea.NavAppName=vc},()=>window.navigator.appName,Fa);m.ft(vc=>{Ea.NavAppVersion=
vc},()=>window.navigator.appVersion,Fa);m.ft(vc=>{Ea.NavLanguage=vc},()=>window.navigator.browserLanguage||window.navigator.language,Fa);m.ft(vc=>{Ea.NavUserAgent=vc},()=>window.navigator.userAgent,Fa);m.ft(vc=>{Ea.NavPlatform=vc},()=>window.navigator.platform,Fa);m.ft(vc=>{Ea.NavPlugins=vc},m.ZSh,Fa);m.ft(vc=>{Ea.CalculatedDevicePixelRatio=vc},()=>m.devicePixelRatio,Fa);Ea.Error=Fa.toString();return Ea}static get devicePixelRatio(){const Ea=window.devicePixelRatio;return isNaN(Ea)?window.screen.deviceXDPI/
window.screen.logicalXDPI:Ea}static ft(Ea,Fa,vc){try{const rd=Fa();Ea(rd)}catch(rd){vc.isEmpty()||vc.append(" | "),vc.append(rd.message||"null")}}}Object(b.a)(m,"BrowserInfoLogger",null,[]);var v=a(246);class n{get name(){return"Common.App.BrowserInfoLogger"}ai(){}init(){m.$ti()}dispose(){}static main(){v.a.instance.Ii(new n)}}Object(b.a)(n,"BrowserInfoLoggerPackage",null,[4,5]);var w=a(80);class r{constructor(Ea){this.WCc=Ea}xbf(Ea){if(!this.WCc)return!0;Ea=w.a.$cd(Ea);if(!Ea)return!1;Ea=Ea.toLowerCase();
for(let Fa=0;Fa<this.WCc.length;Fa++)if(Ea.endsWith(this.WCc[Fa]))return!0;return!1}}Object(b.a)(r,"DomainAllowListManager",null,[]);class u{constructor(Ea,Fa){this.h$=null;this.BQc=Ea;this.url=Fa}get XXd(){return w.a.Aca(this.url)}get yt(){return this.BQc}IUd(){const Ea={},Fa=this.yt;Ea.a=this.XXd;Ea.b=this.round(Fa.navigationStart);Ea.c=this.round(Fa.unloadEventStart);Ea.d=this.round(Fa.unloadEventEnd);Ea.e=this.round(Fa.redirectStart);Ea.f=this.round(Fa.redirectEnd);Ea.g=this.round(Fa.fetchStart);
Ea.h=this.round(Fa.domainLookupStart);Ea.i=this.round(Fa.domainLookupEnd);Ea.j=this.round(Fa.connectStart);Ea.k=this.round(Fa.connectEnd);Ea.l=void 0!==Fa.secureConnectionStart&&null!==Fa.secureConnectionStart?this.round(Fa.secureConnectionStart):0;Ea.m=this.round(Fa.requestStart);Ea.n=this.round(Fa.responseStart);Ea.o=this.round(Fa.responseEnd);Ea.q=this.round(Fa.domInteractive);Ea.r=this.round(Fa.domContentLoadedEventStart);Ea.s=this.round(Fa.domContentLoadedEventEnd);Ea.t=this.round(Fa.domComplete);
Ea.u=this.round(Fa.loadEventStart);Ea.v=this.round(Fa.loadEventEnd);Ea.w=this.h$;return Ea}round(Ea){return Math.round(1E3*Ea)/1E3}}Object(b.a)(u,"PerformanceTimingEntry",null,[]);const x=(Ea,Fa)=>{const vc={};let rd=null;switch(Ea){case 0:rd="ResourceTiming";Ea=Fa.a;null!=Ea&&(vc.Url=Ea);Ea=Fa.b;null!=Ea&&(vc.InitiatorType=Ea);Ea=null==Fa.c?null:Fa.c.toString();null!=Ea&&(vc.RedirectStart=Ea);Ea=null==Fa.d?null:Fa.d.toString();null!=Ea&&(vc.RedirectEnd=Ea);Ea=null==Fa.e?null:Fa.e.toString();null!=
Ea&&(vc.FetchStart=Ea);Ea=null==Fa.f?null:Fa.f.toString();null!=Ea&&(vc.DomainLookupStart=Ea);Ea=null==Fa.g?null:Fa.g.toString();null!=Ea&&(vc.DomainLookupEnd=Ea);Ea=null==Fa.h?null:Fa.h.toString();null!=Ea&&(vc.ConnectStart=Ea);Ea=null==Fa.i?null:Fa.i.toString();null!=Ea&&(vc.ConnectEnd=Ea);Ea=null==Fa.j?null:Fa.j.toString();null!=Ea&&(vc.SecureConnectionStart=Ea);Ea=null==Fa.k?null:Fa.k.toString();null!=Ea&&(vc.RequestStart=Ea);Ea=null==Fa.l?null:Fa.l.toString();null!=Ea&&(vc.ResponseStart=Ea);
Ea=null==Fa.m?null:Fa.m.toString();null!=Ea&&(vc.ResponseEnd=Ea);Ea=Fa.n;null!=Ea&&(vc.CustomText=Ea);Ea=null==Fa.o?null:Fa.o.toString();null!=Ea&&(vc.DecodedBodySize=Ea);Ea=null==Fa.p?null:Fa.p.toString();null!=Ea&&(vc.EncodedBodySize=Ea);Fa=null==Fa.q?null:Fa.q.toString();null!=Fa&&(vc.TransferSize=Fa);break;case 1:rd="PerformanceTiming",Ea=Fa.a,null!=Ea&&(vc.Url=Ea),Ea=null==Fa.b?null:Fa.b.toString(),null!=Ea&&(vc.NavigationStart=Ea),Ea=null==Fa.c?null:Fa.c.toString(),null!=Ea&&(vc.UnloadEventStart=
Ea),Ea=null==Fa.d?null:Fa.d.toString(),null!=Ea&&(vc.UnloadEventEnd=Ea),Ea=null==Fa.e?null:Fa.e.toString(),null!=Ea&&(vc.RedirectStart=Ea),Ea=null==Fa.f?null:Fa.f.toString(),null!=Ea&&(vc.RedirectEnd=Ea),Ea=null==Fa.g?null:Fa.g.toString(),null!=Ea&&(vc.FetchStart=Ea),Ea=null==Fa.h?null:Fa.h.toString(),null!=Ea&&(vc.DomainLookupStart=Ea),Ea=null==Fa.i?null:Fa.i.toString(),null!=Ea&&(vc.DomainLookupEnd=Ea),Ea=null==Fa.j?null:Fa.j.toString(),null!=Ea&&(vc.ConnectStart=Ea),Ea=null==Fa.k?null:Fa.k.toString(),
null!=Ea&&(vc.ConnectEnd=Ea),Ea=null==Fa.l?null:Fa.l.toString(),null!=Ea&&(vc.SecureConnectionStart=Ea),Ea=null==Fa.m?null:Fa.m.toString(),null!=Ea&&(vc.RequestStart=Ea),Ea=null==Fa.n?null:Fa.n.toString(),null!=Ea&&(vc.ResponseStart=Ea),Ea=null==Fa.o?null:Fa.o.toString(),null!=Ea&&(vc.ResponseEnd=Ea),Ea=null==Fa.p?null:Fa.p.toString(),null!=Ea&&(vc.DomLoading=Ea),Ea=null==Fa.q?null:Fa.q.toString(),null!=Ea&&(vc.DomInteractive=Ea),Ea=null==Fa.r?null:Fa.r.toString(),null!=Ea&&(vc.DomContentLoadedEventStart=
Ea),Ea=null==Fa.s?null:Fa.s.toString(),null!=Ea&&(vc.DomContentLoadedEventEnd=Ea),Ea=null==Fa.t?null:Fa.t.toString(),null!=Ea&&(vc.DomComplete=Ea),Ea=null==Fa.u?null:Fa.u.toString(),null!=Ea&&(vc.LoadEventStart=Ea),Ea=null==Fa.v?null:Fa.v.toString(),null!=Ea&&(vc.LoadEventEnd=Ea),Fa=Fa.w,null!=Fa&&(vc.CustomText=Fa)}vc.Table=rd;return Sys.Serialization.JavaScriptSerializer.serialize(vc)};var z=a(52),B=a(217),y=a(316);class A{constructor(Ea,Fa=null,vc=null){this.Og=Ea;this.WXd=this;this.wog=Fa||(()=>
window.location.href);this.VFc=new r(vc)}run(){if(A.lP(window.performance))try{const de=this.wog();if(A.ixg.exec(de)&&this.VFc.xbf(de)){var Ea=new u(window.performance.timing,de);y.a.instance.t5i(Ea.yt.fetchStart);y.a.instance.u5i(Ea.yt.navigationStart);y.a.instance.MBb(z.a.CCh,"connectStart","requestStart");y.a.instance.MBb(z.a.KCh,"requestStart","responseStart");y.a.instance.MBb(z.a.NCh,"responseStart","responseEnd");this.WXd.Ie(1,Ea.IUd());this.Og.Wm(z.a.eua,Ea.yt.fetchStart);this.Og.Wm(z.a.HCh,
Ea.yt.domainLookupStart);this.Og.Wm(z.a.GCh,Ea.yt.domainLookupEnd);this.Og.Wm(z.a.ECh,Ea.yt.connectStart);this.Og.Wm(z.a.OCh,Ea.yt.secureConnectionStart);this.Og.Wm(z.a.DCh,Ea.yt.connectEnd);this.Og.Wm(z.a.LCh,Ea.yt.requestStart);this.Og.Wm(z.a.jad,Ea.yt.responseStart);this.Og.Wm(z.a.ICh,Ea.yt.responseEnd-Ea.yt.responseStart);this.Og.Wm(z.a.MCh,Ea.yt.responseStart-Ea.yt.requestStart);var Fa=0,vc=0,rd=0;({transferSize:Fa,s6c:vc,$3c:rd}=this.UMj(de)).returnValue&&(this.Og.Wm(z.a.PCh,Fa),this.Og.Wm(z.a.FCh,
rd),this.Og.Wm(z.a.JCh,vc));this.Og.Wm(z.a.iad,Ea.yt.navigationStart)}}catch(de){d.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",de)}}UMj(Ea){let Fa,vc,rd;rd=vc=Fa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Fa,s6c:vc,$3c:rd};Ea=window.performance.getEntriesByName(Ea,"navigation");if(void 0===Ea||null===Ea||1!==Ea.length)return{returnValue:!1,transferSize:Fa,s6c:vc,$3c:rd};
Ea=Ea[0];var de=Ea.transferSize;void 0!==Fa&&null!==Fa&&(Fa=de);de=Ea.decodedBodySize;void 0!==de&&null!==de&&(rd=de);Ea=Ea.encodedBodySize;void 0!==Ea&&null!==Ea&&(vc=Ea);return{returnValue:!0,transferSize:Fa,s6c:vc,$3c:rd}}Ie(Ea,Fa){d.ULS.sendTraceTag(4551815,306,50,x(Ea,Fa))}static get instance(){return A.Ma||(A.Ma=new A(B.a.instance,null,k.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?k.AFrameworkApplication.fa.lw("ResourceLoggerDomainAllowList"):null))}static lP(Ea){return!(void 0===
Ea||null===Ea)&&!(void 0===Ea.timing||null===Ea.timing)}}A.Ma=null;A.ixg=RegExp("^https?://.*","i");Object(b.a)(A,"PerformanceTimingLogger",null,[598]);var K=a(95),G=a(84);class T{constructor(Ea,Fa){this.h$=null;this.BQc=Ea;this.behavior=Fa;this.url=this.yt.name}get XXd(){return 2===this.behavior?this.url:w.a.Aca(this.url)}get yt(){return this.BQc}IUd(){const Ea={},Fa=this.yt;Ea.a=this.XXd;Ea.b=Fa.initiatorType;Ea.c=this.round(Fa.redirectStart);Ea.d=this.round(Fa.redirectEnd);Ea.e=this.round(Fa.fetchStart);
Ea.f=this.round(Fa.domainLookupStart);Ea.g=this.round(Fa.domainLookupEnd);Ea.h=this.round(Fa.connectStart);Ea.i=this.round(Fa.connectEnd);Ea.j=void 0!==Fa.secureConnectionStart&&null!==Fa.secureConnectionStart?this.round(Fa.secureConnectionStart):0;Ea.k=this.round(Fa.requestStart);Ea.l=this.round(Fa.responseStart);Ea.m=this.round(Fa.responseEnd);Ea.o=this.round(T.C3a(Fa,"decodedBodySize"));Ea.p=this.round(T.C3a(Fa,"encodedBodySize"));Ea.q=this.round(T.C3a(Fa,"transferSize"));Ea.n=this.h$;return Ea}round(Ea){return Math.round(1E3*
Ea)/1E3}static C3a(Ea,Fa){return Ea[Fa]}}Object(b.a)(T,"ResourceTimingEntry",null,[638]);var W=a(98),P=a(134),E=a(41),H=a(112),F=a(185);class N{constructor(Ea,Fa=null,vc=100){this.y0d=Ea;this.oVb=Fa;this.vfb={};this.dlg=vc}jMj(Ea){var Fa=Ea.name.toLowerCase();const vc=w.a.Nua(Fa);this.igj(vc,Fa)&&(vc in this.vfb?d.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",vc):(Fa={},Fa.fetchstart=Ea.fetchStart,Fa.responseend=Ea.responseEnd,Fa.iscached=this.Qmi(Ea),
Fa.encodedsize=T.C3a(Ea,"encodedBodySize"),Fa.decodedsize=T.C3a(Ea,"decodedBodySize"),this.vfb[vc]=Fa))}igj(Ea,Fa){if(this.y0d)return Array.contains(this.y0d,Ea);if(this.oVb)for(Ea=w.a.FM(Fa),Fa=0;Fa<this.oVb.length;Fa++)if(this.oVb[Fa]&&Ea.endsWith(this.oVb[Fa]))return!0;return!1}Qmi(Ea){try{const Fa=T.C3a(Ea,"transferSize");if(void 0!==Fa&&null!==Fa)return!Fa;d.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return Ea.responseEnd-
Ea.fetchStart<this.dlg}catch(Fa){d.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Fa.message)}return!1}R5i(){if(H.a.kh(this.vfb))d.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Ea=k.AFrameworkApplication.YE?k.AFrameworkApplication.YE.split(";"):[],Fa=Object.assign(new F.a,{extendedProperties:P.a.Kr()});Fa.extendedProperties.set("Flights",E.c(Ea));this.hui(Fa,this.vfb,
W.Health.instance)}}hui(Ea,Fa,vc){if(Fa){var rd=0,de=0,qe=0,bf=0,of=0,Mf=0,Ff=0,hg=0,xf=0,Df=0,Tf=0;for(let ig in Fa){var Pg=Fa[ig];try{const ag=Object(G.a)(Object,Pg);if(!ag)continue;const eh=ag.iscached?Boolean.parse(ag.iscached.toString()):!1,xg=ag.fetchstart?this.parseFloat(ag.fetchstart.toString()):0,fh=(ag.responseend?this.parseFloat(ag.responseend.toString()):0)-xg,gh=ag.encodedsize?this.parseFloat(ag.encodedsize.toString()):0,$g=ag.decodedsize?this.parseFloat(ag.decodedsize.toString()):0;
rd+=fh;bf+=gh;Ff+=$g;Df++;eh?(qe+=fh,Mf+=gh,xf+=$g,Tf++):(de+=fh,of+=gh,hg+=$g)}catch(ag){d.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",ag.message)}}Ea.extendedProperties.set("StaticResources",E.c(Fa));Ea.extendedProperties.set("TotalResourceDownloadLatency",rd.toString());Ea.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",de.toString());Ea.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",qe.toString());Ea.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
bf.toString());Ea.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",of.toString());Ea.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Mf.toString());Ea.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ff.toString());Ea.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",hg.toString());Ea.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",xf.toString());Ea.extendedProperties.set("TotalNumberOfResourcesDownloaded",
Df.toString());Ea.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Tf.toString());vc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);vc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ea)}}parseFloat(Ea){if(!Ea)return 0;Ea=parseFloat(Ea);return isNaN(Ea)?0:Ea}}Object(b.a)(N,"AppStaticResourceManager",null,[]);class J extends Sys.EventArgs{constructor(Ea){super();this.entries=Ea}}Object(b.a)(J,"EntriesAvailableEventArgs",Sys.EventArgs,
[]);var R=a(107);class M{constructor(Ea,Fa,vc=null,rd=null,de=100){this.UJc=!1;this.Ni=null;this.wgb=0;this.eb=new K.a;this.Afb=null;this.wS=!1;this.Wge=0;this.ee=Ea;this.n3d=0;this.WXd=this;this.VFc=new r(vc);this.Ju=Fa;rd&&(this.Afb=new N(null,rd,de))}get dte(){try{return!(void 0===this.Ju||null===this.Ju)&&!(void 0===this.Ju.getEntriesByType||null===this.Ju.getEntriesByType)}catch(Ea){return d.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
Ea),!1}}get wbh(){return this.n3d}get isActive(){return this.wS}get yUd(){return this.Wge}ZDg(Ea){this.eb.addHandler(M.Y6c,Ea)}laj(Ea){this.eb.removeHandler(M.Y6c,Ea)}ai(Ea,Fa){const vc=this.yUd!==Ea;this.Wge=Ea;this.isActive&&this.ee&&vc&&(this.Hp(),this.Hg());this.n3d=Fa}activate(){!this.isActive&&this.dte&&(this.Hg(),this.wS=!0)}deactivate(Ea){this.isActive&&(this.Hp(),Ea&&this.flush(),this.wS=!1)}flush(){if(this.isActive&&this.dte)try{var Ea=window.performance.getEntriesByType("resource");0<Ea.length-
this.wgb&&d.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ea.length-this.wgb);const Fa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Fa&&(window.performance.clearResourceTimings(),this.wgb=0);const vc=[];for(let rd=this.wgb;rd<Ea.length;rd++)this.VFc.xbf(Ea[rd].name)&&(this.Afb&&this.Afb.jMj(Ea[rd]),vc.push(new T(Ea[rd],this.wbh)));Fa||(this.wgb=Ea.length);this.eb.raiseEvent(M.Y6c,
new J(vc));for(Ea=0;Ea<vc.length;Ea++)0!==vc[Ea].behavior&&2!==vc[Ea].behavior||this.WXd.Ie(0,vc[Ea].IUd());0<vc.length&&d.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",vc.length)}catch(Fa){d.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Fa)}}Ie(Ea,Fa){d.ULS.sendTraceTag(4310804,306,50,x(Ea,Fa))}s5i(){this.Afb.R5i()}Hg(){this.ee&&0<this.yUd&&(this.Ni=new R.a(3,2,1E3*this.yUd,()=>{this.flush()},
5),this.ee.Hg(this.Ni),this.UJc=!0)}Hp(){this.UJc&&(this.ee.Hp(this.Ni),this.Ni=null,this.UJc=!1)}}M.Y6c="EntriesAvailable";Object(b.a)(M,"ResourceTimingLogger",null,[572,598]);var L=a(119);class U{constructor(){this.gb=null}get name(){return"Common.ResourceTiming"}init(){this.gb.resolve("Common.NetworkTiming.IResourceTimingLogger");A.instance.run()}dispose(){}ai(Ea){this.gb=Ea;let Fa=null;if(k.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{Fa=k.AFrameworkApplication.fa.lw("ResourceLoggerDomainAllowList")}catch(de){d.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const vc=[];vc.push(w.a.FM(L.a.kL).toLowerCase());vc.push(w.a.FM(L.a.lcb).toLowerCase());const rd=k.AFrameworkApplication.fa.nd("AppStaticResourceMonitorCacheThresholdInMs",100);Ea.register(572,"Common.NetworkTiming.IResourceTimingLogger").uc().Gc(()=>new M(k.AFrameworkApplication.Ji,window.performance,Fa,vc,rd))}static main(){v.a.instance.Ii(new U)}}Object(b.a)(U,"ResourceTimingPackage",null,[4,5]);var X=a(83);class da extends Sys.EventArgs{constructor(Ea,
Fa){super();this.hIj=Ea;this.actualValue=Fa}}Object(b.a)(da,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var fa=a(165);class S{constructor(){this.pUa=[];this.M2d=this.jFc=0;this.sea=null;this.eb=new K.a}init(Ea,Fa,vc){this.sea=Ea;this.jFc=Fa;this.M2d=vc;this.sea.wme(Object(X.a)(this,this.EHi,"onCpuMeterFrameAvailable"));this.lFg(Object(X.a)(this,this.e3g,"cpuPercentThresholdExceeded"))}EHi(Ea,Fa){Fa.Cqf&&(Array.enqueue(this.pUa,Fa.Cqf.CP),this.pUa.length>this.M2d&&(Array.dequeue(this.pUa),
this.UVg()))}UVg(){var Ea=this.pUa.length;let Fa=0;for(let vc=0;vc<Ea;vc++){const rd=Array.dequeue(this.pUa);Fa+=rd;Array.enqueue(this.pUa,rd)}Ea=Fa/Ea;Ea>this.jFc&&this.eb.raiseEvent("CPTTE",new da(this.jFc,Ea))}e3g(Ea,Fa){fa.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.g5g(Fa.hIj,Fa.actualValue))}lFg(Ea){this.eb.addHandler("CPTTE",Ea)}g5g(Ea,Fa){const vc={};vc.ThresholdValue=Ea;vc.ActualValue=Fa;return vc}}Object(b.a)(S,"CpuMeterMonitor",null,[606]);var ka=a(156);class V{constructor(){this.S=
this.T=this.M=this.C=0}}Object(b.a)(V,"ProfileInformation",null,[]);var wa=a(13),ma=a(44),ab=a(263);class ba{constructor(Ea=0,Fa=0){this.uIc=!1;this.MCa={};this.FSb=Ea;this.OSb=Fa;this.OQc=0;ma.a.addHandler(window.self,wa.a.QHg,()=>{this.uIc=!0});ma.a.addHandler(window.self,wa.a.RHg,()=>{this.uIc=!1})}Tne(Ea,Fa,vc){const rd=ba.generateKey(Fa,vc);rd in this.MCa?Fa=this.MCa[rd]:(Fa=new V,Fa.S=vc?1:0,this.MCa[rd]=Fa,this.OQc++);Fa.C++;Fa.M=Ea>Fa.M?Ea:Fa.M;Fa.T+=Ea}aM(Ea,Fa){this.Tne(Ea,Fa,!1);this.uIc&&
this.Tne(Ea,Fa,!0)}getData(){if(0<this.OSb&&this.OQc>this.OSb)return this.KKh();const Ea=0<this.FSb,Fa={},vc=this.MCa;for(let de in vc){var rd=de;const qe=vc[de];this.sTf(qe);Ea&&qe.T>=this.FSb&&(Fa[rd]=qe)}return Ea?H.a.kh(Fa)?null:Fa:this.MCa}KKh(){var Ea=0<this.FSb,Fa=[];const vc=this.MCa;for(let rd in vc){const de={key:rd,value:vc[rd]};let qe=de.value;(!Ea||qe.T>=this.FSb)&&Array.add(Fa,de)}if(Fa.length>this.OSb)Fa.sort((rd,de)=>de.value.T-rd.value.T),Fa=Fa.slice(0,this.OSb);else if(!Fa.length)return null;
Ea={};for(const rd of Fa)Fa=rd.value,this.sTf(Fa),Ea[rd.key]=Fa;return Ea}sTf(Ea){Ea.M=ab.a.p6(Ea.M,0);Ea.T=ab.a.p6(Ea.T,0)}reset(){this.MCa={};this.OQc=0}static generateKey(Ea,Fa){return Fa?Ea+" [it]":Ea}}Object(b.a)(ba,"FunctionCallAggregator",null,[604]);class Ca{}Ca.WMg="BatchedOperation";Ca.replication="Replication";Ca.xNj="25";Ca.rdj="9_"+Ca.WMg+"_"+Ca.replication;Object(b.a)(Ca,"CpuMeterConstants",null,[]);class Na{}Object(b.a)(Na,"CpuMeterFrame",null,[]);class za extends Sys.EventArgs{constructor(Ea){super();
this.Cqf=Ea}}Object(b.a)(za,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class la{}Object(b.a)(la,"MiniTaskItemInfo",null,[]);class aa{}Object(b.a)(aa,"TaskItemInfo",null,[]);var sa=a(547),ea=a(99);class Z{static h_h(){if(!Z.YOb&&(Z.YOb=new ea.a,k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.lo("AggregatorIdDisabledList"))){const Ea=k.AFrameworkApplication.fa.lw("AggregatorIdDisabledList");for(let Fa=0;Fa<Ea.length;Fa++)Z.YOb.ia(Ea[Fa],!0)}return Z.YOb}}Z.YOb=null;Object(b.a)(Z,"DisabledAggregatorListStore",
null,[]);var ua=a(266);class ya{constructor(Ea,Fa,vc,rd,de,qe=!0,bf=null){this.WW=this.jge=this.H8d=!1;this.ee=null;if(!Ea)throw ua.a.argument("taskManagerLazy");if(!de)throw ua.a.argument("dataAggregator");this.ywg=Ea;this.qMc=Fa;this._id=vc;this.d7d=6E4*rd;this.jQb=de;this.yde=qe;this.lkb=bf;Z.h_h().lb(this._id.toString())&&(this.WW=!0)}get taskManager(){return this.ee||(this.ee=this.ywg.value)}track(Ea,Fa=null){this.WW||(this.Nkh(),this.Ojj(),this.jQb.aM(Ea,Fa))}Ojj(){!this.H8d&&0<this.d7d&&(this.H8d=
!0,this.fVf())}fVf(){const Ea=new R.a(5,1,this.d7d,()=>{this.Rlj()},19,this._id.toString());this.taskManager.Hg(Ea)}Rlj(){!this.lkb||this.lkb.mvj()?this.mWf():this.yde&&this.jQb.reset();this.fVf()}mWf(){const Ea=this.jQb.getData();if(Ea){const Fa=parseInt(String(Ea.length));if(isNaN(Fa)||0<Fa)this.Ltc(Ea),this.yde&&this.jQb.reset()}}Ltc(Ea){d.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Ea})}Nkh(){this.jge||(this.qMc(()=>{this.mWf()}),this.jge=!0)}static CM(Ea,
Fa,vc,rd,de){return new ya(new sa.a(()=>k.AFrameworkApplication.Ji),k.AFrameworkApplication.ILb,Ea,Fa,vc,rd,de)}static I2a(Ea,Fa,vc){return ya.CM(Ea,Fa,vc,!0,null)}}Object(b.a)(ya,"Aggregator",null,[603]);class ha{constructor(Ea=null){this.Sm=null;this.reset();this.lkb=Ea}aM(Ea,Fa){if(!this.lkb||this.lkb.mvj())Fa in this.Sm||(this.Sm[Fa]=[]),this.Sm[Fa].push(Ea)}getData(){return H.a.count(this.Sm)?this.Sm:null}reset(){this.Sm={}}}Object(b.a)(ha,"NamedValuesAggregator",null,[604]);var Da=a(262);class nb{constructor(Ea,
Fa,vc,rd,de){this.kEa=0;this.aE=null;this.xUb=this.Ufe=0;this.iee=!1;this.OUa=0;this.hib=!1;this.aqa=null;this.MRb=0;this.fbe=new K.a;this.BVb=[];this.HL=Ea;this.lLc=Fa;this.kHc=vc;this.t$d=rd;k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.Aqd();this.yng=de;this.lHc=new ba(100);this.Jrg=ya.I2a(1,5,new ha)}wme(Ea){this.fbe.addHandler("OnCpuMeterFrameAvailable",Ea)}A$a(Ea,Fa,vc,rd=null){vc=rd?rd.priority:7;const de=this.HL();this.start(Fa,vc);
try{Ea()}finally{this.stop(Fa,rd),Ea=this.HL()-de,this.t$d.track(Ea,Fa)}}DV(Ea,Fa){const vc=this.HL();try{Ea()}finally{Ea=this.HL()-vc,this.kHc.aM(Ea,Fa),0<this.kEa&&this.lHc.aM(Ea,Fa),this.t$d.track(Ea,Fa)}}rAd(Ea){const Fa=new aa;Fa.TN=Ea.Dic;Fa.TP=Ea.priority;this.gKf(1,Fa)}V7a(Ea){this.MRb|=Ea}start(Ea,Fa){if(!this.kEa){this.lHc.reset();const vc=this.Qgf(Ea);vc&&this.pud(1);this.aE=new aa;this.aE.TN=Ea;this.aE.TP=Fa;this.aE.ST=(new Date).toISOString();this.aE.STS=ab.a.p6(this.HL(),2);vc?this.aE.UI=
1:this.Jii(Ea)?this.aE.UI=2:this.aE.UI=0}this.kEa++}pud(Ea){this.OUa|=Ea}HZc(Ea=!0,Fa=0){this.OUa=Ea?0:this.OUa&~Fa}stop(Ea,Fa=null){let vc;this.kEa--;0>=this.kEa&&this.aE&&(vc=this.HL()-this.aE.STS,this.xUb+=vc,this.lLc.aM(vc,Ea),this.Qgf(Ea)&&this.HZc(!1,1),this.aE.TRT=ab.a.p6(vc,2),Fa&&(this.aE.TQT=ab.a.p6(Fa.W1i,2),this.aE.TDT=ab.a.p6(Fa.gif,2)),this.yng&&(this.gKf(0,this.aE),this.Ydj()),this.kEa=0);0<=Ea.indexOf(Ca.xNj)&&this.V7a(2);0<=Ea.indexOf(Ca.rdj)&&this.V7a(4);1===(this.OUa&1)&&this.V7a(1);
2===(this.OUa&2)&&this.V7a(8)}Ydj(){var Ea=this.aE.TRT;if(750<Ea){let vc=this.lHc.getData();if(vc){const rd={};for(let de in vc){var Fa=vc[de];const qe=de;qe.startsWith("SiOp_")||qe.endsWith("[it]")||(rd[qe]=Math.round(100*Fa.T/Ea))}vc=rd}Ea=Object.assign(new la,{B:this.aE.STS,T:Ea,S:vc});this.Jrg.track(Ea,this.aE.TN)}}tCj(){var Ea=this.HL()-this.Ufe,Fa=ab.a.p6(this.xUb/Ea*100,2);Ea=new Na;Ea.CP=Fa;Ea.II=this.MRb;Fa=this.lLc.getData();H.a.count(Fa)&&(Ea.LRT=Fa);Fa=this.kHc.getData();H.a.count(Fa)&&
(Ea.FP=Fa);this.fbe.raiseEvent("OnCpuMeterFrameAvailable",new za(Ea));this.H4f()}H4f(){this.lLc.reset();this.kHc.reset();this.xUb=this.kEa=0;this.Ufe=this.HL();this.MRb=0;this.aE=null}run(){this.iee?this.tCj():(this.H4f(),this.iee=!0);this.aqa?this.aqa(Object(X.a)(this,this.run,"run"),1E3):window.setTimeout(Object(X.a)(this,this.run,"run"),1E3)}zSc(Ea,Fa,vc){const rd=Array(2);rd[0]=Fa;rd[1]=vc;this.BVb[Ea]||(this.BVb[Ea]=[]);this.BVb[Ea].push(rd)}gKf(Ea,Fa){Ea=this.BVb[Ea];if(!Da.a.kh(Ea))for(let rd=
0;rd<Ea.length;rd++){var vc=Ea[rd];const de=vc[0];vc=vc[1];de&&!de(Fa)||vc(Fa)}}Aqd(){if(!this.hib){const Ea=window.setTimeout;this.aqa=(Fa,vc)=>Ea(Fa,vc);this.hib=!0}}Qgf(Ea){return Ea.startsWith("key")||Ea.startsWith("input")}Jii(Ea){return Ea.startsWith("click")||Ea.startsWith("mouse")||Ea.startsWith("pointer")}}Object(b.a)(nb,"CpuMeter",null,[97]);class qa{constructor(Ea){this.vgb=null;this.fm=new ka.a;this.HL=Ea}initialize(Ea,Fa,vc,rd=!1){this.vgb||(this.vgb=new nb(this.HL,Ea,Fa,vc,rd),this.fm.setResult(this.vgb));
return this.vgb}}Object(b.a)(qa,"CpuMeterProvider",null,[605]);class pa{constructor(Ea=1){this.kx=[];this.rQb=[];this._count=Ea}Ezh(){let Ea=0;for(let Fa=0;Fa<this.kx.length;Fa++)this.kx[Fa]<this.kx[Ea]&&(Ea=Fa);return Ea}aM(Ea,Fa){Ea=ab.a.p6(Ea,2);if(this.kx.length<this._count)Array.add(this.kx,Ea),Array.add(this.rQb,Fa);else{var vc=this.Ezh();Ea>this.kx[vc]&&(this.kx[vc]=Ea,this.rQb[vc]=Fa)}}getData(){return this.kx.length?{["Vals"]:this.kx,["Desc"]:this.rQb}:null}reset(){this.kx=[];this.rQb=[]}}
Object(b.a)(pa,"MaxDataAggregator",null,[604]);var Ja=a(39),$a=a(82);class rb{get name(){return"Common.App.CpuMeter"}ai(Ea){Ea.register(qa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").uc().Gc(()=>new qa(Ja.a.Sd));Ea.register(S,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").uc().Gc(()=>new S)}init(){const Ea=k.AFrameworkApplication.fa;if(Ea.qa("CpuMeterIsEnabled")){const Fa=$a.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");y.a.instance.Qoe.continueWith(()=>
{rb.E9h(Ea,Fa)})}}dispose(){}static E9h(Ea,Fa){const vc=ya.I2a(10,5,new ba(Ea.nd("TaskManagerLoggingThreshold",0),Ea.nd("CpuMeterMaximumEntriesToLog",0)));Fa=Fa.initialize(new pa(5),new ba,vc,Ea.qa("CPUMeterExposeTaskDetailsIsEnabled"));Fa.run();Ea.qa("CpuMeterMonitorIsEnabled")&&$a.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Fa,Ea.vua("CpuMeterAverageCpuPercentThreshold",80),Ea.nd("CpuMeterRollingAverageFramesCount",15));fa.a(16827671,306,50,"Initializing CpuMeter")}static main(){v.a.instance.Ii(new rb)}}
Object(b.a)(rb,"CpuMeterPackage",null,[4,5]);var Pa=a(937);class eb{get name(){return"Common.App.EventsCachePackage"}ai(){}init(){Pa.a.instance.init()}dispose(){}static main(){v.a.instance.Ii(new eb)}}Object(b.a)(eb,"EventsCachePackage",null,[4,5]);var Ob=a(10),tb=a(220),cc=a(1230),Ib=a(163),Mb=a(370),Oa=a(203),Aa=a(147),Ba=a(59),ob=a(90),xb=a(1),Va=a(22),bb=a(158),ra=a(758);class Qa extends cc.a{constructor(Ea,Fa,vc){super(Fa,vc);this.Qa=new K.a;this.d6h=rd=>{if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const de=
rd.Values.m_Origin;k.AFrameworkApplication.wopiHostOriginFromPostMessage||(k.AFrameworkApplication.wopiHostOriginFromPostMessage=de)}switch(rd.MessageId){case Ib.a.gid:bb.a(this.$).p4e(rd);break;case Ib.a.dsd:Aa.a.ltas(null);break;case Ib.a.vcc:this.QLi();break;case Ib.a.kid:this.PLi(rd)}};this.$=Ea;vc!==ra.a.f9&&this.QEa(vc);this.S$h();this.c$h();Ea=this.d6h;this.Vl(Ib.a.gid,Ea);this.Vl(Ib.a.dsd,Ea);this.Vl(Ib.a.vcc,Ea);this.Vl(Ib.a.kid,Ea)}dispose(){this.$=null;super.dispose()}S$h(){this.fo(Ib.a.Jue);
this.fo(Ib.a.gid);this.fo(Ib.a.vcc);this.fo(Ib.a.kid);this.sSc(Ib.a.dsd);this.fo(Ib.a.jid)}c$h(){this.Wfa(Ib.a.nlb);this.Wfa(Ib.a.kta);this.Wfa("App_CloseTab");this.Wfa(Ib.a.tTa);this.Wfa(Ib.a.uTa);this.Wfa(Ib.a.s7e);this.Wfa(Ib.a.scc)}QLi(){const Ea={};Ea.hostMessageReceived=(new Date).getTime();d.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");k.AFrameworkApplication.apd=!0;Ea.appUnloadStart=(new Date).getTime();Ea.sendBeaconFlight=k.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");
Ea.sendBeaconSupported=Ba.a.ada();Ba.a.Zoe();Ea.appUnloadEnd=(new Date).getTime();Ea.appMessageSent=(new Date).getTime();this.Fj(Ib.a.eJg,Ea)}PLi(Ea){d.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Ea.Values&&Mb.a.jwd in Ea.Values&&Va.a.equals(Ea.Values[Mb.a.jwd],Oa.a.edit,!0)&&!this.$.isEditMode&&(d.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Ea.Values[Mb.a.jwd]}`),Ea=new ob.a(-8805455,0,1,0,null),this.$.Ka.Lb(Ea))}}Object(b.a)(Qa,"EwaHostMessenger",
cc.a,[594,391,3]);class qb extends tb.a{constructor(Ea){super();this.Ize=!1;this.$=Ea;this.Fb()}create(){const Ea=this.$.da,Fa=$a.a.instance;if(!this.Ize){this.Ize=!0;let vc;vc=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||ra.a.f9:k.AFrameworkApplication.FCd||ra.a.f9;Fa.register(Qa,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").uc().Gc(()=>new Qa(this.$,window.parent,
vc,k.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.qb(Ea.za(21)||Ea.Ga(21,Fa.resolve("Postmessage.IHostPostmessenger")))}}Object(b.a)(qb,"HostMessengerFactory",tb.a,[]);var Wa=a(124),ta=a(146),ib=a(680),Bb=a(548),Ub=a(78),Ta=a(131),mb=a(453),Qb=a(45),Lb=a(313),Jb=a(346),Ab=a(350),pb=a(486),va=a(5),db=a(51);class Ya{constructor(Ea,Fa,vc){this.correlations=this.properties=this.operation=null;this.operation=Ea;this.properties=Fa;this.correlations=vc}static Zwh(Ea,Fa,vc){const rd=
{},de=db.b();switch(Ea.command){case -1537138325:rd.Action=Fa.LabelText;break;case -1104934572:rd.PrevTab=de.mj(parseInt(Fa.OldContextCommand,10));rd.NextTab=de.mj(parseInt(Fa.NewContextCommand,10));break;case 802602464:rd.Origin=Fa[va.a.sU];break;case -1027730316:case -1059615499:rd.MenuType=Fa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Fa&&(rd.SqmControlId=Fa.SqmControlId)}rd.InputMethod=Jb.a[Ea.method];rd.Location=
Ab.a[Ea.Re];rd.Mode=pb.a[Ea.mode];rd.ParentName=Ea.tabName;rd.IsSystemInitiated="IsSystemInitiated"in Fa?Fa.IsSystemInitiated:!1;rd.NoReporting="NoReporting"in Fa?Fa.NoReporting:!1;"ControlIdToLog"in Fa&&(rd.ControlId=Fa.ControlIdToLog);"TerminalParentControlIdToLog"in Fa&&(rd.TerminalParentControlId=Fa.TerminalParentControlIdToLog);for(const qe of Object.keys(vc))rd[qe]=vc[qe];return rd}}Object(b.a)(Ya,"InteractivityRecord",null,[]);class gb extends Ya{constructor(Ea,Fa,vc){super(Ea.operation,Ea.properties,
Ea.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Fa;this.timeFromNavigationStart=vc}}Object(b.a)(gb,"FirstUserInteractivityRecord",Ya,[]);var Ka=a(636);class ub{constructor(){this.commandSurface=this.triggerMethod=Wa.a.keb}static T9h(){ub.Z1a||(ub.Z1a=new Ka.a(Bb.a.Rk()),ub.Z1a.add("InputMethod"),ub.Z1a.add("Location"),ub.Z1a.add("Mode"))}}ub.Z1a=null;Object(b.a)(ub,"ExcelUserAction",null,[]);var ac=a(201),Ra=a(46),na=a(424),lb=a(238);class jb extends Ub.a{constructor(Ea){super();
this.j$e=0;this.nSe=!1;this.Rqd=Array(jb.Y7a);this.D3b=0;this.$=Ea;this.vyb=xb.EwaSettings.ma(78);this.qgf=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");this.nji=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");Wa.a.sSh();this.Daa={};jb.yWb||(jb.yWb=new ib.a(Bb.a.Rk()),jb.b9h(jb.yWb));ub.T9h();if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ea=0;Ea<jb.Y7a;Ea++)this.Rqd[Ea]="NA"}dispose(){this.$=
this.Daa=null;super.dispose()}JQf(Ea,Fa,vc){if(this.vyb){var rd=db.b().mj(Ea.command);rd||d.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${rd}, command: ${Ea.command}, commandInfo: ${Ea}`);Fa=Ya.Zwh(Ea,Fa,vc);vc=!!Fa&&(!("IsSystemInitiated"in Fa)||!Fa.IsSystemInitiated);this.$&&this.$.ea.Eg&&vc&&Pa.a.instance.LLf("OtelUserAction",new na.a(rd,Ea.tabName,Date.now()));this.YQf(rd,Fa,null,!0,!0)}}Cd(Ea,Fa,vc=null,rd=!1){this.vyb&&this.YQf(Ea,
Fa,vc,!1,rd)}sSd(Ea){if(this.vyb)if(this.Daa){++this.j$e;this.Daa[Ea]||(this.Daa[Ea]=[]);var Fa=this.j$e.toString();this.Daa[Ea].push(Fa);d.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Ea}', correlation=${Fa}`)}else d.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ea}] == null`)}JSd(Ea){if(this.vyb)if(this.Daa&&this.Daa[Ea]){var Fa=this.Daa[Ea],vc=Fa.pop().toString();Fa.length||delete this.Daa[Ea];
d.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Ea}', correlation=${vc}`)}else d.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ea}] == null`)}EP(Ea,Fa,vc=!1){return this.vyb?Lb.a(rd=>{this.Cd(Ea,rd(),void 0,vc)},jb.jIj,this.la,Qb.a.Sbi,!1,!Fa):null}ZId(){let Ea="";for(let Fa=0;Fa<jb.Y7a;Fa++)Ea+=this.Rqd[(this.D3b+jb.Y7a-Fa-1)%jb.Y7a]+",";d.ULS.sendTraceTag(557188890,0,15,`Last operations ${Ea}`)}xRj(Ea){Ea&&
(this.Rqd[this.D3b]=Ea,this.D3b=(this.D3b+1)%jb.Y7a)}eui(Ea,Fa,vc){k.AFrameworkApplication.i6b();const rd=Ea.operation,de=Ea.properties;void 0!==vc?mb.a(this.$,432,433,0,qe=>{qe.T5i(rd,de,vc)}):this.ENj(Ea);this.FNj(Ea);this.uUi(Fa,de,rd)}ENj(Ea){this.xBj(Ea)||(this.nSe=!0,Ea=new gb(Ea,Ra.PageLoadTrackingInfo.instance.HJa(new Date),Ra.PageLoadTrackingInfo.lz()),Ea=Sys.Serialization.JavaScriptSerializer.serialize(Ea),d.ULS.sendTraceTag(458261331,0,50,`${Ea}`))}xBj(Ea){const Fa=Ea.properties;Ea=Ea.operation;
return this.nSe||void 0===Ea||null===Ea||Ea===Ta.a.YRc||Ea===Ta.a.$Ld||Ea===Ta.a.dDd||Ba.a.god(Ea)||!!Fa&&"IsSystemInitiated"in Fa&&Fa.IsSystemInitiated}FNj(Ea){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.xRj(Ea.operation);Ea=Sys.Serialization.JavaScriptSerializer.serialize(Ea);d.ULS.sendTraceTag(21542793,0,50,`${Ea}`)}uUi(Ea,Fa,vc){Wa.a.dka()&&(Fa?"NoReporting"in Fa&&Fa.NoReporting||"IsSystemInitiated"in Fa&&Fa.IsSystemInitiated||!Ea&&!this.qgf||((Ea=
Wa.a.Tj(Fa,jb.yWb,ub.Z1a))?(Fa=jb.gxh(Fa))?ta.a.sendUserActionEvent(Wa.a.g3b(vc,null,Fa.triggerMethod,Fa.commandSurface,Ea)):d.ULS.sendTraceTag(537155550,0,50,"user action was null"):d.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):d.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${vc}`))}YQf(Ea,Fa,vc,rd,de){const qe=ac.a(this.$);if(this.qgf){let of=null;Va.a.equals(Ea,Ta.a.xtc,!0)&&Fa&&"InputMethod"in Fa&&
(of=Ta.a.jTe(Ea,Fa.InputMethod));qe.UHb(of||Ea,vc)}else Va.a.equals(Ea,Ta.a.xtc,!0)&&Fa&&"InputMethod"in Fa&&(Ea=Ta.a.jTe(Ea,Fa.InputMethod)),qe.UHb(Ea,vc);Fa&&(Fa.IsCommand=rd);let bf=void 0;this.nji&&(bf="ActionRelativeTime"in Fa?Fa.ActionRelativeTime:Ra.PageLoadTrackingInfo.lz());Object(lb.b)(()=>{const of=new Ya(Ea,Fa,this.Daa);this.eui(of,de,bf)},this.$.la,50)}static gxh(Ea){if(!Ea)return null;const Fa=new ub;"InputMethod"in Ea&&(Fa.triggerMethod=Ea.InputMethod);"Location"in Ea&&(Fa.commandSurface=
Ea.Location);return Fa}static b9h(Ea){Ea?(Ea.add("Origin",2),Ea.add("InputMethod",2),Ea.add("ButtonType",2),Ea.add("selectedRange",2),Ea.add("SelectedRanges",2),Ea.add("editRange",2),Ea.add("Location",2),Ea.add("Mode",2),Ea.add("CurrentSelectionMode",2),Ea.add("Action",2),Ea.add("type",2),Ea.add("floatingObjectType",2),Ea.add("PrevTab",2),Ea.add("NextTab",2),Ea.add("DialogName",2),Ea.add("dx",3),Ea.add("dy",3),Ea.add("NumberOfSelectedRanges",3),Ea.add("IsCommand",1),Ea.add("IsInFormulaBarEdit",1),
Ea.add("isLink",1),Ea.add("isSheetRef",1),Ea.add("isEmptyText",1),Ea.add("isFormula",1),Ea.add("IsResizingHiddenHeader",1)):d.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}jb.jIj=1E3;jb.Y7a=40;jb.yWb=null;Object(b.a)(jb,"InteractivityLogger",Ub.a,[15]);var Yb=a(50),Gb=a(37),wb=a(7);class dc{constructor(){this.appInfoProperties=this.appState=null}}Object(b.a)(dc,"CurrentAppInfo",null,[]);const Jc=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6476239_OfficeOnlineUxInteractivityBucket"),
Qc=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(Ea=>{Ea.actions.forEach(Fa=>{Qc.set(Fa,Ea.name)})});class fd{constructor(){this.value=this.key=null}}Object(b.a)(fd,"AppInfoProperty",null,[]);class Wc{constructor(Ea){this.$=Ea}getAppState(){const Ea=Ra.PageLoadTrackingInfo.instance.HJa(new Date);
return-1===Ea?"boot":3E4>Ea?"postboot":"steady"}isChangeGateEnabled(Ea){return xb.EwaSettings.isChangeGateEnabled(Ea)}getBooleanFeatureGate(Ea,Fa){return xb.EwaSettings.getBooleanFeatureGate(Ea,Fa)}getCurrentAppInfo(){return Object(wb.a)(new dc,{appState:this.getAppState(),appInfoProperties:[Object(wb.a)(new fd,{key:"coauthCount",value:this.$.ea.Jm.length.toString()})]})}sendBeaconTraceTag(Ea,Fa,vc,rd){this.$.sendBeaconTraceTag(Ea,Fa,vc,rd)}getActionBucket(Ea){return c(Ea)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.Pyi}`}}
Object(b.a)(Wc,"InteractivityTrackerCallbacks",null,[631]);class Rb{constructor(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}}Object(b.a)(Rb,"InteractivityTrackerOptions",null,[]);var Sb=a(195);class mc{constructor(Ea){this.Eaa=null;if(mc.edf)d.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");else{if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(Ea);
else{const Fa=Yb.GetServiceTaskFactory.Ta(Ea.da,283,284,1);Gb.TaskExtensions.Aa(Fa,()=>{Gb.TaskExtensions.Aa(Sb.c(Fa.result.$n.loadScript(va.a.i$e)),()=>{d.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");this.initialize(Ea)},Ea.la,3)},Ea.la,3)}mc.edf=!0}}initialize(Ea){d.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.Eaa=interactivity.InteractivityTrackerFactoryGlobal.create()){const Fa=new Rb;xb.EwaSettings.Ipd()&&mc.A6f.push(wa.a.v9);
Fa.events=mc.A6f;Fa.durationThresholdInMs=mc.durationThresholdInMs;Fa.callbacks=new Wc(Ea);Fa.patchTaskScheduling=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);Ea=this.Eaa.start(Fa);Ea.started?d.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):d.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Ea.failureReason)}else d.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}IAa(Ea,
Fa,vc){this.Eaa?this.Eaa.track(Ea,Fa,vc):d.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Fa}`)}ADe(){return this.Eaa?this.Eaa.createActionsRetriever():(d.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.Eaa&&(this.Eaa.stop(),this.Eaa=null)}}mc.durationThresholdInMs=100;mc.A6f="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");
mc.edf=!1;Object(b.a)(mc,"InteractivityTrackerService",null,[376]);var ec=a(695);class Rc extends tb.a{constructor(Ea){super();this.$=Ea;this.Fb()}create(){if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){const Ea=Yb.GetServiceTaskFactory.Ta(this.$.da,283,284,this.ib);Gb.TaskExtensions.Aa(Ea,()=>{Gb.TaskExtensions.Aa(Sb.c(Ea.result.$n.loadScript("interactivity")),()=>{this.qb(Object(ec.a)(this.$.da,443,()=>new mc(this.$)))},this.$.la,3)},this.$.la,
3)}else this.qb(Object(ec.c)(this.$.da,443,()=>new mc(this.$)))}static ka(Ea){Ea.da.Ga(444,new Rc(Ea))}}Object(b.a)(Rc,"InteractivityTrackerServiceFactory",tb.a,[]);var Mc=a(86),bc=a(382),ic=a(8),Yc=a(47),md=a(188),id=a(58);class xd{constructor(Ea){this.eCj=Ea}getCustomProperties(Ea){const Fa=new Map;if(Ea.hasOwnProperty("startTimeInMs")&&Ea.hasOwnProperty("totalExecutionTimeInMs")){const vc=Ea.startTimeInMs;Ea=this.eCj.retrieveSlowActionsBetweenTimeRange(vc,vc+Ea.totalExecutionTimeInMs);Fa.set("actions",
id.a.Ac(Ea))}return Fa}}Object(b.a)(xd,"CallTreeCustomPropertiesRetriever",null,[650]);class Lc{constructor(){this.customProperties=new Map}addCustomProperty(Ea,Fa){this.customProperties.set(Ea,Fa)}getCustomProperties(){return this.customProperties}}Object(b.a)(Lc,"CustomPropertiesRetriever",null,[649]);class Pb{isFeatureEnabled(Ea,Fa){return xb.EwaSettings.getBooleanFeatureGate(Ea,Fa)}}Object(b.a)(Pb,"ExcelFeatureChecker",null,[648]);class Gc{isProfilingEnabled(){return!0}}Object(b.a)(Gc,"ExcelProfilingFeatureChecker",
null,[647]);class Nb{constructor(Ea,Fa){this.xRi=Ea;this.zRi=Fa}onProfilerEvent(Ea){switch(Ea.eventId){case 1:this.xRi(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.zRi();break;default:d.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${Ea.eventId}`)}}}Object(b.a)(Nb,"JSCPUProfilerObserver",null,[646]);class yc{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=
this.maximumNumberOfSamplesToTake=null}}Object(b.a)(yc,"JSCPUProfilerInitOptions",null,[]);class Tc{constructor(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=
this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=
this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(b.a)(Tc,"JSCPUProfilingPackageInitOptions",null,[]);class gd{constructor(Ea,Fa){this.interactivityTrackerService=this.O4f=this.iEd=this.B$a=this.jEd=this.DIf=this.EIf=null;this.J0i=new Set([1,0]);d.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=Ea;this.interactivityTrackerService=Fa;this.P$h();this.O$h();this.Ioi=this.$.ya.JsProfilingSampleIntervalInMs;
this.profilingIntervalInMs=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.yAe=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.hEj()}dispose(){d.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");Mc.a.Ia(this.O4f);this.iEd=this.$=null;this.jEd.clear();this.B$a.clear()}ADj(){const Ea=Math.random()*this.yAe;d.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${Ea}`);
this.O4f=Yc.a.instance.create(()=>{this.Wdd("ExcelOnlineContinuousSessionProfiler",2).start()},Ea,Qb.a.Cuj,!0)}MDj(){d.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Wdd("ExcelOnlineFullSessionProfiler",3).start()}TDj(Ea){d.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Hef(Ea)?this.Wdd(Ea,0,1E4).start():d.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")}REj(Ea){this.Hef(Ea)?
(Ea=this.P_e(Ea))&&Ea.stop():d.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")}hEd(Ea){return this.B$a.has(Ea)}hEj(){xb.EwaSettings.s0e()||(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.MDj():this.ADj())}createProfiler(Ea,Fa,vc,rd,de,qe){d.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const bf=new yc;bf.samplingIntervalInMs=Fa;bf.maximumNumberOfSamplesToTake=
vc;bf.idleIntervalInMs=rd;bf.profilingIntervalInMs=de;return this.h8g(Ea,qe,bf)}O$h(){const Ea=new Gc,Fa=new Tc;Fa.ulsInstance=new bc.a;Fa.deObfuscationEndpoint="ProfilerReporting.ashx";Fa.shouldCompressSerializedCallTrees=!1;Fa.shouldKeepSamplesOutsideOfProfilingInterval=!1;Fa.shouldSendAllCallTreesFromProfileInASingleRequest=!xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);Fa.shouldUseSendBeaconForSendingCallTrees=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",
!1);Fa.callTreeFilteringThresholdInMs=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);Fa.deObfuscationRequestQueryParamsRetriever=this.V4g();Fa.deObfuscationRequestBodyPropertiesRetriever=this.U4g();Fa.featureEnabledChecker=new Pb;Fa.useMainEventLoopForProfilerTraceProcessing=!1;Fa.profilerTraceProcessingWebWorkerSourceURL=this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;Fa.shouldProcessProfileCapturedWhileUserIsIdle=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
this.iEd=this.EIf.retrievePackage(Ea,Fa).retrieveProfilerFactory()}V4g(){const Ea=new Lc;Ea.addCustomProperty(ic.a.nJf,k.AFrameworkApplication.userType);Ea.addCustomProperty(k.AFrameworkApplication.Neb,k.AFrameworkApplication.userSessionId);Ea.addCustomProperty(ic.a.twd,this.$.ya.SkipAuthentication?ic.a.Sqf:null);Ea.addCustomProperty(ic.a.DEd,this.$.ya.MachineCluster);return Ea}U4g(){const Ea=new Lc;Ea.addCustomProperty("appName","Excel");Ea.addCustomProperty("buildVersion",k.AFrameworkApplication.buildVersion);
Ea.addCustomProperty("shouldUseSourceMaps","true");Ea.addCustomProperty("shouldFilterSensitiveResources","true");Ea.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.Yxj().toString());return Ea}h8g(Ea,Fa,vc){const rd=new Lc;rd.addCustomProperty("ProfilerName",Ea);this.DIf.set(Ea,rd);Fa=this.iEd.createProfiler(Fa,vc,rd);this.B$a.set(Ea,Fa);Ea=this.w6g(Ea);Fa.subscribeProfilerObserver(Ea,this.J0i);return Fa}P_e(Ea){return this.hEd(Ea)?this.B$a.get(Ea):(d.ULS.shipAssertTag(537155520,
0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${Ea}) does not exist`),null)}Wdd(Ea,Fa,vc=null){if(this.hEd(Ea))return this.P_e(Ea);const rd=this.Ioi;return this.createProfiler(Ea,rd,null!=vc&&0<rd?vc/rd:2E6,2===Fa?this.yAe:null,0===Fa?null:this.profilingIntervalInMs,Fa)}w6g(Ea){var Fa=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:md.b(this.$);if(Fa){const vc=Fa.ADe();if(vc){Fa=this.B$a.get(Ea);
const rd=new xd(vc);Fa.subscribeCallTreeCustomPropertiesRetriever(rd);Fa=new Nb(de=>{vc.startCollectingSlowActions(de)},Object(X.a)(vc,vc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.jEd.set(Ea,Fa);return Fa}d.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}d.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null}P$h(){this.EIf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.DIf=new Map;this.jEd=new Map;this.B$a=new Map}Hef(Ea){return!!Ea}Yxj(){return!xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6967854_ESNextEnabled")}}Object(b.a)(gd,"JsSelfProfilerManager",null,[596,3]);class Ad extends tb.a{constructor(Ea){super();this.$=Ea;this.Fb()}create(){d.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");const Ea=Yb.GetServiceTaskFactory.Ta(this.$.da,
283,284,this.ib);Gb.TaskExtensions.Aa(Ea,()=>{xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.$.da.Za(443,Fa=>{this.BCe(Ea.result,Fa)}):this.BCe(Ea.result)},this.$.la,3)}BCe(Ea,Fa){Gb.TaskExtensions.Aa(Sb.c(Ea.$n.loadScript("officeOnlineCpuProfiling")),()=>{const vc=Object(ec.a)(this.$.da,437,()=>new gd(this.$,Fa));this.qb(vc)},this.$.la,3)}static ka(Ea){Ea.da.Ga(438,new Ad(Ea))}}Object(b.a)(Ad,"JsSelfProfilerManagerFactory",tb.a,[]);class Od{constructor(){this.order=
0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(b.a)(Od,"ActionData",null,[]);class Pd{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(b.a)(Pd,"BlockedEngagementInfo",null,[]);class Md extends Od{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(b.a)(Md,"SuccessfulActionData",Od,[]);class ge{constructor(){this.successfulActions=[]}}Object(b.a)(ge,"SuccessfulEngagementInfo",null,[]);var pe=a(43);class Qd{constructor(Ea){this.FIa=
new Set;this.KLb=null;this.mSe=this.s6f=!1;this.yg=()=>{this.Xsi();this.KLb=Yc.a.instance.create(()=>{this.fBb()},Qd.NFj,Qb.a.fBb)};this.Dc=()=>{this.fBb()};this.EEb=(Fa,vc)=>{Fa=this.Vnb.blockedActions.length;const rd=vc.details?vc.actionName+"_"+vc.details:vc.actionName;vc=Object(wb.a)(new Od,{order:Fa+1,name:rd,componentName:vc.componentName,timeFromNavigationStart:vc.timeFromNavigationStart});this.Vnb.blockedActions.push(vc)};this.Vnb=new Pd;this.Vnb.hasBlockedActions=!1;this.ldb=new ge;this.Dyh();
this.$=Ea;this.$.ea.ql(this.yg);this.$.ik(this.Dc);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.VAe=new Promise(Fa=>{this.D2g=Fa}))}dispose(){this.$.ea&&this.$.ea.xn(this.yg);this.$.Bl(this.Dc);Mc.a.Ia(this.KLb);this.$=this.KLb=null}T5i(Ea,Fa,vc){if(void 0!==Ea&&null!==Ea&&Fa){var rd=this.ldb.successfulActions.length+1,de="InputMethod"in Fa?Fa.InputMethod:"",qe="IsCommand"in Fa&&Fa.IsCommand;if(this.gni(Ea,Fa,de,qe)){if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const bf=
!qe&&Ea;this.mSe||bf===Ta.a.cfg||bf===Ta.a.dfg||bf===Ta.a.$eg||bf===Ta.a.afg||(this.mSe=!0,this.D2g(void 0))}rd>Qd.fof||(Ea=Object(wb.a)(new Md,{order:rd,name:Ea,componentName:"Location"in Fa?Fa.Location:"",timeFromNavigationStart:vc,inputMethod:de,isCommand:qe}),this.ldb.successfulActions.push(Ea),1===rd?this.Mti():rd===Qd.fof&&this.fBb())}}}C5i(Ea){pe.a(this.$).YXb(this.EEb);this.Vnb.hasBlockedActions=!0;this.EEb(null,Ea)}Xsi(){d.ULS.sendTraceTag(254546634,0,50,`${E.c(this.Vnb)}`)}Mti(){Ra.PageLoadTrackingInfo.instance.HJa(new Date)>
Qd.Qyh?d.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${E.c(this.ldb.successfulActions[0])}`):d.ULS.sendTraceTag(254563592,0,50,`${E.c(this.ldb.successfulActions[0])}`)}fBb(){!this.s6f&&this.ldb.successfulActions.length&&(this.s6f=!0,Mc.a.Ia(this.KLb),this.KLb=null,this.$.sendBeaconTraceTag(254559496,50,!1,E.c(this.ldb)))}Dyh(){this.FIa.add(Ta.a.YRc);this.FIa.add(Ta.a.$Ld);this.FIa.add(Ta.a.dDd);this.FIa.add(Ta.a.eHf);this.FIa.add(Ta.a.gHf);this.FIa.add(Ta.a.iHf)}gni(Ea,Fa,
vc,rd){vc=!vc||"unknown"===vc;const de="IsSystemInitiated"in Fa&&Fa.IsSystemInitiated;Fa="NoReporting"in Fa&&Fa.NoReporting;const qe=this.FIa.has(Ea);Ea=Va.a.equals(Ea,Ta.a.xtc,!0)&&vc;return!de&&!Fa&&!qe&&!Ea&&!(rd&&vc)}}Qd.fof=10;Qd.Qyh=6E4;Qd.NFj=12E4;Object(b.a)(Qd,"PageLoadEngagementInfo",null,[595]);class he extends tb.a{constructor(Ea){super();this.$=Ea;this.Fb()}create(){this.qb(this.$.da.za(432)||this.$.da.Ga(432,new Qd(this.$)))}static ka(Ea){Ea.da.Ga(433,new he(Ea))}}Object(b.a)(he,"PageLoadEngagementInfoFactory",
tb.a,[]);var ue=a(53),je=a(136),Ge=a(509),Ce=a(38),pc=a(75),Uc=a(373),hd=a(34),yd=a(230);class wd extends Sys.EventArgs{constructor(Ea){super();this.lU=Ea}}Object(b.a)(wd,"ErrorDataArgs",Sys.EventArgs,[]);var I=a(641),xa=a(110),Ua=a(28);class vb{constructor(Ea,Fa){this.IPb=null;this.b4b=this.bid=!1;this.uee=this.vee=null;this.x4a=this.w4a=0;this.mVf=Ea;this.Jbe=Fa}get rEf(){return this.Jbe}get UIb(){return this.vee}get lVf(){return this.uee}get Goi(){return this.yue(this.mVf.getTime())}get fVi(){return this.yue(this.lVf.getTime())}get S0f(){return!(this.b4b||
void 0===window.bsqmXLSPageLoadStartTime)}get e_c(){try{return this.IPb||(this.IPb=xa.toUtc(window.bsqmXLSPageLoadStartTime)),this.IPb}catch(Ea){return null}}set e_c(Ea){this.IPb=Ea}$rj(Ea){this.b4b||(this.vee=Ea,this.uee=xa.toUtc(this.UIb))}j6h(Ea){if(Ea.Values&&(!this.w4a||!this.x4a))try{Mb.a.x7e in Ea.Values&&(this.w4a=parseInt(Ea.Values[Mb.a.x7e].toString(),10));Mb.a.y7e in Ea.Values&&(this.x4a=parseInt(Ea.Values[Mb.a.y7e].toString(),10));const Fa=y.a.instance;0<this.w4a&&(this.Tkf(this.w4a,"PageLoadFromHostClick"),
Fa.X5i(this.w4a));0<this.x4a&&(this.Tkf(this.x4a,"PageLoadFromHostFrameCreation"),Fa.Y5i(this.x4a));const vc=Ea.Values[Mb.a.m6h]||0,rd=Ea.Values[Mb.a.k6h]||Ea.Values[Mb.a.l6h]||0;0<rd&&Fa.E5i(rd);Fa.F5i(vc)}catch(Fa){}}Afj(){this.mVf=this.e_c=Ua.a.Wa.Nb;this.Jbe=0;this.bid=this.b4b=!1}yue(Ea){const Fa=this.e_c.getTime();return Fa>=Ea?0:Ea-Fa+this.rEf}Tkf(Ea,Fa){if(Ea){const vc=db.b();vc.ALb("UserAction",Fa,Fa,Ua.a.FBb(Ea),I.EcmaDateClock.instance.appStart);vc.Yrb(Fa,xa.toTimestamp(this.UIb))}}}Object(b.a)(vb,
"PageLoadPerfInfo",null,[]);var cb=a(70);class Xb{constructor(Ea,Fa,vc){this.IPc=Ea.keyCode;this.DJb(Ea.ctrlKey,1);this.DJb(Ea.shiftKey,2);this.DJb(Ea.altKey,4);this.DJb(cb.b(Ea),8);this.DJb(vc,16);this.IPc=this.$cb|Fa<<24}get $cb(){return this.IPc}get keyCode(){return this.$cb&65535}DJb(Ea,Fa){Ea&&(this.IPc=this.$cb|Fa<<16)}}Object(b.a)(Xb,"ShortcutSqmData",null,[]);class rc{constructor(){this.gtd=null;this.sZg={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.cSf()}pUg(Ea,Fa,vc){0===
vc&&(vc=this.sZg[Fa.toString()]);return rc.R0f(Ea,vc)&&(Ea=new Xb(Ea,vc,l.a.isMac),!hd.a.og(this.gtd,Ea.$cb.toString()))?(this.gtd[Ea.$cb.toString()]=!0,Ea):null}cSf(){this.gtd={}}static hhi(Ea){return 112<=Ea&&123>=Ea||61440<=Ea&&61451>=Ea}static sii(Ea){return 17!==Ea&&18!==Ea&&16!==Ea&&91!==Ea&&93!==Ea}static R0f(Ea,Fa){let vc=Ea.ctrlKey||Ea.altKey||cb.b(Ea);Ea=Ea.keyCode;vc=rc.hhi(Ea)||vc;vc=rc.sii(Ea)&&vc;return 0!==Fa&&vc}}Object(b.a)(rc,"UnhandledShortcutLogger",null,[]);class Ec{constructor(Ea){this.u1b=
[];this.dJg=null;this.sqmManager=Ea}gXb(Ea){this.u1b.push(Ea)}R4(Ea,Fa,vc){try{if(Fa)Fa.endTime=vc,this.sqmManager.Mje(Fa);else for(let rd=0,de=this.u1b.length;rd<de;rd++){const qe=this.u1b[rd];Ea?(qe.endTime=qe.startTime,qe.Yye=0):qe.endTime=vc;this.sqmManager.Mje(qe)}}catch(rd){}finally{this.u1b.length=0}}}Object(b.a)(Ec,"UserInteractionPerfInfo",null,[]);var ed=a(35),ud=a(68),Kd=a(229);class Zd extends Ub.a{constructor(Ea,Fa){super();this.Ugd=this.WHb=!1;this.U0f=!0;this.Qa=new Ce.a;this.mFc=!1;
this.Dc=()=>{const vc=ud.a(this.$).fd.activityState,rd=hd.a.og(vc,ed.a.sje);hd.a.og(vc,ed.a.Ilb)||rd||this.upload()};this.$=Ea;this.mub=Fa;this.ea=Ea.ea;this.$.ik(this.Dc);this.lag=new rc;this.rOa=new vb(Ba.a.rLd,Ea.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);this.RAc=new Ec(this)}qTc(Ea){this.Qa.addHandler("EREK",Ea)}QHd(Ea){this.Qa.removeHandler("EREK",Ea)}get Y$g(){return this.mFc}get ybi(){return this.$.frame.DQ?ic.a.Abi:ic.a.zbi}get workbookContext(){return this.$.workbookContext}get nT(){Zd.Jfb||
(Zd.Jfb=this.ZJe());Zd.XWc||(Zd.XWc=!0,this.l9e());return Zd.Jfb}set nT(Ea){Zd.Jfb=Ea;Zd.Jfb||(Zd.XWc=!1)}get b2(){return pc.a(this.$.ya,3)}dispose(){this.Y$g&&k.AFrameworkApplication.Dn&&k.AFrameworkApplication.Dn.disable();this.$&&this.$.Bl(this.Dc);this.$=this.RAc=this.rOa=this.nT=null;super.dispose()}p4e(Ea){this.rOa.j6h(Ea);this.Uti()}KMd(Ea){this.setDw(9415,Ea)}gXb(Ea){this.RAc.gXb(Ea)}R4(Ea,Fa,vc){this.RAc.R4(Ea,Fa,vc)}Gsd(Ea){if(this.b2){const Fa=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;
Ea=this.$.isEditMode||Ea&&this.ea.workbookContext.Options&512?2:Fa?9:this.ea.jc.inEmbedView?14:1;this.setDw(8721,Ea);this.EAh(Ea);this.mFc=!1}}glf(){const Ea=this.rOa;this.b2&&Ea.S0f&&(this.setDw(9450,Ea.rEf),this.setDw(9085,Ea.Goi))}hlf(Ea){if(!this.WHb){this.WHb=!0;const Fa=this.rOa;let vc=0;this.b2&&Fa.S0f?(Fa.$rj(Ea),this.RAc.dJg=Fa.lVf,this.setDw(9086,Fa.fVi),Fa.b4b=!0,vc=this.rOa.UIb.getTime()):vc=Ea.getTime();Gb.TaskExtensions.Aa(this.mub.value,rd=>{rd.result.Fj(Ib.a.XIg,{[Mb.a.YIg]:vc})},
this.la,3)}}Mje(Ea){this.b2&&Ea&&1!==Ea.rda&&this.$fa(8327,yd.b(Ea),yd.n(Ea),yd.a(Ea),2,Ea.Yye,yd.o(Ea),yd.d(Ea),yd.e(Ea))}WId(Ea,Fa){Ea&&Ea.MessageIdHash&&this.VId(Ea.MessageIdHash,Ea.MessageIdName,Ea.MessageId,Ea.ErrorCause?Ea.ErrorCause:ue.a.ozc,!1,Fa,Ea,null)}VId(Ea,Fa,vc,rd,de,qe,bf,of){Zd.appEncounteredFirstError||(Zd.appEncounteredFirstError=!0,je.a.get_instance().isCompleted(13)||(je.a.get_instance().ut(13),d.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));
Ea=this.gsb(Ea);const Mf=!!bf,Ff={};Ff.ErrorName=Fa;Ff.ErrorHashCode=Ea.toString();Ff.ErrorId=vc.toString();Ff.ErrorCause=rd.toString();Ff.ErrorType=0===qe?"ErrorDialog":"BusinessBar";Ff.BusinessBarEntryName=of||"null";Ff.ServerCorrelationId=Mf?bf.CorrelationId:"null";Ff.WebMethodName=Mf?bf.WebMethodName:"null";Ff.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Ff.WfeServerId=Mf?bf.WfeServerId:"null";Fa=id.a.Ac(Ff);this.Qa.raiseEvent("EREK",new wd(Ff));d.ULS.sendTraceTag(1881314,
0,15,Fa);this.b2&&(P.a.OLf(Ea.toString()),this.$fa(9134,Ea,rd,ue.a.wWd),this.ea.kv||de||(this.setDw(10459,Ea),this.Gsd(!0),this.Ugd=!0,this.upload(),this.l9e()))}gsb(Ea){return 5439488|(Ea>>>16^Ea&65535)&65535}$sd(Ea,Fa,vc){Ea=this.lag.pUg(Ea,Fa,vc);this.b2&&Ea&&this.$fa(11007,Ea.$cb)}upload(){!this.b2||!this.WHb&&!this.Ugd||l.a.Tf&&k.AFrameworkApplication.Mg?l.a.Tf&&k.AFrameworkApplication.Mg&&d.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.nT.INb(),this.mFc=!0);
k.AFrameworkApplication.Dn=this.nT=null;this.rOa.Afj();this.WHb=!1;k.AFrameworkApplication.Dn=this.nT=this.ZJe();this.lag.cSf()}Uti(){const Ea=this.rOa;if(this.b2&&!Ea.bid){var Fa=Ea.w4a,vc=Ea.x4a,rd=Ea.UIb.getTime();k.AFrameworkApplication.rM=Ea.UIb;Fa&&this.setDw(10324,Fa>rd?0:rd-Fa);vc&&this.setDw(10325,vc>rd?0:rd-vc);Ea.bid=!0}}$fa(Ea,...Fa){this.b2&&this.nT.$fa(Ea,...Fa)}setDw(Ea,Fa){this.b2&&this.nT.setDw(Ea,Fa)}ZJe(){Uc.a.uKe(this.$.ya);return k.AFrameworkApplication.Dn}EAh(Ea){let Fa;try{Fa=
Object(G.a)(Object,id.a.Uh(k.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(vc){d.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${vc.message}`);return}if(Fa){let vc=Object(G.a)(String,Fa.ApplicationModeExtended),rd=Object(G.a)(String,Fa.ApplicationMode);vc&&rd&&(vc=vc.toUpperCase(),2!==Ea&&16!==Ea||"VIEW"!==vc&&"UNIFIED"!==vc?1!==Ea||"EDIT"!==vc&&"UNIFIED"!==vc||(vc="VIEW",rd="View"):(vc="EDIT",rd="Edit"),Fa.ApplicationModeExtended=vc,Fa.ApplicationMode=
rd,k.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=id.a.Ac(Fa))}}l9e(){const Ea=this.$.ya;this.nT.FQ=!0;this.nT.xNb(Ea.BWsaStartTime);this.setDw(59,83);this.WHb=!1;if(this.b2){const Fa=Ea.DocumentHostInfo;this.y9g();this.setDw(8491,this.$.oG);this.setDw(9236,Ea.RequestedUILcid);this.setDw(8473,Ea.WacHostId);this.setDw(9902,yd.c(Fa.ClusterId));xb.EwaSettings.ma(453)?this.nT.mYf(""):this.nT.mYf(Ea.FlightHolder?Ea.FlightHolder.FlightId:"");this.KMd(this.ea.jc.inEmbedView?1:0);this.Ugd=!1;
this.setDw(9104,yd.c(Fa.FileSourceId));this.setDw(10309,this.ybi);this.Vtj();k.AFrameworkApplication.wb.aNf(Ge.a.getInstance(!1))}}Vtj(){y.a.instance.g9h(this.nT);if(this.U0f){const Ea=y.a.instance;Ea.y5i();Ea.Q5i();Ea.P5i();Ea.O5i();Ea.K5i();this.U0f=!1}}y9g(){this.createStream(8327,1,Kd.a.Sbh,Kd.a.x0a);this.createStream(9134,1,3,Kd.a.x0a);this.createStream(11007,1,1,Kd.a.x0a)}createStream(Ea,Fa,vc,rd){this.nT.createStream(Ea,Fa,vc,rd)}}Zd.Jfb=null;Zd.XWc=!1;Zd.appEncounteredFirstError=!1;Object(b.a)(Zd,
"SqmManager",Ub.a,[149,567]);var Xd=a(734);class Je{constructor(Ea,Fa=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=Ea;this.buffered=Fa}}Object(b.a)(Je,"PerformanceObserverInit",null,[]);class Xe extends Sys.EventArgs{constructor(Ea){super();this.xKe=Ea}}Object(b.a)(Xe,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Ke extends Sys.EventArgs{constructor(Ea){super();this.gdc=Ea}}Object(b.a)(Ke,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class Qe{constructor(Ea){this.Qa=
new Ce.a;this.GIc=!1;this.yg=()=>{if(l.a.fp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.Wvi)).observe(new Je([ic.a.jtd])),this.GIc=!0)}catch(Fa){this.GIc=!1,d.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Fa}`)}this.Qa.raiseEvent("ltpoiek",new Ke(this.gdc))}};this.Wvi=Fa=>{this.Qa.raiseEvent("ltoek",new Xe(Fa))};this.$=Ea;this.$.ea.Eg?this.yg(this,Sys.EventArgs.Empty):this.$.ea.ql(this.yg)}get gdc(){return this.GIc}mme(Ea){this.Qa.addHandler("ltoek",
Ea)}Xaj(Ea){this.Qa.removeHandler("ltoek",Ea)}WEg(Ea){this.Qa.addHandler("ltpoiek",Ea)}Yaj(Ea){this.Qa.removeHandler("ltpoiek",Ea)}dispose(){this.$.ea.xn(this.yg);Mc.a.Ia(this.Qa);this.$=this.Qa=null}}Object(b.a)(Qe,"LongTaskPerformanceObserver",null,[3]);var df=a(172);class Ne{constructor(Ea=0,Fa=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=Ea;this.longTaskDuration=Fa}get mtd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:
0}Dni(Ea){return 100*this.mtd>Ea}ECg(Ea){this.ele(Ea.longTaskDuration);this.bTc(Ea.activeSessionDuration)}ele(Ea){this.longTaskDuration+=Ea}bTc(Ea){this.activeSessionDuration+=Ea}}Object(b.a)(Ne,"LongTaskPerformanceData",null,[]);class jf{constructor(Ea,Fa,vc,rd,de){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Ea;this.entireSessionData=Fa;this.worstWindowData=vc;this.postBootWindowData=rd;this.maxUsersCount=
de}get reportName(){return"LongTaskPerformance"}static get tjh(){return new jf(!1,new Ne,new Ne,new Ne,0)}}Object(b.a)(jf,"LongTaskPerformanceDataStatistics",null,[510]);class Le extends Sys.EventArgs{constructor(Ea){super();this.ktd=Ea}}Object(b.a)(Le,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var me=a(455),Za=a(375);class Tb{constructor(Ea,Fa){this.Qa=new Ce.a;this.nMa=this.U4=this.bS=this.Ne=null;this.Vhf=this.gQd=this.Igc=!1;this.WMa=null;this.maxUsersCount=0;this.Ylc=(vc,rd)=>{vc=rd.xKe.getEntriesByType(ic.a.jtd);
for(const de of vc)this.Ne.kB(de.duration)||k.AFrameworkApplication.VLa||(this.bS.ele(de.duration),this.Qa.raiseEvent("lttek",new Le(de)),vc={},vc.LongTaskDuration=de.duration,vc.LongTaskStartTime=de.startTime,d.ULS.sendTraceTag(187982418,0,50,JSON.stringify(vc)))};this.yg=()=>{this.gQd=!0;this.cxc()};this.xB=(vc,rd)=>{rd&&(this.maxUsersCount=Math.max(this.maxUsersCount,rd.nYd));this.U4.maxUsersCount=this.maxUsersCount};this.Zc=()=>{this.cxc()};this.Dc=()=>{this.C5f()};this.nyf=(vc,rd)=>{rd.gdc&&
this.cxc()};this.Mlf=()=>{this.bS.bTc(xa.getElapsedMilliseconds(this.nMa,Ua.a.Wa.Nb));this.hSd(!0);var vc=!1;this.U4.postBootWindowData.activeSessionDuration?(!this.Vhf&&xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.$dg&&db.b().aRf(2),W.Health.instance.recordKpiUsage(Za.a.longJsTask,0,me.a.Hoi,null),this.Vhf=!0),!this.U4.isVetoSession&&this.bS.Dni(this.Peg)&&(this.U4.isVetoSession=!0,xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.$dg&&db.b().bRf(2,this.Uvi),W.Health.instance.recordKpiFailure(Za.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.U4.worstWindowData.mtd<=this.bS.mtd&&(this.U4.worstWindowData=this.bS),this.U4.entireSessionData.ECg(this.bS)):(this.U4.postBootWindowData=new Ne(this.bS.activeSessionDuration,this.bS.longTaskDuration),vc=!0);const rd={};rd.LastWindowScore=this.bS;rd.postBootWindow=vc;rd.CoauthersNumber=this.$.ea.Jm.length;vc=JSON.stringify(rd);d.ULS.sendTraceTag(20779346,0,50,vc);this.bS=
new Ne};this.Qkc=()=>{this.Ne.Ei||k.AFrameworkApplication.VLa||this.hSd(!1)};this.Pkc=()=>{this.bS.bTc(xa.getElapsedMilliseconds(this.nMa,Ua.a.Wa.Nb));this.nMa=null;this.WMa.cancel()};this.$=Ea;this.Peg=Ea.ya.LongTaskPerformanceVetoThreshold;this.Uvi="PercentageOver_"+this.Peg.toString();this.ltd=Ea.ya.LongTaskPerformanceWindowDurationInMs;this.eN=Fa;this.$dg=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Za(291,vc=>{this.Ne=vc;this.cxc()});this.$.ea.Eg?this.yg(this,
Sys.EventArgs.Empty):this.$.ea.ql(this.yg);this.eN.WEg(this.nyf);this.$.el(this.Zc);this.$.ik(this.Dc)}XEg(Ea){this.Qa.addHandler("lttek",Ea)}Zaj(Ea){this.Qa.removeHandler("lttek",Ea)}dispose(){this.gQd=!1;this.C5f();this.$.Cl(this.Zc);this.$.Bl(this.Dc);this.eN.Yaj(this.nyf);Mc.a.Ia(this.WMa);this.eN=this.$=this.WMa=null;void 0!==this.Ne&&null!==this.Ne&&Mc.a.Ia(this.Ne)}cxc(){void 0===this.Ne||null===this.Ne?d.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.eN.gdc?this.Igc?d.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.gQd?(this.Igc=!0,this.U4=jf.tjh,this.bS=new Ne,this.$.ea.V8(this.xB),this.maxUsersCount=this.$.ea.Jm.length,this.eN.mme(this.Ylc),this.Ne.LXa(this.Pkc),this.Ne.mmb(this.Qkc),k.AFrameworkApplication.gTc(this.Pkc),k.AFrameworkApplication.hTc(this.Qkc),this.WMa=Yc.a.instance.create(this.Mlf,this.ltd,Qb.a.Xkf,!1),ac.a(this.$).BX(this.U4),
this.Ne.Ei||k.AFrameworkApplication.VLa||this.hSd(!0),d.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):d.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):d.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}C5f(){this.Igc&&
(this.Igc=!1,this.$.ea.xn(this.yg),this.eN.Xaj(this.Ylc),this.$.ea.j6(this.xB),void 0!==this.Ne&&null!==this.Ne&&(this.Ne.yab(this.Pkc),this.Ne.zab(this.Qkc)),k.AFrameworkApplication.IOf(this.Pkc),k.AFrameworkApplication.JOf(this.Qkc),this.WMa.cancel(),this.nMa=this.bS=this.U4=null,this.maxUsersCount=0)}hSd(Ea){Ea||void 0===this.nMa||null===this.nMa?(this.nMa=Ua.a.Wa.Nb,this.WMa=df.AsyncMethodContext.B7g(this.Mlf,Ea?this.ltd:this.ltd-this.bS.activeSessionDuration,Qb.a.Xkf,this.WMa)):d.ULS.sendTraceTag(589875356,
0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(b.a)(Tb,"LongTaskPerformanceTracker",null,[3]);class uc extends Ce.a{constructor(Ea,Fa){super();this.statusBarManager=this.Ne=null;this.oyf=(vc,rd)=>{rd.ktd&&rd.ktd.duration>=this.Xvi&&(this.Zlf++,this.rif=rd.ktd.duration)};this.$=Ea;this.$.da.Za(29,vc=>{this.statusBarManager=vc;vc.hJ(this)});this.$.da.Za(291,vc=>{this.Ne=
vc});this.rif=this.Zlf=0;this.Xvi=Ea.ya.LongTaskThresholdMs;this.G7a=Fa;this.G7a.XEg(this.oyf)}nq(Ea){this.addHandler("LTSCEK",Ea)}Nq(Ea){this.removeHandler("LTSCEK",Ea)}Dz(){this.mn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Pr(Ea,Fa){if("QueryLongTasksCount"!==Ea)return!1;this.D2h(Fa);return!0}mn(){return xb.EwaSettings.ma(581)}dispose(){this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.G7a.Zaj(this.oyf);super.dispose()}D2h(Ea){Ea.Value=`Long Tasks: ${this.Zlf} | Last Task Duration: ${Math.round(this.rif)}ms`}}
Object(b.a)(uc,"LongTasksStatusBarManager",Ce.a,[3,184,185]);var Oc=a(11);class sb{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(b.a)(sb,"NetworkInfoData",null,[]);class $b extends Ce.a{constructor(Ea){super();this.statusBarManager=null;this.OSc=!1;this.orf=()=>{this.raiseEvent("NetworkInformation")};this.$=Ea;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.VZ=this.$Vd("connection")||
this.$Vd("mozConnection")||this.$Vd("webkitConnection"))&&xb.EwaSettings.ma(469)&&Ea.da.Za(29,Fa=>{this.statusBarManager=Fa;Fa.hJ(this);this.VZ.addEventListener("change",this.orf);this.OSc=!0})}nq(Ea){this.addHandler("NetworkInformation",Ea)}Nq(Ea){this.removeHandler("NetworkInformation",Ea)}q3a(){return this.VZ?Object(wb.a)(new sb,{bandwidthMps:this.VZ.downlink,rttMs:this.VZ.rtt,connectionType:this.VZ.type,effectiveConnection:this.VZ.effectiveType,downlinkMaxMps:this.VZ.downlinkMax}):null}Pr(Ea,
Fa){if("QueryNetworkInformation"!==Ea)return!1;this.E2h(Fa);return!0}mn(){return this.OSc}dispose(){this.OSc&&(this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null),this.VZ&&this.VZ.removeEventListener("change",this.orf));this.$=null;super.dispose()}$Vd(Ea){return Oc.HelperMethods.ln(window.navigator,Ea)?window.navigator[Ea]:null}E2h(Ea){Ea.Value="Network: "+this.VZ.downlink.toString()+" Mbps, "+this.VZ.rtt.toString()+" ms"}}Object(b.a)($b,"NetworkInformationManager",
Ce.a,[184,185]);var xc=a(184),ad=a(21);class Dd{constructor(Ea="",Fa=-1,vc=-1,rd=-1,de=!1,qe=!0,bf=!0,of=!1,Mf="",Ff=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=Ea;this.startTime=Fa;this.startToNextFrame=vc;this.startToResponseRenderEnd=rd;this.wasHidden=de;this.isUserOperation=qe;this.isGroupBreaking=
bf;this.operationThatLedToLogging=Mf;this.startToOperationThatLedToLogging=Ff;this.isPartOfGroup=of}}Object(b.a)(Dd,"OperationStatisticsData",null,[]);var ie=a(79);class $d{constructor(){this.operationsGroups=null;this.D8h()}isGroup(Ea,Fa,vc){const rd=new xc.a;rd.addRange(Ea);rd.addRange(Fa);for(let de=0;de<this.operationsGroups.count;de++)if(this.Jji(this.operationsGroups.na(de),rd,vc))return d.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${vc}' is part of a group ( operationsList: ${this.aEf(Ea)} , frameOperationsList: ${this.aEf(Fa)})`),
!0;d.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${vc}' is NOT part of a group.`);return!1}Jji(Ea,Fa,vc){let rd=0;for(let de=0;de<Fa.count;de++)if(Fa.na(de).isGroupBreaking){if(Ea.count<=rd||!Va.a.equals(Fa.na(de).name,Ea.na(rd),!0))return!1;rd++}return Ea.count>rd&&Va.a.equals(vc,Ea.na(rd),!0)}aEf(Ea){Ea=ie.select(Ea,Fa=>Fa.name);return`[${ie.toArray(Ea).join(", ")}]`}D8h(){this.operationsGroups=new xc.a;let Ea;this.BXa((Ea=new xc.a,Ea.add("Paste"),Ea.add("SelectingRange_unknown"),
Ea));let Fa;this.BXa((Fa=new xc.a,Fa.add("AutoSum"),Fa.add("SelectingRange_unknown"),Fa));let vc;this.BXa((vc=new xc.a,vc.add("ChangeSheetDirection"),vc.add("ActiveItemChanged"),vc));let rd;this.BXa((rd=new xc.a,rd.add("InsertSheet"),rd.add("ActiveItemChanged"),rd.add("SelectingRange_unknown"),rd));let de;this.BXa((de=new xc.a,de.add("DeleteSheet"),de.add("DialogButtonClick"),de.add("ActiveItemChanged"),de.add("SelectingRange_unknown"),de));let qe;this.BXa((qe=new xc.a,qe.add("EditBoxEndEdit"),qe.add("SetCell"),
qe.add("SelectingRange_keyboard"),qe.add("MoveDownWithinSelectionOrCommitEdit"),qe))}BXa(Ea){this.operationsGroups.add(Ea)}}Object(b.a)($d,"OperationsGroupDetector",null,[]);var ne=a(25);class ye{constructor(Ea,Fa,vc,rd){this.framePerformanceTracker=this.LHb=this.e_=this.e0=null;this.Mdj=()=>{this.EUc=-1;const de=Oc.HelperMethods.Tb();this.VSj(de);xb.EwaSettings.ma(369)&&(this.aJb&&(d.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.yNb(this.KE,de),this.aJb=!1),this.bfc&&(this.yNb(this.pD,de),this.aJb||this.yNb(this.KE,de)));window.setTimeout(this.Rti,0)};this.Rti=()=>{const de=new xc.a,qe=this.$.ya.OperationToPrevOperationThreshold;for(var bf=0;bf<this.KE.count;bf++){const of=this.KE.na(bf);bf<qe&&de.add(of);this.pD.add(of)}ad.g(this.$)&&ad.g(this.$).Ea?((bf=this.sessionStatisticsManager.Wbd(0))?d.ULS.sendTraceTag(237798547,1,50,`DOM count: (${bf.Gzi}, ${bf.GMg}, ${bf.uyi}), long tasks: ${this.lBb}, operations count: ${this.KE.count}, operations: ${de}`):
d.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.KE.count>qe&&d.ULS.sendTraceTag(537153875,1,50,`More than ${qe} operations are in the operationsList. count: ${this.KE.count}`),this.KE.clear(),this.lBb.clear()):d.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Ylc=(de,qe)=>{this.Vvi(qe.xKe)};this.$=Ea;this.pI=Fa;this.yh=this.yh||Ua.a.Wa;this.pD=new xc.a;this.KE=new xc.a;this.EUc=this.a7a=-1;this.lBb=new xc.a;this.operationsGroupDetector=
new $d;this.aJb=this.bfc=!1;this.Y8h();this.F8h();this.E8h();this.sessionStatisticsManager=vc;this.eN=rd;this.eN.mme(this.Ylc);this.$.da.Za(263,de=>{this.framePerformanceTracker=de})}UHb(Ea,Fa){var vc=Oc.HelperMethods.Tb();const rd=xb.EwaSettings.ma(369)?this.operationsGroupDetector.isGroup(this.pD,this.KE,Ea):!1;this.bfc=this.kef(Ea);xb.EwaSettings.ma(369)?this.bfc&&0<this.pD.count&&!rd&&(this.YRj(),this.zcg(Ea,vc),this.GSe()):0<this.pD.count&&this.kef(Ea)&&(this.zcg(Ea,vc),this.GSe());this.a7a=
-1;if(ad.g(this.$)&&ad.g(this.$).Ea){var de=!this.e0.contains(Ea);vc=new Dd(Ea,vc,void 0,void 0,void 0,de,this.bfc,rd);this.KE.add(vc);this.framePerformanceTracker&&this.framePerformanceTracker.aEj(vc.name,Fa);xb.EwaSettings.ma(369)&&!this.aJb&&this.LHb.contains(Ea)&&(this.aJb=!0);-1===this.EUc&&(this.EUc=window.requestAnimationFrame(this.Mdj))}else d.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}Drc(){this.a7a=Oc.HelperMethods.Tb()}Krc(){this.pD.count||this.KE.count?(this.yNb(this.KE,
this.a7a),this.yNb(this.pD,this.a7a)):d.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.a7a}`);this.a7a=-1}kef(Ea){return!this.e_.contains(Ea)&&!Ea.includes("Menu")&&!Ea.includes("TellMe")}GSe(){for(let Ea=0;Ea<this.pD.count;Ea++){const Fa=this.pD.na(Ea);this.pI.yyg(Fa);this.yui(Fa)}this.pD.clear()}VSj(Ea){for(let Fa=0;Fa<this.KE.count;Fa++)this.KE.na(Fa).startToNextFrame=this.Qdd(this.KE.na(Fa).startTime,Ea),this.KE.na(Fa).wasHidden=
Xd.a.kB(this.KE.na(Fa).startToNextFrame)}zcg(Ea,Fa){for(let vc=0;vc<this.pD.count;vc++)-1===this.pD.na(vc).startToResponseRenderEnd&&(this.pD.na(vc).operationThatLedToLogging=Ea,this.pD.na(vc).startToOperationThatLedToLogging=this.Qdd(this.pD.na(vc).startTime,Fa))}YRj(){var Ea=!1;for(let Fa of this.pD)if(Fa.isPartOfGroup){Ea=!0;break}if(Ea)for(Ea=0;Ea<this.pD.count;Ea++)this.pD.na(Ea).isPartOfGroup=this.pD.na(Ea).isGroupBreaking}yNb(Ea,Fa){for(let vc=0;vc<Ea.count;vc++)Ea.na(vc).startToResponseRenderEnd=
this.Qdd(Ea.na(vc).startTime,Fa),Ea.na(vc).wasHidden=Xd.a.kB(Ea.na(vc).startToResponseRenderEnd)}yui(Ea){d.ULS.sendTraceTag(2020372336,1,50,`${Ea}`)}Qdd(Ea,Fa){return-1===Ea?-1:-1===Fa?-2:Fa-Ea}Vvi(Ea){Ea=Ea.getEntriesByType(ic.a.jtd);for(let Fa=0;Fa<Ea.length;Fa++)if(30>this.lBb.count)if(this.KE.count)this.lBb.add(this.NWi(Ea[Fa]));else{const vc=Ea[Fa];if(null===vc||void 0===vc?0:vc.attribution)void 0!==vc.attribution.containerSrc&&null!==vc.attribution.containerSrc&&(vc.attribution.containerSrc=
""),void 0!==vc.attribution.containerId&&null!==vc.attribution.containerId&&(vc.attribution.containerId=""),void 0!==vc.attribution.containerName&&null!==vc.attribution.containerName&&(vc.attribution.containerName="");d.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{d.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Ea.length} First long task: ${this.lBb.na(0)}`);break}}NWi(Ea){return`name:${Ea.name}, startTime:${Ea.startTime}, duration:${Ea.duration}`}Y8h(){this.e0||
(this.e0=new Ka.a(Bb.a.Rk()),this.e0.add("ActiveItemChanged"),this.e0.add(db.b().mj(-1398645260)),this.e0.add(db.b().mj(722290388)),this.e0.add(db.b().mj(974713501)),this.e0.add(ne.a.hQ(ne.a.h1b)),this.e0.add(ne.a.hQ(ne.a.g1b)),this.e0.add(ne.a.hQ(ne.a.qpb)),this.e0.add(ne.a.hQ(ne.a.VIf)),this.e0.add(ne.a.hQ(ne.a.pma)))}F8h(){this.e_||(this.e_=new Ka.a(Bb.a.Rk()),this.e_.add("PromptEditInBrowser"),this.e_.add(db.b().mj(-1398645260)),this.e_.add(db.b().mj(722290388)),this.e_.add(db.b().mj(974713501)),
this.e_.add(ne.a.hQ(ne.a.h1b)),this.e_.add(ne.a.hQ(ne.a.g1b)),this.e_.add(ne.a.hQ(ne.a.qpb)),this.e_.add(ne.a.hQ(ne.a.VIf)),this.e_.add(ne.a.hQ(ne.a.pma)))}E8h(){this.LHb||(this.LHb=new Ka.a(Bb.a.Rk()),this.LHb.add("SelectingRange_keyboard"),this.LHb.add("SelectingRange_mouse"))}}Object(b.a)(ye,"OperationStatistics",null,[]);var te=a(575);class Ze{constructor(Ea,Fa){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ea;this.errorCause=Fa}}Object(b.a)(Ze,"RequestError",null,[]);class re{constructor(Ea,
Fa,vc,rd,de,qe,bf,of,Mf,Ff,hg,xf,Df,Tf,Pg,ig,ag){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Ea;this.isUserTriggeredRequest=re.zPh(Ea);this.isFullyLoggedKPIRequest=re.vPh(Ea);this.isPromotedUTRRequest=re.wPh(Ea);this.requestDuration=Fa;this.totalOperationDuration=vc;this.requestTimeInQueue=rd;this.requestInvokedTime=de;this.ecsOperationDuration=qe.EcsOperationDuration;this.EcsRequestDuration=qe.EcsRequestDuration;this.WfeRequestDuration=
qe.WfeRequestDuration;this.TimeFromLastEcsFreeze=qe.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=qe.DuringLoadOnDemand;this.correlationID=bf;this.errors=re.M0g(of);this.httpStatus=Mf;this.requestResourceTiming=Ff;this.communicationErrorRetryCount=hg;this.successfulCall=xf;this.isDocumentHidden=Df;this.coauthorsCount=Tf;this.responseSize=Pg;this.networkInfoData=ig;this.responseToCallbackTime=ag}static M0g(Ea){if(!Ea)return[];const Fa=[];for(const vc of Ea)Fa.push(new Ze(vc.MessageIdName,vc.ErrorCause));
return Fa}static zPh(Ea){return!re.DCi.contains(Ea)}static LRh(){const Ea=new Ka.a(Bb.a.Rk());Ea.add("CheckPersistedContentUpdate");Ea.add("GetContentBundle");Ea.add("GetSessionStatus");Ea.add("GetStatusBarAggregates");Ea.add("PollSessionStatus");Ea.add("UpdatePresenceUsers");Ea.add("UploadLatencyTelemetry");return Ea}static vPh(Ea){return re.eDh.contains(Ea)}static wPh(Ea){return re.N0i.contains(Ea)}static eOh(){const Ea=new Ka.a(Bb.a.Rk());Ea.add("SetRichTextCell");Ea.add("Copy");Ea.add("FormatCells");
Ea.add("PasteRange");Ea.add("FindCell");Ea.add("ApplyToRangesV2");Ea.add("ResizeRowsColumns");Ea.add("InsertDeleteCells");Ea.add("FillRange");Ea.add("PasteHtmlContent");Ea.add("ApplyFilter");Ea.add("PasteString");Ea.add("Undo");Ea.add("LineageUpdateView");Ea.add("FindAll");Ea.add("ApplyHyperlink");Ea.add("AutoFit");Ea.add("GetPrintSettings");Ea.add("GetEdgeCell");Ea.add("Paste");Ea.add("MoveAndResizeFloatingObject");Ea.add("FindRange");Ea.add("SetCustomFilter");Ea.add("RenameSheet");Ea.add("ApplyThreadedComment");
Ea.add("SortFilterColumn");Ea.add("InsertCopiedCutCells");Ea.add("InsertSheet");Ea.add("ToggleAutoFilter");Ea.add("ReorderSheets");Ea.add("SetOutlineLevel");Ea.add("RefreshAll");Ea.add("LineageOpenPaneOrChangeFilter");Ea.add("ApplySlicerSelection");Ea.add("GetCardViewCardByCell");Ea.add("AutoSum");Ea.add("LineageClosePane");Ea.add("Sort");Ea.add("ClearAutoFilter");Ea.add("DeleteSheet");Ea.add("Redo");xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ea.add("RemovePageBreak"),
Ea.add("InsertPageBreak"),Ea.add("SetPrintArea"),Ea.add("ClearPrintArea"));return Ea}static xPh(){const Ea=new Ka.a(Bb.a.Rk());Ea.add("DeleteConditionalFormattingRules");Ea.add("GetConditionalFormattingRules");Ea.add("AddConditionalFormattingRule");Ea.add("QuickEditConditionalFormattingRule");Ea.add("GetPrintSettings");Ea.add("UpdatePresenceUsers");Ea.add("GetThemeInfo");Ea.add("InsertCopiedCutCells");Ea.add("PasteRange");xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(Ea.add("LineageOpenPaneOrChangeFilter"),Ea.add("LineageUpdateView"),Ea.add("LineageRefreshView"),Ea.add("LineageLoadMore"));return Ea}}re.DCi=re.LRh();re.eDh=re.eOh();re.N0i=re.xPh();Object(b.a)(re,"RequestStatisticsData",null,[]);class tc{constructor(Ea,Fa,vc){this.$=Ea;this.pI=Fa;this.Kka=vc}Orc(Ea,Fa,vc,rd,de,qe,bf,of,Mf,Ff,hg,xf,Df,Tf){xf=te.a(xf);Ea=new re(Ea,Fa,vc,rd,de,qe,bf,of,Mf,xf,Ff,hg,Xd.a.kB(Fa),this.rdd(null),Df,this.Kka.q3a(),Tf);this.mJd(Ea)}ki(Ea,Fa){Ea="UnknownMethodName";let vc=
-1;void 0!==Fa.context&&null!==Fa.context&&(Ea=Fa.context.methodName,vc=Fa.context.communicationErrorRetryCount);let rd,de={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Fa.$c?(rd=Fa.$c.Errors||[],this.pI.Edj(Fa.$c.EditSessionIsDirty),void 0!==Fa.$c.RequestTelemetryData&&null!==Fa.$c.RequestTelemetryData&&(de=Fa.$c.RequestTelemetryData)):rd=[];const qe=Fa.duration,bf=te.a(Fa.url);Fa=new re(Ea,qe,Fa.totalOperationDuration,Fa.mUd,
Fa.nF,de,Fa.uMd,rd,Fa.httpStatus,bf,vc,!0,Xd.a.kB(qe),this.rdd(Fa.$c),Fa.responseSize,this.Kka.q3a(),Fa.responseToCallbackTime);this.mJd(Fa)}Un(Ea,Fa){Ea="UnknownMethodName";let vc=-1;void 0!==Fa.context&&null!==Fa.context&&(Ea=Fa.context.methodName,vc=Fa.context.communicationErrorRetryCount);const rd=Fa.duration,de=te.a(Fa.url);Fa=new re(Ea,rd,Fa.totalOperationDuration,Fa.mUd,Fa.nF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
Fa.uMd,Fa.errors||[],Fa.httpStatus,de,vc,!1,Xd.a.kB(rd),this.rdd(null),-1,this.Kka.q3a(),Fa.responseToCallbackTime);this.mJd(Fa)}mJd(Ea){this.pI.VHg(Ea);if(xb.EwaSettings.ma(229)){var Fa=Ea.requestName;if(Fa!==ic.a.A3a&&"SetCell"!==Fa&&"FindRange"!==Fa&&"FindAll"!==Fa&&"FindCell"!==Fa)return}Fa=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ea.requestName||null===Ea.requestName)&&Ea.isPromotedUTRRequest;tc.xhh(Ea,Fa);this.pI.zyg(Ea)}rdd(Ea){var Fa;if(null===
(Fa=null===Ea||void 0===Ea?void 0:Ea.CollaborationResult)||void 0===Fa?0:Fa.Users)return Ea.CollaborationResult.Users.length;Ea=this.$.ea.Jm.length;return 0<Ea?Ea:1}static xhh(Ea,Fa){Fa?db.b().Mtc(388829456,0,15,Ea):(Fa=Sys.Serialization.JavaScriptSerializer.serialize(Ea),d.ULS.sendTraceTag(388829456,0,50,Fa));if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ea.requestName&&null!==Ea.requestName&&Ea.isFullyLoggedKPIRequest){Fa=new Map;Fa.set("isUserTriggeredRequest",
Ea.isUserTriggeredRequest.toString());Fa.set("requestDuration",Ea.requestDuration.toString());Fa.set("totalOperationDuration",Ea.totalOperationDuration.toString());Fa.set("requestTimeInQueue",Ea.requestTimeInQueue.toString());Fa.set("requestInvokedTime",Ea.requestInvokedTime.toString());Fa.set("ecsOperationDuration",Ea.ecsOperationDuration.toString());Fa.set("ecsRequestDuration",Ea.EcsRequestDuration.toString());Fa.set("wfeRequestDuration",Ea.WfeRequestDuration.toString());Fa.set("timeFromLastEcsFreeze",
Ea.TimeFromLastEcsFreeze.toString());Fa.set("duringLoadOnDemand",Ea.DuringLoadOnDemand.toString());Fa.set("correlationID",Ea.correlationID);Fa.set("errors",Ea.errors.toString());Fa.set("httpStatus",Ea.httpStatus.toString());if(Ea.networkInfoData){var vc=Ea.networkInfoData;Fa.set("networkInfoData_bandwidthMps",void 0===vc.bandwidthMps||null===vc.bandwidthMps?"NA":vc.bandwidthMps.toString());Fa.set("networkInfoData_rttMs",void 0===vc.rttMs||null===vc.rttMs?"NA":vc.rttMs.toString());Fa.set("networkInfoData_effectiveConnection",
void 0===vc.effectiveConnection||null===vc.effectiveConnection?"NA":vc.effectiveConnection)}Ea.requestResourceTiming&&(vc=Ea.requestResourceTiming,Fa.set("requestResourceTiming_fetchStart",void 0===vc.downloadDuration||null===vc.downloadDuration?"NA":vc.downloadDuration.toString()));Fa.set("communicationErrorRetryCount",Ea.communicationErrorRetryCount.toString());Fa.set("successfulCall",Ea.successfulCall.toString());Fa.set("isDocumentHidden",Ea.isDocumentHidden.toString());Fa.set("coauthorsCount",
Ea.coauthorsCount.toString());Fa.set("responseSize",Ea.responseSize.toString());Fa.set("responseToCallbackTime",Ea.responseToCallbackTime.toString());db.b().Lrc(Ea.requestName,Ea.successfulCall,Fa)}}}Object(b.a)(tc,"RequestStatistics",null,[]);var $c=a(206),Ed=a(62),Id=a(309);class ae{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(b.a)(ae,
"OperationTypeStatisticsData",null,[]);class ja{constructor(Ea,Fa){this.data=new ae;this.data.operationName=Ea;this.data.isUserOperation=Fa;this.data.totalCount=0;this.W4f=[];this.X4f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Cd(Ea){this.data.totalCount<ja.J5c&&(this.W4f.push(Ea.startToNextFrame),this.X4f.push(Ea.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
Ea.startToNextFrame&&(this.data.longestStartToNextFrame=Ea.startToNextFrame);this.data.longestStartToResponse<Ea.startToResponseRenderEnd&&(this.data.longestStartToResponse=Ea.startToResponseRenderEnd)}H9c(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.w_e(this.W4f),this.data.startToResponsePercentiles=this.w_e(this.X4f))}w_e(Ea){Ea.sort(Oc.HelperMethods.iD);let Fa;Fa="("+Xd.a.wua(Ea,25).toString();Fa=Fa+", "+Xd.a.wua(Ea,50).toString();Fa=Fa+", "+Xd.a.wua(Ea,75).toString();
Fa=Fa+", "+Xd.a.wua(Ea,95).toString();return Fa+")"}}ja.J5c=1E3;Object(b.a)(ja,"OperationTypeStatistics",null,[]);class hb{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(b.a)(hb,"RequestTypeStatisticsData",null,[]);class oa{constructor(Ea){this.data=new hb;this.data.requestName=Ea;this.data.totalCount=0;this.Vab=[];this.rVd=this.jVd=this.kVd=this.oVd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}iej(Ea){this.data.totalCount<oa.J5c&&this.Vab.push(Ea.requestDuration);this.data.totalCount++;this.oVd+=Ea.requestDuration;this.kVd+=oa.bbd(Ea.ecsOperationDuration);this.jVd+=oa.bbd(Ea.EcsRequestDuration);this.rVd+=oa.bbd(Ea.WfeRequestDuration);0<Ea.TimeFromLastEcsFreeze&&Ea.TimeFromLastEcsFreeze<oa.TCh&&this.data.callsDuringEcsFreeze++;Ea.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Ea.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<Ea.requestDuration)this.data.longestRequest=Ea}H9c(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.oVd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.kVd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.jVd/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.rVd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Vab.sort(Oc.HelperMethods.iD),this.data.requestDurationPercentile25=Xd.a.wua(this.Vab,25),this.data.requestDurationPercentile50=Xd.a.wua(this.Vab,50),this.data.requestDurationPercentile75=Xd.a.wua(this.Vab,75),this.data.requestDurationPercentile95=Xd.a.wua(this.Vab,95))}static bbd(Ea){return 0>Ea?0:Ea}}oa.TCh=3E3;oa.J5c=1E3;Object(b.a)(oa,"RequestTypeStatistics",null,[]);class fb{constructor(Ea,Fa,vc,rd,de,qe,bf,of){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ea;this.ocsCapable=Fa;this.endedBySplashScreen=vc;this.dirtySessionOnLastRecordedRequest=rd;this.loadOnDemandCount=de;this.maxCoauthorsCount=qe;this.everConnectedToOcs=bf;Ea=[];for(let Mf in of)Fa=of[Mf],Fa.H9c(),Ea.push(Fa.data);this.requests=Ea}}Object(b.a)(fb,"SessionStatisticsData",null,[]);class Eb{constructor(Ea){this.dirtySessionOnLastRecordedRequest=
this.cSd=!1;this.Qjf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ea;this.plb={};this.olb={};this.y3c={}}Dc(){var Ea=this.x$g();if(Ba.a.ada()){var Fa={};Fa.xlendJson=Ea;this.$.Bma($c.a.wXj,Fa,!1)}else Ed.O(this.$.pa.va,Ea,null,null,null,null,null);Ea=this.y$g();Ba.a.ada()?(Fa={},Fa.xlenoJson=Ea,this.$.Bma($c.a.xXj,Fa,!1)):d.ULS.sendTraceTag(388776782,0,50,Ea);xb.EwaSettings.ma(69)&&(Ea=this.R4g(),Ba.a.ada()?(Fa={},Fa.xlencJson=Ea,this.$.Bma($c.a.vXj,Fa,!1)):d.ULS.sendTraceTag(388776770,
0,50,Ea));this.Pej()}Jgc(){this.everConnectedToOcs=this.$.ea.J6a||this.everConnectedToOcs;W.Health.instance&&W.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}yg(){const Ea=new Id.a;let Fa="";const vc=!this.$.isAnonymousUser(),rd=Ea.If();if(rd){if(vc){Ea.yNd("UMI_Linkable","true");return}Fa=Ea.Eub("UMI_Linkable")}vc||d.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${rd}, UMIIsLinkable:${!!Fa}`)}Rab(){this.cSd=
!0}Edj(Ea){this.dirtySessionOnLastRecordedRequest=Ea}VHg(Ea){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Ea.coauthorsCount);W.Health.instance&&W.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}zyg(Ea){if(!(Ea.requestName in this.plb)){const Fa=new oa(Ea.requestName);this.plb[Ea.requestName]=Fa}this.plb[Ea.requestName].iej(Ea)}yyg(Ea){if(!(Ea.name in this.olb)){const Fa=new ja(Ea.name,Ea.isUserOperation);this.olb[Ea.name]=Fa}this.olb[Ea.name].Cd(Ea)}BX(Ea){this.y3c[Ea.reportName]=
Ea}Pej(){this.dirtySessionOnLastRecordedRequest=this.cSd=!1;this.Qjf=this.$.ea.Zrd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.plb={};this.olb={};this.y3c={}}x$g(){const Ea=new fb(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.cSd,this.dirtySessionOnLastRecordedRequest,this.$.ea.Zrd-this.Qjf,this.maxCoauthorsCount,this.everConnectedToOcs,this.plb);return Sys.Serialization.JavaScriptSerializer.serialize(Ea)}y$g(){var Ea=new xc.a;const Fa=this.olb;for(let vc in Fa){const rd=
Fa[vc];rd.H9c();Ea.add(rd.data)}Ea=Ea.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ea)}R4g(){return Sys.Serialization.JavaScriptSerializer.serialize(this.y3c)}}Object(b.a)(Eb,"SessionStatistics",null,[]);class jc extends Ub.a{constructor(Ea){super();this.mma=this.xla=null;this.tEe=Array(1);this.kLc=this.ntd=null;this.ki=(Fa,vc)=>{xb.EwaSettings.ma(40)&&(this.mma=this.mma||new tc(this.$,this.pI,this.Kka),this.mma.ki(Fa,vc))};this.Un=(Fa,vc)=>{xb.EwaSettings.ma(40)&&(this.mma=this.mma||
new tc(this.$,this.pI,this.Kka),this.mma.Un(Fa,vc))};this.Dc=(Fa,vc)=>{xb.EwaSettings.ma(40)&&this.pI.Dc(Fa,vc)};this.yg=(Fa,vc)=>{xb.EwaSettings.ma(40)&&this.pI.yg(Fa,vc)};this.Jgc=(Fa,vc)=>{xb.EwaSettings.ma(40)&&this.pI.Jgc(Fa,vc)};this.$=Ea;xb.EwaSettings.ma(40)&&(Xd.a.U8h(this.$),this.eN=new Qe(this.$),this.M6g(),xb.EwaSettings.ma(581)&&this.G7a&&(this.ntd=new uc(this.$,this.G7a)),this.pI=new Eb(this.$),this.Kka=new $b(this.$),this.$.ik(this.Dc),this.$.pa.Gr(this.ki),this.$.pa.My(this.Un),this.$.ea.bme(this.Jgc),
xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.ql(this.yg))}get G7a(){return this.kLc}dispose(){this.$&&xb.EwaSettings.ma(40)&&(this.$.Bl(this.Dc),this.$.pa.qt(this.ki),this.$.pa.Oz(this.Un),this.$.ea.oPf(this.Jgc),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.xn(this.yg));Mc.a.Ia(this.Kka);Mc.a.Ia(this.G7a);this.kLc=null;Mc.a.Ia(this.eN);this.eN=null;Mc.a.Ia(this.ntd);this.$=this.ntd=null;super.dispose()}Rab(){xb.EwaSettings.ma(40)&&
this.pI.Rab()}Orc(Ea,Fa,vc,rd,de,qe,bf,of,Mf,Ff,hg,xf,Df,Tf){xb.EwaSettings.ma(40)&&(this.mma=this.mma||new tc(this.$,this.pI,this.Kka),this.mma.Orc(Ea,Fa,vc,rd,de,qe,bf,of,Mf,Ff,hg,xf,Df,Tf))}UHb(Ea,Fa){xb.EwaSettings.ma(40)&&(this.xla=this.xla||new ye(this.$,this.pI,this,this.eN),this.xla.UHb(Ea,Fa))}Drc(){xb.EwaSettings.ma(40)&&(this.xla=this.xla||new ye(this.$,this.pI,this,this.eN),this.xla.Drc())}Krc(){xb.EwaSettings.ma(40)&&(this.xla=this.xla||new ye(this.$,this.pI,this,this.eN),this.xla.Krc())}BX(Ea){xb.EwaSettings.ma(40)&&
this.pI.BX(Ea)}Wbd(Ea){return xb.EwaSettings.ma(40)?this.tEe[Ea]:null}WXf(Ea){Ea&&(this.tEe[Ea.type]=Ea)}q3a(){return this.Kka.q3a()}M6g(){l.a.fp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.kLc=new Tb(this.$,this.eN))}}Object(b.a)(jc,"SessionStatisticsManager",Ub.a,[11]);var Hc=a(101),qd=a(1108),zd=a(118),Hd=a(127);class Yd{constructor(Ea,Fa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ea;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=Fa}yJj(){return id.a.Ac(this)}}Object(b.a)(Yd,"AppUnloadInfo",null,[]);var se=a(689),Re=a(120),Ye=a(558);class rf{constructor(Ea){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ea.zye+Ea.dag;this.dataLossReason=Ea.Gue;this.zSg(Ea.mYd)}zSg(Ea){const Fa=new se.a(Ye.a.YJ());let vc=0,rd=0;for(const de of Ea)Fa.lb(de)||Fa.ia(de,0),Ea=Fa.ia(de,Fa.na(de)+1),Ea>
vc&&(vc=Ea,rd=de);vc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Re.a(rd),this.mostCommonOperationCount=vc)}}Object(b.a)(rf,"DataLossInfo",null,[]);var tf=a(57);class Bf{constructor(Ea){this.MUc="AppUnloadInfo";this.vm=this.$=this.workbookHashedId=this.Oy=null;this.r0d=this.I3d=!1;this.hf=null;this.z8e=0;this.cOa=(Fa,vc)=>{this.z8e=vc.uyc};this.dDf=(Fa,vc)=>{vc.mYd.length&&this.$.aD&&(this.Oy.dataLossInfo=new rf(vc),this.Oy.wasDataLostDuringUnload=!0,this.ubb())};this.yg=()=>{this.tWf();
this.$.ea.xn(this.yg)};this.HNa=()=>{this.Oy.wasUpdatedOnBeforeUnload=!0;this.Oy.inactivityDurationBeforeUnloadSeconds=this.hf.rMb<Bf.Jyi?this.z8e:this.hf.rMb;this.vcg()};this.uEb=()=>{this.Oy.wasUpdatedOnUnload=!0;this.vcg();Sys.Application.remove_unload(this.uEb)};this.kRi=()=>{this.Oy.lastSilentReopenStartTime=Ua.a.Wa.Nb;this.Oy.lastSilentReopenEndTime=null;this.ubb();this.$.el(this.aCf)};this.aCf=()=>{this.Oy.lastSilentReopenEndTime=Ua.a.Wa.Nb;this.ubb();this.$.Cl(this.aCf)};this.localStorage=
new Id.a;this.localStorage.If()&&(this.$=Ea,this.workbookHashedId=tf.a(this.$),this.Oy=new Yd(this.workbookHashedId,this.$.ya.UserSessionId),this.vm=Hd.a.instance.XG(),this.vm.ka("beforeunload",this.HNa),this.$.userOperationManager.NGg(this.dDf),Ea.ea.Eg?this.tWf():this.$.ea.ql(this.yg),this.hf=this.$.ea.hf,this.hf.dra(this.cOa),Sys.Application.add_unload(this.uEb),this.$.ea.UTc(this.kRi))}get dialogPromptedOnUnload(){return this.I3d}set dialogPromptedOnUnload(Ea){this.I3d=Ea;this.Oy?(this.Oy.dialogPromptedOnUnload=
Ea,this.ubb()):this.localStorage.If()&&d.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.If()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.r0d}set apiBeforeCloseNotificationEnabledOnUnload(Ea){this.r0d=Ea;this.Oy?(this.Oy.apiBeforeCloseNotificationEnabledOnUnload=Ea,this.ubb()):this.localStorage.If()&&d.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.If()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.ucj(this.dDf);this.hf&&(this.hf.zPa(this.cOa),this.hf=null);this.vm.JC();this.$=this.vm=null}vcg(){this.Rsj();this.ubb()}Rsj(){this.Oy.wasOfflineDuringUnload=this.$.Rf.tZ;this.Oy.timeFromLastConnectivity=zd.a(Ua.a.Wa,this.$.Rf.Pif);this.Oy.timeFromLastDisconnectionStart=zd.a(Ua.a.Wa,this.$.Rf.upi);this.Oy.disconnectionSource=Enum.toString(qd.a,this.$.Rf.disconnectionSource);this.Oy.hadConnectivityIssuesDuringUnload=this.$.Rf.Jja;this.Oy.timeFromLastStatusCode0=
zd.a(Ua.a.Wa,this.$.Rf.Oif)}ubb(){this.Oy.timestamp=Date.now();this.localStorage.yNd(this.MUc,this.Oy.yJj())}tWf(){const Ea=this.localStorage.Eub(this.MUc);if(Ea)try{const Fa=id.a.Uh(Ea);this.localStorage.kHd(this.MUc);const vc=this.exi(Fa);d.ULS.sendTraceTag(574677456,0,50,vc)}catch(Fa){d.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Fa.message}`)}else d.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}exi(Ea){const Fa=
{};Fa.WACSessionID=Ea.wacSessionId;Fa.wasRefreshed=this.hWg(Ea,this.$.ya.MaxAppReloadDurationIndicatingRefresh);Fa.closedWithDialogConfirmation=Ea.dialogPromptedOnUnload;Fa.wasOfflineDuringUnload=Ea.wasOfflineDuringUnload;Fa.TimeFromLastConnectivityMs=Ea.timeFromLastConnectivity;Fa.TimeFromLastDisconnectionStart=Ea.timeFromLastDisconnectionStart;Fa.wasDataLostDuringUnload=Ea.wasDataLostDuringUnload;Fa.DataLossInfo=Ea.dataLossInfo;Fa.flushedOnUnload=Ea.wasUpdatedOnUnload;Fa.flushedOnBeforeUnload=Ea.wasUpdatedOnBeforeUnload;
Fa.InactivityDurationBeforeUnload=Ea.inactivityDurationBeforeUnloadSeconds;Fa.DisconnectionSource=Ea.disconnectionSource;Fa.hadConnectivityIssuesDuringUnload=Ea.hadConnectivityIssuesDuringUnload;Fa.TimeFromLastStatusCode0=Ea.timeFromLastStatusCode0;Fa.LastSilentReopenStartTime=Ea.lastSilentReopenStartTime;Fa.LastSilentReopenEndTime=Ea.lastSilentReopenEndTime;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Fa.ApiBeforeCloseNotificationEnabledOnUnload=
Ea.apiBeforeCloseNotificationEnabledOnUnload);return E.c(Fa)}hWg(Ea,Fa){const vc=window.performance.timing.navigationStart-Ea.timestamp;(Ea=this.workbookHashedId===Ea.workbookHashedId&&vc<Fa)&&d.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ea}static ka(Ea){Ea.ea.jc.inWebPart||Ea.da.Ga(410,new Bf(Ea))}}Bf.Jyi=10;Object(b.a)(Bf,"AppUnloadTelemetryManager",null,[668,3]);var Jf=a(171),Lf=a(109);class fg{constructor(Ea,Fa){this.stopped=!1;this.chainedCallsTracer=
Ea;this.glg=Fa}get call(){return this.glg}u5f(){d.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.SEj(this))}dispose(){this.u5f()}}Object(b.a)(fg,"CallMeasureContext",null,[680,3]);class Bg{constructor(Ea,Fa){this.C8c=0;this.DPe=this.startTime=Oc.HelperMethods.Tb();this._name=Ea;this.fC=Fa}get name(){return this._name}get type(){return this.fC}B1g(){this.DPe=
Oc.HelperMethods.Tb()}r5f(){this.C8c+=Oc.HelperMethods.Tb()-this.DPe}ePh(){return Oc.HelperMethods.Tb()-this.startTime}LEj(){this.r5f();return this.C8c}}Object(b.a)(Bg,"MeasuredCall",null,[]);class Sf{constructor(Ea){this.Nra=[];this.TYc=null;this.Bzi=100;this.documentVisibilityObserver=null;this.Azi=Ea}L4f(Ea,Fa){this.g7g();this.OEj();Ea=new Bg(Ea,Fa);this.Nra.push(Ea);return new fg(this,Ea)}g7g(){0<this.Nra.length?d.ULS.shipAssertTag(537151054,1,!!this.TYc,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.TYc=Jf.a.create().toString()}SEj(Ea){const Fa=this.Nra.pop();if(Ea.call!==Fa)d.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",Ea.call.name,Fa?Fa.name:"null"),this.Nra=[];else{Ea=Fa.ePh();var vc=Fa.LEj();d.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var rd=
this.documentVisibilityObserver?this.documentVisibilityObserver.kB(Ea+this.Bzi):null;this.Eti(Fa,Ea,vc,rd);this.C1g()}}OEj(){const Ea=this.UYe();Ea&&Ea.r5f()}C1g(){const Ea=this.UYe();Ea&&Ea.B1g()}UYe(){return this.Nra.length?this.Nra[this.Nra.length-1]:null}Eti(Ea,Fa,vc,rd){if(!(Fa<this.Azi)){var de=Lf.f(this.Nra,qe=>qe.name).join();d.ULS.sendTraceTag(537151051,0,50,`ChainedCallsTracer: Inclusive duration: ${Fa.toFixed(2)} Exclusive duration: ${vc.toFixed(2)} Chain ID: ${this.TYc} Call ID: ${Ea.name} Type: ${Ea.type} Document hidden: ${rd} Call chain: ${de}`)}}static ka(Ea){if(xb.EwaSettings.ma(677)){var Fa=
new Sf(Ea.ya.ChainedCallsTracerMinThresholdToLogInMs);Ea.da.Za(291,vc=>{Fa.documentVisibilityObserver=vc});Ea.da.Ga(425,Fa);Ce.a.koj(Fa)}}}Object(b.a)(Sf,"ChainedCallsTracer",null,[666]);var Ha=a(513);class Db{constructor(Ea){this.Ne=null;this.xKj=Fa=>{const vc={["TaskName"]:Fa.TN,["TotalRunInMs"]:Fa.TRT,["TotalDelayInMs"]:Fa.TDT,["TotalQueueInMs"]:Fa.TQT,["TaskPriority"]:Fa.TP,["CoauthorsCount"]:this.ea.Jm.length};Fa.TDT>this.uUd||Fa.TRT>this.sUd?d.ULS.sendTraceTag(321938518,0,15,H.a.toJSON(vc)):
(Fa.TDT>this.tUd||Fa.TRT>this.rUd)&&d.ULS.sendTraceTag(321938508,0,50,H.a.toJSON(vc))};this.Uyh=Fa=>this.Ne.kB(Fa.TRT+Fa.TQT+3E3)?!1:Fa.TDT>Math.min(this.tUd,this.uUd)||Fa.TRT>Math.min(this.rUd,this.sUd);this.uUd=Ea.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.tUd=Ea.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.sUd=Ea.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.rUd=Ea.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=Ea.ea;Ea.da.Za(291,Fa=>{this.Ne=Fa});d.ULS.sendTraceTag(537151046,
0,50,`TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = ${this.tUd}, TimeToReportOnLongWaitingTaskInMsAsWarning = ${this.uUd}, TimeToReportOnLongRunningTaskInMsAsMedium = ${this.rUd}, TimeToReportOnLongRunningTaskInMsAsWarning = ${this.sUd}`)}}Object(b.a)(Db,"TaskEventProcessor",null,[]);const zc=Ea=>{d.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");Gb.TaskExtensions.Aa(Ha.a.Sq($a.a.instance.Vb("Common.ICpuMeterProvider")),
Fa=>{d.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");Gb.TaskExtensions.Aa(Fa.result.fm.task,vc=>{d.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");const rd=new Db(Ea);vc.result.zSc(0,rd.Uyh,rd.xKj)},Ea.la,3)},Ea.la,3)};var cd=a(14);class td{constructor(Ea){this.eFe=!1;this.gFe=null;this.Uc=()=>{this.kij();ad.g(this.$).ha&&ad.g(this.$).ha.fI(this.Uc)};
this.Eh=(Fa,vc)=>{vc.oa&&!this.aUd.has(vc.oa.name)&&(this.aUd.add(vc.oa.name),ad.g(this.$).ha&&(ad.g(this.$).ha.fI(this.Uc),ad.g(this.$).ha.lE(this.Uc)))};this.$=Ea;this.T7f=new Set;this.aUd=new Set;this.$.xa&&this.$.xa.oa&&this.aUd.add(this.$.xa.oa.name);ad.g(this.$).ha.lE(this.Uc);this.$.xa.Pf(this.Eh)}dispose(){this.$=null}kij(){this.gFe||this.ISg();const Ea=ad.c(ad.g(this.$));if(!this.eFe){const Fa=cd.a.instance.Xa(280).split(",");Ea.push(...Fa);this.eFe=!0}for(const Fa of Ea)Fa&&!this.T7f.has(Fa)&&
(this.Oti(Fa),this.T7f.add(Fa))}Oti(Ea){this.ETg(Ea)}ISg(){this.gFe=td.g3a("monospace");td.g3a("sans-serif");td.g3a("serif")}ETg(Ea){td.g3a(`${Ea},${"monospace"}`);td.g3a(`${Ea},${"sans-serif"}`);td.g3a(`${Ea},${"serif"}`)}static ka(Ea){if(xb.EwaSettings.ma(62)){const Fa=new td(Ea);Ea.da.Ga(210,Fa)}}static g3a(Ea){const Fa=document.createElement("div"),vc=document.createElement("div");Fa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";td.Csj(vc,Ea);document.body.appendChild(Fa);
Fa.appendChild(vc);vc.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ea=vc.offsetWidth+"x"+vc.offsetHeight;document.body.removeChild(vc.parentNode);return Ea}static Csj(Ea,Fa){Ea.style.cssText="display: inline; visibility: hidden;";Ea.style.fontSize="100px";Ea.style.fontWeight="normal";Ea.style.fontStyle="normal";Ea.style.letterSpacing="normal";Ea.style.lineHeight="normal";Ea.style.whiteSpace="nowrap";Ea.style.fontFamily=Fa}}Object(b.a)(td,"FontTelemetryManager",
null,[3]);var Sd=a(232),oe=a(161),le;(function(Ea){Ea[Ea.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ea[Ea.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ea[Ea.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ea[Ea.invalid=3]="invalid"})(le||(le={}));Object(b.b)("RibbonMode",le);var Te=a(105);class Me extends Ce.a{constructor(){super();this.ML=!1;this.e9d=this.d9d=null;this.xyd=()=>{this.mcg()};this.wOi=()=>{Mc.a.Ia(this.pY);Mc.a.Ia(this.vm)};this.pY=Hd.a.instance.UGa();this.vm=Hd.a.instance.XG();
this.pY.ka("visibilitychange",this.xyd);this.vm.ka("pagehide",this.wOi);this.mcg()}get Ei(){return this.ML}get hif(){return this.d9d}get nhc(){return this.e9d}LXa(Ea){this.addHandler("ekdh",Ea)}yab(Ea){this.removeHandler("ekdh",Ea)}mmb(Ea){this.addHandler("ekduh",Ea)}zab(Ea){this.removeHandler("ekduh",Ea)}kB(Ea){return this.Ei?!0:this.nhc?xa.getElapsedMilliseconds(this.nhc,Ua.a.Wa.Nb)<Ea:!1}dispose(){Mc.a.Ia(this.pY);Mc.a.Ia(this.vm);super.dispose()}mcg(){this.ML="hidden"===window.document.visibilityState;
this.Ei?(this.raiseEvent("ekdh"),this.d9d=Ua.a.Wa.Nb):(this.raiseEvent("ekduh"),this.e9d=Ua.a.Wa.Nb)}}Object(b.a)(Me,"DocumentVisibilityObserver",Ce.a,[623,3]);class cf{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(b.a)(cf,"FramePerformanceData",null,[]);class Ae{constructor(Ea){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=
new cf;this.l2FramePerformanceData=new cf;this.l3FramePerformanceData=new cf;this.name=Ea}}Object(b.a)(Ae,"FramePerformanceDataGroup",null,[]);class gf{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(b.a)(gf,"FramePerformanceSessionEndsReport",null,[510]);class zf{constructor(Ea){this.TAd={};this.hga=null;this.yeb=(Fa,vc)=>{Fa.longFramesOverThresholdOps++;Fa.maxLongFrameDuration=Math.max(Fa.maxLongFrameDuration,
vc)};this.df=new gf;this.x7g();Ea.da.Za(276,()=>{ac.a(Ea).BX(this.df)})}x7g(){this.hga=new Ae("AllGridOperationsData");this.df.operationsGroups.push(this.hga);this.nqb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.nqb("DragScroll",["DragScroll"]);this.nqb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.nqb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.nqb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}bej(Ea,Fa,vc,rd){const de=this.aOh(Ea);de&&(Lf.b(this.df.operationsGroups,qe=>Va.a.equals(qe.name,de.name,!1))||this.df.operationsGroups.push(de),de.count++,this.nAc(Fa,de),this.jAc(vc,de),this.hga.count++,
this.nAc(Fa,this.hga),this.jAc(vc,this.hga),0<rd&&this.FRj(rd,de),0<=Fa&&this.ZQj(Fa,de))}hSj(){for(const Ea of this.df.operationsGroups)zf.cRj(Ea)}nqb(Ea,Fa){Ea=new Ae(Ea);for(const vc of Fa)this.TAd[vc]=Ea}aOh(Ea){return Ea in this.TAd?this.TAd[Ea]:null}ZQj(Ea,Fa){30>Ea&&this.TWd(vc=>{vc.l1FramePerformanceData.fpsUnderThresholdOps++},Fa);15>Ea&&this.TWd(vc=>{vc.l2FramePerformanceData.fpsUnderThresholdOps++},Fa);5>Ea&&this.TWd(vc=>{vc.l3FramePerformanceData.fpsUnderThresholdOps++},Fa)}FRj(Ea,Fa){100<=
Ea&&(this.zeb(Fa.l1FramePerformanceData,Ea,this.yeb),this.zeb(this.hga.l1FramePerformanceData,Ea,this.yeb));300<=Ea&&(this.zeb(Fa.l2FramePerformanceData,Ea,this.yeb),this.zeb(this.hga.l2FramePerformanceData,Ea,this.yeb));600<=Ea&&(this.zeb(Fa.l3FramePerformanceData,Ea,this.yeb),this.zeb(this.hga.l3FramePerformanceData,Ea,this.yeb))}TWd(Ea,Fa){Fa&&(Ea(Fa),Ea(this.hga))}zeb(Ea,Fa,vc){Ea&&vc(Ea,Fa)}nAc(Ea,Fa){Fa.minFPS=-1===Fa.minFPS?Ea:Math.min(Fa.minFPS,Ea)}jAc(Ea,Fa){Fa.maxFPS=Math.max(Fa.maxFPS,
Ea)}static cRj(Ea){zf.sXd(Ea.l1FramePerformanceData,Ea.count);zf.sXd(Ea.l2FramePerformanceData,Ea.count);zf.sXd(Ea.l3FramePerformanceData,Ea.count)}static sXd(Ea,Fa){Ea.fpsUnderThresholdOpsPercentage=100*Ea.fpsUnderThresholdOps/Fa;Ea.longFramesOverThresholdOpsPercentage=100*Ea.longFramesOverThresholdOps/Fa}}Object(b.a)(zf,"FramePerformanceSessionEndsReportManager",null,[]);class rg{constructor(){this.f=null}}Object(b.a)(rg,"FpsDataWrapper",null,[]);class ng{constructor(Ea=-1,Fa=-1){this.duration=
this.startSecond=0;this.startSecond=Ea;this.duration=Fa}}Object(b.a)(ng,"LongFrameData",null,[]);var Sa=a(341);class yb{constructor(Ea=null,Fa=0,vc=-1,rd=-1,de=0,qe=-1,bf=0,of=-1,Mf=-1,Ff=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=Ea;this.count=Fa;this.start=vc;this.end=rd;this.Avg=de;this.Max=qe;this.Min=Sa.a.Khg;this.longFrameCount=bf;this.coauth=of||1;this.tfAppInt=Mf;this.Props=
Ff;this.LFrame=null}}Object(b.a)(yb,"OperationFPSData",null,[]);var Zb=a(33),sc=a(787);class Fc extends Ub.a{constructor(Ea){super();this.Omb=-1;this.Qqd=0;this.Twa=new Date(0);this.QX=null;this.rha={};this.zta=new xc.a;this.nKd=this.f7a=!1;this.q2a=null;this.lyc=this.w8a=0;this.isSynthetic=!1;this.BTe=()=>{const Fa=new Date;var vc=Fa.getMinutes();const rd=Fa.getSeconds();this.qAb&&Fa.getTime()-this.qAb.getTime()>this.gIj?(this.stop(),this.t$c(Fa)):(vc!==this.Qqd&&(this.t$c(Fa),this.Qqd=vc),this.f7a&&
(this.Ne.Ei?this.QX[rd]=Fc.U4b:(this.zGe(rd),this.f7a=!1,this.zta.clear(),this.rha={})),this.QX[rd]!==Fc.U4b&&(this.QX[rd]++,vc=Fa.getTime()-this.Twa.getTime(),vc>this.Wlf&&this.mui(this.Twa,vc)),this.Omb=window.requestAnimationFrame(this.BTe),this.Twa=Fa)};this.q5=()=>{this.f7a=!0};this.Osf=()=>{this.pause()};this.Qsf=()=>{this.nKd&&this.resume()};this.Hi=()=>{this.Ea.iZ()&&this.ORj()};this.qAb=new Date;this.Ne=new Me;this.Ne.LXa(this.q5);k.AFrameworkApplication.gTc(this.Osf);k.AFrameworkApplication.hTc(this.Qsf);
this.$=Ea;this.Wlf=Ea.ya.LongFrameThresholdMs;this.Tvi="MoreThan_"+this.Wlf.toString()+"_Ms";this.fIj=Ea.ya.ThresholdToEndOperationTrackingSeconds;this.gIj=Ea.ya.ThresholdToStopFPSTrackingMS;this.Ea=ad.g(this.$).Ea;k.AFrameworkApplication.Rb&&k.AFrameworkApplication.Rb.IsSynthetic&&(this.isSynthetic=Va.a.compare(k.AFrameworkApplication.Rb[ic.a.isSynthetic],"True",!0)?!1:!0);this.Ea.ox(this.Hi);this.JJd();this.nui=this.$.Pja&&xb.EwaSettings.ma(580)}start(){this.nKd=!0;this.resume()}stop(){this.nKd=
!1;this.pause()}dispose(){this.stop();this.Ne.yab(this.q5);k.AFrameworkApplication.IOf(this.Osf);k.AFrameworkApplication.JOf(this.Qsf);Mc.a.Ia(this.Ne);this.Ea.uv(this.Hi);super.dispose()}aEj(Ea,Fa){const vc=Ea in this.rha?this.rha[Ea]:null;this.qAb=new Date;this.start();const rd=this.qAb.getSeconds(),de=rd+this.fIj;vc&&rd<=vc.end?(vc.count++,vc.end=de):(vc&&rd>vc.end&&this.zta.add(vc),this.rha[Ea]=new yb(Ea,1,rd,de,void 0,void 0,void 0,this.$.ea.Jm.length,Ra.PageLoadTrackingInfo.instance.HJa(this.qAb),
Fa))}N5g(){this.q2a||(this.t$c(new Date),this.q2a=new zf(this.$))}resume(){this.Wbf()||!this.Ea.TF||this.isSynthetic||(this.f7a=this.Ne.Ei,this.Twa=new Date,this.Qqd=this.Twa.getMinutes(),this.JJd(),this.zGe(this.Twa.getSeconds()),this.Omb=window.requestAnimationFrame(this.BTe))}Wbf(){return 0<=this.Omb}pause(){this.Wbf()&&(this.f7a||(this.AGe((new Date).getSeconds()),d.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.QX.toString()}`)),window.cancelAnimationFrame(this.Omb),this.Omb=-1)}t$c(Ea){if(Ea.getTime()-
this.Twa.getTime()<Fc.yzi&&(this.f7a&&this.AGe(this.Twa.getSeconds()),this.Kjh(),0<this.zta.count&&(Ea={},Ea.NonEmptyCellsCount=this.w8a,Ea.TextCellsCount=this.lyc,Ea.xlfpsJson=Object(wb.a)(new rg,{f:this.zta.toArray()}),Ea.memoryInfo=this.Xyi(),Ea.zoom=Zb.a(this.$)?Zb.a(this.$).zoom:1,Ea.RibbonMode=oe.a(this.$)?le[oe.a(this.$).tR]:Fc.invalid,Ea.deviceMemory=navigator.deviceMemory||0,Ea.hardwareConcurrency=navigator.hardwareConcurrency||0,Ea=JSON.stringify(Ea),d.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.QX.toString()}`),
!this.isSynthetic))){if(Ba.a.ada()){var Fa={};Fa.xlfpsJson=Ea;this.$.Bma($c.a.yXj,Fa,!1)}else d.ULS.sendTraceTag(388781010,0,50,`${Ea}`);if(this.nui)for(let vc of this.zta){Fa=1E3>=this.w8a?"0_1000":3E3>=this.w8a?"1000_3000":"3000_inf";const rd=new Map;rd.set("Operation",vc.Op);rd.set("BucketOfRenderedCells",Fa);W.Health.instance.recordKpiUsage(Za.a.longFrame,0,me.a.canvas,rd);0<vc.longFrameCount&&W.Health.instance.recordKpiFailure(Za.a.longFrame,"LongFrame",!1,!0,Object(wb.a)(new F.a,{extendedProperties:rd}));
3E4<vc.tfAppInt&&(0<vc.longFrameCount?db.b().ZQf(0,this.Tvi,rd):db.b().$Qf(0,rd))}d.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Ea.length}`)}this.reset()}Xyi(){const Ea={};if(window.performance){const Fa=window.performance.memory;Fa&&(Ea.jsHeapSizeLimit=Fa.jsHeapSizeLimit,Ea.usedJSHeapSize=Fa.usedJSHeapSize,Ea.totalJSHeapSize=Fa.totalJSHeapSize)}return Ea}reset(){this.zta.clear();this.rha={};this.JJd()}Kjh(){if(this.QX){for(const Ea of sc.a(this.rha)){const Fa=this.rha[Ea];Fa.end=
Math.min(this.QX.length-1,Fa.end);this.zta.add(Fa)}this.VSg(this.zta,this.QX)}}VSg(Ea,Fa){for(let vc of Ea){let rd=Ea=0;if(vc.end<Fa.length){for(let de=vc.start;de<=vc.end;de++){const qe=Fa[de];0<=qe&&(vc.Max=Math.round(Math.max(vc.Max,qe)),vc.Min=Math.round(Math.min(vc.Min,qe)),Ea+=qe,rd++)}0<rd&&(vc.Avg=Math.round(Ea/rd));this.q2a&&this.q2a.bej(vc.Op,vc.Min,vc.Max,vc.LFrame?vc.LFrame.duration:-1);vc.Props&&(this.SMj(vc),vc.Props=null)}}this.q2a&&this.q2a.hSj()}JJd(){this.QX=[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}zGe(Ea){Ea++;for(let Fa=0;Fa<Ea;Fa++)this.QX[Fa]=Fc.U4b}AGe(Ea){for(;60>Ea;Ea++)this.QX[Ea]=Fc.U4b}mui(Ea,Fa){Ea=Ea.getSeconds();var vc=sc.a(this.rha);if(0<vc.length)for(const rd of vc)if(vc=this.rha[rd],Ea>=vc.start&&Ea<vc.end)vc.LFrame?vc.LFrame.duration<Fa&&(vc.LFrame.startSecond=Ea,vc.LFrame.duration=Fa,vc.longFrameCount++):(vc.LFrame=new ng(Ea,Fa),vc.longFrameCount++)}ORj(){this.lyc=this.w8a=
0;for(const Ea of ad.g(this.$).sn){const Fa=Ea.mBa;for(let vc in Fa){const rd=this.Ea.tl(Fa[vc].hashCode);if(null===rd||void 0===rd?0:rd.Ck)this.w8a+=rd.he.NonEmptyCellsCount,this.lyc+=rd.he.TextValueCellsCount}}}SMj(Ea){const Fa=Ea.Props;if(va.a.DKb in Fa&&Fa[va.a.DKb]&&va.a.kMb in Fa){let vc;(vc=Object(G.a)(Sd.a,Fa[va.a.kMb]))&&vc.continueWith(rd=>{Te.TextEditorTelemetry.instance.NAg(Ea.Op,Ea.Min,!!Ea.LFrame,Ea.LFrame?Ea.LFrame.duration:0,rd.result)})}}}Fc.U4b=-1;Fc.yzi=6E4;Fc.invalid="Invalid";
Object(b.a)(Fc,"FramePerformanceTracker",Ub.a,[597,3]);class ld extends tb.a{constructor(Ea){super();this.$=Ea;this.Fb()}create(){let Ea=this.$.da.za(263);Ea||(Ea=this.$.da.Ga(263,new Fc(this.$)));this.qb(Ea)}static ka(Ea){Ea.da.Ga(264,new ld(Ea))}}Object(b.a)(ld,"FramePerformanceTrackerFactory",tb.a,[]);var Jd=a(1271),h=a(934);class Fb{Ng(Ea,Fa){return new h.a(Ea,Fa)}xc(Ea,Fa){Ea=this.Ng(Ea,Fa);Ea.start();return Ea}}Object(b.a)(Fb,"DefaultStopwatchBuilder",null,[151]);class hc{constructor(){this.hpa=
new Fb}Ng(Ea,Fa){return this.hpa.Ng(Ea,Fa)}xc(Ea,Fa){return this.hpa.xc(Ea,Fa)}}Object(b.a)(hc,"StopwatchBuilder",null,[151]);var wc=a(412),bd=a(1024),Bd=a(920),Cd;(function(Ea){Ea[Ea.actions=0]="actions";Ea[Ea.correlationStart=1]="correlationStart";Ea[Ea.reorderSheetOp=2]="reorderSheetOp";Ea[Ea.formatCellOp=3]="formatCellOp";Ea[Ea.copyOp=4]="copyOp";Ea[Ea.pasteOp=5]="pasteOp";Ea[Ea.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ea[Ea.instantaneousSetData=7]="instantaneousSetData";Ea[Ea.immediateSetData=
8]="immediateSetData";Ea[Ea.dependentCellsCalc=9]="dependentCellsCalc";Ea[Ea.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ea[Ea.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ea[Ea.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ea[Ea.gridBlockUpdates=13]="gridBlockUpdates";Ea[Ea.browserAppStart=14]="browserAppStart";Ea[Ea.linkedObjects=15]="linkedObjects";Ea[Ea.longFrames=16]="longFrames";Ea[Ea.task=17]="task";Ea[Ea.conflictInEditing=18]="conflictInEditing";
Ea[Ea.incomingPresenceData=19]="incomingPresenceData";Ea[Ea.editorTableDelay=20]="editorTableDelay";Ea[Ea.presenceStartup=21]="presenceStartup";Ea[Ea.presenceDelete=22]="presenceDelete";Ea[Ea.editorEvent=23]="editorEvent";Ea[Ea.editorTime=24]="editorTime";Ea[Ea.gridScreenReaderOps=25]="gridScreenReaderOps";Ea[Ea.sendPresenceToService=26]="sendPresenceToService";Ea[Ea.IME=27]="IME";Ea[Ea.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ea[Ea.customizeStatusBar=29]="customizeStatusBar";Ea[Ea.clientWebRequests=
30]="clientWebRequests";Ea[Ea.showCommentTaskPane=31]="showCommentTaskPane";Ea[Ea.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ea[Ea.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ea[Ea.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ea[Ea.goto=35]="goto";Ea[Ea.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";Ea[Ea.richApiInvocation=37]="richApiInvocation";Ea[Ea.fxLibrary=38]="fxLibrary";Ea[Ea.embeddedApiSession=39]="embeddedApiSession";Ea[Ea.numberFormattingCalculator=
40]="numberFormattingCalculator";Ea[Ea.requestDataAfterSend=41]="requestDataAfterSend";Ea[Ea.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ea[Ea.copy=43]="copy";Ea[Ea.paste=44]="paste";Ea[Ea.dragDrop=45]="dragDrop";Ea[Ea.clearCopyState=46]="clearCopyState";Ea[Ea.webWorkerRecalcStats=47]="webWorkerRecalcStats";Ea[Ea.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Ea[Ea.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ea[Ea.customSort=50]="customSort";
Ea[Ea.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ea[Ea.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ea[Ea.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ea[Ea.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ea[Ea.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Ea[Ea.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";Ea[Ea.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";
Ea[Ea.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Ea[Ea.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Ea[Ea.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(Cd||(Cd={}));Object(b.b)("UsageTable",Cd);var Wd=a(418),ee=a(466),He=a(594),Ga=a(643),Kb=a(267);class gc extends Sys.EventArgs{constructor(){super();this.XBi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(b.a)(gc,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Ic{constructor(Ea,
Fa=1){this.ZKd=Fa;this.total=Ea}get average(){return this.total/this.ZKd}kZg(Ea){return new Ic(this.total+Ea.total,this.ZKd+Ea.ZKd)}static ZPg(Ea,Fa){return`${Ea}_${Fa}`}}Object(b.a)(Ic,"StopwatchAverage",null,[]);var Nc;(function(Ea){Ea[Ea.longFrame=0]="longFrame";Ea[Ea.longGetRange=1]="longGetRange";Ea[Ea.longJsTask=2]="longJsTask";Ea[Ea.viewportCalculationLoops=3]="viewportCalculationLoops"})(Nc||(Nc={}));Object(b.b)("UtrKpiVeto",Nc);class nd{static M3a(Ea){return Enum.toString(Nc,Ea)}}nd.kTa=
"UTR";Object(b.a)(nd,"KpiConstants",null,[]);class Ud{}Ud.geg="UTRVetoName";Ud.Zdg="UTRErrorName";Ud.sUj="UTROperationName";Ud.rYd="UTRDuration";Ud.tUj="UTREndedInPhase";Ud.deg="UTRMessage";Ud.feg="UtrUnavailabilityType";Ud.operationName="OperationName";Ud.duration="Duration";Ud.message="Message";Object(b.a)(Ud,"UtrAdditionalData",null,[]);class ke{}ke.yVj="VetoLike";ke.Mhh="E2EOperationPerf";ke.Gej="RequestPerf";ke.LNj="UnavailabilityDurations";Object(b.a)(ke,"UtrTypes",null,[]);class Nd{THb(Ea,
Fa,vc=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(vc=vc?Object(wb.a)(new F.a,{extendedProperties:vc}):null,Ea=nd.M3a(Ea),W.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ea,Fa,!1,!0,"",vc))}uJb(Ea,Fa,vc,rd,de,qe){qe[nd.kTa]=ke.yVj;qe[Ud.geg]=nd.M3a(rd);qe[Ud.Zdg]=de;d.ULS.sendTraceTag(Ea,Fa,vc,id.a.Ac(qe));delete qe[nd.kTa];delete qe[Ud.geg];delete qe[Ud.Zdg]}}Object(b.a)(Nd,"UtrKpiVetoReporter",null,[]);class ve{kJd(Ea,Fa=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
W.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+nd.M3a(Ea),0,"",Fa)}THb(Ea,Fa,vc=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ea=nd.M3a(Ea),W.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ea,Fa,!1,!0,this.A1c(vc)))}Rdj(Ea,Fa=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||W.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+nd.M3a(Ea),"",this.A1c(Fa))}Qdj(Ea,Fa,vc=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ea=nd.M3a(Ea),W.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ea,Fa,!1,!0,"",this.A1c(vc)))}A1c(Ea){return Ea?Object(wb.a)(new F.a,{extendedProperties:Ea}):null}}Object(b.a)(ve,"UtrKpiVetoUsageReporter",null,[]);class Oe{Erc(Ea,Fa,vc=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||W.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ea,"",Object(wb.a)(new F.a,{extendedProperties:vc,durationMs:Fa}))}Lrc(Ea,Fa,vc=null){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Fa?W.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Ea,"",Object(wb.a)(new F.a,{extendedProperties:vc})):W.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ea,"",!1,!1,"",Object(wb.a)(new F.a,{extendedProperties:vc})))}rJb(Ea,Fa,vc,rd,de,qe,bf,...of){bf=String.format(bf,...of);of={};of[nd.kTa]=ke.Mhh;of[Ud.sUj]=rd;of[Ud.tUj]=de;of[Ud.rYd]=qe;of[Ud.deg]=bf;d.ULS.sendTraceTag(Ea,Fa,vc,id.a.Ac(of))}tJb(Ea,Fa,vc,rd,de,qe){this.h_f(qe,rd,de);d.ULS.sendTraceTag(Ea,Fa,vc,id.a.Ac(qe));
this.Ich(qe)}sJb(Ea,Fa,vc,rd,de,qe,...bf){qe=String.format(qe,...bf);bf={};this.h_f(bf,rd,de,qe);d.ULS.sendTraceTag(Ea,Fa,vc,id.a.Ac(bf))}Mtc(Ea,Fa,vc,rd){rd[nd.kTa]=ke.Gej;d.ULS.sendTraceTag(Ea,Fa,vc,id.a.Ac(rd));delete rd[nd.kTa]}h_f(Ea,Fa,vc,rd=null){Ea[nd.kTa]=ke.LNj;Ea[Ud.feg]=Fa;Ea[Ud.rYd]=vc;rd&&(Ea[Ud.deg]=rd)}Ich(Ea){delete Ea[nd.kTa];delete Ea[Ud.feg];delete Ea[Ud.rYd]}}Object(b.a)(Oe,"UtrOperationPerfReporter",null,[]);class ze extends Ce.a{constructor(Ea,Fa=null,vc=null,rd=null,de=null,
qe=!1){super();this.Svh=[va.a.Jse,va.a.cLe,va.a.dLe,va.a.Wcc,va.a.jic,va.a.bkf,va.a.renderCachedContent,va.a.renderServerContent,va.a.i3b,va.a.ojj,va.a.JUf,va.a.KUf,va.a.Vmj];this.fkb=this.lCa=this.LNb=this.Jeb=this.j$d=this.Pre=this.bWa=this.cge=null;this.oFf=this.Hse=!1;this.ceg=this.beg=this.eeg=this.vJd=this.mfg=null;this.tAf=(bf,of)=>{for(bf=0;bf<of.entries.length;bf++){const xf=of.entries[bf];xf.url=w.a.removeParameter(xf.url,k.AFrameworkApplication.ZO);var Mf=w.a.Aca(xf.url);!xb.EwaSettings.ma(489)&&
this.zki(xf.url,Mf)&&(xf.behavior=1);if("img"===xf.yt.initiatorType&&Mf.endsWith(bd.a.pIe)){var Ff=w.a.RY(xf.url,bd.a.oIe),hg=w.a.RY(xf.url,bd.a.qIe);xf.h$=`${xf.h$}imageID=${Ff}, imgStateID=${hg}`}Ff=xf.yt.transferSize;let Df;hg=xf.yt.decodedBodySize;void 0!==Ff&&null!==Ff&&void 0!==hg&&null!==hg?Df=0===Ff&&0<hg:void 0!==Ff&&null!==Ff&&(Df=0===Ff);Ra.PageLoadTrackingInfo.instance.RBg(Mf,Math.round(xf.yt.fetchStart),Math.round(xf.yt.responseEnd),Df,this.Yli);Va.a.contains(Mf,va.a.richTextEditor,!0)&&
(Mf=Te.TextEditorTelemetry.instance,Mf.jE(va.a.fgj,Math.round(xf.yt.fetchStart)),Mf.jE(va.a.hgj,Math.round(xf.yt.responseEnd)))}};this.q5=()=>{const bf=this.Q6;for(let of in bf)bf[of].h=!0};this.userSessionId=Ea;this.O_a=Fa=Fa||new He.a;this.yh=vc||Ua.a.Wa;this.ZEj=rd||this;this.Ne=de;this.Yli=qe;this.$Ee=Fa.S7a();this.Ne&&this.Ne.LXa(this.q5)}get Q6(){return this.cge||(this.cge={})}get iEe(){return this.Jeb||this.$Ee}get pEe(){return this.lCa||ze.Rqf}get NSd(){return this.Pre=this.Pre||{}}get Xnc(){return this.bWa||
"undefined"===typeof Stw?this.bWa:this.bWa=Stw.swpc}get Tlf(){return this.j$d=this.j$d||{}}get MPa(){return this.fkb||(this.fkb=$a.a.instance.Vb("Common.NetworkTiming.IResourceTimingLogger"))}get aeg(){return this.beg||(this.beg=new Nd)}get Oeb(){return this.eeg||(this.eeg=new Oe)}get UAc(){return this.ceg||(this.ceg=new ve)}uSd(Ea,Fa,vc){this.ALb(Ea,Fa,vc,Ua.a.FBb(Ua.a.Wa.Nb.getTime()))}ALb(Ea,Fa,vc,rd,de=null){if(this.Q6[vc])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.Q6[vc]=this.DDe(Ea,Fa,vc,rd,de)}C6c(Ea){this.Yrb(Ea,Ua.a.FBb(Ua.a.Wa.Nb.getTime()))}Yrb(Ea,Fa){const vc=this.Q6[Ea];vc&&(this.Fze(vc,Fa),this.CPj(vc),delete this.Q6[Ea])}vOf(Ea){delete this.Q6[Ea]}Y4f(Ea,Fa){this.Jeb||this.N4f(Ea,Fa)}I4f(){this.Y4f(ze.$fd,this.yh.je)}QJe(Ea,Fa=!1){if(this.Jeb){if(this.lCa===ze.lBd||this.lCa===ze.$fd){const vc=y.a.instance;vc.userSessionId=this.userSessionId;if(this.lCa===ze.lBd){this.Hse||(this.ska(Ea.m,Object(X.a)(vc,vc.x5i,"recordContentFetchEnd")),this.Hse=
!0);if(Fa){this.oFf||(this.ska(Ea.m,Object(X.a)(vc,vc.L5i,"recordPerceivedContentDisplayed")),this.oFf=!0);return}this.ska(Ea.m,Object(X.a)(vc,vc.w5i,"recordContentDisplayed"))}else this.lCa===ze.$fd&&(Fa=this.Q6[this.LNb])&&this.ska(Kb.a(Ea,Fa.s),Object(X.a)(vc,vc.I5i,"recordInteractivityContentDisplayed"),!1)}this.Yrb(this.LNb,Ea);this.LNb=this.lCa=this.Jeb=null}}ska(Ea,Fa,vc=!0){y.a.lP&&Object(wc.a)(Ga.PerformanceClock,Ua.a.Wa)&&vc&&(Ea+=window.performance.timing.navigationStart);Fa(Ea)}mj(Ea){return Wd.a(Ea)}Ie(Ea,
Fa,vc=!1){try{if(this.Tlf[Cd[Ea]]=!0,vc){var rd=d.ULS,de=rd.sendTraceTag;const Pc={};let Ef=null;switch(Ea){case 0:Ef="Actions";var qe=Fa.a;null!=qe&&(Pc.Id=qe);var bf=null==Fa.b?null:Fa.b;null!=bf&&(Pc.Operation=bf);var of=Fa.c;null!=of&&(Pc.Target=of);var Mf=null==Fa.d?null:Fa.d.toString();null!=Mf&&(Pc.StartTime=Mf);var Ff=null==Fa.e?null:Fa.e.toString();null!=Ff&&(Pc.Duration=Ff);var hg=Fa.f;null!=hg&&(Pc.CorrelationId=hg);var xf=Fa.g;null!=xf&&(Pc.ParentAction=xf);var Df=null==Fa.h?null:Fa.h.toString();
null!=Df&&(Pc.DocumentHidden=Df);break;case 1:Ef="CorrelationStart";var Tf=Fa.a;null!=Tf&&(Pc.CorrelationId=Tf);var Pg=Fa.b;null!=Pg&&(Pc.UserSessionId=Pg);var ig=Fa.c;null!=ig&&(Pc.UserAction=ig);break;case 2:Ef="ReorderSheetOp";var ag=Fa.a;null!=ag&&(Pc.UserSessionId=ag);var eh=null==Fa.b?null:Fa.b.toString();null!=eh&&(Pc.IsDragReorder=eh);var xg=null==Fa.c?null:Fa.c.toString();null!=xg&&(Pc.DocumentUp=xg);var fh=null==Fa.d?null:Fa.d.toString();null!=fh&&(Pc.OldIndex=fh);var gh=null==Fa.e?null:
Fa.e.toString();null!=gh&&(Pc.NewIndex=gh);var $g=null==Fa.f?null:Fa.f.toString();null!=$g&&(Pc.TotalSheets=$g);break;case 3:Ef="FormatCellOp";var Sg=Fa.a;null!=Sg&&(Pc.UserSessionId=Sg);var gg=null==Fa.b?null:Fa.b.toString();null!=gg&&(Pc.TaskId=gg);var yg=null==Fa.c?null:Fa.c.toString();null!=yg&&(Pc.NumberOfRanges=yg);var ah=Fa.d;null!=ah&&(Pc.Ranges=ah);var ff=Fa.e;null!=ff&&(Pc.ActiveCell=ff);var ia=null==Fa.f?null:Fa.f.toString();null!=ia&&(Pc.ActionId=ia);var Hb=Fa.g;null!=Hb&&(Pc.CommandParameters=
Hb);var Vb=Fa.h;null!=Vb&&(Pc.UserActionStopwatchId=Vb);break;case 4:Ef="CopyOp";var Ac=Fa.a;null!=Ac&&(Pc.UserSessionId=Ac);var vd=null==Fa.b?null:Fa.b.toString();null!=vd&&(Pc.IsChrome=vd);var Td=null==Fa.c?null:Fa.c.toString();null!=Td&&(Pc.IsIE=Td);var fe=null==Fa.d?null:Fa.d.toString();null!=fe&&(Pc.IsFromUI=fe);var Ee=null==Fa.e?null:Fa.e.toString();null!=Ee&&(Pc.IsCopyInLoadedRange=Ee);var kf=null==Fa.f?null:Fa.f.toString();null!=kf&&(Pc.IsRepeatedCopy=kf);var lf=null==Fa.g?null:Fa.g.toString();
null!=lf&&(Pc.IsClipboarAccessSupported=lf);var ca=null==Fa.h?null:Fa.h.toString();null!=ca&&(Pc.IsClipboarAccessInstallationSupported=ca);var Xa=null==Fa.i?null:Fa.i.toString();null!=Xa&&(Pc.RibbonCommand=Xa);var C=null==Fa.j?null:Fa.j.toString();null!=C&&(Pc.CutCopyPasteFlags=C);var Y=null==Fa.k?null:Fa.k.toString();null!=Y&&(Pc.IsDrag=Y);var Ia=null==Fa.l?null:Fa.l.toString();null!=Ia&&(Pc.IsIeBeforeAlowDenyPopUp=Ia);var zb=Fa.m;null!=zb&&(Pc.IsPasteMatchCopy=zb);var nc=Fa.n;null!=nc&&(Pc.WaitMessageInClipboard=
nc);var kc=null==Fa.o?null:Fa.o.toString();null!=kc&&(Pc.CallCount=kc);break;case 5:Ef="PasteOp";var fc=Fa.a;null!=fc&&(Pc.UserSessionId=fc);var Zc=null==Fa.b?null:Fa.b.toString();null!=Zc&&(Pc.IsChrome=Zc);var od=null==Fa.c?null:Fa.c.toString();null!=od&&(Pc.IsIE=od);var pd=null==Fa.d?null:Fa.d.toString();null!=pd&&(Pc.IsCopyActive=pd);var Ld=null==Fa.e?null:Fa.e.toString();null!=Ld&&(Pc.IsFromUI=Ld);var be=null==Fa.f?null:Fa.f.toString();null!=be&&(Pc.IsClipboarAccessSupported=be);var De=null==
Fa.g?null:Fa.g.toString();null!=De&&(Pc.IsClipboarAccessInstallationSupported=De);var xe=null==Fa.h?null:Fa.h.toString();null!=xe&&(Pc.RibbonCommand=xe);var Fe=null==Fa.i?null:Fa.i.toString();null!=Fe&&(Pc.CutCopyPasteFlags=Fe);var Ue=Fa.j;null!=Ue&&(Pc.WaitMessageInClipboard=Ue);var af=Fa.k;null!=af&&(Pc.PopupDialog=af);var hf=Fa.l;null!=hf&&(Pc.SimplePopupMessage=hf);var pf=Fa.m;null!=pf&&(Pc.DialogCloseButton=pf);var mf=Fa.n;null!=mf&&(Pc.UserPressedInstallLink=mf);var Nf=null==Fa.o?null:Fa.o.toString();
null!=Nf&&(Pc.CallCount=Nf);break;case 6:Ef="GetNumberViewModelDataOp";var wf=Fa.a;null!=wf&&(Pc.UserSessionId=wf);var vg=Fa.b;null!=vg&&(Pc.NumberFormatOptionsPreviousOutputJson=vg);var ug=Fa.c;null!=ug&&(Pc.NumberFormatOptionsNewInputJson=ug);break;case 7:Ef="InstantaneousSetData";var Qg=Fa.a;null!=Qg&&(Pc.Id=Qg);var lh=null==Fa.b?null:Fa.b.toString();null!=lh&&(Pc.WasEmpty=lh);var Gf=null==Fa.c?null:Fa.c.toString();null!=Gf&&(Pc.ValueNotChanged=Gf);var Hg=Fa.d;null!=Hg&&(Pc.Source=Hg);var qf=null==
Fa.e?null:Fa.e.toString();null!=qf&&(Pc.ProcessingCompleted=qf);break;case 8:Ef="ImmediateSetData";var Ig=Fa.a;null!=Ig&&(Pc.ClientStopwatchId=Ig);var zh=Fa.b;null!=zh&&(Pc.Operation=zh);var Vi=Fa.c;null!=Vi&&(Pc.Parameters=Vi);var Nh=null==Fa.d?null:Fa.d.toString();null!=Nh&&(Pc.WasUpdatedByImmediate=Nh);var hi=null==Fa.e?null:Fa.e.toString();null!=hi&&(Pc.areHtmlElementsEqualClientComparison=hi);var Hh=null==Fa.f?null:Fa.f.toString();null!=Hh&&(Pc.WasDecisionMadeByHtmlComparison=Hh);var zg=null==
Fa.g?null:Fa.g.toString();null!=zg&&(Pc.IsNumeric=zg);var sh=null==Fa.h?null:Fa.h.toString();null!=sh&&(Pc.IsDateTime=sh);var vi=null==Fa.i?null:Fa.i.toString();null!=vi&&(Pc.HasCurrencySymbol=vi);var wi=null==Fa.j?null:Fa.j.toString();null!=wi&&(Pc.HasPercentSymbol=wi);var Wi=null==Fa.k?null:Fa.k.toString();null!=Wi&&(Pc.IsFunc=Wi);var Xi=null==Fa.l?null:Fa.l.toString();null!=Xi&&(Pc.DiffInWrappingWhitespace=Xi);var Li=Fa.m;null!=Li&&(Pc.ImmediatePattern=Li);var xi=null==Fa.n?null:Fa.n.toString();
null!=xi&&(Pc.TextAlignmentMatch=xi);var yi=null==Fa.o?null:Fa.o.toString();null!=yi&&(Pc.FontColorMatch=yi);var zi=null==Fa.p?null:Fa.p.toString();null!=zi&&(Pc.FormulaTextMatch=zi);var Oh=null==Fa.q?null:Fa.q.toString();null!=Oh&&(Pc.isFormula=Oh);var Ph=Fa.r;null!=Ph&&(Pc.FormulaText=Ph);var Qh=Fa.s;null!=Qh&&(Pc.InstantaneousPattern=Qh);var Yi=null==Fa.t?null:Fa.t.toString();null!=Yi&&(Pc.AreHtmlInnerTextElementsEqualClientComparison=Yi);var Zi=Fa.u;null!=Zi&&(Pc.HtmlComparisonDecision=Zi);break;
case 9:Ef="DependentCellsCalc";var Bh=Fa.a;null!=Bh&&(Pc.CalcStatus=Bh);var Vg=null==Fa.b?null:Fa.b.toString();null!=Vg&&(Pc.SuccessfullyCalculatedRanges=Vg);var Jg=null==Fa.c?null:Fa.c.toString();null!=Jg&&(Pc.RangesSkipped=Jg);var Rh=null==Fa.d?null:Fa.d.toString();null!=Rh&&(Pc.TotalErrors=Rh);var vh=null==Fa.e?null:Fa.e.toString();null!=vh&&(Pc.Partial=vh);var Mi=null==Fa.f?null:Fa.f.toString();null!=Mi&&(Pc.Canceled=Mi);var hh=null==Fa.g?null:Fa.g.toString();null!=hh&&(Pc.Aggregate=hh);var Ai=
null==Fa.h?null:Fa.h.toString();null!=Ai&&(Pc.Unknown=Ai);var ih=null==Fa.i?null:Fa.i.toString();null!=ih&&(Pc.UnavailableData=ih);var Vc=null==Fa.j?null:Fa.j.toString();null!=Vc&&(Pc.Cycle=Vc);var Fd=null==Fa.k?null:Fa.k.toString();null!=Fd&&(Pc.NotImplemented=Fd);var Lg=null==Fa.l?null:Fa.l.toString();null!=Lg&&(Pc.InvalidInput=Lg);var Bi=null==Fa.m?null:Fa.m.toString();null!=Bi&&(Pc.AreDepCells=Bi);break;case 10:Ef="DependentCellsGraphStat";var Ih=null==Fa.a?null:Fa.a.toString();null!=Ih&&(Pc.ParsedFormulas=
Ih);var Ci=null==Fa.b?null:Fa.b.toString();null!=Ci&&(Pc.GraphNodes=Ci);var Ni=null==Fa.c?null:Fa.c.toString();null!=Ni&&(Pc.GraphArcs=Ni);var Sh=null==Fa.d?null:Fa.d.toString();null!=Sh&&(Pc.AnalyzedBlocks=Sh);var Oi=null==Fa.e?null:Fa.e.toString();null!=Oi&&(Pc.IterationId=Oi);var Di=Fa.f;null!=Di&&(Pc.UniqueId=Di);var wg=null==Fa.g?null:Fa.g.toString();null!=wg&&(Pc.Aborted=wg);break;case 11:Ef="DependentCellsGraphSectionStat";var Ei=null==Fa.a?null:Fa.a.toString();null!=Ei&&(Pc.IterationId=Ei);
var Pi=Fa.b;null!=Pi&&(Pc.BlockHash=Pi);var Qi=Fa.c;null!=Qi&&(Pc.Functions=Qi);var Jh=Fa.d;null!=Jh&&(Pc.Operators=Jh);var ii=null==Fa.e?null:Fa.e.toString();null!=ii&&(Pc.CrossDocRefs=ii);var Kh=null==Fa.f?null:Fa.f.toString();null!=Kh&&(Pc.CrossSheetRefs=Kh);var kg=null==Fa.g?null:Fa.g.toString();null!=kg&&(Pc.ErrRefs=kg);var Ch=null==Fa.h?null:Fa.h.toString();null!=Ch&&(Pc.LargeRanges=Ch);var Th=null==Fa.i?null:Fa.i.toString();null!=Th&&(Pc.NameRefs=Th);var Wg=null==Fa.j?null:Fa.j.toString();
null!=Wg&&(Pc.ParserErrors=Wg);var Ah=null==Fa.k?null:Fa.k.toString();null!=Ah&&(Pc.RowRefs=Ah);var Uh=null==Fa.l?null:Fa.l.toString();null!=Uh&&(Pc.ColumnRefs=Uh);var wh=null==Fa.m?null:Fa.m.toString();null!=wh&&(Pc.TableRefs=wh);var th=Fa.n;null!=th&&(Pc.UniqueId=th);var $e=null==Fa.o?null:Fa.o.toString();null!=$e&&(Pc.UnreachableReferences=$e);break;case 12:Ef="GetRangeContentPrefetchFailures";var Mg=Fa.a;null!=Mg&&(Pc.UserSessionId=Mg);var bh=Fa.b;null!=bh&&(Pc.ClientStopwatchId=bh);var Cg=null==
Fa.c?null:Fa.c.toString();null!=Cg&&(Pc.StateId=Cg);break;case 13:Ef="GridBlockUpdates";var Tg=Fa.a;null!=Tg&&(Pc.UserSessionId=Tg);var Fi=Fa.b;null!=Fi&&(Pc.CorrelationId=Fi);var ji=Fa.c;null!=ji&&(Pc.Operation=ji);var Dg=null==Fa.d?null:Fa.d.toString();null!=Dg&&(Pc.PerformanceType=Dg);var Gi=Fa.e;null!=Gi&&(Pc.BlockHash=Gi);var Vh=null==Fa.f?null:Fa.f.toString();null!=Vh&&(Pc.DurationInMs=Vh);break;case 14:Ef="BrowserAppStart";var Dh=null==Fa.a?null:Bd.a.rsa(Fa.a.getTime());null!=Dh&&(Pc.ScriptExecutionStart=
Dh);var ki=Fa.b;null!=ki&&(Pc.UserSessionId=ki);var li=Fa.c;null!=li&&(Pc.ClockMechanism=li);var Hi=null==Fa.d?null:Fa.d.toString();null!=Hi&&(Pc.ScreenDPI=Hi);var Ii=null==Fa.e?null:Fa.e.toString();null!=Ii&&(Pc.NavigationToScriptExecutionDelta=Ii);break;case 15:Ef="LinkedObjects";var Eg=Fa.a;null!=Eg&&(Pc.ChildId=Eg);var Ji=Fa.b;null!=Ji&&(Pc.ParentId=Ji);var Xg=Fa.c;null!=Xg&&(Pc.ChildTable=Xg);var Eh=Fa.d;null!=Eh&&(Pc.ParentTable=Eh);break;case 16:Ef="LongFrames";var $i=null==Fa.a?null:Bd.a.rsa(Fa.a.getTime());
null!=$i&&(Pc.StartTime=$i);var Ug=null==Fa.b?null:Fa.b.toString();null!=Ug&&(Pc.DurationInMs=Ug);break;case 17:Ef="Task";var Wh=Fa.a;null!=Wh&&(Pc.StopwatchId=Wh);var mi=null==Fa.b?null:Fa.b.toString();null!=mi&&(Pc.Status=mi);var Lh=null==Fa.c?null:Fa.c.toString();null!=Lh&&(Pc.CreateTime=Lh);var Xh=null==Fa.d?null:Fa.d.toString();null!=Xh&&(Pc.TaskId=Xh);break;case 18:Ef="ConflictInEditing";var Ti=Fa.a;null!=Ti&&(Pc.OtherUserState=Ti);var Pf=Fa.b;null!=Pf&&(Pc.UserSessionId=Pf);var ni=null==Fa.c?
null:Bd.a.rsa(Fa.c.getTime());null!=ni&&(Pc.ConflictTime=ni);break;case 19:Ef="IncomingPresenceData";var aj=Fa.a;null!=aj&&(Pc.UserSessionId=aj);var pg=Fa.b;null!=pg&&(Pc.UserId=pg);var Yh=null==Fa.c?null:Fa.c.toString();null!=Yh&&(Pc.Disconnected=Yh);var jh=null==Fa.d?null:Bd.a.rsa(Fa.d.getTime());null!=jh&&(Pc.ReceivedTime=jh);break;case 20:Ef="EditorTableDelay";var Ui=Fa.a;null!=Ui&&(Pc.UserSessionId=Ui);var oi=Fa.b;null!=oi&&(Pc.UserId=oi);var Fg=null==Fa.c?null:Fa.c.toString();null!=Fg&&(Pc.Received=
Fg);var bj=null==Fa.d?null:Fa.d.toString();null!=bj&&(Pc.DurationInMs=bj);var Zh=null==Fa.e?null:Fa.e.toString();null!=Zh&&(Pc.NotAloneAtLogTime=Zh);var ph=null==Fa.f?null:Bd.a.rsa(Fa.f.getTime());null!=ph&&(Pc.Time=ph);break;case 21:Ef="PresenceStartup";var pi=Fa.a;null!=pi&&(Pc.UserSessionId=pi);var yf=null==Fa.b?null:Fa.b.toString();null!=yf&&(Pc.EverReceived=yf);var $h=null==Fa.c?null:Fa.c.toString();null!=$h&&(Pc.NotAloneOnOpen=$h);var Ki=null==Fa.d?null:Fa.d.toString();null!=Ki&&(Pc.NotAloneAtLogTime=
Ki);var qh=null==Fa.e?null:Fa.e.toString();null!=qh&&(Pc.EditorCount=qh);var qi=null==Fa.f?null:Fa.f.toString();null!=qi&&(Pc.WorkbookOpenToFirstReceivedInMs=qi);break;case 22:Ef="PresenceDelete";var ai=Fa.a;null!=ai&&(Pc.UserSessionId=ai);var dg=Fa.b;null!=dg&&(Pc.UserId=dg);var ri=Fa.c;null!=ri&&(Pc.Context=ri);var xh=Fa.d;null!=xh&&(Pc.Reason=xh);var si=null==Fa.e?null:Bd.a.rsa(Fa.e.getTime());null!=si&&(Pc.Time=si);break;case 23:Ef="EditorEvent";var bi=Fa.a;null!=bi&&(Pc.UserSessionId=bi);var ci=
Fa.b;null!=ci&&(Pc.UserId=ci);var ti=Fa.c;null!=ti&&(Pc.Context=ti);var di=null==Fa.d?null:Bd.a.rsa(Fa.d.getTime());null!=di&&(Pc.Time=di);break;case 24:Ef="EditorTime";var Mh=Fa.a;null!=Mh&&(Pc.UserSessionId=Mh);var Q=Fa.b;null!=Q&&(Pc.UserId=Q);var La=null==Fa.c?null:Fa.c.toString();null!=La&&(Pc.DurationInMs=La);break;case 25:Ef="GridScreenReaderOps";var kb=Fa.a;null!=kb&&(Pc.UserSessionId=kb);var Wb=Fa.b;null!=Wb&&(Pc.CommandTaskId=Wb);var oc=null==Fa.c?null:Fa.c.toString();null!=oc&&(Pc.CommandId=
oc);var Kc=null==Fa.d?null:Fa.d.toString();null!=Kc&&(Pc.ClientSideOnly=Kc);var Cc=null==Fa.e?null:Fa.e.toString();null!=Cc&&(Pc.DurationInMS=Cc);var Bc=null==Fa.f?null:Fa.f.toString();null!=Bc&&(Pc.ReachedMaxReadoutCells=Bc);var qc=null==Fa.g?null:Fa.g.toString();null!=qc&&(Pc.RequstedCellCount=qc);var Sc=null==Fa.h?null:Fa.h.toString();null!=Sc&&(Pc.NonEmptyCellCount=Sc);var Xc=null==Fa.i?null:Fa.i.toString();null!=Xc&&(Pc.Succeeded=Xc);var jd=null==Fa.j?null:Fa.j.toString();null!=jd&&(Pc.Canceled=
jd);var Rd=Fa.k;null!=Rd&&(Pc.ErrorType=Rd);break;case 26:Ef="SendPresenceToService";var ce=Fa.a;null!=ce&&(Pc.UserSessionId=ce);var we=null==Fa.b?null:Fa.b.toString();null!=we&&(Pc.TotalCount=we);var Be=null==Fa.c?null:Fa.c.toString();null!=Be&&(Pc.SendCount=Be);break;case 27:Ef="IME";var Ie=Fa.a;null!=Ie&&(Pc.UserSessionId=Ie);break;case 28:Ef="FreezePaneFloatingObjects";var Cf=Fa.a;null!=Cf&&(Pc.UserSessionId=Cf);var Hf=null==Fa.b?null:Fa.b.toString();null!=Hf&&(Pc.ObjectType=Hf);var Ve=Fa.c;null!=
Ve&&(Pc.ObjectID=Ve);var jg=null==Fa.d?null:Fa.d.toString();null!=jg&&(Pc.SpannedPanesCount=jg);break;case 29:Ef="CustomizeStatusBar";var Zf=Fa.a;null!=Zf&&(Pc.UserSessionId=Zf);var Qf=Fa.b;null!=Qf&&(Pc.UIControlName=Qf);var sg=null==Fa.c?null:Fa.c.toString();null!=sg&&(Pc.IsControlVisible=sg);break;case 30:Ef="ClientWebRequests";var Ag=Fa.a;null!=Ag&&(Pc.Path=Ag);var Yg=Fa.b;null!=Yg&&(Pc.ProxyStopwatchId=Yg);var rh=Fa.c;null!=rh&&(Pc.RequestStatus=rh);var Af=null==Fa.d?null:Fa.d.toString();null!=
Af&&(Pc.ResponseSizeInBytes=Af);var We=Fa.e;null!=We&&(Pc.ClientRequestId=We);var vf=null==Fa.f?null:Fa.f.toString();null!=vf&&(Pc.StateId=vf);break;case 31:Ef="ShowCommentTaskPane";var Kf=Fa.a;null!=Kf&&(Pc.UserSessionId=Kf);var qg=null==Fa.b?null:Fa.b.toString();null!=qg&&(Pc.IsFromKeyboardShortcut=qg);var eg=null==Fa.c?null:Fa.c.toString();null!=eg&&(Pc.IsShowPane=eg);var Uf=null==Fa.d?null:Fa.d.toString();null!=Uf&&(Pc.ShowForDeepLink=Uf);var Rf=null==Fa.e?null:Fa.e.toString();null!=Rf&&(Pc.DeepLinkFound=
Rf);break;case 32:Ef="ApplyThreadedCommentChange";var If=Fa.a;null!=If&&(Pc.UserSessionId=If);var Vf=null==Fa.b?null:Fa.b.toString();null!=Vf&&(Pc.Operation=Vf);var tg=Fa.c;null!=tg&&(Pc.CommentId=tg);var ch=null==Fa.d?null:Fa.d.toString();null!=ch&&(Pc.CommentsCount=ch);break;case 33:Ef="UpgradeLegacyCommentsChange";var Wf=Fa.a;null!=Wf&&(Pc.UserSessionId=Wf);var kh=null==Fa.b?null:Fa.b.toString();null!=kh&&(Pc.OperationSuccessful=kh);break;case 34:Ef="FindNextOrPreviousComment";var ui=Fa.a;null!=
ui&&(Pc.UserSessionId=ui);var cj=null==Fa.b?null:Fa.b.toString();null!=cj&&(Pc.Succeeded=cj);break;case 35:Ef="Goto";var ei=Fa.a;null!=ei&&(Pc.UserSessionId=ei);var Yf=null==Fa.b?null:Fa.b.toString();null!=Yf&&(Pc.IsSucceeded=Yf);var Rg=null==Fa.c?null:Fa.c.toString();null!=Rg&&(Pc.IsNOVMode=Rg);break;case 36:Ef="LaunchOfficeAddInDialog";var Zg=Fa.a;null!=Zg&&(Pc.UserSessionId=Zg);var Xf=Fa.b;null!=Xf&&(Pc.SourceId=Xf);var Gg=Fa.c;null!=Gg&&(Pc.SourceLabel=Gg);var dh=Fa.d;null!=dh&&(Pc.Flight=dh);
var yh=Fa.e;null!=yh&&(Pc.Experiment=yh);var Fh=Fa.f;null!=Fh&&(Pc.UICultureTag=Fh);var fi=null==Fa.g?null:Fa.g.toString();null!=fi&&(Pc.UICultureTagLcid=fi);var dj=null==Fa.h?null:Fa.h.toString();null!=dj&&(Pc.WacHostId=dj);break;case 37:Ef="RichApiInvocation";var gj=Fa.a;null!=gj&&(Pc.UserSessionId=gj);var mj=null==Fa.b?null:Fa.b.toString();null!=mj&&(Pc.Succeeded=mj);var hj=Fa.c;null!=hj&&(Pc.ErrorType=hj);var nj=Fa.d;null!=nj&&(Pc.ResultInfo=nj);var ij=Fa.e;null!=ij&&(Pc.Source=ij);break;case 38:Ef=
"FxLibrary";var jj=Fa.a;null!=jj&&(Pc.EntityName=jj);var kj=null==Fa.b?null:Fa.b.toString();null!=kj&&(Pc.EntryPoint=kj);var oj=null==Fa.c?null:Fa.c.toString();null!=oj&&(Pc.Action=oj);var lj=null==Fa.d?null:Fa.d.toString();null!=lj&&(Pc.InsertLocation=lj);break;case 39:Ef="EmbeddedApiSession";var pj=Fa.a;null!=pj&&(Pc.UserSessionId=pj);break;case 40:Ef="NumberFormattingCalculator";var ej=Fa.a;null!=ej&&(Pc.Id=ej);var qj=Fa.b;null!=qj&&(Pc.CounterName=qj);var rj=Fa.c;null!=rj&&(Pc.Values=rj);break;
case 41:Ef="RequestDataAfterSend";var sj=Fa.a;null!=sj&&(Pc.ClientStopwatchId=sj);var tj=Fa.b;null!=tj&&(Pc.RequestStatus=tj);var uj=null==Fa.c?null:Fa.c.toString();null!=uj&&(Pc.SendDuration=uj);var vj=null==Fa.d?null:Fa.d.toString();null!=vj&&(Pc.RequestId=vj);break;case 42:Ef="FloatingObjectsStopwatchData";var wj=Fa.a;null!=wj&&(Pc.StopMessage=wj);var uf=null==Fa.b?null:Fa.b.toString();null!=uf&&(Pc.Type=uf);var fj=Fa.c;null!=fj&&(Pc.GUID=fj);var O=null==Fa.d?null:Fa.d.toString();null!=O&&(Pc.Pane=
O);var Ma=null==Fa.e?null:Fa.e.toString();null!=Ma&&(Pc.IsAboveGrid=Ma);var Cb=Fa.f;null!=Cb&&(Pc.StartCorrelation=Cb);var lc=Fa.g;null!=lc&&(Pc.LoadImageCorrelation=lc);var Dc=null==Fa.h?null:Fa.h.toString();null!=Dc&&(Pc.SkippedGetEffectsExtents=Dc);var dd=null==Fa.i?null:Fa.i.toString();null!=dd&&(Pc.Version=dd);break;case 43:Ef="Copy";var kd=Fa.a;null!=kd&&(Pc.UserSessionId=kd);var sd=Fa.b;null!=sd&&(Pc.Trigger=sd);var Gd=Fa.c;null!=Gd&&(Pc.RibbonCommandName=Gd);var Vd=Fa.d;null!=Vd&&(Pc.SourceItem=
Vd);var Pe=null==Fa.e?null:Fa.e.toString();null!=Pe&&(Pc.SourceRangeCellCount=Pe);var Se=Fa.f;null!=Se&&(Pc.ClientSideStopwatchId=Se);var ef=Fa.g;null!=ef&&(Pc.CopyOperationId=ef);var lg=null==Fa.h?null:Fa.h.toString();null!=lg&&(Pc.IsAsync=lg);var bg=null==Fa.i?null:Fa.i.toString();null!=bg&&(Pc.IsFromCache=bg);var cg=null==Fa.j?null:Fa.j.toString();null!=cg&&(Pc.IsSuccessiveCopy=cg);var Of=null==Fa.k?null:Fa.k.toString();null!=Of&&(Pc.IsSelectionAllowed=Of);var mg=null==Fa.l?null:Fa.l.toString();
null!=mg&&(Pc.IsSuccess=mg);var Ng=null==Fa.m?null:Fa.m.toString();null!=Ng&&(Pc.IsExpectedError=Ng);var Kg=Fa.n;null!=Kg&&(Pc.ExpectedErrorReason=Kg);var Og=Fa.o;null!=Og&&(Pc.ErrorMessage=Og);var Gh=null==Fa.p?null:Fa.p.toString();null!=Gh&&(Pc.ClientSideCopyTimeInMs=Gh);var gi=null==Fa.q?null:Fa.q.toString();null!=gi&&(Pc.TotalTimeInMs=gi);var Yj=null==Fa.r?null:Fa.r.toString();null!=Yj&&(Pc.PlainTextPayloadSize=Yj);var Zj=Fa.s;null!=Zj&&(Pc.CopyPasteTargetType=Zj);var ak=null==Fa.t?null:Fa.t.toString();
null!=ak&&(Pc.ShadowWorkbookPayloadSize=ak);var bk=null==Fa.u?null:Fa.u.toString();null!=bk&&(Pc.HtmlPayloadSize=bk);var ck=null==Fa.v?null:Fa.v.toString();null!=ck&&(Pc.HtmlSizeExceedsLimit=ck);var dk=null==Fa.w?null:Fa.w.toString();null!=dk&&(Pc.CopyTotalSizeExceedsLimit=dk);var ek=null==Fa.x?null:Fa.x.toString();null!=ek&&(Pc.ErrorReason=ek);var fk=Fa.y;null!=fk&&(Pc.ErrorName=fk);var gk=null==Fa.z?null:Fa.z.toString();null!=gk&&(Pc.IsSucceededWithAlert=gk);var hk=null==Fa.ba?null:Fa.ba.toString();
null!=hk&&(Pc.EncounteredDeploymentErrors=hk);var ik=null==Fa.bb?null:Fa.bb.toString();null!=ik&&(Pc.ShadowWorkbookSizeExceedsLimit=ik);var jk=Fa.bc;null!=jk&&(Pc.CopyPasteTargetName=jk);var kk=Fa.bd;null!=kk&&(Pc.CCPSliceName=kk);var lk=Fa.be;null!=lk&&(Pc.SyncClipboardItemsKeys=lk);var mk=Fa.bf;null!=mk&&(Pc.AsyncClipboardItemsKeys=mk);var nk=Fa.bg;null!=nk&&(Pc.CopyPasteHandlerName=nk);var ok=Fa.bh;null!=ok&&(Pc.SucceededPopulatingSystemClipboardSync=ok);var pk=Fa.bi;null!=pk&&(Pc.SucceededPopulatingSystemClipboardAsync=
pk);var qk=Fa.bj;null!=qk&&(Pc.Location=qk);var rk=Fa.bk;null!=rk&&(Pc.CopyContextId=rk);var sk=null==Fa.bl?null:Fa.bl.toString();null!=sk&&(Pc.ServerRequestTimeInMs=sk);var tk=null==Fa.bm?null:Fa.bm.toString();null!=tk&&(Pc.EcsOperationDuration=tk);var uk=null==Fa.bn?null:Fa.bn.toString();null!=uk&&(Pc.EcsRequestDuration=uk);var vk=null==Fa.bo?null:Fa.bo.toString();null!=vk&&(Pc.WfeRequestDuration=vk);var wk=null==Fa.bp?null:Fa.bp.toString();null!=wk&&(Pc.OriginalSourceRangesCountExceedsLimit=wk);
var xk=null==Fa.bq?null:Fa.bq.toString();null!=xk&&(Pc.UploadToClipServiceAttempted=xk);var yk=null==Fa.br?null:Fa.br.toString();null!=yk&&(Pc.FloatingObjectType=yk);break;case 44:Ef="Paste";var zk=Fa.a;null!=zk&&(Pc.UserSessionId=zk);var Ak=Fa.b;null!=Ak&&(Pc.Trigger=Ak);var Bk=Fa.c;null!=Bk&&(Pc.RibbonCommandName=Bk);var Ck=null==Fa.d?null:Fa.d.toString();null!=Ck&&(Pc.PasteTypeFlagValue=Ck);var Dk=Fa.e;null!=Dk&&(Pc.PasteOperationId=Dk);var Ek=Fa.f;null!=Ek&&(Pc.CopyOperationId=Ek);var Fk=Fa.g;
null!=Fk&&(Pc.ClientSideStopwatchId=Fk);var Gk=Fa.h;null!=Gk&&(Pc.OriginalDestinationRange=Gk);var Hk=Fa.i;null!=Hk&&(Pc.ExpandDestinationRange=Hk);var Ik=Fa.j;null!=Ik&&(Pc.SourceItem=Ik);var Jk=null==Fa.k?null:Fa.k.toString();null!=Jk&&(Pc.SourceRangeCellCount=Jk);var Kk=null==Fa.l?null:Fa.l.toString();null!=Kk&&(Pc.IsSuccess=Kk);var Lk=null==Fa.m?null:Fa.m.toString();null!=Lk&&(Pc.IsExpectedError=Lk);var Mk=Fa.n;null!=Mk&&(Pc.ClipboardFormatReadTimeInMs=Mk);var Nk=Fa.o;null!=Nk&&(Pc.ClipboardFormatReadStatus=
Nk);var Ok=null==Fa.p?null:Fa.p.toString();null!=Ok&&(Pc.ClipboardReadPermissionPromptShown=Ok);var Pk=null==Fa.q?null:Fa.q.toString();null!=Pk&&(Pc.AsyncApiReadTimedOut=Pk);var Qk=Fa.r;null!=Qk&&(Pc.ExpectedErrorReason=Qk);var Rk=Fa.s;null!=Rk&&(Pc.ErrorMessage=Rk);var Sk=null==Fa.t?null:Fa.t.toString();null!=Sk&&(Pc.TotalTimeInMs=Sk);var Tk=null==Fa.u?null:Fa.u.toString();null!=Tk&&(Pc.PlainTextPayloadSize=Tk);var Uk=null==Fa.v?null:Fa.v.toString();null!=Uk&&(Pc.ShadowWorkbookPayloadSize=Uk);var Vk=
null==Fa.w?null:Fa.w.toString();null!=Vk&&(Pc.HtmlPayloadSize=Vk);var Wk=Fa.x;null!=Wk&&(Pc.CopyPasteTargetType=Wk);var Xk=null==Fa.y?null:Fa.y.toString();null!=Xk&&(Pc.IsLastCopyWasExternal=Xk);var Yk=null==Fa.z?null:Fa.z.toString();null!=Yk&&(Pc.IsClipboardDataContainShadowWorkbook=Yk);var Zk=null==Fa.ba?null:Fa.ba.toString();null!=Zk&&(Pc.IsShadowWorkbookParsedSuccessfully=Zk);var $k=Fa.bb;null!=$k&&(Pc.ActiveSelectionType=$k);var al=Fa.bc;null!=al&&(Pc.PasteResult=al);var Tj=null==Fa.bd?null:
Fa.bd.toString();null!=Tj&&(Pc.ErrorReason=Tj);var bl=Fa.be;null!=bl&&(Pc.ErrorName=bl);var cl=null==Fa.bf?null:Fa.bf.toString();null!=cl&&(Pc.IsSucceededWithAlert=cl);var dl=null==Fa.bg?null:Fa.bg.toString();null!=dl&&(Pc.IsAfterCut=dl);var el=null==Fa.bh?null:Fa.bh.toString();null!=el&&(Pc.EncounteredDeploymentErrors=el);var fl=null==Fa.bi?null:Fa.bi.toString();null!=fl&&(Pc.IsCrossSession=fl);var gl=null==Fa.bj?null:Fa.bj.toString();null!=gl&&(Pc.ShadowWorkbookSizeExceedsLimit=gl);var hl=null==
Fa.bk?null:Fa.bk.toString();null!=hl&&(Pc.ClipboardContainXLOPayload=hl);var il=Fa.bl;null!=il&&(Pc.CopyPasteTargetName=il);var jl=Fa.bm;null!=jl&&(Pc.ChromeExtensionId=jl);var kl=Fa.bn;null!=kl&&(Pc.PayloadOrigin=kl);var ll=Fa.bo;null!=ll&&(Pc.PayloadType=ll);var am=Fa.bp;null!=am&&(Pc.CCPSliceName=am);var xj=Fa.bq;null!=xj&&(Pc.ClipboardItemsKeys=xj);var yj=Fa.br;null!=yj&&(Pc.CopyPasteHandlerName=yj);var zj=null==Fa.bs?null:Fa.bs.toString();null!=zj&&(Pc.IsSourceItemOriginSameSession=zj);var Aj=
Fa.bt;null!=Aj&&(Pc.Location=Aj);var Bj=Fa.bu;null!=Bj&&(Pc.ExternalAppSource=Bj);var Cj=Fa.bv;null!=Cj&&(Pc.PasteContextId=Cj);var Dj=null==Fa.bw?null:Fa.bw.toString();null!=Dj&&(Pc.ServerRequestTimeInMs=Dj);var ml=null==Fa.bx?null:Fa.bx.toString();null!=ml&&(Pc.IndicationDisplayScheduled=ml);var nl=Fa.by;null!=nl&&(Pc.PasteIndicationDisplayStatus=nl);var Uj=null==Fa.bz?null:Fa.bz.toString();null!=Uj&&(Pc.PasteRecoveryUIDisplayed=Uj);var Vj=null==Fa.ca?null:Fa.ca.toString();null!=Vj&&(Pc.IsFromPasteRecoveryUI=
Vj);var Wj=null==Fa.cb?null:Fa.cb.toString();null!=Wj&&(Pc.EcsOperationDuration=Wj);var Xj=null==Fa.cc?null:Fa.cc.toString();null!=Xj&&(Pc.EcsRequestDuration=Xj);var ol=null==Fa.cd?null:Fa.cd.toString();null!=ol&&(Pc.WfeRequestDuration=ol);var Ej=null==Fa.ce?null:Fa.ce.toString();null!=Ej&&(Pc.OriginalSourceRangesCountExceedsLimit=Ej);var Fj=Fa.cf;null!=Fj&&(Pc.PasteRecoveryUndoStopwatchId=Fj);var Gj=null==Fa.cg?null:Fa.cg.toString();null!=Gj&&(Pc.PasteRecoveryUndoTimeInMs=Gj);var Hj=null==Fa.ch?
null:Fa.ch.toString();null!=Hj&&(Pc.PasteCSEPerformed=Hj);var Ij=null==Fa.ci?null:Fa.ci.toString();null!=Ij&&(Pc.CSEStatus=Ij);var Jj=null==Fa.cj?null:Fa.cj.toString();null!=Jj&&(Pc.IsFromEnterShortcut=Jj);var Kj=null==Fa.ck?null:Fa.ck.toString();null!=Kj&&(Pc.pasteDestinationHasMergedCells=Kj);break;case 45:Ef="DragDrop";var Lj=Fa.a;null!=Lj&&(Pc.UserSessionId=Lj);var Mj=Fa.b;null!=Mj&&(Pc.Trigger=Mj);var Nj=Fa.c;null!=Nj&&(Pc.RibbonCommandName=Nj);var Oj=Fa.d;null!=Oj&&(Pc.OperationId=Oj);var Pj=
Fa.e;null!=Pj&&(Pc.ClientSideStopwatchId=Pj);var Qj=Fa.f;null!=Qj&&(Pc.SourceRange=Qj);var Rj=Fa.g;null!=Rj&&(Pc.DestinationRange=Rj);var Sj=Fa.h;null!=Sj&&(Pc.CutCopyType=Sj);var pl=null==Fa.i?null:Fa.i.toString();null!=pl&&(Pc.IsShiftKeyDown=pl);var ql=null==Fa.j?null:Fa.j.toString();null!=ql&&(Pc.IsDragInsert=ql);var rl=null==Fa.k?null:Fa.k.toString();null!=rl&&(Pc.IsSuccess=rl);var sl=null==Fa.l?null:Fa.l.toString();null!=sl&&(Pc.IsExpectedError=sl);var tl=Fa.m;null!=tl&&(Pc.ExpectedErrorReason=
tl);var ul=Fa.n;null!=ul&&(Pc.ErrorMessage=ul);var vl=null==Fa.o?null:Fa.o.toString();null!=vl&&(Pc.TotalTimeInMs=vl);var wl=Fa.p;null!=wl&&(Pc.ErrorName=wl);var xl=null==Fa.q?null:Fa.q.toString();null!=xl&&(Pc.IsSucceededWithAlert=xl);var yl=Fa.r;null!=yl&&(Pc.CopyPasteTargetType=yl);var zl=null==Fa.s?null:Fa.s.toString();null!=zl&&(Pc.EncounteredDeploymentErrors=zl);break;case 46:Ef="ClearCopyState";var Al=Fa.a;null!=Al&&(Pc.UserSessionId=Al);var Bl=Fa.b;null!=Bl&&(Pc.ClientSideStopwatchId=Bl);
var Cl=Fa.c;null!=Cl&&(Pc.Trigger=Cl);var Dl=null==Fa.d?null:Fa.d.toString();null!=Dl&&(Pc.IsClearClipboard=Dl);var El=null==Fa.e?null:Fa.e.toString();null!=El&&(Pc.IsExplicit=El);var Fl=null==Fa.f?null:Fa.f.toString();null!=Fl&&(Pc.IsSuccess=Fl);var Gl=Fa.g;null!=Gl&&(Pc.ErrorMessage=Gl);var Hl=Fa.h;null!=Hl&&(Pc.ErrorName=Hl);var Il=null==Fa.i?null:Fa.i.toString();null!=Il&&(Pc.TotalTimeInMs=Il);var Jl=Fa.j;null!=Jl&&(Pc.CopyPasteTargetType=Jl);break;case 47:Ef="WebWorkerRecalcStats";var Kl=null==
Fa.a?null:Fa.a.toString();null!=Kl&&(Pc.SuccessCount=Kl);var Ll=null==Fa.b?null:Fa.b.toString();null!=Ll&&(Pc.FailureCount=Ll);var Ml=null==Fa.c?null:Fa.c.toString();null!=Ml&&(Pc.ValueTypeMismatchCount=Ml);var Nl=null==Fa.d?null:Fa.d.toString();null!=Nl&&(Pc.CellValueMismatchCount=Nl);var Ol=null==Fa.e?null:Fa.e.toString();null!=Ol&&(Pc.IfmtMismatchCount=Ol);var Pl=null==Fa.f?null:Fa.f.toString();null!=Pl&&(Pc.FormattedTextMismatchCount=Pl);var Ql=null==Fa.g?null:Fa.g.toString();null!=Ql&&(Pc.CellValueStringMismatchCount=
Ql);var Rl=null==Fa.h?null:Fa.h.toString();null!=Rl&&(Pc.CellValueNumberMismatchCount=Rl);var Sl=null==Fa.i?null:Fa.i.toString();null!=Sl&&(Pc.CellValueBooleanMismatchCount=Sl);var Tl=null==Fa.j?null:Fa.j.toString();null!=Tl&&(Pc.CellValueBlankMismatchCount=Tl);var Ul=null==Fa.k?null:Fa.k.toString();null!=Ul&&(Pc.CellValueErrorMismatchCount=Ul);var Vl=null==Fa.l?null:Fa.l.toString();null!=Vl&&(Pc.FormattedTextStringMismatchCount=Vl);var Wl=null==Fa.m?null:Fa.m.toString();null!=Wl&&(Pc.FormattedTextNumberMismatchCount=
Wl);var Xl=null==Fa.n?null:Fa.n.toString();null!=Xl&&(Pc.FormattedTextBooleanMismatchCount=Xl);var Yl=null==Fa.o?null:Fa.o.toString();null!=Yl&&(Pc.FormattedTextBlankMismatchCount=Yl);var Zl=null==Fa.p?null:Fa.p.toString();null!=Zl&&(Pc.FormattedTextErrorMismatchCount=Zl);var $l=null==Fa.q?null:Fa.q.toString();null!=$l&&(Pc.StringMismatchCount=$l);var uh=null==Fa.r?null:Fa.r.toString();null!=uh&&(Pc.NumericMismatchCount=uh);var mh=null==Fa.s?null:Fa.s.toString();null!=mh&&(Pc.ErrorMismatchCount=mh);
var nh=null==Fa.t?null:Fa.t.toString();null!=nh&&(Pc.StringValuesCount=nh);var oh=null==Fa.u?null:Fa.u.toString();null!=oh&&(Pc.NumericValuesCount=oh);var Ri=null==Fa.v?null:Fa.v.toString();null!=Ri&&(Pc.BooleanValuesCount=Ri);var Si=null==Fa.w?null:Fa.w.toString();null!=Si&&(Pc.BlankValuesCount=Si);var bm=null==Fa.x?null:Fa.x.toString();null!=bm&&(Pc.ErrorValuesCount=bm);var hm=null==Fa.y?null:Fa.y.toString();null!=hm&&(Pc.NumericValuesDiffAverage=hm);var im=Fa.z;null!=im&&(Pc.NumericEvaluatedValuesMismatchSamples=
im);var jm=Fa.ba;null!=jm&&(Pc.NumericFormattedTextMismatchSamples=jm);var km=Fa.bb;null!=km&&(Pc.NumericMismatchSamples=km);var lm=Fa.bc;null!=lm&&(Pc.CellValueTypeMismatchSamples=lm);var mm=Fa.bd;null!=mm&&(Pc.IfmtMismatchSamples=mm);var nm=Fa.be;null!=nm&&(Pc.BlockHashCode=nm);break;case 48:Ef="DataValidationEditOpenDialog";var om=Fa.a;null!=om&&(Pc.ServerCommand=om);var pm=null==Fa.b?null:Fa.b.toString();null!=pm&&(Pc.SubDialogOpened=pm);var qm=Fa.c;null!=qm&&(Pc.SubDialogButtonClicked=qm);var rm=
null==Fa.d?null:Fa.d.toString();null!=rm&&(Pc.DialogOpened=rm);var sm=Fa.e;null!=sm&&(Pc.RuleType=sm);var tm=Fa.f;null!=tm&&(Pc.ConditionType=tm);var um=null==Fa.g?null:Fa.g.toString();null!=um&&(Pc.LowerBoundaryFilled=um);var vm=null==Fa.h?null:Fa.h.toString();null!=vm&&(Pc.UpperBoundaryFilled=vm);var wm=null==Fa.i?null:Fa.i.toString();null!=wm&&(Pc.IgnoreBlank=wm);var xm=null==Fa.j?null:Fa.j.toString();null!=xm&&(Pc.InCellDropdown=xm);var ym=null==Fa.k?null:Fa.k.toString();null!=ym&&(Pc.ShowInputMessage=
ym);var zm=null==Fa.l?null:Fa.l.toString();null!=zm&&(Pc.InputTitleFilled=zm);var Am=null==Fa.m?null:Fa.m.toString();null!=Am&&(Pc.InputMessageFilled=Am);var Bm=null==Fa.n?null:Fa.n.toString();null!=Bm&&(Pc.ShowErrorAlert=Bm);var Cm=null==Fa.o?null:Fa.o.toString();null!=Cm&&(Pc.AlertBlocking=Cm);var Dm=null==Fa.p?null:Fa.p.toString();null!=Dm&&(Pc.AlertTitleFilled=Dm);var Em=null==Fa.q?null:Fa.q.toString();null!=Em&&(Pc.AlertMessageFilled=Em);var Fm=Fa.r;null!=Fm&&(Pc.StopWatchId=Fm);break;case 49:Ef=
"DataValidationEditSubmitRule";var Gm=Fa.a;null!=Gm&&(Pc.RuleType=Gm);var Hm=Fa.b;null!=Hm&&(Pc.ConditionType=Hm);var Im=null==Fa.c?null:Fa.c.toString();null!=Im&&(Pc.LowerBoundaryFilled=Im);var Jm=null==Fa.d?null:Fa.d.toString();null!=Jm&&(Pc.UpperBoundaryFilled=Jm);var Km=null==Fa.e?null:Fa.e.toString();null!=Km&&(Pc.IgnoreBlank=Km);var Lm=null==Fa.f?null:Fa.f.toString();null!=Lm&&(Pc.InCellDropdown=Lm);var Mm=null==Fa.g?null:Fa.g.toString();null!=Mm&&(Pc.ShowInputMessage=Mm);var Nm=null==Fa.h?
null:Fa.h.toString();null!=Nm&&(Pc.InputTitleFilled=Nm);var Om=null==Fa.i?null:Fa.i.toString();null!=Om&&(Pc.InputMessageFilled=Om);var Pm=null==Fa.j?null:Fa.j.toString();null!=Pm&&(Pc.ShowErrorAlert=Pm);var Qm=null==Fa.k?null:Fa.k.toString();null!=Qm&&(Pc.AlertBlocking=Qm);var Rm=null==Fa.l?null:Fa.l.toString();null!=Rm&&(Pc.AlertTitleFilled=Rm);var Sm=null==Fa.m?null:Fa.m.toString();null!=Sm&&(Pc.AlertMessageFilled=Sm);var Tm=null==Fa.n?null:Fa.n.toString();null!=Tm&&(Pc.ClearAllPressed=Tm);var Um=
Fa.o;null!=Um&&(Pc.ActionStatus=Um);var Vm=Fa.p;null!=Vm&&(Pc.Error=Vm);var Wm=Fa.q;null!=Wm&&(Pc.StopWatchId=Wm);break;case 50:Ef="CustomSort";var Xm=Fa.a;null!=Xm&&(Pc.RangeType=Xm);var Ym=null==Fa.b?null:Fa.b.toString();null!=Ym&&(Pc.HasHeaders=Ym);var Zm=null==Fa.c?null:Fa.c.toString();null!=Zm&&(Pc.SortTopToBottom=Zm);var $m=null==Fa.d?null:Fa.d.toString();null!=$m&&(Pc.ColumnCount=$m);var an=null==Fa.e?null:Fa.e.toString();null!=an&&(Pc.RowCount=an);var bn=null==Fa.f?null:Fa.f.toString();null!=
bn&&(Pc.RangeLimitExceeded=bn);var cn=null==Fa.g?null:Fa.g.toString();null!=cn&&(Pc.CaseSensitive=cn);var dn=null==Fa.h?null:Fa.h.toString();null!=dn&&(Pc.GetSortInfoDuration=dn);var en=null==Fa.i?null:Fa.i.toString();null!=en&&(Pc.LevelCount=en);var fn=null==Fa.j?null:Fa.j.toString();null!=fn&&(Pc.SortOnValuesCount=fn);var gn=null==Fa.k?null:Fa.k.toString();null!=gn&&(Pc.SortOnCellColorCount=gn);var hn=null==Fa.l?null:Fa.l.toString();null!=hn&&(Pc.SortOnFontColorCount=hn);var jn=null==Fa.m?null:
Fa.m.toString();null!=jn&&(Pc.SortOnIconCount=jn);var kn=null==Fa.n?null:Fa.n.toString();null!=kn&&(Pc.CustomOrderCount=kn);var ln=null==Fa.o?null:Fa.o.toString();null!=ln&&(Pc.AvgCellColorCount=ln);var mn=null==Fa.p?null:Fa.p.toString();null!=mn&&(Pc.MaxCellColorCount=mn);var nn=null==Fa.q?null:Fa.q.toString();null!=nn&&(Pc.AvgFontColorCount=nn);var on=null==Fa.r?null:Fa.r.toString();null!=on&&(Pc.MaxFontColorCount=on);var pn=null==Fa.s?null:Fa.s.toString();null!=pn&&(Pc.AvgIconsCount=pn);var qn=
null==Fa.t?null:Fa.t.toString();null!=qn&&(Pc.MaxIconsCount=qn);var rn=null==Fa.u?null:Fa.u.toString();null!=rn&&(Pc.Executed=rn);break;case 51:Ef="NamedSheetViewUserAction";var sn=Fa.a;null!=sn&&(Pc.UserSessionId=sn);var tn=Fa.b;null!=tn&&(Pc.UserActionName=tn);var un=null==Fa.c?null:Fa.c.toString();null!=un&&(Pc.UserActionSource=un);var vn=Fa.d;null!=vn&&(Pc.UserActionData=vn);var wn=Fa.e;null!=wn&&(Pc.OtherData=wn);break;case 52:Ef="NamedSheetViewTeachingCallout";var xn=Fa.a;null!=xn&&(Pc.UserSessionId=
xn);var yn=null==Fa.b?null:Fa.b.toString();null!=yn&&(Pc.TeachingCalloutSequence=yn);var zn=null==Fa.c?null:Fa.c.toString();null!=zn&&(Pc.TeachingCalloutIndex=zn);var An=null==Fa.d?null:Fa.d.toString();null!=An&&(Pc.UserActionName=An);var Bn=Fa.e;null!=Bn&&(Pc.UserActionData=Bn);var Cn=null==Fa.f?null:Fa.f.toString();null!=Cn&&(Pc.DurationInMs=Cn);break;case 53:Ef="NamedSheetViewTeachingDialog";var Dn=Fa.a;null!=Dn&&(Pc.UserSessionId=Dn);var En=Fa.b;null!=En&&(Pc.UserActionName=En);var Fn=Fa.c;null!=
Fn&&(Pc.ButtonClicked=Fn);var Gn=null==Fa.d?null:Fa.d.toString();null!=Gn&&(Pc.DurationInMs=Gn);var Hn=null==Fa.e?null:Fa.e.toString();null!=Hn&&(Pc.IsNewTeachingDialog=Hn);break;case 54:Ef="NamedSheetViewOptionsDialog";var In=Fa.a;null!=In&&(Pc.UserSessionId=In);var Jn=null==Fa.b?null:Fa.b.toString();null!=Jn&&(Pc.OptionsAction=Jn);var Kn=Fa.c;null!=Kn&&(Pc.OptionsActionData=Kn);var Ln=Fa.d;null!=Ln&&(Pc.OptionsOtherData=Ln);var Mn=null==Fa.e?null:Fa.e.toString();null!=Mn&&(Pc.DurationInMs=Mn);break;
case 55:Ef="NamedSheetViewTempViewApplyDialog";var Nn=Fa.a;null!=Nn&&(Pc.UserSessionId=Nn);var On=Fa.b;null!=On&&(Pc.TriggeredFrom=On);var Pn=Fa.c;null!=Pn&&(Pc.ButtonClicked=Pn);var Qn=null==Fa.d?null:Fa.d.toString();null!=Qn&&(Pc.DurationInMs=Qn);break;case 56:Ef="NamedSheetViewTempViewSaveDialog";var Rn=Fa.a;null!=Rn&&(Pc.UserSessionId=Rn);var Sn=Fa.b;null!=Sn&&(Pc.TriggeredFrom=Sn);var Tn=Fa.c;null!=Tn&&(Pc.ButtonClicked=Tn);var Un=null==Fa.d?null:Fa.d.toString();null!=Un&&(Pc.NameUpdated=Un);
var Vn=null==Fa.e?null:Fa.e.toString();null!=Vn&&(Pc.DurationInMs=Vn);break;case 57:Ef="TemporaryViewStartedDataRestore";var Wn=Fa.a;null!=Wn&&(Pc.UserSessionId=Wn);var Xn=null==Fa.b?null:Fa.b.toString();null!=Xn&&(Pc.CountOfTempViews=Xn);break;case 58:Ef="TemporaryViewFetchedVersion";var Yn=Fa.a;null!=Yn&&(Pc.UserSessionId=Yn);var Zn=null==Fa.b?null:Fa.b.toString();null!=Zn&&(Pc.NumberOfBytes=Zn);break;case 59:Ef="RaiseEventsAndGenerateBlockRequests";var $n=null==Fa.a?null:Fa.a.toString();null!=
$n&&(Pc.ReturnContentStatus=$n);var ao=null==Fa.b?null:Fa.b.toString();null!=ao&&(Pc.CacheState=ao);var bo=null==Fa.c?null:Fa.c.toString();null!=bo&&(Pc.FromXhrCallback=bo);var co=null==Fa.d?null:Fa.d.toString();null!=co&&(Pc.AreGeneralErrorsPresent=co);var eo=Fa.e;null!=eo&&(Pc.BlockCacheItemHash=eo);var fo=Fa.f;null!=fo&&(Pc.StopwatchId=fo);var go=Fa.g;null!=go&&(Pc.BlockCacheItemProcessingStopwatchId=go);var ho=null==Fa.h?null:Fa.h.toString();null!=ho&&(Pc.StateId=ho);var io=null==Fa.i?null:Fa.i.toString();
null!=io&&(Pc.IsHighPriority=io);var jo=null==Fa.j?null:Fa.j.toString();null!=jo&&(Pc.CalcComplete=jo);var ko=null==Fa.k?null:Fa.k.toString();null!=ko&&(Pc.EditedCellsUpdatedByCse=ko);var lo=null==Fa.l?null:Fa.l.toString();null!=lo&&(Pc.DependentCellsUpdatedByCse=lo);var mo=null==Fa.m?null:Fa.m.toString();null!=mo&&(Pc.Revision=mo);var no=null==Fa.n?null:Fa.n.toString();null!=no&&(Pc.SheetProcessedDataVersion=no);var oo=null==Fa.o?null:Fa.o.toString();null!=oo&&(Pc.RefCount=oo);var po=null==Fa.p?
null:Fa.p.toString();null!=po&&(Pc.ExistsInView=po);var qo=null==Fa.q?null:Fa.q.toString();null!=qo&&(Pc.ContentSource=qo);break;case 60:Ef="LaunchMakerCodeEditor";var ro=Fa.a;null!=ro&&(Pc.SessionId=ro);var so=Fa.b;null!=so&&(Pc.Command=so);var to=null==Fa.c?null:Fa.c.toString();null!=to&&(Pc.IsPreviewGallery=to);var uo=Fa.d;null!=uo&&(Pc.MenuItemId=uo);var vo=Fa.e;null!=vo&&(Pc.ScriptId=vo);var wo=Fa.f;null!=wo&&(Pc.ShareId=wo);var xo=null==Fa.g?null:Fa.g.toString();null!=xo&&(Pc.IsOwner=xo);var yo=
null==Fa.h?null:Fa.h.toString();null!=yo&&(Pc.PublishedScriptCount=yo);var zo=null==Fa.i?null:Fa.i.toString();null!=zo&&(Pc.RecentScriptCount=zo);var Ao=null==Fa.j?null:Fa.j.toString();null!=Ao&&(Pc.WorkbookScriptCount=Ao)}Pc.Table=Ef;var Fo=Sys.Serialization.JavaScriptSerializer.serialize(Pc);de.call(rd,3704927,0,50,Fo)}}catch(Pc){d.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Ea} exception: ${Pc}`)}}z6c(Ea,Fa,vc){if(this.Xnc){const rd=this.bWa[Ea+Fa];rd&&(rd.e=vc,this.I9c(rd));
delete this.bWa[Ea+Fa]}}psd(Ea,Fa){Cd[Ea]in this.Tlf||this.Ie(Ea,Fa)}WWi(){this.yh.appStart&&this.N4f(ze.lBd,this.yh.appStart)}tvi(Ea){const Fa={};Fa.a=Ea.i;Fa.b=Ea.o;Fa.c=Ea.t;Fa.d=Kb.a(Ea.s,Ea.p||this.yh.appStart);Fa.e=Kb.a(Ea.e,Ea.s);Fa.f=Ea.c;Fa.g=Ea.a;Fa.h=Ea.h;this.Ie(0,Fa,this.jji(Fa.b,Fa.c))}jji(Ea,Fa){return["CommandTask","QueuedTask","Task"].includes(Ea)&&!this.Svh.includes(Fa)?!1:!0}FA(Ea,Fa,vc,rd,de=!0){if(Ea&&Fa){const qe={};qe.a=Ea;qe.b=Fa;qe.c=vc.toString();qe.d=rd.toString();this.Ie(15,
qe,de)}}Dlf(Ea,Fa,vc,rd){const de={};Ea&&(de.c=Kb.a(Ea,this.yh.appStart));de.b=Fa;de.a=vc;de.d=rd;this.Ie(17,de)}dispose(){this.MPa.execute(Ea=>{Ea.deactivate(!0);Ea.laj(this.tAf)});this.Ne&&this.Ne.yab(this.q5);super.dispose()}B2e(){return this.mfg=this.mfg||new hc}DDe(Ea,Fa,vc=null,rd=null,de=null){const qe={};qe.o=Ea;qe.t=Fa;qe.p=de;qe.s=rd||this.yh.je;this.Vjd(qe,vc);return qe}Fze(Ea,Fa=null){Ea&&(Ea.e=Fa||this.yh.je,Ea.i=Ea.i||this.O_a.S7a(),Ea.c=Ea.c||this.iEe,Ea.a=Ea.a||this.pEe,Ea.h=void 0!==
Ea.h&&null!==Ea.h?Ea.h:this.Ne?this.Ne.Ei:!1,this.I9c(Ea))}Llf(Ea){const Fa=Ea.context;Ea.duration>ze.Ehh&&(Fa.methodName===ic.a.eac||Fa.methodName===ic.a.A3a)&&this.Irc(1,ze.cUh);if("GetSessionStatus"!==Fa.methodName){const vc={};vc.a=Fa.methodName;vc.b=Fa.stopwatch.id;vc.c=Ea.Urc;vc.d=Ea.responseSize;vc.e=Fa.Z0b;vc.f=Ea.$c?Ea.$c.StateId:ic.a.sWd;this.Ie(30,vc,!0);this.FA(vc.b,Ea.$c.ServerCorrelationId,"clientWebRequests","ServerActions")}}H5f(){if(this.Xnc){const Ea=this.bWa.LoadingUIShownSplashScreen;
Ea&&Ra.PageLoadTrackingInfo.instance.Dqj(Ea.s)}}Irc(Ea,Fa){this.aeg.THb(Ea,Fa,null)}$Qf(Ea,Fa=null){this.UAc.Rdj(Ea,Fa)}ZQf(Ea,Fa,vc=null){this.UAc.Qdj(Ea,Fa,vc)}aRf(Ea){this.UAc.kJd(Ea,null)}bRf(Ea,Fa){this.UAc.THb(Ea,Fa,null)}Erc(Ea,Fa,vc=null){this.Oeb.Erc(Ea,Fa,vc)}Lrc(Ea,Fa,vc=null){this.Oeb.Lrc(Ea,Fa,vc)}sendDNMTraceTag(Ea,Fa,vc,rd,...de){xb.EwaSettings.ma(218)&&d.ULS.sendTraceTag.apply(null,[Ea,Fa,vc,rd].concat(de))}rJb(Ea,Fa,vc,rd,de,qe,bf,...of){this.Oeb.rJb(Ea,Fa,vc,rd,de,qe,bf,...of)}tJb(Ea,
Fa,vc,rd,de,qe){this.Oeb.tJb(Ea,Fa,vc,rd,de,qe)}sJb(Ea,Fa,vc,rd,de,qe,...bf){this.Oeb.sJb(Ea,Fa,vc,rd,de,qe,...bf)}uJb(Ea,Fa,vc,rd,de,qe){this.aeg.uJb(Ea,Fa,vc,rd,de,qe)}Mtc(Ea,Fa,vc,rd){this.Oeb.Mtc(Ea,Fa,vc,rd)}I9c(Ea){this.ZEj.tvi(Ea)}XWi(){if(this.Xnc){Stw.swpc=null;const Ea=this.Xnc;for(let Fa in Ea)this.Vjd(Ea[Fa])}}bzh(){const Ea=window[ee.a.namespace];if(Ea){const Fa=Ea[ee.a.Oye];Fa&&(delete Ea[ee.a.Oye],Fa.forEach(vc=>{this.Vjd(vc);this.I9c(vc)}))}}zki(Ea,Fa){if("about:blank"===Ea||"renamehandler.ashx"===
Fa&&"2"===w.a.gB(Ea,"u"))return!0;for(Ea=0;Ea<this.vJd.length;Ea++)if(Fa.endsWith(this.vJd[Ea]))return!0;return!1}Ysi(){this.MPa.execute(Ea=>{Ea.ai(ze.sMg,0);Ea.ZDg(this.tAf);Ea.activate()})}Qsi(){const Ea={};Ea.a=new Date(I.EcmaDateClock.instance.appStart.m);Ea.b=this.userSessionId;Ea.c=this.yh.E8f;Ea.d=ze.ybh*m.devicePixelRatio;Ea.e=Ua.a.Wa.appStart.m;this.Ie(14,Ea,!0);this.ska(Ua.a.Wa.appStart.m,Object(X.a)(y.a.instance,y.a.instance.o5i,"recordAppInitStart"))}N4f(Ea,Fa){this.Jeb=this.O_a.S7a();
this.LNb=this.O_a.S7a();this.lCa=Ea;this.ALb("UserAction",Ea,this.LNb,Fa);this.Ekf(Ea,this.Jeb)}hHj(){const Ea=window[ee.a.namespace];Ea&&!ze.SBe&&(Ea[ee.a.VDj]=(Fa,vc)=>this.DDe(Fa,vc),Ea[ee.a.Mjh]=Fa=>{this.Fze(Fa)},ze.SBe=!0)}CPj(Ea){const Fa=Ic.ZPg(Ea.o,Ea.t),vc=new Ic(Kb.a(Ea.e,Ea.s)),rd=Fa in this.NSd?this.NSd[Fa].kZg(vc):vc;this.NSd[Fa]=rd;if(vc===rd||vc.average!==rd.average)Ea=Object(wb.a)(new gc,{operation:Ea.o,target:Ea.t,XBi:rd.average,sender:this}),this.raiseEvent(Fa,Ea)}Ekf(Ea,Fa){const vc=
{};vc.a=Fa;vc.b=this.userSessionId;vc.c=Ea;this.Ie(1,vc,!0)}P9h(){this.vJd=[ic.a.W8i,ic.a.getSessionStatus,ic.a.A3a,ic.a.XYg,ic.a.RVg,ic.a.$Sa,ic.a.S$b,ic.a.getObjectMetadata,ic.a.setRichTextCell,ic.a.NJa,ic.a.ITj,ic.a.pollSessionStatus,ic.a.$Wh,ic.a.iVh,ic.a.pPh]}Vjd(Ea,Fa=null){Ea.i=Fa||this.O_a.S7a();Ea.a=this.pEe;Ea.c=this.iEe;Ea.h=this.Ne?this.Ne.Ei:!1}static ka(Ea){var Fa=new Me;Ea.da.Ga(291,Fa);Fa=new ze(Ea.ya.UserSessionId,void 0,void 0,void 0,Fa,!0);Fa.Ekf(ze.Rqf,Fa.$Ee);d.ULS.sendTraceTag(524166239,
0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Fa.Ysi();Fa.hHj();Fa.WWi();Fa.Qsi();Fa.bzh();Fa.XWi();Fa.P9h();ze.toj(Ea);Hc.a.ul.Ga(41,Fa)}static toj(Ea){const Fa=m.devicePixelRatio;1<Fa&&Ea.jc.Pw(!0,2<=Fa?8388608:4194304)}}ze.Rqf="UnassignedUserAction";ze.lBd="PageLoad";ze.$fd="GridUpdateOperation";ze.Ehh=5E3;ze.cUh="MoreThan_5000_Ms";ze.ybh=96;ze.sMg=30;ze.SBe=!1;Object(b.a)(ze,"TelemetryManager",Ce.a,[13,14,568,569]);var nf=a(198),$f=a(104);class sf{constructor(Ea,Fa,
vc){this.dVj=Ea;this.pU=Fa;this.name=vc}}Object(b.a)(sf,"Validation",null,[]);class og{constructor(Ea){this.H8a=()=>{this.tFf(this.wSe)};this.Hi=()=>{this.tFf(this.CNg)};this.$=Ea;this.CNg=new xc.a;this.wSe=new xc.a;ad.g(this.$).Ea.ox(this.Hi);ad.g(this.$).Ea.tle(this.H8a)}JSc(Ea,Fa,vc,rd,de){if(Ea&&rd){const qe=nf.a.fz(Fa,vc);this.jXb(()=>!!$f.a(Ea).sq(qe),rd.StateId,de)}}jXb(Ea,Fa,vc){this.PCg(this.wSe,Ea,Fa,vc)}PCg(Ea,Fa,vc,rd){Ea&&Fa&&vc!==ic.a.ze&&Ea.add(new sf(Fa,vc,rd))}tFf(Ea){if(Ea){var Fa=
new xc.a;for(let vc of Ea){if(vc.pU===this.$.ea.Le)try{vc.dVj()||d.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${vc.name}]`)}catch(rd){d.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${vc.name}]. Exception: [${rd}]`)}Fa.add(vc)}for(let vc of Fa)Ea.remove(vc)}else d.ULS.shipAssertTag(537151011,0,!!Ea,
"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){ad.g(this.$)&&ad.g(this.$).Ea&&(ad.g(this.$).Ea.uv(this.Hi),ad.g(this.$).Ea.FHd(this.H8a));this.$=null}static ka(Ea){const Fa=new og(Ea);Ea.da.Ga(277,Fa)}}Object(b.a)(og,"ValidationTelemetryManager",null,[566,3]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");n.main();Type.registerNamespace("CNT");U.main();Type.registerNamespace("CACPU");rb.main();Type.registerNamespace("Common.App.EventsCacheManager");
eb.main();(()=>{Ob.a.Fa(Ea=>{Ea.da.Ga(137,new qb(Ea))})})();(()=>{Ob.a.Fa(Ea=>{Ea.da.Ga(37,new jb(Ea))})})();(()=>{Ob.a.Fa(Ea=>{Rc.ka(Ea)})})();(()=>{Ob.a.Fa(Ea=>{Ad.ka(Ea)})})();(()=>{Ob.a.Fa(Ea=>{he.ka(Ea)})})();(()=>{Ob.a.Fa(Ea=>{Ea.da.Ga(40,new Zd(Ea,new sa.a(()=>Yb.GetServiceTaskFactory.create(Ea.da,137,Ea.la,1))))})})();(()=>{Ob.a.Fa(Ea=>{Ea.da.Ga(276,new jc(Ea))})})();(()=>{Ob.a.Fa(Ea=>{Hc.a.ul.Za(135,()=>{ze.ka(Ea);td.ka(Ea);og.ka(Ea);ld.ka(Ea);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",
!1)||zc(Ea);Bf.ka(Ea);Sf.ka(Ea);Jd.RenderingFidelityTracker.ka(Ea)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tm.js.map/586d2e74d46112de68dd438cd36fec3b/EwaDSEsNext.tm.js.map