'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[61],{1434:function(t,D,a){a.r(D);var c=a(0),b=a(505),d=a(49),f=a(10),e=a(54),k=a(86),l=a(84),m=a(220),v=a(413),n=a(37),w=a(7),r=a(15),u=a(85),x=a(82),z=a(221),B=a(13),y=a(108),A=a(4),K=a(88),G=a(146),T=a(124),W=a(570),P=a(93),E=a(550),H=a(5),F=a(719),N=a(131),J=a(510),R=a(368),M=a(170),L=a(247),U=a(36),X=a(245),da=a(561),fa=a(12),S=a(1),ka=a(11),V=a(14),wa=a(21),ma=a(132),ab=a(151),ba=a(339),Ca=a(680),Na=a(548),
za=a(19);const la=za.a.I7c,aa=E.a.tMe;class sa extends P.a{constructor(Pb,Gc,Nb){super(Pb);this.NHg='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.yYb=null;this.Fid=this.I8f=!1;this.A6d=this.oj=this.lf=null;this.vu=0;this.button=null;this.OIf=!1;this.Xac="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=yc=>{if(void 0!==yc.Ca&&null!==yc.Ca&&yc.Ca.keyCode===u.a.dA)if(yc.Ca.shiftKey){if(!U.a.zd(this.$)){yc=this.$.da.za(183);if(!yc)return!1;yc.nNd()}}else this.gg(!0,
!1),yc.Ca.preventDefault(),yc.Ca.stopPropagation();return!0};this.mmc=(yc,Tc)=>{Object.getType(Tc)===String&&Tc.toString()===this.lf.InstanceId&&(yc=!!this.title,Tc=!this.Fid,yc&&this.rJe(),this.P$f(),U.a.zd(this.$)&&(yc&&this.I8f||Tc&&this.Fid)&&this.T6.updateTaskPane(this.rW,this.LB))};this.$ka=()=>{var yc;S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.oj.vHd(this.lf.InstanceId);var Tc=da.a(this.lf);if(Tc)if(this.lf.TaskpaneTitle===V.a.instance.ga(979))r.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.lf.PrimaryMarketplace)if("FA000000005"===this.lf.PrimaryMarketplace.SolutionId){r.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let gd="Unknown",Ad="Unknown",Od="Unknown";null===(yc=this.lf.OsfPropertyBag)||void 0===yc?void 0:yc.forEach(Pd=>{2===Pd.length&&("LaunchMode"===Pd[0]?gd=Pd[1]:"CorrelationId"===Pd[0]?Ad=Pd[1]:"LaunchSelectionMode"===Pd[0]&&(Od=Pd[1]))});yc={["LaunchMode"]:gd,["CorrelationId"]:Ad,["LaunchSelectionMode"]:Od,["Location"]:"taskPane"};
ma.b(this.$).Cd(N.a.tYg,yc,void 0,!0);'"Default"'===gd?x.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(Pd=>{Pd.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===gd?x.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(Pd=>{Pd.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===gd&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?x.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(Pd=>
{Pd.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===gd&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&x.a.instance.Vb("Common.ISystemInitiatedFeedback").execute(Pd=>{Pd.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else U.a.Xci()&&"FA000000043"===this.lf.PrimaryMarketplace.SolutionId?"Record Actions"===this.lf.TaskpaneTitle&&(this.$.Taa=!1,r.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.lf.PrimaryMarketplace.SolutionId===W.a&&this.klf(!1);ka.HelperMethods.qw(this.lf)?this.hg(!1):(U.a.zd(this.$)?this.T6.hideTaskPane(this.rW):this.raiseEvent("AgavePaneRemovedEventKey"),this.oj.tPa(this.lf.InstanceId),U.a.zd(this.$)||this.T6.Vw());wa.g(this.$).setFocus();if(1===this.lf.WebExtensionOsfControlType&&!Tc){this.lf.TaskpaneVisible=!1;const gd=this.$.pa.va.Qb();Tc=(Ad,Od,Pd)=>L.c(this.$.pa.va,
this.lf.InstanceId,!1,Ad,Od,Pd,gd);S.EwaSettings.fc()?R.a(this.$.userOperationManager,Tc,Ad=>new M.a(547,0,Ad,64),null):R.a(this.$.userOperationManager,Tc,Ad=>new J.a(547,0,Ad,0),null)}return!0};this.jzf=(yc,Tc)=>{Object.getType(Tc)===String&&Tc.toString()===this.lf.InstanceId&&(U.a.zd(this.$)?this.T6.hideTaskPane(this.rW):this.raiseEvent("AgavePaneRemovedEventKey"))};this.izf=(yc,Tc)=>{Object.getType(Tc)===String&&Tc.toString()===this.lf.InstanceId&&(this.LVd(),U.a.zd(this.$)?this.K5():this.T6.WF(this,
!0))};this.onResize=()=>{this.P6c()};this.$=Gc;this.T6=Nb;this.domElement.innerHTML=String.format(this.NHg,la,this.$.Bb+H.a.Sne,this.$.Bb+H.a.Rne);this.Ijg=fa.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+H.a.Rne);this.ira=fa.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+H.a.Sne);S.EwaSettings.ma(421)&&(this.yYb=fa.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));Pb=fa.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");
this.yna=this.p4g();Pb.appendChild(this.yna);z.a.instance.ra(B.a.click,this.yna,this.$ka);this.ahc=y.KeyInputManager.instance.ls(this.yna,this.$ka,u.a.Zh);U.a.zd(this.$)||y.KeyInputManager.instance.ra(B.a.Mb,this.yna,this.onCloseButtonTabKeyDown);fa.DOMElementExtensions.setVisible(this.ira,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.P6c();this.$&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
this.domElement.classList.add(E.a.uMe);this.$.GA(this.onResize)}bP(Pb){this.addHandler("AgavePaneRemovedEventKey",Pb)}pR(Pb){this.removeHandler("AgavePaneRemovedEventKey",Pb)}dDg(Pb){this.addHandler("AgavePaneReadyKey",Pb)}z$i(Pb){this.removeHandler("AgavePaneReadyKey",Pb)}get pFa(){return this.Ijg}get Wg(){return 6}get Sk(){return this.lf.TaskpaneIconCssClass||""}get QM(){return this.lf.TaskpaneButtonTooltip||this.lf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.A6d}get wo(){return this.lf.TaskpaneWidth}get isResizable(){const Pb=
Gc=>{var Nb,yc;return(null===(yc=null===(Nb=this.lf)||void 0===Nb?void 0:Nb.PrimaryMarketplace)||void 0===yc?void 0:yc.SolutionId)===Gc};return!OSF.OsfControl.isFirstPartyStoreString(this.lf.PrimaryMarketplace.MarketplaceType)&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||Pb("FA000000043")||S.EwaSettings.isChangeGateEnabled("OfficeVSO:6130323_PowerBiSDXResize")&&Pb("FA000000054")||S.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&
Pb("FA000000005")?!0:!1}get Zd(){return X.a.OHg}get lc(){return this.domElement}get jf(){return!!this.lf}get title(){return this.oj.uLh(this.lf.InstanceId)}get titleText(){return this.title}get jYa(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.lf.InstanceId}get rW(){return"AgaveTaskPane-"+this.instanceId.replace(RegExp("[{}]","g"),"")}get LB(){const Pb=this.T6.iua(this.lc,this.titleText,this.wo,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=
!0},()=>{this.isVisible=!1},this.wo,void 0,this.iconUrl,this.lf.TaskpaneIconId,ka.HelperMethods.qw(this.lf));if(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.lf.SrcLocationOverrideResourceId===this.Xac){Pb.contentProps.type="OcvFeedbackTaskPaneProps";Pb.hideHeader=!1;let Gc=JSON.parse(this.lf.OsfPropertyBag[0][1]);Pb.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:Gc,taskPaneLocation:Pb.location,taskPaneIdToClose:this.rW}}return Pb}startEdit(){return!0}ixc(){return!0}Shf(){this.oj.Qh.notifyAgave(this.lf.InstanceId,
OSF.AgaveHostAction.TabIn)}Thf(){this.oj.Qh.notifyAgave(this.lf.InstanceId,OSF.AgaveHostAction.TabInShift)}gzd(){this.oj.Ile(this.jzf);this.oj.JDg(this.izf);let Pb=this.oj.Ybd(this.lf.InstanceId);this.title&&Pb||this.oj.MDg(this.mmc);this.title&&this.rJe();this.raiseEvent("AgavePaneReadyKey");U.a.zd(this.$)&&(""!==this.Sk&&e.a.gf(10),this.xH(),S.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&U.a.zd(this.$)&&ka.HelperMethods.qw(this.lf)&&this.lf.Preload&&!this.lf.TaskpaneVisible?
this.d3b():this.K5())}d3b(){this.T6.d3b(this.rW,this.LB)}K5(){this.T6.K5(this.rW,this.LB)}dispose(){var Pb,Gc;this.OIf||(null===(Gc=null===(Pb=this.lf)||void 0===Pb?void 0:Pb.PrimaryMarketplace)||void 0===Gc?void 0:Gc.SolutionId)!==W.a||this.klf(!0);z.a.instance.Ba(B.a.click,this.yna,this.$ka);y.KeyInputManager.instance.Ev(this.yna,this.ahc);U.a.zd(this.$)||y.KeyInputManager.instance.Ba(B.a.Mb,this.yna,this.onCloseButtonTabKeyDown);this.oj&&(this.oj.aaj(this.mmc),this.oj.Z$i(this.jzf),this.oj.Y$i(this.izf),
this.$&&(this.$.AD(this.onResize),this.$=null));this.$=this.lf=null;super.dispose()}xH(){this.domElement.classList.add(aa);this.lf&&this.P$f()}cR(Pb){Pb||this.LVd()}hg(Pb){if(this.lf){const Gc=this.lf.TaskpaneVisible!==Pb;this.lf.TaskpaneVisible=Pb;U.a.zd(this.$)?Pb||this.T6.hideTaskPane(this.rW):this.T6.Vw();ka.HelperMethods.qw(this.lf)&&Gc&&this.oj.eAh(this.instanceId,Pb)}}hp(){let Pb=!1;this.lf&&this.$.Bd&8388608&&(Pb=this.lf.TaskpaneVisible);return Pb}Yr(){return!this.lf||OSF.OsfControl.isFirstPartyStoreString(this.lf.PrimaryMarketplace.MarketplaceType)||
this.$.j9?ka.HelperMethods.qw(this.lf)?this.lf.TaskpaneVisible:!!this.lf:!1}gg(Pb,Gc){return Gc?!1:(this.LVd(),this.oj.Qh.notifyAgave(this.lf.InstanceId,Pb?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}hh(Pb){return fa.DOMElementExtensions.uf(this.lc,Pb)}kj(){}Mj(){}nQ(Pb,Gc){var Nb=Gc.querySelectorAll(fa.DOMElementExtensions.lr);Gc=fa.DOMElementExtensions.Ll(Nb);Nb=fa.DOMElementExtensions.iz(Nb);let yc=!1;Gc===Pb.Cb&&Pb.Ca.shiftKey?((Pb=document.getElementById(this.$.Bb+H.a.tkc))&&
fa.DOMElementExtensions.isVisible(Pb)?fa.DOMElementExtensions.setFocus(Pb):this.gg(!1,!1),yc=!0):Nb!==Pb.Cb||Pb.Ca.shiftKey||(this.rYf(),yc=!0);return yc}rYf(){this.yna&&fa.DOMElementExtensions.setFocus(this.yna)}p4g(){const Pb=document.createElement("a");Pb.tabIndex=0;Pb.id="AgaveTaskpaneCloseButtonId";Pb.className=H.a.sdb+(A.AFrameworkApplication.isRtl?H.a.O$:H.a.P$);Pb.title=V.a.instance.ga(10);Pb.setAttribute(K.a.Kd,K.a.Ps);Pb.style.borderColor="transparent";S.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?
Pb.style.margin="6px 6px 0px 6px":Pb.style.margin="6px";Pb.style.zIndex="2";Pb.style.position="relative";const Gc=document.createElement("span");Gc.className="StandardButtonImage clip16x16 StandardButtonImageNoText";Gc.id=Pb.id+"-close";const Nb=ab.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,V.a.instance.ga(794));Gc.appendChild(Nb);Pb.appendChild(Gc);return Pb}rJe(){this.ira.innerText=this.title;this.ira.style.textOverflow="ellipsis";this.ira.style.whiteSpace="nowrap";this.ira.style.overflowX=
"hidden";this.lf.TaskpaneTitleCssClass&&(this.ira.className=this.ira.className+" "+this.lf.TaskpaneTitleCssClass);S.EwaSettings.ma(421)&&(this.yYb.className=this.yYb.className+" "+this.lf.TaskpaneHeaderCssClass);fa.DOMElementExtensions.setVisible(this.ira,!0);this.button&&(this.button.vZa.title=this.title);this.P6c();this.I8f=!0}P$f(){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.Sk&&!U.a.zd(this.$)){if(this.button){var Pb=e.a.gf(10),Gc=this.button.wl;
Gc.setAttribute("src",Pb);Gc.setAttribute("class",this.Sk)}return}}else if(this.Sk){this.button&&(Pb=e.a.gf(10),Gc=this.button.wl,Gc.setAttribute("src",Pb),Gc.setAttribute("class",this.Sk));return}if(Pb=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.lf.TaskpaneIconUrl?this.lf.TaskpaneIconUrl:this.oj.Ybd(this.lf.InstanceId):this.oj.Ybd(this.lf.InstanceId))this.$.Uja&&this.lf.PrimaryMarketplace&&this.lf.PrimaryMarketplace.SolutionId===F.a.solutionId&&(Pb=this.$Oh(Pb)),
U.a.zd(this.$)?this.A6d=Pb:(Gc=this.button.wl,Gc.setAttribute("src",Pb),Gc.setAttribute("onerror","this.onerror = null;this.src = '"+e.a.current.Rn(101)+"';")),this.Fid=!0}$Oh(Pb){const Gc=F.a.b0e(this.$),Nb=F.a.$2a(this.$),yc=F.a.bvb(this.$),Tc=F.a.I_e(this.$),gd=this.lf.SrcLocationOverrideResourceId,Ad=U.a.zd(this.$);return gd===Gc?Ad?Pb.replace("/icon-32.png","/record-tp-20.png"):Pb.replace("/icon-32.png","/record-tp-32.png"):gd===Nb?Ad?Pb.replace("/icon-32.png","/code-tp-20.png"):Pb.replace("/icon-32.png",
"/code-tp-32.png"):gd===yc?Ad?Pb.replace("/icon-32.png","/rfb-tp-20.png"):Pb.replace("/icon-32.png","/rfb-tp-32.png"):gd===Tc?Ad?Pb.replace("/icon-32.png","/flowconnector-tp-20.png"):Pb.replace("/icon-32.png","/flowconnector-tp-32.png"):Pb}P6c(){this.$&&!S.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&(this.pFa.style.height=ka.HelperMethods.qc(this.T6.mO.offsetHeight-this.yYb.offsetHeight))}LVd(){this.oj.Pwd(this)}klf(Pb){Pb={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:Pb.toString()};
const Gc=new Ca.a(Na.a.Rk());Gc.add("PaneClosedTime",3);Gc.add("IsSessionEnded",1);G.a.sendTelemetryEvent(Object(w.a)(new ba.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:T.a.Tj(Pb,Gc)}));this.OIf=!0}}Object(c.a)(sa,"AgaveTaskPane",P.a,[110,222,247,251]);class ea extends m.a{constructor(Pb){super();this.tBd=[];this.ADf=null;this.Lsf=Gc=>{this.qb(Object(l.a)(222,Gc))};this.$=Pb;this.Fb()}create(){n.TaskExtensions.Aa(v.a(this.$),Pb=>{Pb=new sa(document.createElement("div"),this.$,
Pb.result);this.tBd.push(Pb);Pb.dDg(this.Lsf);this.Qa.raiseEvent(m.a.rWc,null,Pb)},this.la,3)}dispose(){for(const Pb of this.tBd)Pb.z$i(this.Lsf);k.a.rc(this.tBd);k.a.Ia(this.ADf);this.$=this.ADf=null;super.dispose()}}Object(c.a)(ea,"AgaveTaskPaneFactory",m.a,[]);var Z=a(83),ua=a(258),ya=a(353),ha=a(552),Da=a(18),nb=a(17);class qa extends Sys.EventArgs{constructor(Pb,Gc,Nb){super();this.dzb=Nb}}Object(c.a)(qa,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var pa=a(44),Ja=a(38),$a=a(234);const rb=
E.a.sph,Pa=E.a.uph,eb=`<span class='${za.a.$0b} ${E.a.vph} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class Ob extends $a.a{constructor(Pb){super(document.createElement("a"));this.Qa=new Ja.a;this.Fge=null;this.dd=()=>{this.enabled&&this.Qa.raiseEvent("tpButtonClicked",null,this);return!0};this.rtl=Pb}pDg(Pb){this.Qa.addHandler("tpButtonClicked",Pb)}OOf(Pb){this.Qa.removeHandler("tpButtonClicked",Pb)}get vZa(){return this.domElement}get taskPane(){return this.Fge}get enabled(){return super.enabled}set enabled(Pb){Pb!==
super.enabled&&(this.domElement.classList.toggle(E.a.MT),this.domElement.classList.toggle(Pa),this.domElement.tabIndex=Pb?0:-1,super.enabled=Pb)}get wl(){return this.domElement.firstChild.firstChild}dispose(){k.a.rc([this.Qa]);this.Qa=null;this.domElement&&pa.a.ama(this.domElement);super.dispose()}kai(Pb){const Gc=6===Pb.Wg,Nb=Gc&&!Pb.Sk;this.domElement.innerHTML=String.format(eb,Pb.QM,Pb.Sk,Nb?e.a.current.Rn(101):e.a.gf(10),E.a.pha,Nb?String.format('style="width:24px;{0}:0px"',this.rtl?"right":"left"):
"");this.domElement.classList.add(rb);this.domElement.classList.add(Pa);this.domElement.title=Pb.QM;this.domElement.tabIndex=0;fa.DOMElementExtensions.ru(this.domElement,H.a.Ps,null,null);this.Fge=Pb;Gc&&this.taskPane.xH();z.a.instance.ra(B.a.click,this.domElement,this.dd);y.KeyInputManager.instance.ls(this.domElement,this.dd,u.a.Zh)}}Object(c.a)(Ob,"TaskPaneButton",$a.a,[274]);class tb extends P.a{constructor(Pb,Gc,Nb){super(Pb);this.animationManager=this.K4=this.xe=null;this.VI=this.dUa=!1;this.Z2d=
0;this.jb=null;this.pJc=!1;this.Gz=()=>{this.whi||(this.Vw(),this.$.pf())};this.Uxd=(yc,Tc)=>{this.onButtonClick(yc,Tc)};this.n5=()=>{this.hNb()};r.ULS.sendTraceTag(523379010,9,50,"NovDeprecation: NovToolbarControl");this.$=Gc;ua.a(this.$).Xh(this);this.$.yb.Pf(this.n5);this.configuration=Nb;this.baseName=ka.HelperMethods.PY(this.domElement,this.configuration.QTd||this.configuration.rW);this.y7b={};this.udb=[];this.Jt=[];this.nob={};this.Gge=document.getElementById(this.baseName+this.configuration.Wxc);
this.mO||r.ULS.sendTraceTag(537151132,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+this.configuration.Wxc} not found`);this.zwg=document.getElementById(this.baseName+this.configuration.rW);this.Dv||r.ULS.sendTraceTag(537151131,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+this.configuration.rW} not found`);this.Awg=document.getElementById(this.baseName+this.configuration.Iyc);this.mL||r.ULS.sendTraceTag(537151130,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+
this.configuration.Iyc} not found`);this.mL.innerHTML=String.format(tb.nHj,this.baseName+this.configuration.TUd,this.baseName+tb.ZLb);this.o1d=document.getElementById(this.baseName+tb.ZLb);this.qXc||r.ULS.sendTraceTag(537151129,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+tb.ZLb} not found`);(this.mob=document.getElementById(this.baseName+tb.ZLb))||r.ULS.sendTraceTag(537151128,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+tb.ZLb} not found`);this.Dlg=
this.h2c(this.configuration.C_c,this.A_c);this.Clg=tb.QBe(this.configuration.B_c,V.a.instance.ga(1295),this.N_h,this.rGa,!0);this.wng=this.h2c(this.configuration.Q8c,this.ZPe);this.vng=tb.QBe(this.configuration.N8c,V.a.instance.ga(1294),this.O_h,this.Wha,!1);fa.DOMElementExtensions.setVisible(this.Wha,!1);z.a.instance.ra(B.a.click,this.m_a,Object(Z.a)(this,this.lDb,"onCollapseIconClicked"));z.a.instance.ra(B.a.click,this.uIa,Object(Z.a)(this,this.wDb,"onExpandIconClicked"));z.a.instance.ra(B.a.click,
this.rGa,Object(Z.a)(this,this.lDb,"onCollapseIconClicked"));z.a.instance.ra(B.a.click,this.Wha,Object(Z.a)(this,this.wDb,"onExpandIconClicked"));y.KeyInputManager.instance.ra(B.a.Mb,this.m_a,Object(Z.a)(this,this.gyd,"onCollapseIconKeyDown"));y.KeyInputManager.instance.ra(B.a.Mb,this.uIa,Object(Z.a)(this,this.Cyd,"onExpandIconKeyDown"))}mE(Pb){this.addHandler(tb.sTa,Pb);Pb(this,new qa(this.isVisible,fa.DOMElementExtensions.isVisible(this.mL),this.dzb))}SF(Pb){this.removeHandler(tb.sTa,Pb)}get mL(){return this.Awg}get lc(){return this.mL}get jf(){return this.dUa}set jf(Pb){this.dUa=
Pb}get Dv(){return this.zwg}get Zd(){return X.a.zDi}get mO(){return this.Gge}get aA(){return this.Jt}get Bg(){return this.xe}get KP(){return null}get Sfa(){return null}get isCollapsed(){return this.VI}get P3b(){return this.Z2d}get $(){return this.jb}set $(Pb){this.jb=Pb}get qXc(){return this.o1d}get m_a(){return this.Clg}get uIa(){return this.vng}get rGa(){return this.Dlg}get Wha(){return this.wng}get whi(){return this.pJc}get O_h(){return this.$.Ol&&this.$.isChromeRtl?this.configuration.o7b:this.configuration.l1b}get N_h(){return this.$.Ol&&
this.$.isChromeRtl?this.configuration.l1b:this.configuration.o7b}mqb(Pb,Gc,Nb,yc,Tc){let gd=Pb.za(Gc);gd||(gd=nb.a(Da.a,Nb,Pb,Gc),gd.SetScriptLoadFlavor(Tc));yc&&gd.jTc(yc);const Ad=""+Gc;Ad in this.y7b||gd.fYb((Md,ge)=>{this.w5(ge)});let Od=null;const Pd=()=>{gd.create();Od()};this.y7b[Ad]=Od=()=>{gd.Nqc(Pd);delete this.y7b[Ad]};gd.HXb(Pd)}dispose(){if(this.Jt)for(let Gc=0,Nb=this.Jt.length;Gc<Nb;Gc++)this.Jt[Gc].OOf(this.Uxd),this.Jt[Gc].dispose();const Pb=this.y7b;for(let Gc in Pb)({key:Gc,value:Pb[Gc]}).value();
this.$.ea&&this.$.yb&&this.$.yb.Ag(this.n5);this.mob=this.o1d=this.Gge=this.xe=this.nob=this.udb=this.Jt=null;z.a.instance.Ba(B.a.click,this.m_a,Object(Z.a)(this,this.lDb,"onCollapseIconClicked"));z.a.instance.Ba(B.a.click,this.uIa,Object(Z.a)(this,this.wDb,"onExpandIconClicked"));z.a.instance.Ba(B.a.click,this.rGa,Object(Z.a)(this,this.lDb,"onCollapseIconClicked"));z.a.instance.Ba(B.a.click,this.Wha,Object(Z.a)(this,this.wDb,"onExpandIconClicked"));y.KeyInputManager.instance.Ba(B.a.Mb,this.m_a,Object(Z.a)(this,
this.gyd,"onCollapseIconKeyDown"));y.KeyInputManager.instance.Ba(B.a.Mb,this.uIa,Object(Z.a)(this,this.Cyd,"onExpandIconKeyDown"));super.dispose()}gg(Pb,Gc){if(Gc)return!1;this.xe&&!this.isCollapsed?(Pb=this.Bg.taskPane,Pb.jf&&Pb.gg(!0,!1)||fa.DOMElementExtensions.setFocus(this.Bg.vZa)):fa.DOMElementExtensions.setFocus(this.uIa);return!0}hh(Pb){return this.isVisible?fa.DOMElementExtensions.uf(this.domElement,Pb)||fa.DOMElementExtensions.uf(this.domElement,fa.DOMElementExtensions.Aub(Pb)):!1}kj(){}Mj(){this.xe&&
this.xe.taskPane.Mj()}setFocusOnToolbarFirstElement(){this.isCollapsed?fa.DOMElementExtensions.setFocus(this.uIa):fa.DOMElementExtensions.setFocus(this.m_a)}nNd(){for(let Pb=this.Jt.length-1;0<=Pb;Pb--)if(this.Jt[Pb].isVisible){fa.DOMElementExtensions.setFocus(this.Jt[Pb].vZa);return}this.setFocusOnToolbarFirstElement()}qvb(Pb){const Gc=[];for(let Nb=this.Jt.length-1;0<=Nb;Nb--)this.Jt[Nb].taskPane.Wg===Pb&&Gc.push(this.Jt[Nb].taskPane);return Gc}pbd(Pb){const Gc=[];for(let Nb=0;Nb<this.Jt.length;Nb++)this.Jt[Nb].taskPane.Wg===
Pb&&Gc.push(this.Jt[Nb]);return Gc}ble(Pb){if(Pb){let Gc;const Nb=Object(l.a)(222,Pb);Nb?(Gc=new Ob(this.$.Ol&&this.$.isChromeRtl),Gc.domElement.id=this.baseName+"bt_"+Pb.Wg.toString()+"_"+Pb.lf.InstanceId,this.mob.appendChild(Gc.domElement),this.nob["6"]=Gc,Nb.button=Gc):Gc=this.nob[Pb.Wg.toString()];Gc.kai(Pb);Gc.pDg(this.Uxd);Gc.isVisible=Pb.hp();Gc.enabled=Pb.Yr();this.udb.push(Pb);this.Jt.push(Gc);this.$.Ol&&Pb.xH();tb.EAi(Pb,this.mO);this.tkh(Gc);this.hNb()}}WF(Pb,Gc){let Nb;for(const yc of this.Jt)Nb=
yc.taskPane,Nb.Wg===Pb.Wg&&Nb==Pb&&this.u0b(yc,Gc)}iua(){r.ULS.shipAssertTag(537151124,11,!1,"NovToolbarControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}K5(){r.ULS.shipAssertTag(537151123,11,!1,"NovToolbarControl.ShowTaskPane: should only be used with WAC infra.")}d3b(){r.ULS.shipAssertTag(528023624,11,!1,"NovToolbarControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){r.ULS.shipAssertTag(537151122,11,!1,"NovToolbarControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){r.ULS.shipAssertTag(537151121,
11,!1,"NovToolbarControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){r.ULS.shipAssertTag(537151120,11,!1,"NovToolbarControl.HideTaskPane: should only be used with WAC infra.")}q2f(Pb,Gc){Pb?(this.pJc=!0,this.cKb(!1)):(this.pJc=!1,this.cKb(!0),Gc&&(this.Vw(),this.$.pf()))}tQ(Pb){if(!this.udb.includes(Pb)){let Nb=null;Nb=()=>{this.k$i(Pb);Pb.pR(Nb)};Pb.bP(Nb);this.ble(Pb);var Gc=Object(l.a)(249,Pb);Gc&&(Gc.mE(this.Gz),this.Gz(Gc,Sys.EventArgs.Empty));if(Gc=Object(l.a)(134,
Pb))Gc.mE(this.Gz),this.Gz(Gc,Sys.EventArgs.Empty);if(Gc=Object(l.a)(250,Pb))Gc.mE(this.Gz),this.Gz(Gc,Sys.EventArgs.Empty);this.$.Ol&&Pb.xH();this.raiseEvent(tb.AEf,null,Pb);this.Vw()}}u0b(Pb,Gc){if(Pb.taskPane.Yr()&&Pb.taskPane.hp()){if(this.xe){this.xe.domElement.classList.remove(tb.ylb);this.xe.taskPane.isVisible=!1;if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Nb=Object(l.a)(222,this.xe.taskPane);Nb&&Nb.oj.vHd(Nb.lf.InstanceId)}this.K4=this.xe}this.xe=Pb;this.xe.taskPane.isVisible=
!0;this.xe.domElement.classList.add(tb.ylb);Gc&&this.LJ(!1,!1);this.Feb()}}onButtonClick(Pb){let Gc=!1;if(this.xe!==Pb){Gc=!0;const Nb=Pb.taskPane.lc;this.animationManager.UZi(Nb);if(this.xe){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const yc=Object(l.a)(222,this.xe.taskPane);yc&&yc.oj.vHd(yc.lf.InstanceId)}this.xe.taskPane.isVisible=!1;this.xe.domElement.classList.remove(tb.ylb)}this.K4=this.xe;this.xe=Pb;this.xe.domElement.classList.add(tb.ylb);this.xe.taskPane.isVisible=
!0;this.Feb();this.animationManager.mwh(Nb)}this.LJ(!(this.isCollapsed||Gc),!1)}Feb(){const Pb=this.P3b;let Gc=0;this.xe&&(Gc=this.xe.taskPane.vu?this.xe.taskPane.vu:this.xe.taskPane.wo);if(Gc!==Pb){this.Z2d=Gc;const Nb=this.$.Ol?ya.a.qBd+ya.a.N0c:0;this.isCollapsed||(this.animationManager&&this.xe?this.animationManager.Lmb(this.Dv,Pb+Nb,Gc+Nb,this.Bg.taskPane):this.Dv.style.width=ka.HelperMethods.qc(Gc+Nb));this.kza();this.raiseEvent(tb.I3f,null,this)}}FE(Pb){const Gc=new Ob(this.$.Ol&&this.$.isChromeRtl);
Gc.isVisible=!1;Gc.domElement.id=this.baseName+"bt_"+Pb.toString();this.mob.appendChild(Gc.domElement);this.nob[Pb.toString()]=Gc}hNb(){if(void 0!==this.Jt&&null!==this.Jt){void 0===this.xe||null===this.xe||this.xe.taskPane.Yr()||(this.xe.domElement.classList.remove(tb.ylb),this.xe.taskPane.isVisible=!1,this.xe.taskPane.hp()&&(this.K4=this.xe),this.xe=null);var Pb=null;for(let Gc=0;Gc<this.Jt.length;Gc++)if(this.udb[Gc].hp()){const Nb=this.udb[Gc].Yr();(this.Jt[Gc].enabled=Nb)&&!Pb&&(Pb=this.Jt[Gc])}void 0!==
this.xe&&null!==this.xe||!Pb||(void 0!==this.K4&&null!==this.K4&&this.K4.taskPane.Yr()&&this.K4.taskPane.hp()?this.u0b(this.K4,!1):this.u0b(Pb,!1));void 0!==ha.a(this.$)&&null!==ha.a(this.$)&&ha.a(this.$).isVisible&&void 0!==this.xe&&null!==this.xe&&1!==this.xe.taskPane.Wg&&(ha.a(this.$).isVisible=!1);void 0!==this.xe&&null!==this.xe&&7!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(52),null===Pb||void 0===Pb?0:Pb.isVisible)&&(Pb.isVisible=!1);void 0!==this.xe&&null!==this.xe&&8!==this.xe.taskPane.Wg&&(Pb=
this.$.da.za(233))&&(Pb.isVisible=!1);void 0!==this.xe&&null!==this.xe&&9!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(248))&&(Pb.isVisible=!1);S.EwaSettings.ma(296)&&void 0!==this.xe&&null!==this.xe&&12!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(302))&&(Pb.isVisible=!1);S.EwaSettings.ma(480)&&void 0!==this.xe&&null!==this.xe&&15!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(365))&&(Pb.isVisible=!1);U.a.Zpd(this.$)&&void 0!==this.xe&&null!==this.xe&&13!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(334))&&(Pb.isVisible=
!1);void 0!==this.xe&&null!==this.xe&&14!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(346))&&(Pb.isVisible=!1);void 0!==this.xe&&null!==this.xe&&16!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(371))&&(Pb.isVisible=!1);S.EwaSettings.Rfc()&&void 0!==this.xe&&null!==this.xe&&17!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(408))&&(Pb.isVisible=!1);S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.xe&&null!==this.xe&&18!==this.xe.taskPane.Wg&&(Pb=this.$.da.za(415))&&
(Pb.isVisible=!1);this.Feb()}}qRe(Pb,Gc){fa.DOMElementExtensions.setVisible(this.rGa,!Pb);fa.DOMElementExtensions.setVisible(this.Wha,Pb);Pb&&this.raiseEvent(tb.Mye,null,this);this.Feb();Gc&&fa.DOMElementExtensions.setFocus(Pb?this.uIa:this.m_a)}dva(Pb,Gc){this.$.xd(Pb,Gc,26,null)}w5(Pb){Pb.ZN&&this.tQ(Pb.ZN)}k$i(Pb){if(Pb){const Gc=this.Jt.length;let Nb=!1;for(let yc=0;yc<Gc;yc++){const Tc=this.Jt[yc];if(Tc.taskPane===Pb){this.mob.removeChild(Tc.vZa);delete this.nob[Pb.Wg.toString()];Array.remove(this.udb,
Pb);Array.remove(this.Jt,Tc);Tc.OOf(this.Uxd);Tc.taskPane.lc.parentNode.removeChild(Tc.taskPane.lc);this.xe&&this.xe.taskPane===Tc.taskPane&&(this.xe=null);this.K4&&this.K4.taskPane===Tc.taskPane&&(this.K4=null);Nb=!0;break}}Nb&&this.hNb()}}tkh(Pb){const Gc=Pb.taskPane.Wg,Nb=this.$.Ol,yc=!!this.xe&&1===this.xe.taskPane.Wg;(Nb&&0===Gc||!Nb&&(1===Gc||!yc&&2===Gc))&&this.u0b(Pb,!1)}static EAi(Pb,Gc){const Nb=Pb.lc;Nb.parentNode&&Nb.parentNode.removeChild(Nb);Gc.appendChild(Nb);Pb.isVisible=!1}static QBe(Pb,
Gc,Nb,yc,Tc){const gd=document.createElement("a");gd.setAttribute(H.a.HX,Tc?H.a.jk:H.a.cr);gd.setAttribute(H.a.Kd,H.a.Ps);gd.tabIndex=0;gd.classList.add(za.a.RA);gd.classList.add(Pb);gd.classList.add(E.a.rph);gd.innerHTML=String.format(tb.AWg,Gc,Nb,e.a.gf(10));yc.appendChild(gd);return gd}}tb.sTa="tpVisibility";tb.nHj=`<div id='{0}' class='${E.a.xph}'><div id='{1}' class='${E.a.wph}'></div></div>`;tb.AWg="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";tb.ZLb="novTaskpaneButtonGroup";tb.ylb=E.a.tph;
tb.I3f="tpSizeChanged";tb.Mye="tpCollapsed";tb.AEf="tpAdded";Object(c.a)(tb,"NovToolbarControl",P.a,[239,110,3]);var cc=a(522),Ib=a(104),Mb=a(511);class Oa{constructor(){this.o7b=this.l1b=this.N8c=this.B_c=this.Q8c=this.C_c=this.TUd=this.Iyc=this.Wxc=this.rW=this.QTd=null}}Object(c.a)(Oa,"Configuration",null,[]);class Aa extends tb{constructor(Pb,Gc){super(Pb,Gc,Aa.M1c());this.Leb=!1;this.Hi=()=>{this.Bxd()};this.nmc=Nb=>{r.ULS.sendTraceTag(521405900,9,50,"NovDeprecation: onPaneSectionKeyDown");var yc=
!1;if(9===Nb.Ca.keyCode){var Tc=this.domElement.querySelectorAll(ya.a.BEf);yc=fa.DOMElementExtensions.Ll(Tc);Tc=fa.DOMElementExtensions.iz(Tc);yc=fa.DOMElementExtensions.Kma(Nb.Ca,yc,Tc)}else 27===Nb.Ca.keyCode&&this.Bg.taskPane.hg(!1);return yc};r.ULS.sendTraceTag(523379012,9,50,"NovDeprecation: NovActionToolbarControl");y.KeyInputManager.instance.ra(B.a.Mb,this.domElement,this.nmc)}get jf(){return!0}set jf(Pb){super.jf=Pb}get Zd(){return X.a.vDi}get dzb(){return this.$.isChromeRtl}get A_c(){return this.Dv}get ZPe(){return this.mL}initialize(){this.FE(3);
this.FE(4);this.FE(5);this.Vw()}dispose(){y.KeyInputManager.instance.Ba(B.a.Mb,this.domElement,this.nmc);super.dispose()}Vw(){let Pb=0;const Gc=this.aA;for(let Nb=Gc.length-1;0<=Nb;Nb--){const yc=Gc[Nb].taskPane.hp();(Gc[Nb].isVisible=yc)&&Pb++}this.cKb(0<Pb);fa.DOMElementExtensions.setVisible(this.qXc,1<Pb);this.hNb()}nJd(){}Bxd(){wa.g(this.$).Ea.uv(this.Hi);Mb.a(this.$).Ea.uv(this.Hi);Ib.a(this.$);this.Bg&&3===this.Bg.taskPane.Wg?this.$.NT.Ea.iZ()&&this.LJ(!0,!1):this.Leb||this.LJ(!1,!1)}LJ(Pb,
Gc){if(this.isCollapsed!==Pb){var Nb=this.P3b+ya.a.qBd+ya.a.N0c;this.VI=!this.isCollapsed;this.animationManager.Lmb(this.Dv,Pb?Nb:0,Pb?0:Nb,this.Bg.taskPane);this.animationManager.IIg(this.Wha,Pb);this.qRe(Pb,Gc)}}cKb(Pb){const Gc=this.isVisible!==Pb;fa.DOMElementExtensions.setVisible(this.Dv,Pb);Gc&&this.raiseEvent(tb.sTa,new qa(Pb,Pb,!this.dzb),this)}onButtonClick(Pb,Gc){super.onButtonClick(Pb,Gc);this.Leb=this.isCollapsed}lDb(Pb){if(Pb.Cb===this.rGa&&3!==Pb.tb)return!1;this.dva(329273335,Pb.tb);
this.LJ(!0,!0);return this.Leb=!0}wDb(Pb){if(Pb.Cb===this.Wha&&3!==Pb.tb)return!1;this.dva(1962240939,Pb.tb);this.LJ(!1,!0);this.Leb=!1;return!0}gyd(Pb){return 13===Pb.Ca.keyCode?(this.dva(329273335,Pb.tb),this.LJ(!0,!0),this.Leb=!0):!1}Cyd(Pb){return 13===Pb.Ca.keyCode?(this.dva(1962240939,Pb.tb),this.LJ(!1,!0),this.Leb=!1,!0):!1}kza(){}h2c(Pb,Gc){const Nb=document.createElement("div");Nb.classList.add(Pb);Gc.appendChild(Nb);return Nb}static ka(Pb){var Gc=Pb.da.za(51);if(!Gc){const Nb=cc.a(Pb.domElement);
Nb&&(r.ULS.sendTraceTag(523379011,9,50,"NovDeprecation: NovActionToolbarControl attach"),Gc=document.getElementById(ka.HelperMethods.PY(Nb,H.a.JCb)+H.a.trf),Gc=Pb.da.Ga(51,new Aa(Gc,Pb)))}return Gc}static M1c(){const Pb=new Oa;Pb.QTd=H.a.trf;Pb.rW=H.a.sDi;Pb.Wxc=H.a.rDi;Pb.Iyc=H.a.uDi;Pb.TUd=H.a.tDi;Pb.C_c=E.a.jph;Pb.Q8c=E.a.lph;Pb.B_c=E.a.iph;Pb.N8c=E.a.kph;Pb.l1b=E.a.HOe;Pb.o7b=E.a.FOe;return Pb}}Object(c.a)(Aa,"NovActionToolbarControl",tb,[]);var Ba=a(29),ob=a(211),xb=a(62),Va=a(47),bb=a(45),ra=
a(318),Qa=a(70),qb=a(22),Wa=a(283),ta=a(280);const ib=za.a.Sph,Bb=za.a.Tph,Ub=za.a.Ush,Ta=E.a.tMe,mb=`<div class="${za.a.I7c}"><div title="{0}" class="${za.a.bqh}">{0}</div></div><div><div class="${za.a.Vph}">{1}</div><div class="${za.a.Zph} ${za.a.Wo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${za.a.Uph}"><button class="${za.a.rMe} ${za.a.Rph}" id="applyButton" type="submit">{2}</button><button class="${za.a.rMe}" id="resetButton" type="button">{3}</button></div></div>`,Qb=`<div><div class="${za.a.$ph}"><label for="{2}" title="{1}">{0}</label></div><div class="${za.a.aqh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;
class Lb extends $a.a{constructor(Pb,Gc,Nb){super(Pb);this.MNd=this.DUa=this.i0=null;this.vu=0;this.wBf=()=>{this.DUa=null};this.drj=()=>{k.a.Ia(this.MNd);this.MNd=null;this.isVisible!==this.wPd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.p_g=(yc,Tc)=>qb.a.compare(yc.Name,Tc.Name,!0);this.Rsf=yc=>{Qa.g(yc);if(!this.pra.domElement.classList.contains(za.a.J6b)){wa.g(this.$).Fo(!0);var Tc=[];for(yc=0;yc<this.i0.length;yc++){const Ad=this.DUa[yc],Od=this.i0[yc].text;Ad.Values=[Od];Od&&
Tc.push(Ad)}if(Tc.length){var gd=this.$.pa.va.Qb();this.pra.addCssClass(za.a.J6b);this.$.userOperationManager.Ub(new M.a(142,0,(Ad,Od,Pd)=>xb.G(this.$.pa.va,Tc,!1,0,!1,ta.b(Ad,this.NQi),ta.a(Od,this.MQi),Pd,null,gd)),null)}}};this.zPi=yc=>{Qa.g(yc);yc=this.i0;for(let Tc=0,gd=yc.length;Tc<gd;Tc++)yc[Tc].text=""};this.NQi=()=>{this.pra.removeCssClass(za.a.J6b)};this.MQi=()=>{this.pra.removeCssClass(za.a.J6b)};this.pEb=(yc,Tc)=>{13===Tc.charCode&&this.Rsf(Tc)};this.$=Gc;this.taskPaneManager=Nb;Pb.innerHTML=
String.format(mb,this.titleText,V.a.instance.ga(1327),V.a.instance.ga(1328),V.a.instance.ga(1329));this.Gnc=this.getElementById("parametersSection");this.pra=new ra.a(this.getElementById("applyButton"));this.pra.Fc.ka("click",this.Rsf);this.CJd=new ra.a(this.getElementById("resetButton"));this.CJd.Fc.ka("click",this.zPi);this.$.ea.hk(this.wBf);ua.a(this.$).Xh(this)}bP(Pb){this.get_events().addHandler("RemoveParamTpEventKey",Pb)}pR(Pb){this.get_events().removeHandler("RemoveParamTpEventKey",Pb)}mE(Pb){this.addHandler("parameterTaskPaneVilibilityChanged",
Pb)}SF(Pb){this.removeHandler("parameterTaskPaneVilibilityChanged",Pb)}get d5b(){this.q9e();return this.DUa}get lc(){return this.domElement}get wo(){return 250}get isResizable(){return!1}get jf(){return this.isVisible}get Zd(){return X.a.qVi}get Wg(){return 2}get Sk(){return Ub}get QM(){return V.a.instance.ga(1064)}get wPd(){return!!this.d5b&&0<this.d5b.length&&!this.$.isEditMode}get titleText(){return V.a.instance.ga(1326)}get LB(){return this.taskPaneManager.iua(this.lc,this.titleText,this.wo,this.isResizable,
()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}xH(){this.domElement.classList.add(this.$.isChromeRtl?Bb:ib);this.style.width=ka.HelperMethods.qc(this.wo);this.domElement.classList.add(Ta)}hg(Pb){U.a.zd(this.$)&&(Pb?(this.q9e(),this.taskPaneManager.K5("ParametersTaskPane",this.LB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}hp(){return this.wPd}Yr(){return this.wPd}cR(){}dispose(){this.$&&this.$.ea.Hk(this.wBf);this.xOf();k.a.rc([this.pra,
this.CJd]);this.DUa=this.Gnc=this.$=this.pra=this.CJd=null;super.dispose()}gg(Pb,Gc){Gc||(this.i0&&0<this.i0.length?this.i0[0]:this.pra).focus();return!Gc}hh(Pb){return fa.DOMElementExtensions.uf(this.lc,Pb)}kj(){}Mj(){}nQ(){return!1}q9e(){!this.DUa&&this.$.Bd&2048&&this.ALg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}ALg(Pb,Gc){var Nb=[];this.xOf();if(!this.$.isEditMode&&Pb&&0<Pb.length){var yc=this.p_g;if(Gc&&0<Gc.length){var Tc=new ob.a([...Gc]);Tc.m9.sort(yc)}else Tc=
null;for(let Ad=0,Od=Pb.length;Ad<Od;Ad++){var gd=Pb[Ad];Gc&&!(0>ka.HelperMethods.qx(Tc,0,Tc.Nia(),gd,yc))||gd.IsPivotPageField||gd.IsSlicer||Nb.push(gd)}}this.DUa=Nb;if(this.Gnc&&(this.$.Ol||this.isVisible===0<Nb.length||(this.MNd=Va.a.instance.create(this.drj,500,bb.a.rVi,!0,!0)),this.Gnc.innerHTML="",Nb.length)){Gc="";Pb=[];for(let Ad=0,Od=Nb.length;Ad<Od;Ad++)yc=this.$.Bb+"param"+Ad,Pb.push(yc),gd=Nb[Ad],Tc=gd.Name?Ba.a.Dg(gd.Name):"",gd=gd.Comment?Ba.a.XY(gd.Comment):"",Gc+=String.format(Qb,
Tc,gd,yc);this.Gnc.innerHTML=Gc;Gc=[];for(let Ad=0,Od=Nb.length;Ad<Od;Ad++)Nb=new Wa.a(document.getElementById(Pb[Ad])),Gc.push(Nb),Nb.MEg(this.pEb);this.i0=Gc}}xOf(){if(this.i0){for(let Pb=0,Gc=this.i0.length;Pb<Gc;Pb++)this.i0[Pb].Oaj(this.pEb);k.a.rc(this.i0);this.i0=null}}static BLg(Pb,Gc){const Nb=Pb.da;let yc=Nb.za(17);if(!yc){const Tc=document.getElementById(Pb.Bb+H.a.sVi);Tc&&(yc=Nb.Ga(17,new Lb(Tc,Pb,Gc)))}return yc}}Object(c.a)(Lb,"ParametersTaskPane",$a.a,[133,247,110,3]);class Jb extends m.a{constructor(Pb){super();
this.$=Pb;this.Fb()}create(){n.TaskExtensions.Aa(v.a(this.$),Pb=>{this.qb(Lb.BLg(this.$,Pb.result))},this.la,3)}}Object(c.a)(Jb,"ParametersTaskPaneFactory",m.a,[]);var Ab=a(690),pb=a(181),va=a(55);class db{Qc(){return!1}executeCommand(Pb,Gc){Pb=Gc.command;switch(Pb){case 329273335:case 1962240939:case 296943390:case -625072140:return va.Task.Ua(!0);default:return pb.a(Pb)}}Ec(Pb,Gc,Nb,yc){if(Pb=!!yc&&2===yc.Vy)switch(Gc.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:Pb=!1}return Pb}Vc(){return!1}}Object(c.a)(db,"TaskPaneCommandHandler",null,[188]);class Ya extends Ab.a{constructor(Pb){super(Pb)}Dd(){this.ld([new db])}static ka(Pb){Ab.a.Rd(115,new Ya(Pb))}}Object(c.a)(Ya,"TaskPaneCommandHandlerFactory",Ab.a,[]);var gb=a(1309),Ka=a(197);class ub{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(ub,"TaskPaneGroupAppProps",null,[]);var ac=a(27),Ra=a(212);class na{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(na,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var lb=a(289),jb=a(127);class Yb{constructor(Pb){this.width=Pb}}Object(c.a)(Yb,"ActiveTaskPaneData",null,[]);class Gb extends Ja.a{constructor(Pb,Gc){super();this.isVisible=!1;this.RTd=this.zda=-1;this.BFe=
40;this.Bg=this.mL=this.animationManager=this.oFc=null;this.Oyd=()=>{this.YRf()};this.$xc=new Set;this.$xc.add("FieldListTaskPane");this.$xc.add("PivotTableSettingsTaskPane");this.$xc.add("SlicerSettingsTaskPane");this.jb=Gc;ua.a(this.$).Xh(this);this.Dv=Pb;this.f8a=this.eQg();U.a.Tk()||A.AFrameworkApplication.ta.Pa.Ef||(this.Dv.style.bottom=this.$.Ol?"":this.$.Bd&4?ka.HelperMethods.qc(this.$.tda):"0");this.z7b={};this.$Lb={};this.Z_d={};this.MTd=jb.a.instance.Vd(this.lc);this.MTd.ka("focusin",this.Oyd);
this.lai()}get $(){return this.jb}get Sfa(){return this.Z_d}get KP(){return this.oFc}get isCollapsed(){return!this.KP}dispose(){ua.a(this.$).Nz(this);const Pb=this.z7b;for(let Gc in Pb)({key:Gc,value:Pb[Gc]}).value();this.$Lb=this.Z_d=this.z7b=null;this.MTd.JC();this.f8a=this.Dv=this.MTd=null;super.dispose()}iua(Pb,Gc,Nb,yc,Tc,gd,Ad,Od,Pd=Gb.Vqi,Md=Gb.Uqi,ge=null,pe=null,Qd=!1){const he=Object(w.a)(new na,{getContent:()=>Pb});he.isSharedRuntime=Qd;return Object(w.a)(new gb.a,{hideHeader:!0,contentProps:he,
title:Gc,width:Nb,location:2,onOpen:Tc,onClose:gd,onShow:Ad,onHide:Od,iconUrl:ge,iconId:pe,enableResize:yc,minResizeWidth:Pd,maxResizeWidth:Md})}K5(Pb,Gc){Ka.UISurfaces.Lj().then(Nb=>{Pb in this.Sfa?Nb.setSelectedTaskPane(Pb):Nb.showTaskPane(Pb,Gc);return null})}d3b(Pb,Gc){Ka.UISurfaces.Lj().then(Nb=>{Nb.initializeHiddenSharedRuntimeTaskPane(Pb,Gc);const yc=this.$.domElement;yc.addEventListener("scroll",function gd(){0!=yc.scrollLeft&&(yc.scrollLeft=0,yc.removeEventListener("scroll",gd))})})}updateTaskPane(Pb,
Gc){Ka.UISurfaces.Lj().then(Nb=>{Nb.updateTaskPane(Pb,Gc);return null})}setSelectedTaskPane(Pb){Ka.UISurfaces.Lj().then(Gc=>{Gc.setSelectedTaskPane(Pb);return null})}hideTaskPane(Pb){Ka.UISurfaces.Lj().then(Gc=>{Gc.hideTaskPane(Pb,Gb.mHj);return null})}get lc(){return this.Dv}get jf(){return this.isVisible}get Zd(){return X.a.Xxc}gg(Pb,Gc){return Gc?!1:(this.UVf(),!0)}hh(Pb){return fa.DOMElementExtensions.uf(this.lc,Pb)}kj(){this.$.frame.Ee.Rj(this.Zd)}Mj(){}eQg(){const Pb=document.createElement(Ra.a.div);
Pb.style.height="0px";Pb.style.width="0px";Pb.tabIndex=-1;return Pb}gGh(){var Pb=fa.DOMElementExtensions.getElementById(this.Dv,"tabStripFocusZone");if(Pb){Pb=Pb.getElementsByTagName("button");for(let Gc=0;Gc<Pb.length;Gc++)if(Boolean.parse(Pb[Gc].getAttribute("aria-selected")))return Pb[Gc].getAttribute("aria-controls")}return null}R_g(Pb){return(Pb=window.getComputedStyle(Pb,null).getPropertyValue("transition-duration"))?parseInt(Pb.endsWith("ms")?parseFloat(Pb):1E3*parseFloat(Pb),10):0}l7i(){const Pb=
document.getElementById("tabbedTaskPaneContainer");Pb&&Pb.addEventListener("transitionend",()=>this.XFa(-1))}lai(){Ka.UISurfaces.Lj().then(Pb=>{let Gc;Pb.renderTaskPaneGroups(null,this.Dv,(Gc=new ub,Gc.middleContainer=this.f8a,Gc.onOpen=(Nb,yc)=>{this.isVisible=!0;-1===this.zda&&(this.zda=this.R_g(yc));U.a.Tk()||(this.Sfa[Nb]=new Yb(fa.DOMElementExtensions.rP(fa.DOMElementExtensions.getElementById(yc,Gb.u7f))))},Gc.onClose=Nb=>{this.isVisible=0<Pb.selectors.getTabbedTaskPaneCount();r.ULS.sendTraceTag(537014371,
0,50,`Closing of ${Nb} TaskPane`);if(!this.isVisible)this.QSe(),U.a.Tk()||A.AFrameworkApplication.ta.Pa.Ef||window.requestAnimationFrame(()=>{this.tYb(this.f8a)});else if(!U.a.Tk()&&this.KP&&this.KP!==Nb){const yc=1<Pb.selectors.getTabbedTaskPaneCount()?this.yac():0,Tc=1===Pb.selectors.getTabbedTaskPaneCount()?-1*this.yac():0;this.wne(Nb,this.KP,yc,Tc)}U.a.Tk()?this.XFa(this.zda):(A.AFrameworkApplication.ta.Pa.Ef&&0>=this.zda&&this.XFa(this.zda),delete this.Sfa[Nb]);delete this.$Lb[Nb]},Gc.onShow=
(Nb,yc)=>{null!=this.Yh&&(this.Yh.stop(),this.Yh=null);this.oFc=Nb;this.YRf();1!==yc&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.iij()},0)});U.a.Tk()?window.requestAnimationFrame(()=>{this.XFa(this.zda)}):A.AFrameworkApplication.ta.Pa.Ef&&0>=this.zda?window.requestAnimationFrame(()=>{this.XFa(this.zda)}):window.requestAnimationFrame(()=>{this.Ijj(this.f8a,this.zda)})},Gc.onHide=(Nb,yc,Tc)=>{const gd=this.gGh();gd!==Nb&&(this.Yh=this.$.Hb.xc("UserAction","TaskPaneToggle"),r.ULS.sendTraceTag(537014370,
0,50,`Toggling Pane from ${Nb} to ${gd}`));Tc?U.a.Tk()||this.tYb(this.f8a):!U.a.Tk()&&gd&&(Nb=1===Object.keys(this.Sfa).length?this.yac():0,this.wne(this.KP,gd,this.yac(),Nb));this.oFc=null;Tc&&1!==yc&&this.QSe();U.a.Tk()&&window.requestAnimationFrame(()=>{this.XFa(this.zda)})},Gc.setFocusCallback=(Nb,yc)=>{yc&&(this.$Lb[Nb]=yc)},Gc.onResizeStart=()=>{U.a.Tk()||this.hUc(ka.HelperMethods.qc(0))},Gc.onResizeEnd=()=>{U.a.Tk()?this.XFa():(this.tYb(this.f8a),this.Sfa[this.KP]=this.gfd(this.KP));r.ULS.sendTraceTag(537014369,
0,50,`Resizing of ${this.KP} TaskPane`)},Gc));A.AFrameworkApplication.ta.Pa.Ef&&!U.a.Tk()&&this.l7i();return null})}tYb(Pb){this.hUc(this.$.isChromeRtl?Pb.style.left:Pb.style.right)}hUc(Pb){r.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.KP}`);this.$.Zej(Pb)}XFa(Pb=0){-1<Pb?va.Task.delay(Pb+this.BFe).continueWith(()=>{this.$.Kya(lb.a.MY("ResetContentAreaMargin"))}):this.$.Kya(lb.a.MY("ResetContentAreaMargin"))}wne(Pb,Gc,Nb,yc){Gc=Gc.endsWith(Gb.NTd)?Gc.substring(0,
Gc.length-Gb.NTd.length):Gc;Gc=this.E2e(Gc);yc=Gc+yc;Pb=this.E2e(Pb);yc<Pb&&this.hUc(ka.HelperMethods.qc(Gc+Nb))}Ijj(Pb,Gc){window.setTimeout(()=>{this.tYb(Pb)},Gc+this.BFe)}yac(){return-1!==this.RTd?this.RTd:this.RTd=fa.DOMElementExtensions.rP(fa.DOMElementExtensions.getElementById(this.Dv,"tabStripFocusZone"))}gfd(Pb){return fa.DOMElementExtensions.rP(fa.DOMElementExtensions.getElementById(fa.DOMElementExtensions.getElementById(this.Dv,Pb+Gb.NTd),Gb.u7f))}E2e(Pb){if(Pb in this.Sfa){const Gc=this.Sfa[Pb].width;
return 0<Gc?Gc:this.gfd(Pb)}return Pb?this.gfd(Pb):0}QSe(){wa.g(this.$).setFocus()}iij(){if(this.$Lb[this.KP]){const Pb=this.$Lb[this.KP];Pb&&Pb(null,null)}else this.$xc.has(this.KP)||this.UVf()}UVf(){Ka.UISurfaces.Lj().then(Pb=>{1<Pb.selectors.getTabbedTaskPaneCount()?Pb.focusTabbedTaskPaneArea():(Pb=fa.DOMElementExtensions.getElementById(this.lc,"AgaveTaskpaneCloseButtonId"))?Pb.focus():(Pb=fa.DOMElementExtensions.Ll(this.lc.querySelectorAll("button")))&&Pb.focus();return null})}YRf(){this.$.domElement.scrollLeft=
0;ac.a.PLa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}mE(Pb){this.addHandler(Gb.sTa,Pb)}SF(Pb){this.removeHandler(Gb.sTa,Pb)}get mO(){return this.Dv}get aA(){r.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}mqb(Pb,Gc,Nb,yc,Tc){let gd=Pb.za(Gc);gd||(gd=nb.a(Da.a,Nb,Pb,Gc),gd.SetScriptLoadFlavor(Tc));yc&&gd.jTc(yc);const Ad=""+Gc;let Od=null;
const Pd=()=>{gd.create();Od()};this.z7b[Ad]=Od=()=>{gd.Nqc(Pd);delete this.z7b[Ad]};gd.HXb(Pd)}initialize(){r.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}q2f(){}tQ(){r.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}WF(){r.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}ble(){r.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}nJd(){r.ULS.shipAssertTag(537151107,
11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}qvb(){r.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}pbd(){r.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}LJ(){r.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}Vw(){r.ULS.shipAssertTag(537151075,
11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}Bxd(){r.ULS.shipAssertTag(537151071,11,!1,"ReactTaskPaneManager.OnActiveItemSlicersLoaded should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){r.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}nNd(){r.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(Pb){const Gc=
Gb.aRg(Pb.Bb,Pb.isChromeRtl);Gb.ILg(Pb,Gc);return new Gb(Gc,Pb)}static aRg(Pb,Gc){const Nb=document.createElement("div");Nb.id=Pb+H.a.Yxc;U.a.Tk()?Nb.classList.add(za.a.aWj):(Nb.classList.add(Gc?za.a.cWj:za.a.bWj),A.AFrameworkApplication.ta.Pa.Ef&&Nb.classList.add(za.a.KGb));return Nb}static ILg(Pb,Gc){S.EwaSettings.isChangeGateEnabled("OfficeVSO:6205697_TalkbackAnnouncingStatusStatus")&&Pb.isMobileMode&&Gc.setAttribute("aria-hidden","true");Pb.Ol?(Pb=ka.HelperMethods.PY(null,H.a.JCb),Pb=document.getElementById(Pb+
H.a.Zwd),U.a.Tk()&&Gc.classList.add(za.a.lLe),Pb.appendChild(Gc)):A.AFrameworkApplication.ta.Pa.Ef?document.getElementById("FarPaneRegion").appendChild(Gc):(U.a.Tk()&&Gc.classList.add(za.a.lLe),document.getElementById(Pb.Bb+H.a.e_a).insertBefore(Gc,Pb.fdb))}}Gb.Vqi=300;Gb.Uqi=950;Gb.mHj=2;Gb.NTd="-panel";Gb.u7f="ExcelTaskPaneContentWrapper";Gb.I3f="rtpSizeChanged";Gb.Mye="rtpCollapsed";Gb.AEf="rtpAdded";Gb.sTa="rtpVisibility";Object(c.a)(Gb,"ReactTaskPaneManager",Ja.a,[239,110,3]);var wb=a(94),dc=
a(155),Jc=a(235),Qc=a(412),fd=a(48),Wc=a(703),Rb=a(425),Sb=a(293);class mc extends Sb.a{constructor(Pb){super(5,Pb)}}Object(c.a)(mc,"ResizeAnimationEvent",Sb.a,[]);var ec=a(465),Rc=a(580),Mc=a(101);class bc{constructor(Pb,Gc){this.w7f=null;r.ULS.sendTraceTag(521405899,9,50,"NovDeprecation: TaskPaneAnimationManager");this.$=Gc;this.taskPane=Pb}fwh(){this.w7f=fa.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Bb+H.a.Ywd);const Pb=bc.c3b(this.taskPane),Gc=bc.c3b(this.w7f),Nb=Rc.a(Mc.a.ul);
Nb.animate(Pb,H.a.kcb);Nb.animate(Gc,H.a.kcb)}IIg(Pb,Gc){const Nb=()=>{fa.DOMElementExtensions.setVisible(Pb,Gc)},yc=Rc.a(Mc.a.ul);Gc?yc.animate(bc.c3b(Pb),H.a.kcb,null,Nb):yc.animate(bc.f6g(Pb),H.a.kcb,null,null,Nb)}UZi(Pb){Pb.style.opacity="0"}mwh(Pb){Rc.a(Mc.a.ul).animate(bc.c3b(Pb),H.a.kcb)}Lmb(Pb,Gc,Nb,yc){Gc||(yc.isVisible=!0);this.$.kza(Nb);Rc.a(Mc.a.ul).animate(bc.I8g(Pb,Gc,Nb),H.a.kcb,null,null,()=>{this.$.lza();Nb||1===yc.Wg||(yc.isVisible=!1);yc.cR(Nb<Gc)})}static f6g(Pb){Pb=new Rb.a(Pb);
Pb.MG(1,0);return Pb}static I8g(Pb,Gc,Nb){Pb=new mc(Pb);Pb.JIg(Gc,Nb);return Pb}static c3b(Pb){Pb=new ec.a(Pb);Pb.MG(0,1);return Pb}}Object(c.a)(bc,"TaskPaneAnimationManager",null,[269]);const ic=`<div id="{0}" class="${E.a.Bph}" runat="server"></div></div><div id="{1}" class="${E.a.Aph} ${E.a.Wo}" runat="server"></div>`,Yc=`<button type="button" id="{0}" class="${E.a.yph}"></button><span><div id="{1}" class="${E.a.zph}"></div></span>`,md=E.a.hph;class id extends tb{constructor(Pb,Gc,Nb){super(Pb,
Nb,id.M1c());this.Hnc=null;this.xpd=!1;this.NR=null;this.nmc=yc=>{var Tc=!1;if(9===yc.Ca.keyCode){Tc=this.Bg.taskPane.nQ(yc,this.mL);if(!Tc){Tc=this.$.da.za(52);var gd=this.domElement.querySelectorAll(this.Bg.taskPane===Tc?Tc.lr:ya.a.BEf);Tc=fa.DOMElementExtensions.Ll(gd);gd=fa.DOMElementExtensions.iz(gd);Tc=fa.DOMElementExtensions.Kma(yc.Ca,Tc,gd)}return Tc}gd=wb.FocusManager.instance().pi;if(null===gd||void 0===gd?0:gd.bN)return Tc;27===yc.Ca.keyCode&&this.Bg.taskPane.hg(!1);return Tc};this.Zc=
()=>{this.mL.style.bottom=this.Dv.style.bottom=this.$.Ol?"":this.$.Bd&4&&!A.AFrameworkApplication.ta.Pa.Ef?ka.HelperMethods.qc(this.$.tda):"0";this.Vw()};this.rAf=yc=>{Object(Qc.a)(222,this.Bg.taskPane)&&(this.Bg.taskPane.pFa.firstChild.style[H.a.pointerEvents]="none");this.xpd=!0;this.NR=this.Oub(yc.clientPoint);dc.a.instance.ra(B.a.Xf,this.domElement.ownerDocument.body,this.Bmc);dc.a.instance.ra(B.a.te,this.domElement.ownerDocument.body,this.Cmc);Jc.a.instance.ra(B.a.zj,this.domElement.ownerDocument.body,
this.Bmc);Jc.a.instance.ra(B.a.Mf,this.domElement.ownerDocument.body,this.Cmc);return!0};this.Cmc=()=>{Object(Qc.a)(222,this.Bg.taskPane)&&(this.Bg.taskPane.pFa.firstChild.style[H.a.pointerEvents]="");this.xpd=!1;dc.a.instance.Ba(B.a.Xf,this.domElement.ownerDocument.body,this.Bmc);dc.a.instance.Ba(B.a.te,this.domElement.ownerDocument.body,this.Cmc);Jc.a.instance.Ba(B.a.zj,this.domElement.ownerDocument.body,this.Bmc);Jc.a.instance.Ba(B.a.Mf,this.domElement.ownerDocument.body,this.Cmc);return!0};this.Bmc=
yc=>{this.xpd&&(yc=this.Oub(yc.clientPoint),yc=Wc.a.KD(yc,this.NR),this.toe(yc.x));return!0};this.APi=yc=>{void 0!==yc.Ca&&null!==yc.Ca&&(9===yc.Ca.keyCode?yc.Ca.shiftKey?(yc=Object(Qc.a)(110,this.Bg.taskPane)?this.Bg.taskPane:null)&&yc.gg(!1,!1):this.setFocusOnToolbarFirstElement():37!==yc.Ca.keyCode&&39!==yc.Ca.keyCode||this.toe(37===yc.Ca.keyCode?-20:20));return!0};r.ULS.sendTraceTag(521405898,9,50,"NovDeprecation: TaskPanePickerControl");this.$.domElement.classList.add(md);this.v7f=Gc;this.initialize();
y.KeyInputManager.instance.ra(B.a.Mb,this.domElement,this.nmc);this.aMb=fa.DOMElementExtensions.getElementById(Gc.parentNode,this.$.Bb+H.a.tkc);this.byc=fa.DOMElementExtensions.getElementById(Gc.parentNode,this.$.Bb+H.a.vrf);this.aMb.title=V.a.instance.ga(2225);dc.a.instance.ra(B.a.zf,this.byc,this.rAf);Jc.a.instance.ra(B.a.pointerDown,this.byc,this.rAf);y.KeyInputManager.instance.ra(B.a.Mb,this.aMb,this.APi)}get Zd(){return X.a.Xxc}get dzb(){return!this.$.Ol||!this.$.isChromeRtl}get A_c(){return this.mL}get ZPe(){return this.A_c}Feb(){super.Feb();
this.aMb&&(this.Bg&&this.Bg.taskPane.isResizable?(this.aMb.style.display="block",this.byc.style.display="block"):(this.aMb.style.display="none",this.byc.style.display="none"))}get Jyc(){const Pb=this.mL;return Pb&&fa.DOMElementExtensions.isVisible(Pb)?ya.a.Jyc:0}nJd(Pb){Pb&&(this.animationManager=Pb);this.$.Ol?this.sej():(this.tej(),this.animationManager=Pb||new bc(this.Dv,this.$),this.animationManager.fwh())}dispose(){this.Hnc&&this.Hnc.SF(this.Gz);ha.a(this.$)&&ha.a(this.$).SF(this.Gz);const Pb=
this.$.da.za(52);Pb&&Pb.SF(this.Gz);this.$.Cl(this.Zc);k.a.rc([this.Hnc]);this.Hnc=null;super.dispose()}initialize(){this.nJd(null);this.FE(0);this.FE(1);this.FE(2);this.FE(7);this.FE(8);this.FE(9);this.FE(10);S.EwaSettings.ma(296)&&this.FE(12);S.EwaSettings.ma(480)&&this.FE(15);S.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.FE(13):U.a.Zpd(this.$)&&this.FE(13);this.FE(14);this.FE(16);S.EwaSettings.Rfc()&&this.FE(17);S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.FE(18);this.Vw()}Bxd(){}Vw(){var Pb=0;let Gc=0;for(let Nb=this.aA.length-1;0<=Nb;Nb--){const yc=this.aA[Nb].taskPane.hp(),Tc=this.aA[Nb].taskPane;if(this.aA[Nb].isVisible=yc)Gc++,(1!==Tc.Wg&&(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Tc.Wg)&&14!==Tc.Wg&&16!==Tc.Wg||Tc.Yr())&&Pb++}Pb=0<Pb;fa.DOMElementExtensions.setVisible(this.mL,Pb);this.cKb(Pb);fa.DOMElementExtensions.setVisible(this.Wha,Pb&&this.isCollapsed);fa.DOMElementExtensions.setVisible(this.rGa,
Pb&&!this.isCollapsed);fa.DOMElementExtensions.setVisible(this.qXc,1<Gc);this.hNb()}LJ(Pb,Gc){if(this.isCollapsed!==Pb){Pb||(this.v7f.style.display=A.AFrameworkApplication.ta.Pa.Ef?"flex":"block");var Nb=this.P3b+(this.$.Ol?ya.a.qBd+ya.a.N0c:0);this.VI=!this.isCollapsed;var yc=Pb?Nb:0;Nb=Pb?0:Nb;this.Bg&&(this.animationManager.Lmb(this.Dv,yc,Nb,this.Bg.taskPane),this.kza());Pb&&(this.v7f.style.display="none");this.qRe(Pb,Gc)}}cKb(Pb){const Gc=this.isVisible!==Pb;this.jf=Pb;fa.DOMElementExtensions.setVisible(this.domElement,
Pb);Gc&&(A.AFrameworkApplication.ta.Pa.Ef&&fa.DOMElementExtensions.toggleCssClass(this.domElement,E.a.Voh,Pb),this.kza(),this.raiseEvent(tb.sTa,new qa(Pb,Pb,this.dzb),this))}lDb(Pb){if(Pb.Cb===this.rGa&&3!==Pb.tb)return!1;this.dva(296943390,Pb.tb);this.LJ(!0,!0);return!0}wDb(Pb){if(Pb.Cb===this.Wha&&3!==Pb.tb)return!1;this.dva(-625072140,Pb.tb);this.LJ(!1,!0);return!0}gyd(Pb){return 13===Pb.Ca.keyCode?(this.dva(296943390,Pb.tb),this.LJ(!0,!0),!0):!1}Cyd(Pb){return 13===Pb.Ca.keyCode?(this.dva(-625072140,
Pb.tb),this.LJ(!1,!0),!0):!1}kza(){if(!this.$.Ol){let Pb=0;this.$.Bd&262144&&(Pb+=this.Jyc,fa.DOMElementExtensions.isVisible(this.Dv)&&!this.isCollapsed&&(Pb+=this.P3b));this.$.kza(Pb)}}h2c(Pb,Gc){const Nb=document.createElement("div");Nb.classList.add(Pb);Gc.insertBefore(Nb,Gc.firstChild);return Nb}sej(){const Pb=this.domElement;var Gc=ka.HelperMethods.PY(null,H.a.JCb);Gc=document.getElementById(Gc+H.a.Zwd);Pb.parentNode&&Pb.parentNode!==Gc&&Pb.parentNode.removeChild(Pb);Gc.appendChild(Pb);this.V4e()}tej(){const Pb=
this.domElement;let Gc=document.getElementById(this.$.Bb+H.a.e_a);A.AFrameworkApplication.ta.Pa.Ef&&(Gc=document.getElementById("FarPaneRegion"));Pb.parentNode&&Pb.parentNode!==Gc&&Pb.parentNode.removeChild(Pb);Gc.appendChild(Pb);this.V4e()}V4e(){const Pb=this.Dv,Gc=this.mL;var Nb=!this.$.Ol;const yc=this.$.ea,Tc=Nb?"0":"";Pb.style.right=Tc;A.AFrameworkApplication.ta.Pa.Ef||(Pb.style.marginRight=ka.HelperMethods.qc(ya.a.Jyc));Pb.style.bottom=Nb?this.$.Bd&4&&!A.AFrameworkApplication.ta.Pa.Ef?ka.HelperMethods.qc(this.$.tda):
"0":"";this.mO.style.bottom=Tc;Gc.style.right=Tc;this.$.el(this.Zc);yc.uF&&this.Zc(null,null);Nb||(Nb=this.$.isChromeRtl?"left":"right",Pb.style[Nb]="0",Gc.style[Nb]="0")}Oub(Pb){const Gc=new fd.a(0,0);return Wc.a.ys(Gc,this.Dv,Pb,!1)}toe(Pb){const Gc=this.Dv.offsetWidth;Pb=Gc-Pb;Pb<this.Bg.taskPane.wo?Pb=this.Bg.taskPane.wo:950<Pb&&(Pb=950);this.Bg.taskPane.vu=Pb;const Nb=new bc(this.Dv,this.$);Nb.Lmb(this.Dv,Gc,Pb,this.Bg.taskPane);Object(Qc.a)(222,this.Bg.taskPane)||Nb.Lmb(this.Bg.taskPane.lc,
Gc,Pb,this.Bg.taskPane);this.$.kza(this.mL.offsetWidth+Pb);this.$.Kya(lb.a.MY("AnimateTaskpaneResize"))}static ka(Pb){let Gc=null;Pb.Hb&&(Gc=Pb.Hb.Ng("ComponentAttach","AttachTaskPanePickerControl"),Gc.start());const Nb=id.cRg(Pb.Bb),yc=id.bRg(Pb.Bb),Tc=id.dRg(Pb.Bb);Nb.appendChild(Tc);Nb.appendChild(yc);id.JLg(Pb,Nb);Pb=new id(Nb,yc,Pb);Gc&&Gc.stop();return Pb}static cRg(Pb){const Gc=document.createElement("div");Gc.id=Pb+H.a.Yxc;return Gc}static bRg(Pb){const Gc=document.createElement("div");Gc.id=
Pb+H.a.urf;Gc.className=E.a.mph;let Nb=String.format(ic,Pb+H.a.xDi,Pb+H.a.VQ);Nb+=String.format(Yc,Pb+H.a.tkc,Pb+H.a.vrf);Gc.innerHTML=Nb;A.AFrameworkApplication.ta.Pa.Ef&&fa.DOMElementExtensions.toggleCssClass(Gc,E.a.KGb,!0);return Gc}static dRg(Pb){const Gc=document.createElement("div");Gc.id=Pb+H.a.Ywd;Gc.className=E.a.mrh;Gc.style.zIndex="100";A.AFrameworkApplication.ta.Pa.Ef&&fa.DOMElementExtensions.toggleCssClass(Gc,E.a.KGb,!0);return Gc}static JLg(Pb,Gc){Pb.Ol?(Pb=ka.HelperMethods.PY(null,
H.a.JCb),Pb=document.getElementById(Pb+H.a.Zwd)):Pb=A.AFrameworkApplication.ta.Pa.Ef?document.getElementById("FarPaneRegion"):document.getElementById(Pb.Bb+H.a.e_a);Pb.appendChild(Gc)}static M1c(){const Pb=new Oa;Pb.QTd=H.a.Yxc;Pb.rW=H.a.urf;Pb.Wxc=H.a.VQ;Pb.Iyc=H.a.Ywd;Pb.TUd=H.a.yDi;Pb.C_c=E.a.oph;Pb.Q8c=E.a.qph;Pb.B_c=E.a.nph;Pb.N8c=E.a.pph;Pb.l1b=E.a.GOe;Pb.o7b=E.a.IOe;return Pb}}Object(c.a)(id,"TaskPanePickerControl",tb,[]);class xd extends m.a{constructor(Pb){super();this.$=Pb;this.Fb()}create(){U.a.zd(this.$)?
this.qb(Gb.ka(this.$)):this.qb(id.ka(this.$))}static ka(Pb){Pb.da.Ga(50,new xd(Pb))}}Object(c.a)(xd,"TaskPaneManagerFactory",m.a,[]);class Lc extends d.a{constructor(Pb){super(Pb);this.mu=()=>{this.$.ea.nR(this.mu);this.GDe()};this.$=Pb}GDe(){const Pb=this.$.da;Pb.Ga(72,new Jb(this.$));Pb.Ga(77,new ea(this.$));xd.ka(this.$);S.EwaSettings.isChangeGateEnabled("OfficeVSO:6938438_deleteNovActionToolbarControl")||Aa.ka(this.$);Ya.ka(this.$)}static main(){f.a.Fa(Pb=>{b.a.ajd(Pb.domElement.ownerDocument,
e.a.current.Rn(96),()=>{Pb.gI()});const Gc=new Lc(Pb);Pb.ea.kv?Gc.GDe():Pb.ea.bT(Gc.mu)})}}Object(c.a)(Lc,"TaskPaneSliceBootstrapper",d.a,[]);Type.registerNamespace("_Ewa");Lc.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/6ce6e90801ed8e16756dad9544954795/EwaDSEsNext.tp.js.map