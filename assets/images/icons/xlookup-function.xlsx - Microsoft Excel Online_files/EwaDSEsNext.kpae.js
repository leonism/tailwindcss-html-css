'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1073:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1074:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{constructor(b,d){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=d}$s(){return this.command}}Object(t.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[116])},1075:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1076:function(t,D,a){a.d(D,"a",function(){return"FieldInfoListContextLoaded"});a.d(D,"k",function(){return"GetFieldInfoListContextOperationFailed"});a.d(D,"f",function(){return"Days from Today"});a.d(D,"i",function(){return"Total Weekdays from Today"});a.d(D,"j",function(){return"Years from Today"});a.d(D,"e",function(){return"Day of the Week"});a.d(D,"h",function(){return"Month of the Year"});a.d(D,"g",function(){return"End of Month"});a.d(D,"c",function(){return"Next Month"});a.d(D,"d",function(){return"Next Week"});
a.d(D,"b",function(){return"Next Day"})},1077:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1078:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1080:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di(".ewa-facp-text-box{position:absolute}")}},1081:function(t,D,a){a.d(D,"b",function(){return"MinorThemeFont"});a.d(D,"a",function(){return"MajorThemeFont"})},1083:function(t,D,a){a.d(D,"a",function(){return b});var c=a(505);const b=()=>{c.a.Di('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1084:function(t,D,a){a.d(D,"a",function(){return l});t=a(0);D=a(234);var c=a(5),b=a(36),d=a(11),f=a(21),e=a(33),k=a(4);class l extends D.a{constructor(m){super(document.createElement("div"));this.JQ=this.EHa=this.DHa=this.FHa=this.HHa=this.GHa=!1;this.LI=null;this.visible=void 0;this.Glc=(v,n)=>{this.mt(v,n)};this.HKa=()=>{this.Ya.textBox.jF=!0};this.bya=()=>{this.Py(!0)};this.dtf=()=>{this.Ya.textBox.focus()};this.Dh=()=>{f.g(this.$).inRangePicker||(this.qe=!1)};this.$=m;f.g(m)&&f.g(m).ha&&f.g(this.$).ha.iJ(this.Dh);
this.Nk=b.a.W3()}get UH(){return this.Pt.UH}get qe(){return this.Pt.qe}set qe(m){this.Pt.qe=m}get Ya(){return this.LI}set Ya(m){(this.LI=m)&&this.LI.bZd.add(this)}get wCh(){return b.a.VM(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(m){if(this.visible===m)return m;this.visible=m;return super.set_visible(m)}mt(){this.WAa(!1);this.Pt.mt()}dispose(){this.$&&f.g(this.$)&&f.g(this.$).ha&&f.g(this.$).ha.RK(this.Dh);this.$=null;super.dispose()}Sh(m,
v,n=!1){m=!1;if((this.e0a||n)&&!this.iwa()&&this.get_visible()&&this.qe)switch(this.Nk&&this.Kzc(v),v){case 1872288872:this.qe=!1;m=!0;break;case -798660877:this.Pt.rB(1);m=!0;break;case 137938150:this.Pt.rB(-1);m=!0;break;case 2091832999:this.Pt.rB(this.UH-1);m=!0;break;case 742457698:this.Pt.rB(-(this.UH-1));m=!0;break;case 125627505:m=this.Py(!1);break;case 267796030:b.a.W3()&&(m=this.Py(!1))}return m}WAa(m){if(this.qe||m){var v=f.g(this.$);m=v.domElement;var n=this.LI.textBox.domElement,w=e.a(this.$).ni(n.offsetHeight),
r=e.a(this.$).ni(n.offsetTop),u=e.a(this.$).ni(n.offsetWidth);n=e.a(this.$).ni(n.offsetLeft);v=v.lj;var x=k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Pa.Ef,z=$get(this.$.Bb+c.a.e_a,this.$.domElement);x&&(z=document.getElementById("EditorContainer"));var B=new Sys.UI.Point(v?this.Pt.O8b:0,v?this.wCh:l.y0h);w=z.offsetTop+B.y+(b.a.VM(this.$)&&v?0:w+r);this.$.Oaa||(r=$get(c.a.xFa,this.$.domElement),w+=r&&!x?r.offsetHeight:0);r=this.domElement;r.style.top=d.HelperMethods.qc(w);n=z.offsetLeft+
n+B.x;!b.a.VM(this.$)&&this.$.isChromeRtl?r.style.right=d.HelperMethods.qc(v?this.Pt.O8b:m.offsetLeft+m.offsetWidth-n-u):r.style.left=d.HelperMethods.qc(n)}}cSa(m){this.Pt&&(m&&!this.JQ?(this.Pt.S8(this.dtf),this.Pt.MXb(this.HKa),this.Pt.wmb(this.bya),this.JQ=!0):this.JQ&&(this.Pt.Fca(this.dtf),this.Pt.Tqc(this.HKa),this.Pt.DHb(this.bya),this.JQ=!1))}Kzc(m){switch(m){case -798660877:case 137938150:case 2091832999:case 742457698:this.GHa=!0;break;case 125627505:this.FHa=!0;break;case 267796030:b.a.W3()&&
(this.DHa=!0)}}}l.O8b=0;l.y0h=1;Object(t.a)(l,"AutoCompleteControl",D.a,[404])},1085:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c extends Sys.EventArgs{constructor(b,d=0,f="",e=""){super();this.length=b;this.selectedIndex=d;this.ZF=f;this.description=e}}Object(t.a)(c,"ListEventArgs",Sys.EventArgs,[])},1086:function(t,D,a){a.d(D,"a",function(){return r});t=a(0);var c=a(15),b=a(27);D=a(835);var d=a(770),f=a(5),e=a(77),k=a(36),l=a(12),m=a(1),v=a(116),n=a(21),w=a(905);class r extends D.a{constructor(u,
x){super(u,x,new w.a(d.a.listItem,d.a.PAb,d.a.SAb,d.a.TAb));this.gbc=!1;this.ukb=this.ir=null;this.wTe=!1;this.visible=void 0;this.lAa(!0);this.wTe=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get O8b(){if(k.a.VM(this.$)){var u=document.getElementById(this.$.Bb+f.a.vTe);return!this.wTe||u?l.DOMElementExtensions.getBoundingClientRect(u).x:0}u=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.Gvd):document.getElementById(this.$.Bb+
f.a.Gvd+"-"+f.a.aqf);c.ULS.shipAssertTag(537170323,0,!!u||this.$.jK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return u?u.offsetWidth:0}get de(){return this.ukb}set de(u){this.ukb=u}get qe(){return void 0!==this.visible?this.visible&&0<this.ir.length:(this.visible=l.DOMElementExtensions.isVisible(this.fg))&&0<this.ir.length}set qe(u){this.visible!==u&&(l.DOMElementExtensions.setVisible(this.fg,u),l.DOMElementExtensions.setVisible(this.CSa,u),this.visible=
u);const x=n.g(this.$).view;u?this.gbc||(x.Ns(this.FFa.Glc),this.gbc=!0):(this.ir.length=0,this.gbc&&(x.Oq(this.FFa.Glc),this.gbc=!1))}wxa(){var u=460;const x=n.g(this.$);var z=x.domElement,B=this.CSa.style;const y=this.fg.offsetTop+this.Ej.offsetHeight*this.Ej.sectionRowIndex-this.fg.scrollTop;B.width="auto";B.whiteSpace="nowrap";B.position="absolute";const A=z.offsetLeft+z.offsetWidth-(this.domElement.offsetLeft+this.fg.offsetLeft+this.fg.offsetWidth+3);z=this.domElement.offsetLeft-3-(z.offsetLeft+
this.O8b);u=Math.min(this.CSa.offsetWidth,u,Math.max(A,z));l.DOMElementExtensions.Gv(this.CSa,u);B.whiteSpace="";B.position="absolute";y+3>this.fg.offsetTop+this.fg.offsetHeight||y<this.fg.offsetTop||(u=this.fg.offsetLeft-3-this.CSa.offsetWidth,B=this.fg.offsetLeft+this.fg.offsetWidth+3,l.DOMElementExtensions.updatePosition(this.CSa,z>A!==x.rtl?u:B,y,!1))}rB(u){super.rB(u);this.wxa()}mt(){this.wxa()}hra(){const u=this.pn,x=this.fg,z=3===e.a.Eb||b.a.jp,B=z?this.JBb:this.UH;this.qe=!0;x.style.height=
"auto";this.FFa.set_visible(!0);this.cmb(u,z);this.ir.length>B?(l.DOMElementExtensions.CI(x,Math.floor(x.offsetHeight*B/this.ir.length)),x.style.overflowY="auto"):m.EwaSettings.Kyb()||(x.style.height="auto",x.style.overflowY="hidden");l.DOMElementExtensions.Gv(x,u.offsetWidth+(this.ir.length>B?v.a.qu:0))}}Object(t.a)(r,"AutoCompleteListBox",D.a,[])},1087:function(t,D,a){a.d(D,"a",function(){return n});t=a(0);var c=a(221),b=a(13),d=a(108),f=a(235);D=a(234);var e=a(550),k=a(5),l=a(54),m=a(12),v=a(70);
class n extends D.a{constructor(w,r,u,x,z,B,y,A,K,G){super(document.createElement("a"));this.Tm=!1;this.dd=T=>{this.raiseEvent("ClickButton",T);return!0};this.onKeyDown=T=>{this.raiseEvent("KeyDown",T);return!1};this.Aw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.xN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=T=>{v.g(T);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=T=>{v.g(T);this.focused=!0;this.raiseEvent("Focus")};this.Fjh=A;this.Qeh=
K;this.SI=n.pb(this.domElement,r,u,x,z,B,y,G);this.Fc.ka("contextmenu",T=>{v.g(T)});this.enable();this.focused=this.hovered=!1;w.appendChild(this.domElement)}nTc(w){this.get_events().addHandler("ClickButton",w)}KHd(w){this.get_events().removeHandler("ClickButton",w)}ATc(w){this.get_events().addHandler("KeyDown",w)}YHd(w){this.get_events().removeHandler("KeyDown",w)}aYb(w){this.get_events().addHandler("PointerOver",w)}iId(w){this.get_events().removeHandler("PointerOver",w)}$Xb(w){this.get_events().addHandler("PointerOut",
w)}hId(w){this.get_events().removeHandler("PointerOut",w)}imb(w){this.get_events().addHandler("Blur",w)}pHb(w){this.get_events().removeHandler("Blur",w)}S8(w){this.get_events().addHandler("Focus",w)}Fca(w){this.get_events().removeHandler("Focus",w)}get wl(){return this.SI}get isEnabled(){return this.Tm}enable(){this.domElement&&(this.domElement.classList.remove(e.a.MT),this.domElement.style.cursor="",c.a.instance.ra(b.a.click,this.domElement,this.dd),d.KeyInputManager.instance.ra(b.a.Mb,this.domElement,
this.onKeyDown),f.a.instance.ra(b.a.pointerOver,this.domElement,this.Aw),f.a.instance.ra(b.a.pointerOut,this.domElement,this.xN),this.Fc.kn("blur")||this.Fc.ka("blur",this.onBlur),this.Fc.kn("focus")||this.Fc.ka("focus",this.onFocus),this.domElement.title=this.Fjh,this.Tm=!0)}disable(){this.domElement&&(this.domElement.classList.add(e.a.MT),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.dd),d.KeyInputManager.instance.Ba(b.a.Mb,this.domElement,this.onKeyDown),
f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Aw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.xN)),this.domElement.title=this.Qeh,this.Tm=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.dd),d.KeyInputManager.instance.Ba(b.a.Mb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Aw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.xN),this.Tm=!1);m.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(w,
r,u,x,z,B,y,A){w.removeAttribute("Href");w.setAttribute(k.a.Kd,k.a.Ps);w.className=r;w.tabIndex=A;r=document.createElement("span");r.className=y;r.classList.add(u);r.tabIndex=-1;w.appendChild(r);w=document.createElement("img");w.src=l.a.gf(x);w.className=z;w.alt=B;w.tabIndex=-1;r.appendChild(w);return w}}Object(t.a)(n,"ListButton",D.a,[448,3])},1129:function(t,D,a){function c(ja){var hb;if(ja){var oa=new Ze(0===ja.kind);ja=null===(hb=null===ja||void 0===ja?void 0:ja.rangeInfo)||void 0===hb?void 0:
hb.positionKindInfo;if(!ja)return oa;oa.pF=0===ja.firstRow;oa.oF=0===ja.firstColumn;oa.gK=0===ja.secondRow;oa.fK=0===ja.secondColumn;return oa}}var b=a(10),d=a(0),f=a(690),e=a(50),k=a(37),l=a(15),m=a(19),v=a(379),n=a(77);class w{}w.B8c="!";w.cEf="[";w.bEf="]";w.openParen="(";w.closeParen=")";w.Rfg=" /.(*\\".split("");w.U5b="...";w.VEb="param_help_link";w.vBd="param_help_udf";w.wad="function_list_box";w.rDh="function_param_box";w.yad="function_reader_description";w.sad="function_description_box";w.RTe=
"function_param_table";w.nVi="param_row_";w.wBd="param_set";w.KEf="param_row_0";w.LEf="param_row_1";w.sDh="<div id='{0}' class='{1}'></div>";w.qDh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";w.MEf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";w.nDh="<div id='{0}' class='{1} {2} {3}'></div>";w.kDh="<div id='{0}' class='{1} {2} {3} {4}'></div>";
w.gjf="[@";w.$2g=1;w.Z2g=3;w.gch=500;w.zof=50;Object(d.a)(w,"FormulaAssistanceConstants",null,[]);var r=a(14),u=a(282),x=a(8),z=a(5),B=a(90),y=a(11),A=a(21),K=a(351),G=a(432),T=a(349);const W=(ja,hb,oa)=>{if(ja){const fb=ja.da.za(491);fb?fb.l9.argumentAssistanceLearnMoreCounter++:l.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");oa?P(ja,hb,oa):(oa=new B.a(-859308420,n.a.Eb,ja.Mc,0,null),ja.Ka.Lb(oa,{[n.a.Oc]:z.a.pQ,
[n.a.Zf]:"HelpID="+hb}))}},P=(ja,hb,oa)=>{if(oa){if(hb&&(!hb||hb.startsWith("http://")||hb.startsWith("https://"))){if(ja.ma(156)&&(ja=Object(G.a)({XCb:269,new:T.a,registry:ja.da}))&&ja.QAa(hb))return;y.HelperMethods.Ve(hb,"_blank",K.a)}}else y.HelperMethods.nV(ja.oG,"XLWAEndUser_"+hb,ja.ZR)},E=ja=>{let hb=x.a.XZ;const oa=ja.da.za(368);oa&&!A.g(ja).lj&&(hb=oa.zoom);return hb};var H=a(36),F;(function(ja){ja.CategoryList="categoryList";ja.FunctionsMap="functionsMap";ja.FunctionIdsToDisplay="functionIdsToDisplay";
ja.RefreshListCallback="refreshListCallback";ja.HelpCallback="helpCallback";ja.InitialCategory="initialCategory";ja.AllCategoryName="allFunctionsCategoryName"})(F||(F={}));Object(d.b)("PropsKeys",F);class N extends u.a{constructor(ja){super(ja);this.MTe=(hb,oa)=>{1===hb&&(this.hide(),hb={[n.a.Oc]:oa.functionName,["ibdk"]:!0},oa=H.a.ewa(this.$)?1117706454:-433697611,oa=new B.a(oa,0,this.$.Mc,8,null),this.$.Ka.Lb(oa,hb))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Bab(this.onFunctionInfoLoaded);
this.c9e()};this.Z4h=hb=>{P(this.$,hb,!1)};this.cef=hb=>!this.functionInfoManager.Nec(hb);this.Il=r.a.instance.ga(1029);this.functionInfoManager=ja.da.za(19);this.wg()}get oc(){return"FunctionDialog"}wg(){this.functionInfoManager.m1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Sb=1;this.functionInfoManager.qZ?this.c9e():this.functionInfoManager.NXa(this.onFunctionInfoLoaded)}c9e(){var ja;this.EYb=this.functionInfoManager.W8b.filter(this.cef);const hb=null!==(ja=N.bif)&&void 0!==
ja?ja:N.j_g;ja=this.functionInfoManager.rad;const oa=this.functionInfoManager.q$b(hb).map(fb=>fb.FunctionIndex);this.Ex={[N.Uu]:this.oc,[F.CategoryList]:ja,[F.FunctionsMap]:this.Q5g(),[F.FunctionIdsToDisplay]:oa,[F.RefreshListCallback]:this.fMi.bind(this),[F.HelpCallback]:this.Z4h,[F.InitialCategory]:hb,[F.AllCategoryName]:N.AllCategoryName};this.initializeAndShow(this.Il,this.MTe,this.Ex)}Q5g(){let ja={};this.EYb.forEach(hb=>{ja[hb.FunctionIndex]=hb});return ja}zQj(ja){ja=ja.map(hb=>hb.FunctionIndex);
this.Ex[F.FunctionIdsToDisplay]=ja;this.WSa(this.Il,this.D3a(this.MTe),this.Ex)}fMi(ja,hb){hb?hb=this.Ryh(hb):(hb=this.functionInfoManager.q$b(ja).filter(this.cef),N.bif=ja);this.zQj(hb)}Ryh(ja=""){ja=ja.toLocaleLowerCase();const hb=this.EYb.filter(({NameUI:oa})=>oa.toLocaleLowerCase().startsWith(ja));3<=ja.length&&(hb.push(...this.EYb.filter(oa=>oa.NameUI.toLocaleLowerCase().includes(ja)&&!hb.includes(oa))),hb.push(...this.EYb.filter(oa=>oa.Help.toLocaleLowerCase().includes(ja)&&!hb.includes(oa))));
return hb}}N.AllCategoryName=r.a.instance.ga(1028);N.j_g=r.a.instance.ga(1027);N.bif=void 0;Object(d.a)(N,"FunctionDialog",u.a,[]);var J=a(1),R=a(97),M=a(55),L=a(63),U=a(86),X=a(27),da=a(210),fa=a(71),S=a(117),ka=a(223),V=a(54),wa=a(723),ma=a(12),ab=a(70);const ba=fa.a.hnh,Ca=fa.a.FLe,Na=fa.a.GLe,za=fa.a.z7c,la=fa.a.jnh,aa=fa.a.nnh,sa=fa.a.BLe,ea=fa.a.JLe,Z=fa.a.lnh,ua=fa.a.CLe;class ya extends da.a{constructor(ja,hb){super(ja,r.a.instance.ga(1029),void 0,void 0,void 0,J.EwaSettings.ma(395));this.ztb=
this.jkf=this.TTe=this.QTe=this.via=this.PTe=this.Atb=this.WIa=this.wia=this.XIa=null;this.shd=!1;this.owb=this.e5=this.f0b=null;this.onFunctionInfoLoaded=()=>{if(!this.WIa.count){const oa=this.functionInfoManager.rad;for(let fb=0,Eb=oa.length;fb<Eb;++fb)this.WIa.XL(oa[fb],oa[fb],!1).className=fa.a.inh;this.WIa.selectedIndex=0;U.a.rc([this.f0b,this.e5,this.owb]);this.f0b=this.pe.Vd(this.XIa);this.e5=this.pe.Vd(this.wia);this.owb=this.pe.Vd(this.ztb);this.f0b.ka("change",this.qwf);this.e5.ka("change",
this.FJi);this.e5.ka("dblclick",this.GJi);this.owb.ka("click",this.Oba);this.owb.ka("keyup",this.LLi);ma.DOMElementExtensions.setVisible(this.wia,!0);ma.DOMElementExtensions.setVisible(this.PTe,!1);this.$.I3c&&ma.DOMElementExtensions.setVisible(this.jkf,!0)}this.qwf(null);this.getButton(0).get_element().disabled=!1;this.XIa.disabled=!1;this.MQa();this.shd=!0};this.Oba=()=>{this.f$&&W(this.$,this.f$.HelpId,this.f$.IsDynamicUdf)};this.LLi=oa=>{13!==oa.keyCode&&32!==oa.keyCode||this.Oba(oa)};this.qwf=
()=>{const oa=this.functionInfoManager.q$b(this.WIa.de.value);this.hua(oa);this.wia.scrollTop=0;this.SXf()};this.FJi=()=>{this.SXf()};this.GJi=oa=>{this.f$&&(ab.g(oa),this.close(0))};this.Xc=(oa,fb)=>{ka.b(fb)&&this.Rt()};this.functionInfoManager=ja.da.za(19);this.formulaAssistanceControl=ja.da.za(221);if(this.Y$c=H.a.oZ(this.$))this.formulaAssistanceManager=ja.da.za(464);this.WA=hb;this.GYc=hb.textBox.caretPosition}get oc(){return"FunctionDeprecatedDialog"}get f$(){if(!this.wia||!this.wia.firstChild)return null;
const ja=Number.parseInvariant(this.wia.children[this.wia.selectedIndex].value);return this.functionInfoManager.gOh(ja)}initialize(){this.Jb.classList.add(fa.a.fnh);this.Jb.innerHTML=ya.WG();this.Ge||(this.Nl(),this.E1());super.initialize();const ja=ma.DOMElementExtensions.Kj(this.Jb,ua);this.rtl&&(ja.align="right",this.ztb.style.marginLeft="5px");this.Ge&&(ja.style.padding="1px");this.functionInfoManager.m1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&
(this.functionInfoManager.Bab(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Hk(this.Xc));U.a.rc([this.f0b,this.e5,this.owb,this.WIa,this.Atb]);super.dispose()}Nl(){this.XIa=ma.DOMElementExtensions.Kj(this.Jb,ba);this.wia=ma.DOMElementExtensions.Kj(this.Jb,Ca);this.XIa.setAttribute(z.a.Kd,z.a.iZb);this.WIa=new wa.a(this.XIa,!0);this.Atb=new wa.a(this.wia,!0);this.PTe=ma.DOMElementExtensions.Kj(this.Jb,aa);this.ztb=ma.DOMElementExtensions.Kj(this.Jb,la);this.TTe=ma.DOMElementExtensions.Kj(this.Jb,
ea);this.jkf=ma.DOMElementExtensions.Kj(this.Jb,Z);this.QTe=$get(ya.tad,this.Jb);this.via=ma.DOMElementExtensions.Kj(this.Jb,sa);this.Ge&&(this.via.style.paddingLeft="1px");this.functionInfoManager.NXa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.hk(this.Xc)}rQ(ja){this.$.da.Za(40,()=>{this.WIa.rQ(ja)})}An(){this.Y$c?this.formulaAssistanceManager.X4b():this.formulaAssistanceControl.set_visible(!1);super.An();this.shd||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.XIa.disabled&&
this.shd&&ma.DOMElementExtensions.setFocus(this.XIa)}commit(){return!0}zpb(){let ja=this.f$.NameDataStrings;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var hb=new B.a(-433697611,0,this.$.Mc,8,null);this.$.Ka.Lb(hb,{[n.a.Oc]:ja})}else{ja+=w.openParen;hb=A.g(this.$);hb.view.visibleArea.contains(hb.lg(null))||hb.Sr(hb.ha.sa.activeCell,3,R.a.lDh);const oa=this.WA.textBox;if(this.WA.$a&&this.WA.text){const fb=this.WA.text,Eb=this.GYc?fb.substring(0,this.GYc):"=";
this.WA.text=Eb+ja+fb.substring(this.GYc+(oa.wv?oa.wv.length:0),fb.length);oa.caretPosition=Eb.length+ja.length}else k.TaskExtensions.Aa(hb.startEdit(!0,1),()=>{this.WA.text="="+ja;const fb=ja.length+1;oa.FQa(fb);oa.caretPosition=fb},this.la,11,L.a.current);hb.lj&&(hb=hb.Wb,hb.text=oa.text,hb.setCaretPosition(oa.caretPosition));(hb=this.WA.JX.get(v.a.u2a))&&hb.wT(!1)}}Ora(){this.Y$c?this.formulaAssistanceManager.Lca():this.formulaAssistanceControl.onb()}hua(ja){this.Atb.clear();const hb=ya.tad+" "+
ya.KTe;for(let oa=0,fb=ja.length;oa<fb;++oa){const Eb=this.Atb.XL(ja[oa].NameUI,ja[oa].FunctionIndex.toString(),!1);X.a.lv&&Eb.classList.add(za);Eb.setAttribute(z.a.pE,ya.LTe);Eb.setAttribute(z.a.NG,hb)}this.Atb.selectedIndex=0}SXf(){if(this.f$){this.ztb.parentNode.className=fa.a.CLe+(this.functionInfoManager.Nec(this.f$)?"-udf":"");var ja=this.f$.NameDataStrings;this.TTe.innerText=ja;this.ztb.innerText=ja;this.via.innerText=this.f$.Help;ja=this.f$.Params.split(w.B8c);this.QTe.innerText=w.openParen+
(1<ja.length?w.U5b:ja[0])+w.closeParen}}static WG(){return String.format("<div class='"+fa.a.gnh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+S.a.Nn+"'>{1}</div>\r\n<div class='"+fa.a.ALe+"'>\r\n\t<select id='{16}' class='{17} "+m.a.Lp+" "+m.a.Wo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+fa.a.knh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+m.a.Lp+
"'>\r\n\t\t\t<span class='"+m.a.RA+" "+fa.a.mnh+"'>\r\n\t\t\t\t<img title='{3}' class='"+m.a.Ish+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",r.a.instance.ga(1032),r.a.instance.ga(1033),r.a.instance.ga(741),r.a.instance.mb(3),V.a.gf(13),r.a.instance.ga(1034),ya.jDh,ya.tad,7,ba,la,aa,sa,ea,Z,ua,ya.oDh,Ca+(X.a.lv?
" "+Na:""),ya.KTe,ya.LTe)}}ya.tad="function_dialog_param_string";ya.KTe="function_dialog_function_description";ya.LTe="function_dialog_function_name";ya.oDh="function_list";ya.jDh="function_category";Object(d.a)(ya,"FunctionDeprecatedDialog",da.a,[]);var ha=a(260);class Da extends u.a{constructor(ja,hb){super(ja);this.V8b=hb;this.gDh=(oa,fb)=>{var Eb;1===oa&&(this.hide(),oa={[n.a.Oc]:this.V8b.NameUI,["functionArgs"]:null!==(Eb=fb.functionArgs)&&void 0!==Eb?Eb:[],["ibdk"]:!0},Eb=new B.a(-433697611,
0,this.$.Mc,8,null),this.$.Ka.Lb(Eb,oa))};this.jHh=oa=>({name:"argument_"+oa,description:"mock argument description. she sells sea shells at the sea shore shop",type:"number"});this.Il=r.a.instance.ga(1030);this.wg()}get oc(){return"FunctionArgumentsDialog"}wg(){this.Sb=1;this.Ex={[ha.a.Uu]:this.oc,["functionInfo"]:this.V8b,["initialArgs"]:this.kHh(this.V8b),["evaluateCallback"]:this.CSg,["generateArgByIndex"]:this.jHh,["helpCallback"]:this.nV,["isModal"]:!1};this.initializeAndShow(this.Il,this.gDh,
this.Ex)}nV(){P(this.$,this.V8b.HelpId,!1)}CSg(){return"42"}kHh(ja){return nb(ja)}}Object(d.a)(Da,"FunctionArgumentsDialog",u.a,[]);const nb=ja=>ja.Params.split("!")[0].split(",").map(hb=>({name:hb,description:`Mock description for param ${hb}. How Mmuch wood would a wood chuck chuck if a wood chuck would chuck wood`,type:"text"}));class qa{constructor(ja,hb,oa){this.$=ja;this.Sa=hb;this.functionInfoManager=oa;this.mDh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");
this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.mDh.includes(this.menuId)&&this.frame.Ww(this.menuId)};this.oZ=H.a.oZ(this.$);this.ewa=H.a.ewa(this.$);this.nki=H.a.xnd();this.oZ&&(this.formulaAssistanceManager=this.$.da.za(464));this.PX={};this.frame=this.$.frame;this.functionInfoManager.NXa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=ja.da.za(491)}Qc(ja,hb){if(!J.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(hb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return ja=
A.g(this.$).Qi,ja.N4a||!ja.$a||0>=ja.text.length?!1:!0;default:return!1}}executeCommand(ja,hb,oa){var fb,Eb;ja=hb.command;const jc=A.g(this.$),Hc=jc.Qi;switch(ja){case 753860909:case -2060563418:null===(fb=this.formulaAssistanceManager)||void 0===fb?void 0:fb.X4b();jc.inRangePicker&&Hc.tE(!1);this.nki?new N(this.$):(new ya(this.$,Hc)).xf();this.formulaAssistanceTelemetryManager.t2a.dialogShownCounter++;break;case 1117706454:null===(Eb=this.formulaAssistanceManager)||void 0===Eb?void 0:Eb.X4b();jc.inRangePicker&&
Hc.tE(!1);fb=this.functionInfoManager.hOh(oa[n.a.Oc]);new Da(this.$,fb);oa.ibdk?this.formulaAssistanceTelemetryManager.t2a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.t2a.argsDialogOpenedByRibbonCounter++;break;case -433697611:oa.ibdk&&(this.ewa?this.formulaAssistanceTelemetryManager.t2a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.t2a.dialogCommitedCounter++);let qd=oa[n.a.Oc]+w.openParen;this.ewa&&(qd+=oa.functionArgs.join(this.$.listSeparator)+
w.closeParen);oa.UILocation&&this.$.xd(-1075437823,-1,0,null);jc.view.visibleArea.contains(jc.lg(null))||jc.Sr(jc.ha.sa.activeCell,3,R.a.lCh);const zd=Hc.textBox;oa=Hc.textBox.caretPosition;Hc.$a&&Hc.text?(fb=Hc.text,Eb=oa?fb.substring(0,oa):"=",Hc.text=Eb+qd+fb.substring(oa+(zd.wv?zd.wv.length:0),fb.length),zd.caretPosition=Eb.length+qd.length):k.TaskExtensions.Aa(jc.startEdit(!0,1),()=>{Hc.text="="+qd;if(this.ewa)jc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{const Hd=qd.length+
1;zd.FQa(Hd);zd.caretPosition=Hd}},this.$.la,11,L.a.current);jc.lj&&(oa=jc.Wb,oa.text=zd.text,oa.setCaretPosition(zd.caretPosition));this.oZ?this.formulaAssistanceManager.Lca():(oa=Hc.JX.get(v.a.u2a),null===oa||void 0===oa?void 0:oa.wT(!1))}return M.Task.Ua(!0)}Ec(ja,hb){switch(hb.command){case 753860909:case -2060563418:case -433697611:return!0;case 1117706454:return this.ewa;default:return!1}}kEh(ja,hb){hb=this.Sa.pq(hb);const oa=this.Sa.Bc();var fb=this.functionInfoManager.q$b(ja);if(!fb)return l.ULS.sendTraceTag(537162067,
0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),hb.rE();const Eb=this.ewa?1117706454:-433697611;for(let jc=0;jc<fb.length;++jc){const Hc=fb[jc].NameUI,qd=this.Sa.zP(280,"Formulas."+ja+"MenuItem_"+fb[jc].FunctionIndex.toString(),Eb,null,1,"None",0,0,Hc,!1,0);qd.label=Hc;const zd=fb[jc].Params.split(w.B8c);qd.ER(Hc+" "+(w.openParen+(1<zd.length?w.U5b:zd[0])+w.closeParen)+"\n"+fb[jc].Help);oa.buttons.push(qd)}ja=this.Sa.Bc();fb=this.Sa.zP(280,"Formulas.MoreFunctionsMenuItem",
-2060563418,m.a.OOe,3,"Image16by16",1031,0,"Formulas.MoreFunctionsMenuItem",!1,0);ja.buttons.push(fb);hb.pc.push(oa);hb.pc.push(ja);return hb.rE()}Vc(ja,hb,oa){ja=this.fOh(hb);if(-1===ja)return!1;this.menuId=oa.MenuId;if(!this.functionInfoManager.qZ)return this.functionInfoManager.m1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;ja=this.functionInfoManager.rad[ja];this.PX[ja]=this.PX[ja]||this.kEh(ja,oa.MenuId);oa.MenuItems=this.PX[ja];return!0}fOh(ja){switch(ja){case "PopulateFinancialFnsMenu":return 2;
case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(d.a)(qa,"FormulaAssistanceCommandHandler",null,[188]);class pa extends f.a{constructor(ja){super(ja)}Dd(){const ja=
e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib),hb=e.GetServiceTaskFactory.create(this.$.da,153,this.la,this.ib);k.TaskExtensions.Aa(k.TaskExtensions.Xd([ja,hb],this.la),()=>{this.ld([new qa(this.$,ja.result,hb.result)])},this.la,3)}static ka(ja){f.a.Rd(92,new pa(ja))}}Object(d.a)(pa,"FormulaAssistanceCommandHandlerFactory",f.a,[]);var Ja=a(220),$a=a(22);class rb{constructor(ja,hb){this.YIa=this.bua=this.qia=null;this.Zzf=(oa,fb)=>{this.G4i(fb.functionName,fb.xad)};this.aAf=(oa,fb)=>
{this.F4i(fb.xad,fb.ULd,fb.oVi)};this.$zf=(oa,fb)=>{oa=[];for(var Eb of fb.ULd)(!this.Nva||void 0!==Eb&&null!==Eb)&&(fb=Eb.trim())&&oa.push(fb);if(!this.Nva||oa.length){Eb="";for(fb=0;fb<oa.length;fb++){const jc=this.jXc(oa[fb]),Hc=rb.ACd(fb,oa.length);Eb+=jc+Hc;Hc&&(Eb+=this.ariaLiveNotifier.bxa)}this.ariaLiveNotifier.readText(Eb)}};this.bAf=(oa,fb)=>{this.ariaLiveNotifier.I4i(fb.ZF,fb.description,fb.selectedIndex.toString(),fb.length.toString())};this.Vzf=(oa,fb)=>{this.ariaLiveNotifier.aLf(fb.description,
fb.length)};this.kwf=()=>{this.ariaLiveNotifier.X$a(r.a.instance.ga(883),z.a.FYa)};this.dwf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(884))};this.gwf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(885))};this.$=hb;this.ariaLiveNotifier=ja;this.$.da.Ga(219,this);this.Nva=H.a.W3()}dispose(){this.EWd();this.YIa=this.bua=this.qia=null}HVc(ja){ja&&(this.qia=ja,this.qia.Yle(this.Zzf),this.qia.Ome(this.aAf),this.Nva&&this.qia.Nme(this.$zf))}IVc(ja){ja&&(this.bua=ja,this.Nva&&(this.bua.Wle(this.kwf),
this.bua.Ule(this.dwf)),this.bua.Vle(this.gwf))}JVc(ja){ja&&(this.YIa=ja,this.YIa.NTc(this.bAf),this.YIa.QXb(this.Vzf))}EWd(){var ja,hb,oa;this.qia&&(this.qia.kPf(this.Zzf),this.qia.KPf(this.aAf),this.Nva&&this.qia.JPf(this.$zf));this.YIa&&(this.YIa.lId(this.bAf),this.YIa.Wqc(this.Vzf));this.Nva&&(null===(ja=this.bua)||void 0===ja?void 0:ja.jPf(this.kwf),null===(hb=this.bua)||void 0===hb?void 0:hb.hPf(this.dwf));null===(oa=this.bua)||void 0===oa?void 0:oa.iPf(this.gwf)}G4i(ja,hb){if(hb){let oa="";
this.Nva||(oa+=r.a.instance.mb(57)+this.ariaLiveNotifier.bxa);for(let fb=0;fb<hb.length;fb++)oa+=ja+this.ariaLiveNotifier.bxa+this.jXc(hb[fb])+rb.ACd(fb,hb.length);this.Nva&&(oa+=r.a.instance.ga(882)+this.ariaLiveNotifier.bxa);this.ariaLiveNotifier.readText(oa)}}F4i(ja,hb,oa){if(ja){let Eb="",jc=0;if(hb){for(let Hc=0;Hc<hb.length;Hc++){if(oa>=ja[Hc].split(this.$.listSeparator).length){jc++;continue}var fb=hb[Hc].trim();if(!fb)return;fb=this.jXc(fb);const qd=rb.ACd(Hc-jc,hb.length-jc);Eb+=fb+qd;qd&&
(Eb+=this.ariaLiveNotifier.bxa)}this.ariaLiveNotifier.readText(Eb)}}}jXc(ja){if(!ja)return"";var hb=ja.split(this.$.listSeparator);ja="";for(const oa of hb){if(rb.Zld(oa))ja+=oa;else{const fb=(hb=rb.kji(oa))?oa.replace("[","").replace("]",""):oa;ja+=String.format(hb?r.a.instance.mb(59):r.a.instance.mb(58),fb)}ja+=this.ariaLiveNotifier.bxa}return ja}static ACd(ja,hb){return ja>=hb||1===hb?(l.ULS.shipAssertTag(537161997,0,ja<hb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),
""):String.format(r.a.instance.mb(55),ja+1,hb)+"\r\n"}static Zld(ja){return $a.a.contains(ja,w.U5b,!0)}static kji(ja){return ja.trimStart().startsWith(w.cEf)||ja.trimEnd().endsWith(w.bEf)}}Object(d.a)(rb,"FormulaAssistanceReadoutHandler",null,[402,3]);class Pa extends Ja.a{constructor(ja){super();this.$=ja;this.Fb()}create(){const ja=this.$.da;k.TaskExtensions.Aa(e.GetServiceTaskFactory.Ta(ja,211,212,this.ib),hb=>{hb=ja.za(219)||new rb(hb.result,this.$);this.qb(hb)},this.la,3)}static ka(ja){ja.da.Ga(220,
new Pa(ja))}}Object(d.a)(Pa,"FormulaAssistanceReadoutHandlerFactory",Ja.a,[]);var eb=a(637),Ob=a(112),tb=a(974),cc=a(58),Ib=a(42),Mb=a(121);class Oa{constructor(){this.QPa={}}afd(ja){return this.QPa&&ja in this.QPa?this.QPa[ja]:null}J5f(ja,hb){this.QPa||(this.QPa={});this.QPa[ja]=hb}eZ(){this.QPa=null}}Object(d.a)(Oa,"FormulaAssistanceContextualPreviewCache",null,[]);var Aa=a(62);const Ba=(ja,hb,oa,fb,Eb,jc,Hc=null)=>{Hc=ja.Na(1,Hc);Hc.getPartialCalcResultsParameters=hb;return Aa.g(ja,"GetPartialCalcResults",
Hc,oa,fb,Eb,jc,4)};class ob{constructor(ja){this.pyi=30;this.calcManager=null;this.Ad=!1;this.hOa=this.kFb=this.$9a=null;this.iy=()=>{this.Kga.eZ()};this.$=ja;this.Kga=new Oa;this.HRf=-1;this.$.ea.kE(this.iy)}dispose(){this.Ad||(this.$&&(this.$.ea.CD(this.iy),this.$=null),this.Kga=this.kFb=null,this.Ad=!0)}Obd(ja,hb,oa,fb){if(hb&&0>=hb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!ja)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");
this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let Eb="="+hb.substring(oa.start,oa.end);J.EwaSettings.ma(588)&&(Eb=this.calcManager.oXh(A.g(this.$).ha.sa.activeCell,ja,oa));const jc=this.nKh(Eb,oa);if(J.EwaSettings.ma(588)){if(jc&&!this.calcManager.isFormulaSubExpressionVolatile(ja))return Promise.resolve(jc)}else if(jc)return Promise.resolve(jc);return this.pKh(Eb,oa).then(Hc=>{if(this.rZc(fb))throw Error.create("OperationCanceledException");
if(!Hc||Hc.Egj||Hc.oma.startsWith("##UNSUPPORTED:"))return this.tWe(hb,Eb,oa,fb);this.Kga.J5f(Eb,Hc.oma);return Promise.resolve(Hc)})}nKh(ja,hb){return(ja=this.Kga.afd(ja))?new tb.a(ja,hb.start,hb.end,0):null}pKh(ja,hb){if(!ja||0>=ja.length||!hb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.ASg(A.g(this.$).ha.sa.activeCell,ja,this.pyi,hb)}tWe(ja,hb,oa,fb){if(!ja||0>=ja.length||!hb||0>=hb.length||
!oa)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.hOa)return this.oKh(ja,hb,oa,fb);const Eb={};Eb.PartialFormula=hb;Eb.Formula=ja;Eb.SourceRange=Ib.v(A.g(this.$).ha.sa.activeCell,this.$);return this.hOa=new Promise((jc,Hc)=>{this.kFb=new eb.a;this.HRf=this.$.ea.Le;this.$9a=Ba(this.$.pa.va,Eb,qd=>{this.iTi(hb,oa,fb,qd,jc,Hc)},qd=>{this.$9a=this.hOa=null;Hc(qd)},null,null,null);this.kFb.token.register(()=>{this.eUg(Hc)})})}iTi(ja,
hb,oa,fb,Eb,jc){this.$9a=this.hOa=null;if(this.HRf!==this.$.ea.Le)jc(Error.create("OperationCanceledException"));else if(fb.Result)if(fb=cc.a.Uh(fb.Result),!fb||Ob.a.isEmpty(fb))Eb(null);else{for(let Hc in fb)this.Kga.J5f(Hc,fb[Hc]);this.rZc(oa)?jc(Error.create("OperationCanceledException")):(ja=this.Kga.afd(ja))?(""===ja&&(ja=" "),Eb(new tb.a(ja,hb.start,hb.end,0))):jc(Error.create("SubexpressionNotFoundException"))}else Eb(null)}oKh(ja,hb,oa,fb){return new Promise((Eb,jc)=>{this.hOa.then(()=>{this.sSf(ja,
hb,oa,fb,Eb,jc)}).catch(()=>{this.sSf(ja,hb,oa,fb,Eb,jc)})})}sSf(ja,hb,oa,fb,Eb,jc){if(this.rZc(fb))jc(Error.create("OperationCanceledException"));else{const Hc=this.Kga.afd(hb);Hc?Eb(new tb.a(Hc,oa.start,oa.end,0)):this.tWe(ja,hb,oa,fb).then(qd=>{Eb(qd)}).catch(qd=>{jc(qd)})}}eUg(ja){this.$9a&&(Mb.a.wu(this.$9a.Ot)?(this.hOa=this.$9a=null,ja(Error.create("PendingWebReqeuestCancelled"))):l.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}eZ(){this.fUg();this.Kga&&this.Kga.eZ()}fUg(){this.kFb&&
this.kFb.cancel()}rZc(ja){return this.Ad||ja.hK}}Object(d.a)(ob,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var xb=a(156),Va=a(212);class bb{}bb.Vnh="ewa-facp-text-box";Object(d.a)(bb,"CssClassNames",null,[]);class ra{constructor(ja){this.Lpa=this.eSa=this.v1a=this.yP=this.X9=this.Ya=null;this.dhd=!1;this.Hc=ja}dispose(){(this.X9||this.yP)&&this.F6e();this.Ya=this.Lpa=null}lQj(ja,hb,oa,fb){ja&&hb&&fb&&hb.oma&&!(1>hb.oma.length)&&(this.Ya=ja,this.kOf(),this.v1a=hb,this.eSa=fb,this.Jyj(hb,
oa,fb))}F6e(){this.k5h();this.kOf();this.eSa=this.v1a=null}Jyj(ja,hb,oa){if(ja.oma&&!(1>ja.oma.length)){var fb=this.Hc.da.za(266);if(fb){var Eb=fb.qQh();Eb&&k.TaskExtensions.Aa(this.XAb,()=>{if(hb)if(J.EwaSettings.ma(588)&&this.Ya.$a&&0<oa.length){this.zwb(ja.UIa,oa[0].start,null);var jc=this.z1e(oa[0],Eb),Hc=this.Ya.text.substring(oa[0].start,oa[0].end).trim();Hc=this.Ya.text.indexOf(Hc);Hc=this.Ya.text.substring(0,Hc).lastIndexOf("\n");this.zwb(0>Hc||1>=oa.length?oa[0].start:Hc+1,oa[0].end,jc?String.format(jc,
.3):null);for(var qd=1;qd<oa.length;qd++)jc=this.z1e(oa[qd],Eb),Hc=this.Ya.text.substring(oa[qd].start,oa[qd].end).trim(),Hc=this.Ya.text.indexOf(Hc),Hc=this.Ya.text.substring(oa[qd-1].end,Hc).lastIndexOf("\n"),this.zwb(0>Hc?oa[qd-1].end:Hc+1+oa[qd-1].end,oa[qd].end,jc?String.format(jc,.3):null);Hc=this.Ya.text.substring(oa[oa.length-1].end,ja.dua).indexOf("\n");this.zwb(0>Hc?oa[oa.length-1].end:Hc+1+oa[oa.length-1].end,ja.dua,null);l.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.zwb(ja.UIa,
ja.dua,null),l.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.X9||(this.X9=document.createElement(Va.a.div),this.Ya.textBox.domElement.appendChild(this.X9));this.yP||(this.yP=document.createElement(Va.a.div),this.yP.className=bb.Vnh,this.Hc.domElement.appendChild(this.yP));jc=ja.dua;J.EwaSettings.ma(588)&&this.Ya.$a&&oa&&0<oa.length&&oa[0].start<jc&&oa[0].start!==ja.UIa&&
!this.Ya.textBox.wv.length&&(jc=oa[0].start);qd=$a.a.contains(this.Ya.textBox.Se.id,"FormulaBar",!0)&&$a.a.contains(this.Ya.text.substring(ja.UIa,ja.dua),"\n",!0);Hc=this.Ya.$a?this.Ya.textBox.caretPosition:0;jc=excelOnline.utils.getBoundingRectForText(this.Ya.textBox.Se,qd?Hc:ja.UIa,qd?Hc:jc,J.EwaSettings.ma(588));this.yP.style.left=y.HelperMethods.qc(jc.left);this.yP.style.top=y.HelperMethods.qc(jc.top);this.yP.style.width=y.HelperMethods.qc(jc.width);this.yP.style.height=y.HelperMethods.qc(jc.height);
dialogControls.renderToolTip(this.X9,`FormulaAssistancePreviewToolTip_${ja.dua}_${ja.dua}`,ja.oma,this.yP,0,!1,!1,1)},this.Hc.la,3)}}}z1e(ja,hb){const oa=this.Ya.text;var fb=oa.substring(ja.start,ja.end);fb=fb.trim();ja=oa.indexOf(fb,ja.start);hb=oa.indexOf(hb,ja);fb=oa.substring(ja,hb);fb=fb.trim();return this.Ya.colors.getItem(ja+"-"+(ja+fb.length))}k5h(){this.Ya&&this.X9&&this.yP&&k.TaskExtensions.Aa(this.XAb,()=>{this.Ya.textBox.domElement.contains(this.X9)&&(dialogControls.clearToolTip(this.X9),
this.Ya.textBox.domElement.removeChild(this.X9),this.X9=null);this.Hc.domElement.contains(this.yP)&&(this.Hc.domElement.removeChild(this.yP),this.yP=null)},this.Hc.la,3)}zwb(ja,hb,oa){!this.Ya||ja>=hb||(this.Ya.textBox.formatText(ja,hb-ja,{["background"]:oa||"#E3DDCC"}),this.dhd=!0)}kOf(){if(this.Ya&&this.v1a&&this.dhd){var ja=this.v1a.dua;J.EwaSettings.ma(588)&&0<this.eSa.length&&this.eSa[this.eSa.length-1].end>ja&&(ja=this.eSa[this.eSa.length-1].end);this.Ya.textBox.formatText(this.v1a.UIa,ja-this.v1a.UIa,
{["background"]:!1});this.dhd=!1}}get XAb(){if(this.Lpa)return this.Lpa;const ja=new xb.a;this.Hc.kz(hb=>{k.TaskExtensions.Aa(hb.Vrd(),()=>{ja.setResult(!0)},this.Hc.la,3)});return this.Lpa=ja.task}}Object(d.a)(ra,"FormulaAssistanceContextualPreviewControl",null,[3]);var Qa=a(84),qb=a(47),Wa=a(45);class ta{constructor(ja){this.X6=0;this.X$c=ja}Z1f(ja,hb,oa){oa?this.X4g(ja,hb,oa):this.M3e(ja,hb,oa,!0)}ffj(){this.X6=0}X4g(ja,hb,oa){this.X6++;const fb=this.X6;qb.a.instance.create(()=>{this.M3e(ja,hb,
oa,fb===this.X6)},500,Wa.a.mCh,!0,!0)}M3e(ja,hb,oa,fb){const Eb=this.X$c.Obd(ja,hb);Eb&&Eb.then(jc=>{fb&&this.X$c.Kmd(hb)&&this.X$c.kQj(ja,jc,oa)}).catch(jc=>{jc=Object(Qa.a)(Error,jc);"OperationCanceledException"===jc.message?l.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${jc}`):l.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${jc}`)})}}Object(d.a)(ta,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var ib=
a(200);class Bb{constructor(ja){this.Dqb=this.Iga=this.calcManager=this.Ya=null;this.V8a=()=>{this.s4a(!1,!1)};this.$=ja;this.qtb=new ra(ja);this.L8b=new ob(ja);this.M8b=new ta(this);A.g(ja).Wb.jm(this.V8a);this.$.da.Ga(317,this)}dispose(){this.nYc();U.a.rc([this.qtb,this.L8b]);this.M8b=this.L8b=this.qtb=null;this.$&&A.g(this.$).Wb.Al(this.V8a);this.Iga=this.Ya=this.$=null}Kyj(ja,hb){hb&&ib.f(hb.text)&&!(hb.Zva||hb.textBox.wv||this.Ya&&this.Ya.textBox.wv)&&(this.Ya=hb,this.calcManager=this.$.da.za(266))&&
(l.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),ja=y.HelperMethods.Wtb(ja),ja=this.calcManager.lXh(A.g(this.$).ha.sa.activeCell,this.Ya.text,ja.x,ja.y),hb=this.calcManager.getSubExpressionSpan(ja),!hb||hb.end<=hb.start||this.Kmd(hb)||(this.Iga=hb,this.M8b.Z1f(ja,hb,!0)))}CQd(ja){if(ja&&ib.f(ja.text))if(ja.textBox.wv&&ja.textBox.wv.trim()){if(this.Ya=ja,this.calcManager=this.$.da.za(266)){l.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");ja={};var hb=this.Ya.textBox.wv.trim();ja.start=this.Ya.text.indexOf(hb,this.Ya.textBox.caretPosition);ja.end=ja.start+hb.length;(hb=this.calcManager.getFormulaSubExpressionObject(A.g(this.$).ha.sa.activeCell,this.Ya.text,this.Ya.textBox.wv))&&!this.Kmd(ja)&&(this.Iga=ja,this.M8b.Z1f(hb,ja,!1))}}else this.s4a(!1,!0)}s4a(ja,hb){!this.Ya||hb&&this.Ya.textBox.wv||(this.Iga=
null,ja&&(this.nYc(),this.L8b.eZ(),this.M8b.ffj()),this.qtb&&this.qtb.F6e(),this.Ya.Zva||(this.Ya.Zva=!1,this.Ya=null))}Obd(ja,hb){if(!this.Ya||this.Ya.Zva)return null;this.nYc();this.Dqb=new eb.a;return this.L8b.Obd(ja,this.Ya.text,hb,this.Dqb.token)}kQj(ja,hb,oa){this.Dqb=null;!ja||!hb||!hb.oma||0>=hb.oma.length?this.s4a(!1,!1):(ja=this.calcManager.mXh(A.g(this.$).ha.sa.activeCell,ja,this.Ya.text),this.qtb.lQj(this.Ya,hb,oa,ja))}Kmd(ja){return this.Iga?ja.start===this.Iga.start&&ja.end===this.Iga.end&&
ja.pre===this.Iga.pre&&ja.post===this.Iga.post:!1}nYc(){this.Dqb&&this.Dqb.cancel()}}Object(d.a)(Bb,"FormulaAssistanceContextualPreviewManager",null,[417,3,418]);var Ub=a(7),Ta=a(4),mb=a(221),Qb=a(13),Lb=a(184),Jb=a(1084),Ab=a(67),pb=a(770),va=a(30),db=a(24),Ya=a(64),gb=a(247),Ka=a(245),ub=a(162);class ac{constructor(ja=!1){this.yS=0;this.y7d=!1;this.ZUa=this.U8d=null;this.Pqg=ja;this.textEdit=null}DYf(ja){this.yS=0;this.y7d=ja.IsCompatibility;this.set_name(ja.NameDataStrings);this.ZUa=ja.Help}qpj(ja){this.yS=
1;this.set_name(ja.Name)}Roj(ja){this.yS=2;this.set_name(ja.name);this.ZUa=ja.tooltip}tqj(ja){this.yS=3;this.set_name(ja.name);this.ZUa=ja.toolTip}a_f(ja){this.yS=4;this.set_name(ja.name)}Jsj(ja){this.yS=5;this.set_name(ja.name);this.ZUa=ja.toolTip}Isj(ja){this.yS=7;this.set_name(ja.name)}hrj(){this.yS=6;this.set_name(r.a.instance.mb(191));this.ZUa=r.a.instance.mb(192)}get itemType(){return this.yS}get afi(){return this.y7d}get name(){return this.label}set_name(ja){return this.U8d=ja}get label(){return this.U8d}get via(){return this.ZUa}get nzb(){return this.Pqg}static s9g(){return Object(Ub.a)(new ac(!0),
{})}}Object(d.a)(ac,"AutoCompleteItem",null,[543]);class Ra{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(Ra,"DefinedNameInfo",null,[]);var na=a(183);class lb{constructor(ja){this.xFe={};this.$=ja}get wFe(){const ja=[];if(!this.$.yb||!this.$.yb.items)return ja;let hb=0;const oa=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&H.a.oZ(this.$);for(const fb of this.$.yb.items)if(fb&&(3===fb.type&&fb.usedRange||
oa&&2===fb.type)){const Eb=new Ra;Eb.tooltip=fb.sheetName+Ab.a.exclamation+fb.usedRange.toString();Eb.name=fb.name;Eb.namedRange=this.g2g(fb.usedRange);Eb.sheetName=fb.sheetName;Eb.type=this.Z1g(fb.type);ja.push(Eb);this.xFe[fb.name.toUpperCase()]=Eb;++hb;if(hb===w.zof){l.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${w.zof}`);break}}return ja}HMj(ja){var hb=this.xFe[ja.toUpperCase()];if(!hb)return{returnValue:!1,sheetName:"",range:null};ja=hb.sheetName;
hb=this.R1g(hb.namedRange);return{returnValue:!0,sheetName:ja,range:hb}}g2g(ja){if(null!=ja&&void 0!=ja)return{top:ja.top,left:ja.left,bottom:ja.bottom,right:ja.right,maxRows:ja.maxRows,maxColumns:ja.maxColumns,sheetName:void 0}}R1g(ja){if(null!=ja&&void 0!=ja)return new na.a(ja.top,ja.left,ja.bottom,ja.right,ja.maxRows,ja.maxColumns)}Z1g(ja){switch(ja){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(lb,"DefinedNameInfoManager",null,[]);var jb=a(128),Yb=a(262),Gb=a(259),wb=a(234);class dc extends Sys.EventArgs{constructor(ja,
hb){super();this.functionName=ja;this.xad=hb}}Object(d.a)(dc,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class Jc extends Sys.EventArgs{constructor(ja){super();this.ULd=ja}}Object(d.a)(Jc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class Qc extends Sys.EventArgs{constructor(ja,hb,oa){super();this.xad=ja;this.ULd=hb;this.oVi=oa}}Object(d.a)(Qc,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var fd=a(258);class Wc{constructor(ja,hb,
oa,fb,Eb=null){this.Haa=this.aYc=!1;this.$=ja;this.formulaAssistanceUIControl=hb;this.rTe=oa;this.Rkj=fb;this.c4e=Eb;this.Haa=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get jf(){return this.aYc}set jf(ja){this.aYc!==ja&&(ja?fd.a(this.$).Xh(this):fd.a(this.$).Nz(this),this.aYc=ja)}get Zd(){return this.Rkj}get lc(){return this.formulaAssistanceUIControl.getRootElement(this.rTe)}gg(ja,hb){ja=!1;hb||(A.g(this.$).Qi.textBox.jF=!0,ja=this.formulaAssistanceUIControl.focus(this.rTe));
return ja}hh(ja){const hb=this.lc;return!(void 0===hb||null===hb)&&ma.DOMElementExtensions.uf(hb,ja)}kj(){this.c4e&&this.c4e();if(this.Haa){const ja=A.g(this.$).Qi.textBox;this.selection=ja.selection;ja.removeSelection()}}Mj(){this.Haa&&(A.g(this.$).Qi.textBox.selection=this.selection)}dispose(){fd.a(this.$).Nz(this)}}Object(d.a)(Wc,"FormulaAssistanceFocusManager",null,[110,3]);var Rb=a(38),Sb=a(368),mc=a(170),ec=a(34),Rc=a(281),Mc=a(280),bc=a(907);class ic extends Rb.a{constructor(ja,hb){super();
this.iog=[];this.Aad={};this.Bad={};this.uS=null;this.T7=[];this.ZIa={};this.Gwf=(oa,fb)=>{l.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.swf(oa,!!fb&&1!==fb.FilterType,!0)};this.Fwf=()=>{l.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.uS=null};this.pwf=oa=>{l.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
this.dGd(oa.xia,!0,!1)};this.Ewf=oa=>{l.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.swf(oa,!0,!1)};this.lJc=this.nJc=!1;this.jb=ja;this.pluginScheduler=hb;this.$.da.Ga(19,this)}NXa(ja){this.addHandler("FunctionInfoLoaded",ja)}Bab(ja){this.removeHandler("FunctionInfoLoaded",ja)}mEg(ja){this.addHandler("FunctionInfoReset",ja)}waj(ja){this.removeHandler("FunctionInfoReset",ja)}get qZ(){return this.nJc}get Wgi(){return this.lJc}get W8b(){var ja=this.uS,hb=
bc.a(this.$);if(!hb)return ja;hb=hb.vNh();const oa=hb.length;if(0>=oa)return ja;const fb=[];fb.push(...ja);for(ja=0;ja<oa;ja++){const Eb=hb[ja],jc={};jc.FunctionIndex=fb.length;jc.HelpId=jc.GroupUI=null;jc.Help=Eb.description;jc.IsCommonlyUsed=jc.IsCompatibility=!1;jc.NameDataStrings=Eb.name;jc.NameUI=Eb.name;jc.Params=null;jc.ParamsHelp=null;fb.push(jc)}return fb}get rad(){return this.T7}get $(){return this.jb}dispose(){const ja=this.$.da.za(268);ja&&ja.SHd(this.pwf);this.jb=null;super.dispose()}ZRf(){this.raiseEvent("FunctionInfoReset")}AJd(){this.ZRf();
this.nJc=!1;this.uS=null;this.lJc=!0}m1a(ja,hb=!1){if(this.qZ)this.IJf();else{l.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let fb=null;(fb=this.$.da.za(268))||l.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===fb||void 0===fb?0:fb.xia)&&0<fb.xia.length)J.EwaSettings.ma(121)?fb.PBh(this.Ewf):this.dGd(fb.xia,!0,!1);else{var oa=this.$.pa.va.Qb();ja&&(this.$.ea.hc||hb)&&!this.Wgi&&
(hb?Sb.a(this.$.userOperationManager,(Eb,jc,Hc)=>Aa.p(this.$.pa.va,ja,Mc.b(Eb,this.Gwf),Mc.a(jc,this.Fwf),Hc,ja,oa),Eb=>new mc.a(130,0,Eb,16),null):Aa.p(this.$.pa.va,ja,this.Gwf,this.Fwf,null,ja,oa));!this.qZ&&this.$.ea.hc&&(fb?(l.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.qZ}, IsSessionActive=${this.$.ea.hc}`),fb.Xle(this.pwf)):(l.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
Aa.p(this.$.pa.va,{FilterType:0},this.Ewf,null,null,null,oa),this.lJc=!1))}}}gOh(ja){return 0>ja||ja>=this.uS.length?null:this.uS[ja]}Ocd(ja){return ec.a.Cc(this.Aad,ja.toUpperCase())}hOh(ja){return ec.a.Cc(this.Bad,ja.toUpperCase())}q$b(ja){return ec.a.Cc(this.ZIa,ja)}Nec(ja){return!ja.GroupUI}swf(ja,hb,oa){const fb=Rc.a(ja);l.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${fb}`);fb?(A.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.vp(ja.Errors)):(this.dGd(ja.Result,hb,oa),H.a.TU()&&!H.a.oZ(this.$)&&this.BSj())}dGd(ja,hb,oa){l.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${ja.length}, isCategorized = ${hb}, partialResult = ${oa} IsFullyLoaded = ${this.qZ}`);this.qZ||(this.uS=ja,this.mPg(hb),this.nJc=!oa,this.IJf())}IJf(){this.raiseEvent("FunctionInfoLoaded")}BSj(){this.pluginScheduler.notifier().setFunctionsInfo(this.W8b)}mPg(ja){var hb=r.a.instance.ga(1027),oa=[];
this.ZIa={};this.T7=[];this.ZIa[hb]=oa;const fb=r.a.instance.ga(1028),Eb=[];this.T7.push(hb);this.T7.push(fb);for(let Hc=0,qd=this.uS.length;Hc<qd;Hc++){hb=this.uS[Hc];hb.IsCompatibility||Eb.push(hb);var jc=hb.NameUI;const zd=hb.NameDataStrings;this.Aad[zd.toUpperCase()]||(this.Aad[zd.toUpperCase()]=hb);this.Bad[jc.toUpperCase()]||(this.Bad[jc.toUpperCase()]=hb);if(!this.Nec(hb)){if(ja){jc=hb.GroupUI;let Hd=ec.a.Cc(this.ZIa,jc);Hd||(Hd=[],this.ZIa[jc]=Hd,this.T7.push(jc));Hd.push(hb)}hb.IsCommonlyUsed&&
oa.push(hb);hb.IsCompatibility||this.iog.push(zd)}}this.ZIa[fb]=Eb;ja&&(ic.zNf(oa,[2,3,0,5,4,9,1,7,8,6]),oa=Array(14),oa[0]=0,oa[1]=1,oa[2]=7,oa[3]=11,oa[4]=5,oa[5]=2,oa[6]=6,oa[7]=10,oa[8]=9,oa[9]=3,oa[10]=4,oa[11]=13,oa[12]=12,oa[13]=8,ic.zNf(this.T7,oa),oa=[],oa.push(...this.T7),oa.splice(13,1),this.T7=oa);oa=(Hc,qd)=>Hc.NameUI.localeCompare(qd.NameUI);this.uS=[...this.uS];this.uS.sort((Hc,qd)=>Hc.NameDataStrings.localeCompare(qd.NameDataStrings));for(let Hc=1,qd=this.T7.length;Hc<qd&&ja;Hc++)this.ZIa[this.T7[Hc]].sort(oa);
for(let Hc=0,qd=this.uS.length;Hc<qd;Hc++)this.uS[Hc].FunctionIndex=Hc}static zNf(ja,hb){const oa=[...ja];for(let fb=0;fb<oa.length&&fb<hb.length;fb++)ja[fb]=oa[hb[fb]]}}Object(d.a)(ic,"FunctionInfoManager",Rb.a,[399,400,3]);var Yc=a(235),md=a(93),id=a(48),xd=a(703);class Lc extends md.a{constructor(ja,hb,oa,fb=null){super(ja,fb);this.O2=null;this.JLb=this.bTd=!1;this.offsetParent=this.P6=this.W0a=null;this.KHc=!1;this.wyd=Eb=>this.r5(Eb);this.vyd=Eb=>this.oN(Eb);this.mvf=Eb=>{const jc=y.HelperMethods.Qn(Eb);
jc.button===Sys.UI.MouseButton.leftButton&&2===Eb.tb&&(this.gmd(jc.target)||this.SRa(jc));return!1};this.a4d=hb;oa&&(this.bTd=!0,Yc.a.instance.ra(Qb.a.pointerDown,this.ZHe,this.mvf));this.Cea=!1}get G5b(){return this.Cea}get ZHe(){return this.a4d}get g4h(){return this.KHc}dispose(){this.bTd&&(Yc.a.instance.Ba(Qb.a.zj,this.ZHe,this.mvf),this.bTd=!1);this.JLb&&(this.JLb=!1,Yc.a.instance.Ba(Qb.a.Mf,this.domElement.ownerDocument.body,this.wyd),Yc.a.instance.Ba(Qb.a.zj,this.domElement.ownerDocument.body,
this.vyd));this.O2=this.a4d=null;super.dispose()}Wje(ja){this.O2?this.O2.push(ja):this.O2=[ja]}gmd(ja){if(this.O2)for(let hb=0,oa=this.O2.length;hb<oa;++hb)if(ma.DOMElementExtensions.uf(this.O2[hb],ja))return!0;return!1}SRa(ja){this.G5b||(this.Cea=!0,$a.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Dkh(),Yc.a.instance.ra(Qb.a.Mf,this.domElement.ownerDocument.body,this.wyd),Yc.a.instance.ra(Qb.a.zj,this.domElement.ownerDocument.body,
this.vyd),this.JLb=!0,this.drag(!0,ja))}drag(ja,hb){ab.g(hb);var oa=new id.a(0,0),fb=new Sys.UI.Point(hb.clientX,hb.clientY);hb=this.domElement.parentNode;fb=xd.a.ys(oa,hb,fb,this.isRtl());ja?(oa=xd.a.cF(oa,hb,this.domElement,this.isRtl()),this.W0a=xd.a.KD(fb,oa),this.P6=fb,this.KHc=!1):!this.g4h&&this.c4h(fb,this.P6)&&(this.KHc=!0);oa=xd.a.KD(fb,this.W0a);xd.a.Wbb(hb,this.domElement,oa,this.isRtl(),ja)}YA(ja){this.JLb&&(this.JLb=!1,Yc.a.instance.Ba(Qb.a.Mf,this.domElement.ownerDocument.body,this.wyd),
Yc.a.instance.Ba(Qb.a.zj,this.domElement.ownerDocument.body,this.vyd));ab.g(ja);this.Cea=!1;this.P6=this.W0a=null}r5(ja){const hb=y.HelperMethods.Qn(ja);hb.button===Sys.UI.MouseButton.leftButton&&2===ja.tb&&this.YA(hb);return!1}oN(ja){2===ja.tb&&this.drag(!1,y.HelperMethods.Qn(ja));return!1}c4h(ja,hb){return hb.x<ja.x-2||hb.x>ja.x+2||hb.y<ja.y-2||hb.y>ja.y+2}Dkh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;ma.DOMElementExtensions.getLocation(this.offsetParent)}}
Object(d.a)(Lc,"BaseDraggableBehavior",md.a,[]);class Pb extends Lc{constructor(ja,hb,oa=null,fb=!1){super(ja,hb,!1,oa);this.WQa(fb);this.dj=$a.a.equals("rtl",ja.dir,!0)}setVisible(ja){ma.DOMElementExtensions.setVisible(this.domElement,ja);ja||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.dj}WQa(ja){const hb=this.domElement.style;hb.cursor="move";hb.position=ja?"relative":"absolute"}}Object(d.a)(Pb,"FunctionParamBoxDraggableItem",Lc,[]);class Gc{constructor(){this.onDismissClick=
this.onFeedback=this.onHelpLink=this.onCardModeChange=null}}Object(d.a)(Gc,"FormulaArgumentAssistanceCallbacks",null,[]);class Nb{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}}Object(d.a)(Nb,"FormulaArgumentAssistanceRenderingInfo",null,[]);var yc=a(85),Tc=a(108),gd=a(151);class Ad{constructor(ja){this.aH=ja;this.$Y=this.EPd=this.kn=!1;this.onKeyDown=hb=>!this.$Y&&hb.keyCode===yc.a.boa&&hb.altKey&&hb.ctrlKey?(this.p6b(),hb.stopPropagation(),hb.preventDefault(),!0):
!1;this.jMa=hb=>{if(!this.$Y)return!1;if(hb.eventName===Qb.a.Mb){const oa=hb.Ca.ctrlKey?1:hb.Ca.shiftKey?50:10;switch(hb.Ca.keyCode){case yc.a.lTa:this.c5(0,-oa);break;case yc.a.$na:this.c5(0,oa);break;case yc.a.aoa:this.c5(-oa,0);break;case yc.a.Peb:this.c5(oa,0);break;case yc.a.uL:case yc.a.Zh:this.EPd=!0;break;default:return!1}}hb.eventName===Qb.a.Gd&&this.EPd&&this.d3(!0);hb.Ca.preventDefault();return!0};this.uFb=hb=>{if(!this.$Y)return!1;hb.Ca.preventDefault();this.d3();return!0};this.onBlur=
()=>{if(!this.$Y)return!1;this.d3();return!0};this.Eq=Tc.KeyInputManager.instance;this.pointerInputManager=Yc.a.instance}ka(ja){(this.root=ja)&&!this.kn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.kn=!0)}detach(){this.root&&this.kn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.kn=!1)}p6b(){this.root&&(this.target=this.aH.kCf("move",!0),this.BSd=this.target.getBoundingClientRect(),this.$Y=!0,this.EPd=!1,this.tv(),this.Ojc||this.s2c(),this.target.appendChild(this.Ojc))}d3(ja=
!1){this.aH.Evf(ja);this.$Y=!1;this.rHd();this.UGd();this.BSd=this.target=void 0}tv(){this.Eq.capture(this.jMa,null);this.pointerInputManager.pt(Qb.a.pointerDown,this.target,this.uFb,!0);this.target.addEventListener("blur",this.onBlur)}UGd(){this.Eq.releaseCapture();this.pointerInputManager.At(Qb.a.pointerDown,this.target,this.uFb,!0);this.target.removeEventListener("blur",this.onBlur)}rHd(){var ja;this.target&&(null===(ja=this.Ojc)||void 0===ja?void 0:ja.parentNode)===this.target&&this.target.removeChild(this.Ojc)}c5(ja,
hb){const oa=this.target.getBoundingClientRect();ja+=oa.left-this.BSd.left;hb+=oa.top-this.BSd.top;this.aH.onMove(ja,hb)}s2c(){this.Ojc=gd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Ad,"FormulaAssistanceMoveAdapter",null,[]);var Od=a(275);class Pd{constructor(ja){this.aH=ja;this.kn=!1}Jaa(){return this.kn&&!!this.gja}LNa(ja){this.gja.style.cursor="grabbing";this.pEj=ja.clientPoint.x;this.qEj=ja.clientPoint.y;this.aH.kCf("drag");return!0}ela(ja){this.aH.onMove(ja.clientPoint.x-
this.pEj,ja.clientPoint.y-this.qEj);return!0}dla(){this.YA()}cla(){this.YA()}ka(ja){if(this.gja=ja)this.gja.style.cursor="grab",Od.a.instance.v_(this.gja,this),this.kn=!0}detach(){this.kn&&this.gja&&(this.gja.style.cursor="",Od.a.instance.f7(this.gja,this),this.kn=!1)}YA(){this.gja.style.cursor="grab";this.aH.Evf()}}Object(d.a)(Pd,"FormulaAssistanceDragAdapter",null,[574]);class Md{constructor(ja,hb){this.QIa=ja;this.formulaAssistanceTelemetryManager=hb;this.kn=!1;this.Vda={[ge.Drag]:0,[ge.Move]:0};
this.CBc=this.QIa.getWindowEdgeBuffer()+1;this.Cpf=new Ad(this);this.VHe=new Pd(this)}ka(ja,hb,oa,fb){this.root=ja;this.render=oa;this.dismiss=fb;this.detach();hb&&(this.VHe.ka(hb),this.Cpf.ka(ja.firstChild),this.kn=!0)}detach(){this.kn&&(this.VHe.detach(),this.Cpf.detach(),this.kn=!1);ma.DOMElementExtensions.nf(this.placeholder)}clear(){this.QIa.setOverrideTarget(void 0);this.detach();this.kJd()}kCf(ja,hb=!1){this.Vda[ja]+=1;this.axc=this.root.firstChild.getBoundingClientRect();this.placeholder=
this.root.cloneNode(!0);ja=this.placeholder.firstChild;ja.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);hb&&(this.xDd=document.activeElement,ja.tabIndex=0,ja.focus());this.dismiss();return ja}onMove(ja,hb){ja=Math.min(Math.max(ja,this.CBc-this.axc.left),window.innerWidth-this.axc.right-this.CBc);hb=Math.min(Math.max(hb,this.CBc-this.axc.top),window.innerHeight-this.axc.bottom-this.CBc);this.placeholder.firstChild.style.transform=`translate(${ja}px, ${hb}px)`}Evf(ja=
!0){const hb=this.placeholder.firstChild.getBoundingClientRect(),oa=this.QIa.getDirectionalHint({top:hb.top,left:hb.left});this.QIa.setOverrideTarget({top:1===oa?hb.bottom:hb.top,left:hb.left});this.render();window.requestAnimationFrame(()=>{ma.DOMElementExtensions.nf(this.placeholder);this.xDd&&(ja&&this.xDd.focus(),this.xDd=void 0)})}kJd(){const ja=this.formulaAssistanceTelemetryManager.l9,hb=this.Vda[ge.Drag],oa=this.Vda[ge.Move];0<hb&&(ja.argumentAssistanceDragCounter+=1,ja.argumentAssistanceDragTotalCounter+=
hb,this.Vda[ge.Drag]=0);0<oa&&(ja.argumentAssistanceMoveCounter+=1,ja.argumentAssistanceMoveTotalCounter+=oa,this.Vda[ge.Move]=0)}}Object(d.a)(Md,"FormulaAssistanceDragControl",null,[]);var ge;(function(ja){ja.Drag="drag";ja.Move="move"})(ge||(ge={}));Object(d.b)("FormulaAssistanceDragMode",ge);class pe extends wb.a{constructor(ja,hb,oa,fb,Eb,jc){super(pe.bJa(H.a.W3()));this.$=ja;this.uj=hb;this.functionInfoManager=oa;this.formulaAssistanceUIControl=fb;this.formulaAssistanceTelemetryManager=Eb;this.pluginScheduler=
jc;this.Y0a=null;this.P1=0;this.kr=null;this.iVc=!1;this.nka=this.Pq=null;this.jRa=!0;this.wQ=!1;this.Naa=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Gdf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=Hc=>{this.iNb(Hc);1===Hc?this.formulaAssistanceTelemetryManager.l9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.l9.argumentAssistanceExpandCounter++};
this.xQa=Hc=>{const qd={};qd[z.a.sU]="ArgumentAssistanceCard";const zd={};zd.FunctionName=Hc.functionName;qd[z.a.i9c]=zd;this.$.xd(802602464,0,8,qd)};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.l9.argumentAssistanceDismissCounter++;this.jRa=!1;this.prb();this.wQ&&this.aH.clear();0===this.P1&&this.iNb(1)};this.Jf=()=>{this.jRa=!0;this.wQ&&this.aH.clear()};this.EJi=Hc=>{Hc.button===Sys.UI.MouseButton.leftButton&&Hc.target&&(ab.g(Hc),this.Y0a&&this.Y0a.SRa(Hc))};this.mt=()=>{void 0!==
this.Pq&&null!==this.Pq&&this.Pq()};this.V3=(this.Nk=H.a.W3())&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Nk){this.vNd();this.kr=new Wc(this.$,this.formulaAssistanceUIControl,0,Ka.a.W$c);this.V3&&A.g(this.$).dc.jm(this.Jf);if(this.wQ=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.aH=
new Md(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.Y0a=new Pb(this.domElement,this.$.zE,void 0,H.a.VM(this.$)),this.Fc.ka("mousedown",this.EJi),ja=$get(w.wad,this.uj),this.uj.insertBefore(this.domElement,ja);A.g(this.$).view.Ns(this.mt)}Yle(ja){this.addHandler("FAFunctionNameUpdated",ja)}kPf(ja){this.removeHandler("FAFunctionNameUpdated",
ja)}Ome(ja){this.addHandler("FAParameterSelectionChangedOld",ja)}KPf(ja){this.removeHandler("FAParameterSelectionChangedOld",ja)}Nme(ja){this.addHandler("FAParameterSelectionChanged",ja)}JPf(ja){this.removeHandler("FAParameterSelectionChanged",ja)}set_visible(ja){this.Nk?ja||this.prb():Sys.UI.Control.prototype.set_visible.call(this,ja);return ja}prb(){this.formulaAssistanceUIControl&&(this.Pq=null,this.wQ&&this.aH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.nka=null,this.kr.jf=
!1)}show(ja){this.Nk||(this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceRender"]),this.Y0a.setVisible(!!ja),this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceRender"]),this.iVc&&(this.iVc=!1,this.formulaAssistanceTelemetryManager.bIa("argumentAssistanceOverall")))}oJd(){if(!this.V3||this.jRa){this.V3||this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceComputation"]);var ja=A.g(this.$).Qi,hb=
{content:ja.text,caretPosition:ja.textBox.caretPosition};(this.Naa?this.pluginScheduler.getRequester().argumentAssistance(hb,0):this.pluginScheduler.requester().argumentAssistance(hb)).then(oa=>{0===oa.kind?oa.payload?(this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceComputation"]),this.nyj(this.SCd(oa.payload),ja.textBox.domElement)):this.prb():this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceComputation"],!1);return null})}}update(ja,hb,oa,fb){if(!this.Nk&&ja){this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.iVc=!0;var Eb=this.$.listSeparator;try{var jc=$get(w.yad,this.uj);const Hc=$get(w.sad,this.uj);jc.innerText="";Hc.innerText="";const qd=$get(w.RTe,this.uj),zd=ja.Params.split(w.B8c);jc=[];for(let Hd=0,Yd=qd.rows.length;Hd<Yd;Hd++){const se=qd.rows[Hd];ma.DOMElementExtensions.setVisible(se,Hd<zd.length);let Re=zd[Hd];const Ye=w.nVi+Hd+"_",rf=ja.NameDataStrings;$get(Ye+w.VEb,se).innerText=rf;$get(Ye+w.vBd,se).innerText=rf;if(Re){const tf=zd[Hd].split(Eb),Bf=pe.Zld(tf[tf.length-
1]),Jf=pe.pji(ja);Bf&&(Jf&&(2<tf.length?(tf[tf.length-2]+="1",tf[tf.length-3]+="1"):l.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",rf,tf.length.toString(),hb)),pe.vJg(tf,Jf,hb,ja));Re=tf.join(Eb.toString()+" ");zd[Hd]=Re;oa<tf.length?(jc[Hd]=tf[oa],l.ULS.shipAssertTag(537162072,0,!!tf[oa]&&1<=tf[oa].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
oa,tf.length,rf,Hd),tf[oa]=`${"<b>"}${tf[oa]}${"</b>"}`,Re=tf.join(Eb.toString()+" ")):l.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+oa+"currRowParamsArray.Length = "+tf.length+", current row = "+Hd);fb&&l.ULS.sendTraceTag(558474578,0,50,`formula '${rf}', ${tf.length} params, isElipsis = ${Bf}, isPairsParamsFormula = ${Jf}, currentParameterIndex = ${hb}`)}$get(Ye+w.wBd,se).innerHTML="("+(Re||"")+")"}fb?this.raiseEvent("FAFunctionNameUpdated",
new dc(ja.NameDataStrings,zd)):this.raiseEvent("FAParameterSelectionChangedOld",new Qc(zd,jc,oa));qd.className=pb.a.Coh+(this.functionInfoManager.Nec(ja)?"-udf":"")}catch(Hc){throw l.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",ja.NameDataStrings,hb,Hc),Hc;}this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceComputation"])}}dispose(){this.Nk||(this.Fc.JC(),U.a.Ia(this.Fc),A.g(this.$).view.Oq(this.mt),U.a.Ia(this.Y0a),
this.Y0a=null);this.Nk&&U.a.Ia(this.kr);this.V3&&A.g(this.$).dc.Al(this.Jf);this.functionInfoManager=this.$=null;super.dispose()}SCd(ja){const hb=new Nb;hb.functionRenderingInfo=ja;hb.cardMode=this.P1;this.KGd(hb);return hb}KGd(ja){ja.callbacks=new Gc;ja.callbacks.onHelpLink=this.Ycd(ja.functionRenderingInfo);ja.callbacks.onCardModeChange=this.onCardModeChange;ja.callbacks.onFeedback=this.xQa;this.V3&&(ja.callbacks.onDismissClick=this.onDismissClick)}nyj(ja,hb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceRender"]);
const oa={};oa.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(oa);this.Pq=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,hb,ja)};this.Pq();this.XBd(ja);this.wQ&&this.aH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Pq,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.kr.jf=!0;this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.bIa("argumentAssistanceOverall")}}Ycd(ja){return()=>
{W(this.$,ja.helpID,ja.isUDF)}}vNd(){const ja=jb.a.get(z.a.gZb);this.P1=ja?parseInt(ja,10):pe.j4c;this.formulaAssistanceTelemetryManager.hXf(this.P1)}XBd(ja){var hb=ja.functionRenderingInfo.functionName;this.nka&&$a.a.equals(this.nka,hb,!0)?(hb=Yb.a.map(ja.functionRenderingInfo.signatures,oa=>{let fb="";0<=oa.signatureParams.activeParam&&oa.signatureParams.activeParam<oa.signatureParams.params.length&&(fb=oa.signatureParams.params[oa.signatureParams.activeParam]);return fb}),this.raiseEvent("FAParameterSelectionChanged",
new Jc(hb))):(this.nka=hb,ja=Yb.a.map(ja.functionRenderingInfo.signatures,oa=>oa.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new dc(hb,ja)))}iNb(ja){this.P1=ja;try{jb.a.Rw(z.a.gZb,ja.toString(),Gb.AFrame.Lda)}catch(hb){l.ULS.sendTraceTag(537162070,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${hb.message}`)}}static Zld(ja){return $a.a.contains(ja,w.U5b,!0)}static pji(ja){return!!ja&&$a.a.i1a(ja.NameDataStrings,"IFS")}static vJg(ja,
hb,oa,fb){try{if(!ja||2>ja.length)l.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${fb.NameDataStrings}', ${ja?ja.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${hb}, currentParameterIndex = ${oa}.`);else{var Eb=ja.pop().toString();for(let jc=ja.length-1;jc<oa;jc++){const Hc=ja[jc].trim();if(hb){const qd=ja[jc-1].trim();ja.push(pe.cFh(qd,Hc))}else{const qd=pe.F8e(Hc);ja.push(pe.rUe(qd))}}ja.push(Eb)}}catch(jc){throw l.ULS.shipAssertTag(537162068,
0,!1,`AppendNewOptionalParameters Exception. formula '${fb.NameDataStrings}', ${ja?ja.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${hb}, currentParameterIndex = ${oa}. 
Exception: ${jc}`),jc;}}static cFh(ja,hb){ja=pe.F8e(ja);const oa=pe.t_e(ja);hb=pe.t_e(hb);return pe.rUe(ja,!0,!!oa&&!!hb&&oa!==hb)}static F8e(ja){var hb=ja.match(pe.lxd);ja=$a.a.trimEnd($a.a.trimStart(ja,w.cEf),w.bEf);if(hb&&hb.length){hb=hb[hb.length-1];const oa=Number.parseLocale(hb)+1;ja=ja.replace(hb,oa.toString())}else ja=`${ja}${1}`;return ja}static rUe(ja,hb=!1,oa=!1){let fb="[{0}]";hb&&(fb=oa?"[{0}":"{0}]");return String.format(fb,ja)}static t_e(ja){return(ja=ja.match(pe.lxd))&&ja.length?
ja[0]:null}static bJa(ja){if(ja)return document.createElement("div");ja=String.format(w.MEf,w.KEf,w.vBd,pb.a.ZLe,w.VEb,pb.a.YLe,w.wBd);var hb=String.format(w.MEf,w.LEf,w.vBd,pb.a.ZLe,w.VEb,pb.a.YLe,w.wBd);ja=String.format(w.qDh,w.rDh,pb.a.TMe,pb.a.Alh,m.a.Lp,w.RTe,ja,hb);hb=document.createElement("div");hb.innerHTML=ja;return hb.firstChild}}pe.lxd=RegExp("\\d+");pe.j4c=0;Object(d.a)(pe,"FormulaArgumentAssistanceControlDeprecated",wb.a,[542]);class Qd{constructor(){this.Yga=this.dsa=this.esa=!1;this.TDf=
40;this.nye=41;this.i_a=this.$Ad=this.aBd=this.WEb=0;this.Muf=!0;this.Gzd=!1;this.cSe=this.HLd=-1}}Object(d.a)(Qd,"ParseContext",null,[]);var he=a(412),ue=a(906),je=a(319);class Ge extends ue.a{constructor(ja,hb,oa,fb){super(ja,hb);this.formulaAssistanceControl=oa;this.formulaAssistanceTelemetryManager=fb;this.CDf=!1;this.nRa=null;this.hjd=0;this.pHa=this.fEc=null;this.JP=0;this.Anb=hb.textBox;this.Nk=H.a.W3();this.J9i=J.EwaSettings.xb();this.B1=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance")}get Sxb(){return Object(he.a)(ya,
this.$.rb.eh)}get iK(){return this.formulaAssistanceControl.qe}set iK(ja){this.formulaAssistanceControl.qe=ja}get N4a(){return this.Ya.N4a}get v7h(){var ja=this.Anb.text;let hb=!1;if(0>=ja.length)return hb;const oa=this.$.Hb.xc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),fb=A.g(this.$).ha.sa.activeCell.clone();var Eb=ja.charCodeAt(0);this.pHa="";this.JP=this.xUg(ja,this.Anb.caretPosition);Eb=61===Eb&&-1!==this.JP;if(!J.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Eb&&
(hb=!0);else if(Eb){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Eb=0;for(var jc=this.JP-1;1<=jc&&!(this.JP-jc>Ge.wof);jc--)if(Ge.Sse.includes(ja.charAt(jc))){Eb=jc;break}Eb=ja.substring(Eb+1,this.JP);ja=""!==Eb?this.$.yb.getItemByName(Eb):null;jc=this.JP;for(var Hc=this.JP+1;Hc<=this.Ya.textBox.caretPosition;Hc++)if("["===this.Ya.text.charAt(Hc))jc=Hc;else break;this.JP=jc}else{Eb=ja.lastIndexOf("[");jc=0;for(Hc=Eb-1;1<=Hc&&!(Eb-Hc>Ge.wof);Hc--)if(Ge.Sse.includes(ja.charAt(Hc))){jc=
Hc;break}Eb=ja.substring(jc+1,Eb);ja=""!==Eb?this.$.yb.getItemByName(Eb):null}ja&&2===ja.type?(hb=!0,this.pHa=Eb):A.g(this.$).Db.Xj(fb)&&(hb=!0,this.pHa="")}oa.stop();this.hjd=oa.tc;l.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.hjd} milliseconds`);return hb}get key(){return v.a.u2a}get calcManager(){this.fEc||(this.fEc=this.$.da.za(266,!1));return this.fEc}get aQd(){if(null!=
this.nRa)return this.nRa;if(!J.EwaSettings.ma(135))return this.nRa=!1;const ja=A.g(this.$).ha.sa.activeCell.clone();if(1!==ja.aof||!ja.left||A.g(this.$).ha.sa.lfc())return!1;let hb=this.formulaAssistanceControl.tableManager.Fm(ja);if(hb)return this.nRa=!1;--ja.left;--ja.right;if(!ja.yz)return!1;hb=this.formulaAssistanceControl.tableManager.Fm(ja);return this.nRa=!!hb&&ja.top===hb.top&&this.formulaAssistanceControl.tableManager.X2g(hb,A.g(this.$))}Sh(ja,hb){this.formulaAssistanceControl.Ya=this.Ya;
-1470715894!==hb&&-1231471547!==hb||!this.pGe()||(this.iK=!1);return super.Sh(ja,hb)}Jxd(){var ja=this.N4a;if(ja||this.aQd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.Gnb.formulaAssistanceRequestAttemptedCounter++,this.pGe())if(!ja&&this.aQd)this.formulaAssistanceControl.Tqe();else if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.v7h){if(ja=this.$.Hb.xc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.Vqe(),ja.stop(),this.Anb.text.endsWith("[")&&"["!==this.Anb.text.charAt(this.Anb.text.length-2)){const hb=""===this.pHa?this.formulaAssistanceControl.tableManager.Jg:Object(Qa.a)(je.a,this.$.yb.getItemByName(this.pHa));l.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${hb.aj} in ${ja.tc} ms with cell edit regression time of ${this.hjd} ms and popup visibility - ${this.iK}`)}}else this.formulaAssistanceControl.onb(),
this.CDf&&(this.CDf=this.iK=!1);else this.formulaAssistanceTelemetryManager.Gnb.formulaAssistanceRequestOptimizedCounter++;else this.iK=!1}Lh(){this.J9i||(this.nRa=null,this.aQd&&this.formulaAssistanceControl.JY())}Jf(){this.iK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Wrc();this.Nk&&this.Qti()}pEd(ja,hb){return this.formulaAssistanceControl.Sh(ja,hb)}Qti(){this.formulaAssistanceControl.fAa&&(this.formulaAssistanceTelemetryManager.BM.smartSuggestionShownCounter++,
this.formulaAssistanceControl.fAa=!1);this.formulaAssistanceControl.LRa&&(this.formulaAssistanceTelemetryManager.BM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.LRa=!1);this.formulaAssistanceControl.KRa&&(this.formulaAssistanceTelemetryManager.BM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.KRa=!1);this.B1&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.BM.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=
!1),this.formulaAssistanceControl.eLa&&(this.formulaAssistanceTelemetryManager.BM.isCellContentFormulaCounter++,this.formulaAssistanceControl.eLa=!1))}xUg(ja,hb){let oa=0,fb;for(;-1!==oa;)if(oa=ja.indexOf("[",oa+1),-1!==oa&&oa<hb&&(fb=ja.indexOf("]",oa+1),-1===fb||fb>=hb))return oa;return-1}pGe(){const ja=this.Ya.text,hb=this.Ya.textBox.caretPosition,oa=this.formulaAssistanceControl.Swa,fb=this.formulaAssistanceControl.vMa;if(this.iK&&$a.a.equals(ja,oa,!0)&&hb===fb)return!1;this.formulaAssistanceControl.Swa=
ja;this.formulaAssistanceControl.vMa=hb;return!0}}Ge.Sse=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Ge.wof=255;Object(d.a)(Ge,"FormulaAutoCompleteListAutoCompleteBehavior",ue.a,[]);var Ce=a(29),pc;(function(ja){ja[ja.function=0]="function";ja[ja.field=1]="field";ja[ja.definedName=2]="definedName";ja[ja.letVariable=3]="letVariable";ja[ja.tableColHeaderName=4]="tableColHeaderName";ja[ja.tableSpecialStructRef=5]="tableSpecialStructRef";ja[ja.pendingData=6]="pendingData";ja[ja.tableNamedObject=7]="tableNamedObject"})(pc||
(pc={}));Object(d.b)("ItemType",pc);var Uc=a(1086),hd=a(1085);class yd{constructor(ja){this.index=ja}execute(ja){ja.push(this.index)}}Object(d.a)(yd,"AppendIndexOperation",null,[571]);class wd{execute(){}}Object(d.a)(wd,"NopIndexOperation",null,[571]);class I{constructor(ja,hb){this.k_i=ja;this.Eqf=hb}execute(ja){for(let hb=0;hb<ja.length;hb++)ja[hb]===this.k_i&&(ja[hb]=this.Eqf)}}Object(d.a)(I,"ReplaceIndexOperation",null,[571]);var xa=a(79);class Ua{constructor(ja,hb){this.$=ja;this.items=hb;this.pZ=
H.a.pZ(this.$)}TCe(ja,hb){const oa=new yd(hb);if(!this.pZ)return oa;ja=this.eoi(ja,hb);return null!=ja?this.items[ja].nzb?new I(ja,hb):new wd:oa}eoi(ja,hb){const oa=this.items[hb];l.ULS.shipAssertTag(537162075,0,!!oa,"Internal error: invalid item index");ja=xa.where(xa.asEnumerable(ja),fb=>this.items[fb].name===oa.name);return xa.Ct(ja)?xa.first(ja):null}}Object(d.a)(Ua,"FilterItemOperationFactory",null,[]);var vb=a(116),cb=a(835);class Xb{constructor(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=
this.isPrefixed=this.detail=this.type=null}}Object(d.a)(Xb,"CompletionItem",null,[]);const rc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${m.a.Lp}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Lp}'>{5}</td>\r\n</tr>`,Ec=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Lp}'></td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Lp}'>{2}</td>\r\n</tr>`,ed=`<td>\r\n\t<div class='${m.a.RA}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,
ud=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Lp}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Lp}'>{2}</td>\r\n</tr>`;class Kd extends Uc.a{constructor(ja,hb,oa,fb,Eb){super(ja,hb);this.xqa=null;this.pLb=this.wtc=0;this.G1b=null;this.STe=oa;this.ytb=fb;this.formulaAssistanceControl=Eb;this.ir=[];this.zV=[];this.Zdf=(this.Nk=H.a.W3())&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations")}NTc(ja){this.addHandler("FLBSelectedRowChanged",
ja)}lId(ja){this.removeHandler("FLBSelectedRowChanged",ja)}QXb(ja){this.addHandler("ACLBUpdated",ja)}Wqc(ja){this.removeHandler("ACLBUpdated",ja)}get ugc(){return 0<this.pLb&&this.pLb===this.ir.length}get qe(){return super.qe}set qe(ja){super.qe=ja;ja||(this.wtc=0,this.de=null);0===this.wtc?ma.DOMElementExtensions.setVisible(this.ytb,ja&&!this.Nk):ma.DOMElementExtensions.setVisible(this.ytb,!1)}get Ej(){return this.xqa}set Ej(ja){this.DAa(this.Ej);if(ja){this.STe.innerText="";this.xqa=ja;var hb=this.DAa(this.Ej);
const oa=ja.rowIndex+1,fb=$get("description_cell"+oa,ja);this.ytb.innerText=fb.innerText;const Eb=$get("item_type_cell",ja);this.de=hb=hb.innerText;this.wtc="field"===Eb.innerText?1:"definedName"===Eb.innerText?2:"letVariable"===Eb.innerText?3:"tableColHeaderName"===Eb.innerText?4:"tableSpecialStructRef"===Eb.innerText?5:"pendingData"===Eb.innerText?6:"tableNamedObject"===Eb.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new hd.a(this.ir.length,oa,hb,fb.innerText));this.itc(ja)}}get CSa(){return this.ytb}get FFa(){return this.formulaAssistanceControl}get J_(){return this.wtc}dispose(){super.dispose();
this.xqa=this.STe=this.ytb=null}Lxc(ja,hb,oa,fb=0){this.Zdf||this.S6(!1);let Eb="";oa&&(Eb+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${pb.a.eZg}'>${oa}</td></tr></table>`);Eb+=`<table class='${this.qba}' aria-live='off'><tbody>`;const jc=new Lb.a;for(let qd=0,zd=this.zV.length;qd<zd;qd++)Eb+=this.I1e(ja[this.zV[qd]],qd+1,hb,fb),this.Nk&&jc.add(this.nWe(ja[this.zV[qd]]));let Hc=this.zV.length;for(let qd=0,zd=this.ir.length;qd<zd;qd++)this.zV.includes(this.ir[qd])||(Hc++,
Eb+=this.I1e(ja[this.ir[qd]],Hc,hb,fb),this.Nk&&jc.add(this.nWe(ja[this.ir[qd]])));this.fg.innerHTML=Eb+"</tbody></table>";this.pn=ma.DOMElementExtensions.Kj(this.domElement,this.qba);this.Nk&&(this.G1b=jc.toArray());this.Zdf?(this.qe=!0,this.FFa.set_visible(!0)):(this.S6(!0),this.sHg(!!oa))}DIa(ja,hb,oa,fb="",Eb=0,jc=!1){if(ja){var Hc=[],qd=[];this.pLb=0;var zd=new Ua(this.$,ja);if(hb){var Hd=!!hb&&0<Eb,Yd=Hd&&91===hb.charCodeAt(Eb+1)?Eb+2:Eb+1;jc=Hd?hb.length===Yd:!1;Hd&&hb.length===Eb&&J.EwaSettings.ma(135)&&
(jc=!0);var se=null;!jc&&Hd&&hb.length>Eb+1&&(se=hb.substring(Yd,hb.length));if(hb)for(let Re=0,Ye=ja.length;Re<Ye;Re++)if(Hd=ja[Re].name,!ja[Re].afi){Yd=zd.TCe(Hc,Re);ja[Re].nzb&&this.pLb++;if(!se&&!jc||0===ja[Re].itemType)({L8e:Hc,SGf:qd}=this.iRe(hb,Hd,oa,Yd,Hc,qd));se&&1===ja[Re].itemType&&({L8e:Hc,SGf:qd}=this.iRe(se,Hd,!0,Yd,Hc,qd));jc&&1===ja[Re].itemType&&Yd.execute(Hc)}}else for(oa=0;oa<ja.length;++oa)if(ja[oa].nzb||jc)se=zd.TCe(Hc,oa),se.execute(Hc),se.execute(qd),ja[oa].nzb&&this.pLb++;
this.zV=qd;this.ir=Hc;this.Lxc(ja,hb,fb,Eb)}}CRj(ja){if(ja&&!(1<ja.length)){var hb=[],oa=[];hb.push(0);oa.push(0);this.zV=hb;this.ir=oa;this.Lxc(ja,"","",0)}}wxa(){this.Ej&&super.wxa()}J2i(ja,hb){this.raiseEvent("ACLBUpdated",new hd.a(ja,void 0,void 0,hb))}Qcg(ja){const hb=this.pn.rows[ja];return(!this.Ej||this.Ej!==hb)&&ja<this.pn.rows.length?(this.Ej=hb,!0):!1}static oWe(ja){switch(ja){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;
case 7:return 106;default:return 3}}onItemClick(ja){ab.g(ja.Ca);0===this.J_||2===this.J_||3===this.J_||4===this.J_||5===this.J_||7===this.J_?(this.raiseEvent(cb.a.Q3a),this.wxa()):1===this.J_?this.FFa.Py(!1):(this.FFa.Py(!1),ja=A.g(this.$),ja.Fo(!1),ja.focus());return!0}sHg(ja){this.hra();if(ja){var hb=this.pn.offsetWidth+(this.ir.length>this.UH?vb.a.qu:0);ja=$get("list_column_header");ja.offsetWidth>hb&&ma.DOMElementExtensions.Gv(this.fg,ja.offsetWidth);hb=this.fg.getElementsByClassName(this.IZ);
for(let oa=0;oa<hb.length;oa++)hb[oa].style.width=y.HelperMethods.qc(ja.offsetWidth)}}I1e(ja,hb,oa,fb){if(1===ja.itemType){const Eb=Ce.a.Dg(ja.name),jc=Ce.a.Dg(fb?oa.substring(fb+1,oa.length):oa);let Hc=0;Eb.substring(0,jc.length).toLowerCase()!==jc.toLowerCase()&&(Hc=Kd.YDj(Eb,w.Rfg,jc));oa="";oa=0<=Hc?oa+(Eb.substring(0,Hc)+"<b>"+Eb.substring(Hc,Hc+jc.length)+"</b>"+Eb.substring(Hc+jc.length,Eb.length)):oa+Eb;fb=fb?String.format(ed,m.a.tNe,Ce.a.XY(V.a.gf(0)),r.a.instance.ga(717)):"";return String.format(Ec,
fb,hb,pc[ja.itemType],this.IZ,oa)}if(5===ja.itemType)return String.format(ud,"",hb,pc[ja.itemType],this.IZ,Ce.a.Dg(ja.name),Ce.a.Dg(ja.via));if(4===ja.itemType)return String.format(ud,"(...)",hb,pc[ja.itemType],this.IZ,Ce.a.Dg(ja.name));if(6===ja.itemType)return fb=fb?String.format(ed,m.a.tNe,Ce.a.XY(V.a.gf(0)),r.a.instance.ga(717)):"",String.format(rc,fb,this.IZ,Ce.a.Dg(ja.name),Ce.a.Dg(ja.via),hb,pc[ja.itemType]);fb=String.format(ed,2===ja.itemType||3===ja.itemType?m.a.Rrh:m.a.Prh,Ce.a.XY(V.a.gf(0)),
r.a.instance.ga(714));return String.format(rc,fb,this.IZ,Ce.a.Dg(ja.name),Ce.a.Dg(ja.via),hb,pc[ja.itemType])}nWe(ja){const hb=new Xb;hb.label=ja.label;hb.textEdit=ja.textEdit;hb.kind=Kd.oWe(ja.itemType);hb.type=ja.nzb?1:0;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===hb.kind){const oa=this.formulaAssistanceControl.iOh(ja.label);hb.detail=oa?oa:ja.via}else hb.detail=ja.via;return hb}iRe(ja,hb,oa,fb,Eb,jc){$a.a.equals(hb,"Pretend this is the line.",!1)&&0<
Eb.length||$a.a.jL(hb,ja)?(fb.execute(Eb),fb.execute(jc)):oa&&ja.length>=w.$2g&&Kd.Kch(hb,w.Rfg,ja)?fb.execute(Eb):!oa&&ja.length>=w.Z2g&&$a.a.contains(hb,ja,!0)&&fb.execute(Eb);return{L8e:Eb,SGf:jc}}static Kch(ja,hb,oa){for(const fb of hb)if(hb=ja.split(fb),!(2>hb.length))for(const Eb of hb)if($a.a.jL(Eb,oa))return!0;return!1}static YDj(ja,hb,oa){for(const fb of hb)if(hb=ja.toLowerCase().indexOf((fb+oa).toLowerCase()),0<hb)return hb+1;return-1}}Object(d.a)(Kd,"FormulaAutoCompleteListBox",Uc.a,[541]);
class Zd{constructor(){this.A8=this._name=null}get name(){return this._name}get toolTip(){return this.A8}}Object(d.a)(Zd,"LETVariableInfo",null,[]);class Xd{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Xd,"TableColHeaderNameInfo",null,[]);class Je{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Je,"TableNamedObjectInfo",null,[]);class Xe{constructor(){this.A8=this._name=null}get name(){return this._name}get toolTip(){return this.A8}}Object(d.a)(Xe,
"TableSpecialStructRefInfo",null,[]);var Ke=a(113),Qe=a(172),df=a(31),Ne=a(100),jf=a(903),Le=a(250),me=a(51),Za=a(182);class Tb{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(Tb,"FormulaAutoCompleteCallbacks",null,[]);class uc{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(uc,"FormulaAutoCompleteRenderingInfo",null,[]);class Oc{}Object(d.a)(Oc,"RunExperimentRequest",
null,[]);class sb extends Jb.a{constructor(ja,hb,oa,fb,Eb,jc,Hc,qd,zd){super(ja);this.functionInfoManager=hb;this.calcManager=fb;this.instantaneousSupportInformationManager=Eb;this.formulaAssistanceUIControl=Hc;this.formulaAssistanceTelemetryManager=qd;this.pluginScheduler=zd;this.Ubc=!1;this.C4=this.iqd=this.ZU=this.Jg=this.GFa=this.kr=null;this.C3b=this.XLb=this.Crb=this.HHe=this.N2=this.X8b=this.v2a=0;this.Fvc=!1;this.Mnc=this.Zha=null;this.columnName="";this.lve=this.u4c=!1;this.RIa=[];this.IP=
null;this.JRa=[];this.u7=this.zad=this.Pq=null;this.eLa=this.isCellContentOnlyEqualDuringEdit=this.KRa=this.LRa=this.fAa=this.Sea=!1;this.Swa=null;this.vMa=0;this.H0d=null;this.XBb=0;this.Rkd=!1;this.onRestoreFocus=()=>{};this.Zeb=void 0;this.Naa=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Gdf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.Hyb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);this.dgd=()=>{this.Nk&&this.raiseEvent(sb.E$c,null)};this.eRe=()=>{this.Zha=!1;this.ZU=this.Ya.text;this.jh.DIa(this.Hr,this.ZU,!0,this.columnName,void 0,!1);1===this.jh.ir.length&&1===this.jh.zV.length?(this.set_visible(!1),this.lve||this.bjd()):this.show()};this.pLi=Hd=>{if(Rc.a(Hd))-315732528!==Hd.Errors[0].MessageId&&l.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${df.a.zc(Hd.Errors)}`);else if((Hd=Hd.Result)&&
Hd.length){this.Jg.kO||(this.Jg.kO={},this.Jg.kO.HeadersList=[]);this.Jg.kO.IsFullTableHeaders=!0;for(let Yd=0;Yd<Hd.length;++Yd)this.Jg.kO.HeadersList[Yd]={},this.Jg.kO.HeadersList[Yd].Index=Yd,this.Jg.kO.HeadersList[Yd].Name=Hd[Yd];this.pGf(!0);this.ZU=this.H1e();this.jh.DIa(this.Hr,this.ZU,!0,void 0,void 0,!0);this.show()}else l.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.oLi=Hd=>{Hd=Mb.a.kf(Hd.data);l.ULS.sendTraceTag(537162011,
0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${df.a.zc(Hd)}`)};this.xsf=(Hd,Yd)=>{this.gridView.$a||this.gridView.vi||this.yNa(null===Yd||void 0===Yd?void 0:Yd.cell)};this.Lh=(Hd,Yd)=>{this.yNa(null===Yd||void 0===Yd?void 0:Yd.oia)};this.o5=(Hd,Yd)=>{this.TKd(Yd.newValue)};this.Uc=()=>{(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Nk)&&this.set_visible(!1)};this.rwf=()=>{this.u7=this.GFa=
null};this.Eh=()=>{this.Nk&&this.M0a()};this.onFunctionInfoLoaded=()=>{this.onb()};this.Sxa=()=>{this.uja?(this.GFa=this.u7=null,this.onb()):this.Qg.Pk&&this.Tqe()};this.Oba=()=>{this.IP&&W(this.$,this.IP.HelpId,this.IP.IsDynamicUdf);return!0};this.Rba=(Hd,Yd)=>{0==Yd.Kq&&(170==Yd.wf.operation.operationName&&this.formulaAssistanceTelemetryManager.Nhc++,this.$.userOperationManager.Co(this.Rba))};this.UNa=(Hd,Yd)=>{0==Yd.Kq&&(12==Yd.wf.operation.operationName&&this.$.userOperationManager.Fr(this.Rba),
this.$.userOperationManager.Co(this.UNa))};this.M0a=()=>{this.Nk&&this.msd();this.qF&&this.Ya.$a&&this.cma();this.Pq=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.HZb),this.kr.jf=!1);this.Rkd=!1};this.mBf=()=>{this.qF&&this.cma();this.V2f();1===this.WVf.type&&J.EwaSettings.xb()&&!this.Ya.text.includes("\n")&&this.jDd(this.WVf)};this.onDismiss=()=>{this.qe=!1;this.gridView.Qi.textBox.focus()};this.xQa=()=>{const Hd={};this.jh.ugc?Hd[z.a.sU]="SmartSuggestionsCard":
Hd[z.a.sU]="FunctionAndSmartSuggestionsCard";this.$.xd(802602464,0,8,Hd)};this.jyd=(Hd,Yd)=>{this.jh.Qcg(Yd);this.Nk&&(this.HHa=!0)};this.iyd=Hd=>{this.Nk&&(this.EHa=!0);this.qF?(this.sze(),this.L8&&this.xUf(),this.gridView.t$.ZWf(),this.gridView.Qi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Hd.textEdit?this.Apb(Hd.textEdit):this.Py(!0)};this.$p=A.g(ja);this.domElement.className=pb.a.eLe;this.Qg=jc.T1c(ja,oa);this.s4b=new lb(ja);this.uwg=oa;sb.vid||(sb.vid=sb.bJa());this.domElement.innerHTML=
sb.vid;this.lxd=RegExp("\\d+");Le.d(this.style,this.$.isChromeRtl);this.pia=new pe(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler);hb=$get(w.wad,this.domElement);oa=$get(w.sad,this.domElement);fb=$get(w.yad,this.domElement);this.dog=new Kd(this.$,hb,fb,oa,this);this.Qg.IXb(this.Sxa);this.functionInfoManager.NXa(this.onFunctionInfoLoaded);this.functionInfoManager.mEg(this.rwf);this.HZb=this.domElement;this.Nk&&
(this.$.xa.Pf(this.Eh),this.jh.NTc(this.mBf),J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.HZb=document.createElement("div")));this.cSa(!0);this.m6f(!0);this.$.domElement.appendChild(this.HZb);this.OOc=0;(oa=Ke.a(ja))&&this.RIa.push(new Ge(ja,oa,this,this.formulaAssistanceTelemetryManager));this.RIa.push(new Ge(ja,this.$p.Wb,this,this.formulaAssistanceTelemetryManager));this.rtb=this.RIa[0];this.Lob=this.RIa[this.RIa.length-1];ja.da.Ga(221,this);
this.instantaneousSupportInformationManager||this.$.da.Za(268,Hd=>{this.instantaneousSupportInformationManager=Hd});this.vQe=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.eda.anyPluginInitialized?l.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):
this.formulaAssistanceTelemetryManager.eda.anyPluginInitialized||(this.XBb=J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.eAa=H.a.pZ(this.$);this.Hwc=H.a.ywa(this.$);this.Mwd=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.B1=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.AWc=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");H.a.TU()&&this.Xjd();
H.a.VM(this.$)&&hb.classList.add("ewa-fb-refactor");this.Nk?this.gridView.ha.LG(this.Uc):this.gridView.ha.cT(this.Uc);this.kr=new Wc(this.$,this.formulaAssistanceUIControl,1,Ka.a.Z$c,this.dgd);this.xld=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.L8=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.Ubf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");this.ohi=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",
!1)}Wle(ja){this.addHandler(sb.fad,ja)}jPf(ja){this.removeHandler(sb.fad,ja)}Ule(ja){this.addHandler(sb.E$c,ja)}hPf(ja){this.removeHandler(sb.E$c,ja)}Vle(ja){this.addHandler("FormulaAutoCompleteShown",ja)}iPf(ja){this.removeHandler("FormulaAutoCompleteShown",ja)}get Pt(){return this.jh}get Hr(){return this.u7}get gJb(){return this.jh.de}get OTe(){return this.jh}get qTe(){return this.pia}get jh(){return this.dog}get e0a(){return this.eAa?this.Ya?this.Ya.text:null:this.ZU}get_visible(){return void 0!==
this.Zeb?this.Zeb:this.Zeb=super.get_visible()}set_visible(ja){if(this.Zeb===ja)return this.Nk&&!ja&&this.M0a(),ja;this.pia.set_visible(ja);this.Nk&&!ja&&this.M0a();Sys.UI.Control.prototype.set_visible.call(this,ja);return this.Zeb=ja}get qe(){return this.Pt.qe}set qe(ja){this.Nk&&!ja&&this.M0a();this.Pt.qe=ja}get tableManager(){return this.uwg}get uja(){return 0<this.qY}get qF(){return this.Sea}get gridView(){return this.ohi?this.$p:A.g(this.$)}get Db(){return this.gridView.Db}GTg(ja,hb){this.qe&&
(ja+=w.openParen,hb++,this.ABd(ja,hb));var oa=hb===ja.length||ja.charAt(hb)===w.closeParen;if(!(0<hb&&ja.charAt(hb-1)===w.openParen&&oa))return l.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${hb} is invalid. Is cell empty: ${!ja.length}. Function exists in cell: ${!!this.IP}`),!1;oa=ja.substring(0,hb).lastIndexOf(this.$.listSeparator);const fb=ja.substring(0,hb-1).lastIndexOf(w.openParen);ja=ja.substring(-1===oa&&-1===fb?1:Math.max(oa,fb)+1,
hb-1).trim();return this.functionInfoManager.Ocd(ja)?!0:(l.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.IP}`),!1)}Vai(ja,hb){var oa=this.GTg(ja,hb);if(!oa||!this.IP)return l.ULS.shipAssertTag(537162051,0,!oa||oa&&!!this.IP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Aqf:0,dSe:0};oa=this.IP.Params;oa=oa.replace(RegExp("[\\[\\]]",
"g"),"");const fb=ja.charAt(hb-1)===w.openParen,Eb=fb?"":"(",jc=hb===ja.length?")":"";var Hc=this.$.listSeparator;Hc=oa.includes(Hc)?oa.indexOf(Hc):oa.length;return{returnValue:ja.substring(0,hb)+Eb+oa+jc+ja.substring(hb,ja.length),Aqf:fb?hb:hb+1,dSe:Hc}}mt(ja,hb){this.Nk&&void 0!==this.Pq&&null!==this.Pq&&this.Pq();this.Nk||super.mt(ja,hb)}get rZb(){return this.H0d}get qY(){return this.HHe}set qY(ja){this.HHe=ja;ja||(this.N2=0)}get ywj(){if(null==this.Mnc){const ja=this.$.jc;this.Mnc=!!ja&&!ja.inEmbedView}return this.Mnc}get WVf(){return this.jh.G1b[this.jh.Ej.rowIndex]}get VTe(){!this.zad&&
this.pluginScheduler&&(this.zad=this.pluginScheduler.getFunctionsShortDescriptions());return this.zad}dispose(){if(this.$){this.cSa(!1);const ja=this.gridView;this.L8&&(this.$.userOperationManager.Co(this.Rba),this.$.userOperationManager.Co(this.UNa));ja&&(ja.ha&&(this.Nk?ja.ha.RF(this.Uc):ja.ha.qR(this.Uc),H.a.TU()&&4!==this.XBb&&(this.Hyb?ja.dc.Gk(this.Lh):ja.ha.dma(this.xsf))),ja.view.Oq(this.Glc));this.Nk&&this.$.xa&&this.$.xa.Ag(this.Eh)}this.functionInfoManager&&(this.functionInfoManager.Bab(this.onFunctionInfoLoaded),
this.functionInfoManager.waj(this.rwf));this.Qg&&this.Qg.Oqc(this.Sxa);this.Nk&&this.jh&&this.jh.lId(this.mBf);H.a.Ldc&&this.Ya&&this.Ya.qHb(this.o5);this.m6f(!1);U.a.Ia(this.jh);U.a.Ia(this.rZb);U.a.Ia(this.pia);U.a.Ia(this.kr);this.Ya=this.functionInfoManager=this.Qg=null;U.a.rc(this.RIa);this.Jg=this.u7=this.pia=this.RIa=null;super.dispose()}iwa(){return!this.Hr}Yhi(){return!this.GFa}Sh(ja,hb){if(!this.iwa()){if(this.Nk&&this.qF){if(125627505===hb||267796030===hb)return this.Nk&&this.Kzc(hb),this.sze(),
this.L8&&this.xUf(),!1;if(1872288872===hb)return this.cma(),this.qe=!1,!0;if(this.jh.ugc&&(-798660877===hb||137938150===hb))return!1}if(1!==this.jh.J_||125627505!==hb&&267796030!==hb)if(6===this.jh.J_){var oa=ja.keyCode;13!==oa&&9!==oa||this.Py(!1)}else{if(4===this.jh.J_||5===this.jh.J_)return super.Sh(ja,hb,!0);1===this.jh.zV.length&&(oa=ja.keyCode,this.lve=8===oa||127===oa||46===oa?!0:!1)}else{if(this.Py(!1)&&!this.uja)return this.gridView.ha.Sh(ja,hb);if(125627505===hb&&this.uja)return!0}}return super.Sh(ja,
hb)}Wrc(){this.Qg.abb();this.u7=null;null==this.Zha||this.Zha||this.oic("NoFieldChosen",1,2,1);this.Zha=null;this.qY=0;this.C4=this.iqd=this.Mnc=null}onb(){this.Gdf&&this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceOverall"]);const ja=!!this.Ya&&!Ya.f(this.$.oa);let hb=null;this.B1&&ja&&(hb=this.Ya.text,hb.startsWith("=")&&(this.eLa=!0,1===hb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if((this.eAa||this.Hwc)&&ja){this.B1||(hb=this.Ya.text);const oa={content:hb,caretPosition:null};
(this.Naa?this.pluginScheduler.getRequester().functionSuggestion(oa,0):this.pluginScheduler.requester().functionSuggestion(oa)).then(fb=>{if(0===fb.kind){l.ULS.shipAssertTag(537162050,0,!!fb&&!!fb.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Eb=xa.toArray(xa.select(xa.asEnumerable(fb.payload.items),jc=>sb.O1g(jc)));this.Hwc&&this.gridView.t$.BNd(fb.payload,hb);this.eAa&&(this.JRa=Eb,Ta.AFrameworkApplication.Mg||(this.AWc&&this.Db.o4(this.gridView.ha.sa.activeCell)?
this.formulaAssistanceTelemetryManager.BM.smartSuggestionWouldSuggestInsidePivotCounter++:this.Uqe(ja,!0)))}return null})}this.eAa&&ja||this.Uqe(ja,!1)}H1e(){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var ja=this.gridView.lj?this.rtb.JP:this.Lob.JP;this.XLb="@"===this.Ya.text.charAt(ja+1)&&this.Ya.textBox.caretPosition>ja+1?ja+2:ja+1}else{ja=this.Ya.text.lastIndexOf(w.gjf);const hb=this.Ya.text.lastIndexOf("[");this.XLb=ja+1>=hb?ja+2:hb+1}return this.Ya.text.substring(this.XLb,
this.Ya.textBox.caretPosition)}Vqe(){this.g3f()&&(this.J9g(),this.Hr&&(this.Zha=!1,this.ZU=this.H1e(),this.jh.DIa(this.Hr,this.ZU,!0,void 0,void 0,!0),this.show(),J.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.pia.prb()))}Tqe(){this.g3f()&&(this.rZb&&this.rZb.cancel(),this.Qg.A5a?(this.iwa()&&this.FBe(!0),this.get_visible()?this.eRe():this.H0d=Qe.AsyncMethodContext.hr(this.eRe,w.gch,Wa.a.nCh,this.rZb)):this.JY())}g3f(){return this.Ya?0<this.$.rb.dR||
!this.Ya.text||!this.Ya.$a?(this.set_visible(!1),!1):Ya.f(this.$.oa)?!1:!0:!1}Apb(ja){this.Ya&&this.qe&&(this.kkd(this.Ya.text,ja),this.Ya.textBox.caretPosition=ja.range.start.character+ja.newText.length,this.set_visible(!1))}Py(){var ja;if(!this.Ya||!this.qe)return!1;const hb=this.jh.J_;this.Ubf&&this.formulaAssistanceTelemetryManager.C8e(Kd.oWe(hb));let oa="";var fb=0;const Eb=this.gridView;var jc=this.Ya.text,Hc=0,qd=this.jh.de,zd=!1;if(0===hb||2===hb||3===hb||7===hb)oa+=jc.substr(0,this.v2a)+
this.jh.de,0!==hb||this.jh.de.endsWith(")")||(oa+="("),fb=oa.toString().length,oa+=jc.substr(this.X8b),2===hb&&(Hc=4,qd="DefinedName",zd=!0,this.set_visible(!1));else if(1===hb)if(this.Zha=!0,this.uja){oa+=jc.substr(0,this.qY+2);!oa.toString().endsWith(Ab.a.bU)&&J.EwaSettings.ma(135)&&(oa+=Ab.a.bU);Hc=this.jh.de;Hc=Hc.replace("'","''");Hc=Hc.replace("[","'[");Hc=Hc.replace("]","']");if(this.u4c||this.Uxh(Hc))Hc=Ab.a.Jqi+Hc+Ab.a.Ahj,zd=!0;oa+=Hc;fb=oa.length;Hc=3;Za.a("PulloutFieldAccepted")}else return this.Ya.text=
this.jh.de,this.set_visible(!1),Eb.Fo(!1),Eb.focus(),this.oic("FieldName",1,1,1),Za.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===hb)l.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),oa+=jc.substr(0,this.XLb),$a.a.equals(this.jh.de,"@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString,!1)?oa+="@":(oa+=this.jh.de,zd=!0,this.set_visible(!1)),fb=oa.length;else if(4===hb){l.ULS.sendTraceTag(575776009,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");oa+=jc.substr(0,this.XLb);zd="";fb=!1;var Hd=[39,91,93,64,35];for(let Yd=0;Yd<this.jh.de.length;Yd++){const se=this.jh.de.charCodeAt(Yd);Hd.includes(se)&&(zd+="'");zd+=this.jh.de.charAt(Yd).toString();fb||$a.a.isNumeral(se)||$a.a.tdf(se)||(fb=!0)}Hd=this.gridView.lj?this.rtb.JP:this.Lob.JP;jc=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===jc.charAt(Hd+
1)&&fb:jc.lastIndexOf(w.gjf)+1>=jc.lastIndexOf("[")&&fb;oa+=jc?"["+zd+"]":zd;zd=!0;this.set_visible(!1);fb=oa.toString().length}else if(6===hb)oa+=jc.substr(0,this.Crb);else return l.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=oa;this.Ya.textBox.caretPosition=fb;this.Ya.zwa()&&(null===(ja=Eb.Lr)||void 0===ja?0:ja.cua)&&Eb.Lr.oJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.wv.length);Eb.lj&&
(ja=Eb.Wb,ja.text=this.Ya.text,ja.setCaretPosition(this.Ya.textBox.caretPosition));qd=(null==this.Zha?0:this.Zha)?"FieldName":qd;this.jh.Ej.sectionRowIndex>=this.jh.zV.length?this.oic(qd,4,Hc,0):this.oic(qd,1,Hc,0);zd||(5===hb||4===hb?this.Vqe():this.onb());return!0}JY(ja=null,hb=null){ja?(this.Qg.abb(),this.Qg.JY(ja,!1,!1,hb)):(ja=this.gridView,ja.ha.sa.xg&&(ja=Ib.v(ja.ha.sa.Wc,this.$),this.Qg.JY(ja,!0,!0,hb)))}cma(){this.Sea=!1;this.Ya.QGe()}iOh(ja){ja=this.calcManager.getWorksheetFuncId(ja);return this.VTe?
this.VTe.descriptionsMap.get(ja):null}FBe(ja){if(this.Yhi()){if(this.Qg.A5a&&this.Qg.Pk&&(!this.Qg.Pk.length||!this.Qg.Pk[0].FieldInfoDataList))return;this.BPj(ja)}ja=xa.asEnumerable(this.GFa);ja=xa.concat(ja,this.iQh(this.Ya.text));J.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Nk&&(ja=xa.concat(ja,this.qRh()));xa.OBc(ja,hb=>hb.name,new jf.a);this.eAa&&(ja=xa.concat(xa.asEnumerable(this.JRa),ja),J.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
(0<this.JRa.length&&(this.fAa=!0),this.JRa=[]));this.u7=xa.toArray(ja)}J9g(){var ja=this.Ya.text;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var hb=this.gridView.lj?this.rtb.pHa:this.Lob.pHa,oa=!0;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==hb&&(this.Jg=Object(Qa.a)(je.a,this.$.yb.getItemByName(hb))),this.Jg||(this.Jg=this.tableManager.Jg,oa=!1),!this.Jg){l.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");
return}}else this.Jg=Object(Qa.a)(je.a,this.$.yb.getItemByName(hb)),this.Jg||(this.Jg=this.tableManager.Jg,oa=!1);this.Jg.kO&&this.Jg.kO.IsFullTableHeaders?this.pGf(oa):ub.d(this.Jg)?(l.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),gb.p(this.$.pa.va,this.Jg.aj,this.pLi,this.oLi,null,null)):l.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&
this.tableManager.Jg)if(hb=this.calcManager.I3a(this.tableManager.Jg))if(this.calcManager.gIg(this.tableManager.Jg,hb)){ja=xa.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){const fb=this.$_a("@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString);ja=xa.concat(ja,(oa=new Lb.a,oa.add(fb),oa))}ja=xa.concat(ja,xa.select(xa.asEnumerable(hb.toArray()),fb=>{const Eb=new ac,jc=new Xd;jc._name=fb.toString();Eb.a_f(jc);return Eb}));this.u7=xa.toArray(ja)}else ja.endsWith("[")&&
"["!==ja.charAt(ja.length-2)&&l.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${hb.count} columns for a table with id ${this.tableManager.Jg.aj} of size ${this.tableManager.Jg.usedRange.right-this.tableManager.Jg.usedRange.left+1}`);else ja.endsWith("[")&&"["!==ja.charAt(ja.length-2)&&l.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}Uxh(ja){if(!ja)return!1;
let hb=ja.charCodeAt(0);if(46===hb||48<=hb&&57>=hb||63===hb)return!0;for(let oa=0;oa<ja.length;oa++,hb=ja.charCodeAt(oa))if(!((J.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?$a.a.isLetter(hb):$a.a.dnd(hb))||92===hb||95===hb||63===hb||48<=hb&&57>=hb))return!0;return!1}ABd(ja,hb){let oa=!1,fb=!1;var Eb=!1,jc=0;let Hc=0;this.v2a=0;this.X8b=hb;this.C3b=1;for(let qd=hb-1;0<=qd;--qd)switch(ja.charCodeAt(qd)){case 39:fb=!fb;break;case 34:oa=
!oa;break;case 91:++jc;Eb=jc>Hc;break;case 93:++Hc}Eb=Object(Ub.a)(new Qd,{dsa:!oa,esa:!fb,Yga:!Eb,WEb:1});jc=this.JVi(ja,hb,Eb);hb=this.KVi(ja,hb,Eb.dsa,Eb.esa,Eb.Yga);this.C3b=jc+hb;if(this.OOc=jc-1)this.Fvc=!1;this.Jyh(ja,oa,fb,Eb.$Ad,Eb.aBd)}Xjd(){4!==this.XBb&&(this.Hyb?this.gridView.dc.Mk(this.Lh):this.gridView.ha.aga(this.xsf));const ja=H.a.vxb()?this.$p.Xb(null):void 0;this.yNa(ja);H.a.Ldc&&this.gridView.Qi.KXa(this.o5);sb.VKd(this.pluginScheduler);this.eAa&&this.YVg()}ixh(){return this.eAa||
this.vQe}LVi(){var ja=this.C4;if(!this.ywj||!ja)return this.qY=0,this.GFa=this.u7=null,!1;ja=ja.endsWith(Ab.a.bU);let hb;if(J.EwaSettings.ma(135)&&({sheetRange:hb}=this.YMj(this.C4.substring(0,this.N2))).returnValue){const oa=this.C4.substring(0,this.qY);if(ja&&oa!==this.iqd)return this.iqd=oa,this.qY=this.C4.length-(ja?1:0),this.JY(hb,this.C4),this.Zha=!1,l.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}iQh(ja){const hb=new Lb.a;this.calcManager&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
l.ULS.shipAssertTag(537162014,0,!!this.calcManager.ssa(db.Range.Tc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.vQe&&(ja=this.calcManager.extractLetVariables(ja,this.Ya.textBox.caretPosition)))for(const oa of ja){ja=new Zd;ja._name=oa;ja.A8=r.a.instance.ga(2211);const fb=new ac;fb.tqj(ja);hb.add(fb)}return hb}qRh(){const ja=new Lb.a,hb=this.$.yb.items;for(let fb=0,Eb=hb.length;fb<Eb;fb++){var oa=hb[fb];if(!Ya.n(oa))continue;const jc=
new Je;jc._name=oa.name;oa=new ac;oa.Isj(jc);ja.add(oa)}return ja}$_a(ja){const hb=new ac,oa=new Xe;oa._name=ja;hb.Jsj(oa);return hb}pGf(ja){const hb=new Lb.a,oa=this.Ya.text.charCodeAt(this.Ya.text.length-1),fb=this.Ya.textBox.caretPosition-1;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(fb):91===oa){var Eb=this.$_a("@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString);hb.add(Eb)}for(var jc of this.Jg.kO.HeadersList){Eb=
new ac;const Hc=new Xd;Hc._name=jc.Name;Eb.a_f(Hc);hb.add(Eb)}jc=this.gridView.lj?this.rtb.JP:this.Lob.JP;Eb=this.Ya.text.charCodeAt(jc+1);(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!ja||fb!==jc&&35!==Eb:!ja||91!==oa&&35!==oa)||(ja=this.$_a("#"+this.instantaneousSupportInformationManager.De.AllStructRefString),hb.add(ja),ja=this.$_a("#"+this.instantaneousSupportInformationManager.De.DataStructRefString),hb.add(ja),ja=this.$_a("#"+this.instantaneousSupportInformationManager.De.HeadersStructRefString),
hb.add(ja),ja=this.$_a("#"+this.instantaneousSupportInformationManager.De.TotalsStructRefString),hb.add(ja));hb&&(this.u7=hb.toArray())}BPj(ja){let hb=xa.empty();!ja&&this.functionInfoManager.qZ&&(hb=xa.concat(hb,xa.select(xa.asEnumerable(this.functionInfoManager.W8b),oa=>{const fb=new ac;fb.DYf(oa);return fb})),ja=this.s4b.wFe,0<ja.length&&(hb=xa.OBc(xa.concat(hb,xa.select(xa.asEnumerable(ja),oa=>{const fb=new ac;fb.Roj(oa);return fb})),oa=>oa.name,new jf.a)));if(this.Qg.A5a&&this.Qg.Pk){if(!this.Qg.Pk.length||
!this.Qg.Pk[0].FieldInfoDataList)return;hb=xa.OBc(xa.concat(hb,xa.select(xa.asEnumerable(this.Qg.Pk[0].FieldInfoDataList),oa=>{const fb=new ac;fb.qpj(oa);return fb})),oa=>oa.name,new jf.a);this.columnName=this.Qg.Pk[0].ColumnName}this.GFa=xa.toArray(hb)}yNa(ja){var hb;if(1!==this.XBb){var oa=this.gridView.ha.sa.activeCell;if(oa){var fb=this.calcManager.ssa(oa,!this.xld);if(fb){var Eb=this.$.xa,jc=fb.sheet.index;0>=Eb.count||0>jc||jc>=Eb.count||(jc=Eb=null,this.Mwd&&void 0!==this.calcManager&&null!==
this.calcManager&&(ja=null!==(hb=null===ja||void 0===ja?void 0:ja.cell)&&void 0!==hb?hb:this.gridView.Ea.Qr(oa))&&(hb=this.calcManager.T$b(ja.Ek),void 0!==hb&&null!==hb&&(Eb=hb.FormatString,jc=hb.Builtin)),2!==this.XBb&&this.pluginScheduler.notifier().setActiveCell({colIndex:fb.range.col,rowIndex:fb.range.row,sheetIndex:this.$.xa.getItem(fb.sheet.index).sheetId,docName:fb.sheet.document.name,docPath:fb.sheet.document.path,formatString:Eb,builtIn:jc}))}}}}xUf(){this.formulaAssistanceTelemetryManager.NH=
{Bk:this.gridView.ha.sa.activeCell,Nob:this.gridView.Wb.text,Cpb:!0};this.formulaAssistanceTelemetryManager.AAb=this.$.ea.Le;this.formulaAssistanceTelemetryManager.Mhc=this.$.xa.oa.sheetId;this.$.userOperationManager.Fr(this.UNa)}YVg(){this.gridView.lj?this.rtb.wT(!1):this.Lob.wT(!1)}Tgf(ja){let hb;hb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?$a.a.isLetter(ja):$a.a.dnd(ja);return 48<=ja&&57>=ja||46===ja||95===ja||hb}show(){if(this.Hr){var ja=
this.jh.Qcg(0);this.Nk?0<this.jh.ir.length?ja||this.V2f():this.M0a():((ja=0<this.jh.ir.length)&&this.formulaAssistanceTelemetryManager.gO(["autoCompleteRender"]),!this.qe&&this.columnName&&ja&&this.jh.J2i(this.jh.ir.length,this.columnName),this.qe=ja,this.pia.show(this.IP),this.WAa(!0),this.jh.wxa(),ja&&this.formulaAssistanceTelemetryManager.RP(["autoCompleteRender"]))}}KVi(ja,hb,oa,fb,Eb){for(oa=Object(Ub.a)(new Qd,{TDf:41,nye:40,dsa:oa,esa:fb,Yga:Eb});hb<ja.length&&!this.QEf(ja,hb,oa);++hb);return oa.WEb}JVi(ja,
hb,oa){for(--hb;0<=hb&&!this.QEf(ja,hb,oa);--hb);return oa.WEb}QEf(ja,hb,oa){const fb=ja.charCodeAt(hb);0>=this.N2&&(this.N2=ja.substring(0,hb).lastIndexOf(Ab.a.bU));46===fb&&(hb<this.N2?this.N2=hb:hb>this.Crb&&(this.qY=this.Crb=hb));if(!this.Tgf(fb)&&!sb.yni(fb)&&(!this.uja||hb<=this.N2||!sb.W6h(fb,oa))){oa.Muf&&(oa.Muf=!1,this.v2a=hb+1);if(oa.Gzd){oa.aBd=hb+1;if(this.functionInfoManager.Ocd(ja.substring(oa.aBd,oa.$Ad)))return!0;oa.Gzd=!1}switch(fb){case 39:oa.esa=!oa.esa;break;case 34:oa.dsa=!oa.dsa;
break;case 91:oa.Yga=!1;break;case 93:oa.Yga=!0}fb===this.$.listSeparator.toString().charCodeAt(0)&&oa.esa&&oa.dsa&&!oa.i_a&&(!this.uja||oa.Yga)&&(hb<oa.HLd||-1===oa.HLd)&&(oa.WEb+=1,this.C3b++);fb===oa.nye&&oa.dsa&&oa.esa&&(!this.uja||oa.Yga)?oa.i_a+=1:fb===oa.TDf&&oa.dsa&&oa.esa&&(!this.uja||oa.Yga)?0<oa.i_a?--oa.i_a:(oa.HLd=oa.cSe,oa.cSe=hb,0<hb&&this.Tgf(ja.charCodeAt(hb-1))&&(oa.Gzd=!0,oa.$Ad=hb)):this.uja&&46===fb&&hb>this.N2&&(hb<this.N2?this.N2=hb:hb>this.Crb&&(this.qY=this.Crb=hb))}return!1}Jyh(ja,
hb,oa,fb,Eb){this.X8b>this.v2a&&0<=this.v2a?hb||oa||(this.ZU=ja.substring(this.v2a,this.X8b)):this.ZU=null;fb!==Eb?(ja=ja.substring(Eb,fb),this.IP&&$a.a.equals(this.IP.NameDataStrings,ja,!0)||(this.Fvc=!0),this.IP=this.functionInfoManager.Ocd(ja)):(this.Fvc=!1,this.IP=null)}m6f(ja){const hb=$get(w.KEf+"_"+w.VEb,this.domElement),oa=$get(w.LEf+"_"+w.VEb,this.domElement);ja&&!this.Ubc?(hb&&mb.a.instance.ra(Qb.a.click,hb,this.Oba),oa&&mb.a.instance.ra(Qb.a.click,oa,this.Oba),this.Ubc=!0):this.Ubc&&(hb&&
mb.a.instance.Ba(Qb.a.click,hb,this.Oba),oa&&mb.a.instance.Ba(Qb.a.click,oa,this.Oba),this.Ubc=!1)}YMj(ja){let hb;hb=null;var oa;if(({sheetName:fb,range:oa}=Ib.Z(ja,this.$.ea.xa)).returnValue&&oa){if(!fb){var fb=Object(Qa.a)(Ne.a,this.$.oa);if(!fb)return{returnValue:!1,sheetRange:hb};fb=fb.name}hb=Ib.v(oa,this.$);hb.SheetName=fb;this.u4c=!1;return{returnValue:!0,sheetRange:hb}}return({sheetName:fb,range:oa}=this.s4b.HMj(ja)).returnValue?(hb=Ib.v(oa,this.$),hb.SheetName=fb,this.u4c=!0,{returnValue:!0,
sheetRange:hb}):{returnValue:!1,sheetRange:hb}}TKd(ja){ja={content:ja,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Naa?this.pluginScheduler.getRequester().runAuthoringExperiment(ja,0):this.pluginScheduler.requester().runAuthoringExperiment(ja)}bjd(){if(1===this.jh.zV.length&&this.Hr.length){var ja=this.Hr[this.jh.zV[0]];if(1===ja.itemType){var hb=ja.name;ja=this.Ya.text;hb=hb.substring(ja.length,hb.length);hb.length&&(this.Ya.text=ja+hb,this.Ya.textBox.selectRange(ja.length,
this.Ya.text.length))}}else l.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.jh.zV.length})`)}oic(ja,hb,oa,fb){const Eb={};Eb.a=ja;Eb.b=hb;Eb.c=oa;Eb.d=fb;me.b().Ie(38,Eb,!0)}Uqe(ja,hb){if(!this.functionInfoManager.qZ){if(ja)if(this.ABd(this.Ya.text,this.Ya.textBox.caretPosition),this.eAa||this.ZU){const oa={};oa.Filter=this.ZU?this.ZU.charAt(0).toString():"";oa.FilterType=1;oa.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.m1a(oa)}else J.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&
this.get_visible()&&this.set_visible(!1);if(!hb)return}0<this.$.rb.dR||this.Ya&&!this.Ya.$a?this.set_visible(!1):ja&&(this.ABd(this.Ya.text,this.Ya.textBox.caretPosition),this.pia.update(this.IP,this.C3b,this.OOc,this.Fvc),this.C4=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.N2=this.C4.indexOf(Ab.a.bU),this.qY=this.C4.lastIndexOf(Ab.a.bU),this.LVi()?(ja=new ac,ja.hrj(),this.GFa=this.u7=ja=[ja],this.jh.CRj(ja),this.show()):((this.ixh()||this.iwa())&&this.FBe(!1),0<this.qY?this.jh.DIa(this.Hr,
this.C4,!1,void 0,this.C4.lastIndexOf(Ab.a.bU),!1):this.jh.DIa(this.Hr,this.ZU,!1,void 0,this.qY,!1),this.show(),this.Nk&&(this.jh.ir.length||this.gridView.Qi.NK?this.pia.prb():(this.pia.oJd(),this.Nk&&this.M0a()))))}V2f(){if(0<this.jh.ir.length){this.formulaAssistanceTelemetryManager.gO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const ja={};ja.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(ja);this.Pq=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.HZb,
this.gridView.Qi.textBox.domElement,this.Lcd())};this.Pq();this.Nk&&this.jh.ugc&&this.raiseEvent(sb.fad,null);this.Rkd||this.jh.ugc||this.raiseEvent("FormulaAutoCompleteShown");this.Rkd=this.kr.jf=!0;this.Ubf&&this.formulaAssistanceTelemetryManager.D8e(this.jh.G1b)}this.formulaAssistanceTelemetryManager.RP(["autoCompleteRender"]);!J.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.JRa&&null!==this.JRa&&0<this.JRa.length&&(this.fAa=!0)}}msd(){this.GHa&&
(this.formulaAssistanceTelemetryManager.LX.selectByArrowKeyCounter++,this.GHa=!1);this.HHa&&(this.formulaAssistanceTelemetryManager.LX.selectByMouseHoverCounter++,this.HHa=!1);this.FHa&&(this.formulaAssistanceTelemetryManager.LX.commitByTabKeyCounter++,this.FHa=!1);this.DHa&&(this.formulaAssistanceTelemetryManager.LX.commitByEnterKeyCounter++,this.DHa=!1);this.EHa&&(this.formulaAssistanceTelemetryManager.LX.commitByMouseClickCounter++,this.EHa=!1)}Lcd(){const ja=new uc;ja.completionItems=this.jh.G1b;
ja.activeItemIndex=this.jh.Ej?this.jh.Ej.rowIndex:-1;this.FGd(ja);return ja}FGd(ja){ja.callbacks=new Tb;ja.callbacks.onCompletionItemSelected=this.jyd;ja.callbacks.onCompletionItemCommitted=this.iyd;ja.callbacks.onFeedback=this.xQa;ja.callbacks.onDismiss=this.onDismiss;ja.callbacks.onRestoreFocus=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0}jDd(ja){this.Sea=!0;const hb=ja.textEdit.newText;this.Ya.Ncb(hb.substring(this.Ya.text.length-ja.textEdit.range.start.character,
hb.length))}sze(){this.Py(!0);this.Sea=this.qe=!1;this.KRa=this.LRa=!0}kkd(ja,hb){this.Ya.text=ja.substring(0,hb.range.start.character)+hb.newText+ja.substring(hb.range.end.character,ja.length);this.gridView.lj&&(this.gridView.Wb.text=this.Ya.text)}static VKd(ja){J.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?ja.getRequester().runExperiment(new Oc,0):ja.requester().runExperiment(new Oc)}static O1g(ja){const hb=ac.s9g(),oa={IsCompatibility:!1};oa.NameDataStrings=
ja.label;oa.Help=ja.detail;hb.DYf(oa);hb.textEdit=ja.textEdit;return hb}static bJa(){const ja=String.format(w.sDh,w.yad,va.a.bMe),hb=String.format(w.nDh,w.wad,pb.a.G7c,m.a.Wo,m.a.Lp),oa=String.format(w.kDh,w.sad,pb.a.G7c,m.a.Wo,pb.a.TMe,m.a.Lp);return`${ja}
${hb}
${oa}`}static yni(ja){return 36===ja||58===ja||33===ja||39===ja||32===ja}static W6h(ja,hb){return 32===ja||91===ja||!hb.Yga}}sb.fad="FACardOpened";sb.E$c="FAFocusOnSmartSuggestionsCard";sb.vid=null;Object(d.a)(sb,"FormulaAssistanceControl",Jb.a,[407,404,3,408,409]);class $b extends wb.a{constructor(ja,hb,oa){super($b.bJa());this.$=ja;this.formulaAssistanceUIControl=hb;this.formulaAssistanceTelemetryManager=oa;this.P1=0;this.nka=this.Pq=this.kr=null;this.wQ=this.Tv=!1;this.Uc=()=>{this.visible=!1};
this.onCardModeChange=fb=>{this.iNb(fb);1===fb?this.formulaAssistanceTelemetryManager.l9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.l9.argumentAssistanceExpandCounter++};this.xQa=fb=>{const Eb={};Eb[z.a.sU]="ArgumentAssistanceCard";const jc={};jc.FunctionName=fb.functionName;Eb[z.a.i9c]=jc;this.$.xd(802602464,0,8,Eb)};this.mt=()=>{void 0!==this.Pq&&null!==this.Pq&&this.Pq()};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.l9.argumentAssistanceDismissCounter++;
this.dismiss();this.raiseEvent("DC");this.wQ&&this.aH.clear();0===this.P1&&this.iNb(1)};this.Jf=()=>{this.wQ&&this.aH.clear()};this.V3=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.vNd();this.kr=new Wc(this.$,this.formulaAssistanceUIControl,0,Ka.a.W$c);A.g(this.$).view.Ns(this.mt);A.g(this.$).ha.LG(this.Uc);if(this.wQ=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1))this.aH=new Md(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),A.g(this.$).dc.jm(this.Jf);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Yle(ja){this.addHandler("FAFunctionNameUpdated",ja)}kPf(ja){this.removeHandler("FAFunctionNameUpdated",ja)}Ome(ja){this.addHandler("FAParameterSelectionChangedOld",ja)}KPf(ja){this.removeHandler("FAParameterSelectionChangedOld",ja)}Nme(ja){this.addHandler("FAParameterSelectionChanged",
ja)}JPf(ja){this.removeHandler("FAParameterSelectionChanged",ja)}RDg(ja){this.addHandler("DC",ja)}faj(ja){this.removeHandler("DC",ja)}get visible(){return this.Tv}set visible(ja){ja||this.dismiss();this.Tv=ja}dismiss(){this.Tv=!1;this.formulaAssistanceUIControl&&(this.Pq=null,this.wQ&&this.aH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.nka=null,this.kr.jf=!1)}show(ja,hb){this.Tv=!0;const oa=this.SCd(ja);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceRender"]),
ja={},ja.zoomLevel=E(this.$),this.formulaAssistanceUIControl.updateContext(ja),J.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Pq=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,hb,oa)},this.Pq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,hb,oa),this.XBd(oa),this.wQ&&this.aH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Pq,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement)),this.kr.jf=!0,this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.bIa("argumentAssistanceOverall"))}dispose(){if(this.$){const ja=A.g(this.$);ja&&(ja.ha&&ja.ha.RF(this.Uc),ja.view.Oq(this.mt),this.wQ&&ja.dc.Al(this.Jf))}U.a.Ia(this.kr);this.$=null}SCd(ja){const hb=new Nb;hb.functionRenderingInfo=ja;hb.cardMode=this.P1;this.KGd(hb);return hb}KGd(ja){ja.callbacks=new Gc;ja.callbacks.onHelpLink=
this.Ycd(ja.functionRenderingInfo);ja.callbacks.onCardModeChange=this.onCardModeChange;ja.callbacks.onFeedback=this.xQa;this.V3&&(ja.callbacks.onDismissClick=this.onDismissClick)}Ycd(ja){return()=>{W(this.$,ja.helpID,ja.isUDF)}}vNd(){const ja=jb.a.get(z.a.gZb);this.P1=ja?parseInt(ja,10):$b.j4c;this.formulaAssistanceTelemetryManager.hXf(this.P1)}XBd(ja){var hb=ja.functionRenderingInfo.functionName;this.nka&&$a.a.equals(this.nka,hb,!0)?(hb=Yb.a.map(ja.functionRenderingInfo.signatures,oa=>{let fb="";
0<=oa.signatureParams.activeParam&&oa.signatureParams.activeParam<oa.signatureParams.params.length&&(fb=oa.signatureParams.params[oa.signatureParams.activeParam]);return fb}),this.raiseEvent("FAParameterSelectionChanged",new Jc(hb))):(this.nka=hb,ja=Yb.a.map(ja.functionRenderingInfo.signatures,oa=>oa.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new dc(hb,ja)))}iNb(ja){this.P1=ja;try{jb.a.Rw(z.a.gZb,ja.toString(),Gb.AFrame.Lda)}catch(hb){l.ULS.sendTraceTag(537162074,0,
15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${hb.message}`)}}static bJa(){return document.createElement("div")}}$b.j4c=0;Object(d.a)($b,"FormulaArgumentAssistanceControl",wb.a,[549]);var xc;(function(ja){ja[ja.Dismissed=0]="Dismissed";ja[ja.Smart=1]="Smart";ja[ja.Simple=2]="Simple";ja[ja.Mixed=3]="Mixed"})(xc||(xc={}));Object(d.b)("UIState",xc);class ad extends wb.a{constructor(ja,hb,oa){super(ad.bJa());this.$=ja;this.formulaAssistanceUIControl=hb;this.formulaAssistanceTelemetryManager=
oa;this.kr=this.Ya=this.gridView=null;this.EHa=this.DHa=this.FHa=this.HHa=this.GHa=!1;this.Hr=null;this.eW=0;this.Pq=null;this.KRa=this.LRa=this.fAa=this.Sea=this.Tv=!1;this.YMb=xc.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.Tv=!1;this.msd();this.qF&&this.Ya.$a&&this.cma();this.Pq=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.kr.jf=!1,this.YMb=xc.Dismissed)};this.dgd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};
this.Rba=(fb,Eb)=>{0==Eb.Kq&&(170==Eb.wf.operation.operationName&&this.formulaAssistanceTelemetryManager.Nhc++,this.$.userOperationManager.Co(this.Rba))};this.UNa=(fb,Eb)=>{0==Eb.Kq&&(12==Eb.wf.operation.operationName&&this.$.userOperationManager.Fr(this.Rba),this.$.userOperationManager.Co(this.UNa))};this.fIi=()=>{this.dismiss();this.gridView.Qi.textBox.focus()};this.xQa=()=>{const fb={};this.DDf?fb[z.a.sU]="SmartSuggestionsCard":fb[z.a.sU]="FunctionAndSmartSuggestionsCard";this.$.xd(802602464,0,
8,fb)};this.Jf=()=>{this.nyb&&this.SHg()};this.jyd=(fb,Eb)=>{this.Deb(Eb);this.HHa=!0};this.Uc=()=>{this.visible=!1};this.iyd=fb=>{this.EHa=!0;this.Apb(fb)};this.Eh=()=>{this.dismiss()};this.mt=()=>{void 0!==this.Pq&&null!==this.Pq&&this.Pq()};this.gridView=A.g(this.$);this.kr=new Wc(this.$,this.formulaAssistanceUIControl,1,Ka.a.Z$c,this.dgd);this.gridView.view.Ns(this.mt);this.gridView.ha.LG(this.Uc);this.$.xa.Pf(this.Eh);this.nyb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
this.L8=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.nyb&&this.gridView.dc.jm(this.Jf);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.oii=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}Wle(ja){this.addHandler("FACardOpened",ja)}jPf(ja){this.removeHandler("FACardOpened",ja)}Ule(ja){this.addHandler("FAFocusOnSmartSuggestionsCard",
ja)}hPf(ja){this.removeHandler("FAFocusOnSmartSuggestionsCard",ja)}Vle(ja){this.addHandler("FormulaAutoCompleteShown",ja)}iPf(ja){this.removeHandler("FormulaAutoCompleteShown",ja)}NTc(ja){this.addHandler("SelectedRowChanged",ja)}lId(ja){this.removeHandler("SelectedRowChanged",ja)}QXb(ja){this.addHandler("ListBoxUpdated",ja)}Wqc(ja){this.removeHandler("ListBoxUpdated",ja)}dispose(){this.$&&(this.L8&&(this.$.userOperationManager.Co(this.Rba),this.$.userOperationManager.Co(this.UNa)),this.gridView&&
(this.gridView.ha&&this.gridView.ha.RF(this.Uc),this.gridView.dc&&this.nyb&&this.gridView.dc.Al(this.Jf),this.gridView.view.Oq(this.mt)),this.$.xa&&this.$.xa.Ag(this.Eh));U.a.Ia(this.kr);this.$=null}FDg(ja){this.addHandler("CVIC",ja)}T$i(ja){this.removeHandler("CVIC",ja)}get visible(){return this.Tv}set visible(ja){ja||this.dismiss();this.Tv=ja}get qF(){return this.Sea}get DDf(){return 1===this.Hr.items.length&&1===this.Hr.items[0].type}Sh(ja,hb){if(!this.visible)return!1;this.Kzc(hb);let oa;return(oa=
this.v2h(hb)).Abc?oa.result:this.dwj(hb)}Fvb(ja){if(!this.visible)return!1;let hb=!1;switch(ja){case 1872288872:this.qF&&this.cma();this.visible=!1;hb=!0;break;case -798660877:this.Deb(this.kvb(this.eW+1));hb=!0;break;case 137938150:this.Deb(this.kvb(this.eW-1));hb=!0;break;case 2091832999:this.Deb(this.kvb(this.eW+8));hb=!0;break;case 742457698:this.Deb(this.kvb(this.eW-8));hb=!0;break;case 125627505:case 267796030:this.Apb(this.Hr.items[this.eW]),hb=!0}return hb}show(ja){this.Ya=this.gridView.Qi;
this.Tv=!0;this.eW=0;this.Hr=ja;0<this.Hr.items.length&&(this.render(),this.Deb(this.kvb(this.eW)),1===this.Hr.items[0].type&&this.nyb&&(this.fAa=!0));this.formulaAssistanceTelemetryManager.D8e(ja.items)}cma(){this.Sea=!1;this.Ya.QGe()}dwj(ja){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(ja)}v2h(ja){return this.qF?125627505===ja||267796030===ja?(this.Apb(this.Hr.items[this.eW]),{Abc:!0,result:!1}):!this.DDf||-798660877!==ja&&137938150!==ja?{Abc:!1}:{Abc:!0,
result:!1}:{Abc:!1}}render(){this.formulaAssistanceTelemetryManager.gO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const ja={};ja.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(ja);this.Pq=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Ya.textBox.domElement,this.Lcd())};this.Pq();this.y2i();this.kr.jf=!0;this.Ljh()}}Ljh(){this.formulaAssistanceTelemetryManager.RP(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.bIa("autoCompleteOverall");
const ja=this.Hr.items.some(oa=>1===oa.type),hb=this.Hr.items.some(oa=>0===oa.type);ja&&hb?this.formulaAssistanceTelemetryManager.bIa("autoCompleteOverallSimpleAndSmart"):ja?this.formulaAssistanceTelemetryManager.bIa("autoCompleteOverallSmartOnly"):hb&&this.formulaAssistanceTelemetryManager.bIa("autoCompleteOverallSimpleOnly")}y2i(){const ja=this.YMb;this.YMb=this.UYh(this.Hr.items);ja!==xc.Dismissed&&ja!==xc.Smart||this.YMb!==xc.Simple&&this.YMb!==xc.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}c3i(){var ja;
if(this.oii&&0!==this.Hr.items.length){var hb=0<=this.eW?this.eW:0,oa=this.Hr.items[hb];oa={ZF:oa.label,description:null!==(ja=oa.detail)&&void 0!==ja?ja:"",selectedIndex:hb+1,length:this.Hr.items.length};this.raiseEvent("SelectedRowChanged",oa)}}Apb(ja){if(this.Ya&&this.visible){var hb=ja.textEdit;this.kkd(this.Ya.text,hb);this.Ya.textBox.caretPosition=hb.range.start.character+hb.newText.length;this.qF&&(this.Sea=!1,this.nyb&&(this.KRa=this.LRa=!0),this.L8&&this.yqj(),this.gridView.t$.ZWf(),this.Ya.endEdit(!0,
"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:ja.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.C8e(ja.kind)}}yqj(){this.formulaAssistanceTelemetryManager.NH={Bk:this.gridView.ha.sa.activeCell,Nob:this.gridView.Wb.text,Cpb:!0};this.formulaAssistanceTelemetryManager.Mhc=this.$.xa.oa.sheetId;this.formulaAssistanceTelemetryManager.AAb=this.$.ea.Le;this.$.userOperationManager.Fr(this.UNa)}SHg(){this.fAa&&
(this.formulaAssistanceTelemetryManager.BM.smartSuggestionShownCounter++,this.fAa=!1);this.LRa&&(this.formulaAssistanceTelemetryManager.BM.smartSuggestionSelectedCounter++,this.LRa=!1);this.KRa&&(this.formulaAssistanceTelemetryManager.BM.smartSuggestionCommittedCounter++,this.KRa=!1)}Lcd(){const ja=new uc;ja.completionItems=this.Hr.items;ja.activeItemIndex=this.eW;this.FGd(ja);return ja}FGd(ja){ja.callbacks=new Tb;ja.callbacks.onCompletionItemSelected=this.jyd;ja.callbacks.onCompletionItemCommitted=
this.iyd;ja.callbacks.onFeedback=this.xQa;ja.callbacks.onDismiss=this.fIi;ja.callbacks.onRestoreFocus=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0}jDd(ja){this.Sea=!0;const hb=ja.textEdit.newText;this.Ya.Ncb(hb.substring(this.Ya.text.length-ja.textEdit.range.start.character,hb.length))}Deb(ja){const hb=this.eW;this.eW=ja;const oa=this.Hr.items[ja];this.qF&&this.cma();hb!==ja&&this.render();1===oa.type&&J.EwaSettings.xb()&&!this.gridView.Qi.text.includes("\n")&&
this.jDd(oa);this.c3i()}kvb(ja){return 0>ja?0:Math.min(ja,this.Hr.items.length-1)}kkd(ja,hb){this.Ya.text=ja.substring(0,hb.range.start.character)+hb.newText+ja.substring(hb.range.end.character,ja.length);this.gridView.lj&&(this.gridView.Wb.text=this.Ya.text)}msd(){this.GHa&&(this.formulaAssistanceTelemetryManager.LX.selectByArrowKeyCounter++,this.GHa=!1);this.HHa&&(this.formulaAssistanceTelemetryManager.LX.selectByMouseHoverCounter++,this.HHa=!1);this.FHa&&(this.formulaAssistanceTelemetryManager.LX.commitByTabKeyCounter++,
this.FHa=!1);this.DHa&&(this.formulaAssistanceTelemetryManager.LX.commitByEnterKeyCounter++,this.DHa=!1);this.EHa&&(this.formulaAssistanceTelemetryManager.LX.commitByMouseClickCounter++,this.EHa=!1)}Kzc(ja){switch(ja){case -798660877:case 137938150:case 2091832999:case 742457698:this.GHa=!0;break;case 125627505:this.FHa=!0;break;case 267796030:this.DHa=!0}}static bJa(){return document.createElement("div")}UYh(ja){return ja.reduce((hb,oa)=>hb|=0===oa.type?xc.Simple:xc.Smart,xc.Dismissed)}}Object(d.a)(ad,
"FormulaAutoCompleteControl",wb.a,[548,3,408]);var Dd=a(749);class ie{constructor(ja,hb){var oa,fb;this.Qg=ja;this.$=hb;this.Sxa=()=>{this.I7b.resolve(this.Qg.Pk);this.eag()};this.zwf=()=>{this.I7b.reject(null);this.eag()};this.Jf=()=>{this.Qg.abb();this.Nqd=null};null===(fb=null===(oa=A.g(this.$))||void 0===oa?void 0:oa.dc)||void 0===fb?void 0:fb.jm(this.Jf);this.wBj=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(ja,
hb,oa,fb){const Eb={D9:ja,IHe:hb};var jc;if(jc=Object(Dd.b)(this.Nqd))jc=this.Nqd,jc=!(Eb.D9.FirstRow===jc.D9.FirstRow&&Eb.D9.FirstColumn===jc.D9.FirstColumn&&Eb.D9.LastRow===jc.D9.LastRow&&Eb.D9.LastColumn===jc.D9.LastColumn&&Eb.D9.SheetName===jc.D9.SheetName&&Eb.IHe===jc.IHe);jc&&this.Qg.abb();this.Nqd=Eb;this.wBj&&this.Qg.A5a||this.Qg.JY(ja,oa,fb,hb);this.I7b=new Dd.a;this.Qg.A5a?this.I7b.resolve(this.Qg.Pk):this.i7i();return this.I7b.promise}dispose(){var ja,hb;null===(hb=null===(ja=A.g(this.$))||
void 0===ja?void 0:ja.dc)||void 0===hb?void 0:hb.Al(this.Jf)}i7i(){this.Qg.IXb(this.Sxa);this.Qg.oEg(this.zwf)}eag(){this.Qg.Oqc(this.Sxa);this.Qg.yaj(this.zwf)}}Object(d.a)(ie,"ServerDataProvider",null,[546]);var $d=a(317),ne=a(574),ye=a(338),te=a(870);class Ze{constructor(ja){this.fK=this.gK=this.oF=this.pF=!1;this.uZ=ja}}Object(d.a)(Ze,"MarqueeRangeData",null,[]);class re{constructor(ja,hb,oa,fb=!1){this.gUd=ja;this.jMb=hb;this.e6a=fb;oa?(this.uZ=oa.uZ,this.pF=oa.pF,this.oF=oa.oF,this.gK=oa.gK,
this.fK=oa.fK):l.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(re,"MarqueeMetadata",null,[]);const tc="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");class $c{constructor(ja,hb){this.$=ja;this.pluginScheduler=hb;this.cK=this.odb=!1;this.Mxa=()=>{this.cK=!1};this.gridView=A.g(ja);this.gridView.Wb.jm(this.Mxa)}get coloredReferencesManager(){this.jUa||
(this.jUa=this.$.da.za(281));return this.jUa}uNj(ja,hb,oa){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.eeb(ja,hb,oa)}eeb(ja,hb,oa){if(this.odb||ja.qF)return!1;const fb=isNullOrUndefined(hb)?ja.text:hb;var Eb=[];const jc=new ec.a(!1);if(1<fb.length){var Hc=this.YNh(hb,oa,ja);if(!Hc)return l.ULS.sendTraceTag(0,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),!1;const zd=[],Hd=[];oa=[];var qd=
0;const Yd=this.Ria();for(const se of Hc){this.iE(zd,fb,qd,se.span.start,null);switch(se.kind){case 0:case 1:case 2:Hc=Ib.B(se.rangeInfo.sharedRange);if(isNullOrUndefined(Hc)){l.ULS.sendTraceTag(521211937,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${se.kind.toString()}`);this.iE(zd,fb,se.span.start,se.span.end,null);break}qd=this.IY(Hc,jc,1);this.iE(zd,fb,se.span.start,se.span.end,qd);Eb.push(new ye.a(Hc,Yd));Hd.push({Start:se.span.start,
End:se.span.end});Hc=zd.length-1;oa.push(new re(Hc,zd[Hc].text,c(se)));break;case 3:this.iE(zd,fb,se.span.start,se.span.end,null,"rgba(229, 229, 229, 1)")}qd=se.span.end}this.iE(zd,fb,qd,fb.length);this.Suc(ja,zd,!!hb);hb=ja.textBox.text;if(!$a.a.equals(hb,fb,!1))return l.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${hb.length}], originalTextLength [${fb.length}]`),
hb=ja.textBox.caretPosition,ja.textBox.text=fb,ja.textBox.caretPosition=hb,!0;this.oz(Eb,jc,oa);return this.cK=!0}this.oz(null,null);return this.cK&&(this.cK=!1,Eb=ja.textBox.caretPosition,ja.textBox.setPlainText(fb),ja.textBox.caretPosition=Math.min(Eb,fb.length),hb)?!0:!1}YNh(ja,hb,oa){var fb;let Eb=ja,jc=hb;Object(Dd.b)(ja)?Object(Dd.b)(hb)||(jc=te.a):(Eb=oa.text,jc=oa.textBox.selection);return null===(fb=this.i3a(Eb,jc))||void 0===fb?void 0:fb.formulaHighlights}cCb(ja,hb,oa){if(!ja||!hb||!oa)return l.ULS.shipAssertTag(524039685,
0,!!ja,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),l.ULS.shipAssertTag(524039684,0,!!hb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),l.ULS.shipAssertTag(524039683,0,!!oa,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const fb=Object(Qa.a)(re,hb.metadata);if(!fb)return l.ULS.shipAssertTag(524039682,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Eb=fb.gUd,jc=fb.jMb,Hc=this.gridView.Db.Wld(oa)?oa.jub(fb.oF,
fb.pF):oa.FJa(fb.oF,fb.pF,fb.fK,fb.gK);if(!Hc)return l.ULS.shipAssertTag(524039681,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const qd=jc.indexOf("!");-1!==qd&&(Hc=jc.substring(0,qd+1)+Hc);if(!ja.textBox.changeTextInExistingTextPart(Eb,jc,Hc))return l.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;fb.jMb=Hc;Eb=!0;for(jc=1;4>=jc;jc++)(Hc=A.g(this.$).ob.ev(3,jc,hb.yT))?(Hc.range=oa,Hc.metadata=fb):(l.ULS.shipAssertTag(524039680,
0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Eb=!1);this.gridView.ob.update(!1,!1);this.gridView.lj&&(this.gridView.dc.textBox.text=ja.text);this.gridView.dc.UOa(new $d.a({Xxb:!0}));return Eb}wii(ja){if(3!==ja.vq)return l.ULS.shipAssertTag(524039651,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;ja=Object(Qa.a)(re,ja.metadata);return ja?ja.uZ&&!ja.e6a:(l.ULS.shipAssertTag(524039650,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),
!1)}oAa(ja,hb){l.ULS.sendTraceTag(524039649,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(hb?"suspending":"resuming")+" colored references");hb&&this.cK&&(this.cK=!1,this.oz(null,null),ja.textBox.uxe());this.odb=hb}dispose(){this.gridView&&this.gridView.Wb&&this.gridView.Wb.Al(this.Mxa)}vKa(ja){var hb=this.i3a(ja,te.a);if(isNullOrUndefined(hb))this.Haa&&this.oz(null,null);else{var oa=this.Ria(),fb=[],Eb=new ec.a(!1),jc=[];hb=hb.formulaHighlights;for(const Hc of hb)if(hb=Hc.kind,
0===hb||2===hb||1===hb)hb=Ib.B(Hc.rangeInfo.sharedRange),Object(Dd.b)(hb)&&(fb.push(new ye.a(hb,oa)),this.IY(hb,Eb,1),jc.push(new re(Hc.span.start,ja.substring(Hc.span.start,Hc.span.end),c(Hc),!0)));this.oz(fb,Eb,jc)}}i3a(ja,hb){ja=this.pluginScheduler.syncRequester().formulaHighlighting({content:ja,caretPosition:null===hb||void 0===hb?void 0:hb.index,selectionLength:null===hb||void 0===hb?void 0:hb.length});if(isNullOrUndefined(ja)||isNullOrUndefined(ja.formulaHighlights))l.ULS.sendTraceTag(521211933,
0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(ja)}`);else return ja}IY(ja,hb,oa){let fb=hb.getItem(ja.toString());fb||(fb=tc[hb.count%tc.length],hb.add(ja.toString(),fb));return String.format(fb,oa)}iE(ja,hb,oa,fb,Eb=null,jc=null){l.ULS.shipAssertTag(524039648,0,oa<=fb,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");oa<fb&&(hb=hb.substring(oa,fb),ja.push(Object(Ub.a)(new ne.a,
{text:hb,color:Eb,backgroundColor:jc})))}oz(ja,hb,oa=null){ja&&ja.length?(l.ULS.sendTraceTag(524039647,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+ja.length),ja.reverse(),oa.reverse(),this.gridView.ob.yv(ja,[3],!0,(fb,Eb)=>{if(fb&&fb.range&&Eb){l.ULS.shipAssertTag(524039643,0,hb.lb(fb.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${fb.range.toString()}' doesn't exist in the range to color dictionary`);var jc=this.IY(fb.range,hb,.1),Hc=
this.IY(fb.range,hb,1);this.$.frame&&this.$.frame.ZC&&this.$.frame.ZC.Raa||(Eb.style.background=jc);Eb.style.borderColor=Hc;oa&&(Eb.setAttribute(z.a.P4a,fb.yT.toString()),fb.metadata=oa[fb.yT])}else l.ULS.shipAssertTag(524039646,0,!!fb,"FormulaHighlightsControl.HighlightRanges: state is null"),l.ULS.shipAssertTag(524039645,0,!!fb.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),l.ULS.shipAssertTag(524039644,0,!!Eb,"FormulaHighlightsControl.HighlightRanges: div is null")})):(ja=
this.$.Hb.xc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.ob.Tg([3]),this.gridView.ob.PQa(new ye.a(null,this.Ria()),[3]),ja.stop())}Suc(ja,hb,oa){const fb=ja.textBox;fb.jF=!0;var Eb=fb.selection;const jc=Eb.index;Eb=jc+Eb.length;fb.setTextFromTextParts(hb);hb=fb.text.length;fb.selectRange(Math.min(jc,hb),Math.min(Eb,hb));oa&&ja.UOa(new $d.a);fb.jF=!1}Y$b(){return this.gridView.Lq&&this.gridView.Lq.LF?this.gridView.Lq.LF:this.$.oa}Ria(){return this.Y$b().sheetId}}Object(d.a)($c,"FormulaHighlightsControl",
null,[545,3]);class Ed{constructor(ja,hb,oa,fb,Eb,jc,Hc){this.$=ja;this.functionInfoManager=hb;this.calcManager=oa;this.pluginScheduler=fb;this.formulaAssistanceUIControl=Eb;this.formulaAssistanceTelemetryManager=jc;this.Qg=Hc;this.jRa=!0;this.eLa=this.isCellContentOnlyEqualDuringEdit=!1;this.Swa=null;this.vMa=-1;this.uV=0;this.Naa=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Hyb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);this.Dh=(qd,zd)=>{this.gridView.$a||this.gridView.vi||this.yNa(null===zd||void 0===zd?void 0:zd.cell)};this.Lh=(qd,zd)=>{this.yNa(null===zd||void 0===zd?void 0:zd.oia)};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Bab(this.onFunctionInfoLoaded);this.CSj();this.Lca()};this.Vsf=()=>{this.jRa=!1};this.ctf=(qd,zd)=>{var Hd=this.Ya;qd=Hd.text;Hd=Hd.textBox.caretPosition;0<this.uV&&this.formulaAssistanceTelemetryManager.LX.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.gO(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);zd.shouldRequestAutocompleteOnCommit?this.jWf(qd,Hd):this.oJd(qd,Hd)};this.Jf=()=>{this.B1&&(this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.BM.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1),this.eLa&&(this.formulaAssistanceTelemetryManager.BM.isCellContentFormulaCounter++,this.eLa=!1));this.jRa=!0;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.X4b()};this.o5=(qd,
zd)=>{this.TKd(zd.newValue)};this.Hi=()=>{this.Mbg()};this.Mbg=()=>{this.pluginScheduler.notifier().setDefinedNamesInfo(this.s4b.wFe)};this.i3a=(qd,zd)=>{qd=this.pluginScheduler.syncRequester().formulaHighlighting({content:qd,caretPosition:null===zd||void 0===zd?void 0:zd.index,selectionLength:null===zd||void 0===zd?void 0:zd.length});if(isNullOrUndefined(qd)||isNullOrUndefined(qd.formulaHighlights))l.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(qd)}`);
else return qd};this.functionInfoManager=hb;this.formulaAssistanceUIControl=Eb;this.pluginScheduler=fb;this.gridView=A.g(this.$);this.Xdf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.V3=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.Mwd=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.B1=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");
this.AWc=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Hgi=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.Xdf&&(this.s4b=new lb(ja),this.gridView.Ea.ox(this.Hi),this.Mbg());this.npa=new $b(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.S7=new ad(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.chi=H.a.c4(ja);this.ywa=H.a.ywa(ja);this.pZ=H.a.pZ(ja);
this.chi&&(this.opa=new $c(this.$,this.pluginScheduler));ja.da.Ga(464,this);this.calcManager=oa;H.a.TU()&&this.Xjd();this.B1&&this.gridView.dc.jm(this.Jf);this.V3&&(this.B1||this.gridView.dc.jm(this.Jf),this.npa.RDg(this.Vsf));this.xld=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}get ria(){return this.S7}get pTe(){return this.npa}get hz(){return this.opa}get Ya(){return this.gridView.Qi}get Db(){return this.gridView.Db}dispose(){if(this.$){const ja=this.gridView;
ja&&(ja.ha&&H.a.TU()&&(this.Hyb?ja.dc.Gk(this.Lh):ja.ha.dma(this.Dh)),this.Xdf&&ja.Ea&&ja.Ea.uv(this.Hi))}this.B1&&this.gridView.dc.Al(this.Jf);this.V3&&(this.B1||this.gridView.dc.Al(this.Jf),this.npa.faj(this.Vsf));this.S7.T$i(this.ctf);this.functionInfoManager&&this.functionInfoManager.Bab(this.onFunctionInfoLoaded);H.a.Ldc&&this.Ya&&this.Ya.qHb(this.o5);U.a.Ia(this.npa);U.a.Ia(this.S7);this.S7=this.npa=this.functionInfoManager=this.$=null}Sej(){this.vMa=-1;this.Swa=null}X4b(){this.S7.visible=!1;
this.npa.visible=!1}Sh(){this.Lca();return!1}Lca(){if(!this.Ya.NK)if(this.formulaAssistanceTelemetryManager.Gnb.formulaAssistanceRequestAttemptedCounter++,this.Owj()){this.functionInfoManager.qZ||(this.functionInfoManager.NXa(this.onFunctionInfoLoaded),this.functionInfoManager.m1a({}));var ja=this.Ya,hb=ja.text;ja=ja.textBox.caretPosition;this.B1&&hb.startsWith("=")&&(this.eLa=!0,1===hb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.V3||this.jRa?(this.formulaAssistanceTelemetryManager.gO("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),
this.jWf(hb,ja)):(this.formulaAssistanceTelemetryManager.gO(["autoCompleteComputation","autoCompleteOverall"]),this.Bej(hb,ja));J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",!1)&&this.Aej(hb,ja)}else this.formulaAssistanceTelemetryManager.Gnb.formulaAssistanceRequestOptimizedCounter++}jWf(ja,hb){hb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:ja,caretPosition:hb},argumentAssistance:{content:ja,
caretPosition:hb}});this.uV+=1;hb.then(oa=>{--this.uV;0===oa.kind&&(this.D3e(oa.payload.argumentAssistance),this.h4e(oa.payload.functionSuggestion,ja));return null})}Bej(ja,hb){hb={content:ja,caretPosition:hb};hb=this.Naa?this.pluginScheduler.getRequester().functionSuggestion(hb,0):this.pluginScheduler.requester().functionSuggestion(hb);this.uV+=1;hb.then(oa=>{--this.uV;0===oa.kind&&this.h4e(oa.payload,ja);return null})}Aej(ja,hb){hb={content:ja,caretPosition:hb,enableAutocompleteWrapperPlugin:this.ywa&&
!this.pZ&&"="===ja};this.Naa&&(hb=this.pluginScheduler.getRequester().runPerCharacterExperiment(hb,0),this.uV+=1,hb.then(oa=>{--this.uV;if(0===oa.kind)for(const fb of oa.payload.results)0===fb.kind&&this.gridView.t$.BNd(fb.value,ja);return null}))}oJd(ja,hb){ja={content:ja,caretPosition:hb};ja=this.Naa?this.pluginScheduler.getRequester().argumentAssistance(ja,0):this.pluginScheduler.requester().argumentAssistance(ja);this.uV+=1;ja.then(oa=>{--this.uV;0===oa.kind&&this.D3e(oa.payload)})}Owj(){var ja=
this.Ya;const hb=ja.text;ja=ja.textBox.caretPosition;if(this.S7.visible&&$a.a.equals(hb,this.Swa,!0)&&(!this.Hgi||!ib.e(hb))&&ja===this.vMa)return!1;this.Swa=hb;this.vMa=ja;return!0}VKd(){this.Naa?this.pluginScheduler.getRequester().runExperiment(new Oc,0):this.pluginScheduler.requester().runExperiment(new Oc)}D3e(ja){ja&&this.Ya.$a?(this.formulaAssistanceTelemetryManager.RP(["argumentAssistanceComputation"]),this.npa.show(ja,this.Ya.textBox.domElement)):this.npa.dismiss()}h4e(ja,hb){ja&&0<ja.items.length&&
this.Ya.$a&&(!J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487912_SmartSuggestionFix")||this.Ya.text===this.Swa)?this.AWc&&this.Db.o4(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.BM.smartSuggestionWouldSuggestInsidePivotCounter++,this.S7.dismiss()):(this.formulaAssistanceTelemetryManager.RP(["autoCompleteComputation"]),this.S7.show(ja)):this.S7.dismiss();this.ywa&&this.gridView.t$.BNd(ja,hb)}TKd(ja){ja={content:ja,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};
this.Naa?this.pluginScheduler.getRequester().runAuthoringExperiment(ja,0):this.pluginScheduler.requester().runAuthoringExperiment(ja)}yNa(ja){var hb;const oa=this.gridView.ha.sa.activeCell;if(oa){var fb=this.calcManager.ssa(oa,!this.xld);if(fb){var Eb=this.$.xa,jc=fb.sheet.index;0>=Eb.count||0>jc||jc>=Eb.count||(jc=Eb=null,this.Mwd&&void 0!==this.calcManager&&null!==this.calcManager&&(ja=null!==(hb=null===ja||void 0===ja?void 0:ja.cell)&&void 0!==hb?hb:this.gridView.Ea.Qr(oa))&&(hb=this.calcManager.T$b(ja.Ek),
void 0!==hb&&null!==hb&&(Eb=hb.FormatString,jc=hb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:fb.range.col,rowIndex:fb.range.row,sheetIndex:this.$.xa.getItem(fb.sheet.index).sheetId,docName:fb.sheet.document.name,docPath:fb.sheet.document.path,formatString:Eb,builtIn:jc}))}else l.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}}CSj(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.W8b)}Xjd(){this.Hyb?
this.gridView.dc.Mk(this.Lh):this.gridView.ha.aga(this.Dh);const ja=H.a.vxb()?this.gridView.Xb(null):void 0;this.yNa(ja);H.a.Ldc&&this.Ya.KXa(this.o5);this.VKd();this.S7.FDg(this.ctf);this.pluginScheduler.setServerDataProvider(new ie(this.Qg,this.$));this.Lca()}eeb(ja,hb,oa){oa=Object(Dd.b)(hb)?this.i3a(hb,Object(Dd.b)(oa)?oa:te.a):this.i3a(ja.text,ja.textBox.selection);return this.opa.uNj(ja,hb,oa)}}Object(d.a)(Ed,"FormulaAssistanceManager",null,[401,3]);a(195);class Id extends Ja.a{constructor(ja){super();
this.$=ja;this.Fb()}create(){const ja=H.a.TU(),hb=J.EwaSettings.ma(373),oa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),fb=H.a.oZ(this.$),Eb=this.$.da,jc=e.GetServiceTaskFactory.create(Eb,134,this.la,this.ib),Hc=e.GetServiceTaskFactory.Ta(this.$.da,12,477,this.ib);let qd;qd=H.a.W3()?e.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):M.Task.Ua(null);let zd;zd=H.a.TU()?e.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):M.Task.Ua(null);if(oa||ja){const Hd=
e.GetServiceTaskFactory.Ta(Eb,266,265,this.ib),Yd=e.GetServiceTaskFactory.Ta(Eb,219,220,this.ib),se=e.GetServiceTaskFactory.Ta(Eb,491,492,this.ib);k.TaskExtensions.Aa(k.TaskExtensions.Xd([Hd,zd,qd,Yd,se],this.la),()=>{const Re=Eb.za(19)||new ic(this.$,zd.result),Ye=Yd.result;if(fb){var rf=Eb.za(464);rf||(rf=new Ed(this.$,Re,Hd.result,zd.result,qd.result,se.result,Hc.result.T1c(this.$,jc.result)),Ye.HVc(rf.pTe),Ye.IVc(rf.ria),J.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&
Ye.JVc(rf.ria))}else rf=Eb.za(221),rf||(rf=new sb(this.$,Re,jc.result,Hd.result,null,Hc.result,qd.result,se.result,zd.result),Ye.HVc(rf.qTe),Ye.JVc(rf.OTe),Ye.IVc(rf)),hb&&(Eb.za(317)||new Bb(this.$));this.qb(Re)},this.la,3)}else{const Hd=e.GetServiceTaskFactory.Ta(Eb,219,220,this.ib),Yd=e.GetServiceTaskFactory.Ta(Eb,491,492,this.ib);k.TaskExtensions.Aa(k.TaskExtensions.Xd([Hd,qd,zd],this.la),()=>{const se=Eb.za(19)||new ic(this.$,zd.result),Re=Hd.result;let Ye=Eb.za(221);Ye||(Ye=new sb(this.$,se,
jc.result,null,null,Hc.result,qd.result,Yd.result,zd.result),Re.HVc(Ye.qTe),Re.JVc(Ye.OTe),Re.IVc(Ye));hb&&(Eb.za(317)||new Bb(this.$));this.qb(se)},this.la,3)}}static ka(ja){ja.da.Ga(153,new Id(ja))}}Object(d.a)(Id,"FunctionInfoManagerFactory",Ja.a,[]);a.d(D,"a",function(){return ae});const ae=()=>{b.a.Fa(ja=>{pa.ka(ja);Pa.ka(ja);Id.ka(ja)})}},1130:function(t,D,a){var c=a(0),b=a(690),d=a(148),f=a(7),e=a(15),k=a(82),l=a(4),m=a(156),v=a(1067),n=a(1065),w=a(713),r=a(5),u=a(456),x=a(556),z=a(77),B=a(58),
y=a(902),A=a(131),K=a(42),G=a(510),T=a(170),W=a(62),P=a(50),E=a(747),H=a(145),F=a(37),N=a(121),J=a(209),R=a(90),M=a(70),L=a(34),U=a(31),X=a(281),da=a(1),fa=a(181),S=a(14),ka=a(61),V=a(280),wa=a(21),ma=a(132),ab=a(767),ba=a(768),Ca=a(125),Na=a(111),za=a(51),la=a(33),aa=a(417);class sa{constructor(){this.Sections=this.Id=null}}Object(c.a)(sa,"AutoFilterMenu",null,[]);class ea{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;
this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(ea,"MenuItem",null,[]);class Z{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(Z,"MenuSection",null,[]);class ua{constructor(){this.isSuccess=!1}}Object(c.a)(ua,"ApplyFilterByValueResponse",null,[]);class ya{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(ya,"FilterByValueItem",null,[]);class ha{constructor(){this.selectedSortIcon=
this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(ha,"GetColorsAndIconsResponse",null,[]);class Da{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(Da,"GetFilterByValueItemsResponse",null,[]);class nb{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(nb,"ShowSortFilterMenuParams",null,[]);class qa{constructor(){this.onMenuItemClick=this.applyFilterByValueRequest=
this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(qa,"SortFilterControllerFactoryParams",null,[]);class pa{constructor(){this.top=this.left=0}}Object(c.a)(pa,"TargetPoint",null,[]);var Ja=a(55),$a=a(195),rb=a(36),Pa=a(154),eb=a(224),Ob=a(8);const tb=r.a.l1g;class cc extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateAutoFilterContextMenu",1675506831,1651433993,tb,!0,!1,"AutoFilterContextMenuRoot",fb,Eb,!1,jc);this.VUc=this.FSa=
this.sheetName=this.Hqb=null;this.U1a=this.ekf=!1;this.a3c=this.W9a=this.lEe=this.xOa=this.X$b=this.z8c=this.rLb=this.DFb=null;this.iV=()=>{this.Kwc();this.$.ea.xn(this.iV)};this.kKi=Hc=>{this.U1a||ma.b(this.$).Cd(A.a.Awf,this.nm(),void 0,!0);var qd={};this.$.Wj(qd);var zd=this.$.ea.isNamedObjectViewMode;const Hd=B.a.Uh(this.VUc);Hd.SheetName=zd?qd.NamedObjectName:qd.SheetName;Hd.NamedObjectView=zd;zd=!!Hc.searchText;qd=586;this.U1a&&(zd&&(Hd.ItemListOptions=this.a4g(Hc.searchText),qd=597),ma.b(this.$).Cd(A.a.Awf,
{["UserOperation"]:qd.toString()},void 0,!0));const Yd=this.Ryd(zd),se=this.lKi(),Re=this.$.pa.va.Qb();Hc=(Ye,rf,tf)=>this.a3c=W.o(this.$.pa.va,Hd,V.b(Ye,Yd),this.U1a?V.a(rf,se):rf,tf,null,Re);this.lEe=Re.RequestId;this.U1a&&this.X$b&&!this.X$b.dequeueUtcTime&&(this.$.userOperationManager.Zsa(this.X$b),this.$Tg());Hc=da.EwaSettings.fc()?new T.a(qd,0,Hc,80):new G.a(qd,0,Hc,16);this.X$b=this.$.userOperationManager.Ub(Hc,null);this.W9a=this.a3c;this.xOa=this.lEe};this.onMenuItemClick=(Hc,qd,zd)=>{ma.b(this.$).Cd(A.a.hPi,
this.nm(),void 0,!0);qd={["CommandValueId"]:qd,["MenuItemId"]:qd,["InputMethod"]:zd,["TopCellAddress"]:this.FSa};const Hd=new R.a(Hc,zd,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(Hd,qd);e.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${Hc}, ${zd}`)};this.jFi=Hc=>{if(Hc.checkedItems&&Hc.checkedItems.length){ma.b(this.$).Cd(A.a.Tsf,this.nm(),void 0,!0);var qd=B.a.Uh(this.VUc),zd={};this.$.Wj(zd);zd.FirstRow=0;zd.FirstColumn=qd.Column;var Hd=this.$.ea.isNamedObjectViewMode;
qd.NamedObjectView=Hd;qd.SheetName=Hd?zd.NamedObjectName:zd.SheetName;var Yd=Ye=>{if(ab.a.Hvc(Ye)){const rf=ab.a.t9b(Ye);this.ILa?ab.a.DPa(ba.a.applyItemFilter,rf.MessageIdName,Na.a.Ara,!0,ab.a.isSessionEndingError(rf.MessageId)):e.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${rf.MessageIdName}`)}X.a(Ye)||(e.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ma.b(this.$).Cd(A.a.uwf,
this.nm(),void 0,!0),Ye=Object(f.a)(new ua,{isSuccess:!0}),this.rLb.onApplyFilterByValueFinish(Ye),this.sL(this.FSa))},se=this.G1c(qd,zd),Re=new T.a(208,0,(Ye,rf,tf)=>W.a(this.$.pa.va,se,Hc.checkedItems,V.b(Ye,Yd),rf,tf,null,null),6,()=>new y.a(Hc.checkedItems,se));this.E2f(()=>{this.$.userOperationManager.Ub(Re,null)})}else e.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.$Jg=Hc=>{const qd=K.o(this.FSa,this.$),zd=
K.v(this.FSa,this.$);var Hd=Object(f.a)(new v.a,{SortConditionType:Hc.type,RowColOffset:qd.FirstColumn-zd.FirstColumn,SortColor:Hc.color,SortIconSet:Hc.icon.IconSet,SortIcon:Hc.icon.Icon,IsAscending:!0});Hd=Object(f.a)(new n.a,{OperationType:1,ActiveCell:qd,SelectedRange:zd,SortConditions:[Hd],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const Yd={};Yd.SortOptions=Hd;Yd.SelectedRange=zd;Yd.OriginalActiveCell=qd;Yd.ShouldRestoreSelection=!1;Yd.ShouldPromptNamedSheetViewTeachingDialog=da.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");
e.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${Hc.type}`);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.$.xd(-1089513346,z.a.Eb,19,{["CustomSortCommandData"]:Yd}):this.E2f(()=>{this.$.xd(1659552324,z.a.Eb,19,{["CustomSortCommandData"]:Yd})})};this.ILa=ab.a.Skd();this.Xx=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Fw(){return"PopulateAutoFilterContextMenu"}get CB(){return r.a.AKf}executeCommand(oa,
fb,Eb){oa=fb.command;switch(oa){case 1701016594:return w.a.Yvh(Eb),Ja.Task.Ua(!0);case 966232027:if(da.EwaSettings.fl()){const jc=new m.a;F.TaskExtensions.Aa(P.GetServiceTaskFactory.Ta(this.$.da,8,9,0),Hc=>{this.Q4e(fb,Eb,Hc.result);jc.setResult(!0)},this.la,3).continueWith(()=>{jc.setResult(!1)},5,this.la,eb.a.instance);return jc.task}this.Q4e(fb,Eb);return Ja.Task.Ua(!0);default:return fa.a(oa)}}Q4e(oa,fb,Eb){const jc=fb.domEvent;if(M.e(jc.rawEvent)&&(M.g(jc),jc.target)){var Hc=new H.a(this.$.xa);
if(Hc.Wd(4096)||Hc.Wd(2048)){var qd=B.a.Uh(fb[z.a.Zf]);this.f1f(qd)&&(this.ekf?this.vrc(jc,jc.target,qd,oa,Eb):(this.DFb=()=>{this.f1f(qd)&&(this.cai(),this.vrc(jc,jc.target,qd,oa,Eb),this.U1a=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.ekf=!0)},this.Kwc()))}}}Ec(oa,fb,Eb){if(oa=!!Eb)switch(fb.command){case 1701016594:case 966232027:da.EwaSettings.fl()||u.a(this.$)||(oa=!1,fb=za.b().mj(fb.command),e.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${fb}`));
break;default:oa=!1}return oa}rCd(oa){oa.MenuSectionList.push(...this.Hqb)}cai(){aa.a(()=>{this.rLb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new qa,{getFilterByValueItemsRequest:this.kKi,applyFilterByValueRequest:this.jFi,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:cc.Fre,applySortByColorOrIconRequest:this.$Jg}))});this.z8c=k.a.instance.uh("Common.IExternalUICommandDefinitionMapping")||new x.a(this.$.Bb,this.$)}vrc(oa,fb,Eb,jc,Hc){ma.b(this.$).Cd(A.a.vrc,
this.nm(),void 0,!0);e.ULS.shipAssertTag(537167135,0,!!Eb,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");oa=this.BHh(Eb,Hc);jc=Sys.UI.DomElement.getBounds(fb);fb=jc.x+jc.width;jc=jc.y;if(this.Xx&&!Eb.IsHeaderSnapped){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.vld(this.$,Eb.Cell))return;Eb=w.a.Nbd(this.$,Eb.Cell,!0);fb=Eb.x;jc=Eb.y}Eb=wa.g(this.$).rtl?new Sys.UI.Point(fb-la.a(this.$).mFa(cc.Fre),jc):new Sys.UI.Point(fb,
jc);Eb=la.a(this.$).Uia(Eb);Eb=Object(f.a)(new nb,{targetPoint:Object(f.a)(new pa,{left:Eb.x,top:Eb.y}),autoFilterMenu:oa});this.rLb.showSortFilterMenu(Eb);this.$.xd(-544117314,-1,0,null)}f1f(oa){return(null===oa||void 0===oa?0:oa.Cell.SheetName)?wa.g(this.$).l4?oa.Cell.SheetName===this.$.oa.name:oa.Cell.SheetName===this.$.oa.sheetName:!0}BHh(oa,fb){return(oa=this.CHh(oa,fb))?this.kIf(oa):null}kIf(oa){const fb=[];for(const Eb of oa.Sections){if(Object(Pa.f)(this.$)&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&
Eb.Title===S.a.instance.ga(1943))continue;const jc=this.$_i(Eb);fb.push(jc)}return Object(f.a)(new sa,{Id:oa.Id,Sections:fb})}$_i(oa){const fb=[];for(const Eb of oa.MenuItems)if(2===Eb.Identifier)this.VUc=Eb.CommandData;else switch(Eb.Type){case 3:case 2:fb.push(this.Y_i(Eb,2===Eb.Type));break;case 1:fb.push(this.Z_i(Eb))}return Object(f.a)(new Z,{MenuItems:fb,DisplayType:oa.DisplayType,Id:this.PEh(oa)})}Z_i(oa){({label:Hc,DKa:jc}=this.uUe(oa));const fb=this.kIf(oa.SubMenu),Eb=this.kUe(oa);var jc=
this.z8c.l$b(jc);var Hc=Hc||oa.Label;return Object(f.a)(new ea,{Disabled:oa.Disabled,Type:oa.Type,Identifier:oa.Identifier,Id:Eb,CommandData:oa.CommandData,Label:Hc,SubMenu:fb,IsChecked:oa.IsChecked,IconName:"MissingIcon_20"===jc?null:jc})}Y_i(oa,fb){let Eb;({label:fb,DKa:Hc,rr:Eb}=this.c9b(oa,fb&&oa.IsChecked));const jc=this.Lad(oa,fb);var Hc=this.z8c.l$b(Hc);return Object(f.a)(new ea,{Disabled:oa.Disabled,Type:oa.Type,Identifier:oa.Identifier,Id:jc,RibbonCommand:Eb,CommandData:oa.CommandData,Label:fb||
oa.Label,SubMenu:null,IsChecked:oa.IsChecked,IconName:"MissingIcon_20"===Hc?null:Hc})}CHh(oa,fb){var Eb;this.FSa=Eb=K.C(oa.Cell);this.sheetName=this.$.oa.sheetName;fb=fb||u.a(this.$);if(oa.IsHeaderSnapped)Eb=fb.R7b.NOh(Eb);else{fb=wa.g(this.$).Ea.CJa(Eb);if(!fb)return this.ILa?ab.a.DPa(ba.a.CKf,Ca.a.l0h,Na.a.VYa,!0,!1):(oa=wa.g(this.$).view.visibleArea,e.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${Eb}, visible range: ${oa}`)),
null;Eb=fb.autoFilterMenu}if(!Eb)return this.ILa?ab.a.DPa(ba.a.CKf,Ca.a.czi,Na.a.VYa,!0,!1):e.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.urb=oa.Cell.FirstRow+"_"+oa.Cell.FirstColumn;return Eb}Kwc(){if(this.$.ea.Eg){const oa=P.GetServiceTaskFactory.Ta(this.$.da,283,284,1);F.TaskExtensions.Aa(oa,()=>{this.ILa?oa.result.$n.loadScript("sortFilter").then(()=>{this.DFb()},fb=>{ka.a.sk(fb,
"AutoFilterContextMenu.SortFilterScriptLoad");ab.a.DPa(ba.a.Kwc,Ca.a.ACj,Na.a.VYa,!1,!1)}):F.TaskExtensions.Aa($a.c(oa.result.$n.loadScript("sortFilter")),()=>{this.DFb()},this.$.la,3)},this.$.la,3)}else this.$.ea.ql(this.iV)}a4g(oa){const fb={};fb.SearchText=oa;fb.Page=1;fb.DateNodeType=-1;return fb}$Tg(){this.xOa&&(e.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.xOa}`),W.h(this.$.pa.va,
this.xOa,null,null,null),this.xOa=null);this.W9a&&(l.AFrameworkApplication.rd.wu(this.W9a.Ot),this.W9a=null)}Ryd(oa){return fb=>{this.W9a=this.xOa=null;if(ab.a.Hvc(fb)){var Eb=ab.a.t9b(fb);this.ILa?ab.a.DPa(oa?ba.a.searchAutoFilterItemList:ba.a.getAutoFilterItemList,Eb.MessageIdName,Na.a.VYa,!0,!0):e.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${Eb.MessageIdName}`)}if(!X.a(fb)){e.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");
fb=fb.Result;Eb=new L.a(!0);const jc=fb.AutoFilterDateNodes?!0:!1;fb.AutoFilterItems&&Eb.add("AutoFilterItemsCount",fb.AutoFilterItems.length);jc&&Eb.add("AutoFilterDateItemsCount",fb.AutoFilterDateNodes.length);Eb.add("Location","contextMenu");ma.b(this.$).Cd(A.a.Ryd,Eb.ju,void 0,!0);Eb=this.U1a?Object(f.a)(new Da,{filterByValueItems:this.HAe(fb),hasMoreRecords:fb.ItemListMaxExceeded,searchText:fb.SearchText}):Object(f.a)(new Da,{filterByValueItems:this.HAe(fb),hasMoreRecords:fb.ItemListMaxExceeded});
this.rLb.onGetFilterByValueItemsFinish(Eb);oa||(e.ULS.shipAssertTag(529063959,0,null!==fb.FontColors&&null!==fb.CellColors&&null!==fb.Icons&&null!==fb.SelectedSortFontColors&&null!==fb.SelectedSortCellColors&&null!==fb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),fb=Object(f.a)(new ha,{fontColors:fb.FontColors,cellColors:fb.CellColors,icons:fb.Icons,selectedSortFontColor:0<fb.SelectedSortFontColors.length?fb.SelectedSortFontColors[0]:
null,selectedSortCellColor:0<fb.SelectedSortCellColors.length?fb.SelectedSortCellColors[0]:null,selectedSortIcon:0<fb.SelectedSortIcons.length?fb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),this.rLb.onGetColorsAndIconsFinish(fb))}}}lKi(){return oa=>{this.W9a=this.xOa=null;oa=N.a.kf(oa.data);oa=U.a.zc(oa);e.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${oa}].`)}}HAe(oa){const fb=this.N1g(oa),Eb=this.U1g(oa.AutoFilterItems),jc=
[],Hc=[];let qd=0,zd=0;oa.HasBlanks&&(oa=cc.U1c(S.a.instance.ga(783),oa.IsBlanksSelected?1:0,r.a.Ere),jc[qd++]=oa);for(const Hd of fb)jc[qd++]=Hd;if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Hd of Eb)-1!==Array.indexOf(Ob.a.g7c,Hd.displayText)?Hc[zd++]=Hd:jc[qd++]=Hd;else for(const Hd of Eb)jc[qd++]=Hd;return Array.prototype.concat(Hc,jc)}N1g(oa){const fb=[];if(!oa.AutoFilterDateNodes||!oa.AutoFilterDateNodes.length)return fb;const Eb=[this.n3a(oa.YearKeys,
oa.YearValues),this.n3a(oa.MonthKeys,oa.MonthValues),this.n3a(oa.DayKeys,oa.DayValues),this.n3a(oa.HourKeys,oa.HourValues),this.n3a(oa.MinuteKeys,oa.MinuteValues),this.n3a(oa.SecondKeys,oa.SecondValues)];let jc=!1,Hc=!1,qd=0;var zd=null;const Hd=Array(6);var Yd=null;for(const se of oa.AutoFilterDateNodes){Hd[0]&&(Yd.Year!==se.Year?(jc=!0,qd=0,zd=null):Yd.Month!==se.Month?(Hc=!0,qd=1,zd=Hd[0]):Yd.Day!==se.Day?(qd=2,zd=Hd[1]):oa.ShowTime&&(Yd.Hour!==se.Hour?(qd=3,zd=Hd[2]):Yd.Minute!==se.Minute?(qd=
4,zd=Hd[3]):(qd=5,zd=Hd[4])));for(;6>qd;){let Re;switch(qd){case 0:Re=se.Year;Yd=Eb[0].getItem(Re.toString());break;case 1:Re=se.Month;Yd=Eb[1].getItem(Re.toString());break;case 2:Re=se.Day;Yd=Eb[2].getItem(Re.toString());break;case 3:Re=se.Hour;Yd=Eb[3].getItem(Re.toString());break;case 4:Re=se.Minute;Yd=Eb[4].getItem(Re.toString());break;case 5:Re=se.Second;Yd=Eb[5].getItem(Re.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Yd=cc.U1c(Yd,-1!==se.NodeType&&
qd>=se.NodeType?1:0,zd?zd.key+";"+Re:r.a.VVc+Re,!1,[]);zd=zd?zd.children:fb;zd=zd[zd.length]=Yd;Hd[qd]=Yd;switch(qd){case 5:qd=6;break;case 2:qd=oa.ShowTime?qd+1:6;break;default:qd++}}Yd=se}jc||(Hd[0].expanded=!0,Hc||(Hd[1].expanded=!0));return fb}U1g(oa){const fb=[];if(!oa)return fb;let Eb=0;for(const jc of oa)fb[Eb++]=cc.U1c(jc.DisplayString,jc.Selected?1:0,r.a.WVc+jc.DisplayString);return fb}n3a(oa,fb){const Eb=new L.a(!0);if(!oa||!fb)return Eb;const jc=oa.length<fb.length?oa.length:fb.length;
for(let Hc=0;Hc<jc;Hc++)Eb.add(oa[Hc].toString(),fb[Hc]);return Eb}G1c(oa,fb){const Eb={};Eb.Location=fb;Eb.FieldId=oa.Id.toString();Eb.DataSourceIndex=-1;Eb.FilterType=oa.AutoFilterType;Eb.AnchorType=0;Eb.ChartId=null;Eb.AnchorValue1=-1;Eb.AnchorValue2=-1;Eb.Property=oa.RichProperty;return Eb}sL(oa){rb.a.Yaa(this.$)&&F.TaskExtensions.Aa(P.GetServiceTaskFactory.Ta(this.$.da,430,431,1),fb=>{fb.result.b7(oa);e.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.la,3)}nm(){return{["Location"]:"contextMenu"}}getColorName(oa){return E.a.BJa(J.a.hH(oa))}E2f(oa){F.TaskExtensions.Aa(P.GetServiceTaskFactory.Ta(this.$.da,309,310,3),fb=>{fb.result.aAa().continueWith(Eb=>{Eb.result&&oa()})},this.$.la,3)}static U1c(oa=null,fb=0,Eb=null,jc=!1,Hc=null){return Object(f.a)(new ya,{displayText:oa?w.a.zh(oa):oa,state:fb,key:Eb,parent:null,children:Hc,indentationLevel:0,expanded:jc})}}cc.Fre=268;Object(c.a)(cc,"AutoFilterContextMenu",w.a,[]);var Ib=a(721),Mb=a(84),
Oa=a(184),Aa=a(67),Ba=a(19);class ob{}ob.fRe=26;ob.E9c=[230,231,0,99,0,95,94];Object(c.a)(ob,"Constants",null,[]);class xb{constructor(oa,fb,Eb,jc){this.Xrg=oa;this.qmg=fb;this.umg=Eb;this.lwg=jc}get zii(){return 3===this.j3b}get hmi(){return 4===this.j3b&&!!this.subMenu}get subMenu(){return this.lwg}get Nof(){return this.Xrg}get j3b(){return this.qmg}get p3c(){return this.umg}}Object(c.a)(xb,"FiltersMenuData",null,[]);class Va extends xb{constructor(oa,fb){super(oa,2,0,null);this.Gre=fb}}Object(c.a)(Va,
"AutoFilterFiltersMenuData",xb,[]);class bb{}bb.IHj=[new xb(100,2,0,null),new xb(101,2,1,null),new xb(0,3,0,null),new xb(172,2,2,null),new xb(174,2,4,null),new xb(0,3,0,null),new xb(176,2,6,null),new xb(177,2,7,null),new xb(0,3,0,null),new xb(108,0,0,null)];bb.JDi=[new xb(100,2,0,null),new xb(101,2,1,null),new xb(0,3,0,null),new xb(102,2,8,null),new xb(103,2,10,null),new xb(104,2,12,null),new xb(0,3,0,null),new xb(105,1,0,null),new Va(106,1),new Va(107,2),new xb(0,3,0,null),new xb(108,0,0,null)];
bb.Qah=[new xb(100,2,0,null),new xb(0,3,0,null),new xb(112,2,10,null),new xb(113,2,8,null),new xb(104,2,12,null),new xb(0,3,0,null),new Va(110,8),new Va(109,9),new Va(111,10),new xb(0,3,0,null),new Va(115,11),new Va(114,12),new Va(116,13),new xb(0,3,0,null),new Va(117,14),new Va(118,15),new Va(119,16),new xb(0,3,0,null),new Va(120,17),new Va(121,18),new Va(122,19),new xb(0,3,0,null),new Va(123,20),new Va(124,21),new Va(125,22),new xb(0,3,0,null),new Va(126,23),new xb(127,2,12,[new Va(128,24),new Va(129,
25),new Va(130,26),new Va(131,27),new xb(0,3,0,null),new Va(132,28),new Va(133,29),new Va(134,30),new Va(135,31),new Va(136,32),new Va(137,33),new Va(138,34),new Va(139,35),new Va(140,36),new Va(141,37),new Va(142,38),new Va(143,39)]),new xb(0,3,0,null),new xb(108,0,0,null)];Object(c.a)(bb,"Constants",null,[]);var ra=a(903),Qa=a(79);class qb extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,qb.Mxh,!0,!1,qb.uIb,fb,Eb,!1,jc);this.mm=null}get Fw(){return"PopulateAutoFilterFieldListContextMenu"}get CB(){return r.a.BKf}executeCommand(oa,
fb,Eb){oa=fb.command;switch(oa){case -699941697:this.applyAutoFilterFieldList(fb,Eb);break;case 216058793:break;case -1494291901:break;default:return fa.a(oa)}return Ja.Task.Ua(!0)}Ebd(oa,fb){return!oa||oa.length<=fb?(e.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(oa[fb],10)}YDd(oa,fb,Eb,jc,Hc,qd){const zd=this.Ebd(Hc,qd);0>zd&&e.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(ob.E9c[zd]){case 99:oa=new R.a(-2058042992,fb.method,fb.mode,fb.Re,fb.tabName);this.mm.PG.Bsb(this.$,jc,0,oa);break;case 230:oa=new R.a(504133448,fb.method,fb.mode,fb.Re,fb.tabName);this.mm.PG.Bsb(this.$,jc,0,oa);break;case 231:oa=new R.a(-798968736,fb.method,fb.mode,fb.Re,fb.tabName);this.mm.PG.Bsb(this.$,jc,0,oa);break;case 235:oa=new R.a(-1677817820,fb.method,fb.mode,fb.Re,fb.tabName);this.mm.PG.Bsb(this.$,jc,0,oa);break;case 95:this.AIf(oa,fb,jc,Eb,Hc,qd+1);break;case 94:this.mm.PG.dqi(this.$,
jc)}}AIf(oa,fb,Eb,jc,Hc,qd){const zd=this.Ebd(Hc,qd);0>zd&&e.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!jc||zd>=jc.length)e.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(jc=jc[zd],jc.j3b){case 1:this.mm.PG.xqi(this.$,Eb);break;case 2:(Hc=Object(Mb.a)(Va,jc))?(oa=new R.a(-2058042992,fb.method,fb.mode,fb.Re,fb.tabName),this.mm.PG.Bsb(this.$,Eb,Hc.Gre,oa)):this.mm.PG.Xif(this.$,
oa,Eb,jc.p3c);break;case 0:this.mm.PG.Xif(this.$,oa,Eb,jc.p3c);break;case 4:this.AIf(oa,fb,Eb,jc.subMenu,Hc,qd+1)}}applyAutoFilterFieldList(oa,fb){var Eb=fb[Ib.a.cG];if(Eb)if(Eb=Eb.split(Aa.a.bU),3>Eb.length)e.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var jc=this.Ebd(Eb,1),Hc=this.oJa(jc),qd=this.Iof(jc).returnValue;qd?this.YDd(fb,oa,qd,Hc,Eb,2):e.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
jc.toString()+Aa.a.bU)}else e.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Ec(oa,fb){if(oa=this.$.isEditMode)switch(fb.command){case 216058793:break;case -699941697:break;case -1494291901:oa=!0;break;default:oa=!1}return oa}Y_(oa,fb,Eb){this.$.isEditMode&&((this.mm=Object(Mb.a)(307,Eb))||e.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.fY(),super.Y_(oa,
fb,null,null,!0))}O1c(){if(!this.mm||!this.mm.Pk||1!==this.mm.Pk.length)return e.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const oa=this.mm.Pk[0];let fb=new Oa.a;fb.add(S.a.instance.ga(251));fb=Qa.OBc(Qa.concat(fb,Qa.select(Qa.asEnumerable(oa.FieldInfoDataList),Eb=>Eb.Name)),Eb=>Eb,new ra.a);return Qa.toArray(fb)}fieldIndex(oa){if(!this.mm||!this.mm.Pk||1!==this.mm.Pk.length||!this.mm.Pk[0].FieldInfoDataList)return-1;
for(let fb=0;fb<this.mm.Pk[0].FieldInfoDataList.length;++fb)if(this.mm.Pk[0].FieldInfoDataList[fb].Name===oa)return fb;return-1}oJa(oa){return 0>oa||!this.mm||!this.mm.Pk||1!==this.mm.Pk.length||!this.mm.Pk[0].FieldInfoDataList||this.mm.Pk[0].FieldInfoDataList.length<oa?null:this.mm.Pk[0].FieldInfoDataList[oa].Name}fY(){var oa=this.O1c();if(!oa||!oa.length)return null;const fb=this.Sa,Eb=fb.Bc();for(let zd=0;zd<oa.length;++zd){const Hd=oa[zd],Yd=0<zd?this.fieldIndex(Hd):-1,se=qb.h4f+Yd.toString()+
Aa.a.bU;let Re=null;const Ye=this.mm.PG.W3h(0<zd?Hd:null),rf=this.X1c(fb,Ye,qb.h4f+Yd.toString(),Hd);for(let tf=0;tf<ob.E9c.length;++tf){var jc=ob.E9c[tf],Hc=se+tf.toString();Re||(Re=fb.Bc());switch(jc){case 230:Re.buttons.push(fb.Lc(223,Hc,-699941697,this.mm.PG.Sli(0<zd?Hd:null)?Ba.a.W6b:Ba.a.jIa,8,230,!1,null));break;case 231:Re.buttons.push(fb.Lc(224,Hc,-699941697,this.mm.PG.Tli(0<zd?Hd:null)?Ba.a.X6b:Ba.a.kIa,8,231,!1,null));break;case 235:Re.buttons.push(fb.Lc(225,Hc,-699941697,Ba.a.U6b,1,235,
!1,null));break;case 99:jc=this.zQg(Hd);Hc=fb.RGa(Hc+(Ye?".enabled":".disabled"),jc,-699941697,null,"None",null,!Ye,void 0,!0);Hc.GR("Image16by16",8,Ba.a.G1a);Re.buttons.push(Hc);break;case 95:var qd=void 0;const Bf=({oRe:qd,isChecked:jc}=this.Iof(Yd)).returnValue;if(!Bf)return null;qd=this.X1c(fb,jc&&Ye,Hc,qd);Hc=this.zUe(qd.menu,fb,Hc+Aa.a.bU,Bf,jc&&Ye);qd.menu.pc.push(Hc);Re.buttons.push(qd);break;case 0:Re&&(rf.menu.pc.push(Re),Re=null);break;default:Hc=fb.RGa(Hc,S.a.instance.ga(jc),-699941697,
null,"None",null,!1,void 0,!0),this.CXf(Hc,Ye&&94===jc&&this.mm.PG.filter(),S.a.instance.ga(jc)),Re.buttons.push(Hc)}}rf.menu.pc.push(Re);Eb.buttons.push(rf)}oa=fb.pq(this.menuId);oa.pc.push(Eb);return oa}zUe(oa,fb,Eb,jc,Hc){let qd=null;for(let Re=0;Re<jc.length;++Re){var zd=jc[Re],Hd=Eb+Re.toString(),Yd=!1;switch(zd.j3b){case 1:Yd=Hc&&this.mm.PG.Ph.IsTop10;break;case 2:Yd=Object(Mb.a)(Va,zd);Yd=Hc&&this.mm.PG.ofi(Yd?Yd.Gre:0,zd.p3c);break;case 0:Yd=Hc&&this.mm.PG.Ph.IsCustomSupportedAndNotPresent}qd||
(qd=fb.Bc());if(zd.zii)qd&&(oa.pc.push(qd),qd=null);else if(zd.hmi){var se=S.a.instance.ga(zd.Nof);se=this.X1c(fb,Yd,Hd,se);se.menu.pc.push(this.zUe(se.menu,fb,Hd+Aa.a.bU,zd.subMenu,Yd));qd.buttons.push(se)}else zd=S.a.instance.ga(zd.Nof),Hd=fb.RGa(Hd,zd,-699941697,null,"None",null,!1,void 0,!0),this.CXf(Hd,Yd,zd),qd.buttons.push(Hd)}return qd}CXf(oa,fb,Eb){fb?oa.GR("Image16by16",8,Ba.a.Jta):oa.GR("None",0,null);oa.ER(Eb);oa.label=Eb}X1c(oa,fb,Eb,jc){return fb?oa.P1c(Eb,this.menuId,jc,798637440,8,
Ba.a.Jta):oa.Su(Eb,this.menuId,jc,798637440)}kh(oa){return!oa||!oa.length}Iof(oa){var fb=0>oa?0:this.mm.Pk[0].FieldInfoDataList[oa].MajorityDataTypeForField;var Eb=null;oa=this.mm.PG.V3h(fb);switch(fb){case 0:Eb=96;fb=bb.IHj;break;case 1:Eb=95;fb=bb.JDi;break;case 2:Eb=97;fb=bb.Qah;break;default:return e.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,oRe:Eb,isChecked:oa}}Eb=S.a.instance.ga(Eb);return{returnValue:fb,oRe:Eb,
isChecked:oa}}zQg(oa){return!oa||this.kh(oa.trim())?S.a.instance.ga(98):oa.length>ob.fRe?String.format(S.a.instance.mb(155),oa.substring(0,ob.fRe)):String.format(S.a.instance.mb(156),oa)}}qb.Mxh=r.a.k1g;qb.uIb="AutoFilterFieldListContextMenuRoot";qb.h4f="ApplyAutoFilterFieldList.";Object(c.a)(qb,"AutoFilterFieldListContextMenu",w.a,[]);var Wa=a(543),ta=a(834),ib=a(11),Bb=a(122),Ub=a(369);class Ta extends w.a{constructor(oa,fb,Eb,jc,Hc="PopulateFloatingObjectContextMenu",qd=-2017893763,zd=1350204367,
Hd=r.a.r1g,Yd=!0,se=!1){super(oa,Hc,qd,zd,Hd,Yd,se,Hd,fb,Eb,!0,jc);this.floatingObject=null;this.tb=0;this.pjc=!0}get Fw(){return"PopulateFloatingObjectContextMenu"}get CB(){return r.a.JKf}executeCommand(oa,fb,Eb){oa=Object(Mb.a)(Wa.a,Eb.eventArgs);switch(fb.command){case -1372040782:Eb=wa.g(this.$).ha.Oa.$b;e.ULS.shipAssertTag(537167048,0,!!Eb);Eb&&(this.floatingObject=Eb.floatingObject,this.tb=fb.method,fb=this.S9b(oa),this.xp(fb,!0,oa.tb));break;case 848910589:oa&&(fb=[ta.a.Q_f],oa=new Sys.UI.Point(oa.Ca.clientX,
oa.Ca.clientY),this.showFloatie(fb,new Sys.UI.Bounds(oa.x,oa.y,0,0),2))}return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){switch(fb.command){case -1372040782:return!!Eb&&this.ggf(oa);case 848910589:return oa=wa.g(this.$).ha.Oa.$b,!!Eb&&!!oa&&oa.$a;default:return!1}}ggf(oa){switch(oa){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}xSc(oa,fb,Eb){Ub.a(this.$)?wa.g(this.$).hb.Ti||(la.a(this.$).dQd()?Eb.buttons.push(oa.pb(265)):Eb.buttons.push(oa.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.v8b()&&
Eb.buttons.push(oa.pb(101)),5!==this.floatingObject.type||Bb.a.DH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(da.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Nod()?Eb.buttons.push(oa.pb(186)):Eb.buttons.push(oa.pb(147))),this.v8b()||this.Nod()||Eb.buttons.push(oa.pb(146)),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.PDh(Eb),this.sFh(Eb)),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&0===this.floatingObject.type&&Eb.buttons.push(oa.pb(287)),da.EwaSettings.ma(166)&&0===this.floatingObject.type&&Eb.buttons.push(oa.pb(249)),5===this.floatingObject.type&&wa.g(this.$).ha.Oa.$b.s4()&&this.$.Uja&&this.$.j9&&Eb.buttons.push(oa.pb(273)))}rJa(oa){const fb=[];if(Ub.a(this.$))return fb;3===oa?(oa=!!this.$.me.get(5)&&this.floatingObject.iTd(),this.v8b()||(this.$.isEditMode?(oa&&fb.push(ta.a.PAh),5===wa.g(this.$).ha.Oa.UA.floatingObject.type&&fb.push(ta.a.duj)):oa&&fb.push(ta.a.copy)),
fb.push(ta.a.QAh)):2===oa&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?wa.g(this.$).ha.Oa.$b&&this.vZe(wa.g(this.$).ha.Oa.$b,fb):this.vZe(wa.g(this.$).ha.Oa.UA,fb));return fb}fY(){const oa=this.Sa,fb=oa.pq(this.menuId);var Eb=Ub.a(this.$);if(this.$.isEditMode){var jc=oa.Bc();this.xSc(oa,fb,jc);fb.pc.push(jc)}this.$.me.get(5)&&this.floatingObject.iTd()&&!this.v8b()&&!Eb&&(jc=oa.Bc(),this.dAg(oa,jc),fb.pc.push(jc));(jc=this.$.xa.oa)&&jc.Fd&&(jc=jc.Fd.mv||
jc.Fd.KH,!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||Eb||this.$.isMobileMode||jc||(Eb=oa.Bc(),this.bCg(oa,Eb),fb.pc.push(Eb)));return fb}S9b(oa){var fb=wa.g(this.$).ha.Oa.$b;oa=oa&&1!==oa.tb&&oa.clientPoint?oa.clientPoint:Sys.UI.DomElement.getLocation(fb.domElement);const Eb=this.$.domElement,jc=wa.g(this.$).rtl;(fb=ib.HelperMethods.VC(fb.jg.domElement,Eb,jc))?(oa.y=Math.max(oa.y,fb.y),oa.x=Math.max(oa.x,
fb.x)):e.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${l.AFrameworkApplication.Mg}`);return oa}Nod(){const oa=wa.g(this.$).ha.Oa.$b;return!!oa&&oa.$a}dAg(oa,fb){if(this.$.isEditMode){fb.buttons.push(oa.pb(42));fb.buttons.push(oa.pb(43));const Eb=this.$.da.za(254,!0);(Eb&&2===Eb.pAb()||da.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Nod())&&
fb.buttons.push(oa.pb(44))}else fb.buttons.push(oa.pb(43))}bCg(oa,fb){fb.buttons.push(oa.pb(274))}v8b(){return da.EwaSettings.ma(465)&&!!wa.g(this.$).ha.Oa.Yn}vZe(oa,fb){5===oa.floatingObject.type?da.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&oa.$a?fb.push(ta.a.Q_f):fb.push(ta.a.$tj):fb.push(w.a.uSe)}PDh(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(282));fb.buttons.push(this.Sa.pb(281));const Eb=this.Sa.Su("BringToFront","BringToFrontMenuId",S.a.instance.ga(823),
-1777747317);Eb.menu.pc.push(fb);oa.buttons.push(Eb)}sFh(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(284));fb.buttons.push(this.Sa.pb(283));const Eb=this.Sa.Su("SendToBack","SendToBackMenuId",S.a.instance.ga(824),-1777747317);Eb.menu.pc.push(fb);oa.buttons.push(Eb)}}Object(c.a)(Ta,"FloatingObjectContextMenu",w.a,[]);var mb=a(784),Qb=a(102),Lb=a(552),Jb=a(511);const Ab=r.a.n1g;class pb extends Ta{constructor(oa,fb,Eb,jc){super(oa,fb,Eb,jc,"PopulateChartContextMenu",-498523270,1640762262,Ab);
this.isPivotChart=this.refresh=this.xY=this.qva=this.Zza=!1}get Fw(){return"PopulateChartContextMenu"}get CB(){return r.a.DKf}executeCommand(oa,fb,Eb){const jc=this.$;this.tb=fb.method;fb=Eb[pb.fZc];if(!(oa&68)){if(!fb){if(8===oa)fb=Jb.a(jc).Rc;else{var Hc=wa.g(jc).ha.Oa.$b;if(null===Hc||void 0===Hc?0:Hc.floatingObject)fb=Hc.floatingObject.Rc}if(!fb)return Ja.Task.Ua(!0)}this.isPivotChart=!!(fb.Attributes&4)}if(this.isPivotChart||jc.isEditMode)if(this.refresh=this.xY=this.qva=this.Zza=!1,Hc=wa.g(this.$).ha.Oa.$b,
e.ULS.shipAssertTag(537167107,0,!!Hc),Hc){this.floatingObject=Hc.floatingObject;Hc=Lb.a(jc);if(null===Hc||void 0===Hc?0:Hc.APd)this.Zza=Hc=Qb.f(jc.pg),this.qva=!Hc;Hc=jc.jc;this.xY=!!mb.a(jc)&&!!fb&&!!(fb.Attributes&512)&&!(oa&8)&&Hc.O1(32768);Hc.allowManualDataRefresh&&Hc.allowInteractivity&&(this.refresh=!0);oa=this.S9b(Object(Mb.a)(Wa.a,Eb.eventArgs));this.xp(oa,!0)}return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){return-149612405===fb.command&&!!Eb&&this.ggf(oa)}xSc(oa,fb,Eb){this.isPivotChart&&(this.refresh&&
Eb.buttons.push(oa.pb(100)),this.xY&&Eb.buttons.push(oa.pb(99)),this.Zza?Eb.buttons.push(oa.pb(59)):this.qva&&Eb.buttons.push(oa.pb(58)));super.xSc(oa,fb,Eb)}static get fZc(){return"chartMetaData"}}Object(c.a)(pb,"ChartContextMenu",Ta,[]);var va=a(12);const db=r.a.p1g;class Ya extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateFieldListContextMenu",-1045020714,-170383950,db,!0,!1,db,fb,Eb,!1,jc);this.vL=this.qo=null;this.kTd=this.isOlap=this.VU=this.jZ=!1}get Fw(){return"PopulateFieldListContextMenu"}get CB(){return r.a.iFd}executeCommand(oa,
fb,Eb){oa=fb.command;switch(oa){case 330754562:fb=Eb.domElement;this.isOlap=Eb.isOlap;this.vL=Eb.versionkey;this.qo=Eb.fieldItem;this.jZ=Eb.isChart;this.VU=Eb.isPpm;this.kTd="supportsImplicitMeasures"in Eb?Eb.supportsImplicitMeasures:!1;wa.g(this.$).Fo(!0);fb=va.DOMElementExtensions.getBounds(fb);fb=new Sys.UI.Point(fb.x+fb.width,fb.y+fb.height/2);"isKeyboardInput"in Eb&&Eb.isKeyboardInput?this.xp(fb,!1,1):this.xp(fb,!1);break;case 926905850:this.kTd&&this.qo&&5===this.qo.TypeTag&&!this.qo.IsCollapsible&&
e.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Lb.a(this.$).HJ(this.qo,8,-1,this.vL,fb);break;case -67292059:Lb.a(this.$).HJ(this.qo,1,-1,this.vL,fb);break;case 745182485:Lb.a(this.$).HJ(this.qo,2,-1,this.vL,fb);break;case 359279088:Lb.a(this.$).HJ(this.qo,4,-1,this.vL,fb);break;case 547535945:Lb.a(this.$).X3i(this.qo);break;default:return fa.a(oa)}return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){oa=!1;switch(fb.command){case 330754562:oa=!!Eb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:oa=
!0}return oa}fY(){const oa=this.Sa.pq(this.menuId);this.uYi(oa);this.jZ||this.isOlap||this.tYi(oa);return oa}uYi(oa){const fb=this.Sa,Eb=fb.Bc();let jc=!1;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(jc=this.isOlap&&!this.VU&&this.kTd&&5===this.qo.TypeTag&&!this.qo.IsCollapsible);3!==this.qo.TypeTag&&37!==this.qo.TypeTag||this.qo.IsSet?17===this.qo.TypeTag||this.VU?(Eb.buttons.push(fb.pb(79)),Eb.buttons.push(fb.pb(this.jZ?91:80)),Eb.buttons.push(fb.pb(this.jZ?
92:81)),Eb.buttons.push(fb.pb(82))):13===this.qo.TypeTag||this.qo.IsSet?(Eb.buttons.push(fb.pb(83)),Eb.buttons.push(fb.pb(this.jZ?91:80)),Eb.buttons.push(fb.pb(this.jZ?92:81)),Eb.buttons.push(fb.pb(86))):(Eb.buttons.push(fb.pb(79)),Eb.buttons.push(fb.pb(this.jZ?91:80)),Eb.buttons.push(fb.pb(this.jZ?92:81)),Eb.buttons.push(fb.pb(jc?82:86))):(Eb.buttons.push(fb.pb(83)),Eb.buttons.push(fb.pb(this.jZ?93:84)),Eb.buttons.push(fb.pb(this.jZ?94:85)),Eb.buttons.push(fb.pb(82)));oa.pc.push(Eb)}tYi(oa){const fb=
this.Sa.Bc();fb.buttons.push(this.Sa.pb(78));oa.pc.push(fb)}}Object(c.a)(Ya,"FieldListContextMenu",w.a,[]);var gb=a(412),Ka=a(64);class ub{constructor(oa){this.$=oa;this.gN={}}get(oa,fb,Eb){const jc=this.m$f(oa,"PivotFilterContextMenuCache.Get");return jc&&this.gN[jc]?this.gN[jc][ub.zdd(fb,this.$,oa,Eb)]:null}set(oa,fb,Eb,jc){const Hc=this.m$f(oa,"PivotFilterContextMenuCache.Set");Hc&&(this.gN[Hc]||(this.gN[Hc]={}),this.gN[Hc][ub.zdd(fb,this.$,oa,jc)]=Eb)}J5b(oa){oa in this.gN&&this.gN[oa]&&(this.gN[oa]=
null)}m$f(oa,fb){return Ka.f(this.$.oa)?this.$.activeItemName:(oa=this.vMj(oa,fb))?oa.Nd:null}vMj(oa,fb){oa=K.C(oa);oa=wa.g(this.$).Ea.Fua(oa,this.$.activeItemName);e.ULS.shipAssertTag(537167008,0,!!oa,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${fb}`);return oa}static zdd(oa,fb,Eb,jc){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===jc?fb.oa.index+"_"+
oa.id+"_"+Eb.FirstRow.toString()+"_"+Eb.FirstColumn.toString():fb.oa.index+"_"+oa.id}}Object(c.a)(ub,"PivotFilterContextMenuCache",null,[]);class ac{constructor(){this.cell=null;this.dataSourceIndex=0;this.Bo=this.pivotName=null}}Object(c.a)(ac,"ShowPivotFilterData",null,[]);var Ra=a(452),na=a(1282),lb=a(54);const jb=r.a.vAe;class Yb extends w.a{constructor(oa,fb,Eb,jc,Hc,qd,zd,Hd=jb){super(oa,fb,Eb,jc,Hd,!0,!1,"PivotFilterMenuRootName",Hc,qd,!1,zd);this.Fkc=this.mxd=this.pivotData=this.mlb=this.iif=
this.u3b=null;this.GX=this.w0b=this.PCb=0;this.Hqb=null;this.EKi=(Yd,se)=>{if(se)if(X.a(Yd))this.oud(se,!1);else if(Yd=Yd.Result){this.urb=ub.zdd(se,this.$,this.pivotData.cell,this.GX);var Re=this.Jof(Yd.MenuModel.Sections);this.Hqb=Re;Yb.gN.set(this.pivotData.cell,se,Re,this.GX);na.a(this.$).eFj(Yd);this.oud(se,!0)}};this.DKi=(Yd,se)=>{this.oud(se,!1)};this.mf=(Yd,se)=>{Yb.gN.J5b(se.gd.hash)};this.Lm=(Yd,se)=>{Yb.gN.J5b(se.gd.hash)};this.Rya=null;this.qwe=this.w0b=this.nxd=this.PCb=-1;this.roe=this.GX=
0;this.Xx=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Yb.gN||(Yb.gN=new ub(this.$),wa.g(this.$).Ea.Ms(this.mf),wa.g(this.$).Ea.KG(this.Lm),wa.g(this.$).Ea.bga(this.mf))}F8c(oa,fb){const Eb=oa.rawEvent,jc=oa.cell,Hc=oa.requiresConfirmation;Ra.a(this.$).yx(Hc,qd=>{if(qd){qd=Eb?new Sys.UI.DomEvent(Eb):null;this.pivotData=new ac;this.pivotData.pivotName=oa.pivotName;this.pivotData.dataSourceIndex=oa.dataSourceIndex;this.pivotData.cell=jc;this.pivotData.Bo=oa.optionalPivotMenuAnchorParameter;
if(this.pivotData.Bo&&0<this.pivotData.Bo.AnchorType){this.Fkc=oa.objectId;this.PCb=oa.objectVersion;const zd=this.pivotData.Bo.AnchorType;if(4===zd||5===zd||6===zd||11===zd||9===zd||10===zd||8===zd)this.mlb=oa.location}else this.mxd=this.Fkc=null,this.nxd=this.PCb=-1;wa.g(this.$).Fo(!0);this.$.Wj(jc);this.Y_(qd,qd?qd.target:oa.domElement,this.pivotData,fb,this.lLa())}});return!0}Y_(oa,fb,Eb,jc){if(Object(gb.a)(ac,Eb)){this.pivotData=Eb;this.u3b=fb;this.iif=oa;this.w0b=this.pivotData.Bo?this.pivotData.Bo.AnchorValue1:
-1;this.GX=this.pivotData.Bo?this.pivotData.Bo.AnchorType:0;var Hc=!1,qd=null;qd=Yb.gN.get(this.pivotData.cell,fb,this.GX);Hc=!!qd;var zd=!0;switch(this.GX){case 4:case 5:case 6:this.Rya=new Sys.UI.Point(this.mlb.x,this.mlb.y);zd=!1;break;case 7:var Hd=Sys.UI.DomElement.getBounds(fb);zd=Hd.x+(0<=Hd.x?0:Hd.width);Hd=Hd.y+(0<=Hd.y?0:Hd.height);this.Rya=new Sys.UI.Point(0<=zd?zd:0,0<=Hd?Hd:0);zd=!1;break;case 8:case 10:case 9:case 11:this.Rya=new Sys.UI.Point(this.mlb.x,this.mlb.y);break;default:this.Rya=
null}Hc&&this.Fkc===this.mxd&&this.PCb===this.nxd&&this.w0b===this.qwe&&this.GX===this.roe?(e.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Hqb=qd,this.Rya?this.xp(this.Rya,this.lLa()):this.Xx?(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||w.a.vld(this.$,this.pivotData.cell))&&this.xp(w.a.Nbd(this.$,this.pivotData.cell,!1),this.lLa()):super.Y_(oa,fb,Eb,jc,this.lLa())):1!==
Yb.WMh(fb)&&(zd&&(fb.parentNode.menuFetchStates=1,this.Eoj(fb),this.jXf(!0)),this.$.userOperationManager.Ub(new T.a(126,0,(Yd,se,Re)=>{const Ye=this.$;return W.q(Ye.pa.va,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,Ye.domElement.id,Ye.isChromeRtl,Ye.workbookContext.NovMode,V.b(Yd,this.EKi),V.a(se,this.DKi),Re,fb,this.pivotData.Bo)},16),jc))}}rCd(oa){oa.MenuSectionList.push(...this.Hqb)}oud(oa,fb){oa.parentNode.menuFetchStates=2;this.jXf(!1);if(fb){if(this.u3b!==oa||
this.dzi())this.xp(this.Rya,this.lLa());else if(this.Xx&&!this.Rya){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.vld(this.$,this.pivotData.cell))return;this.xp(w.a.Nbd(this.$,this.pivotData.cell,!1),this.lLa())}else super.Y_(this.iif,oa,null,null,this.lLa());this.mxd=this.Fkc;this.nxd=this.PCb;this.roe=this.GX;this.qwe=this.w0b}}lLa(){return 8!==this.GX&&9!==this.GX&&10!==this.GX&&11!==this.GX}dzi(){switch(this.pivotData.Bo?this.pivotData.Bo.AnchorType:
0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}jXf(oa){const fb=this.u3b;if(fb){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Eb=va.DOMElementExtensions.GY(fb,"ewaprevsrc","");Eb=!!Eb&&"null"!==Eb}else Eb=!!va.DOMElementExtensions.GY(fb,"ewaprevsrc","");oa&&Eb||!oa&&!Eb||(oa?(fb.setAttribute("ewaprevsrc",fb.src),fb.src=lb.a.current.Rn(98)):(oa=va.DOMElementExtensions.GY(fb,"ewaprevsrc",""),fb.src=oa,fb.setAttribute("ewaprevsrc",
null)))}}Eoj(oa){this.u3b=oa}static WMh(oa){const fb=oa.parentNode.menuFetchStates;void 0===fb&&(oa.parentNode.menuFetchStates=0);return fb}}Yb.gN=null;Object(c.a)(Yb,"PivotFilterContextMenuBase",w.a,[]);const Gb="FieldList"+r.a.vAe;class wb extends Yb{constructor(oa,fb,Eb,jc){super(oa,"PopulateFieldListPivotMenu",-1793121409,1378457149,fb,Eb,jc,Gb)}get Fw(){return"PopulateFieldListPivotMenu"}get CB(){return r.a.HKf}executeCommand(oa,fb,Eb){return this.F8c(Eb,fb)?Ja.Task.Ua(!0):fa.a(fb.command)}Ec(oa,
fb,Eb){return-1065117584===fb.command&&!!Eb}}Object(c.a)(wb,"FieldListPivotContextMenu",Yb,[]);var dc=a(262),Jc=a(29),Qc=a(86),fd=a(724);class Wc{}Object(c.a)(Wc,"PivotValueFieldSettingsApplyData",null,[]);class Rb{}Rb.vah="dataFieldCustomLabel";Rb.yEe="dataFieldSourceLabel";Rb.pRd="showValueAsSelect";Rb.nRd="showValueAsBaseFieldSelect";Rb.oRd="showValueAsBaseItemSelect";Rb.EYd="valueFieldsSettingsFieldName";Rb.veg="valueFieldSettingTabs";Object(c.a)(Rb,"CssElementIds",null,[]);var Sb=a(117);class mc{constructor(oa,
fb,Eb){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=oa;this.baseFieldIndex=fb;this.baseItemIndex=Eb}}Object(c.a)(mc,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class ec{constructor(oa,fb,Eb,jc,Hc){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=oa;this.activeCell=fb;this.pivotFieldTitle=Eb;this.summarizeBy=jc;this.showAsValueParameters=Hc}getActiveCell(){return this.activeCell}}
Object(c.a)(ec,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[116]);var Rc=a(234);class Mc{}Object(c.a)(Mc,"PivotValueFieldShowValueAsApplyData",null,[]);var bc=a(723),ic=a(43);const Yc=`<div id='showValueAsControlBody'><label for='${Rb.pRd}' class='${Sb.a.Nn} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Rb.pRd}' class='${Sb.a.RC}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Rb.nRd}'>{1}</label><div><select size=6 id='${Rb.nRd}' class='${Sb.a.RC}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Rb.oRd}'>{2}</label><div><select size=6 id='${Rb.oRd}' class='${Sb.a.RC}'></select></div></div></div>`;
class md extends Rc.a{constructor(oa,fb,Eb,jc,Hc,qd,zd,Hd){super(oa);this.h3d=this.U0d=this.T0d=this.QZb=this.a4b=this.eD=null;this.Puf=()=>{var Yd=parseInt(this.D2.de.value,10);this.OTg(Yd)?(this.hP.Vp.disabled=!0,this.iP.Vp.disabled=!0,this.iP.clear(),md.uaf(Yd)?(this.hP.Vp.disabled=!1,this.gNb(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):md.vaf(Yd)?(this.hP.Vp.disabled=!1,this.iP.Vp.disabled=!1,this.gNb(!0),this.Ljf()):this.gNb(!1)):(Yd=U.a.Yc(1,0,0,
1125,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),ic.a(this.$).tr([Yd]),this.D2.ygj())};this.yFi=()=>{0>this.hP.selectedIndex||this.iP.Vp.disabled||(this.gNb(!0),this.Ljf())};this.ALi=Yd=>{this.eD.ZRa();this.iP.Vp.style.overflowY="scroll";if(Yd&&!X.a(Yd)){Yd=Yd.Result;this.iP.clear();for(const se of Yd.BaseItems)this.iP.XL(se.DisplayString,se.Id.toString(),se.Id===Yd.SelectedBaseItem);this.gNb(!1)}};this.get_visible=this.cja;this.set_visible=this.Sma;this.$=fb;this.cell=Eb;this.Bo=jc;this.externalSourceIndex=
Hc;this.Jd=qd;this.gha=zd;this.Uii=Hd;this.PRj=da.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.wja()}cja(){return this.isVisible}Sma(oa){return this.isVisible=oa}get title(){return S.a.instance.ga(1113)}get Xub(){const oa=this.D2.de?parseInt(this.D2.de.value,10):-1,fb=this.hP.de?parseInt(this.hP.de.value,10):-1,Eb=this.iP.de?parseInt(this.iP.de.value,10):-1;return Object(f.a)(new Mc,{SelectedDataFormat:0<=oa?oa:-1,SelectedBaseField:fb,SelectedBaseItem:Eb})}get hP(){return this.T0d}get iP(){return this.U0d}get D2(){return this.h3d}setFocus(){va.DOMElementExtensions.setFocus(this.D2.Vp)}render(oa){oa.appendChild(this.domElement)}dispose(){Qc.a.rc([this.D2,
this.hP,this.iP,this.a4b,this.QZb]);super.dispose()}mrj(oa){Qc.a.rc([this.a4b,this.QZb]);this.D2.clear();for(const fb of oa.DataFormatTypes)this.D2.XL(md.gLh(fb),fb.toString(),fb===oa.SelectedDataFormat);this.a4b=this.pe.Vd(this.D2.domElement);this.a4b.ka("change",this.Puf);this.hP.clear();for(const fb of oa.BaseFieldList)this.hP.XL(fb.DisplayString,fb.Id.toString(),fb.Id===oa.SelectedBaseField);this.QZb=this.pe.Vd(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?
this.hP.domElement:this.D2.domElement);this.QZb.ka("change",this.yFi);this.eD=this.gha.Bqb(this.iP.Vp.parentNode,1E3,null,"",741);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.eD.ZRa();this.Puf(null)}rQ(oa){this.D2.rQ(oa);this.hP.rQ(oa);this.iP.rQ(oa)}wja(){this.domElement.innerHTML=String.format(Yc,S.a.instance.ga(1114),S.a.instance.ga(1115),S.a.instance.ga(1116));this.h3d=new bc.a(va.DOMElementExtensions.getElementById(this.domElement,Rb.pRd),
!1);this.T0d=new bc.a(va.DOMElementExtensions.getElementById(this.domElement,Rb.nRd),!1);this.U0d=new bc.a(va.DOMElementExtensions.getElementById(this.domElement,Rb.oRd),!1)}OTg(oa){return this.Uii||!md.uaf(oa)&&!md.vaf(oa)?!0:!!this.hP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Ub(new T.a(108,0,(oa,fb,Eb)=>{var jc=this.$.pa.va,Hc=parseInt(this.hP.de.value,10);oa=V.b.call(null,oa,this.ALi);const qd=W.M(jc,this.cell,this.externalSourceIndex,this.Bo);qd.selectedBaseField=
Hc;return W.g(jc,"GetPivotValueFieldSettingsShowValueAsBaseItems",qd,oa,fb,Eb,null,4)},16),this.Jd)}Ljf(){this.iP.clear();this.hP.de&&(this.eD.TRa(),this.iP.Vp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}gNb(oa){const fb=document.getElementById("WACDialogActionButton");this.PRj&&fb&&(fb.disabled=oa)}static gLh(oa){switch(oa){case 0:return S.a.instance.ga(1117);case 1:return S.a.instance.ga(1118);case 2:return S.a.instance.ga(1119);case 3:return S.a.instance.ga(1120);
case 4:return S.a.instance.ga(1121);case 5:return S.a.instance.ga(1122);case 6:return S.a.instance.ga(1123);case 7:return S.a.instance.ga(1124);case 8:return S.a.instance.ga(1126);case 9:return S.a.instance.ga(1127);case 10:return S.a.instance.ga(1128);case 11:return S.a.instance.ga(1129);case 12:return S.a.instance.ga(1130);case 13:return S.a.instance.ga(1131);case 14:return S.a.instance.ga(1132);default:return""}}static uaf(oa){return 11===oa||12===oa||14===oa||13===oa||4===oa}static vaf(oa){return 1===
oa||3===oa||2===oa}}Object(c.a)(md,"ShowValueAsControl",Rc.a,[320,3]);class id{}Object(c.a)(id,"PivotValueFieldSummarizeValueByApplyData",null,[]);const xd="<div id='summarizeValuesByControlBody'>"+`<label class='${Sb.a.Nn} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${Sb.a.Nn} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${Sb.a.RC}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${r.a.NG}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class Lc extends Rc.a{constructor(oa){super(oa);this.jce=null;this.get_visible=this.cja;this.set_visible=this.Sma;this.wja()}get Xub(){const oa=this.jl.de?parseInt(this.jl.de.value,10):-1;return Object(f.a)(new id,{Aggregation:0<=oa?oa:-1})}cja(){return this.isVisible}Sma(oa){return this.isVisible=oa}get title(){return S.a.instance.ga(1112)}get enabled(){return!this.jl.Vp.disabled}set enabled(oa){this.jl.Vp.disabled=!oa}get jl(){return this.jce}setFocus(){va.DOMElementExtensions.setFocus(this.jl.Vp)}render(oa){oa.appendChild(this.domElement)}dispose(){Qc.a.Ia(this.jl);
super.dispose()}focus(){va.DOMElementExtensions.setFocus(this.jl.Vp)}lrj(oa){this.jl.kSd();for(const fb of oa.AggregationTypes){const Eb=fb===oa.SelectedAggregation;this.jl.vSc(Lc.JGh(fb),fb.toString(),Eb,"")}this.jl.t6c();this.jl.Vp.disabled=oa.AggregationsDisabled}ugj(){this.jl.vgj()}wja(){this.domElement.innerHTML=String.format(xd,S.a.instance.ga(1097),S.a.instance.ga(1098));this.jce=new bc.a(va.DOMElementExtensions.getElementById(this.domElement,Lc.HFf),!1)}static JGh(oa){switch(oa){case 0:return S.a.instance.ga(1100);
case 1:return S.a.instance.ga(1101);case 2:return S.a.instance.ga(1102);case 3:return S.a.instance.ga(1103);case 4:return S.a.instance.ga(1104);case 5:return S.a.instance.ga(1105);case 6:return S.a.instance.ga(1106);case 7:return S.a.instance.ga(1107);case 8:return S.a.instance.ga(1108);case 9:return S.a.instance.ga(1109);case 10:return S.a.instance.ga(1110);case 11:return S.a.instance.ga(1111);default:return""}}}Lc.HFf="pivotDataFieldSelect";Object(c.a)(Lc,"SummarizeValuesByControl",Rc.a,[320,3]);
var Pb=a(210),Gc=a(459),Nb=a(1228);class yc extends fd.a{constructor(oa,fb,Eb,jc,Hc,qd,zd,Hd,Yd){super(Hc,S.a.instance.mb(61),!0,2,!0);this.J1f=!0;this.ZPc=this.F3c=this.Vqb=this.afa=this.BRa=this.Mhe=null;this.nFi=se=>{dc.a.any(se.Errors,Re=>-103190598===Re.MessageId)&&this.gSa.ugj()};this.zLi=se=>{se&&!X.a(se)&&(se=se.Result,this.F3c.innerHTML=S.a.instance.ga(1095)+Jc.a.Dg(se.ValueFieldSourceName),this.isOlap&&!this.VU?(this.gSa.enabled=!1,this.afa.activeTab=this.afa.Nxc-1):(this.gSa.enabled=!0,
this.afa.activeTab=0),this.gSa.lrj(se.PivotValueFieldSettingsSummarizeValueByInfo),this.BRa.mrj(se.PivotValueFieldShowValueAsInitialInfo),this.xf())};this.cell=oa;this.Bo=fb;this.externalSourceIndex=Eb;this.ueg=jc;this.Jd=qd;this.gha=zd;this.isOlap=Hd;this.VU=Yd}get oc(){return"ValueFieldSettingsDialog"}get $da(){return this.Mhe}get mCb(){return this.afa}get gSa(){return this.ZPc}get Hv(){return 560}dispose(){this.F3c=this.Vqb=this.BRa=this.ZPc=null;Qc.a.Ia(this.afa);this.afa=null;super.dispose()}initialize(){let oa=
"<div id='"+Rb.yEe+"' class='"+Sb.a.Nn+"'></div><div id='"+Rb.vah+"' class='"+Sb.a.Nn+"'><label for='"+Rb.EYd+"'>{0}</label><input type='text' id='"+Rb.EYd+"' value='{1}' class='"+Sb.a.RC+" UIFont' /></div><div id='"+Rb.veg+"'></div>";oa=String.format(oa,S.a.instance.ga(1096),Jc.a.Dg(this.ueg));this.Jb.innerHTML=oa;this.Ge||(this.E1(),this.Nl());this.Mhe=[-103190598];this.BZh();super.initialize()}close(oa){1===oa&&(this.J1f=!1);super.close(oa)}xGe(oa){this.TM=oa;this.domElement.disabled=oa;const fb=
["input","option","select"];for(let Eb=0,jc=fb.length;Eb<jc;++Eb){const Hc=this.domElement.getElementsByTagName(fb[Eb]);for(let qd=0;qd<Hc.length;++qd)Hc[qd].disabled=oa}}Nl(){this.Vqb=document.getElementById(Rb.EYd);this.F3c=va.DOMElementExtensions.getElementById(this.Jb,Rb.yEe);const oa=va.DOMElementExtensions.getElementById(this.Jb,Rb.veg);this.ZPc=new Lc(document.createElement("div"));this.BRa=new md(document.createElement("div"),this.$,this.cell,this.Bo,this.externalSourceIndex,this.Jd,this.gha,
!this.isOlap);let fb;this.afa=new Nb.a(oa,(fb=new Oa.a,fb.add(this.gSa),fb.add(this.BRa),fb));this.afa.bQf()}CCd(){const oa=new yc(this.cell,this.Bo,this.externalSourceIndex,this.ueg,this.$,this.Jd,this.gha,this.isOlap,this.VU);oa.initialize();oa.xf()}Seb(){const oa=new Gc.a;if(!this.J1f)return oa.isValid=!0,oa;this.Vqb.value.length?oa.isValid=!0:(this.xGe(!0),oa.error=U.a.Yc(1,0,756,771,0,1783218700,"PivotTableValueFieldNoBlank"),this.TM=!0,this.Ge||(this.Xy.disabled=!0),oa.isValid=!1);return oa}T3e(){this.TM=
!1;this.Ge||(this.Xy.disabled=!1);this.xGe(!1)}Qxa(oa){const fb=new R.a(2105621672,0,this.$.Mc,30,null);this.$.Ka.Lb(fb);this.RV(5,oa.tb,"Number Format");return!0}An(){this.Bna=String.format(S.a.instance.mb(61),null);super.An()}setFocus(){if(this.Ge){const oa=va.DOMElementExtensions.getElementById(this.Jb,Lc.HFf);Pb.a.gzc(oa)}else this.afa.setFocus()}hj(){const oa=this.BRa.Xub,fb=new mc(oa.SelectedDataFormat,oa.SelectedBaseField,oa.SelectedBaseItem);return()=>new ec(this.externalSourceIndex,this.cell,
this.Vqb.value,this.gSa.Xub.Aggregation,fb)}Ry(){const oa=Object(f.a)(new Wc,{PivotValueFieldSummarizeValueByApplyData:this.gSa.Xub,PivotValueFieldShowValueAsApplyData:this.BRa.Xub,PivotValueFieldTitle:this.Vqb.value});return(fb,Eb,jc)=>{var Hc=this.$.pa.va;fb=V.b(fb,this.nFi);const qd=W.M(Hc,this.cell,this.externalSourceIndex,this.Bo);qd.pivotValueFieldSettingsApplyData=oa;return W.g(Hc,"ApplyPivotValueFieldSettings",qd,fb,Eb,jc,null,0)}}rQ(oa){this.$.da.Za(40,()=>{this.BRa.rQ(oa)})}BZh(){this.$.userOperationManager.Ub(new T.a(123,
0,(oa,fb,Eb)=>{var jc=this.$.pa.va;oa=V.b.call(null,oa,this.zLi);const Hc=W.M(jc,this.cell,this.externalSourceIndex,this.Bo);return W.g(jc,"GetPivotValueFieldSettingsInitial",Hc,oa,fb,Eb,null,4)},16),this.Jd)}}Object(c.a)(yc,"ValueFieldSettingsDialog",fd.a,[]);const Tc=r.a.q1g;class gd extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateFieldWellContextMenu",1374696078,495005930,Tc,!0,!1,Tc,fb,Eb,!1,jc);this.Bo=this.qo=this.cell=null;this.PZd=this.externalSourceIndex=-1;this.ORa=0;this.Mwc=-1;
this.vL=null;this.T1a=this.VU=this.isOlap=!1}get Fw(){return"PopulateFieldWellContextMenu"}get CB(){return r.a.jFd}executeCommand(oa,fb,Eb,jc){oa=fb.command;switch(oa){case -1453503574:jc=Eb.domElement;this.qo=Eb.fieldItem;this.PZd=Eb.zoneCount;this.ORa=Eb.sourceAxis;this.Mwc=Eb.sourceAxisPos;this.Bo=Eb.optionalPivotMenuAnchorParameter;this.vL=Eb.versionkey;this.isOlap=Eb.isOlap;this.VU=Eb.isPpm;this.T1a="fieldItemsupportsImplicitMeasures"in Eb?Eb.fieldItemsupportsImplicitMeasures:!1;this.cell=Eb.cell;
this.externalSourceIndex=Eb.externalSourceIndex;wa.g(this.$).Fo(!0);jc=va.DOMElementExtensions.getBounds(jc);oa=new Sys.UI.Point(jc.x,jc.y+jc.height);this.$.isChromeRtl&&(oa.x+=jc.width);"isKeyboardInput"in Eb&&Eb.isKeyboardInput?this.xp(oa,!1,1):this.xp(oa,!1);break;case 495005930:break;case -1170196828:Lb.a(this.$).HJ(this.qo,this.ORa,this.Mwc-1,this.vL,fb);break;case -889576107:Lb.a(this.$).HJ(this.qo,this.ORa,this.Mwc+2,this.vL,fb);break;case 2033235475:Lb.a(this.$).HJ(this.qo,this.ORa,this.PZd,
this.vL,fb);break;case 389774337:Lb.a(this.$).HJ(this.qo,this.ORa,0,this.vL,fb);break;case -96230454:Lb.a(this.$).HJ(this.qo,4,-1,this.vL,fb);break;case 74086617:Lb.a(this.$).HJ(this.qo,1,-1,this.vL,fb);break;case 1529312473:Lb.a(this.$).HJ(this.qo,2,-1,this.vL,fb);break;case 563292088:this.T1a&&e.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Lb.a(this.$).HJ(this.qo,8,-1,this.vL,fb);break;case -1092351914:Lb.a(this.$).HJ(this.qo,0,-1,this.vL,fb);break;case -2141589616:const Hc=
P.GetServiceTaskFactory.Ta(this.$.da,12,477,jc.Wia());return F.TaskExtensions.Aa(Hc,()=>{(new yc(this.cell,this.Bo,this.externalSourceIndex,this.qo.Name,this.$,fb,Hc.result,this.isOlap,this.VU)).initialize()},this.la);default:return fa.a(oa)}return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){oa=!1;switch(fb.command){case -1453503574:oa=!!Eb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:oa=
!0}return oa}fY(){const oa=this.Sa.pq(this.menuId);this.BYi(oa,this.Mwc,this.PZd);this.CYi(oa,this.ORa);this.DYi(oa);8===this.ORa&&this.zYi(oa);return oa}BYi(oa,fb,Eb){const jc=this.Sa,Hc=jc.Bc();fb||fb!==Eb-1?!fb&&fb<Eb-1?(Hc.buttons.push(jc.pb(64)),Hc.buttons.push(jc.pb(61)),Hc.buttons.push(jc.pb(66)),Hc.buttons.push(jc.pb(63))):0<fb&&fb<Eb-1?(Hc.buttons.push(jc.pb(60)),Hc.buttons.push(jc.pb(61)),Hc.buttons.push(jc.pb(62)),Hc.buttons.push(jc.pb(63))):0<fb&&fb===Eb-1&&(Hc.buttons.push(jc.pb(60)),
Hc.buttons.push(jc.pb(65)),Hc.buttons.push(jc.pb(62)),Hc.buttons.push(jc.pb(67))):(Hc.buttons.push(jc.pb(64)),Hc.buttons.push(jc.pb(65)),Hc.buttons.push(jc.pb(66)),Hc.buttons.push(jc.pb(67)));oa.pc.push(Hc)}CYi(oa,fb){const Eb=this.Sa,jc=Eb.Bc(),Hc=1!==fb&&(!this.isOlap||this.VU||8!==fb||this.T1a),qd=2!==fb&&(!this.isOlap||this.VU||8!==fb||this.T1a),zd=8!==fb&&-2!==this.qo.PivotTableIndex&&(!this.isOlap||this.VU||this.T1a);jc.buttons.push(Eb.pb(4===fb||this.qo.IsSet||-2===this.qo.PivotTableIndex||
this.isOlap&&!this.VU&&8===fb&&!this.T1a?72:68));8===this.Bo.AnchorType||10===this.Bo.AnchorType?(jc.buttons.push(Eb.pb(Hc?95:97)),jc.buttons.push(Eb.pb(qd?96:98))):(jc.buttons.push(Eb.pb(Hc?69:73)),jc.buttons.push(Eb.pb(qd?70:74)));jc.buttons.push(Eb.pb(zd?71:75));oa.pc.push(jc)}DYi(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(76));oa.pc.push(fb)}zYi(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(77));oa.pc.push(fb)}}Object(c.a)(gd,"FieldWellContextMenu",w.a,[]);var Ad=a(1208);class Od extends Yb{constructor(oa,
fb,Eb,jc){super(oa,"PopulatePivotContextMenu",2123758504,912277356,fb,Eb,jc)}get Fw(){return"PopulatePivotContextMenu"}get CB(){return r.a.NKf}executeCommand(oa,fb,Eb){let jc=!1;const Hc=fb.command;switch(Hc){case 37023044:jc=this.F8c(Eb,fb);break;case 541421805:case -569786022:jc=this.Mgd(oa,fb)}return jc?Ja.Task.Ua(!0):fa.a(Hc)}Ec(oa,fb,Eb){oa=!1;switch(fb.command){case 37023044:oa=!!Eb;break;case 541421805:case -569786022:oa=!0}return oa}Mgd(oa,fb){var Eb=8===oa,jc=this.$,Hc=Jb.a(jc),qd=wa.g(jc).ha.Oa.$b;
let zd=oa=null;Eb&&Hc?(oa=Hc.chartId,zd=Hc.Rc):!Eb&&qd&&(oa=qd.floatingObject.id,zd=qd.floatingObject.Rc);return Od.qqe(zd,260)?(Eb={},jc.Wj(Eb),Eb.FirstColumn=Eb.FirstRow=-1,jc={["rawEvent"]:null,["pivotName"]:null,["cell"]:Eb,["requiresConfirmation"]:Od.qqe(zd,64),["dataSourceIndex"]:zd.ExternalSourceIndex},qd?(Hc=qd.floatingObject,jc.domElement=qd.domElement,jc.objectId=Hc.id,jc.objectVersion=Hc.version):Hc&&(jc.domElement=Hc.wl,jc.objectId=Hc.chartId,jc.objectVersion=Hc.twe),qd={AnchorType:7},
qd.ChartId=oa,qd.AnchorValue1=-1,qd.AnchorValue2=-1,jc.optionalPivotMenuAnchorParameter=qd,this.F8c(jc,fb)):!1}static qqe(oa,fb){return(oa.Attributes&fb)===fb}}Object(c.a)(Od,"PivotFilterContextMenu",Yb,[]);var Pd=a(1281),Md=a(833);const ge=(oa,fb,Eb,jc,Hc,qd,zd,Hd,Yd,se=null)=>{se=oa.Na(41,se);se.activeCell=fb;se.operationType=Eb;se.fieldCaption=jc;se.prevFieldCaption=Hc;return W.g(oa,"ExecutePivotTableOperation",se,qd,zd,Hd,Yd,0)},pe=(oa,fb,Eb,jc,Hc,qd,zd,Hd=null)=>{Hd=oa.Na(41,Hd);Hd.activeCell=
fb;Hd.pivotValueFieldSettingsApplyData=Eb;return W.g(oa,"ApplyValueFieldSettingsToPivotTable",Hd,jc,Hc,qd,zd,0)};var Qd=a(147),he=a(368),ue=a(247),je=a(28),Ge=a(22);const Ce=r.a.u1g,pc=Ce+".RemoveField",Uc=Ce+".Subtotal",hd=Ce+".ClearFilter",yd=Ce+".LayoutSameColumn",wd=Ce+".LayoutNextColumn";class I extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulatePivotTableContextMenu",-1475408662,1114549926,Ce,!0,!1,"PivotTableContextMenuRootName",fb,Eb,!0,jc);this.rZd=this.activeCell=this.nc=null;this.xY=
this.refresh=this.expandCollapse=this.mmd=this.Egc=!1;this.q$a=this.ub=this.K_a=this.eA=this.we=null;this.Vaa=!1;this.QKi=Hc=>{Hc&&!U.a.rg(Hc.Errors)&&this.nc&&(this.nc.Oo=Hc.Result,this.IJb());this.showPivotTableContextMenu()};this.PKi=()=>{};this.DOi=()=>{this.$ab()};this.COi=()=>{this.$ab()};this.tFi=()=>{this.$ab()};this.sFi=()=>{this.$ab()};this.gy=()=>{this.MWd();this.Vaa=!1};this.Iq=()=>{if(this.Vaa){e.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const Hc=this.nc;this.grid.Db.ap(this.grid.ha.sa.activeCell)!==Hc&&(this.$ab(),this.u5h())}};this.Ogh=new DOMParser;this.xvj=!0;this.grid=wa.g(oa);this.pjc=!0}get Fw(){return"PopulatePivotTableContextMenu"}get CB(){return r.a.OKf}executeCommand(oa,fb,Eb){fb=fb.command;oa=null;this.grid=wa.g(this.$);this.activeCell=K.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.nc=this.grid.Db.ap(this.grid.ha.sa.activeCell),!this.nc))return e.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
F.TaskExtensions.kaa();this.rZd=this.$.pa.va;this.K_a=Object(Mb.a)(Wa.a,Eb.eventArgs);switch(fb){case 671488277:this.hxj()?this.SSh():(this.$ab(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.ZQa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.ZQa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.ZQa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.ZQa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.ZQa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.ZQa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Eb=Number.parseInvariant(Eb.MenuItemId.split(".")[2]);this.ZQa(11,Eb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.xd(-1556797033,z.a.Eb,8,null);break;case 1514686611:this.kqi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Eb=Number.parseInvariant(Eb.MenuItemId);this.xXg(Eb);break;case 1778578888:Eb=Number.parseInvariant(Eb.MenuItemId);this.MJg(Eb);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:oa=fa.a(fb)}return oa||F.TaskExtensions.kaa()}Ec(oa,fb){oa=!1;switch(fb.command){case 671488277:oa=
Md.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:oa=!0;break;case 1600778266:oa=!0;break;case -556893687:oa=!0;break;case -1966978671:oa=!0;break;case -1951357930:oa=!0;break;case -1390365353:case -1457478532:oa=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:oa=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:oa=
!0;break;case -1007663920:case 234234584:case 1194992911:oa=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:oa=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:oa=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return oa}hxj(){if(!this.$.isEditMode||this.nc.zec)return!1;let oa=this.I0f(!1);return da.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.nc.isOlap||oa:!this.nc.Hnd()||oa}Qc(oa,fb){let Eb=!1;switch(fb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:Eb=this.IR();break;case -1007663920:case 234234584:Eb=this.Ovj()||this.IR();break;case 1194992911:Eb=this.Pvj()||this.IR();break;case 1217404289:Eb=!Pd.j(this.ub.LabelOrDateFilterType)||
this.IR();break;case -743135194:Eb=!Pd.m(this.ub.ValueFilterType)&&!Pd.l(this.ub.ValueFilterType)||this.IR();break;case 771421327:Eb=0===this.ub.LabelOrDateFilterType&&0===this.ub.ValueFilterType&&!this.ub.HasManualFilter||this.IR();break;case 1015867427:Eb=!Pd.i(this.ub.LabelOrDateFilterType)||this.IR();break;case 1105960559:Eb=!Pd.k(this.ub.LabelOrDateFilterType)||this.IR()}return Eb||super.Qc(oa,fb)}$ab(){this.q$a=this.ub=this.we=null}XSd(){this.grid.aT(this.Iq);this.$.Ka.SXa(this.gy)}MWd(){this.grid.NN(this.Iq);
this.$.Ka.xHb(this.gy)}IJb(){if(this.nc&&this.nc.Oo){this.we=this.nc.Oo;this.ub=this.nc.W9b();if(this.v1f()){const oa=this.nc.XK[4===this.we.CellType?this.nc.H3c-1:this.we.CurrentFieldIndex-1];oa&&(this.q$a=-2===oa.Index?this.nc.DEe:oa.Caption)}this.d9h();this.ub&&8===this.we.CellArea&&(this.eA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.ub.DataFieldAggregationType,this.eA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.ub.DataFieldFormatType,this.eA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=
this.ub.BaseFieldIndex,this.eA.PivotValueFieldTitle=this.ub.Caption)}}I0f(oa){return this.nc?this.nc.isOlap&&!this.nc.dMa(!oa):!1}Wvj(){const oa=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.ub.MeasureType&&(!this.nc.Xef||oa&&2===this.ub.MeasureType)}fY(){const oa=this.Sa.pq(this.menuId),fb=this.Sa.Bc(),Eb=wa.g(this.$).Xb(null);if(this.nc)this.we&&this.nc.Oo&&this.we!==this.nc.Oo&&e.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),
this.ub&&this.ub!==this.nc.W9b()&&e.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return oa;this.TDh(oa);if(this.$.isEditMode){this.refresh&&this.lFh(oa);if(this.we&&this.ub){var jc=this.Sa.Bc();this.AFh(jc);this.iEh(jc);oa.pc.push(jc)}this.xY&&fb.buttons.push(this.Sa.pb(99));this.we&&this.ub&&this.HEh(oa);if(this.expandCollapse){jc=this.Sa.Su("ContextMenu.PivotExpandCollapse",null,S.a.instance.ga(1161),589118293);const Hc=this.Sa.Bc();Hc.buttons.push(this.Sa.pb(243));
Hc.buttons.push(this.Sa.pb(244));Hc.buttons.push(this.Sa.pb(245));Hc.buttons.push(this.Sa.pb(246));jc.menu.pc.push(Hc);jc&&0<Hc.buttons.length&&fb.buttons.push(jc)}this.we&&(jc=this.Sa.Bc(),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.SEh(jc),this.mFh(jc),0<jc.buttons.length&&oa.pc.push(jc));this.we&&this.ub&&8===this.we.CellArea&&8!==this.we.CellType&&(jc=this.Sa.Bc(),this.Wvj()&&this.CFh(jc),3!==this.we.CellType&&this.xFh(jc),oa.pc.push(jc));
!this.nc.isOlap&&""!==(null===Eb||void 0===Eb?void 0:Eb.text)&&this.we&&0===this.we.CellType&&da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.wFh(oa);this.Fji()?fb.buttons.push(this.Sa.pb(257)):fb.buttons.push(this.Sa.pb(258));this.mmd?fb.buttons.push(this.Sa.pb(59)):fb.buttons.push(this.Sa.pb(58))}oa.pc.push(fb);return oa}pRa(){return this.ub&&this.ub.Caption?20<this.ub.Caption.length:!1}pJa(oa){return this.ub&&this.ub.Caption?oa?this.ub.Caption.substring(0,
20)+"...":this.ub.Caption:""}Gua(oa){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Ge.a.hashCode(oa).toString():oa}AFh(oa){if(this.we&&this.ub&&4!==this.we.CellArea){var fb=this.yia(this.lH("PivotTableContextMenu.Sort",this.Gua(this.ub.Caption)),-1777747317,0,0!==this.ub.SortInfo,S.a.instance.ga(229)),Eb=this.Sa.Bc();Eb.buttons.push(this.Qd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.ub.SortInfo,S.a.instance.ga(230)));Eb.buttons.push(this.Qd("PivotTableContextMenu.SortDescending",
234234584,0,2===this.ub.SortInfo,S.a.instance.ga(231)));1!==this.we.CellArea&&2!==this.we.CellArea||Eb.buttons.push(this.Qd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.ub.SortInfo||4===this.ub.SortInfo,S.a.instance.ga(156)));fb.menu.pc.push(Eb);fb&&0<Eb.buttons.length&&oa.buttons.push(fb)}}iEh(oa){if(this.we&&this.ub&&(1===this.we.CellArea||2===this.we.CellArea)){var fb=this.gxj();const qd=this.yia(this.lH("PivotTableContextMenu.Filter",this.Gua(this.ub.Caption)),-1777747317,0,fb,S.a.instance.ga(656)),
zd=this.Sa.Bc();var Eb="",jc=this.pRa(),Hc=String.format(S.a.instance.mb(156),this.pJa(jc));jc&&(Eb=String.format(S.a.instance.mb(156),this.ub.Caption));fb=this.Gua(this.ub.Caption)+"."+(fb?"enabled":"disabled");Eb=this.Qd(this.lH(hd,fb),771421327,0,!1,Hc,"0",Eb,8,Ba.a.G1a);fb=this.Gua(this.ub.Caption)+"."+this.ub.LabelOrDateFilterType.toString();this.ub.IsDateField?(Hc=this.yia(this.lH("PivotTableContextMenu.DateFilter",fb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,S.a.instance.ga(97)),this.XDh(Hc.menu)):
(Hc=this.yia(this.lH("PivotTableContextMenu.LabelFilter",fb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,S.a.instance.ga(654)),this.GEh(Hc.menu));fb=this.Gua(this.ub.Caption)+"."+this.ub.ValueFilterType.toString();fb=this.yia(this.lH("PivotTableContextMenu.ValueFilter",fb),-1777747317,0,0!==this.ub.ValueFilterType,S.a.instance.ga(655));this.OFh(fb.menu);jc=this.Sa.Bc();jc.buttons.push(this.Qd("PivotTableContextMenu.ManualFilter",1514686611,0,this.ub.HasManualFilter,S.a.instance.ga(94)));zd.buttons.push(Eb);
zd.buttons.push(Hc);zd.buttons.push(fb);qd.menu.pc.push(zd);qd.menu.pc.push(jc);qd&&0<zd.buttons.length&&oa.buttons.push(qd)}}XDh(oa){oa.pc.push(this.r$b(!0,!1));oa.pc.push(this.kLh());oa.pc.push(this.jLh());oa.pc.push(this.aNh());oa.pc.push(this.dNh());oa.pc.push(this.bNh());oa.pc.push(this.cNh());oa.pc.push(this.eNh());oa.pc.push(this.fNh());oa.pc.push(this.YKh())}LDh(oa){oa.pc.push(this.r$b(!0,!0));oa.pc.push(this.QTh());oa.pc.push(this.aRh())}GEh(oa){oa.pc.push(this.r$b(!0,!1));oa.pc.push(this.oXe(!0));
oa.pc.push(this.HHh());oa.pc.push(this.hKh());oa.pc.push(this.mWe(!0));oa.pc.push(this.uVe(!0))}OFh(oa){oa.pc.push(this.r$b(!1,!1));oa.pc.push(this.oXe(!1));oa.pc.push(this.mWe(!1));oa.pc.push(this.uVe(!1));oa.pc.push(this.wYh())}wYh(){const oa=this.Sa.Bc();oa.buttons.push(this.Qd("PivotTableContextMenu.Top10",-1611233597,0,Pd.l(this.ub.ValueFilterType),S.a.instance.ga(105)));return oa}hKh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.Contains",786260386,0,10===
this.ub.LabelOrDateFilterType,S.a.instance.ga(657),"10")),oa.buttons.push(this.Qd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.ub.LabelOrDateFilterType,S.a.instance.ga(658),"11")));return oa}HHh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.ub.LabelOrDateFilterType,S.a.instance.ga(659),"6")),oa.buttons.push(this.Qd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.ub.LabelOrDateFilterType,S.a.instance.ga(660),
"7")),oa.buttons.push(this.Qd("PivotTableContextMenu.EndsWith",786260386,0,8===this.ub.LabelOrDateFilterType,S.a.instance.ga(661),"8")),oa.buttons.push(this.Qd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.ub.LabelOrDateFilterType,S.a.instance.ga(662),"9")));return oa}oXe(oa){const fb=this.Sa.Bc();if(this.ub){const Eb=oa?Pd.c:Pd.f;fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.Equals",Eb),786260386,0,oa?4===this.ub.LabelOrDateFilterType:18===this.ub.ValueFilterType,S.a.instance.ga(100),
oa?"4":"18"));fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.DoesNotEqual",Eb),786260386,0,oa?5===this.ub.LabelOrDateFilterType:19===this.ub.ValueFilterType,S.a.instance.ga(101),oa?"5":"19"))}return fb}mWe(oa){const fb=this.Sa.Bc();if(this.ub){const Eb=oa?Pd.c:Pd.f;fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.GreaterThan",Eb),786260386,0,oa?12===this.ub.LabelOrDateFilterType:20===this.ub.ValueFilterType,S.a.instance.ga(102),oa?"12":"20"));fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.GreaterThanOrEqualTo",
Eb),786260386,0,oa?13===this.ub.LabelOrDateFilterType:21===this.ub.ValueFilterType,S.a.instance.ga(663),oa?"13":"21"));fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.LessThan",Eb),786260386,0,oa?14===this.ub.LabelOrDateFilterType:22===this.ub.ValueFilterType,S.a.instance.ga(103),oa?"14":"22"));fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.LessThanOrEqualTo",Eb),786260386,0,oa?15===this.ub.LabelOrDateFilterType:23===this.ub.ValueFilterType,S.a.instance.ga(664),oa?"15":"23"))}return fb}uVe(oa){const fb=
this.Sa.Bc();if(this.ub){const Eb=oa?Pd.c:Pd.f;fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.Between",Eb),786260386,0,oa?16===this.ub.LabelOrDateFilterType:24===this.ub.ValueFilterType,S.a.instance.ga(104),oa?"16":"24"));fb.buttons.push(this.Qd(this.lH("PivotTableContextMenu.NotBetween",Eb),786260386,0,oa?17===this.ub.LabelOrDateFilterType:25===this.ub.ValueFilterType,S.a.instance.ga(665),oa?"17":"25"))}return fb}r$b(oa,fb){const Eb=this.Sa.Bc();if(this.ub){var jc=S.a.instance.ga(98);const qd=
oa?this.ub.LabelOrDateFilterType.toString():this.ub.ValueFilterType.toString();var Hc=["PivotTableContextMenu.ClearFilter",this.Gua(this.ub.Caption),qd];oa=oa?this.ub.IsDateField?fb?1015867427:1105960559:1217404289:-743135194;Hc.push(oa.toString());Hc=Hc.join(".");jc=this.Qd(Hc,oa,0,!1,jc,qd,jc,8,Ba.a.G1a);Eb.buttons.push(jc)}return Eb}kLh(){const oa=this.Sa.Bc();this.ub&&oa.buttons.push(this.Qd(this.lH("PivotTableContextMenu.Equals",Pd.d),786260386,0,26===this.ub.LabelOrDateFilterType,S.a.instance.ga(100),
"26"));return oa}jLh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.Before",786260386,0,27===this.ub.LabelOrDateFilterType,S.a.instance.ga(112),"27")),oa.buttons.push(this.Qd("PivotTableContextMenu.After",786260386,0,28===this.ub.LabelOrDateFilterType,S.a.instance.ga(113),"28")),oa.buttons.push(this.Qd("PivotTableContextMenu.Between",786260386,0,29===this.ub.LabelOrDateFilterType,S.a.instance.ga(104),"29")));return oa}aNh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.Tomorrow",
1778578888,0,30===this.ub.LabelOrDateFilterType,S.a.instance.ga(110),"30")),oa.buttons.push(this.Qd("PivotTableContextMenu.Today",1778578888,0,31===this.ub.LabelOrDateFilterType,S.a.instance.ga(109),"31")),oa.buttons.push(this.Qd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.ub.LabelOrDateFilterType,S.a.instance.ga(111),"32")));return oa}dNh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.ub.LabelOrDateFilterType,S.a.instance.ga(115),
"33")),oa.buttons.push(this.Qd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.ub.LabelOrDateFilterType,S.a.instance.ga(114),"34")),oa.buttons.push(this.Qd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.ub.LabelOrDateFilterType,S.a.instance.ga(116),"35")));return oa}bNh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.ub.LabelOrDateFilterType,S.a.instance.ga(117),"36")),oa.buttons.push(this.Qd("PivotTableContextMenu.ThisMonth",
1778578888,0,37===this.ub.LabelOrDateFilterType,S.a.instance.ga(118),"37")),oa.buttons.push(this.Qd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.ub.LabelOrDateFilterType,S.a.instance.ga(119),"38")));return oa}cNh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.ub.LabelOrDateFilterType,S.a.instance.ga(120),"39")),oa.buttons.push(this.Qd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.ub.LabelOrDateFilterType,
S.a.instance.ga(121),"40")),oa.buttons.push(this.Qd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.ub.LabelOrDateFilterType,S.a.instance.ga(122),"41")));return oa}eNh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.NextYear",1778578888,0,42===this.ub.LabelOrDateFilterType,S.a.instance.ga(123),"42")),oa.buttons.push(this.Qd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.ub.LabelOrDateFilterType,S.a.instance.ga(124),"43")),oa.buttons.push(this.Qd("PivotTableContextMenu.LastYear",
1778578888,0,44===this.ub.LabelOrDateFilterType,S.a.instance.ga(125),"44")));return oa}fNh(){const oa=this.Sa.Bc();if(this.ub){oa.buttons.push(this.Qd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.ub.LabelOrDateFilterType,S.a.instance.ga(126),"45"));const fb=this.yia("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Pd.i(this.ub.LabelOrDateFilterType),S.a.instance.ga(127));this.LDh(fb.menu);oa.buttons.push(fb)}return oa}YKh(){const oa=this.Sa.Bc();this.ub&&oa.buttons.push(this.Qd("PivotTableContextMenu.CustomFilter",
786260386,0,this.dxj(this.ub.LabelOrDateFilterType),S.a.instance.ga(108),"26"));return oa}QTh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.ub.LabelOrDateFilterType,S.a.instance.ga(128),"46")),oa.buttons.push(this.Qd("PivotTableContextMenu.Quarter2",1778578888,0,47===this.ub.LabelOrDateFilterType,S.a.instance.ga(129),"47")),oa.buttons.push(this.Qd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.ub.LabelOrDateFilterType,S.a.instance.ga(130),
"48")),oa.buttons.push(this.Qd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.ub.LabelOrDateFilterType,S.a.instance.ga(131),"49")));return oa}aRh(){const oa=this.Sa.Bc();this.ub&&(oa.buttons.push(this.Qd("PivotTableContextMenu.January",1778578888,0,50===this.ub.LabelOrDateFilterType,S.a.instance.ga(132),"50")),oa.buttons.push(this.Qd("PivotTableContextMenu.February",1778578888,0,51===this.ub.LabelOrDateFilterType,S.a.instance.ga(133),"51")),oa.buttons.push(this.Qd("PivotTableContextMenu.March",
1778578888,0,52===this.ub.LabelOrDateFilterType,S.a.instance.ga(134),"52")),oa.buttons.push(this.Qd("PivotTableContextMenu.April",1778578888,0,53===this.ub.LabelOrDateFilterType,S.a.instance.ga(135),"53")),oa.buttons.push(this.Qd("PivotTableContextMenu.May",1778578888,0,54===this.ub.LabelOrDateFilterType,S.a.instance.ga(136),"54")),oa.buttons.push(this.Qd("PivotTableContextMenu.June",1778578888,0,55===this.ub.LabelOrDateFilterType,S.a.instance.ga(137),"55")),oa.buttons.push(this.Qd("PivotTableContextMenu.July",
1778578888,0,56===this.ub.LabelOrDateFilterType,S.a.instance.ga(138),"56")),oa.buttons.push(this.Qd("PivotTableContextMenu.August",1778578888,0,57===this.ub.LabelOrDateFilterType,S.a.instance.ga(139),"57")),oa.buttons.push(this.Qd("PivotTableContextMenu.September",1778578888,0,58===this.ub.LabelOrDateFilterType,S.a.instance.ga(140),"58")),oa.buttons.push(this.Qd("PivotTableContextMenu.October",1778578888,0,59===this.ub.LabelOrDateFilterType,S.a.instance.ga(141),"59")),oa.buttons.push(this.Qd("PivotTableContextMenu.November",
1778578888,0,60===this.ub.LabelOrDateFilterType,S.a.instance.ga(142),"60")),oa.buttons.push(this.Qd("PivotTableContextMenu.December",1778578888,0,61===this.ub.LabelOrDateFilterType,S.a.instance.ga(143),"61")));return oa}HEh(oa){const fb=this.Sa.Bc();if(this.v1f()){var Eb=this.nc.XK[4===this.we.CellType?this.nc.H3c-1:this.we.CurrentFieldIndex-1];if(Eb&&this.q$a){var jc=this.Sa.Su("ContextMenu.PivotTableLayout",null,S.a.instance.ga(652),-1777747317);var Hc=this.Sa.Bc();const qd=String.format(S.a.instance.mb(169),
this.q$a),zd=String.format(S.a.instance.mb(170),this.q$a);Hc.buttons.push(this.Qd(wd,-1457478532,0,!Eb.IsCompactLayout,qd));Hc.buttons.push(this.Qd(yd,-1390365353,0,Eb.IsCompactLayout,zd));jc.menu.pc.push(Hc);jc&&fb.buttons.push(jc)}}if(1===this.we.CellArea||2===this.we.CellArea)this.ub.Caption&&(Eb="",Hc=this.pRa(),jc=String.format(S.a.instance.mb(159),this.pJa(Hc)),Hc&&(Eb=String.format(S.a.instance.mb(159),this.ub.Caption)),1===this.we.CellArea?(Eb=this.yia("ContextMenu.PivotTableSubtotal",1801458190,
0,this.ub.ShowSubtotal,jc),jc=this.Sa.Bc(),jc.buttons.push(this.Sa.pb(259)),jc.buttons.push(this.Qd("ContextMenu.PivotTableSubtotalOnTop",671485366,644,this.ub.ShowSubtotal&&this.ub.ShowSubtotalAtTop)),jc.buttons.push(this.Qd("ContextMenu.PivotTableSubtotalOnBottom",772221736,645,this.ub.ShowSubtotal&&!this.ub.ShowSubtotalAtTop)),Eb.menu.pc.push(jc),Eb&&0<jc.buttons.length&&fb.buttons.push(Eb)):(Hc=Hc?this.lH(Uc,this.Gua(jc)):Uc,fb.buttons.push(this.Qd(Hc,1801458190,0,this.ub.ShowSubtotal,jc,null,
Eb)))),fb.buttons.push(this.Qd("ContextMenu.RepeatItemLabels",-556893687,647,this.ub.RepeatItemLabels));1===this.we.CellArea&&fb.buttons.push(this.Qd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,646,this.ub.ShowBlankLineAfterEachItem));oa.pc.push(fb)}wFh(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(247));oa.pc.push(fb)}SEh(oa){if(this.$.isEditMode&&this.grid){var fb=this.grid.ha.sa.activeRange;if(fb.top===fb.bottom&&fb.left===fb.right&&0!==this.we.MoveItemsMenuState){fb=this.yia("PivotTableContextMenu.Move",
-1777747317,0,!1,S.a.instance.ga(73));var Eb=this.Sa.Bc();this.gua(Eb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(S.a.instance.mb(162),this.we.MoveItemName),0===(this.we.MoveItemsMenuState&1));this.gua(Eb,"PivotTableContextMenu.MoveUp",713270357,String.format(S.a.instance.mb(163),this.we.MoveItemName),0===(this.we.MoveItemsMenuState&2));this.gua(Eb,"PivotTableContextMenu.MoveDown",-1842411134,String.format(S.a.instance.mb(160),this.we.MoveItemName),0===(this.we.MoveItemsMenuState&
4));this.gua(Eb,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(S.a.instance.mb(161),this.we.MoveItemName),0===(this.we.MoveItemsMenuState&8));this.gua(Eb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(S.a.instance.mb(167),this.pJa(this.pRa())),0===(this.we.MoveItemsMenuState&16));this.gua(Eb,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(S.a.instance.mb(164),this.pJa(this.pRa())),0===(this.we.MoveItemsMenuState&32));this.gua(Eb,"PivotTableContextMenu.MoveDataItemDown",
833996216,String.format(S.a.instance.mb(165),this.pJa(this.pRa())),0===(this.we.MoveItemsMenuState&64));this.gua(Eb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(S.a.instance.mb(166),this.pJa(this.pRa())),0===(this.we.MoveItemsMenuState&128));fb.menu.pc.push(Eb);oa.buttons.push(fb)}}}mFh(oa){var fb="";let Eb="";var jc=!1;3===this.we.CellType?fb=S.a.instance.ga(649):8===this.we.CellType?this.nc&&(fb=String.format(S.a.instance.mb(168),this.nc.DEe)):this.ub&&((jc=this.pRa())&&(Eb=
String.format(S.a.instance.mb(168),this.ub.Caption)),fb=String.format(S.a.instance.mb(168),this.pJa(jc)));fb&&(jc=jc?this.lH(pc,this.Gua(fb)):pc,fb=this.Qd(jc,-1951357930,0,!1,fb,null,Eb,8,Ba.a.d8c),oa.buttons.push(fb))}TDh(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(43));this.ub&&this.we&&this.$.isEditMode&&(0===this.we.CellType||4===this.we.CellType)&&fb.buttons.push(this.Sa.pb(136));oa.pc.push(fb)}lFh(oa){const fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(100));oa.pc.push(fb)}CFh(oa){const fb=
2===this.ub.MeasureType&&!this.ub.IsNumeric,Eb=this.Sa.Su("ContextMenu.SummarizeValuesBy",null,S.a.instance.ga(650),-249874296),jc=this.Sa.Bc();jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesBySum",-1255320719,1100,0===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,fb));jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByCount",1746132849,1101,1===this.ub.DataFieldAggregationType));jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByAverage",-771066011,1102,2===this.ub.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,fb));jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByMax",835007294,1103,3===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,fb));jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByMin",929115636,1104,4===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,fb));jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByProduct",1935475057,1105,5===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.I0f(!0)||
fb));2!==this.ub.MeasureType&&(jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1106,6===this.ub.DataFieldAggregationType)),jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1107,7===this.ub.DataFieldAggregationType)),jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1108,8===this.ub.DataFieldAggregationType)),jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByVariant",1668427539,1109,9===this.ub.DataFieldAggregationType)),
jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1110,10===this.ub.DataFieldAggregationType)));this.nc&&this.nc.Hnd()&&jc.buttons.push(this.Qd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1111,11===this.ub.DataFieldAggregationType));Eb.menu.pc.push(jc);oa.buttons.push(Eb)}xFh(oa){const fb=this.Sa.Su("ContextMenu.ShowValuesAs",null,S.a.instance.ga(651),-1128612833),Eb=this.Sa.Bc();Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsNoCalculation",-841863025,
1117,0===this.ub.DataFieldFormatType));Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1124,7===this.ub.DataFieldFormatType));Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1123,6===this.ub.DataFieldFormatType));Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1122,5===this.ub.DataFieldFormatType));Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1127,9===this.ub.DataFieldFormatType));
Eb.buttons.push(this.Qd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1128,10===this.ub.DataFieldFormatType));if(this.nc&&this.nc.XK&&0<this.nc.XK.length||this.nc.R9&&0<this.nc.R9.length){const jc=this.yia("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1129,11===this.ub.DataFieldFormatType),Hc=this.Sa.Bc(),qd=this.BFh();for(let zd=0;zd<qd.length;zd++){const Hd=qd[zd];Hc.buttons.push(this.Qd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Hd.Caption,-2031744961,1129,11===this.ub.DataFieldFormatType&&
this.ub.BaseFieldIndex===Hd.Index,Hd.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Hd.Index))}jc.menu.pc.push(Hc);Eb.buttons.push(jc)}fb.menu.pc.push(Eb);oa.buttons.push(fb)}showPivotTableContextMenu(){this.mmd=!0;this.expandCollapse=this.xY=this.refresh=!1;var oa=this.$,fb=wa.g(oa),Eb=Ra.a(oa).GJa();if(Eb){var jc=Lb.a(oa);if(null===jc||void 0===jc?0:jc.APd)this.mmd=Qb.f(oa.pg);jc=oa.jc;this.xY=Eb.supportsBIExplore&&!!mb.a(oa)&&jc.O1(32768);jc.allowInteractivity&&(oa=fb.Xb(null),(null===
oa||void 0===oa?0:oa.cell)&&(oa.cell.YXc||oa.cell.s1f)&&(this.expandCollapse=!0),jc.allowManualDataRefresh&&(this.refresh=!0))}oa=null;Eb=1;this.K_a&&1!==this.K_a.tb?(oa=new Sys.UI.Point(this.K_a.clientPoint.x,this.K_a.clientPoint.y),Eb=this.K_a.tb):(fb=Md.e(fb,this.$))&&(oa=new Sys.UI.Point(fb.x+(this.$.isChromeRtl?0:fb.width),fb.y+fb.height));z.a.Eb=Eb;this.Egc=3===Eb;this.xp(oa,!0,Eb);this.Vaa=!0;this.XSd()}u5h(){const oa=new R.a(1114549926,0,this.$.Mc,19,null);this.$.Ka.Lb(oa)}SSh(){if(this.nc&&
this.nc.Oo){var oa=this.nc.Oo.CurrentCol;if(this.nc.Oo.CurrentRow===this.activeCell.FirstRow&&oa===this.activeCell.FirstColumn){this.IJb();this.showPivotTableContextMenu();return}}oa=new T.a(228,0,(fb,Eb,jc)=>ue.k(this.$.pa.va,this.activeCell,V.b(fb,this.QKi),V.a(Eb,this.PKi),jc,null),16);this.$.userOperationManager.Ub(oa,null)}Fji(){if(rb.a.zd(this.$)){var oa=this.$.da.za(441);if(oa)return oa.Or}else if(oa=this.$.da.za(346))return oa.Or;return!1}lH(oa,fb){return oa+"."+fb}performPivotTableOperation(oa,
fb){const Eb=je.a.Wa.Nb;if(!this.nc||!this.ub&&this.we&&3!==this.we.CellType)this.nj();else{var jc=this.nc.isOlap;Ra.a(this.$).yx(jc,Hc=>{Hc&&this.$.Ub(oa,(qd,zd,Hd)=>ge(this.rZd,this.activeCell,fb,this.ub?this.ub.Caption:null,this.q$a,V.b(qd,this.DOi),V.a(zd,this.COi),Hd,null,this.$.pa.va.Qb()),Eb,0,4,229)})}}applyValueFieldSettingsToPivotTable(oa,fb=!1){const Eb=je.a.Wa.Nb;this.nc&&this.ub?(fb&&2===this.ub.MeasureType&&e.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
fb=this.nc.isOlap,Ra.a(this.$).yx(fb,jc=>{jc&&this.$.Ub(oa,(Hc,qd,zd)=>pe(this.rZd,this.activeCell,this.eA,V.b(Hc,this.tFi),V.a(qd,this.sFi),zd,null,this.$.pa.va.Qb()),Eb,0,4,231)})):this.nj()}Qd(oa,fb,Eb,jc,Hc=null,qd=null,zd=null,Hd=8,Yd=null,se=!1){jc&&(oa+=".Checked");se&&(oa+=".Disabled");this.Sa.ald(oa)&&this.Sa.aHd(oa);Eb=Hc||S.a.instance.ga(Eb);oa=this.Sa.RGa(oa,Eb,fb,null,"None",qd,se,null);oa.nuc(null);zd&&oa.ER(zd);jc?oa.GR("Image16by16",3,Ba.a.z$):Yd?oa.GR("Image16by16",Hd,Yd):oa.N0b();
return oa}yia(oa,fb,Eb,jc,Hc=null){Eb=Hc||S.a.instance.ga(Eb);this.Sa.ald(oa)?this.Sa.aHd(oa):this.Sa.aHd(oa+".Checked");jc&&(oa+=".Checked");this.xvj&&(Eb=this.Ogh.parseFromString(Eb,"text/html").body.innerText);oa=this.Sa.P1c(oa,null,Eb,fb,3,Ba.a.z$);oa.p8e=jc;!jc&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&oa.N0b();return oa}d9h(){this.eA=Object(f.a)(new Wc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new id,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new Mc,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}ZQa(oa,fb){this.eA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=oa;this.eA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=fb;this.eA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}BFh(){const oa=[];if(this.nc&&this.nc.R9&&0<this.nc.R9.length)for(const fb of this.nc.R9)fb&&oa.push(fb);if(this.nc&&this.nc.XK&&0<this.nc.XK.length)for(const fb of this.nc.XK)fb&&oa.push(fb);oa.sort((fb,
Eb)=>fb.Index-Eb.Index);return oa}v1f(){if(!this.we||!this.nc||!this.nc.XK)return!1;const oa=1===this.we.CellArea||4===this.we.CellType&&this.we.IsRowAxis,fb=4===this.we.CellType?0<this.nc.H3c:0<this.we.CurrentFieldIndex;return 1<this.nc.XK.length&&oa&&fb}rJa(oa){const fb=[];3===oa?this.$.isEditMode?fb.push(...[ta.a.JFf,ta.a.LFf,ta.a.jXi]):fb.push(...[ta.a.copy]):2===oa&&fb.push(ta.a.Uve);return fb}nj(){const oa=U.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");ic.a(this.$).nj(oa)}gxj(){return this.ub?
0!==this.ub.LabelOrDateFilterType||0!==this.ub.ValueFilterType||this.ub.HasManualFilter:!1}dxj(oa){return 62<=oa&&65>=oa}kqi(){if(this.activeCell&&this.ub&&this.nc){var oa={};oa.cell=this.activeCell;oa.dataSourceIndex=this.nc.externalSourceIndex;oa.fieldId=this.ub.Index.toString();oa.isOlap=this.nc.isOlap;oa.confirmationRequired=this.nc.confirmationRequiredForDataOps;var fb={};fb.showPivotFilterDialogCommandData=oa;this.$.xd(492140419,z.a.Eb,19,fb)}}xXg(oa){this.activeCell&&this.ub&&this.nc&&this.$.userOperationManager.Ub(new T.a(153,
0,(fb,Eb,jc)=>W.B(this.$.pa.va,this.activeCell,this.nc.externalSourceIndex,this.ub.Index.toString(),oa,fb,Eb,jc,null,null)),null)}MJg(oa){!(30>oa||61<oa)&&this.activeCell&&this.ub&&this.nc&&this.$.userOperationManager.Ub(new T.a(152,0,(fb,Eb,jc)=>W.e(this.$.pa.va,this.activeCell,this.nc.externalSourceIndex,this.ub.Index.toString(),oa,fb,Eb,jc,null,null)),null)}applyPivotSort(oa){if(this.nc&&this.ub&&this.activeCell&&this.we){var fb=1===this.we.CellArea||2===this.we.CellArea;8===this.we.CellArea?he.a(this.$.userOperationManager,
(Eb,jc,Hc)=>ue.b(this.$.pa.va,this.activeCell,oa,this.ub.Caption,Eb,jc,Hc,null),Eb=>new T.a(1015,0,Eb,void 0,null),null):fb&&(fb=1===this.we.CellArea?1:2,this.$.ma(689)?Qd.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.nc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.nc.isOlap?"":this.ub.Caption,fb,1===oa):Qd.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.nc.externalSourceIndex,this.ub.Index.toString(),1===
oa))}}IR(){return!this.nc||!this.nc.isActionable}Ovj(){return(this.we||this.nc)&&4!==this.we.CellType&&(0!==this.we.CellType||8!==this.we.CellArea||this.nc.R9&&this.nc.R9.length||this.nc.XK&&this.nc.XK.length)?!1:!0}Pvj(){return this.we&&this.nc&&(1===this.we.CellArea||2===this.we.CellArea)&&this.nc.ZNb&&this.nc.ZNb.length?!1:!0}gua(oa,fb,Eb,jc,Hc){oa.buttons.push(this.Qd(fb,Eb,0,!1,jc,null,null,8,null,Hc))}}Object(c.a)(I,"PivotTableContextMenu",w.a,[]);class xa{compare(oa,fb){return(oa||"").localeCompare(fb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(xa,"DigitsAsNumberComparer",null,[314]);var Ua=a(1076),vb=a(153),cb=a(340),Xb=a(261),rc=a(24),Ec=a(182);const ed=r.a.w1g;class ud extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateTableFieldListContextMenu",-751848458,-1085236154,ed,!0,!1,"TableFieldListContextMenuRoot",fb,Eb,!1,jc);this.z3b=null;this.cxd=0;this.PDa=null;this.grid=wa.g(oa)}get Fw(){return"PopulateTableFieldListContextMenu"}get CB(){return r.a.QKf}get LK(){this.PDa||(this.PDa=
this.$.da.za(261));return this.PDa}executeCommand(oa,fb,Eb){oa=fb.command;switch(oa){case 639960842:this.applyTableFieldList(Eb);this.LK.Nca();break;case -1085236154:e.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.cxd}`);this.LK.Nca();break;case 1833782813:this.LK.showCallout();break;default:return fa.a(oa)}return Ja.Task.Ua(!0)}applyTableFieldList(oa){var fb=oa.MenuItemId.toString();da.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(fb=fb.replace("'","''"),fb=fb.replace("[","'["),fb=fb.replace("]","']"));var Eb=Object(Mb.a)(String,oa.SourceControlId);const jc={};jc.PulloutField=fb;jc.PulloutCardPath=oa.SourceCardKeyPath;jc.PulloutCardSourceRow=oa.SourceCardRow;jc.PulloutCardSourceColumn=oa.SourceCardColumn;if(this.LK.$M){e.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");jc.ParameterType=2;oa=oa.ColumnIndex;if(void 0===oa||null===oa){if(void 0===Eb||null===Eb){e.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}oa=0<=this.LK.RIf?this.LK.RIf:parseInt(Eb.substring(20+fb.length+1,Eb.length),10);if(isNaN(oa)){e.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${Eb}`);return}}jc.PulloutRichColumnSourceIndex=oa;if(this.PDa.mHg){this.$Hg(fb,jc);return}}else e.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),jc.ParameterType=4,Eb=this.LK.selectedRange.right,rb.a.Qxb()&&this.PDa.Dld&&(jc.ParameterType=8,oa=this.LK.Nka.top,oa=
rc.Range.uP(Eb)+oa,fb==Ua.f?(fb="=DAYS("+oa+", TODAY())",Ec.a("DateFormulaPulledOut_DaysFromToday")):fb==Ua.i?(fb="=IF(TODAY() < "+oa+", NETWORKDAYS(TODAY(), "+oa+"), NETWORKDAYS("+oa+", TODAY()))",Ec.a("DateFormulaPulledOut_WeekdaysFromToday")):fb==Ua.j?(fb="=IF(TODAY() < "+oa+", DATEDIF(TODAY(), "+oa+', "Y"), DATEDIF('+oa+', TODAY(), "Y"))',Ec.a("DateFormulaPulledOut_YearsFromToday")):fb==Ua.e?(fb="=TEXT("+oa+', "dddd")',Ec.a("DateFormulaPulledOut_DayOfWeek")):fb==Ua.h?(fb="=TEXT("+oa+', "mmmm")',
Ec.a("DateFormulaPulledOut_MonthOfYear")):fb==Ua.g?(fb="EOMONTH("+oa+", 0)",fb="=DATE(YEAR("+fb+"), MONTH("+fb+"), DAY("+fb+"))",Ec.a("DateFormulaPulledOut_EndOfMonth")):fb==Ua.c?(fb="EDATE("+oa+", 1)",fb="=DATE(YEAR("+fb+"), MONTH("+fb+"), DAY("+fb+"))",Ec.a("DateFormulaPulledOut_AddOneMonth")):fb==Ua.d?(fb="="+oa+" + 7",Ec.a("DateFormulaPulledOut_AddOneWeek")):fb==Ua.b&&(fb="="+oa+" + 1",Ec.a("DateFormulaPulledOut_AddOneDay"))),void 0!==jc.PulloutCardSourceColumn&&null!==jc.PulloutCardSourceColumn&&
(Eb=jc.PulloutCardSourceColumn+1),jc.PulloutRichColumnSourceIndex=Eb;this.iNd(fb,jc)}iNd(oa,fb,Eb=0){e.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.cxd}, SelectedColumnIndex, ${fb.PulloutRichColumnSourceIndex}`);oa=Object(f.a)(new Xb.a,{Text:oa});this.grid.setCell(oa,this.LK.Nka,0,127,fb,Eb);this.grid.focus();this.z3b=null;this.LK.Nca();this.LK.tfj()}Ec(oa,fb,Eb){if(oa=this.$.isEditMode&&da.EwaSettings.ma(135)&&!!this.LK)switch(fb.command){case -1085236154:break;
case 639960842:oa=!!Eb;break;case 1833782813:oa=this.LK.Mva&&this.LK.DAb;break;default:oa=!1}return oa}Y_(oa,fb,Eb){this.$.isEditMode&&(this.z3b=this.NEh(Object(Mb.a)(306,Eb)),super.Y_(oa,fb,null,null,!1))}fY(){return this.z3b}O1c(oa){if(!this.LK||!oa||!oa.Pk)return e.ULS.shipAssertTag(537166994,0,!!this.LK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),e.ULS.shipAssertTag(537166993,0,!!oa,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),oa&&
e.ULS.shipAssertTag(537166992,0,!!oa.Pk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let fb=new Oa.a;for(const jc of oa.Pk){oa=new Oa.a;oa.add(jc.ColumnName);oa.add(jc.ColumnIndex.toString());let Hc=new Oa.a;var Eb=null;rb.a.Qxb()&&this.PDa.Dld?Hc=Qa.toList(Qa.select(Qa.asEnumerable(jc.FieldInfoDataList),qd=>qd.Name)):(Eb=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new xa:new ra.a,Hc=
Qa.OBc(Qa.concat(Hc,Qa.select(Qa.asEnumerable(jc.FieldInfoDataList),qd=>qd.Name)),qd=>qd,Eb));Eb=new Oa.a;Eb.add(Qa.toArray(Qa.concat(oa,Hc)));fb=Qa.toList(Qa.concat(fb,Eb))}return Qa.toArray(fb)}NEh(oa){var fb=this.O1c(oa);if(!fb||!fb.length)return this.z3b=null;oa=this.Sa;const Eb=oa.pq(this.menuId);let jc=oa.Bc();const Hc=1<fb.length,qd=rb.a.Qxb()&&this.PDa.Dld;this.cxd=fb.length;for(const zd of fb){qd?jc.title="Calculate Date Information":Hc||(jc.title=zd[0]);fb=oa.Bc();for(let Hd=2,Yd=zd.length;Hd<
Yd;++Hd)!qd||zd[Hd]!=Ua.f&&zd[Hd]!=Ua.g||(Eb.pc.push(jc),jc=oa.Bc()),(Hc?fb.buttons:jc.buttons).push(oa.RGa("ApplyTableFieldList."+zd[Hd]+"."+zd[1],zd[Hd],639960842,null,"None",zd[Hd],!1,void 0,!0));if(Hc){const Hd=oa.Su("ApplyTableFieldList."+zd[0],this.menuId,zd[0],798637440);Hd.menu.pc.push(fb);jc.buttons.push(Hd)}}Eb.pc.push(jc);return Eb}$Hg(oa,fb){const Eb=U.a.Yc(12,1,0,899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(da.EwaSettings.xz()){const jc=new cb.a(this.$,Eb);jc.aP(()=>{2===
jc.returnValue&&this.iNd(oa,fb,8)})}else{const jc=new vb.ErrorDialog(this.$,Eb);jc.aP(()=>{2===jc.returnValue&&this.iNd(oa,fb,8)});jc.xf()}}}Object(c.a)(ud,"PulloutFieldListContextMenu",w.a,[]);const Kd=r.a.SKf;class Zd extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateRichTextContextMenu",679816325,1151222423,Kd,!0,!1,Kd,fb,Eb,!0,jc);this.grid=wa.g(oa)}get Fw(){return"PopulateRichTextContextMenu"}get CB(){return r.a.SKf}Ec(oa,fb,Eb){return-1687037502===fb.command&&!!Eb&&this.grid.$a}executeCommand(oa,
fb,Eb){this.showRichTextFloatie(Eb);return Ja.Task.Ua(!0)}rJa(){return[ta.a.bVg]}showRichTextFloatie(oa){var fb=Object(Mb.a)(Wa.a,oa.eventArgs);fb&&(oa=this.rJa(fb.tb),fb=new Sys.UI.Point(fb.Ca.clientX,fb.Ca.clientY),this.showFloatie(oa,new Sys.UI.Bounds(fb.x,fb.y,0,0),2))}}Object(c.a)(Zd,"RichTextContextMenu",w.a,[]);var Xd=a(100),Je=a(570);const Xe=r.a.v1g;class Ke extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateSheetOpsContextMenu",274207288,-1497523576,Xe,!0,!1,"SheetTabContextMenuRootName",
fb,Eb,!1,jc);this.wgc=this.Vec=!1}get Fw(){return"PopulateSheetOpsContextMenu"}get CB(){return r.a.TKf}executeCommand(oa,fb,Eb){if(Ub.a(this.$))return Ja.Task.Ua(!0);this.$.isEditMode&&(oa=Eb[r.a.p0f],oa=oa.x&&oa.y?new Sys.UI.Point(oa.x+(this.$.isChromeRtl?10:-10),oa.y):va.DOMElementExtensions.getLocation(Eb[r.a.q0f]),this.xp(oa,!1));return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){return-1075099431===fb.command&&!!Eb}fY(){const oa=this.Sa.pq(this.menuId),fb=this.$.isEditMode;this.NSj();this.BEh(oa,fb);this.qEh(oa);
this.vFh(oa);return oa}oXb(oa,fb,Eb,jc){oa.push(this.Sa.pb(fb?Eb:jc))}BEh(oa,fb){var Eb=this.Sa;const jc=Eb.Bc();jc.buttons.push(Eb.pb(54));this.oXb(jc.buttons,this.wgc,127,56);jc.buttons.push(Eb.pb(55));fb&&this.oXb(jc.buttons,this.wgc,126,125);jc.buttons.push(Eb.pb(158));fb=this.$.xa.oa;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.jK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&fb&&fb.Fd&&(fb.Fd.mv||fb.Fd.KH||jc.buttons.push(Eb.pb(300)));
this.$.ea.rKb&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?l.AFrameworkApplication.Mod(Je.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(fb=Object(Mb.a)(Xd.a,this.$.oa))&&Ka.p(fb)&&this.$.isEditMode&&(jc.buttons.push(Eb.pb(277)),fb.isLockPausedInSession?jc.buttons.push(Eb.pb(279)):fb.ii&&jc.buttons.push(Eb.pb(278)));fb=Eb.Su("ContextMenu.TabColor",null,S.a.instance.ga(523),1841703919);Eb=Eb.L1c(467002767,1549407384,546,-221093529,this.CB);fb.menu.pc.push(Eb);
jc.buttons.push(fb);oa.pc.push(jc)}qEh(oa){const fb=this.Sa.Bc();this.oXb(fb.buttons,this.wgc,114,112);this.oXb(fb.buttons,!this.Vec,115,113);oa.pc.push(fb)}vFh(oa){if(da.EwaSettings.ma(480)&&!Ka.e(this.$.xa.oa)){var fb=this.Sa,Eb=fb.Bc();Eb.buttons.push(fb.pb(263));oa.pc.push(Eb)}}NSj(){let oa,fb;({x1c:oa,kBe:fb}=this.$.w1c());this.wgc=1===oa;this.Vec=0<fb}}Object(c.a)(Ke,"SheetOpsContextMenu",w.a,[]);var Qe=a(512);class df extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateSlicerContextMenu",
-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",fb,Eb,!0,jc)}get Fw(){return"PopulateSlicerContextMenu"}get CB(){return r.a.UKf}Qc(oa,fb){var Eb=!0;switch(fb){case -231711729:Eb=!1;break;case -1909381757:Eb=this.sac();Eb=!!Eb&&Eb.Dgi;break;case 1312363469:Eb=!0}return!Eb||super.Qc(oa,fb)}executeCommand(oa,fb,Eb){if(!this.$.isEditMode)return F.TaskExtensions.kaa();oa=fb.command;fb=this.sac();let jc=null;switch(oa){case 2108047455:fb&&fb.Pxe();break;case -231711729:e.ULS.shipAssertTag(537166990,
0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:fb&&fb.V0b();break;case 1312363469:this.showSlicerContextMenu(Eb);break;default:jc=fa.a(oa)}return jc||F.TaskExtensions.kaa()}Ec(oa,fb,Eb){oa=!1;switch(fb.command){case -231711729:case 2108047455:case -1909381757:oa=!0;break;case 1312363469:oa=!!Eb}return oa}fY(){const oa=this.Sa.pq(this.menuId);var fb=this.Sa.Bc();fb.buttons.push(this.Sa.pb(252));fb.buttons.push(this.Sa.pb(253));fb.buttons.push(this.Sa.pb(254));oa.pc.push(fb);
fb=this.Sa.Bc();this.Qli()?fb.buttons.push(this.Sa.pb(266)):fb.buttons.push(this.Sa.pb(267));oa.pc.push(fb);return oa}Qli(){if(rb.a.zd(this.$)){var oa=this.$.da.za(439);if(oa)return oa.Or}else if(oa=this.$.da.za(371))return oa.Or;return!1}showSlicerContextMenu(oa){var fb=Object(Mb.a)(Wa.a,oa.eventArgs);oa=this.S9b(Object(Mb.a)(Wa.a,oa.eventArgs));fb=fb.tb;z.a.Eb=fb;this.xp(oa,!1,fb)}yUe(oa){const fb=this.Sa.Bc(),Eb=this.Sa.Bc();Eb.buttons.push(this.Sa.pb(255));Eb.buttons.push(this.Sa.pb(256));const jc=
this.Sa.P1c("ContextMenu.SlicerSort",null,S.a.instance.ga(2173),-814639094,0,Ba.a.vNe);jc.menu.pc.push(Eb);fb.buttons.push(jc);oa.pc.push(fb)}wxj(oa){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&oa.Cb.className===Ba.a.O7c||da.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===oa.tb}S9b(oa){var fb=wa.g(this.$).ha.Oa.$b;let Eb=oa&&1!==oa.tb&&oa.clientPoint?oa.clientPoint:Sys.UI.DomElement.getLocation(fb.domElement);
if(this.wxj(oa)){var jc=this.sac();jc&&(oa.Cb.className===Ba.a.O7c&&(Eb=ib.HelperMethods.Wtb(oa.Ca)),1===oa.tb&&(Eb=la.a(this.$).Uia(va.DOMElementExtensions.getLocation(jc.frame))))}else if(oa=this.sac())oa=this.$Nh(oa.frame),(jc=ib.HelperMethods.VC(this.$.Bf,this.$.domElement,wa.g(this.$).rtl,!1))?(oa.x=la.a(this.$).ni(oa.x-jc.x)+jc.x,oa.y=la.a(this.$).ni(oa.y-jc.y)+jc.y):e.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),Eb.y+=oa.y,Eb.x+=oa.x;oa=this.$.domElement;jc=wa.g(this.$).rtl;
fb=ib.HelperMethods.VC(fb.jg.domElement,oa,jc);Eb.y=Math.max(Eb.y,fb.y);Eb.x=Math.max(Eb.x,fb.x);return Eb}sac(){const oa=wa.g(this.$).ha.Oa.$b;e.ULS.shipAssertTag(537166988,0,!!oa);return Qe.a(this.$).rH(oa.floatingObject.id)}$Nh(oa){let fb=new Sys.UI.Point(oa.offsetParent.offsetLeft,oa.offsetParent.offsetTop);var Eb=wa.g(this.$);if(!Eb)return fb;const jc=wa.g(this.$).rtl;fb=ib.HelperMethods.VC(oa,this.$.$q.ownerDocument.body,jc);Eb.cBe(fb);fb.x=jc?this.$.$q.clientWidth-fb.x-oa.clientWidth:fb.x;
oa=Eb.view.Znb;Eb=jc?-Eb.AR.Hba(oa.x):oa.x;fb.x-=Eb;fb.y-=oa.y;return fb}}Object(c.a)(df,"SlicerContextMenu",w.a,[]);class Ne{constructor(oa,fb,Eb){this.type=oa;this.t1g=fb;this.rr=Eb}}Object(c.a)(Ne,"TimeSlicerRibbonButtonParameter",null,[]);class jf extends w.a{constructor(oa,fb,Eb,jc){super(oa,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,jf.IIj,!0,!1,jf.uIb,fb,Eb,!1,jc);this.i0a=0;this.FIe=this.AJa=this.Ura=null}get Fw(){return"PopulateTimeSlicerLevelMenu"}get CB(){return r.a.XKf}executeCommand(oa,
fb,Eb){oa=fb.command;switch(oa){case 2000085697:oa=Eb.DOMElement;this.Ura=Eb.ChangeLevelCallback;this.AJa=Eb.GetLevelLabelCallback;this.i0a=Eb.CurrentLevel;const jc=Eb.DomEvent;M.g(jc);const Hc=Eb.location;Eb=Eb.levelLabelText;this.FIe=va.DOMElementExtensions.rz(document.activeElement,"iframe")&&Eb?Eb.parentNode:null;Eb=Sys.UI.DomElement.getBounds(Eb);Eb.x=Hc.x;Eb.y=Hc.y;this.Y_(jc,oa,Eb,fb,!0);break;case -649826274:this.Ura(0);break;case 149600865:this.Ura(1);break;case -2012435159:this.Ura(2);break;
case -1979934975:this.Ura(3);break;case 1634477200:va.DOMElementExtensions.setFocus(this.FIe);break;default:return fa.a(oa)}return Ja.Task.Ua(!0)}Ec(oa,fb,Eb){oa=!1;switch(fb.command){case 2000085697:oa=!!Eb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:oa=!0}return oa}Y_(oa,fb,Eb){oa=Sys.UI.DomElement.getBounds(fb);Eb.x=la.a(this.$).ni(Eb.x);Eb.y=la.a(this.$).ni(Eb.y);oa.x=la.a(this.$).ni(oa.x);oa.y=la.a(this.$).ni(oa.y);oa=new Sys.UI.Point(oa.x+Eb.x,oa.y+
Eb.y);this.showContextMenu(new Sys.UI.Bounds(oa.x,oa.y-Eb.height,Eb.width,Eb.height))}fY(){const oa=this.Sa,fb=oa.pq(this.menuId),Eb=oa.Bc();for(let Hc=0;3>=Hc;Hc++){const qd=this.AJa(Hc);var jc=jf.tIh(Hc);jc=oa.x3g(jc.t1g,jc.rr,this.i0a===Hc,jf.Rwe);jc.label=qd;jc.ER(qd);this.i0a===Hc?jc.GR("Image16by16",8,jf.Rwe):jc.N0b();Eb.buttons.push(jc)}fb.pc.push(Eb);return fb}static tIh(oa){let fb=null;switch(oa){case 0:fb=new Ne(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:fb=new Ne(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:fb=new Ne(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:fb=new Ne(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return fb}}jf.IIj=r.a.x1g;jf.uIb="TimeSlicerLevelMenuRootName";jf.Rwe=Ba.a.Jta;Object(c.a)(jf,"TimeSlicerLevelMenu",w.a,[]);var Le=a(312),me=a(3);class Za extends b.a{constructor(oa){super(oa)}Dd(){const oa=this.$,fb=eb.a.a0a(za.b(),this.la,"Task","IRootUser"),Eb=d.a(oa);let jc=null;jc=(zd,Hd)=>{Eb.EPf(jc);
fb.setResult(Hd.j2b)};Eb.vme(jc);Eb.j_e();const Hc=P.GetServiceTaskFactory.create(oa.da,102,oa.la,this.ib),qd=P.GetServiceTaskFactory.Ta(oa.da,342,338,this.ib);F.TaskExtensions.Aa(F.TaskExtensions.Xd([fb.task,Hc,qd],this.la),()=>{const zd=Hc.result,Hd=fb.task.result,Yd=qd.result;this.ld([new cc(oa,Hd,zd,Yd),new pb(oa,Hd,zd,Yd),new Ya(oa,Hd,zd,Yd),new wb(oa,Hd,zd,Yd),new gd(oa,Hd,zd,Yd),new Ta(oa,Hd,zd,Yd),new Ad.GridContextMenu(oa,Hd,zd,Yd),new Od(oa,Hd,zd,Yd),new Ke(oa,Hd,zd,Yd),new jf(oa,Hd,zd,
Yd),new ud(oa,Hd,zd,Yd),new qb(oa,Hd,zd,Yd),new I(oa,Hd,zd,Yd),new df(oa,Hd,zd,Yd),new Zd(oa,Hd,zd,Yd)])},oa.la,3)}static initData(){const oa=Le.a.I8;oa(2000085697,20479,0,0);oa(-227942804,me.a.yc|24576,0,0);oa(1634477200,me.a.yc|131072,0,0);oa(-649826274,4095,0,0);oa(149600865,4095,0,0);oa(-2012435159,4095,0,0);oa(-1979934975,4095,0,0);oa(1247109494,me.a.yc|24576,0,0);oa(-2064931494,me.a.yc|131072,0,0);oa(-1396319072,me.a.Ha,128,0);oa(-425234874,me.a.Ha,128,0);oa(-1253126584,me.a.Ha,0,0);oa(274207288,
me.a.yc|24576,0,0);oa(-1497523576,me.a.yc|131072,0,0);oa(-498523270,me.a.yc|24576,64,0);oa(1640762262,me.a.yc|131072,64,0);oa(-2017893763,me.a.yc|24576,0,0);oa(1350204367,me.a.yc|131072,0,0);oa(-889576107,me.a.Zv,128,0);oa(-1170196828,me.a.Zv,128,0);oa(389774337,me.a.Zv,128,0);oa(1529312473,me.a.Zv,128,0);oa(2033235475,me.a.Zv,128,0);oa(-96230454,me.a.Zv,128,0);oa(74086617,me.a.Zv,128,0);oa(563292088,me.a.Zv,128,0);oa(-1092351914,me.a.Zv,128,0);oa(-2141589616,me.a.Zv|16384,128,0);oa(745182485,me.a.Zv,
0,0);oa(359279088,me.a.Zv,128,0);oa(-67292059,me.a.Zv,128,0);oa(926905850,me.a.Zv,128,0);oa(547535945,me.a.Zv,128,0);oa(1374696078,me.a.yc|24576,0,0);oa(495005930,me.a.yc|212992,0,0);oa(-1045020714,me.a.yc|24576,0,0);oa(-170383950,me.a.yc|212992,0,0);oa(324156914,me.a.Ha,0,0);oa(-1085236154,me.a.Qu,0,0);oa(-751848458,me.a.rl|16384,0,0);oa(216058793,me.a.Qu,0,0);oa(474690375,me.a.rl|16384,0,0);oa(-1920954846,me.a.yc|24576,0,0);oa(723126814,me.a.yc|131072,0,0);oa(2108047455,128,128,0);oa(-231711729,
128,128,0);oa(-1909381757,128,128,0);oa(-814639094,128,128,0);oa(1701016594,me.a.yc|3072,128,0);oa(-1475408662,me.a.yc|24576,0,0);oa(1114549926,me.a.yc|131072,32,0)}static ka(oa){b.a.Rd(10,new Za(oa))}}Object(c.a)(Za,"ContextMenuCommandHandlerFactory",b.a,[]);var Tb=a(220),uc=a(1388),Oc=a(91),sb=a(238);class $b{constructor(oa,fb){this.Tpb=fb;this.$=oa}dispose(){}l$(){this.Tpb.J2()}MC(){this.Tpb.MC()}AQd(oa,fb,Eb){Md.h(this.$,Md.b);this.Tpb.showContextMenu(Object(f.a)(new uc.a,{x:fb.x,y:fb.y}),Eb,
oa);Oc.EventHandlerManager.instance.P$c()}$vc(oa,fb,Eb){Md.h(this.$,Md.b);this.Tpb.showFloatie(Object(f.a)(new uc.a,{x:fb.x,y:fb.y}),oa,Eb);sb.a(()=>{Oc.EventHandlerManager.instance.P$c()},this.$.la)}zQd(oa,fb,Eb,jc){Md.h(this.$,Md.b);this.Tpb.zQd(Object(f.a)(new uc.a,{x:fb.x,y:fb.y}),oa,Eb,jc)}}Object(c.a)($b,"ReactContextMenuController",null,[255,3]);class xc extends Tb.a{constructor(oa){super();this.b9e=!1;this.Cjd=()=>{let fb;(fb=this.$.da.za(342))?this.qb(fb):this.$.kz(Eb=>{Eb.Scc().then(jc=>
{(fb=this.$.da.za(342))?this.qb(fb):(fb=new $b(this.$,jc),this.qb(this.$.da.Ga(342,fb)))})})};this.$=oa;this.Fb()}dispose(){this.b9e&&this.$&&this.$.ea.xn(this.Cjd);super.dispose()}create(){this.$.ea.Eg?(e.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Eg}`),this.Cjd(null,null)):(this.b9e=!0,this.$.ea.ql(this.Cjd))}static ka(oa){oa.da.Ga(338,new xc(oa))}}Object(c.a)(xc,"ContextMenuControllerFactory",Tb.a,[]);var ad=
a(155);class Dd{constructor(){this.dictionary=this.Jd=null}}Object(c.a)(Dd,"RibbonCommandParams",null,[]);class ie{constructor(){this.menuModel=null;this.VDe=0}}Object(c.a)(ie,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class $d{constructor(){this.Pbc={}}FIh(oa){return(oa=this.Pbc[oa.toString()])?oa.menuModel:null}mSg(oa,fb){this.Pbc[fb.toString()]=Object(f.a)(new ie,{menuModel:oa,VDe:ib.HelperMethods.Tb()})}J5b(oa){this.Pbc[oa.toString()]=null}nYh(oa){return(oa=this.Pbc[oa.toString()])?oa.VDe:
-1}}Object(c.a)($d,"FilterMenuCache",null,[]);var ne=a(13),ye=a(187),te=a(221);class Ze{constructor(){this.Nd=this.Hre=this.cell=null}}Object(c.a)(Ze,"AutoFilterEventRegistrationArgs",null,[]);class re{constructor(oa){this.UYa=null;this.QPd=!1;this.FAb=0;this.q7c=1;this.YKe=0;this.EDb=fb=>{this.qJf(fb.domElement,fb.hashCode)};this.fNf=fb=>{let Eb=0;for(;window.performance.now()-fb<this.vlh&&0<this.UYa.length;)this.Fke(this.UYa.shift()),Eb++;e.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.q7c}, Events Registered in this frame: ${Eb}, Events in queue: ${this.UYa.length}`);
0<this.UYa.length?this.FAb=window.requestAnimationFrame(this.fNf):(fb=window.performance.now()-this.YKe,e.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.q7c}, Total time in MS: ${fb}`),this.q7c++,this.FAb=0)};this.onPointerDown=fb=>{Qd.a.slim(fb.Ca.rawEvent);return!1};this.$=oa;this.gridView=wa.g(this.$);this.l8h();this.vlh=this.$.ya.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.FAb);this.gridView&&
this.gridView.Sqc(this.EDb);this.gridView=null}l8h(){if(this.QPd=ib.HelperMethods.b6a)this.UYa=[];this.ABg();this.gridView.LXb(this.EDb)}ABg(){for(const oa of this.gridView.sn){const fb=oa.mBa;for(let Eb in fb){const jc=fb[Eb];this.qJf(jc.domElement,jc.hashCode)}}}qJf(oa,fb){if(wa.g(this.$).Ea.sm.Q0a(fb))if(oa){oa=oa.querySelectorAll('[id^="'+r.a.D9c+'"]');for(let Hc=0;Hc<oa.length;Hc++){var Eb=oa[Hc],jc=Eb.getAttribute(r.a.Tyh);const qd=Eb.getAttribute(r.a.Myh);e.ULS.shipAssertTag(537167053,0,!!jc&&
!!qd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${Eb.id}, BlockHash: ${fb}`);jc=rc.Range.Tc(parseInt(jc,10),parseInt(qd,10));Eb=Object(f.a)(new Ze,{cell:jc,Hre:Eb,Nd:fb});this.QPd?(this.UYa.push(Eb),this.FAb||(this.YKe=window.performance.now(),this.FAb=window.requestAnimationFrame(this.fNf))):this.Fke(Eb)}}else e.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${fb}`);
else e.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${fb}`)}Fke(oa){const fb=this.gridView.Ea.CJa(oa.cell,oa.Nd);fb?this.zBg(oa.Hre,fb):e.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${oa.Nd}, AutoFilter Cell: ${oa.cell}`)}zBg(oa,fb){fb.hasAutoFilter?this.xzg(oa,
fb.Psb):fb.E3?this.xBg(oa,fb.Psb,fb.Vnd):e.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");ad.a.instance.ra(ne.a.zf,oa,this.onPointerDown);ye.a.instance.ra(ne.a.zxa,oa,this.onPointerDown)}xzg(oa,fb){te.a.instance.ra(ne.a.click,oa,Eb=>{fb&&Qd.a.hrc(Eb.Ca.rawEvent,966232027,fb,null);return!0})}xBg(oa,fb,Eb){const jc=B.a.Uh(fb);te.a.instance.ra(ne.a.click,oa,Hc=>{Eb?Qd.a.spf(document.getElementById(jc.EwaElementId),
jc.Cell,jc.DataSourceIndex,jc.FieldId,jc.IsOlap,jc.RequiresConfirmation,Hc.Ca.rawEvent,jc.OptionalPivotMenuAnchor):Qd.a.spfm(Hc.Ca.rawEvent,jc.RequiresConfirmation,jc.Cell,jc.DataSourceIndex,jc.PivotName,jc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(re,"FilterMenuPointerEventsManager",null,[3]);class tc{constructor(oa){this.jRe=null;this.$=oa;this.a8a=new $d;da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.jRe=new re(this.$))}dispose(){da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.jRe.dispose();this.$=null}NOh(oa){const fb=wa.g(this.$).Ea.t9(oa,this.$.activeItemName);return fb&&fb.blockPresentInViewportTimeStamp>this.a8a.nYh(oa.left)?fb.Rr(oa).autoFilterMenu:this.a8a.FIh(oa.left)}JLi(oa,fb,Eb){this.a8a&&this.a8a.mSg(oa.menuModel[fb],Eb)}KLi(oa){this.a8a&&this.a8a.J5b(oa)}}Object(c.a)(tc,"FilterMenuManager",
null,[254,3]);var $c=a(204),Ed=a(167);class Id{constructor(oa,fb,Eb){this.Awc={};this.Ad=!1;this.Sl=(jc,Hc=null)=>{this.showContextMenu(Hc)};this.Iuf=(jc,Hc)=>{Hc.gzi===Id.c0h&&wa.g(this.$).focus()};this.XQ=(jc,Hc)=>{jc=this.$.Ka.X$(Hc.Jd.command);(null===jc||void 0===jc?0:jc.dismissesContextualUI)&&this.J2()};this.WQ=()=>{this.$.da.YT(342);F.TaskExtensions.Aa(P.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),jc=>{jc=jc.result;for(let Hc of this.Awc)Hc.QMf(jc)},this.$.la)};this.$=oa;this.contextMenuController=
Eb;this.Z4d=new tc(this.$);oa.da.Ga(8,this);for(Eb=0;Eb<fb.length;Eb++)this.Awc[Id.y1g[Eb]]=fb[Eb];this.ha=wa.g(oa).ha;this.ha.EXb(this.Sl);this.$.Ka.SXa(this.Iuf);ad.a.instance.ssj();da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.WEa(this.XQ);da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.CX(this.WQ)}get R7b(){return this.Z4d}Mbd(oa){return L.a.Cc(this.Awc,oa)}dispose(){this.Ad?
e.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ad=!0,this.$&&(this.$.Cl(Id.Zc),this.$.da.YT(8),this.ha&&this.ha.Kqc(this.Sl),this.$.Ka.xHb(this.Iuf),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.dza(this.XQ),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.x_(this.WQ)),this.$=this.ha=null,this.R7b.dispose(),
this.Awc=this.Z4d=null)}showContextMenu(oa,fb=null,Eb=null){this.cxj(oa)&&(Md.h(this.$,Md.i),oa=this.I4g(oa,fb,Eb),this.$.Ka.Lb(oa.Jd,oa.dictionary))}J2(){this.contextMenuController?this.contextMenuController.l$():e.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}cxj(oa){return ic.a(this.$).Qp()?(e.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
ic.a(this.$).EV(Ed.a.grid,$c.a.showContextMenu),!1):!this.$.Ka.qwh&&(!oa||oa.Cb!==wa.g(this.$).domElement&&!Ge.a.equals(oa.Cb.tagName,"INPUT",!0))}I4g(oa,fb=null,Eb=null){Eb={["eventArgs"]:oa,["creationParams"]:Eb};oa=oa?oa.tb:-1;const jc=this.ha.Oa.$b;let Hc=1441131127;jc?(fb=jc.floatingObject,e.ULS.shipAssertTag(537167059,0,!!fb,"floatingObj shouldn't be null."),Id.gpd(fb)?Hc=1312363469:Id.isPivotChart(fb)?(Eb[pb.fZc]=fb?fb.Rc:null,Hc=-149612405):Hc=-1372040782):Id.xef(fb)?(Eb[pb.fZc]=fb,Hc=-149612405):
!Md.g(this.$)&&Md.f(wa.g(this.$))&&(Hc=671488277);fb=new R.a(Hc,oa,this.$.Mc,30,null);return Object(f.a)(new Dd,{Jd:fb,dictionary:Eb})}static ka(oa){oa.el(Id.Zc)}static isPivotChart(oa){return!!oa&&0===oa.type&&Id.xef(oa.Rc)}static gpd(oa){return!!oa&&2===oa.type}static xef(oa){return!!oa&&!!(oa.Attributes&4)}}Id.y1g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Id.c0h="GridContextMenu";Id.Zc=oa=>{(oa=Object(Mb.a)(7,oa))&&P.GetServiceTaskFactory.create(oa.da,9,oa.la,0)};Object(c.a)(Id,"ContextMenuManager",null,[223,3]);class ae extends Tb.a{constructor(oa){super();this.$=oa;this.Fb()}create(){const oa=this.$,fb=oa.jc;if(fb.allowSelection||fb.allowEdits||fb.allowFiltering||fb.allowSorting||fb.allowPivotSpecificOperations){const Eb=P.GetServiceTaskFactory.create(oa.da,10,oa.la,this.ib),jc=P.GetServiceTaskFactory.Ta(oa.da,342,338,this.ib);F.TaskExtensions.Aa(F.TaskExtensions.Xd([Eb,
jc],this.la),()=>{this.qb(u.a(oa)||new Id(oa,Eb.result,jc.result))},this.$.la,3)}else e.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),oa.da.YT(8),this.qb(null)}static ka(oa){oa.da.Ga(9,new ae(oa))}}Object(c.a)(ae,"ContextMenuManagerFactory",Tb.a,[]);var ja=a(10);a.d(D,"a",function(){return hb});const hb=()=>{Za.initData();ja.a.Fa(oa=>{xc.ka(oa);ae.ka(oa);Za.ka(oa);Id.ka(oa)})}},1141:function(t,D,a){var c=
a(10);t=a(0);var b=a(690),d=a(15);const f=ya=>{switch(ya){case 0:ya="Between";break;case 1:ya="NotBetween";break;case 2:ya="Equal";break;case 3:ya="NotEqual";break;case 4:ya="GreaterThan";break;case 5:ya="LessThan";break;case 6:ya="GreaterThanOrEqual";break;case 7:ya="LessThanOrEqual";break;default:ya="Unknown"}return ya},e=ya=>{switch(ya){case 0:ya="AnyValue";break;case 1:ya="WholeNumber";break;case 2:ya="Decimal";break;case 3:ya="List";break;case 4:ya="Date";break;case 5:ya="Time";break;case 6:ya=
"TextLength";break;case 7:ya="Custom";break;default:ya="Unknown"}return ya};var k=a(131),l=a(42),m=a(368),v=a(170),n=a(247);class w{constructor(ya=null){this.d4=ya?ya.IsIgnoreBlank:!0;this.e4=ya?ya.IsInCellDropDown:!0;this.AN=ya?ya.LowerBoundary:"";this.BN=ya?ya.UpperBoundary:"";this.FB=ya?ya.ConditionType:0;this.ruleType=ya?ya.RuleType:0;this.hZ=ya?ya.IsAlertBlocking:!0;this.fT=ya?ya.AlertTitle:"";this.eT=ya?ya.AlertMessage:"";this.PU=ya?ya.InputMessage:"";this.kF=ya?ya.InputTitle:"";this.u4=ya?
ya.IsShowErrorAlert:!0;this.v4=ya?ya.IsShowInputMessage:!0}isEqual(ya){return ya?this.d4===ya.d4&&this.e4===ya.e4&&this.AN===ya.AN&&this.BN===ya.BN&&this.FB===ya.FB&&this.ruleType===ya.ruleType&&this.hZ===ya.hZ&&this.fT===ya.fT&&this.eT===ya.eT&&this.PU===ya.PU&&this.kF===ya.kF&&this.u4===ya.u4&&this.v4===ya.v4:(d.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(t.a)(w,"DataValidationEditDialogState",null,[]);var r=a(281),u=a(181),x=a(280),
z=a(21),B=a(132),y=a(51),A=a(55);class K{constructor(ya,ha){this.OB=this.t0a=this.selectedRanges=null;this.mIe=!1;this.Yh=null;this.WJi=Da=>{d.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!Da||r.a(Da)?d.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.t0a=Da.Result,this.XZi())};this.xwh=Da=>{this.RV("DataValidationEdit.ExpandExisitngDialog",
Da);this.OB.c=K.wha(Da);1===Da?this.SGa(new w(this.t0a)):2===Da?this.SGa(new w):this.Jlf()};this.VUi=Da=>{this.RV("DataValidationEdit.OverrideExisitngDialog",Da);this.OB.c=K.wha(Da);1===Da?this.SGa(new w):this.Jlf()};this.$=ya;this.K3c=ha}Qc(){return!1}executeCommand(ya,ha){-1728432249!==ha.command&&u.a(ha.command);this.selectedRanges=l.r(z.g(this.$).ha.sa.selectedRanges,this.$);z.g(this.$).yRa(!0);this.getDataValidationInitialState();this.Yh=this.$.Hb.xc("UserAction","DataValidationEditTimeToDialogOpen");
this.mIe?d.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(d.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.mIe=!0);return A.Task.Ua(!0)}Ec(ya,ha){return-1728432249===ha.command}Vc(){return!1}getDataValidationInitialState(){const ya=this.$.pa.va.Qb();m.a(this.$.userOperationManager,(ha,Da,nb)=>n.f(this.$.pa.va,this.selectedRanges,x.b(ha,this.WJi),x.a(Da),nb,ya),ha=>new v.a(120,0,ha,16),null)}XZi(){var ya=
this.OB={};let ha;switch(this.t0a.Command){case 0:ha="CreateNew";break;case 1:ha="CreateNewFromRule";break;case 2:ha="ExpandExisitng";break;case 3:ha="OverrideExisitng";break;default:ha="Unknown"}ya.a=ha;this.Yh&&(this.Yh.stop(),this.OB.r=this.Yh.id);switch(this.t0a.Command){case 0:this.OB.b=!1;this.OB.c="None";this.SGa(new w);break;case 1:this.OB.b=!1;this.OB.c="None";this.SGa(new w(this.t0a));break;case 2:this.OB.b=!0;this.K3c.G3g(this.$,this.xwh);break;case 3:this.OB.b=!0;this.K3c.I3g(this.$,this.VUi);
break;default:d.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}SGa(ya){this.K3c.SGa(this.$,this.selectedRanges,ya,this.t0a.Command);this.Mvi(ya)}Mvi(ya){K.mrb(ya,this.OB);this.OB.d=!0;y.b().Ie(48,this.OB,!0)}Jlf(){this.OB.d=!1;y.b().Ie(48,this.OB,!0)}RV(ya,ha){ya={["ButtonType"]:K.wha(ha),["DialogName"]:ya,["Location"]:"dialog",["NumberOfSelectedRanges"]:z.g(this.$).ha.sa.BK};B.b(this.$).Cd(k.a.G4b,ya)}static mrb(ya,ha){ha.e=e(ya.ruleType);
ha.f=f(ya.FB);ha.g=!!ya.AN;ha.h=!!ya.BN;ha.i=ya.d4;ha.j=ya.e4;ha.k=ya.v4;ha.l=!!ya.kF;ha.m=!!ya.PU;ha.n=ya.u4;ha.o=ya.hZ;ha.p=!!ya.fT;ha.q=!!ya.eT}static wha(ya){switch(ya){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return d.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(t.a)(K,"DataValidationEditCommandHandler",null,[188]);var G=a(133),T=a(795),W;(function(ya){ya[ya.between=0]="between";ya[ya.notBetween=
1]="notBetween";ya[ya.equal=2]="equal";ya[ya.notEqual=3]="notEqual";ya[ya.greaterThan=4]="greaterThan";ya[ya.lessThan=5]="lessThan";ya[ya.greaterThanOrEqual=6]="greaterThanOrEqual";ya[ya.lessThanOrEqual=7]="lessThanOrEqual"})(W||(W={}));Object(t.b)("DataValidationRuleConditionType",W);var P;(function(ya){ya[ya.anyValue=0]="anyValue";ya[ya.wholeNumber=1]="wholeNumber";ya[ya.decimal=2]="decimal";ya[ya.list=3]="list";ya[ya.date=4]="date";ya[ya.time=5]="time";ya[ya.textLength=6]="textLength";ya[ya.custom=
7]="custom"})(P||(P={}));Object(t.b)("DataValidationRuleType",P);var E=a(144),H=a(173);class F{static get ag(){return E.a.Yo(F.Ak,"")}static get Wdh(){return E.a.Yo(F.$dh,H.a.ga(1667),H.a.ga(1682),H.a.ga(1683),H.a.ga(1684),H.a.ga(1685),H.a.ga(1686),H.a.ga(1687),H.a.ga(1688),H.a.ga(1689),H.a.ga(1668),H.a.ga(1692),H.a.ga(1693),H.a.ga(1694),H.a.ga(1695),H.a.ga(1696),H.a.ga(1697),H.a.ga(1698),H.a.ga(1699),H.a.ga(1669),H.a.ga(1670),H.a.ga(1690),H.a.ga(1691),H.a.ga(1681),"255")}static get ceh(){return E.a.Yo(F.aeh,
H.a.ga(1704),H.a.ga(1708),H.a.ga(1709),"255","32")}static get geh(){return E.a.Yo(F.beh,H.a.ga(1703),H.a.ga(1706),H.a.ga(1705),H.a.ga(1707),H.a.ga(1708),H.a.ga(1709),"255","32")}}F.W7f=255;F.Ak="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";F.$dh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
F.aeh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
F.beh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(t.a)(F,"DataValidationEditDialogHtml",null,[]);var N=a(85),J=a(549),R=a(13),M=a(184),L=a(234),U=a(12),X=a(14);class da extends L.a{constructor(ya,ha,Da){super(ha);this.VAd=this.lnc=this.nOa=this.G9a=this.JMa=this.M4a=this.jya=this.iya=this.GK=this.gT=this.Kcc=this.yva=null;this.sAh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Gkj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.Llc=nb=>{let qa=!1;(null===nb||void 0===nb?0:nb.Ca)&&(nb.Ca.keyCode===N.a.boa||nb.Ca.keyCode===N.a.Zh)&&(qa=this.Pba(nb),this.gT.blur(),this.GK.blur());return qa};this.Pba=()=>{const nb=this.gT.selectedIndex,qa=this.GK.selectedIndex;this.lnc.innerText=this.pub(nb,qa);this.VAd.innerText=this.Ged(nb,qa);switch(nb){case 0:return this.GK.disabled=!0,U.DOMElementExtensions.setVisible(this.G9a,!1),U.DOMElementExtensions.setVisible(this.nOa,!1),U.DOMElementExtensions.setVisible(this.M4a,
!1),U.DOMElementExtensions.setVisible(this.JMa,!1),this.yva.disabled=!0,!1;case 3:return this.GK.disabled=!0,U.DOMElementExtensions.setVisible(this.G9a,!0),U.DOMElementExtensions.setVisible(this.nOa,!1),U.DOMElementExtensions.setVisible(this.M4a,!0),U.DOMElementExtensions.setVisible(this.JMa,!0),this.yva.disabled=!1;case 7:return this.GK.disabled=!0,U.DOMElementExtensions.setVisible(this.G9a,!0),U.DOMElementExtensions.setVisible(this.nOa,!1),U.DOMElementExtensions.setVisible(this.M4a,!1),U.DOMElementExtensions.setVisible(this.JMa,
!1),this.yva.disabled=!1;default:this.yva.disabled=!1,U.DOMElementExtensions.setVisible(this.G9a,!0),U.DOMElementExtensions.setVisible(this.JMa,!1)}switch(qa){case 0:case 1:U.DOMElementExtensions.setVisible(this.nOa,!0);break;default:U.DOMElementExtensions.setVisible(this.nOa,!1)}this.GK.disabled=!1;this.lnc.disabled=!1;U.DOMElementExtensions.setVisible(this.M4a,!1);U.DOMElementExtensions.setVisible(this.JMa,!1);return!1};this.get_visible=this.cja;this.set_visible=this.Sma;this.GQ=new M.a;this.GQ.add(X.a.instance.ga(1669));
this.GQ.add(X.a.instance.ga(1670));this.GQ.add(X.a.instance.ga(1673));this.GQ.add(X.a.instance.ga(1671));this.GQ.add(X.a.instance.ga(1672));this.GQ.add(X.a.instance.ga(1674));this.GQ.add(X.a.instance.ga(1675));this.GQ.add(X.a.instance.ga(1676));this.GQ.add(X.a.instance.ga(1677));this.GQ.add(X.a.instance.ga(1678));this.GQ.add(X.a.instance.ga(1679));this.GQ.add(X.a.instance.ga(1680));this.GQ.add("");this.$=ya;this.Fk=Da;this.wja()}get title(){return X.a.instance.ga(1700)}get T_g(){return this.gT.selectedIndex}Jza(ya){this.gT.selectedIndex=
ya.ruleType;this.GK.selectedIndex=ya.FB;this.Kcc.checked=ya.e4;this.yva.checked=ya.d4;this.iya.value=ya.AN;this.jya.value=ya.BN;this.Pba(null)}qob(ya){ya.d4=this.yva.checked;ya.e4=this.Kcc.checked;ya.FB=this.GK.selectedIndex;ya.ruleType=this.gT.selectedIndex;ya.AN=this.iya.value;ya.BN=this.jya.value}dispose(){this.ek();this.Fk=this.VAd=this.lnc=this.nOa=this.G9a=this.JMa=this.M4a=this.Kcc=this.jya=this.iya=this.GK=this.gT=this.yva=null;super.dispose()}render(ya){ya.appendChild(this.domElement)}cja(){return this.isVisible}Sma(ya){return this.isVisible=
ya}setFocus(){}pub(ya,ha){return this.f_e(ya,ha,this.sAh)}Ged(ya,ha){return 0!==ha&&1!==ha?"":this.f_e(ya,ha,this.Gkj)}wja(){this.domElement.innerHTML=F.Wdh;this.yva=U.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.gT=U.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.GK=U.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.iya=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.jya=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.lnc=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.VAd=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.M4a=U.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.JMa=U.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.G9a=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.nOa=U.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Kcc=U.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Bj()}f_e(ya,ha,Da){return Da.length<ya||Da[ya].length<ha?(d.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${ya} operatorOption=${ha}, cannot get label.`),""):this.GQ.na(Da[ya][ha])}Bj(){J.a.instance.ra(R.a.Mb,this.gT,this.Llc);J.a.instance.ra(R.a.Mb,this.GK,
this.Llc);J.a.instance.ra(R.a.change,this.gT,this.Pba);J.a.instance.ra(R.a.change,this.GK,this.Pba);J.a.instance.ra(R.a.change,this.GK,this.Fk);J.a.instance.ra(R.a.change,this.gT,this.Fk);J.a.instance.ra(R.a.change,this.iya,this.Fk);J.a.instance.ra(R.a.Mb,this.iya,this.Fk);J.a.instance.ra(R.a.change,this.jya,this.Fk);J.a.instance.ra(R.a.Mb,this.jya,this.Fk)}ek(){J.a.instance.Ba(R.a.Mb,this.gT,this.Llc);J.a.instance.Ba(R.a.Mb,this.GK,this.Llc);J.a.instance.Ba(R.a.change,this.gT,this.Pba);J.a.instance.Ba(R.a.change,
this.GK,this.Pba);J.a.instance.Ba(R.a.change,this.GK,this.Fk);J.a.instance.Ba(R.a.change,this.gT,this.Fk);J.a.instance.Ba(R.a.change,this.iya,this.Fk);J.a.instance.Ba(R.a.Mb,this.iya,this.Fk);J.a.instance.Ba(R.a.change,this.jya,this.Fk);J.a.instance.Ba(R.a.Mb,this.jya,this.Fk)}static Bia(){let ya;return ya=new M.a,ya.add("operatorInputId1"),ya.add("operatorInputId2"),ya}}Object(t.a)(da,"DataValidationEditConditionsControl",L.a,[320,3,526]);var fa=a(62);const S=(ya,ha,Da,nb,qa,pa,Ja,$a=null)=>{$a=
ya.Na(9,$a);$a.selectedRanges=ha;$a.ruleOptions=Da;return fa.g(ya,"CreateOrEditDataValidation",$a,nb,qa,pa,Ja,0)};var ka=a(31),V=a(22),wa=a(200);class ma extends T.a{constructor(ya,ha,Da,nb){super(ya);this.JLd=this.Xsb=null;this.hMa=this.disposed=this.Gja=!1;this.Yh=null;this.QUj=(qa,pa)=>{let Ja;this.a$b(qa);if(({errorString:qa,qq:Ja}=this.yYd()).returnValue)return this.TKa(121,this.hLh(this.$,pa),0,this.j4,!1),"";this.tka("OkInvalidByClient",Ja);return qa};this.J3c=qa=>{this.RV(qa);this.Yh=this.$.Hb.xc("UserAction",
"DataValidationEditTimeToDialogTryClose");0===qa&&this.Zka()};this.selectedRanges=ha;this.wQb=Da;this.command=nb;3===nb&&(this.Gja=!0);this.Sb=2;this.Mv=!1}get vd(){return this.wQb}get oc(){return"DataValidationEditDialog"}mRd(){var ya={["RuleType"]:this.vd.ruleType,["RuleOperatorType"]:this.vd.FB,["OperatorInput1"]:this.vd.AN,["OperatorInput2"]:this.vd.BN,["IsIgnoreBlank"]:this.vd.d4,["IsInCellDropDown"]:this.vd.e4,["IsAlertBlocking"]:this.vd.hZ,["AlertTitle"]:this.vd.fT,["AlertMessage"]:this.vd.eT,
["InputTitle"]:this.vd.kF,["InputMessage"]:this.vd.PU,["IsShowErrorAlert"]:this.vd.u4,["IsShowInputMessage"]:this.vd.v4};this.sc(2,X.a.instance.ga(1666));ya={[ma.Uu]:this.oc,["validateDialogValues"]:this.QUj,["RangePickerController"]:z.g(this.$).Cf.gac(),["isModal"]:!1,["bodyProps"]:ya};this.initializeAndShow(X.a.instance.ga(1665),this.J3c,ya);d.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get k0b(){return 3===
this.vd.ruleType}Bia(){return da.Bia()}hLh(ya,ha){return(Da,nb,qa)=>{const pa=ya.pa.va.Qb();return S(this.$.pa.va,this.selectedRanges,this.qQg(),this.SZa(Da,this.oyd(ha)),x.a(nb),qa,pa)}}oyd(ya){return ha=>{d.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let Da;r.a(ha)?(d.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${ha?ka.a.zc(ha.Errors):null}.`),ha.Errors&&1===ha.Errors.length&&
((Da=this.Xbd(ha.Errors[0].MessageId))?this.tka("OkInvalidByServer",ha.Errors[0].MessageIdName):(this.tka("OkValid","None"),this.hide()),ya(Da)),d.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ka.a.zc(ha.Errors)}`)):this.hide()}}qQg(){const ya={};ya.Command=this.command;ya.RuleType=this.vd.ruleType;ya.ConditionType=this.vd.FB;ya.IsIgnoreBlank=this.vd.d4;ya.IsInCellDropDown=this.vd.e4;ya.LowerBoundary=this.vd.AN;ya.UpperBoundary=
this.vd.BN;ya.IsAlertBlocking=this.vd.hZ;ya.IsShowErrorAlert=this.vd.u4;ya.IsShowInputMessage=this.vd.v4;ya.AlertTitle=this.vd.fT;ya.AlertMessage=this.vd.eT;ya.InputTitle=this.vd.kF;ya.InputMessage=this.vd.PU;ya.ShouldIgnoreFormulaError=this.hMa;return ya}Xbd(ya){switch(ya){case 1173235830:return X.a.instance.ga(1715);case 43935303:return X.a.instance.ga(1716);case -1323438439:return X.a.instance.ga(1718);case 2112020473:return X.a.instance.ga(1712);case -219503282:return X.a.instance.ga(1713);case 1689335445:return X.a.instance.ga(1714);
case 2146493810:return X.a.instance.ga(1717);case -2104909922:return String.format(X.a.instance.mb(105),this.Xsb,this.JLd);case -869372599:return String.format(X.a.instance.mb(104),this.Xsb);case -1181828368:return X.a.instance.ga(1720);case -758480861:return X.a.instance.ga(1721);case -13729088:return X.a.instance.ga(1722);case -846654055:return X.a.instance.ga(1723);case 751854001:return X.a.instance.ga(1724);case -453846397:return X.a.instance.ga(1725);case 1102013489:return X.a.instance.ga(1726);
case 835813260:return X.a.instance.ga(1727);case 1577787509:return X.a.instance.ga(1728);case 2083564019:return X.a.instance.ga(1719);default:d.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${ya.toString()}.`)}return null}Zka(){this.tka("Cancel","None")}RV(ya){d.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===ya?"Ok":"Cancel"} was clicked.`);ya={["ButtonType"]:ma.wha(ya),["DialogName"]:this.oc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:z.g(this.$).ha.sa.BK};B.b(this.$).Cd(k.a.G4b,ya)}tka(ya,ha){const Da={};ma.mrb(this.vd,Da);Da.o=ya;Da.p=ha;Da.n=this.Gja;this.Yh&&(this.Yh.stop(),Da.q=this.Yh.id);y.b().Ie(49,Da,!0)}a$b(ya){this.vd.ruleType=ya.RuleType;this.vd.FB=ya.RuleOperatorType;this.vd.AN=ya.OperatorInput1;this.vd.BN=ya.OperatorInput2;this.vd.hZ=ya.IsAlertBlocking;this.vd.u4=ya.IsShowErrorAlert;this.vd.fT=ya.AlertTitle;this.vd.eT=ya.AlertMessage;this.vd.v4=ya.IsShowInputMessage;this.vd.kF=ya.InputTitle;
this.vd.PU=ya.InputMessage;this.vd.d4=ya.IsIgnoreBlank;this.vd.e4=ya.IsInCellDropDown;this.Xsb=ya.firstOperatorLabel;this.JLd=ya.secondOperatorLabel}WNb(ya,ha,Da){let nb,qa;qa=nb=null;if(!ya)return Da?(nb=String.format(X.a.instance.mb(105),this.Xsb,this.JLd),qa="DataValidationEditNoMinMaxError"):(nb=String.format(X.a.instance.mb(104),this.Xsb),qa="DataValidationEditNoValueError"),{returnValue:!1,errorString:nb,qq:qa};if(ya.length>F.W7f)return nb=X.a.instance.ga(1719),{returnValue:!1,errorString:nb,
qq:qa};if(wa.d(ya))return{returnValue:!0,errorString:nb,qq:qa};if(1===ha||2===ha||6===ha){if(!V.a.m4(ya))return nb=X.a.instance.ga(1712),{returnValue:!1,errorString:nb,qq:qa};if(1===ha&&!V.a.isInteger(ya))return nb=X.a.instance.ga(1713),{returnValue:!1,errorString:nb,qq:qa};if(6===ha){if(!V.a.isInteger(ya))return nb=X.a.instance.ga(1713),{returnValue:!1,errorString:nb,qq:qa};if(0>parseInt(ya,10))return nb=X.a.instance.ga(1714),{returnValue:!1,errorString:nb,qq:qa}}}return{returnValue:!0,errorString:nb,
qq:qa}}yYd(){let ya,ha;ha=ya=null;const Da=this.vd.AN,nb=this.vd.BN,qa=P[this.vd.ruleType];var pa=W[this.vd.FB];if(0===qa)return{returnValue:!0,errorString:ya,qq:ha};pa=(0===pa||1===pa)&&3!==qa&&7!==qa;return!({errorString:ya,qq:ha}=this.WNb(Da,qa,pa)).returnValue||pa&&!({errorString:ya,qq:ha}=this.WNb(nb,qa,pa)).returnValue?{returnValue:!1,errorString:ya,qq:ha}:pa&&(1===qa||2===qa||6===qa)&&!wa.d(Da)&&!wa.d(nb)&&parseFloat(Da)>parseFloat(nb)?(ya=X.a.instance.ga(1717),{returnValue:!1,errorString:ya,
qq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:ya,qq:ha}}static wha(ya){switch(ya){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static mrb(ya,ha){ha.a=e(ya.ruleType);ha.b=f(ya.FB);ha.c=!!ya.AN;ha.d=!!ya.BN;ha.e=ya.d4;ha.f=ya.e4;ha.g=ya.v4;ha.h=!!ya.kF;ha.i=!!ya.PU;ha.j=ya.u4;ha.k=ya.hZ;ha.l=!!ya.fT;ha.m=!!ya.eT}}Object(t.a)(ma,
"DataValidationEditDialog",T.a,[]);var ab=a(86);T=a(260);class ba{}ba.Kah="DataValidationDialogPanel";ba.Jah="DataValidationButtonPanel";ba.Iah="DataValidationButtonClearAll";Object(t.a)(ba,"CssClassNames",null,[]);class Ca extends L.a{constructor(ya,ha){super(ya);this.yaa=this.zaa=this.xaa=null;this.Nlc=()=>{this.xaa.checked?(this.zaa.disabled=!1,this.yaa.disabled=!1):(this.zaa.disabled=!0,this.yaa.disabled=!0);return!1};this.get_visible=this.cja;this.set_visible=this.Sma;this.Fk=ha;this.wja()}get title(){return X.a.instance.ga(1702)}render(ya){ya.appendChild(this.domElement)}cja(){return this.isVisible}Sma(ya){return this.isVisible=
ya}setFocus(){}dispose(){this.ek();this.Fk=this.zaa=this.yaa=this.xaa=null;super.dispose()}wja(){this.domElement.innerHTML=F.ceh;this.xaa=U.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");U.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.zaa=U.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.yaa=U.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.xaa.checked=!0;this.Bj();this.Nlc(null)}Jza(ya){this.zaa.value=
void 0===ya.kF||null===ya.kF?"":ya.kF;this.yaa.value=void 0===ya.PU||null===ya.PU?"":ya.PU;this.xaa.checked=ya.v4;this.Nlc(null)}qob(ya){ya.kF=this.zaa.value;ya.PU=this.yaa.value;ya.v4=this.xaa.checked}Bj(){J.a.instance.ra(R.a.change,this.xaa,this.Nlc);J.a.instance.ra(R.a.change,this.xaa,this.Fk);J.a.instance.ra(R.a.change,this.zaa,this.Fk);J.a.instance.ra(R.a.Mb,this.zaa,this.Fk);J.a.instance.ra(R.a.change,this.yaa,this.Fk);J.a.instance.ra(R.a.Mb,this.yaa,this.Fk)}ek(){J.a.instance.Ba(R.a.change,
this.xaa,this.Nlc);J.a.instance.Ba(R.a.change,this.xaa,this.Fk);J.a.instance.Ba(R.a.change,this.zaa,this.Fk);J.a.instance.Ba(R.a.Mb,this.zaa,this.Fk);J.a.instance.Ba(R.a.change,this.yaa,this.Fk);J.a.instance.Ba(R.a.Mb,this.yaa,this.Fk)}}Object(t.a)(Ca,"DataValidationEditInputControl",L.a,[320,3,525]);class Na extends L.a{constructor(ya,ha){super(ya);this.a9=this.b9=this.vTa=this.xga=this.Z8=null;this.Mlc=()=>{this.Z8.checked?(this.xga.disabled=!1,this.vTa.disabled=!1,this.b9.disabled=!1,this.a9.disabled=
!1):(this.xga.disabled=!0,this.vTa.disabled=!0,this.b9.disabled=!0,this.a9.disabled=!0);return!1};this.get_visible=this.cja;this.set_visible=this.Sma;this.Fk=ha;this.wja()}get title(){return X.a.instance.ga(1701)}render(ya){ya.appendChild(this.domElement)}cja(){return this.isVisible}Sma(ya){return this.isVisible=ya}setFocus(){}dispose(){this.ek();this.Fk=this.b9=this.a9=this.vTa=this.xga=this.Z8=null;super.dispose()}wja(){this.domElement.innerHTML=F.geh;this.Z8=U.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.xga=U.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.vTa=U.DOMElementExtensions.getElementById(this.domElement,"warningId");this.b9=U.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.a9=U.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.Z8.checked=!0;this.xga.checked=!0;this.Bj();this.Mlc(null)}Jza(ya){this.xga.checked=ya.hZ;this.vTa.checked=!ya.hZ;this.b9.value=void 0===ya.fT||null===
ya.fT?"":ya.fT;this.a9.value=void 0===ya.eT||null===ya.eT?"":ya.eT;this.Z8.checked=ya.u4;this.Mlc(null)}qob(ya){ya.fT=this.b9.value;ya.eT=this.a9.value;ya.hZ=this.xga.checked;ya.u4=this.Z8.checked}Bj(){J.a.instance.ra(R.a.change,this.Z8,this.Mlc);J.a.instance.ra(R.a.change,this.Z8,this.Fk);J.a.instance.ra(R.a.change,this.xga,this.Fk);J.a.instance.ra(R.a.change,this.vTa,this.Fk);J.a.instance.ra(R.a.change,this.b9,this.Fk);J.a.instance.ra(R.a.Mb,this.b9,this.Fk);J.a.instance.ra(R.a.change,this.a9,this.Fk);
J.a.instance.ra(R.a.Mb,this.a9,this.Fk)}ek(){J.a.instance.Ba(R.a.change,this.Z8,this.Mlc);J.a.instance.Ba(R.a.change,this.Z8,this.Fk);J.a.instance.ra(R.a.change,this.xga,this.Fk);J.a.instance.ra(R.a.change,this.vTa,this.Fk);J.a.instance.Ba(R.a.change,this.b9,this.Fk);J.a.instance.Ba(R.a.Mb,this.b9,this.Fk);J.a.instance.Ba(R.a.change,this.a9,this.Fk);J.a.instance.Ba(R.a.Mb,this.a9,this.Fk)}}Object(t.a)(Na,"DataValidationEditMessagesControl",L.a,[320,3,524]);class za{constructor(ya,ha){this.options=
this.cellRange=null;this.cellRange=ya;this.options=ha}}Object(t.a)(za,"MacroRecorderRangeDataValidationChangedPayload",null,[116]);var la=a(1228);class aa extends T.a{constructor(ya,ha,Da,nb){super(ya);this.q2=this.idc=this.zjc=this.mCb=null;this.hMa=this.disposed=this.Gja=!1;this.Yh=null;this.oyd=qa=>{d.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)d.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(r.a(qa)){d.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${qa?ka.a.zc(qa.Errors):null}.`);if(qa.Errors&&1===qa.Errors.length){const pa=qa.Errors[0].MessageId,Ja=this.Xbd(pa);if(Ja){this.Mxj(pa)?this.atj(Ja):this.tr(Ja);this.tka("OkInvalidByServer",qa.Errors[0].MessageIdName);return}}d.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ka.a.zc(qa.Errors)}`)}this.tka("OkValid",
"None");this.hide()}};this.J3c=qa=>{this.RV(qa);2!==qa&&(this.Yh=this.$.Hb.xc("UserAction","DataValidationEditTimeToDialogTryClose"));1===qa?this.n9a():2===qa?this.Qxa():this.Zka()};this.Pba=()=>{this.$Pj();this.hMa?this.Jxe():this.sxe();return this.Gja=!1};this.selectedRanges=ha;this.wQb=Da;this.command=nb;3===nb&&(this.Gja=!0);this.Sb=2;this.Mv=!1;this.ag=F.ag}get vd(){return this.wQb}get oc(){return"DataValidationEditDialog"}mRd(){const ya={["key"]:this.vd};this.initializeAndShow(X.a.instance.ga(1665),
this.J3c,ya);d.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.idc=this.zjc=this.q2=null,ab.a.Ia(this.mCb),this.mCb=null,B.b(this.$)&&B.b(this.$).JSd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get ey(){return()=>{this.RV(1);this.n9a()}}xv(ya){super.xv(ya);this.sc(2,X.a.instance.ga(1666));ya=this.zU(2);var ha=this.zU(1),Da=this.zU(0),nb=ha.parentNode;nb.appendChild(ya);nb.appendChild(ha);nb.appendChild(Da);
ya.parentNode.classList.add(ba.Jah);ya.classList.add(ba.Iah);ya=document.getElementById("dataValidationTabsId");ha=new da(this.$,document.createElement("div"),this.Pba);Da=new Ca(document.createElement("div"),this.Pba);nb=new Na(document.createElement("div"),this.Pba);this.jai(ha,Da,nb);let qa;this.mCb=new la.a(ya,(qa=new M.a,qa.add(ha),qa.add(Da),qa.add(nb),qa));this.mCb.bQf();this.mU=document.getElementById("validationErrorMessageId");this.Jza();B.b(this.$)&&B.b(this.$).sSd("DataValidationDialogCorellation")}tI(){super.tI();
document.getElementById(this.ei("WACDialogPanel")).classList.add(ba.Kah)}get RX(){return!1}get k0b(){return 3===this.q2.T_g}Bia(){return da.Bia()}lcd(){return"validationErrorMessageId"}jai(ya,ha,Da){this.q2=ya;this.idc=ha;this.zjc=Da}Nlj(){const ya={};ya.IsClearAll=this.Gja;ya.Command=this.command;ya.RuleType=this.vd.ruleType;ya.ConditionType=this.vd.FB;ya.IsIgnoreBlank=this.vd.d4;ya.IsInCellDropDown=this.vd.e4;ya.LowerBoundary=this.vd.AN;ya.UpperBoundary=this.vd.BN;ya.IsAlertBlocking=this.vd.hZ;
ya.IsShowErrorAlert=this.vd.u4;ya.IsShowInputMessage=this.vd.v4;ya.AlertTitle=this.vd.fT;ya.AlertMessage=this.vd.eT;ya.InputTitle=this.vd.kF;ya.InputMessage=this.vd.PU;ya.ShouldIgnoreFormulaError=this.hMa;const ha=this.$.pa.va.Qb(),Da=()=>new za(this.selectedRanges,ya);m.a(this.$.userOperationManager,(nb,qa,pa)=>S(this.$.pa.va,this.selectedRanges,ya,x.b(nb,this.oyd),x.a(qa),pa,ha),nb=>new v.a(121,0,nb,void 0,Da),null)}Mxj(ya){return 1577787509===ya}atj(ya){this.mU.innerText=ya;this.qI(this.zU(0));
this.hMa=!0}Jxe(){this.hMa=!1;this.mU.innerText=""}Xbd(ya){switch(ya){case 1173235830:return X.a.instance.ga(1715);case 43935303:return X.a.instance.ga(1716);case -1323438439:return X.a.instance.ga(1718);case 2112020473:return X.a.instance.ga(1712);case -219503282:return X.a.instance.ga(1713);case 1689335445:return X.a.instance.ga(1714);case 2146493810:return X.a.instance.ga(1717);case -2104909922:return String.format(X.a.instance.mb(105),this.q2.pub(this.vd.ruleType,this.vd.FB),this.q2.Ged(this.vd.ruleType,
this.vd.FB));case -869372599:return String.format(X.a.instance.mb(104),this.q2.pub(this.vd.ruleType,this.vd.FB));case -1181828368:return X.a.instance.ga(1720);case -758480861:return X.a.instance.ga(1721);case -13729088:return X.a.instance.ga(1722);case -846654055:return X.a.instance.ga(1723);case 751854001:return X.a.instance.ga(1724);case -453846397:return X.a.instance.ga(1725);case 1102013489:return X.a.instance.ga(1726);case 835813260:return X.a.instance.ga(1727);case 1577787509:return X.a.instance.ga(1728);
case 2083564019:return X.a.instance.ga(1719);default:d.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${ya.toString()}.`)}return null}n9a(){d.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.a$b();let ya,ha;if(!({errorString:ya,qq:ha}=this.yYd()).returnValue)return this.tr(ya),this.tka("OkInvalidByClient",ha),!1;this.Nlj();return!0}Zka(){this.a$b();this.tka("Cancel","None");this.hide()}Qxa(){d.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.hMa?this.Jxe():this.sxe();this.$ej();this.Gja=!0}RV(ya){ya={["ButtonType"]:aa.wha(ya),["DialogName"]:this.oc,["Location"]:"dialog",["NumberOfSelectedRanges"]:z.g(this.$).ha.sa.BK};B.b(this.$).Cd(k.a.G4b,ya)}$ej(){this.wQb=new w;this.Jza()}Jza(){this.zjc.Jza(this.vd);this.idc.Jza(this.vd);this.q2.Jza(this.vd)}a$b(){this.q2.qob(this.vd);this.zjc.qob(this.vd);this.idc.qob(this.vd)}tka(ya,ha){const Da={};aa.mrb(this.vd,Da);Da.o=ya;
Da.p=ha;Da.n=this.Gja;this.Yh&&(this.Yh.stop(),Da.q=this.Yh.id);y.b().Ie(49,Da,!0)}WNb(ya,ha){let Da,nb;nb=Da=null;if(!ya)return ha?(Da=String.format(X.a.instance.mb(105),this.q2.pub(this.vd.ruleType,this.vd.FB),this.q2.Ged(this.vd.ruleType,this.vd.FB)),nb="DataValidationEditNoMinMaxError"):(Da=String.format(X.a.instance.mb(104),this.q2.pub(this.vd.ruleType,this.vd.FB)),nb="DataValidationEditNoValueError"),{returnValue:!1,errorString:Da,qq:nb};if(ya.length>F.W7f)return Da=X.a.instance.ga(1719),{returnValue:!1,
errorString:Da,qq:nb};if(wa.d(ya))return{returnValue:!0,errorString:Da,qq:nb};if(1===this.vd.ruleType||2===this.vd.ruleType||6===this.vd.ruleType){if(!V.a.m4(ya))return Da=X.a.instance.ga(1712),{returnValue:!1,errorString:Da,qq:nb};if(1===this.vd.ruleType&&!V.a.isInteger(ya))return Da=X.a.instance.ga(1713),{returnValue:!1,errorString:Da,qq:nb};if(6===this.vd.ruleType){if(!V.a.isInteger(ya))return Da=X.a.instance.ga(1713),{returnValue:!1,errorString:Da,qq:nb};if(0>parseInt(ya,10))return Da=X.a.instance.ga(1714),
{returnValue:!1,errorString:Da,qq:nb}}}return{returnValue:!0,errorString:Da,qq:nb}}yYd(){let ya,ha;ha=ya=null;if(this.Gja||0===this.vd.ruleType)return{returnValue:!0,errorString:ya,qq:ha};const Da=(0===this.vd.FB||1===this.vd.FB)&&3!==this.vd.ruleType&&7!==this.vd.ruleType;return!({errorString:ya,qq:ha}=this.WNb(this.vd.AN,Da)).returnValue||Da&&!({errorString:ya,qq:ha}=this.WNb(this.vd.BN,Da)).returnValue?{returnValue:!1,errorString:ya,qq:ha}:Da&&(1===this.vd.ruleType||2===this.vd.ruleType||6===this.vd.ruleType)&&
!wa.d(this.vd.AN)&&!wa.d(this.vd.BN)&&parseFloat(this.vd.AN)>parseFloat(this.vd.BN)?(ya=X.a.instance.ga(1717),{returnValue:!1,errorString:ya,qq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:ya,qq:ha}}set ey(ya){super.ey=ya}static wha(ya){switch(ya){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static mrb(ya,ha){ha.a=
e(ya.ruleType);ha.b=f(ya.FB);ha.c=!!ya.AN;ha.d=!!ya.BN;ha.e=ya.d4;ha.f=ya.e4;ha.g=ya.v4;ha.h=!!ya.kF;ha.i=!!ya.PU;ha.j=ya.u4;ha.k=ya.hZ;ha.l=!!ya.fT;ha.m=!!ya.eT}}Object(t.a)(aa,"DataValidationEditDialogDeprecated",T.a,[]);var sa=a(1);class ea{SGa(ya,ha,Da,nb){sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new ma(ya,ha,Da,nb)).mRd():(new aa(ya,ha,Da,nb)).mRd()}G3g(ya,ha){const Da=new G.StandardDialog;Da.Sb=3;Da.$za(ya.rb.zia,X.a.instance.ga(1710),ha)}I3g(ya,
ha){const Da=new G.StandardDialog;Da.Sb=1;Da.mW(ya.rb.zia,X.a.instance.ga(1711),ha)}}Object(t.a)(ea,"DataValidationEditDialogFactory",null,[415]);class Z extends b.a{constructor(ya){super(ya)}Dd(){this.ld([new K(this.$,new ea)])}static ka(ya){b.a.Rd(245,new Z(ya))}}Object(t.a)(Z,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return ua});const ua=()=>{c.a.Fa(Z.ka)}},1146:function(t,D,a){function c(ra,Qa,qb,Wa,ta,ib){if(0===Wa)return Object(la.a)(Ba.UnsupportedZeroResize);if(0>
Wa||0===qb.length)return Object(la.a)(Ba.InvalidInput);if(ra.t4h())return Object(la.a)(Ba.UnsupportedSkeletonInView);const Bb=ra.ye;if(!Bb)return Object(la.a)(Ba.NullSPD);var Ub=Bb.qYe(qb);if(Ub&&0<Ub.length)return Object(la.a)(Ub.length.toString()+" "+Ba.UnsupportedHiddenInRange);a:{for(const mb of qb)ta?mb.right=S.a.Ch:mb.bottom=S.a.mh;Ub=ra.d$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",qb);try{for(Ub.$$rst();Ub.$$mn();)if(Ub.Jn.PCj){var Ta=!0;break a}}finally{Ub&&Ub.dispose()}Ta=!1}if(Ta)return Object(la.a)(Ba.UnsupportedMergeCell);
if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!ta&&"undefined"!==typeof gridRenderer)for(const mb of qb)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(mb.left);ra=ra.Ea;Ta=Aa.a.create().toString();Bb.Ncg(qb,Wa,ta);ib=ra.JPj(ta,ib);Qa.d6i(qb,ta);ra.e2i(ib,Ta,ta?"row":"column");return Object(la.d)(Wa)}var b=a(10);t=a(0);var d=a(220),f=a(7),e=a(15),k=a(86);a(262);var l=a(184),m=a(412),v=a(84),n=a(769),w=a(183),r=a(265),u=a(24),x=a(869),z=a(42);
class B{}B.ADh="GalleryGeneral";B.CDh="GalleryNumber";B.yDh="GalleryCurrency";B.wDh="GalleryAccounting";B.FDh="GalleryShortDate";B.BDh="GalleryLongDate";B.HDh="GalleryTime";B.DDh="GalleryPercentage";B.zDh="GalleryFraction";B.EDh="GalleryScientific";B.GDh="GalleryText";B.DRg="ButtonComma";B.buttonPercentage="ButtonPercentage";B.keyboardNumber="KeyboardNumber";B.keyboardCurrency="KeyboardCurrency";B.keyboardDate="KeyboardDate";B.keyboardTime="KeyboardTime";B.keyboardPercentage="KeyboardPercentage";
Object(t.a)(B,"RibbonFormatKind",null,[]);var y=a(62),A=a(292),K=a(615),G=a(614),T=a(613),W=a(1);class P extends A.a{constructor(ra,Qa,qb,Wa,ta,ib,Bb,Ub,Ta,mb,Qb,Lb=null,Jb=null){super(11,0,Ub,Qb);this.WBh=ra;this.U$c=Qa;this.format=Wa;this.activeCell=qb;this.aqe=ta;this.PFf=ib;this.KFf=Bb;this.xEa=Ta;this.clientCorrelationId=mb;this.Pkb=Lb;this.jhb=Jb}get KF(){return W.EwaSettings.fc()?super.KF:0}get wt(){return this.Pkb}get G$(){return this.jhb}get MAc(){return this.xEa}X1(ra){return super.X1(ra)||
this.WBh.X1(this.U$c,this.activeCell,this.format,this.aqe,this.PFf,this.KFf,this.BYb,this.xEa,this.clientCorrelationId,this.Pkb,this.jhb)}hj(){const ra=[];if(this.fbc)for(const Qa of this.fbc)ra.push(T.a(Qa));else ra.push(new G.a(this.format,this.U$c,this.activeCell));return()=>new K.a(ra)}Jdb(){const ra={OperationType:0};ra.FormatCellsMultiRange=this.U$c;ra.ActiveCell=this.activeCell;ra.Format=this.format;ra.ApplyFormatOnPivotTableValueField=this.aqe;ra.PivotTableXluid=this.PFf;ra.PivotTableFieldCaption=
this.KFf;return ra}}Object(t.a)(P,"FormatCellsBatchOperation",A.a,[]);var E=a(36),H=a(208);class F{}F.editCell="Edited";F.dependentCell="Dependents";Object(t.a)(F,"RecalcPriorityGroupType",null,[]);var N=a(196);const J=ra=>{switch(ra.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return e.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},R=ra=>{if(ra=ra.color){if("String"===Object.getType(ra).getName())return N.a.Zo(ra);
if("Number"===Object.getType(ra).getName())return null}else return null;e.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},M=(ra,Qa)=>{ra=excelOnlineCalc.calc.getCellValueKind(ra.rangeDelta.data.value);switch(ra){case "number":case "string":case "boolean":return!0;case "Blank":if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;Qa.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",
!1))return!0;Qa.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Qa.numberOfUnsupportedRichCellTypes++,!1;default:return e.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${ra}`),!1}},L=ra=>{ra=excelOnlineCalc.calc.getCellValueKind(ra.rangeDelta.data.value);let Qa=0;switch(ra){case "number":Qa=1;break;case "string":Qa=2;break;case "boolean":Qa=3;break;case "Error":Qa=4;break;case "Blank":Qa=0;break;default:e.ULS.shipAssertTag(537162191,
0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${ra}`)}return Qa},U=ra=>{const Qa=ra.value;switch(ra.type){case 2:return void 0===Qa||null===Qa?"":Qa;case 1:return ra=parseFloat(Qa),isNaN(ra)?null:ra;case 3:return ra=parseFloat(Qa),isNaN(ra)?null:1===ra;case 4:return ra=parseFloat(Qa),isNaN(ra)?null:excelOnlineCalc.calc.errorValue(ra);default:return excelOnlineCalc.calc.blankValue}},X=(ra,Qa)=>{const qb=da(Qa);var Wa=!(void 0===Qa.rangeDelta.data.format||null===Qa.rangeDelta.data.format);
e.ULS.shipAssertTag(537162187,0,0===qb||!Wa,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Qa.priorityGroup}`);ra=Math.max(ra.cell.Ek,0);Wa&&(Wa=excelOnlineCalc.calc.getCellFormatKind(Qa.rangeDelta.data.format.format),"number"===Wa?ra=Qa.rangeDelta.data.format.format:"string"===Wa?e.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Wa?e.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):
e.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return ra},da=ra=>{if(ra.priorityGroup===F.editCell)return 0;if(ra.priorityGroup===F.dependentCell)return 1;e.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},fa=ra=>{ra=da(ra);if(0===ra)return 1;if(1===ra)return 2;e.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");
return 0};var S=a(8);class ka{constructor(ra=0,Qa="",qb=0,Wa="",ta=""){this.oJ=ra;this.cellValue=Qa;this.ifmt=qb;this.priorityGroup=Wa;this.Px=ta}}Object(t.a)(ka,"RecalcAccuracyObject",null,[]);class V{}V.string="String";V.blank="Blank";V.general="General";V.HAh="Flexible";Object(t.a)(V,"FormattedUnitKind",null,[]);class wa{constructor(ra=0,Qa=0,qb=0,Wa=0,ta=0,ib=0,Bb=0,Ub=0,Ta=0,mb=0,Qb=0,Lb=0,Jb=0,Ab=0,pb=0,va=!1,db="",Ya=0,gb=null,Ka=null,ub=null,ac=null,Ra=null,na=null,lb=null){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=ra;this.numberOfNonUpdatedCells=Qa;this.numberOfUpdatedCells=qb;this.numberOfCellsUpdatedAlreadyByServer=Wa;this.numberOfCellsSkippedDueToTimeout=ta;
this.numberOfCellsWithNoFormattedCell=ib;this.numberOfUnsupportedErrorCellTypes=Bb;this.numberOfUnsupportedBlankCellTypes=Ub;this.numberOfUnsupportedRichCellTypes=Ta;this.numberOfSkippedCellsDueToMissingLocaleInfo=mb;this.totalExecutionTime=Qb;this.originalProcessingTimeLimit=Lb;this.newProcessingTimeLimit=Jb;this.numberOfEditedRecalcedCellsInBatch=Ab;this.numberOfDependentRecalcedCellsInBatch=pb;this.isNewTask=va;this.lastSetCellInstantaneousOperation=db;this.taskId=Ya;this.isNewNumberFormatter=
gb;this.numberOfRecalcedCellsWithFormattedValue=Ka;this.numberOfRecalcedCellsWithoutFormattedValue=ub;this.totalNumberFormatterTime=ac;this.newNumberFormatterFinalizeFailures=Ra;this.numberOfMeasureTextWidthCalls=na;this.numberOfHashFormattedValues=lb}}Object(t.a)(wa,"RecalcResultProcessingStatistics",null,[]);class ma{constructor(ra,Qa,qb,Wa){this.rangeDelta=ra;this.stateId=Qa;this.isFinished=qb;this.priorityGroup=Wa}}Object(t.a)(ma,"RecalcedCellInfo",null,[]);var ab=a(109),ba=a(11),Ca=a(22),Na=
a(55),za=a(63),la=a(454);class aa{constructor(ra,Qa,qb){this.sca=[];this.calcManager=this.Dxc=this.lastSetCellInstantaneousOperation=null;this.xIf=Wa=>{var ta;if(Wa&&Wa.rangeDeltas){var ib=this.sca.length;for(let Bb=0;Bb<Wa.rangeDeltas.length;Bb++)(null===(ta=Wa.rangeDeltas[Bb])||void 0===ta?0:ta.data)&&void 0!==Wa.rangeDeltas[Bb].data.value&&null!==Wa.rangeDeltas[Bb].data.value&&void 0!==Wa.rangeDeltas[Bb].range&&null!==Wa.rangeDeltas[Bb].range&&this.sca.push(new ma(Wa.rangeDeltas[Bb],Wa.stateId,
Wa.isFinished,Wa.priorityGroup));e.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${Wa.stateId}, priorityGroup=${Wa.priorityGroup}, recalcFinished=${Wa.isFinished}, cellsFromCalc=${Wa.rangeDeltas.length}, initialCellsToRender=${ib}, recalcedCells=${this.sca.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);!ib&&this.sca.length&&this.eAf(!1,0)}};this.$=ra;this.grid=Qa;this.ug=qb;this.oca=aa.lFe;this.$.da.Za(268,Wa=>{this.Dxc=Wa});this.$.da.Za(266,
Wa=>{this.calcManager=Wa});this.yzb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.eqd=W.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.Zni=W.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=this.Dxc=this.ug=this.grid=this.$=null}G9c(ra,Qa,qb,Wa,ta,ib,Bb){if(!Qa)return Object(la.a)("Null");var Ub=excelOnlineCalc.numfmt.renderCallback(Wa,
mb=>gridRenderer.CanvasRendererGlobals.measureTextWidth(mb,ta,!0,W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),Bb);let Ta=ra.renderValue(Qa,Ub);if(!excelOnlineCalc.util.isSuccess(Ta))return Object(la.a)("Finalize");Wa=null;if(Bb=excelOnlineCalc.numfmt.isHashesValue(Ta.value)){if(Ta=ra.renderHashesValue(Ta.value,Ub),!excelOnlineCalc.util.isSuccess(Ta))return Object(la.a)("Hashes")}else Wa=aa.gCh(Qa,Ta.value);Ub=Ta.value;ra=excelOnlineCalc.numfmt.renderedValueToString(Ub);
Qa=J(Ub);Ub=R(Ub);return Object(la.d)({text:ra,valueType:qb,fontColor:Ub,Ek:ib,zNa:Wa,horizontalAlignment:Qa,isHashesValue:Bb})}eAf(ra,Qa){this.$&&this.grid&&this.calcManager&&this.Dxc&&this.calcManager.jD?(ra&&(this.oca=this.Dxc.f$e),this.w0i(this.grid,this.calcManager.jD,ra,Qa),!this.oca&&this.sca.length?Na.Task.delay(0).So(qb=>{this.eAf(!0,qb.id);return!0},0,null,za.a.current):Na.Task.Ua(!0)):(e.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),
Na.Task.Ua(!1))}w0i(ra,Qa,qb,Wa){const ta=ba.HelperMethods.Tb();for(qb=new wa(this.sca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.oca,void 0,void 0,void 0,qb,void 0,Wa,!0,0,0,0,0,0,0);0<this.sca.length;){Wa=ba.HelperMethods.Tb()-ta;if(!this.oca||Wa>this.oca){qb.numberOfCellsSkippedDueToTimeout=this.sca.length;break}Wa=Array.dequeue(this.sca);if(M(Wa,qb)){var ib=u.Range.Tc(Wa.rangeDelta.range.row+1,Wa.rangeDelta.range.column+1);(ib=ra.Xb(ib))?aa.xTg(Wa.stateId,
ib.cell)?(aa.skc(ra,ib,Wa,qb),this.XJg(Qa,ib,Wa,qb)):qb.numberOfCellsUpdatedAlreadyByServer++:qb.numberOfCellsWithNoFormattedCell++}}Wa=Math.round(ba.HelperMethods.Tb()-ta);this.lTj(Wa);this.TFj(qb,Wa);this.hej(qb)}XJg(ra,Qa,qb,Wa){var ta,ib,Bb,Ub,Ta=X(Qa,qb);const mb=qb.rangeDelta.data.formatted,Qb=L(qb),Lb=da(qb);ra=this.G9c(ra,mb,Qb,Qa.cell.uAa,Qa.cell.oha,Ta,!1);Ta=Qa.cell.dCc;if(Object(la.c)(ra))if(this.yzb&&this.eqd){if(0===Lb||Qa.text!==ra.value.text)this.Zni&&0===Lb&&this.OPd(Ta,ra.value)&&
(Qa.cell.Rh=Ta),this.ug.yYa(Qa,ra.value),qb=fa(qb),this.ug.v6c(Qa,this.lastSetCellInstantaneousOperation,2,qb,!0,!0),0===Lb&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.jrf(Qa.range):e.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),Wa.numberOfUpdatedCells++}else Qa.text!==ra.value.text&&(this.ug.yYa(Qa,ra.value),qb=
fa(qb),this.ug.v6c(Qa,this.lastSetCellInstantaneousOperation,2,qb,!0,!0),Wa.numberOfUpdatedCells++);else switch(ra.reason){case "Null":Wa.numberOfRecalcedCellsWithoutFormattedValue=(null!==(ta=Wa.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==ta?ta:0)+1;break;case "Hashes":Wa.numberOfHashFormattedValues=(null!==(ib=Wa.numberOfHashFormattedValues)&&void 0!==ib?ib:0)+1;break;case "Finalize":Wa.newNumberFormatterFinalizeFailures=(null!==(Bb=Wa.newNumberFormatterFinalizeFailures)&&void 0!==Bb?
Bb:0)+1}Object(la.b)(ra)&&"Null"!==ra.reason&&(Wa.numberOfRecalcedCellsWithFormattedValue=(null!==(Ub=Wa.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ub?Ub:0)+1);Wa=0===Lb?Qa.cell.userInput:Qa.formulaBarText;Ub=Object(la.c)(ra)?ra.value.text:"";qb=Object(la.b)(ra)?ra.reason:"";e.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Qa.range.top}, ${Qa.range.left}) 2nd pass formatting, success: ${ra.success}, reason: ${qb}, priority: ${Lb}, ifmt: ${Qa.cell.Ek}, input: '${Wa?
Ca.a.dM(Wa):"null"}', prediction: '${Ub?Ca.a.dM(Ub):"null"}',`)}lTj(ra){this.oca=Math.max(this.oca-Math.max(ra,1),0)}TFj(ra,Qa){ra.numberOfNonUpdatedCells=this.sca.length;ra.totalExecutionTime=Qa;ra.newProcessingTimeLimit=this.oca;ra.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}hej(ra){ra=Sys.Serialization.JavaScriptSerializer.serialize(ra);e.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${ra}`)}static gCh(ra,Qa){ra=ra.units;var qb=
Qa.units;if(ra.length!==qb.length)return e.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Qa=[];let Wa=-1;for(let ta=0;ta<ra.length;ta++)switch(ra[ta].kind){case V.blank:Qa.push(...ab.h(" ",qb[ta].str.length));break;case V.string:Qa.push(ra[ta].str);break;case V.HAh:Qa.push("");Wa=ta;break;case V.general:Qa.push(qb[ta].str);break;default:e.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Wa||""===qb[Wa].str)return null;qb={};qb.Start=Qa.slice(0,Wa).join("");qb.Separator=ra[Wa].str;qb.End=Qa.slice(Wa+1,Qa.length).join("");return qb}static WIh(ra){return ra&&ra&&ra.cu?ra.cu.mJ:S.a.ze}static xTg(ra,Qa){if(!Qa)return!1;Qa=aa.WIh(Qa);return Qa===S.a.ze||Qa===ra}static skc(ra,Qa,qb,Wa){var ta=qb.rangeDelta.data.value.toString();const ib=L(qb),Bb=X(Qa,qb);ta=new ka(ib,ta,Bb,qb.priorityGroup);Qa.cell.skc(ta,
ra.Ea.L4);1===da(qb)?Wa.numberOfDependentRecalcedCellsInBatch++:Wa.numberOfEditedRecalcedCellsInBatch++}OPd(ra,Qa){return null==ra?!1:!!ra.TextRuns&&!!ra.Fonts&&ra.Text===Qa.text&&2===Qa.valueType}}aa.lFe=20;Object(t.a)(aa,"CalcResultProcessor",null,[538,3]);class sa{constructor(ra,Qa=null,qb=""){this.success=ra;this.xkc=Qa;this.reason=qb}}Object(t.a)(sa,"GetRibbonNumberFormatResult",null,[]);var ea=a(904);class Z{constructor(ra,Qa){this.rx=null;this.Ea=ra;this.Q1a=Qa}Ubb(ra,Qa,qb,Wa,ta=!1,ib=!1){ra&&
(ra.R_(Qa,qb,ta,ib),ra.verticalAlignment=Wa)}EJb(ra,Qa,qb){this.rx||(this.rx=new ea.a(this.Ea,this.Q1a));this.rx.EJb(ra,Qa,qb)}}Object(t.a)(Z,"FormatCellsActionModelAccessor",null,[537]);var ua=a(209),ya=a(28),ha=a(31),Da=a(281),nb=a(250),qa=a(280),pa=a(74);class Ja{constructor(){this.yeg=this.qWj=!1;this.source=0;this.Gva=this.Tfc=!1}}Object(t.a)(Ja,"FormatCellInstantaneousResult",null,[]);class $a{constructor(ra,Qa){this.success=ra;this.Px=Qa}}Object(t.a)($a,"FormatStringResult",null,[]);var rb=
a(21),Pa=a(200),eb=a(1079),Ob=a(43),tb=a(514),cc=a(51),Ib=a(199),Mb=a(261),Oa=a(79),Aa=a(171),Ba;(function(ra){ra.InvalidInput="invalid input";ra.UnsupportedZeroResize="resizing to 0 - ignore";ra.UnsupportedSkeletonInView="skeleton in view - ignore";ra.NullSPD="ActiveSheetProcessedData is null";ra.UnsupportedHiddenInRange="hiddens in resizeRanges";ra.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Ba||(Ba={}));Object(t.b)("InstantaneousRowColumnResizeFailureReason",Ba);
var ob=a(174);class xb{constructor(ra){this.rx=this.calcManager=this.pz=this.FRa=null;this.yJi=(Qa,qb)=>{if(Qa&&!Da.a(Qa)&&qb){const Wa=!!Qa&&!!Qa.RequestTelemetryData;rb.g(this.$).Ci.Cka(qb.toString(),Qa.StateId,Wa?Qa.RequestTelemetryData.EcsOperationDuration:0,Wa?Qa.RequestTelemetryData.EcsRequestDuration:0,Wa?Qa.RequestTelemetryData.WfeRequestDuration:0)}};this.$=ra;this.$.da.Za(268,Qa=>{this.pz=Qa});this.XBh=new Z(rb.g(this.$).Ea,this.$);this.Lga=new aa(this.$,rb.g(this.$),this);this.$.da.Za(266,
Qa=>{this.calcManager=Qa});this.xb=W.EwaSettings.xb();this.Im=W.EwaSettings.Im();this.yzb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.eqd=W.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.ZLa=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.$ni=W.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}get aua(){return this.XBh}get jD(){return void 0===
this.calcManager||null===this.calcManager?null:this.calcManager.jD}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){k.a.rc([this.FRa,this.Lga]);this.$=this.Lga=this.FRa=null}vRa(ra,Qa,qb,Wa,ta=!1,ib="",Bb,Ub=0,Ta=null){return this.Gzj(ra,Qa,qb,ta,Ub,ib,void 0,Ta)}v6c(ra,Qa,qb,Wa,ta,ib){ra.cell.cu.zJ|=Wa;xb.F_g(rb.g(this.$),ra,qb,ta);this.Lga.lastSetCellInstantaneousOperation=Qa;ib&&rb.g(this.$).Ci.a0(Qa,pa.BasicTelemetryCalculator.uQ)}nda(ra,
Qa,qb,Wa=!1,ta=null,ib=null){ib=ib||ra.ha.sa.selectedRanges;if(!(-1690267012===Qa&&1<ib.length)){-1690267012===Qa&&e.ULS.shipAssertTag(537162176,0,1===ib.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${ib.length}`);ib=ra.d$("FormatCellsAction.ShowInstantaneousFormatting",ib);try{ib.$$rst();let Bb=!1;for(;ib.$$mn();){let Ub;const Ta=ib.$$cu().GH?ra.cJb(ib.$$cu().range):(Ub=new l.a,Ub.add(ib.$$cu()),Ub);for(let mb of Ta)if(rb.g(this.$),!mb||ib.fb.contains(mb.range))if(this.t2f(Qa,
mb,qb,Wa,ta,ib.$$cu().GH),Bb||(ra.Ea.SU(),Bb=!0),ta)break}}finally{ib&&ib.dispose()}}}yYa(ra,Qa,qb=null){qb&&(qb.Gva=!0);qb=!Qa.text;const Wa=Ca.a.ief(Qa.text);let ta;const ib=ra.GH?rb.g(this.$).cJb(ra.range):(ta=new l.a,ta.add(ra),ta);for(let Bb of ib)this.VJg(this.$,Bb,Qa.text,Qa.horizontalAlignment,Qa.fontColor,Qa.Ek,ra.cell.Ek,qb,Wa,Qa.valueType,Qa.zNa);ra.cell.BAc()}sWi(ra,Qa,qb,Wa,ta=null){try{const ib=z.D(Qa);let Bb=z.D(qb);if(ra.Db.O5a(ib)||ra.Db.O5a(Bb))return 8;if(-185374993!==Wa&&this.Uli(ra,
ib,Bb))return 9;if(-185374993!==Wa&&(ra.Db.q4(Bb)||ra.Db.Tyb(ib)))return 10;if(1804571062!==Wa&&ra.Db.o4(Bb))return 11;if(this.Jgh(Bb))return 12;if(this.Nmi(ib,Bb))return 13;const Ub=this.$.Hb.xc("UserAction","PasteInstantaneous");Ub.start();tb.a(Ub);ta&&cc.b().FA(Ub.id,ta.id,"actions","actions");!ib.isSingle&&Bb.isSingle&&(Bb=xb.expandRange(ib,Bb),ra.ha.updateSelection(Bb,Bb,0));switch(Wa){case 237279923:case 808159687:if(!this.KWi(ib,Bb))return 14;this.l1c(ra,ib,Bb,!0,!1);break;case 1804571062:this.l1c(ra,
ib,Bb,!0,!1);break;case -185374993:this.l1c(ra,ib,Bb,!1,!0);break;default:return 2}e.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(ib){return e.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(ib)}`),15}}AXg(ra,Qa){for(const qb of ra)this.PZc(qb,!0,Qa)}PZc(ra,Qa,qb=""){if(ra){var Wa=rb.g(this.$);if(Qa){if(Qa=Wa.kk("FormatCellsAction.ClearRangeInstantaneous",ra),Wa=
ra.isSingle?null:ra,Qa.$$mn()&&void 0!==Qa.$$cu()&&null!==Qa.$$cu())for(ra=Object(f.a)(new Mb.a,{Text:""}),this.vRa(Qa.$$cu(),ra,!1,void 0,E.a.Ymd(this.$),qb,void 0,void 0,Wa);Qa.$$mn();)void 0!==Qa.$$cu()&&null!==Qa.$$cu()&&this.vRa(Qa.$$cu(),ra,!1,void 0,!1,qb)}else this.nda(Wa,-1228228458,{},void 0,void 0,[ra])}else e.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}d6i(ra,Qa){if(!Qa){Qa=ba.HelperMethods.Tb();var qb=rb.g(this.$),Wa=qb.d$("FormatCellsAction.ReformatCells",
ra);try{Wa.$$rst();let ta=!1;for(;Wa.$$mn();){const ib=Wa.$$cu().cell;if(0===ib.oJ||2===ib.oJ)this.updateSpillInformation(ib,ra),ta||(qb.Ea.SU(),ta=!0)}}finally{Wa&&Wa.dispose()}e.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${ba.HelperMethods.Tb()-Qa}.`)}}Wgd(ra,Qa){if(this.xb){if(ra.formulaBarText)return!Ca.a.equals(Qa.Text,ra.formulaBarText,!1);let qb=ra.cell.Rh;qb=nb.a(qb,ra.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(qb,
Qa).isEqual}return!Ca.a.equals(Qa.Text,ra.text,!1)}lTe(ra,Qa,qb,Wa){if(void 0===Qa||null===Qa)return new $a(!1,ra);const ta={};ta.value=ra;ta.type=1;Qa=this.k2a(ta,Qa,qb,Wa);return Object(la.b)(Qa)?new $a(!1,ra):new $a(!0,Qa.value.text)}Hzj(ra,Qa,qb,Wa){return c(ra,this,Qa,qb,Wa,!0)}Ezj(ra,Qa,qb){if(!this.Wgd(Qa,qb))return Object(la.d)("Skip unchanged cell content");Qa=Qa.cell;qb=this.nTe(qb.Text,Qa.Ek,Qa.uAa,Qa.oha,!0);if(Object(la.b)(qb))ra=qb;else{qb=qb.value;var Wa=Qa.hasRichValueIcon?"Unsupported rich value icon":
Qa.n7?"Unsupported wrapped text":Qa.Xgf||null!=Qa.pL&&0!==Qa.pL?"Unsupported rotated text":!0;!0!==Wa?ra=Object(la.a)(Wa):(Qa.isCellWidthFixed?Wa="Skip fixed width cell":(Wa=qb.valueType,Wa=0===Wa?"Skip empty cell value":2===Wa?"Skip string cell value":Qa.rF&&!Qa.Oli?"Skip merged cell":Qa.rwc?"Skip shrunk to fit":qb.isHashesValue?"Skip hashes cell value":!0),!0!==Wa?ra=Object(la.d)(Wa):(qb=Qa.h1g(qb.text),qb>Qa.offsetWidth?(Qa=[Qa.getRange().clone()],ra=c(ra,this,Qa,qb,!1,!1),ra=Object(la.b)(ra)?
ra:Object(la.d)(qb)):ra=Object(la.d)("Column is wide enough")))}return ra}kTe(ra,Qa,qb,Wa,ta){const ib={};ib.value=ra;ib.type=qb;Qa=this.k2a(ib,Qa,Wa,ta);return Object(la.b)(Qa)?new $a(!1,ra):new $a(!0,Qa.value.text)}updateSpillInformation(ra,Qa){const qb=ra.getRange();let Wa=!1;for(const ta of Qa)if(qb.left===ta.left){Wa=!0;break}ra.ZPj(Wa)}Gzj(ra,Qa,qb,Wa,ta,ib="",Bb=1,Ub=null){this.yzb&&this.$ni&&(ra.cell.dCc=Qa);const Ta=new Ja;Ta.source=0;Ta.Gva=!1;ra.cell.IEb=ra.cell.Ek;let mb=Qa.Text;const Qb=
!mb,Lb=Ca.a.ief(mb);Ca.a.yq(mb)&&(e.ULS.shipAssertTag(537162142,0,!((void 0===mb||null===mb)&&void 0!==Qa.TextRuns&&null!==Qa.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Qa=Object(f.a)(new Mb.a,{Text:""}),mb="");ra.cell.userInput=mb;if(!this.Wgd(ra,Qa))return this.cVg(ra,ta,Qb,Lb,Ta);qb?this.WUg(ra,mb,this.$.workbookContext.DefaultHyperlinkStyle,Ta):this.QUg(ra,Qa,mb,Qb,Lb,Wa,Ta,Ub);this.v6c(ra,ib,ta,Bb,Ta.Tfc,Ta.Gva);return Ta}cVg(ra,Qa,
qb,Wa,ta){ta.yeg=!0;ta.Tfc=!0;ta.Gva=!1;0===Qa&&rb.g(this.$).Ea.SU();0===ra.cell.kya&&(qb?ra.cell.R_(0,!1):Wa&&ra.cell.R_(1,!1));this.hWd(ra.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return ta}WUg(ra,Qa,qb,Wa){Wa.Gva=!0;ra.insertHyperlink(Qa,H.a.n$c(Qa),qb);this.hWd(ra.range,"FormatCellsAction.cellDataEntryCSE")}QUg(ra,Qa,qb,Wa,ta,ib,Bb,Ub=null){Bb.Gva=!1;const Ta=ra.cell;this.pz||(this.pz=this.$.da.za(268));this.NLj(this.pz,Ta.Ek);Wa||ta?this.SUg(ra,Wa,ta,Bb):(Wa=this.nTe(qb,Ta.Ek,Ta.uAa,
Ta.oha,!1),Object(la.c)(Wa)?(this.OPd(Qa.TextRuns,Qa.Fonts)&&this.UUg(ra,Qa,Wa.value),this.yYa(ra,Wa.value,Bb),this.hWd(ra.range,"FormatCellsAction.cellDataEntryCSE")):this.yzb&&this.eqd?this.$Ug(ra,Qa.Text,Bb):this.aVg(ra,Qa.Text),Qa=Object(la.c)(Wa)?Wa.value.text:"",ta=Object(la.b)(Wa)?Wa.reason:"",e.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${ra.range.top}, ${ra.range.left}) 1st pass formatting, success: ${Wa.success}, reason: ${ta}, ifmt: ${Ta.Ek}, input: '${Ca.a.sYa(Ta.userInput)}', prediction: '${Ca.a.sYa(Qa)}',`));
Ta.formulaBarText=qb;ib&&this.mLj(this.pz,ra,qb,Ub);Bb.Tfc=!0}SUg(ra,Qa,qb,Wa){Wa.Gva=!0;ra.text="";ra.formulaBarText="";ra.cell.userInput="";this.g0b(ra,null,null,Qa,qb)}UUg(ra,Qa,qb){Qa.Text===qb.text&&2===qb.valueType&&(ra.cell.Rh=Qa)}$Ug(ra,Qa,qb){qb&&(qb.Gva=!0);ra.text=Qa;ra.formulaBarText=Qa;this.g0b(ra,1)}aVg(ra,Qa){ra.text=Qa;ra.formulaBarText=Qa;this.g0b(ra,1)}g0b(ra,Qa,qb=null,Wa=!1,ta=!1,ib=!1){let Bb=ra.horizontalAlignment;qb=null!=qb?qb:ra.verticalAlignment;0===ra.cell.kya&&(null!=Qa||
Wa||ta||ib)&&(Wa?Bb=0:ta||ib?Bb=1:null!=Qa&&(Bb=Qa),this.aua.Ubb(ra,Bb,!1,qb,!0))}hWd(ra,Qa){if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const qb=rb.g(this.$),Wa=()=>{this.calcManager?this.calcManager.jrf(ra):e.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Qa}, cell ${ra}`);qb.Wb.Al(Wa)};qb.Wb.jm(Wa)}}NLj(ra,Qa){(null===ra||void 0===ra?0:
ra.Gxa)&&Qa>=xb.pAh&&Qa>ra.Gxa.length-1&&(e.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Qa}. Triggering refresh...`),ra.cTe())}mLj(ra,Qa,qb,Wa=null){if(void 0!==ra&&null!==ra)if(this.pz.okd)e.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var ta=this.$.da.za(266);ta&&(this.Lga.oca=aa.lFe,ra&&(this.Lga.oca=ra.f$e),ta.NSg(Qa,qb,this.Lga.xIf,Wa))}}k2a(ra,Qa,qb,Wa){var ta=
this.$.da.za(266);if(!ta)return Object(la.a)("calcManager is null");if(!ta.jD)return Object(la.a)("calcManager.NumberFormatter is null");if(!this.pz)return Object(la.a)("instantaneousManager is null");let ib;if("number"===typeof Qa||"string"===typeof Qa){var Bb=ta.R$b(Qa);if(!Object(la.c)(Bb))return Bb;ib=Bb.value}else ib=Qa;Bb=ta.jD;const Ub=U(ra);if(void 0===Ub||null===Ub)return Object(la.a)("cellValue is null");ta=excelOnlineCalc.calc.cellValueToReadOper(ta.config.mathpack,Ub);if(void 0===ta||
null===ta)return Object(la.a)("readOper is null");ta=Bb.applyFormat(ib,ta,W.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(ta)?this.Lga.G9c(Bb,ta.value,ra.type,qb,Wa,"number"===typeof Qa?Qa:-1,!1):Object(la.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(ta.reason.kind))}nTe(ra,Qa,qb,Wa,ta){var ib=this.$.da.za(266);if(void 0===ib||null===ib)return Object(la.a)("calcManager is null");if(void 0===ib.jD||null===ib.jD)return Object(la.a)("calcManager.NumberFormatter is null");
if(void 0===this.pz||null===this.pz)return Object(la.a)("instantaneousManager is null");if(this.yzb&&!ta)return Object(la.a)("No main thread number formatter");var Bb=ib.R$b(Qa);if(!Object(la.c)(Bb))return Bb;var Ub=Bb.value;Bb=ib.jD;ra=Bb.parseEdit(ra,Ub);if(!excelOnlineCalc.util.isSuccess(ra))return Object(la.a)(`ParseEdit failure: reason=${ra.reason.kind}, features=${ra.reason.features}`);if(ra.value.kind===x.a.formula)return Object(la.a)("Main thread - skipping formula edit");ib=excelOnlineCalc.numfmt.applyValueEdit(Bb,
ib.localeInfo,Ub,ra.value);if(!excelOnlineCalc.util.isSuccess(ib))return Object(la.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(ib.reason.kind));ra=ra.value;e.ULS.shipAssertTag(537162190,0,ra.kind!==x.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ra=excelOnlineCalc.numfmt.getValueEditOperKind(ra);Ub=0;switch(ra){case 0:case 128:Ub=0;break;case 1:Ub=1;break;case 2:Ub=2;break;case 4:Ub=3;break;case 8:Ub=4;break;case 16:case 32:case 64:case 256:e.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${ra} to a CellValueType`);break;default:e.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${ra}`)}return this.Lga.G9c(Bb,ib.value,Ub,qb,Wa,"number"===typeof Qa?Qa:-1,ta)}Uli(ra,Qa,qb){if(Qa.width<qb.width){const Wa=ra.kk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new u.Range(Qa.top,Qa.left,Qa.bottom,Qa.left,!0,!0));for(;Wa.$$mn();){let ta=Wa.$$cu();if(ta&&
ta.gKa())return e.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Qa.height<qb.height)for(ra=ra.kk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new u.Range(Qa.top,Qa.left,Qa.top,Qa.right,!0,!0));ra.$$mn();)if((Qa=ra.$$cu())&&Qa.jKa())return e.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}l1c(ra,Qa,qb,Wa,ta){const ib=Qa.VR().FirstRow,Bb=Qa.VR().LastRow;
var Ub=qb.VR().FirstRow;const Ta=qb.VR().LastRow;let mb=ib;for(;Ub<=Ta;Ub++,mb++){mb>Bb&&(mb=ib);const Qb=Qa.VR();Qb.FirstRow=Qb.LastRow=mb;const Lb=qb.VR();Lb.FirstRow=Lb.LastRow=Ub;this.H2g(ra,w.a.bQ(Qb),w.a.bQ(Lb),Wa,ta)}}KWi(ra,Qa){const qb=this.$.da.za(266);return void 0!==qb&&null!==qb?(qb.HSg(ra,Qa.topLeft,this.Lga.xIf),!0):!1}Nmi(ra,Qa){const qb=ra.right-ra.left+1;ra=ra.bottom-ra.top+1;const Wa=Qa.right-Qa.left+1;Qa=Qa.bottom-Qa.top+1;if(Wa>qb&&Qa>ra){if(!(Wa%qb&&Qa%ra))return!0}else if(Wa===
qb&&Qa>ra){if(!(Qa%ra))return!0}else if(Wa>qb&&Qa===ra&&!(Wa%qb))return!0;return!1}Jgh(ra){if(W.EwaSettings.ma(102)){ra=rb.g(this.$).x0(ra).gridView.getRangeInformation(ra);for(const Qa of ra)if(Object(m.a)(r.DynamicArrayRange,Qa)&&!Object(v.a)(r.DynamicArrayRange,Qa).kkc)return!0}return!1}aBe(ra,Qa,qb,Wa,ta,ib){for(let Bb of Qa)qb&&(this.L2g(Bb,ta),Bb.setCell(!0)),Wa&&(ib=this.p2h(ta,Bb)),ib||(ra.Ea.SU(),ib=!0);return ib}UNh(ra,Qa,qb){Qa=new u.Range(Qa,qb,Qa,qb,!0,!0);return ra.Xb(Qa)}H2g(ra,Qa,
qb,Wa,ta){if(qb){this.FRa&&qb.equals(this.FRa.range)||(k.a.Ia(this.FRa),this.FRa=ra.kk("FormatCellsAction.CopyBetweenRows",qb));qb=this.FRa;qb.$$rst();var ib=!1;if(W.EwaSettings.getBooleanFeatureGate(ob.a.YDe,!1)){var Bb=Qa.VR().FirstColumn+1,Ub=Qa.VR().LastColumn+1;Qa=Qa.VR().FirstRow+1;let mb=Bb;for(;qb.$$mn();){mb>Ub&&(mb=Bb);const Qb=this.UNh(ra,Qa,mb);mb+=1;var Ta=void 0;const Lb=qb.$$cu().GH?ra.cJb(qb.$$cu().range):(Ta=new l.a,Ta.add(qb.$$cu()),Ta);Qb&&(ib=this.aBe(ra,Lb,Wa,ta,Qb,ib));Oa.lastOrDefault(Lb)}}else for(Ta=
ra.kk("FormatCellsAction.CopyBetweenRows2",Qa);qb.$$mn();)Ta.$$mn()||(Ta.$$rst(),Ta.$$mn()),Ub=Ta.$$cu(),Qa=qb.$$cu().GH?ra.cJb(qb.$$cu().range):(Bb=new l.a,Bb.add(qb.$$cu()),Bb),Ub&&(ib=this.aBe(ra,Qa,Wa,ta,Ub,ib)),Oa.lastOrDefault(Qa)}else e.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}P2f(){const ra=ha.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");Ob.a(this.$).nj(ra)}Cxi(ra,Qa){const qb={ValidMembers:32},Wa=Qa.NumberFormat;switch(ra){case 1890566896:if(1001===
Wa||1002===Wa||1003===Wa){qb.NumberFormat=14;qb.NumberFormatOptions={};switch(Wa){case 1001:qb.NumberFormatOptions.TimeType=2;break;case 1002:qb.NumberFormatOptions.DateType=7;break;case 1003:qb.NumberFormatOptions.DecimalPlaces=0}qb.NumberFormatOptions.NumberFormatCategory=this.KJg(Wa)}else qb.NumberFormat=Wa;break;case 1886928607:qb.NumberFormat=13;break;case -992833457:qb.NumberFormat=11;break;case 218524921:qb.NumberFormat=12;break;case 996232352:qb.NumberFormat=14;qb.NumberFormatOptions=Object(f.a)(new n.a,
{DecimalPlaces:0});qb.NumberFormatOptions.NumberFormatCategory=6;break;default:return Qa}return qb}formatCells(ra,Qa,qb,Wa=null,ta=null,ib=null,Bb=null){const Ub=this.$.Hb.xc("UserAction","FormatCellsInstantaneous, command = "+cc.b().mj(ra)),Ta=this.$.Hb.Ng("UserAction","FormatCellsInstantaneousFrame");Ta.start();tb.a(Ta);var mb=cc.b().mj(ra);const Qb=this.$,Lb=rb.g(Qb);var Jb=Lb.ha.sa,Ab=ta||Jb.selectedRanges,pb=ab.g(Ab,Ka=>Ka.TG);mb=`${mb}, cellCount=${pb}`;rb.g(this.$).Ci.O6(1,Ub.id,mb);Ab=z.r(Ab,
this.$);Jb=Jb.activeCell;mb=-168056295===qb.command;var va=pb=null;if(mb){va=Lb.Db.ap(Jb);if(!va){this.P2f();return}pb=va.dca.substring(1,va.dca.length-1);va=va.W9b();if(!va){this.P2f();return}va=va.Caption}Lb.Cf.UG(!1,!0);const db=z.o(Jb,Qb),Ya=Qb.pa.va.Qb({MZ:!0,bZ:1}),gb=this.Cxi(qb.command,Qa);mb||this.nda(Lb,ra,Qa,!1,Wa,ta);Ub.stop();rb.g(this.$).Ci.a0(Ub.id,pa.BasicTelemetryCalculator.uQ);qb.mbi=ya.a.Wa.Nb;Wa=this.$.Hb.xc("UserAction","FormatCellsUserAction");this.Pti(ra,qb.taskId,Qa,Ab,Jb,
Wa.id);cc.b().FA(Ub.id,Wa.id,"actions","actions");cc.b().FA(Ta.id,Wa.id,"actions","actions");W.EwaSettings.fc()?Qb.userOperationManager.Ub(new P(this,Ab,db,gb,mb,pb,va,Ya,Wa,Ub.id,64,ib,Bb),qb):Qb.userOperationManager.Ub(new P(this,Ab,db,gb,mb,pb,va,Ya,Wa,Ub.id,0,ib,Bb),qb)}X1(ra,Qa,qb,Wa,ta,ib,Bb,Ub,Ta,mb,Qb){const Lb=this.$;return(Jb,Ab,pb)=>{Lb.sy();Jb=[Jb,this.yJi];Ab=[Ab];mb&&Jb.push(mb);Qb&&Ab.push(Qb);return y.l(Lb.pa.va,ra,Qa,qb,Wa,ta,ib,!1,qa.b(...Jb),qa.a(...Ab),pb,Ta,Bb,Ub)}}t2f(ra,Qa,
qb,Wa,ta,ib,Bb=null){if(Qa&&qb){var Ub=qb.Font,Ta=qb.HorizontalAlignment,mb=qb.VerticalAlignment;qb.ValidMembers&2||(Ta=Qa.horizontalAlignment);qb.ValidMembers&1||(mb=Qa.verticalAlignment);var Qb=0!==Ta;xb.ydi(ra)&&0===Ta&&(Ta=this.tYe(Qa));var Lb=!1;switch(ra){case -394785302:this.aua.Ubb(Qa,Ta,Qb,0);break;case 1041132226:this.aua.Ubb(Qa,Ta,Qb,1);break;case -571165336:this.aua.Ubb(Qa,Ta,Qb,2);break;case -1150205178:case -1142465846:case -286432209:this.aua.Ubb(Qa,Ta,Qb,mb,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.ZLa&&
this.joj(Qa,qb,Qb);break;case 1650812936:this.setFillColor(Qa,qb,ib);break;case -287251124:Qa.bold=Ub.Bold;break;case -1690267012:rb.g(this.$).ha.sa.xg&&(Ub=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?Bb?Bb:rb.g(this.$).ha.sa.Wc:rb.g(this.$).ha.sa.Wc,this.aua.EJb(Qa,qb,Ub));break;case 1970784898:qb=N.a.Zo(Qa.color,Qa.backgroundColor);if(ua.a.compare(qb,ua.a.red)&&(Ca.a.m4(Qa.text)||Ca.a.r5e(Qa.text)))break;qb=ua.a.hH(Ub.FontColor);Qa.color=
Ib.e(N.a.iG(qb));break;case -1925065947:Qa.italic=Ub.Italic;break;case -1293291468:Qa.fontName=Ub.FontName;this.Im&&Qa.BYf(Ub.FontScheme);break;case 862890474:case 963349338:Qa.fontSize=Ub.FontSize;this.$.pf();break;case -1077965542:Qa.fontSize=Ub.FontSize;break;case 1764140053:Qa.underline=Ub.Underline;break;case -1685033574:Qa.doubleUnderline=Ub.DoubleUnderline;break;case -1590502662:Qa.fontStrikethrough=Ub.Strikethrough;break;case -848953656:case 2045211913:Lb=Qa.apb();break;case 2105621672:qb=
Object(v.a)(eb.a,ta);if(!qb)break;Ub=ua.a.$Ch(qb.color);Qa.color=Ib.e(N.a.iG(Ub));this.gqe(Qa,qb.Bkc);break;case -1409276245:this.gqe(Qa,qb.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.UJg(Qa,qb);break;case -1228228458:Qa.apb();Qa.clearFormat();this.YUc(Qa,0);Lb=!0;break;case -730106152:Qa.clearFormat();this.YUc(Qa,0);break;case 932244020:this.ioj(Qa,qb,ib);break;case -1942512156:case -1920201820:this.iqj(Qa,qb)}Wa||(Lb?Qa.$Gb(!0):Qa.setCell(!0))}else e.ULS.shipAssertTag(537162135,
0,!Qa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),e.ULS.shipAssertTag(537162134,0,!qb,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}L2g(ra,Qa){ra&&Qa?(ra.jpb(Qa),ra.i_c(Qa),this.YUc(ra,Qa.cell.Ek)):e.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}YUc(ra,Qa){if(0>Qa)this.sba({caller:"ApplyNumberFormatIndexOnCell",cell:ra,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var qb=this.k2a(ra.Cy,Qa,ra.cell.uAa,ra.cell.oha);Object(la.b)(qb)?this.sba({caller:"ApplyNumberFormatIndexOnCell",cell:ra,kind:"failure",reason:qb.reason}):(this.yYa(ra,qb.value),this.sba({caller:"ApplyNumberFormatIndexOnCell",cell:ra,kind:"success",Px:qb.value,format:Qa}))}}gqe(ra,Qa){if(void 0===Qa||null===Qa)this.sba({caller:"ApplyNumberFormatStringOnCell",cell:ra,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var qb=this.k2a(ra.Cy,Qa,ra.cell.uAa,
ra.cell.oha);Object(la.b)(qb)?this.sba({caller:"ApplyNumberFormatStringOnCell",cell:ra,kind:"failure",reason:qb.reason}):(this.yYa(ra,qb.value),this.sba({caller:"ApplyNumberFormatStringOnCell",cell:ra,kind:"success",Px:qb.value,format:Qa}))}}UJg(ra,Qa=null){if(Qa)if(Qa=this.gVh(ra,Qa),Qa.success){var qb=this.k2a(ra.Cy,Qa.xkc,ra.cell.uAa,ra.cell.oha);Object(la.b)(qb)?this.sba({caller:"ApplyNumberFormatCategoryOnCell",cell:ra,kind:"failure",reason:qb.reason,format:Qa.xkc}):(this.yYa(ra,qb.value),this.sba({caller:"ApplyNumberFormatCategoryOnCell",
cell:ra,kind:"success",Px:qb.value,format:Qa.xkc}))}else this.sba({caller:"ApplyNumberFormatCategoryOnCell",cell:ra,kind:"failure",reason:Qa.reason,format:Qa.xkc});else this.sba({caller:"ApplyNumberFormatCategoryOnCell",cell:ra,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}KJg(ra){switch(ra){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<ra?-1:ra}gVh(ra,
Qa){if(!this.pz||!this.localeInfo||!Qa)return ra=this.pz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new sa(!1,void 0,"GetRibbonNumberFormat: "+ra);Qa=Qa.NumberFormat;switch(Qa){case 0:ra=B.ADh;break;case 1:ra=B.CDh;break;case 2:ra=B.yDh;break;case 3:ra=B.wDh;break;case 4:ra=B.FDh;break;case 5:ra=B.BDh;break;case 6:ra=B.HDh;break;case 7:ra=B.DDh;break;case 8:ra=B.zDh;break;case 9:ra=B.EDh;break;case 10:ra=B.GDh;break;case 11:case 12:return this.pz.cTe(),
this.nLh(ra,Qa);case 13:ra=B.DRg;break;case 1006:ra=B.buttonPercentage;break;case 1004:ra=B.keyboardNumber;break;case 1005:ra=B.keyboardCurrency;break;case 1002:ra=B.keyboardDate;break;case 1001:ra=B.keyboardTime;break;case 1003:ra=B.keyboardPercentage;break;case 14:return ra="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",e.ULS.shipAssertTag(537162132,0,!1,ra),new sa(!1,void 0,ra);default:return ra="GetRibbonNumberFormat: unknown NumberFormatType!",e.ULS.shipAssertTag(537162131,
0,!1,ra),new sa(!1,void 0,ra)}return ra?(ra=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,ra))?new sa(!0,ra):new sa(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new sa(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}nLh(ra,Qa){if(!this.calcManager||!this.jD)return Qa=this.calcManager?"numberFormatter is null":"calcManager is null",new sa(!1,void 0,"GetDecimalChangeNumberFormat: "+Qa);ra=
this.calcManager.R$b(ra.cell.Ek);if(!Object(la.c)(ra))return new sa(!1,void 0,`getDecimalChangeNumberFormat: ${ra.reason}`);Qa=this.jD.changeFormatDecimals(ra.value,11===Qa?1:-1);return excelOnlineCalc.util.isSuccess(Qa)?void 0===Qa.value||null===Qa.value?new sa(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new sa(!0,Qa.value):new sa(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}sba(ra){const Qa=ra.cell,qb=ra.format;null==qb||"number"===
typeof qb||("string"===typeof qb?Ca.a.sYa(qb):Ca.a.sYa(qb.formatString));Ca.a.sYa(Qa.Cy.value);"success"===ra.kind&&Ca.a.sYa(ra.Px.text);e.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: [object Object]")}VJg(ra,Qa,qb,Wa,ta,ib,Bb,Ub=!1,Ta=!1,mb=0,Qb=null){const Lb=Qa.cell;Lb.oJ=mb;mb=Qa.text;mb!==qb&&(Lb.text=qb);Lb.zNa=Qb;Pa.f(mb)?Qa.formulaBarText=mb:Qa.formulaBarText="";ra=rb.g(ra).Db.Pef(Qa.range);this.g0b(Qa,Wa,null,Ub,Ta,ra);ta&&(Qa.color=Ib.e(N.a.iG(ta)));Qa.cell.Ek=
ib;Qa.cell.IEb=Bb;Qa.cell.Vwc=ib}Pti(ra,Qa,qb,Wa,ta,ib){const Bb={};Bb.a=this.$.ya.UserSessionId;Bb.b=Qa;Bb.c=Wa.Ranges.length;Bb.d=this.L6g(Wa.Ranges);Bb.e=ta.toString();Bb.f=ra;Bb.h=ib;1890566896===ra?Bb.g=qb.NumberFormat.toString():2105621672===ra&&(Bb.g=qb.NumberFormatOptions.NumberFormatCategory.toString());cc.b().Ie(3,Bb,!0)}L6g(ra){let Qa=0,qb=0,Wa=0;for(let ta=0;ta<ra.length;ta++){const ib=z.B(ra[ta]).TG;Qa+=ib;ib>Wa&&(Wa=ib,qb=ta)}ra=z.B(ra[qb]).toString();return"TotalCellCount:"+Qa+"; Max range:"+
ra+"; MaxRangeSize:"+Wa+";"}ioj(ra,Qa,qb){64===(Qa.ValidMembers&64)&&this.setFillColor(ra,Qa,qb);16===(Qa.ValidMembers&16)&&xb.Mpj(ra,Qa);128===(Qa.ValidMembers&128)&&this.aua.EJb(ra,Qa,ra.range);if(2===(Qa.ValidMembers&2)||1===(Qa.ValidMembers&1)){qb=Qa.VerticalAlignment;Qa=Qa.HorizontalAlignment;const Wa=0!==Qa;W.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!Wa&&this.tYe(ra);this.aua.Ubb(ra,Qa,Wa,qb)}}setFillColor(ra,Qa,qb){(W.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
ra.oaa:ra.oaa&&ra.Ovb&&!ra.Rvb&&!ra.Vvb)||(Qa=-1===Qa.FillColor?qb?N.a.iG(ua.a.white):null:N.a.iG(ua.a.hH(Qa.FillColor)),ra.backgroundColor=Qa?Ib.e(Qa):null)}iqj(ra,Qa){0!==ra.horizontalAlignment&&2!==ra.horizontalAlignment||ra.R_(1,!1);0<=ra.indentation+Qa.IndentationIncrease&&(ra.indentation+=Qa.IndentationIncrease)}joj(ra,Qa,qb){let Wa=ra.pL,ta=Qa.TextOrientation;ta!==S.a.verticalText&&(0>ta||180<ta)&&e.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${ta}`);
Wa===ta||Wa===S.a.Bsc&&ta===S.a.Csc||Wa===S.a.Dsc&&ta===S.a.Esc?Qa.TextOrientation=0:(ra.pL=Qa.TextOrientation,qb||ra.R_(0<=ra.pL?1:3,!1))}tYe(ra){ra=this.k2a(ra.Cy,ra.cell.Ek,ra.cell.uAa,ra.cell.oha);return Object(la.b)(ra)?0:null!=ra.value.horizontalAlignment?ra.value.horizontalAlignment:0}trj(ra,Qa,qb){this.rx||(this.rx=new ea.a(rb.g(this.$).Ea,this.$));this.rx.EJb(ra,Qa,qb)}p2h(ra,Qa){const qb=new Mb.a;if(ra.cell.formulaBarText&&ra.cell.formulaBarText.startsWith("'"))qb.Text=ra.cell.formulaBarText;
else{let Wa=ra.cellValue;Wa&&4!==ra.cell.oJ||(Wa=ra.text);qb.Text=Wa}this.vRa(Qa,qb,!1,void 0,E.a.Ymd(this.$));return!0}OPd(ra,Qa){return this.xb&&!!ra&&!!Qa}static F_g(ra,Qa,qb,Wa){Wa&&Qa.setCell(!0);0===qb&&ra.Ea.SU()}static expandRange(ra,Qa){Qa=Qa.clone();Qa.height<ra.height&&(Qa.bottom=Qa.top+ra.height-1);Qa.width<ra.width&&(Qa.right=Qa.left+ra.width-1);return Qa}static ydi(ra){switch(ra){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}}static Mpj(ra,Qa){Qa=Qa.Font;var qb=0!==(Qa.ValidMembers&16);const Wa=0!==(Qa.ValidMembers&16),ta=0!==(Qa.ValidMembers&16);ra.bold=0!==(Qa.ValidMembers&4);ra.italic=0!==(Qa.ValidMembers&8);qb&&(ra.underline=qb);Wa&&(ra.doubleUnderline=Wa);ta&&(ra.fontStrikethrough=ta);ra.fontName=Qa.FontName;ra.fontSize=Qa.FontSize;qb=N.a.Zo(ra.color,ra.backgroundColor);ua.a.compare(qb,ua.a.red)&&(Ca.a.m4(ra.text)||Ca.a.r5e(ra.text))||(Qa=ua.a.hH(Qa.FontColor),ra.color=Ib.e(N.a.iG(Qa)))}}xb.pAh=
36;Object(t.a)(xb,"FormatCellsAction",null,[411,3]);class Va extends d.a{constructor(ra){super();this.$=ra;this.Fb()}create(){this.qb(new xb(this.$))}static ka(ra){ra.da.Ga(18,new Va(ra))}}Object(t.a)(Va,"FormatCellsActionFactory",d.a,[]);a.d(D,"a",function(){return bb});const bb=()=>{b.a.Fa(Va.ka)}},1154:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(1),f=a(15),e=a(193),k=a(78),l=a(37),m=a(47),v=a(45),n=a(637),w=a(28),r=a(118);class u{constructor(){this.startTime=w.a.Wa.Nb;this.tx=new n.a}jXe(){return r.a(w.a.Wa,
this.startTime)}}Object(t.a)(u,"OngoingAction",null,[]);class x extends k.a{constructor(Va,bb,ra,Qa,qb=null){super();this.gOa=this.Hmb=null;this.tXc=0;this.inc=null;this.TPi=()=>{const Wa=this.gOa.jXe();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.yka}>.OnRunningLong: Operation running for more than ${Wa}ms`);this.inc=m.a.instance.create(this.G5,Math.max(this.Tte-Wa,0),v.a.Aie)};this.G5=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.yka}>.OnTimeout: Operation running for more than ${this.gOa.jXe()}ms, timing out. Has pending actions: ${this.c5a}`);
this.tXc++;this.tXc>this.Ste&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.yka}>.OnTimeout: passed the allowed bypassed count`);this.gOa.tx.cancel();this.TRe()};this.bla=()=>{this.c5a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.yka}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.WKa}, AggregatedActionParams not null: ${this.c5a}`);this.ukd()};this.Dyg=Va;this.Eyg=bb;this.documentVisibilityObserver=ra;this.yka=Qa;this.nL=qb;ra&&this.documentVisibilityObserver.mmb(this.bla);
this.sXc=!!ra&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.Ste=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);bb=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.Tte=Va.Wad(bb);Va=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.PRg=Math.max(this.Tte-bb,
0)+Va}get WKa(){return!!this.gOa}get c5a(){return!!this.Hmb}vFf(Va){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.yka}>.PerformThrottledAction: Start. IsActionOngoing: ${this.WKa}, AggregatedActionParams not null: ${this.c5a}`);this.Hmb=this.Eyg.sUc(Va,this.Hmb);this.ukd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.zab(this.bla);this.xve();super.dispose()}oZf(Va){this.sXc?(this.gOa=Va?new u:null,Va?this.startTimer():this.xve()):this.gOa=Va?{}:null}TRe(Va=
null){this.sXc&&Va&&Va.hK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.yka}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.yka}>.FinishedCallback: Start. IsActionOngoing: ${this.WKa}, AggregatedActionParams not null: ${this.c5a}`),this.oZf(!1),this.ukd())}ukd(){if(!this.LKb()){var Va=this.Hmb;this.Hmb=null;this.oZf(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.yka}>.InternalPerformAction: Calling PerformAction.`);
var bb=this.sXc?this.gOa.tx.token:e.a.none;l.TaskExtensions.Aa(this.Dyg.VBd(Va),()=>{this.TRe(bb)},bb,0,this.nL)}}LKb(){return!this.c5a||this.WKa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ei?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.yka}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}xve(){this.inc&&this.inc.cancel()}startTimer(){this.tXc<=this.Ste&&(this.inc=m.a.instance.create(this.TPi,this.PRg,v.a.Aie))}}Object(t.a)(x,"ActionAggregator",
k.a,[551,3]);var z=a(27),B=a(85),y=a(108),A=a(13),K=a(44),G=a(38),T=a(19),W=a(5),P=a(127),E=a(14),H=a(21),F=a(55);class N extends G.a{constructor(Va){super();this.uw=this.firstElement=null;this.uLa=!1;this.Bs=null;this.fvj=z.a.Tf;this.Sxf=bb=>{const ra=bb.Ca.keyCode;return ra===B.a.Zh?this.GIi():ra===B.a.dA&&bb.Ca.shiftKey?this.twh(this.firstElement):!1};this.rDf=bb=>{if(!this.uLa||bb.Ca.keyCode!==B.a.uL)return!1;N.Y6e();F.Task.delay(1).So(()=>{this.uw.focus();return!0},0,this.la);return!0};this.pTi=
()=>{document.activeElement&&document.activeElement.id===this.uw.id||(N.Y6e(),F.Task.delay(1).So(()=>{this.uw.focus();return!0},0,this.la))};this.Wvf=()=>{this.z9f(this.uw)};this.Rxf=bb=>{bb.stopPropagation();bb.preventDefault();this.uLa&&(this.uLa=!1)};this.$=Va;(Va=this.$.ea.jc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Va.ksa}; InWebPart = '${Va.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Va&&(Va.inWebPart||
Va.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Va.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.C5g(),this.B6g(),y.KeyInputManager.instance.ra(A.a.Mb,this.$.domElement,this.rDf));this.$.da.Ga(238,this)}OEg(Va){this.addHandler("KBIS",Va)}Qaj(Va){this.removeHandler("KBIS",Va)}dispose(){this.firstElement&&
K.a.removeHandler(this.firstElement,A.a.focus,this.Wvf);this.Bs&&this.Bs.detach("focus");this.uw&&(K.a.removeHandler(this.uw,A.a.focus,this.Rxf),K.a.removeHandler(this.uw,A.a.blur,N.onBlur),y.KeyInputManager.instance.Ba(A.a.Mb,this.uw,this.Sxf));y.KeyInputManager.instance.Ba(A.a.Mb,this.$.domElement,this.rDf);this.Bs=this.uw=this.firstElement=this.$=null;super.dispose()}C5g(){this.fvj?(this.firstElement=document.documentElement,this.Bs=P.a.instance.XG(document.parentWindow),this.Bs.ka("focus",this.pTi)):
(this.firstElement=N.jCe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),K.a.addHandler(this.firstElement,A.a.focus,this.Wvf))}B6g(){this.uw=N.jCe();this.uw.id=W.a.iJe;this.uw.setAttribute(W.a.Nt,E.a.instance.ga(863));document.body.appendChild(this.uw);K.a.addHandler(this.uw,A.a.focus,this.Rxf);K.a.addHandler(this.uw,A.a.blur,N.onBlur);y.KeyInputManager.instance.ra(A.a.Mb,this.uw,this.Sxf)}twh(Va){this.z9f(Va);return!1}GIi(){this.uLa=!0;H.g(this.$).focus();H.g(this.$).ha.b4e();
this.raiseEvent("KBIS");return!0}z9f(Va){this.uLa?this.uLa=!1:(this.uLa=!0,Va&&Va.focus())}static jCe(){const Va=document.createElement("div");Va.tabIndex=0;return Va}static Y6e(){document.body.classList.add(T.a.LLe)}static onBlur(){document.body.classList.remove(T.a.LLe)}}Object(t.a)(N,"EmbedViewFocusControl",G.a,[550,3]);var J=a(4),R=a(1076),M=a(60),L=a(516),U=a(24),X=a(42),da=a(368),fa=a(170),S=a(247),ka=a(121),V=a(31),wa=a(281),ma=a(280),ab=a(62);const ba=(Va,bb,ra,Qa,qb,Wa,ta,ib,Bb,Ub,Ta=null)=>
{Ta=Va.Na(1,Ta);Ta.selectedRange=bb;Ta.richValueKeyPath=ra;Ta.singleColumn=Qa;Ta.searchForRange=qb;Ta.calculateMajorityDataType=Wa;return ab.g(Va,"GetRichValueFieldListContextList",Ta,ta,ib,Bb,Ub,4)};var Ca=a(36);class Na extends G.a{constructor(Va,bb){super();this.jIb=this.tcd=this.oub=this.NO=null;this.zSb=!1;this.Y2d=null;this.KEd=!1;this.dKi=(ra,Qa,qb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+qb);this.jIb&&this.jIb.stop();this.NO=null;this.raiseEvent(R.k)};
this.eKi=ra=>{wa.a(ra)||(this.jIb&&this.jIb.stop(),this.zSb=!1,(this.NO=ra.Result)&&0<this.NO.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.NO.length} rich value field list context for autocomplete`),this.oVa=!0,this.opc())};this.oVa=!1;this.jb=Va;this.lRb=-1;this.tableManager=bb;this.KEd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ca.a.oZ(Va)}IXb(Va){this.addHandler(R.a,Va)}Oqc(Va){this.removeHandler(R.a,Va)}oEg(Va){this.addHandler(R.k,
Va)}yaj(Va){this.removeHandler(R.k,Va)}get A5a(){return this.oVa}get osi(){return this.zSb}get JTe(){return this.lRb}get l3c(){return this.Y2d}get $(){return this.jb}get Pk(){return this.NO}get XMh(){return!!this.oub}dispose(){this.jb=null;this.abb();super.dispose()}$Xi(){var Va=Array(9);var bb={};bb.Name=R.e;Va[0]=bb;bb={};bb.Name=R.h;Va[1]=bb;bb={};bb.Name=R.f;Va[2]=bb;bb={};bb.Name=R.i;Va[3]=bb;bb={};bb.Name=R.j;Va[4]=bb;bb={};bb.Name=R.g;Va[5]=bb;bb={};bb.Name=R.c;Va[6]=bb;bb={};bb.Name=R.d;Va[7]=
bb;bb={};bb.Name=R.b;Va[8]=bb;bb={ColumnName:"",ColumnIndex:-1};bb.FieldInfoDataList=Va;Va=[];Va[0]=bb;this.gNd(Va)}JY(Va,bb,ra,Qa=null){if(Va){this.kYc();this.X_b();var qb=null,Wa=!1;if(!Qa&&({T9a:Wa,Pk:qb}=this.yMj(Va,bb,ra)).returnValue)if(this.KEd||this.gNd(qb),this.zSb=!0,this.NO=qb,this.KEd){if(!Wa){this.oVa=!0;this.opc();return}}else if(this.NO&&0<this.NO.length&&(this.oVa=!0,this.opc()),!Wa)return;this.kcg(Va,Qa,bb,ra,!1)}}kcg(Va,bb,ra,Qa,qb){if(this.$.ea.hc){this.$.Hb&&(this.jIb=this.$.Hb.xc("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.oub=null;var Wa=this.$.pa.va.Qb();this.oub=ba(this.$.pa.va,Va,bb,ra,Qa,qb,this.eKi,this.dKi,null,Wa)}else this.NO=null}abb(){this.NO=null;this.oVa=!1;this.kYc();this.X_b();this.oub=null;this.lRb=-1}kYc(){Na.Iob(this.oub)}X_b(){Na.Iob(this.tcd)}opc(){this.raiseEvent(R.a)}Fm(Va){Va=X.D(Va);--Va.left;--Va.right;return this.tableManager.Fm(Va)}nJa(Va){Va.FirstColumn=Va.FirstColumn;Va.LastColumn=Va.LastColumn;Va.FirstRow=Va.FirstRow;Va.LastRow=Va.LastRow;this.X_b();
this.tcd=null;return da.a(this.$.userOperationManager,(bb,ra,Qa)=>S.h(this.$.pa.va,Va,ma.b(bb,qb=>{this.oKi(qb)}),ma.a(ra,ra,qb=>{this.nKi(qb)}),Qa,null),bb=>new fa.a(264,0,bb,80),null)}nKi(Va){Va=ka.a.kf(Va.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${V.a.zc(Va)}`)}oKi(Va){if(wa.a(Va))-315732528!==Va.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${V.a.zc(Va.Errors)}`);
else if(Va&&Va.Result){Va=Va.Result;var bb=Va.HasHeaderRow;bb=new L.AutofilterRange(Va.TableRange.FirstRow+(bb?1:0)+1,Va.TableRange.FirstColumn+1,Va.TableRange.LastRow+1,Va.TableRange.LastColumn+1,null,null,null,0,bb);this.lRb=Va.TableRange.FirstColumn;(Va=this.zIf(!1,!0,bb))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.gNd(Va)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}yMj(Va,
bb,ra){let Qa,qb;qb=null;Qa=!1;if(Va.SheetName!==this.$.ea.oa.sheetName)return{returnValue:!1,T9a:Qa,nJa:!1,Pk:qb};let Wa;this.lRb=-1;if(ra){Wa=this.Fm(Va);if(!Wa||!Wa.qaa)return{returnValue:!1,T9a:Qa,nJa:!1,Pk:qb};var ta=H.g(this.$).Db.t0e(Wa);this.Y2d=Wa;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&ta&&0<ta.count)return--Va.FirstColumn,--Va.LastColumn,this.tcd=this.nJa(Va),{returnValue:!0,T9a:Qa,nJa:!0,Pk:qb};Wa.top+=1;
Wa.right=X.D(Va).right-1}else Wa=new L.AutofilterRange(Va.FirstRow+1,Va.FirstColumn+1,Va.LastRow+1,Va.LastColumn+1,null,null,null,0,!1);if(Wa.top>Wa.bottom||Wa.left>Wa.right)return{returnValue:!0,T9a:Qa,nJa:!1,Pk:qb};Va=H.g(this.$);var ib=Va.hb.width,Bb=Va.hb.height;ta=Va.view.visibleArea;ib=new M.a(ta.x-ib,ta.y-Bb,ta.width+ib,ta.height+Bb);Bb=Va.lg(Wa);if(!ta||!Bb||!Va.Xfc(Wa))return{returnValue:!1,T9a:Qa,nJa:!1,Pk:qb};ib.contains(Bb)||(Qa=!0);qb=this.zIf(bb,ra,Wa);return{returnValue:!0,T9a:Qa,nJa:!1,
Pk:qb}}gNd(Va){Va&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Va.length} rich value field contexts from block cache`);this.zSb=!0;(this.NO=Va)&&0<this.NO.length&&(this.oVa=!0,this.opc())}zIf(Va,bb,ra){let Qa;Qa=null;const qb=ra.clone();if(bb)for(let Wa=ra.right,ta=0;Wa>=ra.left;--Wa){if(qb.left=Wa,qb.right=Wa,bb=this.xXe(qb,!0,ra.left)){Qa||(Qa=[]);Qa[ta]=bb;if(Va)break;++ta}}else if(Va=this.xXe(qb,!1))Qa=[],Qa[0]=Va;return Qa}xXe(Va,bb,ra=0){var Qa=null;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var qb=
H.g(this.$).Db.jVh(Va);if(qb&&0<qb.count){var Wa=Array(qb.count);Qa=0;for(var ta of qb.values)qb={},qb.Name=ta,Wa[Qa]=qb,++Qa;ta="";qb=-1;0<Va.top&&bb&&(Va=new U.Range(Va.top-1,Va.left,Va.top-1,Va.left,!1,!1),null!=H.g(this.$).Xb(Va)&&null!=H.g(this.$).Xb(Va).originalText&&(ta=H.g(this.$).Xb(Va).originalText),qb=Va.left-ra);Qa={};Qa.ColumnName=ta;Qa.ColumnIndex=qb;Qa.FieldInfoDataList=Wa}}else if((ta=H.g(this.$).Db.t0e(Va))&&0<ta.count){Wa=Array(ta.count);Qa=0;for(qb of ta)ta={},ta.Name=qb,Wa[Qa]=
ta,++Qa;ta="";qb=-1;0<Va.top&&bb&&(Va=new U.Range(Va.top-1,Va.left,Va.top-1,Va.left,!1,!1),ta=H.g(this.$).Xb(Va).originalText,qb=Va.left-ra);Qa={};Qa.ColumnName=ta;Qa.ColumnIndex=qb;Qa.FieldInfoDataList=Wa}return Qa}static Iob(Va){Va&&J.AFrameworkApplication.rd.wu(Va.Ot)}}Object(t.a)(Na,"FieldInfoManager",G.a,[306,3]);class za extends Na{constructor(Va,bb,ra,Qa){super(Va,bb);this.b1a=null;this.Qvf=()=>{this.Oqc(this.Qvf);if(this.Pk&&this.Pk.length&&this.contextMenuManager){var qb=this.contextMenuManager.Mbd("autoFilterRichFieldList"),
Wa=window.document.getElementById(this.b1a);qb.Y_(null,Wa,this,null,!0)}};this.wkg=ra;this.contextMenuManager=Qa}get PG(){return this.wkg}gNh(Va,bb){this.b1a=bb;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Va.FirstRow}, ${Va.FirstColumn}, ${Va.LastRow}, ${Va.LastColumn})`);this.kcg(Va,null,!0,!1,!0)}}Object(t.a)(za,"FilterInfoManager",Na,[307,306,3]);var la=a(835),aa=a(1087),sa=a(29),
ea=a(86),Z=a(8);class ua{}ua.uqh="ewa-sharedUi-launchButton";ua.xqh="ewa-sharedUi-launchButtonWithText";ua.vqh="ewa-sharedUi-launchButtonClick";ua.yqh="ewa-sharedUi-launchButtonWithTextClick";ua.wqh="ewa-sharedUi-launchButtonText";Object(t.a)(ua,"CssClassNames",null,[]);var ya=a(64);a(511);var ha=a(235),Da=a(221);G=a(234);var nb=a(284),qa=a(70),pa=a(11),Ja=a(250),$a=a(33);class rb extends G.a{constructor(Va,bb,ra,Qa,qb,Wa,ta,ib){super(document.createElement("div"));this.xif=null;this.qRd=!1;this.hMb=
this.CRa=null;this.uN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.tN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.gBj=()=>{this.Lie()};this.dd=Bb=>{this.raiseEvent(this.vFb,Bb);this.tFb();return!0};this.mIi=Bb=>{100<r.a(w.a.Wa,this.xif)&&this.vgd(new Sys.UI.Point(Math.round(Bb.clientX),Math.round(Bb.clientY)))};this.pN=Bb=>{qa.g(Bb.Ca,!1);return!1};this.pY=this.pe.UGa();this.set_visible(!1);this.vgc=qb;this.vFb=Wa;this.mkc=Va;this.U0b=bb;this.vgc&&(this.CRa=m.a.instance.create(this.gBj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));Va&&this.domElement.classList.add(Va);this.uZa=document.createElement("div");this.domElement.appendChild(this.uZa);ra&&this.uZa.classList.add(ra);Qa&&(this.uZa.innerHTML=Qa);ta&&(this.hMb=document.createElement("div"),this.domElement.appendChild(this.hMb),this.hMb.classList.add(ib),this.hMb.innerText=ta,this.domElement.style.padding="3px",ha.a.instance.ra(A.a.pointerDown,this.domElement,this.pN));this.kZa=new nb.a(this.domElement,7);Da.a.instance.ra(A.a.click,
this.domElement,this.dd);d.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ha.a.instance.ra(A.a.pointerDown,this.domElement,this.pN);Va=Bb=>{qa.g(Bb)};this.Fc.ka("mouseup",Va);this.Fc.ka("click",Va);this.Fc.ka("dblclick",Va)}G1(Va){this.addHandler(this.vFb,Va)}Eca(Va){this.get_events().removeHandler(this.vFb,Va)}eFg(Va){this.addHandler("OnObjectButtonMouseOver",Va)}ebj(Va){this.get_events().removeHandler("OnObjectButtonMouseOver",Va)}dFg(Va){this.addHandler("OnObjectButtonMouseOut",
Va)}dbj(Va){this.get_events().removeHandler("OnObjectButtonMouseOut",Va)}sbg(Va){Va&&(this.uZa.innerHTML=Va)}OPj(Va,bb,ra){this.uZa.innerHTML="";Va?Va.Aaa(bb,16,16,this.uZa,16,16,void 0,ra):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}PPj(Va,bb){Va&&(this.hMb.innerText=Va);this.domElement.title=bb}dispose(){this.get_isInitialized()&&(this.hide(),this.Fc.JC(),ea.a.rc([this.pY,this.kZa]),Da.a.instance.Ba(A.a.click,this.domElement,this.dd),
ha.a.instance.Ba(A.a.pointerDown,this.domElement,this.pN),this.CRa&&this.CRa.dispose(),super.dispose())}Zab(){this.U0b&&this.domElement.classList.remove(this.U0b);this.mkc&&this.domElement.classList.add(this.mkc)}tFb(){this.mkc&&this.domElement.classList.remove(this.mkc);this.U0b&&this.domElement.classList.add(this.U0b);this.p1a()}p1a(){this.vgc&&(this.CRa.cancel(),this.v5f(),this.setOpacity(1));this.set_visible(!0)}xp(Va,bb,ra,Qa,qb=!1){Va=$a.a(Qa).ni(Va);bb=$a.a(Qa).ni(bb);$a.a(Qa).Guc(this.domElement);
this.domElement.style.top=pa.HelperMethods.qc(bb);this.domElement.style.left=this.domElement.style.right="";bb=Va;qb&&(bb=Va-this.domElement.offsetWidth);Ja.c(this.domElement.style,ra,pa.HelperMethods.qc(bb));this.set_visible(!0);this.setOpacity(1);this.vgc&&(this.qRd=!1,this.WDj(),this.CRa.Qq())}hide(){this.Zab();this.set_visible(!1);this.vgc&&(this.v5f(),this.CRa.cancel())}Z5b(){this.Fc.ka("mouseover",this.uN,!0);this.Fc.ka("mouseout",this.tN,!0)}WDj(){this.pY.kn("mousemove")||this.pY.ka("mousemove",
this.mIi)}v5f(){this.pY.kn("mousemove")&&this.pY.detach("mousemove")}vgd(Va){if(this.domElement.parentNode){var bb=Sys.UI.DomElement.getBounds(this.domElement);const ra=new Sys.UI.Point(Math.round(bb.x+bb.width),Math.round(bb.y+bb.height));bb=Math.abs(ra.x-Va.x);Va=Math.abs(ra.y-Va.y);Va=bb>Va?bb:Va;this.qRd?this.setOpacity(rb.USg(Va)):100>=Va&&this.Lie()}}Lie(){this.qRd=!0;this.CRa.cancel()}setOpacity(Va){z.a.setOpacity(this.domElement,Va);this.xif=w.a.Wa.Nb}static USg(Va){return 100>=Va?1:250<=
Va?0:.01*(100-(Va-100)/150*100)}}Object(t.a)(rb,"OnObjectButton",G.a,[475,476,3]);var Pa=a(787);const eb=ua.wqh;class Ob extends k.a{constructor(Va,bb,ra,Qa,qb,Wa,ta,ib=""){super();this.Cva=null;this.E7e=!1;this.Kjc=this.Ljc=null;this.buttons={};this.UKe={};this.$=Va;this.svgIconProvider=bb;this.IGi=ra;this.Wid=Qa;this.Vid=qb;this.altText=Wa;this.vFb=ta;this.buttonText=ib}get mz(){return $a.a(this.$).mFa(Z.a.jOi)}get v0b(){return Z.a.iOi}get buttonWidth(){return $a.a(this.$).mFa(Z.a.kOi)}dispose(){this.Dfh();
this.$=null;super.dispose()}getButton(Va,bb=!0){return this.pua(Va,bb)}pua(Va,bb=!0){const ra=Va.toString();ra in this.buttons||this.D6g(Va,bb);return this.buttons[ra]}xp(Va,bb,ra,Qa,qb=!0,Wa=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&ya.i(this.$.oa)){var ta=H.g(this.$).AR.domElement;const ib=Va+this.buttonWidth-ta.scrollWidth;ta=bb+this.buttonWidth-ta.scrollHeight;Va=0<ib?Va-ib:Va;bb=0<ta?bb-ta:bb}this.pua(Qa,qb).xp(Va,bb,ra,this.$,Wa)}hide(){const Va=this.buttons;for(let bb in Va)Va[bb].hide()}Z5b(Va,
bb){!this.E7e&&(bb=this.buttons[bb.toString()])&&(this.Ljc=(ra,Qa)=>{Va(Qa,!0)},bb.eFg(this.Ljc),this.Kjc=(ra,Qa)=>{Va(Qa,!1)},bb.dFg(this.Kjc),this.E7e=!0,bb.Z5b())}D6g(Va,bb){this.Cva=String.format(this.Wid===T.a.O6b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',sa.a.Dg(this.Wid),sa.a.Dg(this.Vid),"{0}");var ra=String.format(this.Cva,sa.a.Dg(this.altText));bb=new rb(""===this.buttonText?
ua.uqh:ua.xqh,""===this.buttonText?ua.vqh:ua.yqh,T.a.RA,ra,bb,this.vFb,this.buttonText,eb);ra=(Qa,qb)=>{this.IGi(qb,Va)};bb.G1(ra);this.buttons[Va.toString()]=bb;this.UKe[Va.toString()]=ra;ra=H.g(this.$).Lf(Va);ra.domElement.insertBefore(bb.domElement,ra.domElement.firstChild)}Dfh(){for(const Va of Pa.a(this.buttons)){const bb=this.buttons[Va];bb.Eca(this.UKe[Va]);ea.a.Ia(bb);delete this.buttons[Va];this.Ljc&&bb.ebj(this.Ljc);this.Kjc&&bb.dbj(this.Kjc)}}domElement(Va){return this.pua(Va).domElement}p1a(Va){this.pua(Va).p1a()}ENb(Va,
bb,ra=!0){this.Cva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',sa.a.Dg(this.Wid),sa.a.Dg(this.Vid),"{0}");Va=String.format(this.Cva,sa.a.Dg(Va));this.pua(bb,ra).sbg(Va)}bTa(Va,bb,ra){this.pua(ra,!1).PPj(Va,bb)}hcg(){this.Cva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",sa.a.Dg(this.Vid),"{1}");const Va=String.format(this.Cva,void 0,sa.a.Dg(void 0));this.pua(void 0,
!1).sbg(Va)}icg(Va,bb,ra){this.pua(ra,!1).OPj(this.svgIconProvider,Va,bb)}}Object(t.a)(Ob,"OnObjectLaunchButton",k.a,[447,3]);k=a(93);class tb extends k.a{constructor(Va,bb){super(Va);this.ZAb=null;this.nfh=()=>{this.display()};this.T7h=Math.max(1,bb)}dispose(){ea.a.Ia(this.ZAb);this.ZAb=null;super.dispose()}TRa(){ea.a.Ia(this.ZAb);this.ZAb=m.a.instance.create(this.nfh,this.T7h,v.a.ssi)}ZRa(){ea.a.Ia(this.ZAb);this.hide()}}Object(t.a)(tb,"LoadingIndicatorBehavior",k.a,[472,3]);class cc extends tb{constructor(Va,
bb,ra,Qa){super(Va,bb);this.YAb=null;this.Tmg=ra;this.e5h=Qa;this.TAg()}dispose(){this.YAb=null;super.dispose()}display(){this.Tmg(this.YAb)}hide(){this.e5h(this.YAb)}TAg(){this.YAb=document.createElement("div");this.domElement.appendChild(this.YAb)}}Object(t.a)(cc,"ShimmerLoadingIndicatorBehavior",tb,[]);var Ib=a(71),Mb=a(54),Oa=a(12);class Aa extends tb{constructor(Va,bb,ra=null,Qa=null,qb=0){super(Va,bb);this.OMa=null;this.Jcc=ra||Mb.a.current.Rn(103);this.gkf=qb;this.o3c=Qa;this.SAg()}dispose(){this.OMa=
null;super.dispose()}display(){Oa.DOMElementExtensions.setVisible(this.OMa,!0)}hide(){Oa.DOMElementExtensions.setVisible(this.OMa,!1)}SAg(){this.OMa=document.createElement("div");this.OMa.classList.add(Ib.a.Woh);const Va=document.createElement("div");Va.classList.add(Ib.a.Xoh);this.o3c&&""!=this.o3c&&Va.classList.add(this.o3c);const bb=0===this.gkf?"":E.a.instance.ga(this.gkf),ra=String.format('<div class="'+Ib.a.Yoh+'">{0}</div>',bb);Va.innerHTML=this.Jcc?`<img src="${this.Jcc}" alt="${bb}" title="${bb}"/>`+
ra:ra;this.OMa.appendChild(Va);this.domElement.appendChild(this.OMa)}}Object(t.a)(Aa,"SpinnerLoadingIndicatorBehavior",tb,[]);class Ba{q2c(Va,bb,ra){return new la.a(Va,bb,ra)}V2b(Va,bb,ra,Qa,qb,Wa,ta,ib,Bb,Ub){return new aa.a(Va,bb,ra,Qa,qb,Wa,ta,ib,Bb,Ub)}Bqb(Va,bb,ra,Qa,qb=0){return new Aa(Va,bb,ra,Qa,qb)}Vdd(Va){return Va.da.za(238)||new N(Va)}Y2b(Va,bb,ra,Qa,qb,Wa,ta,ib=""){return new Ob(Va,bb,ra,Qa,qb,Wa,ta,ib)}T1c(Va,bb){return new Na(Va,bb)}x5g(Va,bb,ra,Qa){return new za(Va,bb,ra,Qa)}z1c(Va,
bb,ra,Qa){return new x(Va,bb,ra,Qa)}}Object(t.a)(Ba,"SharedUIControlsFactory",null,[397]);class ob extends b.a{constructor(Va){super();this.$=Va;this.Fb()}create(){d.EwaSettings.fl()?this.qb(this.$.da.za(12)||new Ba):this.qb(new Ba)}static ka(Va){Va.da.Ga(477,new ob(Va))}}Object(t.a)(ob,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(D,"a",function(){return xb});const xb=()=>{c.a.Fa(ob.ka)}},1158:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(50),f=a(37),e=a(1),k=a(803);class l extends b.a{constructor(Ta){super();
this.$=Ta;this.Fb()}create(){const Ta=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ib),mb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([Ta,mb],this.la),()=>{this.qb(this.$.da.za(296)||this.$.da.Ga(296,new k.BorderFormatManager(this.$,Ta.result,mb.result)))},this.la,3)}static ka(Ta){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&Ta.da.Ga(468,new l(Ta))}}Object(t.a)(l,"BorderFormatManagerFactory",
b.a,[]);var m=a(690),v=a(15),n=a(262),w=a(171),r=a(818),u=a(27),x=a(39),z=a(29),B=a(94),y=a(259),A=a(350),K=a(346),G=a(98),T=a(184),W=a(8),P;(function(Ta){Ta[Ta.insert=1]="insert";Ta[Ta.delete=2]="delete";Ta[Ta.rows=4]="rows";Ta[Ta.columns=8]="columns";Ta[Ta.cellsShiftHorizontal=16]="cellsShiftHorizontal";Ta[Ta.cellsShiftVertical=32]="cellsShiftVertical";Ta[Ta.insertRows=5]="insertRows";Ta[Ta.insertColumns=9]="insertColumns";Ta[Ta.insertCellsShiftRight=17]="insertCellsShiftRight";Ta[Ta.insertCellsShiftDown=
33]="insertCellsShiftDown";Ta[Ta.deleteRows=6]="deleteRows";Ta[Ta.deleteColumns=10]="deleteColumns";Ta[Ta.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Ta[Ta.deleteCellsShiftUp=34]="deleteCellsShiftUp";Ta[Ta.insertRowsBelow=37]="insertRowsBelow"})(P||(P={}));Object(t.b)("InsertDeleteCellFlags",P);var E=a(5),H=a(418),F=a(64),N=a(77);class J{constructor(Ta){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Ta}}Object(t.a)(J,"MacroRecorderRangeInsertedOrDeletedPayload",
null,[116]);var R=a(1074),M=a(42),L=a(510),U=a(368),X=a(170),da=a(62),fa=a(247),S=a(145),ka=a(452),V=a(113),wa=a(54),ma=a(196),ab=a(90),ba=a(34),Ca=a(31),Na=a(281),za=a(256),la=a(11),aa=a(181),sa=a(22),ea=a(280);class Z{constructor(Ta,mb,Qb,Lb,Jb=0){this.bog=Ta;this.cog=mb;this.hwg=Qb;this.kVb=Lb;this.LBh=Jb}get oia(){return this.bog}get Rh(){return this.cog}get style(){return this.hwg}get size(){return this.kVb}get EY(){return this.LBh}static wQg(Ta,mb){return new Z(Ta,mb,null,null,null)}static kXc(Ta,
mb){return new Z(Ta,null,mb,null,null)}static xQg(Ta,mb){return new Z(Ta,null,null,mb,null)}static vQg(Ta,mb,Qb){return new Z(Ta,null,mb,null,Qb)}}Object(t.a)(Z,"CachedPreviewCellGroup",null,[]);var ua=a(84);b=a(282);var ya=a(100),ha=a(14);class Da extends b.a{constructor(Ta,mb,Qb){super(Ta);this.Il=null;this.O4c=0;this.Tai=(Lb,Jb)=>{if(0===Lb)v.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Lb={};var Ab="",pb=1035996630;switch(Jb.selectedKey){case 0:Ab=
1896159024===this.rr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Ab=1896159024===this.rr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.rr?(Ab="InsertRows",pb=-1113896058):(Ab="DeleteRows",pb=1554436520);break;case 3:1896159024===this.rr?(Ab="InsertColumns",pb=1415868706):(Ab="DeleteColumns",pb=674605324)}v.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${Ab}`);
Jb=new ab.a(pb,1,2,8,null);Lb[N.a.Oc]=Ab;this.$.Ka.Lb(Jb,Lb)}};this.rr=mb;this.selectedRanges=Qb;this.isRtl=Object(ua.a)(ya.a,this.$.xa.oa).displayRtl}get oc(){return"InsertDeleteCellsDialog"}wg(){1896159024===this.rr?(this.Il=ha.a.instance.ga(23),this.O4c=0):(this.Il=ha.a.instance.ga(22),this.O4c=1);const Ta=this.selectedRanges[0].xZ&&!this.selectedRanges[0].x4?0:1;this.Sb=1;this.initializeAndShow(this.Il,this.Tai,{[Da.Uu]:this.oc,["dialogToDisplay"]:this.O4c,["defaultSelectedKey"]:Ta,["isRtl"]:this.isRtl})}}
Object(t.a)(Da,"InsertDeleteCellsDialog",b.a,[]);const nb=(Ta,mb,Qb,Lb,Jb,Ab,pb=null)=>{pb=Ta.Na(41,pb);pb.insertDeleteMultiRangeParameters=mb;return da.g(Ta,"InsertDeleteCells",pb,Qb,Lb,Jb,Ab,0)};class qa{constructor(Ta,mb,Qb,Lb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=Ta;this.targetSheetRange=mb;this.fillRangeType=Qb;this.fillRangeDirection=Lb}}Object(t.a)(qa,"MacroRecorderRangeFilledPayload",null,[116]);var pa=a(7),Ja=
a(24);class $a{constructor(){this.WPa=this.LFa=this.CMa=this.ESa=0}}Object(t.a)($a,"RangeBorders",null,[]);class rb{constructor(){this.scenario=0;this.$P=null}}Object(t.a)(rb,"ScenarioInfo",null,[]);var Pa=a(904),eb=a(21),Ob=a(261),tb=a(209),cc=a(79);class Ib{constructor(Ta,mb){this.$=Ta;this.ug=mb;this.rx=new Pa.a(eb.g(this.$).Ea,this.$);this.Mef=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.Mxb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.mnd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.jfc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Kcf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.rfi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.Kgf=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1);this.Wfc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.Cyb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.kfc=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Aii=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.yfi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");
this.Gaf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");this.Hcf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Qii=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.Vni=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}xfi(Ta,mb){return!(void 0===mb||null===mb)&&!!(mb.scenario&16384)&&!this.zfi(Ta,mb)&&
this.zaf(mb,Ta)}pZe(){var Ta=x.a.Sd(),mb=eb.g(this.$),Qb=mb.ha.sa.selectedRanges;let Lb=0;var Jb=0,Ab=Qb.length;const pb=new rb;if(1<Ab)return pb.scenario=4,pb;if(this.Hcf&&mb.ye.Cfc(Qb[0]))return pb.scenario=262144,pb;this.mnd&&eb.g(this.$).rtl&&(Lb|=65536);if(!mb.kK(Qb[0]))if(this.Mxb)Lb|=32;else return pb.scenario=32,pb;if(mb=mb.Ea.vJa(Qb[0],this.$.activeItemName)){pb.EWc=mb;for(var va of mb)if(Jb+=1,1<Jb){this.Mxb?(Lb|=256,pb.scenario=Lb):pb.scenario=256;if(!this.Cyb)return pb;break}}Jb=eb.g(this.$).Ea.Aia(Qb[0]);
if(!Jb)return pb.scenario=32768,pb;va=Jb.length;Qb=Qb[0];mb=Qb.bottom-Qb.top+1;Ab=Qb.right-Qb.left+1;const db=new $a;for(let Ya=0;Ya<va;Ya++)if(this.Mef&&this.YTh(Jb[Ya],Qb,db),Lb=Lb|(void 0!==Jb[Ya].text&&null!==Jb[Ya].text&&""!==Jb[Ya].text?1:0)|(Jb[Ya].rF?2:0)|(Jb[Ya].hva?8:0)|(Jb[Ya].Pvb?16:0)|(Jb[Ya].fF?64:0)|(Jb[Ya].oaa?128:0),void 0!==Jb[Ya].text&&null!==Jb[Ya].text&&""!==Jb[Ya].text||Jb[Ya].hva)if(void 0===pb.$P||null===pb.$P)pb.$P=eb.g(this.$).Xb(Jb[Ya].getRange());else{if(Jb[Ya].getRange().top<
pb.$P.range.top||Jb[Ya].getRange().top==pb.$P.range.top&&Jb[Ya].getRange().left<pb.$P.range.left)pb.$P=eb.g(this.$).Xb(Jb[Ya].getRange());Lb|=16384}this.Mef&&(db.ESa===Ab&&(Lb|=512),db.LFa===Ab&&(Lb|=2048),db.CMa===mb&&(Lb|=4096),db.WPa===mb&&(Lb|=1024),0<db.ESa&&db.ESa<Ab||0<db.LFa&&db.LFa<Ab||0<db.CMa&&db.CMa<mb||0<db.WPa&&db.WPa<mb)&&(Lb|=8192);!e.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Qb.right!==Qb.maxColumns&&Qb.bottom!==Qb.maxRows||(Lb|=131072);
Ta=x.a.Sd()-Ta;v.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Ta}`);pb.scenario=Lb;return pb}Pof(Ta,mb){const Qb=Ta.command;if(void 0===mb||null===mb)mb=this.pZe();if(!this.zaf(mb,Qb))return!1;Ta=eb.g(this.$).ha.sa.selectedRanges;var Lb=eb.g(this.$).Ea.Aia(Ta[0]);if(!Lb)return!1;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Lb.length&&!Lb[0].rF)return-167499203===Qb?(Lb[0].R_(2,!0),!0):!1;Lb=eb.g(this.$).ha.sa.Wr;const Jb=
this.$.oa.sheetName;let Ab=!0;switch(Qb){case -167499203:2===(mb.scenario&2)&&this.jfc?this.uag(mb.scenario,Ta,Qb):Ab=this.hzi(mb,Ta);break;case 1097660126:(mb=this.Qof(mb,Ta))&&0!=mb.length||(Ab=!1);break;case 155820588:this.uag(mb.scenario,Ta,Qb);break;default:return!1}eb.g(this.$).HU(Ta,Lb,Jb,null,Ta[0],null,null,0,"MergeCellCommandAction");return this.Cyb?Ab:!0}zaf(Ta,mb){const Qb=this.jei(Ta,mb);if(!this.Kcf)return Qb;const Lb=eb.g(this.$).ha.sa.selectedRanges[0].jz(!1);v.ULS.sendTraceTag(526149324,
0,50,`Merge Cell Command: ${mb.toString()}; Scenario Number: ${Ta.scenario}; IsCSEPossible result: ${Qb}; Range: ${Lb}`);return Qb}jei(Ta,mb){if(-255094134===mb)return!1;var Qb=Ta.scenario;if(this.Hcf&&262144===Qb||this.mnd&&65536===(Qb&65536))return!1;if(this.Jgf(mb,Ta))return Qb=eb.g(this.$).ha.sa.selectedRanges,0===Qb.length?!1:this.Zmi(mb,Ta,Qb[0]);this.Mxb&&32===(Qb&32)&&(Qb&=-33);if(256==(Qb&256))if(this.Pii(Ta))Qb&=-257;else return!1;return 32768===Qb||4===Qb||128===(Qb&128)||!this.Mxb&&32===
Qb?!1:-167499203!=mb&&1097660126!==mb||!this.Zkd(Ta)?void 0!==Ta.$P&&null!==Ta.$P&&Ta.$P.n7?!1:0===Qb?!0:16384===(Qb&16384)?e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Qb&1)&&8!==(Qb&8)||!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.kfc}lgi(Ta){return 131072===(Ta.scenario&131072)?!0:!1}Pii(Ta){if(!this.Cyb)return!1;let mb="Multi block",Qb=!0;this.Zkd(Ta)&&(mb+=" with border",Qb=!1);this.lgi(Ta)&&
(Qb=!1,mb+=" with entire row or column selected",16384===(Ta.scenario&16384)&&(mb+=" and a data loss scenario"));Qb||v.ULS.sendTraceTag(523511383,0,50,`CSE for ${mb}, is not enabled`);return Qb}Zkd(Ta){return 16===(Ta.scenario&16)||this.Vgd(Ta.scenario)||this.ohd(Ta.scenario)||this.fhd(Ta.scenario)||this.qhd(Ta.scenario)||8192===(Ta.scenario&8192)?!0:!1}zfi(Ta,mb){return this.yfi?this.Jgf(Ta,mb):155820588===Ta}Jgf(Ta,mb){return 155820588===Ta||(-167499203===Ta||1097660126===Ta)&&2===(mb.scenario&
2)&&this.jfc?!0:!1}Ymi(Ta){return this.qhd(Ta.scenario)||this.fhd(Ta.scenario)||this.Vgd(Ta.scenario)||this.ohd(Ta.scenario)?!0:!1}f4h(Ta){Ta=eb.g(this.$).Ea.Aia(Ta);if(!Ta||0===Ta.length)return!1;for(let mb=0;mb<Ta.length;mb++)if(Ta[mb].rF&&Ta[mb].n7)return!0;return!1}Zmi(Ta,mb,Qb){if(1097660126===Ta&&2===(mb.scenario&2))return!1;if(this.Vni){if(this.f4h(Qb))return!1}else if(this.rfi&&void 0!==mb.$P&&null!==mb.$P&&mb.$P.n7)return!1;this.Mxb&&32===(mb.scenario&32)&&(mb.scenario&=-33);return 32768===
mb.scenario||4===mb.scenario||256===(mb.scenario&256)&&this.Aii||128===(mb.scenario&128)?!1:2===(mb.scenario&2)?this.Ymi(mb)?e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}YTh(Ta,mb,Qb){const Lb=Ta.getRange();if(Lb.top===mb.top)if(Ta.jKa)Qb.ESa+=Lb.right-Lb.left+1;else{var Jb=this.rx.dQ(Lb,0);if(Jb)for(const pb of Jb)pb.eKa&&(Qb.ESa+=
pb.getRange().right-pb.getRange().left+1)}if(Lb.left===mb.left)if(Ta.gKa)Qb.CMa+=Lb.bottom-Lb.top+1;else if(Jb=this.rx.dQ(Lb,2))for(var Ab of Jb)Ab.hKa&&(Qb.CMa+=Ab.getRange().bottom-Ab.getRange().top+1);if(Lb.bottom===mb.bottom)if(Ta.eKa)Qb.LFa+=Lb.right-Lb.left+1;else if(Ab=this.rx.dQ(Lb,1))for(const pb of Ab)pb.jKa&&(Qb.LFa+=pb.getRange().right-pb.getRange().left+1);if(Lb.right===mb.right)if(Ta.hKa)Qb.WPa+=Lb.bottom-Lb.top+1;else if(Ta=this.rx.dQ(Lb,3))for(const pb of Ta)pb.gKa&&(Qb.WPa+=pb.getRange().bottom-
pb.getRange().top+1)}m9i(Ta,mb){for(let Qb of mb.EWc){mb=Ta.Fe(Qb.qf);mb=eb.g(this.$).Ea.Aia(mb);const Lb=mb.length;for(let Jb=1;Jb<Lb;Jb++){const Ab=eb.g(this.$).Xb(mb[Jb].getRange());this.kfc?Ab.cell.deleteCellFromModel():(Ab.apb(),Ab.clearFormat(),Ab.cell.n9i());Ab.$Gb(!0)}}}jTj(Ta,mb){Ta.backgroundColor=mb.backgroundColor;Ta.color=mb.color}ohg(Ta,mb){return{SpansBlocks:!0,OriginRow:Ta,OriginColumn:mb,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}Czg(Ta,mb,Qb,Lb,
Jb){Qb=Ta.Fe(Qb.qf);if(!Qb)return v.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var Ab=new Ja.Range(Ta.top,Ta.left,Qb.top,Qb.left,!1,!1);let pb;Qb.top==Ta.top?pb=0:(Ab.bottom=Qb.top-1,pb=mb.oed(Ab));Qb.left==Ta.left?Ab=0:(Ab.right=Qb.left-1,Ab=mb.ped(Ab));mb=this.ohg(Ta.top-1,Ta.left-1);mb.OriginDeltaY=pb;mb.OriginDeltaX=Ab;mb.Rows=Qb.bottom-Qb.top;mb.Columns=
Qb.right-Qb.left;mb.Height=Jb;mb.Width=Lb;Qb.top==Ta.top&&Qb.left==Ta.left&&(mb.IsOrigin=!0);Ta=eb.g(this.$).Xb(Qb.topLeft);Ta.cell.cZf(mb);return Ta}INd(Ta,mb){let Qb=[];const Lb=eb.g(this.$).ye;if(!Lb)return Qb;const Jb=Lb.oed(Ta),Ab=Lb.ped(Ta);if(mb.EWc)for(const pb of mb.EWc)if(mb=this.Czg(Ta,Lb,pb,Ab,Jb))Qb.push(mb);else{Qb=[];break}return Qb}$Uh(Ta,mb,Qb,Lb){var Jb=Qb.bottom-Qb.top,Ab=Qb.right-Qb.left;let pb=[];const va=Lb.scenario;if(256===(va&256)){if(pb=this.INd(Qb,Lb),!pb||0==pb.length)return pb}else mb.cell.INd(Jb,
Ab),pb.push(mb);Jb=this.f2(this.X3(mb),!0,0,va,"merge");if(void 0!==Ta&&null!==Ta)for(const db of pb){Ab=Ta.cell.Rh;const Ya=Object(pa.a)(new Ob.a,{TextRuns:Ab.TextRuns,Fonts:Ab.Fonts});Ya.Text=void 0!==Ta.cell.originalText&&null!==Ta.cell.originalText?Ta.cell.originalText:void 0!==Ta.cell.userInput&&null!==Ta.cell.userInput?Ta.cell.userInput:Ab.Text;Jb=this.f2(this.X3(db),Jb,1,va,"merge");this.ug.vRa(db,Ya,!1,null,!0,"MergeCells",void 0,2);Jb=this.f2(this.X3(db),Jb,2,va,"merge");this.mnd?db.jpb(Ta):
this.jTj(db,Ta);Jb=this.f2(this.X3(db),Jb,3,va,"merge");db.cell.J2g(Ta.cell);Jb=this.f2(this.X3(db),Jb,4,va,"merge");db.cell.BAc(!1);Jb=this.f2(this.X3(db),Jb,6,va,"merge")}this.m9i(Qb,Lb);this.f2(this.X3(mb),Jb,5,va,"merge");return pb}fhd(Ta){return 4096===(Ta&4096)}qhd(Ta){return 512===(Ta&512)}Vgd(Ta){return 2048===(Ta&2048)}ohd(Ta){return 1024===(Ta&1024)}z9b(Ta,mb){let Qb=null;for(let Lb=0;Lb<Ta.length;Lb++)if(Ta[Lb].BorderPosition===mb){Qb=Ta[Lb];break}return Qb}dQh(Ta,mb){this.Wfc?(mb=this.z9b(mb.cell.DM().Borders,
2))&&Ta.push(mb):(mb=mb.cell.DM().Borders,1<mb.length&&(mb=[mb[1]]),Ta=[...mb,...Ta]);return Ta}xYh(Ta,mb){this.Wfc?(mb=this.z9b(mb.cell.DM().Borders,0))&&Ta.push(mb):(mb=mb.cell.DM().Borders,1<mb.length&&(mb=[mb[0]]),Ta=[...mb,...Ta]);return Ta}dIh(Ta,mb){mb=this.rx.dQ(mb.cell.getRange(),1);if(!mb||0===mb.length)return Ta;if(this.Wfc){if(mb=mb[0].DM().Borders,mb=this.z9b(mb,0))mb.BorderPosition=1,Ta.push(mb)}else{let Qb=[];0<mb.length&&(Qb=mb[0].DM().Borders);Qb[0].BorderPosition=1;Ta=[...Qb,...Ta]}return Ta}kVh(Ta,
mb){mb=this.rx.dQ(mb.cell.getRange(),3);if(!mb||0===mb.length)return Ta;if(this.Wfc){if(mb=mb[0].DM().Borders,mb=this.z9b(mb,2))mb.BorderPosition=3,Ta.push(mb)}else{let Qb=[];0<mb.length&&(Qb=mb[0].DM().Borders);Qb[0].BorderPosition=3;Ta=[...Qb,...Ta]}return Ta}ZTh(Ta,mb,Qb){this.fhd(Ta.scenario)&&(mb=this.dQh(mb,Qb));this.qhd(Ta.scenario)&&(mb=this.xYh(mb,Qb));this.Vgd(Ta.scenario)&&(mb=this.dIh(mb,Qb));this.ohd(Ta.scenario)&&(mb=this.kVh(mb,Qb));return mb}HY(Ta){if(0===Ta.length)return null;let mb=
[0,0,0,0],Qb=[1,1,1,1],Lb=0;Ta.forEach(function(Ab){let pb=Ab.BorderPosition;Qb[pb]=Ab.BorderLineStyle;let va=new tb.a(Ab.Color.Red,Ab.Color.Green,Ab.Color.Blue);mb[pb]=va.UR();Lb|=la.HelperMethods.O2a(Ab.BorderPosition)});Ta={};Ta.LineStyle=Qb;Ta.Color=mb;let Jb={};Jb.BorderFormat=Ta;Jb.Border=Lb;return Jb}F_d(Ta,mb,Qb=null){let Lb=[];Lb=null!==Qb?[...Qb]:this.ZTh(mb,Lb,Ta);if(mb=this.HY(Lb))Ta.cell.qab(Ta.cell.getRange()),this.rx.ZGb(Ta.cell.getRange()),this.ug.nda(eb.g(this.$),-1690267012,mb,!1,
null,[Ta.cell.getRange()])}Yji(Ta){return 512===(Ta.scenario&512)||4096===(Ta.scenario&4096)||1024===(Ta.scenario&1024)||2048===(Ta.scenario&2048)?!0:!1}yYh(Ta){Ta=this.rx.dQ(Ta.cell.getRange(),1);return Ta&&0!==Ta.length?Ta[0].jKa?(Ta=Ta[0].DM().Borders[0],Ta.BorderPosition=1,Ta):null:null}zYh(Ta){Ta=this.rx.dQ(Ta.cell.getRange(),3);return Ta&&0!==Ta.length?Ta[0].gKa?(Ta=Ta[0].DM().Borders[0],Ta.BorderPosition=3,Ta):null:null}$1h(Ta,mb,Qb,Lb,Jb){mb.cell.scg();if(this.Yji(Ta))this.F_d(mb,Ta);else{const Ab=
8192===(Ta.scenario&8192),pb=mb.cell.getRange();Ab&&this.Gaf?(mb.cell.qab(),this.rx.ZGb(pb)):Jb?(Jb=[],null!==Qb&&Jb.push(Qb),null!==Lb&&Jb.push(Lb),0<Jb.length?this.F_d(mb,Ta,Jb):(mb.cell.qab(),this.rx.ZGb(pb))):Ab&&!this.Gaf&&(mb.cell.qab(),this.rx.ZGb(pb))}}yPh(Ta,mb){return null===Ta||void 0===Ta?!0:Ta.cell.getRange().top===mb.topLeft.top&&Ta.cell.getRange().left===mb.topLeft.left&&Ta.cell.getRange().bottom===mb.topLeft.bottom&&Ta.cell.getRange().right===mb.topLeft.right?!0:!1}hzi(Ta,mb){mb=this.Qof(Ta,
mb);if(this.Cyb&&(!mb||0==mb.length))return!1;for(let Qb=0;Qb<mb.length;Qb++)mb[Qb].R_(2,!0),this.f2(this.X3(mb[Qb]),!0,8,Ta.scenario,"merge");return!0}GRj(Ta){const mb=eb.g(this.$).Ea.vJa(Ta,this.$.activeItemName);if(mb&&cc.Ct(mb))for(let Qb of mb)Qb.uXd(Ta,!0)}Qof(Ta,mb){const Qb=Ta.$P,Lb=eb.g(this.$).Xb(mb[0]);let Jb=null,Ab=null;this.kfc&&(Jb=this.yYh(Lb),Ab=this.zYh(Lb));const pb=this.$Uh(Qb,Lb,mb[0],Ta);if(this.Cyb&&(!pb||0==pb.length))return pb;this.Qii?this.GRj(mb[0]):eb.g(this.$).Ea.t9(mb[0],
this.$.activeItemName).uXd(mb[0],!0);this.f2(this.X3(Lb),!0,9,Ta.scenario,"merge");if(this.kfc&&this.Zkd(Ta)){mb=this.yPh(Qb,mb[0]);for(const va of pb)this.$1h(Ta,va,Jb,Ab,mb)}return pb}IJg(Ta,mb,Qb){if(!(1>Ta.Borders.length)){var Lb=this.HY(Ta.Borders);Qb.forEach(Jb=>{Jb=eb.g(this.$).Xb(Jb.getRange());this.ug.t2f(-1690267012,Jb,Lb,!1,null,!1,mb)})}}lOj(Ta,mb,Qb){const Lb=Ta.length;for(let Ab=0;Ab<Lb;Ab++){Ta[Ab].cell.BAc();const pb=Ta[Ab].cell.getRange(),va=eb.g(this.$).Ea.Aia(pb),db=va.length;if(-167499203===
mb&&this.jfc){var Jb=0;2===Ta[Ab].cell.AFd||1===Ta[Ab].cell.oJ?Jb=3:2===Ta[Ab].cell.oJ&&(Jb=1);Ta[Ab].R_(Jb,!1)}for(Jb=1;Jb<db;Jb++)va[Jb].attachCellToModel(),va[Jb].jpb(Ta[Ab]),-167499203===mb&&this.jfc&&va[Jb].R_(null,!1);this.Kgf&&Qb&&this.IJg(Qb[Ab],pb,va)}}RUe(Ta,mb){let Qb=null;for(let Lb=0;Lb<Ta.length;Lb++)if(Ta[Lb].BorderPosition===mb){Qb=Ta[Lb];break}return Qb}cIh(Ta,mb){let Qb=Ta.cell.DM();Ta.eKa()&&Ta.cell.qPa(1);Ta.hKa()&&Ta.cell.qPa(3);if((Ta=this.rx.dQ(mb,0))&&Ta[0].eKa){var Lb=Ta[0].DM().Borders;
Lb=this.RUe(Lb,1);Lb.BorderPosition=0;Qb.Borders.push(Lb);Ta.forEach(Jb=>{Jb.qPa(1)})}(mb=this.rx.dQ(mb,2))&&mb[0].hKa&&(Ta=mb[0].DM().Borders,Ta=this.RUe(Ta,3),Ta.BorderPosition=2,Qb.Borders.push(Ta),mb.forEach(Jb=>{Jb.qPa(3)}));return Qb}uag(Ta,mb,Qb){var Lb=eb.g(this.$).Ea.Fua(mb[0],this.$.activeItemName);const Jb=eb.g(this.$).Ea.t9(mb[0],this.$.activeItemName),Ab=[];if(void 0!==Lb&&null!==Lb&&(mb=eb.g(this.$).Eua(mb[0],Lb),void 0!==mb&&null!==mb)){mb=mb.$$ge();for(Lb=[];mb.$$mn();){var pb=mb.$$cu();
if(pb.GH){Ab.push(pb);this.f2(this.X3(pb),!0,10,Ta,"unmerge");pb.cell.pXg();const va=pb.cell.getRange();this.f2(this.X3(pb),!1,11,Ta,"unmerge");Jb.uXd(va,!1);this.Kgf&&(pb=this.cIh(pb,va),Lb.push(pb))}}0<Ab.length&&(Jb.sf.resetCellLookup(),this.lOj(Ab,Qb,Lb))}}f2(Ta,mb,Qb,Lb,Jb){if(!this.Kcf)return!1;Ta!==mb&&v.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Qb}; Scenario: ${Lb}; Command: ${Jb}; Expected: ${mb?"populated":"empty"}; Actual: ${Ta?
"populated":"empty"}`);return Ta}X3(Ta){return!!Ta.cell.cell.Merge}}Object(t.a)(Ib,"MergeCellCommandAction",null,[]);var Mb=a(74),Oa=a(97),Aa=a(200),Ba=a(43),ob=a(455),xb=a(375),Va=a(51),bb=a(68),ra=a(55),Qa=a(1081),qb=a(36),Wa=a(338),ta=a(182);class ib{constructor(Ta,mb,Qb,Lb,Jb,Ab,pb){this.$=Ta;this.gridView=mb;this.ug=Qb;this.AB=Lb;this.borderFormatManager=Jb;this.moreColorsHelper=Ab;this.fontDropdownHelper=pb;this.pC=null;this.BZa=1461300262;this.ix=this.yZa=this.d8a=this.K8b=null;this.lMi=(va,
db)=>{if(!Na.a(va)&&db){const Ya=!!va&&!!va.RequestTelemetryData;eb.g(this.$).Ci.Cka(db,va.StateId,Ya?va.RequestTelemetryData.EcsOperationDuration:0,Ya?va.RequestTelemetryData.EcsRequestDuration:0,Ya?va.RequestTelemetryData.WfeRequestDuration:0)}};this.epb=()=>{if(this.gridView.C5a){const va=this.$.da.za(254,!0);va&&va.rbj(this.epb);this.gridView.C5a=!1;this.gridView.Cf.Yl(E.a.kQ);this.gridView.ha.OV(this.V$c);eb.g(this.$).$.pf()}};this.V$c=()=>{var va=this.K8b;this.K8b=F.d(this.$.xa.oa);va===this.K8b&&
(this.gridView.ha.OV(this.V$c),(va=this.$.da.za(254,!0))&&va.$Xc(36,eb.g(this.$).ha.sa.selectedRanges)?(va=new ab.a(1804571062,2,2,0,null),this.$.Ka.Lb(va,{[E.a.skipClipboardAccess]:!0,[E.a.FZc]:!0,[E.a.isFormatPainter]:!0}).continueWith(()=>{this.epb()})):this.gridView.Cf.UG(!1))};this.xb=e.EwaSettings.xb();this.vjc=new Ib(this.$,Qb);this.cD=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Im=e.EwaSettings.Im();this.Hm=qb.a.Hm()}get Eff(){return n.a.all(this.gridView.ha.sa.selectedRanges,
Ta=>Ta.isRow)}get zff(){return n.a.all(this.gridView.ha.sa.selectedRanges,Ta=>Ta.Ze)}get themesManager(){this.ix||(this.ix=this.$.da.za(422));return this.ix}Qhi(Ta){return 1896159024===Ta||-1554384558===Ta||-1113896058===Ta||1554436520===Ta||1415868706===Ta||674605324===Ta||1035996630===Ta}Qc(Ta,mb){return 2054778433===mb&&Ta&1?!ka.a(this.$).Zfc:600686207===mb?!1:this.Qhi(mb)&&n.a.any(this.gridView.ha.sa.selectedRanges,Qb=>Qb.Ze||Qb.isRow)&&!this.Eff&&!this.zff?!0:this.tgc(Ta,mb)}executeCommand(Ta,
mb,Qb){return this.Lb(mb,Qb)}Ec(Ta,mb,Qb){if(Ta=1===Ta)switch(mb.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ta=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Ta=
!!Qb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Ta=!0;break;default:Ta=!1}return Ta}Vc(Ta,mb,Qb){switch(mb){case "PopulateFontColor":Qb.MenuItems=this.AB.L9b(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Qb.MenuId);break;case "PopulateFillColor":Qb.MenuItems=this.AB.L9b(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Qb.MenuId);break;case "PopulateBorderColor":Qb.MenuItems=this.AB.L9b(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,Qb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.t2h(Qb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.Hm&&(this.fontDropdownHelper.Iqj(Qb.MenuId),!this.fontDropdownHelper.Qgi()))return!1;Qb.MenuItems=this.fontDropdownHelper.lUe(-1293291468,324978188,-1428968098,Qb.MenuId);break;default:return!1}return!0}tgc(Ta,mb){const Qb=eb.g(this.$).ha.sa.selectedRanges;return!(new S.a(this.$.xa)).om(Ta,mb,Qb,this.gridView)}Lb(Ta,
mb){var Qb=this.gridView;const Lb=Ta.command;var Jb=f.TaskExtensions.vk();let Ab=!0;switch(Lb){case -1077965542:Ab=this.f4e(mb,Ta,!1);break;case 909774670:this.rob(Lb);Ab=this.f4e(mb,Ta,!0);break;case -1293291468:Ab=this.d4e(mb,Ta,!1);break;case 324978188:this.rob(Lb);Ab=this.d4e(mb,Ta,!0);break;case 862890474:case 963349338:Ab=this.N1h(Ta);break;case -1832800737:Ab=this.obc(Lb,mb,!1,Ta);break;case 1970784898:Ab=this.obc(Lb,mb,!1,Ta);break;case -803000997:Ab=this.obc(Lb,mb,!1,Ta);break;case -128950598:case 1688184685:this.rob(Lb);
Ab=this.obc(Lb,mb,!0,Ta);break;case 1597684571:Ab=this.Evb(Lb,mb,!1,Ta);break;case 87208751:mb.Color="-1";mb.IntColor=!0;Ab=this.Evb(Lb,mb,!1,Ta);break;case -446735083:this.rob(Lb);mb.Color="-1";mb.IntColor=!0;Ab=this.Evb(Lb,mb,!0,Ta);break;case 1650812936:Ab=this.Evb(Lb,mb,!1,Ta);break;case 673562736:this.rob(Lb);Ab=this.Evb(Lb,mb,!0,Ta);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.ESf(Lb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Ab=
this.y1h(Lb,Ta);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Ab=this.G0h(Lb,Ta);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ab=this.o2h(Lb,Ta);break;case -1803452024:case -236759591:Ab=this.fgd(Lb,mb,Ta);break;case -2118943501:Ab=this.borderFormatManager.R0h(mb,Ta);break;case 1012765228:Ab=this.borderFormatManager.I2h(mb,Ta);break;case 1256700402:Ab=this.borderFormatManager.jgd(Ta);
break;case -1756763834:Ab=this.borderFormatManager.kgd(Ta);break;case -1418159950:Ab=this.borderFormatManager.S3e(Ta);break;case -1920201820:case -1942512156:Ab=this.O1h(Lb,Ta);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Ab=this.borderFormatManager.E3e(mb,Ta);this.Kyh(mb);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Ab=this.k2h(Lb,mb,Ta);break;case -693675336:case 322710748:break;case 1696566924:Ab=this.z1h(Ta);break;
case -167499203:case -255094134:case 1097660126:case 155820588:Jb=this.handleMergeCellsCommand(this.gridView,Ta);break;case 1896159024:case -1554384558:mb=this.gridView.ha.sa.selectedRanges;if(this.jxj(Ta,mb))v.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Da(this.$,Lb,mb)).wg(),Ab=!0;else if(n.a.any(mb,pb=>this.gridView.Db.JLa(pb))){Qb="";Jb=1461300262;const pb=-1554384558===Lb&&this.gridView.Db.Zji(mb[0]);mb=mb[0].height>mb[0].width&&
!pb;switch(Lb){case 1896159024:Qb=mb?"InsertColumnsTable":"InsertRowsTable";Jb=mb?622604322:942362098;break;case -1554384558:Qb=mb?"DeleteColumnsTable":"DeleteRowsTable",Jb=mb?284490184:1405456548}mb=ba.a.Yp(ib.hkd,Qb,1);new ab.a(Jb,1,2,6,null);Jb=this.insertOrDeleteCells(mb,Ta,!0)}else Jb=this.insertOrDeleteCells(1896159024===Lb?1:2,Ta,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Jb=this.insertOrDeleteCells(ba.a.Yp(ib.hkd,mb[N.a.Oc],1),Ta,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Jb=
this.insertOrDeleteCells(ba.a.Yp(ib.hkd,mb[N.a.Oc],1),Ta,!1);break;case 504848446:Jb=Qb.startEdit(!1,1,mb[E.a.event],void 0,void 0,!0);break;case 1504715724:if(eb.g(this.$).qz&&this.borderFormatManager.eU.mB)break;Jb=Qb.startEdit(!0,0,mb[E.a.event],void 0,void 0,!0);break;case 1872288872:this.epb();break;case 41465729:Jb=this.fill(Qb.ha.sa.Wc,null,0,1,Ta);break;case -1451655532:case 1972143101:Jb=this.fillDownAbsoluteValueAndStartEdit(Qb,mb[E.a.event],-1451655532===Lb);break;case -475861485:Jb=this.fill(Qb.ha.sa.Wc,
null,Qb.rtl?1:2,1,Ta);break;case -978843926:Jb=this.fill(Qb.ha.sa.Wc,null,3,1,Ta);break;case 2098035706:Jb=this.fill(Qb.ha.sa.Wc,null,Qb.rtl?2:1,1,Ta);break;case -2142700828:Jb=this.fill(Qb.ha.sourceRange,Qb.ha.sa.Wc,ib.AXe(Qb.ha.sa.Wc,Qb.ha.sourceRange),2,Ta);break;case 1405660955:Jb=this.fill(Qb.ha.sourceRange,Qb.ha.sa.Wc,ib.AXe(Qb.ha.sa.Wc,Qb.ha.sourceRange),4,Ta);break;case 1983983164:Jb=this.fill(Qb.ha.sa.Wc,null,0,0,Ta);break;case 478842689:(Ta=this.$.da.za(376))?(Ta.u2i(),Ab=!0):v.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Ab=Qb.ha.Lb(null,Lb);break;case -208772570:this.f2h();Ab=!0;break;case -987339782:this.Z0h();Ab=!0;break;case -1770246794:Qb.ha.$0h();Ab=!0;break;case 748067091:case -381232414:this.c1h(Lb);Ab=!0;break;case -1522760979:this.gridView.toggleFormulaView();Ab=!0;break;case 886009118:Jb=this.L1h();break;case 894341014:this.Q1h();
Ab=!0;break;case 862825906:Jb=this.v4e(1970784898,Ta);break;case 1532790410:Jb=this.v4e(1650812936,Ta);break;case 46555851:Jb=this.b2h(Ta);break;default:Ab=!1}Ab||(Jb=aa.a(Lb));return Jb}Kyh(Ta){Ta&&Ta.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Ta.MenuItemId)&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.dOg(new Wa.a(this.gridView.ha.sa.activeRange,F.d(this.$.xa.oa)))}dOg(Ta){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(this.$.da,
426,427,1),mb=>{void mb.result.GVd(Ta,"BorderActions")},this.$.la,3)}jxj(Ta,mb){const Qb=n.a.all(mb,Ab=>!this.gridView.Db.JLa(Ab)),Lb=1<mb.length&&!!this.gridView.Db.dfd(mb),Jb=n.a.all(mb,Ab=>!this.gridView.Db.o4(Ab));mb=!n.a.any(mb,Ab=>Ab.isRow||Ab.Ze);return 1===Ta.method&&6===Ta.Re&&(Qb||Lb)&&Jb&&mb}fillDownAbsoluteValueAndStartEdit(Ta,mb,Qb){const Lb=Ta.ha.sa.activeCell,Jb=M.E(Lb,this.gridView.Is);return Ta.startEdit(!0,0,mb).So(()=>{const Ab=Ta.Xb(Jb),pb=Ta.Xb(Lb);if(!Ab||!pb)return v.ULS.shipAssertTag(537159507,
0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Lb.toString()} and above cell: ${Jb.toString()}`),ra.Task.Ua(!1);this.gridView.Wb.text=Qb?Ab.p0:Ab.text;this.gridView.Wb.textBox.setCaretPositionToEnd();return ra.Task.Ua(!0)})}insertOrDeleteCells(Ta,mb,Qb){const Lb=w.a.create().toString();var Jb=Enum.toString(P,Ta);this.gridView.Ci.O6(17,Lb,Jb);Jb=this.gridView.ha.sa.selectedRanges;var Ab=this.Eff,pb=this.zff;if(!this.$.oq(null,!1,void 0,mb.Re)&&!pb&&!Ab&&
5!==Ta&&9!==Ta)return ra.Task.Ua(!0);2===Ta?Ta=pb?10:Ab?6:Jb[0].height>Jb[0].width?18:34:1===Ta?Ta=pb?9:Ab?5:Jb[0].height>Jb[0].width?17:33:18===Ta&&Ab?Ta=34:34===Ta&&pb&&(Ta=18);Jb=this.BHg(Jb,Ta);if((10===Ta||6===Ta)&&!this.$.oq(Jb,!0,1,mb.Re))return ra.Task.Ua(!0);const va={};va.InsertDeleteRangeItems=Array(Jb.length);va.SheetName=this.$.oa.sheetName;va.IsTableCommand=Qb;for(Qb=0;Qb<Jb.length;Qb++){Ab=Jb[Qb];pb={};let Ka,ub;Ta&4?(pb.FirstRow=Ab.top-1,pb.LastRow=W.a.ay,pb.FirstColumn=0,pb.LastColumn=
W.a.pv,Ka=Ab.bottom-Ab.top+1,ub=0,6===Ta?(Ab.Ze||(pb.FirstRow=Ab.bottom),Ka=-Ka):ta.b("InsertRowsAbove"),37===Ta&&(pb.FirstRow=Ab.bottom,ta.b("InsertRowsBelow"))):Ta&8?(pb.FirstRow=0,pb.LastRow=W.a.ay,pb.FirstColumn=Ab.left-1,pb.LastColumn=W.a.pv,Ka=0,ub=Ab.right-Ab.left+1,10===Ta&&(Ab.isRow||(pb.FirstColumn=Ab.right),ub=-ub)):Ta&16?(pb.FirstRow=Ab.top-1,pb.LastRow=Ab.bottom-1,pb.FirstColumn=Ab.left-1,pb.LastColumn=W.a.pv,Ka=0,ub=Ab.right-Ab.left+1,18===Ta&&(pb.FirstColumn=Ab.right,ub=-ub)):(pb.FirstRow=
Ab.top-1,pb.LastRow=W.a.ay,pb.FirstColumn=Ab.left-1,pb.LastColumn=Ab.right-1,Ka=Ab.bottom-Ab.top+1,ub=0,34===Ta&&(pb.FirstRow=Ab.bottom,Ka=-Ka));const ac={};ac.InsertDeleteRange=pb;ac.DeltaRow=Ka;ac.DeltaColumn=ub;ac.AdjustedSelectedRange=M.j(Ab);va.InsertDeleteRangeItems[Qb]=ac}this.gridView.Cf.UG(!1);const db=e.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");va.IsDecoupleRecalc=db;const Ya=this.$.pa.va.Qb(),gb=()=>new J(va);return U.a(this.$.userOperationManager,
(Ka,ub,ac)=>{db&&!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.sy();return nb(this.$.pa.va,va,ea.b(Ka,this.lMi),ub,ac,Lb,Ya)},Ka=>new X.a(237,0,Ka,void 0,gb),mb)}BHg(Ta,mb){return mb&32?this.fYa(Ta,Qb=>Qb.bottom,Qb=>Qb.top,(Qb,Lb)=>{Qb.bottom=Lb},!1,!0):mb&16?this.gridView.rtl?this.fYa(Ta,Qb=>Qb.left,Qb=>Qb.right,(Qb,Lb)=>{Qb.left=Lb},!1,!1):this.fYa(Ta,Qb=>Qb.right,Qb=>Qb.left,(Qb,Lb)=>{Qb.right=Lb},!1,!1):mb&4?this.fYa(Ta,Qb=>Qb.bottom,Qb=>Qb.top,(Qb,Lb)=>{Qb.bottom=
Lb},!0,!0):mb&8?this.gridView.rtl?this.fYa(Ta,Qb=>Qb.left,Qb=>Qb.right,(Qb,Lb)=>{Qb.left=Lb},!0,!1):this.fYa(Ta,Qb=>Qb.right,Qb=>Qb.left,(Qb,Lb)=>{Qb.right=Lb},!0,!1):Ta}fYa(Ta,mb,Qb,Lb,Jb,Ab){Ta=M.d(Ta);Ta.sort((pb,va)=>mb(va)-mb(pb));if(Jb){Jb=[];Ab=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?Ab?W.a.mh+1:W.a.Ch+1:Ab?W.a.ay:W.a.pv;for(let pb=0;pb<Ta.length;pb++){const va=Ta[pb];Qb(va)<Ab&&(Lb(va,Math.min(mb(va),Ab-1)),Jb.push(va),Ab=Qb(va))}Ta=Jb}return Ta}fill(Ta,
mb,Qb,Lb,Jb){const Ab=this.$;if(!Ab.oq([mb],!0))return ra.Task.Ua(!0);const pb=M.v(Ta,Ab),va=mb?M.v(mb,Ab):pb,db=this.$.pa.va.Qb(),Ya=()=>new qa(pb,va,Lb,Qb);return U.a(this.$.userOperationManager,(gb,Ka,ub)=>{this.$.sy();var ac=this.$.pa.va;const Ra=ac.Na(9,db);Ra.sourceRange=pb;Ra.targetRange=va;Ra.fillDirection=Qb;Ra.fillType=Lb;return da.g(ac,"FillRange",Ra,gb,Ka,ub,null,0)},gb=>new X.a(155,0,gb,void 0,Ya),Jb)}k2h(Ta,mb,Qb){const Lb={ValidMembers:32};switch(Ta){case 1890566896:Ta=parseInt(mb[N.a.Oc].toString(),
10);if(14===Ta)return Qb=new ab.a(2105621672,Qb.method,Qb.mode,Qb.Re,Qb.tabName),mb[N.a.Oc]=null,this.$.Ka.Lb(Qb,mb),v.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Lb.NumberFormat=Ta;break;case 1886928607:Lb.NumberFormat=13;break;case -992833457:Lb.NumberFormat=11;break;case 218524921:Lb.NumberFormat=12;break;case 996232352:Lb.NumberFormat=1006;break;default:return v.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+
Va.b().mj(Qb.command)),!1}v.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Va.b().mj(Qb.command)} command, with menu item ${mb[N.a.Oc]}.`);this.ug.formatCells(1890566896,Lb,Qb);this.$.pf();return!0}N1h(Ta){var mb=this.gridView.Xb(this.gridView.ha.sa.activeCell);if(this.xb&&this.gridView.$a){mb=this.gridView.Qi.h3a(mb?Aa.a(mb).Font:null);if(!mb)return v.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.sa.activeCell.toString()} is null while editing`),
!1;var Qb=mb.FontSize}else if(mb)Qb=mb.fontSize;else return!1;mb=Ta.command;let Lb=0;if(862890474===mb)for(;Lb<ib.OIa.length-1&&ib.OIa[Lb]<=Qb;)Lb++;else if(963349338===mb)for(Lb=ib.OIa.length-1;0<Lb&&ib.OIa[Lb]>=Qb;)Lb--;v.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Qb} to size ${ib.OIa[Lb]}`);if(Qb===ib.OIa[Lb])return!0;Qb=ib.huc(2);Qb.Font.FontSize=ib.OIa[Lb];this.xb&&this.gridView.$a?(this.Wmb(Ta,!1,Qb),this.$.pf()):this.ug.formatCells(mb,
Qb,Ta);return!0}f4e(Ta,mb,Qb){Ta=Ta[Ta[r.a.IsFreeForm]?r.a.Value:N.a.Zf].toString();if(!ib.QYi.test(Ta))return v.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;Ta=parseFloat(Ta);if(8>Ta||72<Ta)return v.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),
e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;const Lb=Math.round(2*Ta)/2,Jb=ib.huc(2);Jb.Font.FontSize=Lb;this.xb&&this.gridView.$a?(this.Wmb(mb,Qb,Jb,!0),Lb===Ta||Qb||this.$.pf()):Qb?this.ug.nda(this.gridView,-1077965542,Jb,Qb):(this.ug.formatCells(-1077965542,Jb,mb),this.b_a());return!0}d4e(Ta,mb,Qb){var Lb=Ta[N.a.Zf];if(this.Hm){var Jb=this.fontDropdownHelper.Exc?this.fontDropdownHelper.Exc[Lb]:null;Jb||(v.ULS.sendTraceTag(523903201,1,15,
`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Lb}`),Jb=la.HelperMethods.PR[Lb])}else Jb=la.HelperMethods.PR[Lb];let Ab=0;this.Im&&(Ta=Ta.MenuItemId,Ta===Qa.b?(Lb==this.themesManager.qL.mpf&&(Jb=Lb),Ab=2):Ta===Qa.a&&(Lb==this.themesManager.qL.Fnf&&(Jb=Lb),Ab=1));if(!Jb)return!0;Lb=ib.huc(1);Lb.Font.FontName=Jb;this.Im&&(Lb.Font.FontScheme=Ab);this.xb&&this.gridView.$a?(this.Wmb(mb,Qb,Lb),this.$.pf()):Qb?this.ug.nda(this.gridView,-1293291468,Lb,Qb):
(this.ug.formatCells(-1293291468,Lb,mb),this.b_a());return!0}obc(Ta,mb,Qb,Lb){let Jb=-803000997===Ta||1688184685===Ta?"black":mb.Color;this.moreColorsHelper&&(-1832800737===Ta?Jb=sa.a.compare(Jb,"WindowText",!0)?this.moreColorsHelper.bab:"black":Qb||(this.moreColorsHelper.bab=Jb,this.moreColorsHelper.tca(mb,Jb,Lb)));Ta=ib.huc(32);Ta.Font.FontColor=ma.a.iH(Jb,ba.a.og(mb,"IntColor"));this.xb&&this.gridView.$a?this.Wmb(Lb,Qb,Ta,17===Lb.Re):Qb?this.ug.nda(this.gridView,1970784898,Ta,Qb):(this.cD&&({themeColor:mb}=
this.getThemeColor(mb)).returnValue&&(Ta.Font.ThemeFontColor=mb,Ta.Font.ColorTypeOption=1),this.ug.formatCells(1970784898,Ta,Lb),this.b_a());return!0}c1h(Ta){var mb=(new Date).format(748067091===Ta?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);const Qb=this.gridView.lj?V.a(this.gridView.$):this.gridView.Wb;Ta=Qb.textBox;if(this.gridView.$a)Qb.insertText(mb);else{const Lb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,
Lb);Qb.text=mb;mb=mb.length;Ta.FQa(mb);Ta.caretPosition=mb}}f2h(){this.gridView.kK(this.gridView.ha.sa.activeCell)||this.gridView.Atc||this.gridView.FLa()||this.gridView.Sr(this.gridView.ha.sa.activeCell,3,Oa.a.n3e)}Z0h(){if(!(this.gridView.Atc||this.gridView.FLa()||this.gridView.$a&&u.a.isMac)){const Ta=this.gridView.ha.sa.l3;this.gridView.vg(M.v(Ta,this.$),Ta,null,null,60,Oa.a.n3e)}}z1h(Ta){this.K8b=F.d(this.$.xa.oa);const mb=this.$.da.za(254,!0);if(this.gridView.C5a)return this.gridView.Cf.UG(!1),
!!mb;if(!mb)return v.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.EX(this.V$c);const Qb=String.format(E.a.Lsa,wa.a.current.Rn(107));this.gridView.Cf.Yl(Qb);Ta=new ab.a(-911352779,Ta.method,Ta.mode,Ta.Re,Ta.tabName);this.$.Ka.Lb(Ta,{[E.a.silentClipboardAccessFailures]:!0,[E.a.isFormatPainter]:!0}).continueWith(Lb=>{(6>Lb.status||6===Lb.status&&!Lb.result)&&this.epb()});this.gridView.C5a=!0;mb.zFg(this.epb);return!0}Evb(Ta,
mb,Qb,Lb){let Jb=87208751===Ta?"-1":mb.Color;this.moreColorsHelper&&(1597684571===Ta?Jb=this.moreColorsHelper.dPa:Qb||(this.moreColorsHelper.dPa=Jb===ib.notSet?ib.AVd:Jb,this.moreColorsHelper.tca(mb,Jb,Lb)));Ta={ValidMembers:64};Ta.FillColor=ma.a.iH(Jb,ba.a.og(mb,"IntColor"));Qb?this.ug.nda(this.gridView,1650812936,Ta,!0):(this.cD&&({themeColor:mb}=this.getThemeColor(mb)).returnValue&&(Ta.ThemeFillColor=mb,Ta.ColorTypeOption=1),this.ug.formatCells(1650812936,Ta,Lb),this.b_a());return!0}Q1h(){v.ULS.sendTraceTag(537159493,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Ta=this.$.da.za(221);if(Ta){var mb=this.gridView.Qi;if(mb){var Qb,Lb,Jb=({Aqf:Qb,dSe:Lb}=Ta.Vai(mb.text,mb.textBox.caretPosition)).returnValue;Jb?(Ta.qe=!1,mb.text=Jb,mb.textBox.selectRange(Qb,Qb+Lb),v.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):v.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else v.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else v.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}y1h(Ta,mb){let Qb=0;const Lb=this.gridView,Jb=Aa.a(Lb.Xb(null));this.xb&&Lb.$a&&(Jb.Font=Lb.Qi.h3a(Jb.Font));let Ab=Jb.Font;Ab||(Ab={ValidMembers:0});switch(Ta){case -287251124:Qb|=4;za.e(Ab,4)?Ab.Bold=!Ab.Bold:Ab.Bold=!0;break;case -1925065947:Qb|=8;za.e(Ab,8)?Ab.Italic=!Ab.Italic:Ab.Italic=
!0;break;case 1764140053:Qb|=16;za.e(Ab,16)?Ab.Underline=!Ab.Underline:Ab.Underline=!0;break;case -1685033574:Qb|=64;za.e(Ab,64)?Ab.DoubleUnderline=!Ab.DoubleUnderline:Ab.DoubleUnderline=!0;break;case -1590502662:Qb|=128,za.e(Ab,128)?Ab.Strikethrough=!Ab.Strikethrough:Ab.Strikethrough=!0}if(!Qb)return!1;Ab.ValidMembers=Qb;Jb.Font=Ab;Jb.ValidMembers=16;this.xb&&this.gridView.$a?this.Wmb(mb,!1,Jb):(e.EwaSettings.ma(652)||Lb.Cf.UG(!1),this.ug.formatCells(Ta,Jb,mb));this.$.pf();return!0}G0h(Ta,mb){let Qb=
0;const Lb=this.gridView,Jb=Aa.a(Lb.Xb(null));-571165336===Ta||1041132226===Ta||-394785302===Ta?(Qb|=1,Jb.VerticalAlignment=ba.a.Yp(ib.oYa,Ta.toString(),2)):ib.Ahi(Ta)?(Qb|=2,this.I1h(Jb,Ta)):-1116189897===Ta&&(Qb|=8,Jb.Wrap=Jb.ValidMembers&8?!Jb.Wrap:!0);if(!Qb)return!1;Jb.ValidMembers=Qb;e.EwaSettings.ma(652)||Lb.Cf.UG(!1);this.ug.formatCells(Ta,Jb,mb);this.$.pf();return!0}I1h(Ta,mb){!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&
-1142465846!==mb&&(mb=-1150205178===mb?-286432209:-1150205178);mb=ba.a.Yp(ib.oYa,mb.toString(),0);Ta.HorizontalAlignment=mb===Ta.HorizontalAlignment?0:mb}tIf(Ta,mb,Qb,Lb){let Jb=!1;e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Jb=this.vjc.Pof(mb,Qb))&&eb.g(this.$).Ci.a0(this.d8a,Mb.BasicTelemetryCalculator.uQ);return this.$rb(Ta,mb,!1,Jb,Ab=>{this.wNi(Ab,Qb,mb,Jb,Lb)})}handleMergeCellsCommand(Ta,mb){this.d8a=w.a.create().toString();let Qb=null;Qb=this.vjc.pZe();
var Lb=H.a(mb.command);const Jb=this.vjc.xfi(mb.command,Qb),Ab=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");let pb=0;Ab&&Jb?pb=x.a.Sd():eb.g(this.$).Ci.O6(4,this.d8a,Lb+", Scenario = "+Qb.scenario.toString());Lb=Ta.ha.sa.selectedRanges;v.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Va.b().mj(mb.command)}, Number of ranges: ${Lb.length}, Ranges: ${M.i(Lb,",",this.$,!1)}`);Lb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",
!1);Ta.Cf.UG(!1,Lb);if(10===ba.a.Yp(ib.Rof,mb.command.toString(),10))return ra.Task.Ua(!1);const va=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Lb&&va)return Jb?(Ab?this.EQd(Qb,mb,!0,!0,pb):this.EQd(Qb,mb,!0),ra.Task.Ua(!0)):this.tIf(Ta,mb,Qb,!1);let db=!1;Lb&&(db=this.vjc.Pof(mb,Qb))&&eb.g(this.$).Ci.a0(this.d8a,Mb.BasicTelemetryCalculator.uQ);return this.$rb(Ta,mb,!1,db,Ya=>{this.xNi(Ya,mb,db)})}$rb(Ta,mb,Qb,Lb,Jb=null){const Ab=this.$.pa.va.Qb(),
pb=ba.a.Yp(ib.Rof,mb.command.toString(),10),va=M.r(Ta.ha.sa.selectedRanges,Ta.$),db=()=>new R.a(pb,va),Ya=gb=>{const Ka=!!gb&&!!gb.RequestTelemetryData;eb.g(this.$).Ci.Cka(this.d8a,gb.StateId,Ka?gb.RequestTelemetryData.EcsOperationDuration:0,Ka?gb.RequestTelemetryData.EcsRequestDuration:0,Ka?gb.RequestTelemetryData.WfeRequestDuration:0)};Ta=(gb,Ka,ub)=>{this.$.sy();gb=Jb?ea.b(gb,Jb):gb;gb=ea.b(gb,Ya);return da.d(this.$.pa.va,pb,va,Qb,gb,Ka,ub,null,Ab)};return Lb?e.EwaSettings.fc()?U.a(this.$.userOperationManager,
Ta,gb=>new X.a(156,0,gb,64,db),mb):U.a(this.$.userOperationManager,Ta,gb=>new L.a(156,0,gb,void 0,db),mb):U.a(this.$.userOperationManager,Ta,gb=>new X.a(156,0,gb,void 0,db),mb)}EQd(Ta,mb,Qb,Lb=!1,Jb=0){v.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Qb}`);var Ab=eb.g(this.$).rtl;const pb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Ab=Ca.a.Yc(3,2,0,Ab?640:639,0,514846606,"MergeCellsLoseData");f.TaskExtensions.Aa(Ba.a(this.$).nj(Ab),
va=>{va=va.result;if(Lb){const db=x.a.Sd()-Jb;v.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${db}, and the user action is : ${va}`)}0===va?(v.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Qb?(Lb&&pb&&(va=H.a(mb.command),eb.g(this.$).Ci.O6(4,this.d8a,va+", Scenario = "+Ta.scenario.toString())),this.tIf(eb.g(this.$),mb,Ta,!0)):this.$rb(this.gridView,mb,!0,!1)):1===va&&v.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.la,11)}pti(Ta,mb,Qb,Lb){mb!==Ta&&v.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${mb} and as per server is ${Ta}. The scenario is:- ${Qb}, The CSE is done:- ${Lb}`)}xNi(Ta,mb,Qb){Na.b(Ta,514846606)&&(v.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),bb.a(this.$).fd.fJ(514846606),Ta=eb.g(this.$).rtl,Ta=Ca.a.Yc(3,2,0,Ta?640:639,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.Aa(Ba.a(this.$).nj(Ta),
Lb=>{Lb=Lb.result;0===Lb?(v.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.$rb(this.gridView,mb,!0,Qb)):1===Lb&&v.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}wNi(Ta,mb,Qb,Lb,Jb){let Ab=!1;Na.b(Ta,514846606)&&(Ab=!0,bb.a(this.$).fd.fJ(514846606),Lb&&Jb?window.setTimeout(()=>{this.$rb(this.gridView,Qb,!0,!0)},0):this.EQd(mb,Qb,!1));this.pti(Ab,Jb,mb.scenario,Lb)}rob(Ta){if(this.BZa!==Ta&&1461300262!==this.BZa){this.ESf(this.BZa);
var mb=Va.b().mj(Ta);const Qb=Va.b().mj(this.BZa);v.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Qb} was restored before caching the style for ${mb} command.`)}this.BZa=Ta;if(this.xb&&this.gridView.$a)this.yZa||(this.yZa=this.gridView.Qi.Rh);else if(!this.pC){this.pC=[];mb=this.gridView.d$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(mb.$$rst();mb.$$mn();){const Qb=mb.$$cu();if(Qb.cell.hasRichText)this.pC.push(Z.wQg(Qb,
Qb.cell.Rh));else switch(Ta){case 673562736:case -446735083:this.pC.push(Z.kXc(Qb,Qb.backgroundColor));break;case -128950598:case 1688184685:this.pC.push(Z.kXc(Qb,Qb.color));break;case 909774670:this.pC.push(Z.xQg(Qb,Qb.fontSize));break;case 324978188:this.Im?this.pC.push(Z.vQg(Qb,Qb.fontName,Qb.EY)):this.pC.push(Z.kXc(Qb,Qb.fontName))}}}finally{mb&&mb.dispose()}}}zBj(){return this.xb&&this.gridView.$a?!this.yZa:!this.pC}oei(Ta){return!!this.pC&&this.pC.length>Ta&&!!this.pC[Ta].Rh}qbd(Ta){return this.pC[Ta].style}IIh(Ta){return this.pC[Ta].size}HIh(Ta){return this.pC[Ta].EY}ESf(Ta){if(!this.zBj()){if(this.xb&&
this.gridView.$a)this.yZa&&(this.gridView.Wb.Rh=this.yZa);else{const Qb=this.pC.length;for(let Lb=0;Lb<Qb;Lb++){let Jb;var mb=this.pC[Lb].oia.cell.getRange();Jb=this.gridView.Xb(mb);if(!Jb){v.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${mb.jz(!1)}`);continue}let Ab;mb=Jb.GH?this.gridView.cJb(Jb.range):(Ab=new T.a,Ab.add(Jb),Ab);for(let pb of mb)if(pb.cell.hasRichText&&1457172838!==Ta)this.oei(Lb)&&(pb.cell.Rh=this.pC[Lb].Rh);
else switch(Ta){case 1457172838:pb.backgroundColor=this.qbd(Lb);break;case 2036397036:pb.color=this.qbd(Lb);break;case -1904244080:pb.fontSize=this.IIh(Lb);break;case -1428968098:pb.fontName=this.qbd(Lb),this.Im&&pb.BYf(this.HIh(Lb))}}}this.BZa=1461300262;this.b_a()}}b_a(){this.xb&&this.gridView.$a?this.yZa=null:this.pC=null}O1h(Ta,mb){const Qb={IndentationIncrease:0};if(-1942512156===Ta)Qb.IndentationIncrease=1;else if(-1920201820===Ta)Qb.IndentationIncrease=-1;else return!0;Qb.ValidMembers=256;
this.ug.formatCells(Ta,Qb,mb);return!0}o2h(Ta,mb){var Qb=Ta;!eb.g(this.$).rtl||-1649235364!==Ta&&524773427!==Ta||(Qb=-1649235364===Ta?524773427:-1649235364);switch(Qb){case -1649235364:Qb=W.a.rotateTextUp45;break;case 524773427:Qb=W.a.Csc;break;case 1886217042:Qb=W.a.rotateTextUp90;break;case 928057943:Qb=W.a.Esc;break;case -1526602249:Qb=W.a.verticalText;break;default:return!1}const Lb={ValidMembers:512};Lb.TextOrientation=Qb;this.ug.formatCells(Ta,Lb,mb);return!0}L1h(){const Ta=eb.g(this.$),mb=
M.r(Ta.ha.sa.selectedRanges,this.$),Qb=M.o(Ta.ha.sa.activeCell,this.$);v.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return U.a(this.$.userOperationManager,(Lb,Jb,Ab)=>fa.q(this.$.pa.va,Qb,mb,Lb,Jb,Ab,null),Lb=>new X.a(201,0,Lb),null)}v4e(Ta,mb){let Qb=null;var Lb=eb.g(this.$).ha.sa.selectedRanges;Lb=this.gridView.d$("MoreColors",Lb,1,!0);try{for(Lb.$$rst();Lb.$$mn();){const Jb=Lb.$$cu().cell;if(!Jb)continue;let Ab=ib.black;if(1970784898===Ta)Ab=Jb.color;
else if(1650812936===Ta){const pb=Jb.backgroundColor;Ab=sa.a.compare(pb,ib.AVd,!0)&&sa.a.compare(pb,ib.empty,!0)?Jb.backgroundColor:ib.white}if(!Qb)Qb=Ab;else if(Qb!==Ab){Qb=ib.black;break}}}finally{Lb&&Lb.dispose()}this.xb&&this.gridView.$a&&1970784898===Ta&&this.gridView.Qi.textBox.Dse();return this.moreColorsHelper.EAb(Ta,mb,Qb)}b2h(Ta){const mb=z.a.z3a(this.borderFormatManager.x2);return this.moreColorsHelper.EAb(-236759591,Ta,mb)}Wmb(Ta,mb,Qb,Lb=!1){mb?this.gridView.Qi.wHf(Qb.Font):(this.Avi(Ta),
Lb?window.requestAnimationFrame(()=>{B.FocusManager.instance().Rj(y.AFrame.m$);this.gridView.Qi.mTe(Qb.Font)}):(B.FocusManager.instance().Rj(y.AFrame.m$),this.gridView.Qi.mTe(Qb.Font)),this.b_a())}Avi(Ta){const mb=H.a(Ta.command);Ta=A.a[Ta.Re]+"_"+K.a[Ta.method];const Qb=this.gridView.dc.Zve.toString(),Lb=new Map;Lb.set("Command",mb);Lb.set("Source",Ta);Lb.set("Ribbon","React");Lb.set("CellTextRuns",Qb);G.Health.instance.recordKpiUsage(xb.a.ZBh,0,ob.a.gTf,Lb)}fgd(Ta,mb,Qb){Ta=this.borderFormatManager.fgd(Ta,
mb,Qb);this.moreColorsHelper&&this.moreColorsHelper.tca(mb,this.borderFormatManager.x2,Qb);return Ta}getThemeColor(Ta){let mb;mb={};let Qb=!1;if((Ta.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return v.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:mb};let Lb;({themeIndex:Ta,zAa:Lb,returnValue:Qb}=this.themesManager.getThemeColor(Ta.Color));Qb&&(mb.ThemeColorIndex=Ta,mb.ThemeColorRow=Lb)}return{returnValue:Qb,
themeColor:mb}}static get QYi(){return ib.sce||(ib.sce=RegExp("^[0-9]+[.]?[0-9]*$"))}static get hkd(){return ib.Y6d||(ib.Y6d={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get oYa(){return ib.xfb||(ib.xfb={["-394785302"]:0,["-571165336"]:2,
["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3})}static get Rof(){return ib.K$d||(ib.K$d={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static Ahi(Ta){return-1150205178===Ta||-1142465846===Ta||-286432209===Ta}static huc(Ta){const mb={},Qb={};mb.ValidMembers=16;mb.Font=Qb;Qb.ValidMembers=Ta;return mb}static AXe(Ta,mb){let Qb;Qb=Ta.top<mb.top?3:Ta.bottom>mb.bottom?0:-1;return Qb=Ta.left<mb.left?1:Ta.right>mb.right?2:Qb}}ib.AVd="transparent";ib.notSet="-1";
ib.black="#000000";ib.empty="";ib.white="#FFFFFF";ib.Y6d=null;ib.xfb=null;ib.K$d=null;ib.sce=null;ib.OIa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(t.a)(ib,"GridCommandHandler",null,[188]);class Bb extends m.a{constructor(Ta){super(Ta)}Dd(){const Ta=d.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ib),mb=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ib),Qb=d.GetServiceTaskFactory.create(this.$.da,397,this.la,this.ib),Lb=d.GetServiceTaskFactory.Ta(this.$.da,502,503,this.ib);
if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const Jb=d.GetServiceTaskFactory.Ta(this.$.da,296,468,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([Ta,mb,Qb,Jb,Lb],this.la),()=>{this.ld([new ib(this.$,eb.g(this.$),mb.result,Ta.result,Jb.result,Qb.result,Lb.result)])},this.la,3)}else{const Jb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([Ta,mb,Jb,Qb,Lb],this.la),()=>{this.ld([new ib(this.$,eb.g(this.$),
mb.result,Ta.result,new k.BorderFormatManager(this.$,mb.result,Jb.result),Qb.result,Lb.result)])},this.la,3)}}static ka(Ta){m.a.Rd(80,new Bb(Ta))}}Object(t.a)(Bb,"GridCommandHandlerFactory",m.a,[]);a.d(D,"a",function(){return Ub});const Ub=()=>{c.a.Fa(Bb.ka);c.a.Fa(l.ka)}},1169:function(t,D,a){t=a(0);var c=a(15),b=a(184),d=a(83),f=a(84),e=a(381),k=a(99),l=a(44);class m{constructor(){this.uca=this.FUe=null}}Object(t.a)(m,"GestureAdapterInfo",null,[]);var v=a(4),n=a(371),w=a(225);class r{constructor(){this.HFc=
null}Jri(){if(!this.HFc){var R="hammer.min.js";v.AFrameworkApplication.fa.lo("IsServerFlavorDebug")&&(R=v.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");R=v.AFrameworkApplication.aL(String.format("{0}",R),5);R=w.a.create(R,null,null);n.a.Kha(R);this.HFc=R.y7a}return this.HFc}static get instance(){r.Ma||(r.Ma=new r);return r.Ma}}r.Ma=null;Object(t.a)(r,"HammerJsDependencyLoader",null,[378]);var u=a(13);const x=(R,M,L=null)=>{if(void 0===M||null===M)throw c.ULS.sendTraceTag(42256258,
310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let U=null;switch(R){case u.a.pinch:U=new Hammer.Pinch(L);break;case u.a.pan:U=new Hammer.Pan(L)}U&&(U.manager=M);return U};var z;(function(R){R[R.none=-1]="none";R[R.pinch=0]="pinch";R[R.pan=1]="pan";R[R.swipe=2]="swipe"})(z||(z={}));Object(t.b)("GestureEvent",z);var B=a(76);class y extends B.a{constructor(R,M,L,U,X,da,fa,S){super(R,L,U,da);this.cgb=M;this.yfa=fa;this.RW=S;this.oog=X}get shiftKey(){return this.yfa}get ctrlKey(){return this.RW}get clientPoint(){return this.cgb}get jua(){return this.oog}static create(R,
M,L,U,X,da){if(L.rawEvent)if(da){var fa=L.rawEvent;fa=new Sys.UI.Point(fa.clientX,fa.clientY)}else fa=B.a.Xtb(L);else fa=new Sys.UI.Point(L.clientX,L.clientY);return new y(R,fa,M,L,U,X,L.shiftKey,L.ctrlKey,da)}}Object(t.a)(y,"GestureEventArgs",B.a,[]);class A{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=
this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(t.a)(A,"GestureManagerData",null,[]);class K{}K.Cig=2;K.Dig=4;K.Eig=8;K.Fig=8;Object(t.a)(K,"HammerConstants",null,[]);var G=a(91),T=a(205),W=a(29),P=a(79);class E extends l.a{constructor(R,M){super();this.upa=e.a.SFh;this.hNc=!!window.PointerEvent;this.$ge=window.hasOwnProperty("ontouchstart");this.$Ua=this.ojb=null;this.V7=!1;this.BS=new k.a;this.Ijb=
new k.a;this.pog=new b.a;this.Ooa=null;this.eUa=this.xHc=this.R1d=this.qEc=this.bLc=this.zde=this.X1d=this.glb=!1;this.Rib=-1;this.curRecognizer=this.element=this.handlers=this.session=this.RPc=null;this.Md=G.EventHandlerManager.instance;this.hNc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.ojb=Object(d.a)(this,this.umc,"onPointerEvent"),this.$Ua=u.a.UFh):this.$ge?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.ojb=Object(d.a)(this,this.eya,"onTouchEvent"),this.$Ua=
u.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.ojb=Object(d.a)(this,this.emc,"onMouseEvent"),this.$Ua=u.a.TFh);this.xh=M;this.Bea=R;v.AFrameworkApplication.fa&&(this.glb=v.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.X1d=v.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.zde=v.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.bLc=v.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.qEc=
v.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.R1d=v.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.xHc=v.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.eUa=this.glb&&v.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&v.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}oOh(){return this.hNc?0:this.$ge?1:2}hn(R){super.hn(R);this.Md.xja(this.$Ua,R,0,this.ojb)}km(R){super.km(R);
this.Md.xHa(R,this.$Ua)}p7i(R,M,L=null){v.AFrameworkApplication.pfc()?r.instance.Jri().continueWith(U=>{this.fEj();if(U.Sf||U.Bh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",U.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",U.status);if(this.R1d){U=window.Hammer;if("undefined"===typeof U){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.mxc();return}if("undefined"===typeof U.inputHandler){c.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.mxc();return}}if(!R)throw this.mxc(),Error.argumentNull("source element can not be null");U=T.a.Jua(R,this.upa);if(void 0===U||null===U)U=new k.a,T.a.acb(R,this.upa,U),this.q7i(R);var X=null;U.lb(z[0])||(X=Object.assign(new m,{uca:x(z[0],this,null),FUe:M}),U.add(z[0],X));if(void 0!==L&&null!==L)for(let da=0;da<L.length;da++)if(U.lb(z[L[da]])){const fa=U.na(z[L[da]]);X.uca.recognizeWith(fa.uca)}}this.mxc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}fEj(){this.xHc&&
(this.xh?this.RPc=this.xh.xc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}mxc(){this.xHc&&(this.RPc?this.RPc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}q7i(R){this.pog.add(R);this.Md.xja(this.$Ua,R,0,this.ojb)}recognize(R){var M=Array(R.pointers.length);for(var L=0;L<R.pointers.length;L++)M[L]=R.pointers[L].target;L=null;for(this.Ooa=this.EQh(M);void 0!==this.Ooa&&null!==this.Ooa&&
(L=T.a.Jua(this.Ooa,this.upa),void 0===L||null===L);this.Ooa=this.Ooa.parentNode);if(void 0!==L&&null!==L){this.curRecognizer&&this.curRecognizer.state===K.Fig&&(this.curRecognizer=null);M=L.keys;for(let U of M){M=L.na(U);void 0!==M&&null!==M&&void 0!==M.uca&&null!==M.uca&&(void 0===this.curRecognizer||null===this.curRecognizer||M.uca===this.curRecognizer||M.uca.canRecognizeWith(this.curRecognizer))&&M.uca.recognize(R);const X=M.uca.state;this.curRecognizer||K.Cig!==X&&K.Dig!==X&&K.Eig!==X||(this.curRecognizer=
M.uca)}}}emit(R,M){if("hammer.input"!==R){this.V7=!1;M=y.create(R,this.Ooa,M.srcEvent,M,3,this.hNc);var L=T.a.Jua(this.Ooa,this.upa);if(this.Cji(R))var U=0;else if(this.rji(R))U=1;else if(this.qmi(R))U=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:L}=L.Cc(z[U]));void 0!==L&&null!==L&&((L=L.FUe,L.jhi())?R.endsWith("start")?this.V7=L.LJi(M):R.endsWith("end")?(L.JJi(M),this.V7=!0):R.endsWith("cancel")?(L.IJi(M),this.V7=!0):R.endsWith("move")&&
(this.V7=L.KJi(M)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",R))}}get(R){return Object(f.a)(Hammer.Recognizer,R)}EQh(R){if(1>R.length)return null;if(1===R.length)return R[0];var M=R[0],L=!0;for(let U=1;U<R.length;U++){if(!R[U])return null;if(M!==R[U]){L=!1;break}}if(L)return M;M=this.YUe(R[0]);L=0;for(const U of R){R=this.YUe(U);if(M.na(M.count-1)!==R.na(R.count-1))return null;for(let X=M.count-2,da=R.count-2;X>=L&&0<=da;X--,da--)if(M.na(X)!==R.na(da)){L=X+1;break}}return M.na(L)}YUe(R){const M=
new b.a;for(;void 0!==R&&null!==R;R=R.parentNode)M.add(R);return M}HYe(R){switch(R){case u.a.zf:case u.a.v9:return 1;case u.a.Xf:case u.a.Bga:return 2;case u.a.te:case u.a.OFa:return 4;case u.a.Qyc:case u.a.TWc:return 8}return 0}eya(R,M,L){R=this.HYe(R);M=this.mPh(L);Hammer.inputHandler(this,R,M);this.V7&&L.preventDefault();return this.V7}c5e(){return 1<this.BS.count}Z_b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.glb)for(let R of this.BS)this.nOf(R.key);else this.BS=
new k.a;this.session=null}jBg(R,M,L){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",R);if(!this.Ijb.lb(R)){try{M.setPointerCapture(R)}catch(U){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",U)}this.Ijb.add(R,M)}this.BS.ia(R,L);this.eUa&&1<this.BS.count&&this.Bea&&!this.Bea.Fob&&(this.Bea.Fob=!0)}nOf(R){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",R);if(this.Ijb.lb(R)){try{this.Ijb.na(R).releasePointerCapture(R)}catch(M){c.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",M)}this.Ijb.remove(R)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",R);this.BS.remove(R);this.eUa&&1>=this.BS.count&&this.Bea&&this.Bea.Fob&&(this.Bea.Fob=!1)}umc(R,M,L){var U=L.rawEvent.pointerType.toString();const X=L.rawEvent.pointerId.toString();if("touch"!==U)return!1;R=this.HYe(R);if(1!==R&&!this.BS.lb(X))return!1;this.X1d&&1===R&&L.rawEvent.isPrimary&&this.BS.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),
this.Z_b());this.glb?this.jBg(X,M,L):this.BS.ia(X,L);this.bLc&&2===R&&(!this.qEc||this.qEc&&"function"===typeof L.rawEvent.getCoalescedEvents)&&(M=L.rawEvent.getCoalescedEvents())&&this.c5e()&&(this.Rib=Math.max(this.Rib,M.length));this.zde&&(this.V7=!1);U=this.lPh(this.BS,L,U);Hammer.inputHandler(this,R,U);if(4===R||8===R)this.glb?this.nOf(X):this.BS.remove(X),this.BS.count||(this.session=null,this.bLc&&-1!==this.Rib&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Rib),
this.Rib=-1));this.V7&&L.preventDefault();return this.V7}emc(){return!1}mPh(R){const M=new A;var L=R.rawEvent;const U=L.touches;L=L.changedTouches;M.pointers=Array.clone(U);M.pointers=Array.clone(0<U.length?U:L);M.changedPointers=Array.clone(L);M.srcEvent=R;M.pointerType="touch";return M}lPh(R,M,L){const U=new A;U.pointers=P.toArray(R.values);U.changedPointers=[M];U.pointerType=L;U.srcEvent=M;return U}Cji(R){return W.a.startsWith(R,u.a.pinch)}rji(R){return W.a.startsWith(R,u.a.pan)}qmi(R){return W.a.startsWith(R,
u.a.swipe)}}Object(t.a)(E,"GestureInputManager",l.a,[374,375]);var H=a(275),F=a(246);class N{constructor(){this.gb=null;this.$w=!1}get name(){return"Common.App.GestureInputManager"}ai(R){R.register(E,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").uc().Gc(()=>new E(H.a.instance,v.AFrameworkApplication.ta.LD));this.gb=R}init(){this.$w||(this.gb.resolve("Common.App.GestureManager.GestureInputManager"),this.$w=!0)}dispose(){}static main(){F.a.instance.Ii(new N)}}Object(t.a)(N,
"GestureInputManagerPackage",null,[4,5]);a.d(D,"a",function(){return J});const J=()=>{Type.registerNamespace("Common.App.GestureManager");N.main()}},1180:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(27),f=a(86),e=a(29),k=a(412),l=a(234);class m{}m.vnh="ewa-dv";m.wnh="ewa-dv-buttonarea";m.Dmh="ewa-dlb";m.SAb="list-table";m.listItem="list-item";m.PAb="list-item-selected";m.TAb="list-table-touch";m.unh="ewa-dpb";m.Hhh="dv-prompt-title";m.Ghh="dv-prompt-message";Object(t.a)(m,"CssClassNames",null,
[]);var v=a(30),n=a(550),w=a(19),r=a(48),u=a(421),x=a(77),z=a(7),B=a(15),y=a(153),A=a(814),K=a(37),G=a(14),T=a(21),W=a(261),P=a(63);class E extends y.ErrorDialog{constructor(pa,Ja,$a){super(pa,E.fQ(Ja,pa,$a));this.Uc=()=>{this.setFocus()};T.g(this.$).ha.LG(this.Uc);(pa=pa.da.za(14).W2a($a))&&pa.options&1&&B.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){T.g(this.$).ha.RF(this.Uc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var pa=
4;break;case 1:pa=3;break;case 2:pa=0;break;default:pa=this.mM}(pa=this.getButton(pa))?pa.get_element().focus():super.setFocus()}zpb(){const pa=T.g(this.$);pa.$a&&pa.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.oSd(1);if(2===this.returnValue||0===this.returnValue){const Ja=pa.Xb(null);if(Ja){pa.Ea.SU();const $a=Object(z.a)(new W.a,{Text:Ja.originalText});pa.setCell($a,Ja.range,0,63,null)}this.$.xd(-798660877,x.a.Eb,8,null)}super.zpb()}Ora(){const pa=
T.g(this.$);pa.$a&&pa.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.oSd(0);super.Ora()}oSd(pa){const Ja=T.g(this.$);K.TaskExtensions.Aa(Ja.startEdit(!1,pa),()=>{const $a=Ja.Wb.textBox;$a.text&&$a.selectRange(0,$a.text.length)},this.la,11,P.a.current)}static fQ(pa,Ja,$a){$a=Ja.da.za(14).W2a($a);pa.MessageId=-1083021405;pa.MessageIdName="DataValidationError";pa.MessageIdHash=e.a.Xv(pa.MessageIdName);pa.Severity=$a?$a.h7c:1;Ja=(null===$a||void 0===
$a?0:$a.gIa)?e.a.Dg($a.gIa):null;$a=(null===$a||void 0===$a?0:$a.error)?e.a.Dg($a.error):String.format("<p>{0}</p><p>{1}</p>",G.a.instance.ga(895),G.a.instance.ga(896));switch(pa.Severity){case 0:pa.Appearance=18;break;case 1:pa.Appearance=12;$a+=String.format("<p>{0}</p>",G.a.instance.ga(897));break;default:pa.Appearance=3}pa.Caption=Ja;pa.Description=$a;pa.HelpDescription=G.a.instance.ga(1317);pa.HelpTopicId=A.a.FEe;return pa}}Object(t.a)(E,"DataValidationErrorDeprecatedDialog",y.ErrorDialog,[]);
y=a(282);var H=a(5),F=a(42),N=a(247),J=a(189),R=a(54),M=a(31),L=a(281),U=a(11),X=a(280),da=a(158);class fa extends y.a{constructor(pa,Ja,$a){super(pa);this.lU=this.Ex=null;this.gff=!1;this.pW=this.Dm=this.s6e=this.errorMessage=null;this.GEe=rb=>{const Pa=this.$;var eb=this.gff;this.hide();const Ob=T.g(Pa);Ob.$a&&Ob.Wb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===rb&&eb&&K.TaskExtensions.Aa(Ob.startEdit(!1,1),()=>{const tb=Ob.Wb.textBox;tb.text&&tb.selectRange(0,tb.text.length)},
this.la,11,P.a.current);if(1===rb&&!eb){if(eb=Ob.Xb(null)){Ob.Ea.SU();const tb=Object(z.a)(new W.a,{Text:eb.cell.userInput});Ob.setCell(tb,eb.range,0,63,null)}Pa.xd(-798660877,x.a.Eb,8,null)}2===rb&&K.TaskExtensions.Aa(Ob.startEdit(!1,0),()=>{const tb=Ob.Wb.textBox;tb.text&&tb.selectRange(0,tb.text.length)},this.la,11,P.a.current)};this.$yd=()=>{U.HelperMethods.nV(this.$.oG,this.error.HelpTopicId,this.$.ZR)};this.BLi=()=>{this.xwb();this.$.xd(802602464,2,8,this.lU)};this.XJi=()=>{B.ULS.sendTraceTag(537163288,
0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.YJi=rb=>{!rb||L.a(rb)?B.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(rb=this.sVh(rb.Result),this.Ex.errorInformation=rb,this.WSa(this.gIa,this.D3a(this.GEe),this.Ex))};this.Fyd=()=>{this.show(this.xQb)};this.IKe=$a;this.sqmManager=da.a(this.$);this.error=fa.fQ(Ja,pa,$a);this.rb.To=
this;this.gIa=(this.Tu=pa.da.za(14).W2a(this.IKe))&&this.Tu.gIa?this.Tu.gIa:G.a.instance.ga(1729);this.Uoj();this.initializeAndShow(this.gIa,this.GEe,this.Ex)}get oc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.To&&(this.rb.To=null);f.a.Ia(this.Dm);this.Dm=null;super.dispose()}Uoj(){this.Tu&&this.Tu.error?this.errorMessage=this.Tu.error:this.Tu&&this.Tu.options&1?(B.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=G.a.instance.ga(1731),this.s6e=R.a.current.Rn(119)):(this.errorMessage=G.a.instance.ga(1730),this.iLh(this.IKe));var pa=this.Tu?this.Tu.h7c:1;this.Ex={[fa.Uu]:this.oc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.s6e};switch(pa){case 0:this.Sb=1;this.sc(1,"Retry");this.Ex.dialogIcon=2;this.gff=!0;break;case 1:this.Sb=4;this.Ex.dialogIcon=1;this.Ex.additionalInformation=G.a.instance.ga(897);break;default:this.Sb=1,this.Ex.dialogIcon=3}this.Ex.helpLink={["type"]:"AppLinkProps",
[fa.Uu]:this.error.HelpTopicId,["text"]:G.a.instance.ga(1317),["handler"]:this.$yd};pa=M.a.dVc([this.error]);this.lU={[H.a.G7b]:!0,[H.a.m9c]:pa,[H.a.n9c]:da.a(this.$).gsb(this.error.MessageIdHash),[H.a.sU]:this.oc,["DismissHandler"]:this.Fyd};this.Ex.giveFeedbackLink={["type"]:"AppLinkProps",[fa.Uu]:H.a.Qfd,["text"]:G.a.instance.ga(1767),["handler"]:this.BLi}}iLh(pa){const Ja=this.$.pa.va.Qb();N.f(this.$.pa.va,F.q(pa,this.$),X.b(this.YJi),X.a(this.XJi),null,Ja)}sVh(pa){let Ja;switch(pa.RuleType){case 1:switch(pa.ConditionType){case 0:return Ja=
G.a.instance.mb(108),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 1:return Ja=G.a.instance.mb(109),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 2:return Ja=G.a.instance.mb(110),String.format(Ja,pa.LowerBoundary);case 3:return Ja=G.a.instance.mb(111),String.format(Ja,pa.LowerBoundary);case 4:return Ja=G.a.instance.mb(112),String.format(Ja,pa.LowerBoundary);case 5:return Ja=G.a.instance.mb(113),String.format(Ja,pa.UpperBoundary);case 6:return Ja=G.a.instance.mb(114),String.format(Ja,
pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(115),String.format(Ja,pa.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(pa.ConditionType){case 0:return Ja=G.a.instance.mb(116),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 1:return Ja=G.a.instance.mb(117),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 2:return Ja=G.a.instance.mb(118),String.format(Ja,pa.LowerBoundary);case 3:return Ja=G.a.instance.mb(119),String.format(Ja,pa.LowerBoundary);case 4:return Ja=
G.a.instance.mb(120),String.format(Ja,pa.LowerBoundary);case 5:return Ja=G.a.instance.mb(121),String.format(Ja,pa.UpperBoundary);case 6:return Ja=G.a.instance.mb(122),String.format(Ja,pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(123),String.format(Ja,pa.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(pa.ConditionType){case 0:return Ja=G.a.instance.mb(124),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 1:return Ja=G.a.instance.mb(125),String.format(Ja,pa.LowerBoundary,
pa.UpperBoundary);case 2:return Ja=G.a.instance.mb(126),String.format(Ja,pa.LowerBoundary);case 3:return Ja=G.a.instance.mb(127),String.format(Ja,pa.LowerBoundary);case 4:return Ja=G.a.instance.mb(128),String.format(Ja,pa.LowerBoundary);case 5:return Ja=G.a.instance.mb(129),String.format(Ja,pa.UpperBoundary);case 6:return Ja=G.a.instance.mb(130),String.format(Ja,pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(131),String.format(Ja,pa.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(pa.ConditionType){case 0:return Ja=
G.a.instance.mb(132),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 1:return Ja=G.a.instance.mb(133),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 2:return Ja=G.a.instance.mb(134),String.format(Ja,pa.LowerBoundary);case 3:return Ja=G.a.instance.mb(135),String.format(Ja,pa.LowerBoundary);case 4:return Ja=G.a.instance.mb(136),String.format(Ja,pa.LowerBoundary);case 5:return Ja=G.a.instance.mb(137),String.format(Ja,pa.UpperBoundary);case 6:return Ja=G.a.instance.mb(138),String.format(Ja,
pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(139),String.format(Ja,pa.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(pa.ConditionType){case 0:return Ja=G.a.instance.mb(140),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 1:return Ja=G.a.instance.mb(141),String.format(Ja,pa.LowerBoundary,pa.UpperBoundary);case 2:return Ja=G.a.instance.mb(142),String.format(Ja,pa.LowerBoundary);case 3:return Ja=G.a.instance.mb(143),String.format(Ja,pa.LowerBoundary);case 4:return Ja=
G.a.instance.mb(144),String.format(Ja,pa.LowerBoundary);case 5:return Ja=G.a.instance.mb(145),String.format(Ja,pa.UpperBoundary);case 6:return Ja=G.a.instance.mb(146),String.format(Ja,pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(147),String.format(Ja,pa.UpperBoundary);default:return"we couldn't get the details"}case 3:return Ja=G.a.instance.mb(106),String.format(Ja,pa.LowerBoundary);case 7:return Ja=G.a.instance.mb(107),String.format(Ja,pa.LowerBoundary);default:return"we couldn't get the details"}}oSd(pa){const Ja=
T.g(this.$);K.TaskExtensions.Aa(Ja.startEdit(!1,pa),()=>{const $a=Ja.Wb.textBox;$a.text&&$a.selectRange(0,$a.text.length)},this.la,11,P.a.current)}get la(){this.Dm=this.Dm||new J.a;return this.Dm.token}static fQ(pa,Ja,$a){Ja=Ja.da.za(14).W2a($a);pa.MessageId=-1083021405;pa.MessageIdName="DataValidationError";pa.MessageIdHash=e.a.Xv(pa.MessageIdName);pa.Severity=Ja?Ja.h7c:1;pa.HelpDescription=G.a.instance.ga(1317);pa.HelpTopicId=A.a.FEe;return pa}}Object(t.a)(fa,"DataValidationErrorDialog",y.a,[92,
93,3,94]);y=a(906);var S=a(379);class ka extends y.a{constructor(pa,Ja,$a){super(pa,Ja);this.dataValidationControl=$a}get Sxb(){return Object(k.a)(fa,this.$.rb.eh)}get iK(){return this.dataValidationControl.qe}set iK(pa){this.dataValidationControl.qe=pa}get N4a(){return!1}get key(){return S.a.L3c}dispose(){this.dataValidationControl=null;super.dispose()}Sh(pa,Ja){this.dataValidationControl.Ya=this.Ya;const $a=pa.keyCode;return 1461300262!==Ja||16!==$a&&17!==$a&&18!==$a?super.Sh(pa,Ja):!1}Jxd(){this.iK&&
(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.XM,!0,!0,d.a.jp||3===x.a.Eb))}Jf(){}Lh(){this.dataValidationControl.show(this.dataValidationControl.XM,!0,!0,d.a.jp||3===x.a.Eb)}pEd(pa,Ja){return this.dataValidationControl.Sh(Ja)}}Object(t.a)(ka,"DataValidationListAutoCompleteBehavior",y.a,[]);var V=a(262);y=a(835);var wa=a(12),ma=a(116),ab=a(22),ba=a(905),Ca=a(1);class Na extends y.a{constructor(pa,Ja,$a){super(pa,Ja,new ba.a(m.listItem,m.PAb,m.SAb,
m.TAb));this.sHa=this.cV=this.Xca=this.de=this.vkb=null;this.KMa=0;this.JEb=[];this.DQj=Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.RAb=$a}get Ej(){return this.vkb}set Ej(pa){this.DAa(this.vkb);if(pa){this.vkb=pa;this.RAb.innerText="";this.DAa(this.vkb);const Ja=this.JEb[pa.rowIndex];this.de=this.cV[Ja];this.sHa&&(this.Xca=this.sHa[Ja],B.ULS.shipAssertTag(537163286,0,!this.JEb.length||!!this.Xca,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.RAb.innerText=this.de;this.itc(pa)}else this.Xca=this.de=null}get $a(){return T.g(this.$).$a}get editText(){return T.g(this.$).Wb.text}dispose(){super.dispose();this.RAb=this.vkb=null}Nda(pa,Ja,$a,rb){if(pa&&(!pa||pa.length)){this.S6(!1);this.sHa=pa;this.cV=[];for(var Pa=0;Pa<pa.length;Pa++)this.cV[Pa]=pa[Pa]?pa[Pa].Name:null;Pa=`<table class='${this.qba}' aria-live='polite'><tbody>`;var eb="",Ob="";pa=0;var tb=T.g(this.$).Xb(null);rb=this.$a?rb?rb.text:this.editText:tb?tb.originalText:null;
tb=!rb;var cc=0;this.JEb.length=0;var Ib=[],Mb=[],Oa=[],Aa=rb?rb.split(" "):[""];rb=rb.trim();for(let ob=0;ob<this.cV.length;ob++){const xb=this.cV[ob];var Ba=void 0;const Va=xb.split(" ");Ba=V.a.all(Aa,Qa=>V.a.any(Va,qb=>ab.a.jL(qb,Qa)));const bb=!xb,ra=Oa.includes(xb);bb||ra||this.$a&&!Ba||(Ba=xb?e.a.Dg(e.a.r6c(xb)):"",Ba=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.IZ,Ba),Oa.push(xb),this.$a&&ab.a.jL(xb,rb)?(eb+=Ba,Ib.push(ob)):(Ob+=Ba,Mb.push(ob)),!tb&&ab.a.equals(rb,xb,!0)&&
(pa=this.$a?Ib.length-1:cc,tb=!0),cc++)}this.KMa=cc;this.JEb.push(...Ib);this.JEb.push(...Mb);this.fg.innerHTML=Pa+(eb+Ob+"</tbody></table>");Pa=this.pn=wa.DOMElementExtensions.Kj(this.domElement,this.qba);this.cmb(Pa,Ja);this.S6(!0);this.hra(Ja,$a);this.Ej=0<this.KMa?Pa.rows[pa]:null}}GQa(pa){var Ja=!1;this.$a&&pa&&(Ja=!this.KMa,pa.endEdit(Ja,"DataValidationListBox.SetCellContent",0));if(!Ja&&(pa=T.g(this.$),Ja=pa.Xb(null))){let rb=null;if(this.Xca&&-1!==this.Xca.SheetId&&-1!==this.Xca.Row&&-1!==
this.Xca.Column){var $a={};$a.SheetName=this.Xca.SheetId.toString();$a.FirstRow=this.Xca.Row;$a.FirstColumn=this.Xca.Column;rb={ParameterType:6};rb.SourceRange=$a}$a=Object(z.a)(new W.a,{Text:this.de});pa.setCell($a,Ja.range,0,63,rb)}return!0}hra(pa,Ja){const $a=pa?this.JBb:this.UH;pa=pa?this.cic:this.dic;0>=this.KMa?this.fg.style.height=U.HelperMethods.qc(pa):(this.fg.style.height="auto",this.KMa>$a?(wa.DOMElementExtensions.CI(this.fg,this.DQj?Math.floor(pa*$a):Math.floor(this.fg.offsetHeight*$a/
this.KMa)),this.fg.style.overflowY="auto"):(this.fg.style.height="auto",this.fg.style.overflowY="hidden"));wa.DOMElementExtensions.Gv(this.fg,Ja);wa.DOMElementExtensions.Gv(this.pn,Ja-(this.KMa>$a?ma.a.qu:0))}}Object(t.a)(Na,"DataValidationListBox",y.a,[]);var za=a(113),la=a(250),aa=a(253),sa=a(1087);const ea=`<p class='${m.Hhh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,Z=`<p class='${m.Ghh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var ua=w.a.KLe,ya=w.a.KLe,
ha=w.a.aYg;class Da extends l.a{constructor(pa){super(document.createElement("div"));this.w_b=this.mQ=this.JQ=!1;this.Wh=this.Kh=null;this.Cfi=Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.Dfi=Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.bld=this.fod=this.gnd=!1;this.c4b=[];this.Dh=()=>{this.b2f(!1)};this.TNa=($a,rb)=>{this.show(this.XM,!this.qe,!0,d.a.jp||3===rb.tb||3===x.a.Eb);this.pyd(null,null)};this.pyd=
()=>{this.gridView.setFocus()};this.HKa=()=>{this.Ya.textBox.jF=!0};this.mt=()=>{this.xcg()};this.onContentReady=()=>{this.b2f(this.qe)};this.Dc=()=>{this.Sx()};this.bya=()=>{this.GQa()};this.uvf=()=>{this.xcg()};this.$=pa;this.gridView=T.g(this.$);this.LI=this.gridView.Wb;var Ja="<div id='dv_reader_description' class='"+v.a.bMe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+m.wnh+" "+w.a.Lp+"'></div>\r\n<div id='dv_list_box' class='"+m.Dmh+" "+w.a.Wo+" "+w.a.Lp+"'></div>\r\n<div id='dv_prompt_box' class='"+
m.unh+" "+w.a.Lp+"'></div>";this.domElement.className=m.vnh;this.domElement.innerHTML=Ja;la.d(this.style,this.isGridRtl);this.fg=$get("dv_list_box",this.domElement);this.m_=$get("dv_prompt_box",this.domElement);this.Jra=$get("dv_list_button",this.domElement);this.RAb=$get("dv_reader_description",this.domElement);(Ja=za.a(pa))&&this.c4b.push(new ka(pa,Ja,this));this.c4b.push(new ka(pa,this.gridView.Wb,this));this.gridView.ha.iJ(this.Dh);this.gridView.Nu(this.onContentReady);this.gridView.dc.VDg(this.uvf);
this.$.ik(this.Dc);Ja=this.gridView.uj;Ja.insertBefore(this.domElement,Ja.firstChild);this.onContentReady(null,null);pa.da.Ga(14,this)}get wzb(){return!!(this.$.Bd&16)}get Vmi(){return this.qe||this.XM||this.Pva}get qe(){return wa.DOMElementExtensions.isVisible(this.fg)}set qe(pa){wa.DOMElementExtensions.setVisible(this.fg,pa)}get XM(){return wa.DOMElementExtensions.isVisible(this.m_)}set XM(pa){wa.DOMElementExtensions.setVisible(this.m_,pa)}get Pva(){return wa.DOMElementExtensions.isVisible(this.Jra)&&
!!this.Kh&&wa.DOMElementExtensions.isVisible(this.Kh.domElement)}set Pva(pa){wa.DOMElementExtensions.setVisible(this.Jra,pa);this.Kh&&wa.DOMElementExtensions.setVisible(this.Kh.domElement,pa)}get Ya(){return this.LI}set Ya(pa){this.LI=pa}get e4a(){return!!this.activeCell&&this.t5c(this.activeCell.range)}get activeCell(){return this.gridView.Xb(null)}get M5e(){return this.e4a&&!!this.Tu&&!!(this.Tu.options&2)&&!!this.Tu.prompt}get Wvb(){return this.e4a&&!!this.Tu&&!!(this.Tu.options&1)}get isGridRtl(){return this.gridView.rtl}get Tu(){return this.W2a(this.activeCell.range)}get ENa(){const pa=
this.activeCell;return pa?this.Kua(this.gridView,pa):null}dispose(){this.$&&(this.GLb(!1),this.gridView.ha.RK(this.Dh),this.gridView.qy(this.onContentReady),this.gridView.dc.iaj(this.uvf),this.$.Bl(this.Dc));this.VCe(!1);this.WCe(!1);f.a.rc(this.c4b);this.c4b=this.Jra=this.fg=this.m_=this.LI=this.gridView=this.$=null;super.dispose()}t5c(pa){return!!this.W2a(pa)}jqb(pa,Ja){return Ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new fa(this.$,pa,Ja):new E(this.$,
pa,Ja)}W2a(pa){pa=this.gridView.getRangeInformation(pa);for(let Ja=0;Ja<pa.length;Ja++){const $a=pa[Ja];if(Object(k.a)(u.DataValidationRange,$a))return $a}return null}lHh(){if(!this.e4a)return"";const pa=this.M5e?`${this.Tu.KIf} ${this.Tu.prompt}`:"",Ja=this.Wvb?G.a.instance.ga(843):"";return String.format(G.a.instance.mb(17),pa,Ja)}Sh(pa){let Ja=!1;if(this.qe||(-569786022===pa||541421805===pa)&&this.Wvb||1872288872===pa&&this.XM)switch(pa){case -569786022:case 541421805:this.show(this.XM,!this.qe,
!0,d.a.jp||3===x.a.Eb);Ja=!0;break;case 1872288872:this.qe?(this.show(this.XM,!1,!0,!1),Ja=!0):this.XM?(this.show(!1,!1,!0,!1),Ja=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Ja=!0);break;case -798660877:this.Wh.rB(1);Ja=!0;break;case 137938150:this.Wh.rB(-1);Ja=!0;break;case 2091832999:this.Wh.rB(this.Wh.UH-1);Ja=!0;break;case 742457698:this.Wh.rB(-(this.Wh.UH-1));Ja=!0;break;case 125627505:case 267796030:Ja=this.GQa()}return Ja}show(pa,Ja,$a,rb){this.Sx();if(this.wzb&&
this.e4a){var Pa=this.ENa;if(Pa){if(pa||Ja||$a)this.isVisible=!0;la.d(this.style,this.isGridRtl);$a&&this.Wvb&&(this.WCe(!0),this.ocg(Pa,!1));Ja&&this.Wvb&&this.wRa(rb,Pa);pa&&this.M5e&&this.uAj(Pa);this.Vmi||(this.isVisible=!1)}}}Kua(pa,Ja){if(!Ja||!Ja.cell.Ck)return null;var $a=this.gridView.dc.textBox.domElement;var rb=0<wa.DOMElementExtensions.getHeight($a)&&0<wa.DOMElementExtensions.getWidth($a)&&0<=$a.offsetTop&&0<=$a.offsetLeft;if(rb)$a=wa.DOMElementExtensions.Kua($a,pa.uj);else{$a=pa.getCellBounds(Ja.cell);
var Pa=wa.DOMElementExtensions.getBoundingClientRect(pa.uj);$a=new Sys.UI.Bounds($a.x-Pa.x,$a.y-Pa.y,$a.width,$a.height)}if($a)if(rb)2<$a.height&&2<$a.height&&($a.x+=1,$a.y+=1,$a.height-=2,$a.width-=2);else if(rb=T.g(this.$).SJ(Ja.cell))rb=rb.width+1,Pa=ab.a.equals(aa.a.cub(Ja.cell,pa.rtl),"right",!0),pa.rtl&&Pa&&($a.x=$a.x+$a.width-rb),Ja.bka&&pa.rtl===Pa&&($a.width=rb);else return null;return $a}b2f(pa){const Ja=this.e4a;this.GLb(Ja);Ja?this.show(!0,pa,!0,!1):this.Sx()}GQa(){let pa=!1;this.qe&&
(pa=this.Wh.GQa(this.Ya),this.show(this.XM,!1,!0,!1));return pa}Sx(){this.Cfi?(this.qe&&(this.qe=!1),this.Pva&&(this.Pva=!1),this.XM&&(this.XM=!1),this.isVisible&&(this.isVisible=!1)):this.qe=this.Pva=this.XM=this.isVisible=!1;this.gnd=this.bld=this.fod=!1}wRa(pa,Ja){this.Wvb&&!this.Tu.sHa?this.Pva&&this.Kh.disable():(this.VCe(!0),this.Wh.Nda(this.Tu.sHa,pa,this.pQh(Ja),this.Ya),this.WAa(Ja,!1))}uAj(pa){this.Tu.prompt&&(this.XM=!0,this.tSj(this.Tu.KIf,this.Tu.prompt),this.Hcg(pa,!1))}ocg(pa,Ja){const $a=
pa.y;this.Jra.style.top=U.HelperMethods.qc($a);pa=this.isGridRtl?pa.x-this.Jra.offsetWidth+1:pa.x+pa.width+1;this.Jra.style.left=U.HelperMethods.qc(pa);Ja?this.Pva=this.gridView.Pgc(new r.a(pa,$a))&&this.bld:this.bld=!0}WAa(pa,Ja){const $a=pa.y+pa.height;pa=this.isGridRtl?pa.x+pa.width-this.fg.offsetWidth:pa.x;this.fg.style.top=U.HelperMethods.qc($a);this.fg.style.left=U.HelperMethods.qc(pa);Ja?this.qe=this.gridView.Pgc(new r.a(pa,$a))&&this.gnd:this.gnd=!0}Hcg(pa,Ja){const $a=pa.y+pa.height+5;var rb=
this.activeCell;rb=rb?rb.width/2:32;pa=this.isGridRtl?pa.x-this.m_.offsetWidth+rb:pa.x+pa.width-rb;this.m_.style.top=U.HelperMethods.qc($a);this.m_.style.left=U.HelperMethods.qc(pa);Ja?this.XM=this.gridView.Pgc(new r.a(pa,$a))&&this.fod:this.fod=!0}tSj(pa,Ja){if(Ja){var $a="";pa&&($a+=String.format(ea,e.a.Dg(pa)));$a+=String.format(Z,e.a.Dg(Ja));this.m_.innerHTML=$a;pa=wa.DOMElementExtensions.Kj(this.m_,"dv-prompt-titletext");if(Ja=wa.DOMElementExtensions.Kj(this.m_,"dv-prompt-messagetext")){pa=pa?
parseInt(String(Math.max(pa.offsetWidth,Ja.offsetWidth)),10):Ja.offsetWidth;pa+=6;wa.DOMElementExtensions.Gv(this.m_,pa);for(let rb=0,Pa=this.m_.children.length;rb<Pa;rb++)wa.DOMElementExtensions.Gv(this.m_.children[rb],pa)}}}pQh(pa){return this.Dfi?pa.width+17-2+1:pa.width+this.Jra.clientWidth-2+1}WCe(pa){this.$&&!this.wzb||!pa?(this.l6f(!1),f.a.Ia(this.Kh),this.Kh=null):(this.Kh||(this.Kh=new sa.a(this.Jra,ua,n.a.pha,1,ya,G.a.instance.ga(894),ha,G.a.instance.ga(893),"",-1),this.l6f(!0)),this.Pva=
!0,this.Tu.sHa?this.Kh.isEnabled||this.Kh.enable():this.Kh.disable())}VCe(pa){this.$&&!this.wzb||!pa?(this.cSa(!1),f.a.Ia(this.Wh),this.Wh=null):(this.Wh||(this.Wh=new Na(this.$,this.fg,this.RAb),this.cSa(!0)),this.qe=!0)}cSa(pa){this.Wh&&(pa&&!this.JQ?(this.Wh.S8(this.pyd),this.Wh.MXb(this.HKa),this.Wh.wmb(this.bya),this.JQ=!0):!pa&&this.JQ&&(this.Wh.Fca(this.pyd),this.Wh.Tqc(this.HKa),this.Wh.DHb(this.bya),this.JQ=!1))}GLb(pa){pa&&!this.mQ?(this.gridView.view.Ns(this.mt),this.mQ=!0):!pa&&this.mQ&&
(this.gridView.view.Oq(this.mt),this.mQ=!1)}l6f(pa){this.Kh&&(pa&&!this.w_b?(this.Kh.nTc(this.TNa),this.Kh.ATc(this.TNa),this.Kh.imb(this.HKa),this.w_b=!0):!pa&&this.w_b&&(this.Kh.KHd(this.TNa),this.Kh.YHd(this.TNa),this.Kh.pHb(this.HKa),this.w_b=!1))}xcg(){if(this.e4a){var pa=this.ENa;pa&&(this.ocg(pa,!0),this.WAa(pa,!0),this.Hcg(pa,!0))}}}Object(t.a)(Da,"DataValidationControl",l.a,[398,3]);class nb extends b.a{constructor(pa){super();this.$=pa;this.Fb()}create(){this.qb(this.$.da.za(14)||new Da(this.$))}}
Object(t.a)(nb,"DataValidationControlFactory",b.a,[]);a.d(D,"a",function(){return qa});const qa=()=>{c.a.Fa(pa=>{pa.da.Ga(150,new nb(pa))})}},1181:function(t,D,a){function c({x:R,y:M},L,U=document){let X=-1,da=null;void 0!==U.caretPositionFromPoint?(R=U.caretPositionFromPoint(R,M),null!==R&&(X=R.offset,da=R.offsetNode)):void 0!==U.caretRangeFromPoint&&(R=U.caretRangeFromPoint(R,M),null!==R&&(X=R.startOffset,da=R.startContainer));return null===da||-1===X?(n.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
-1):L.contains(da)?b(L,da,X):(n.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function b(R,M,L){if(R===M)return L;if(M.textContent!==M.parentElement.textContent)for(;null!==M.previousSibling;)M=M.previousSibling,L+=M.textContent.length,"div"===M.nodeName.toLowerCase()&&(L+=1);return b(R,M.parentElement,L)}function d(R,M,L){if(R.has(M))return R.get(M);L=L();R.set(M,L);return L}function f(R){return JSON.stringify({text:R.text,start:R.start,length:R.length})}
var e=a(10);t=a(0);var k=a(220),l=a(186),m=a(749),v=a(21),n=a(15),w=a(11),r=a(22),u=a(216),x=a(33);class z{constructor(R,M){this.$=R;this.QIa=M;this.a9h();this.editBox=Object(v.g)(this.$).Wb}get zoomManager(){this.nie||(this.nie=Object(x.a)(this.$));return this.nie}dispose(){this.hide()}show(R,M,L){R=Object.assign(Object.assign({},M),{WA:R,wZd:L});this.Bcb(R)&&(this.ana(R)&&this.hide(),this.HC=R,this.yy(),L&&this.V5h())}hide(){if(this.HC){var R=this.HC.wZd;this.cfh();R&&this.L9i();this.HC=void 0}}Bcb(R){var M;
(M=!this.HC)||(M=this.HC,M=!(M.WA===R.WA&&M.kind===R.kind&&M.text===R.text&&M.start===R.start&&M.length===R.length&&M.wZd===R.wZd));return M}ana(R){var M;if(M=this.HC)M=this.HC,M=!(M.WA===R.WA&&M.start===R.start&&M.length===R.length);return M}V5h(){this.HC.WA.textBox.formatText(this.HC.start,this.HC.length,{background:"rgba(202,234,216,0.6)"})}L9i(){const R=this.HC.WA,M=this.HC.start,L=this.HC.length,U=R.text;U.length<M+L?n.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${U.length}:${M}:${L}`):
R.textBox.formatText(M,L,{background:!1})}yy(){var R=this.HC.text;switch(this.HC.kind){case 1:case 2:R={isLoaded:!0,value:R};break;case 3:R={isLoaded:!1,value:null};break;default:return}this.pTj();this.QIa.renderValuePreview(this.xs,this.GMb,R)}cfh(){this.QIa.dismiss(this.xs)}a9h(){this.xs=document.createElement("div");this.GMb=document.createElement("div");this.GMb.style.position="absolute";this.GMb.style.visibility="hidden";this.$.domElement.appendChild(this.GMb)}pTj(){var R=this.HC.WA,M=this.HC.start;
const L=this.HC.length,U=r.a.contains(R.text.substring(M,M+L),"\n",!0);R=excelOnline.utils.getBoundingRectForText(R.textBox.Se,M,U?M:M+L,!1);M=new u.a(this.GMb.style);M.KB.left=this.xwc(R.left);M.KB.top=this.xwc(R.top);M.KB.width=this.xwc(R.width);M.KB.height=this.xwc(R.height);M.N1()}xwc(R){var M=this.HC.WA;M=Object(m.b)(this.zoomManager)&&M===this.editBox;return w.HelperMethods.qc(M?this.zoomManager.ni(R):R)}}Object(t.a)(z,"FormulaAssistanceValuePreviewControl",null,[3]);var B=a(113);class y{constructor(R){this.cache=
R}clearCache(){this.cache=void 0}}Object(t.a)(y,"Cacheable",null,[]);class A extends y{constructor(R,M){super();this.$=R;this.callbacks=M;this.vlc=(L,U)=>{const X=this.gridView.Qi;if(!(0<(X.$a?X.textBox.selection:{index:0,length:0}).length))switch(U.state){case 0:this.bzd(L,U.event);break;case 1:this.RLi(L);break;default:return n.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),U}};this.ulc=(L,U)=>{var X;this.clearCache();U=null!==(X=U.selection)&&
void 0!==X?X:L.textBox.selection;if(0<U.length)this.onSelectionChange(L,U);else this.nBf(L)};this.gridView=Object(v.g)(this.$);this.editBox=this.gridView.dc;this.formulaBar=Object(B.a)(this.$);this.Bj()}dispose(){this.ek()}Bj(){this.editBox.vTc(this.vlc);this.formulaBar.vTc(this.vlc);this.editBox.Gle(this.ulc);this.formulaBar.Gle(this.ulc)}ek(){this.editBox.UHd(this.vlc);this.formulaBar.UHd(this.vlc);this.editBox.YOf(this.ulc);this.formulaBar.YOf(this.ulc)}bzd(R,M){M=new Sys.UI.Point(M.clientX,M.clientY);
M=c(M,R.textBox.Se);if(-1!==M)this.onSelectionChange(R,{index:M,length:0})}RLi(R){this.nBf(R)}onSelectionChange(R,M){this.fwj(M)&&(this.cache=M,this.callbacks.fAd(R,M))}nBf(R){this.clearCache();this.callbacks.INa(R)}fwj(R){var M;(M=!this.cache)||(M=this.cache,M=!(M.index===R.index&&M.length===R.length));return M}}Object(t.a)(A,"FormulaAssistanceValuePreviewHandler",y,[3]);var K=a(42),G=a(62);class T{constructor(R,M){this.$=R;this.pluginScheduler=M;this.Uab=new P(f);this.PWf=new P(f);this.CQi=(L,U)=>
X=>{if(Object(m.c)(X.Result))U("No result");else if(X=JSON.parse(X.Result),Object(m.c)(X))U("Failed to deserialize");else if(1!==Object.keys(X).length)U("Invalid response");else{for(let fa in X)var da=X[fa];L(da)}};this.BQi=L=>()=>{L("Request failed")};this.gridView=Object(v.g)(this.$)}clearCache(){this.Uab.clear();this.PWf.clear()}request(R){return Object(l.a)(this,void 0,void 0,function*(){return d(this.Uab,R,()=>Object(l.a)(this,void 0,void 0,function*(){const {kind:M,payload:L}=yield this.pluginScheduler.getRequester().valuePreview(R,
0);if(0!==M)return null;if(Object(m.c)(L))return{kind:0};switch(L.kind){case 0:return{kind:0};case 1:case 2:return Object.assign({},L);case 3:const U={text:R.text,start:L.start,length:L.length};return this.Uab.has(U)?yield this.Uab.get(U):Object.assign(Object.assign({},L),{kind:3,next:()=>this.zej(U,R,L.text)})}}))})}zej(R,M,L){return Object(l.a)(this,void 0,void 0,function*(){return d(this.PWf,R,()=>{const U=new Promise(X=>Object(l.a)(this,void 0,void 0,function*(){try{const da=yield this.HSh(L);
X({kind:1,text:da,start:R.start,length:R.length})}catch(da){n.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${da}`),X({kind:0})}}));U.then(()=>{this.Uab.set(R,U);this.Uab.set(M,U)}).catch(X=>{n.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${X}`)});return U})})}HSh(R){return Object(l.a)(this,void 0,void 0,function*(){return new Promise((M,L)=>{const U={Formula:R,
PartialFormula:R,SourceRange:Object(K.v)(this.gridView.ha.sa.activeCell,this.$)};W(this.$.pa.va,U,this.CQi(M,L),this.BQi(L),null,null)})})}}Object(t.a)(T,"FormulaAssistanceValuePreviewRequester",null,[]);const W=(R,M,L,U,X,da,fa=null)=>{fa=R.Na(1,fa);fa.getPartialCalcResultsParameters=M;return Object(G.g)(R,"GetPartialCalcResults",fa,L,U,X,da,4)};class P{constructor(R){this.FUd=R;this.map=new Map}has(R){R=this.FUd(R);return this.map.has(R)}get(R){R=this.FUd(R);return this.map.get(R)}set(R,M){R=this.FUd(R);
this.map.set(R,M);return this}clear(){this.map.clear()}}Object(t.a)(P,"RequestMap",null,[]);class E{constructor(R,M,L){this.$=R;this.fAd=(U,X)=>Object(l.a)(this,void 0,void 0,function*(){const da={text:U.text,start:X.index,length:X.length};void this.wIf(da,this.requester.request.bind(this.requester),U,0===da.length)});this.INa=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.iy=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=
Object(v.g)(this.$);this.control=new z(this.$,L);this.requester=new T(this.$,M);this.handler=new A(this.$,{fAd:this.fAd,INa:this.INa});this.Bj()}dispose(){this.ek();this.handler.dispose();this.control.dispose()}Bj(){this.gridView.Wb.jm(this.reset);this.gridView.ha.aga(this.reset);this.$.ea.kE(this.iy)}ek(){this.gridView.Wb.Al(this.reset);this.gridView.ha.dma(this.reset);this.$.ea.CD(this.iy)}wIf(R,M,L,U){return Object(l.a)(this,void 0,void 0,function*(){const X=Object.assign(Object.assign({},R),{WA:L,
JPd:U});this.lHa=X;const da=yield M(R);Object(m.c)(da)||this.Cki(X)&&void this.T2h(da)})}T2h(R){return Object(l.a)(this,void 0,void 0,function*(){const M=this.lHa.text,L=this.lHa.WA,U=this.lHa.JPd;switch(R.kind){case 0:this.hide();break;case 1:case 2:this.show(L,R,U);break;case 3:if(!this.Wmi(R))break;this.show(L,R,U);void this.wIf({text:M,start:R.start,length:R.length},R.next,L,U);break;default:return R}})}show(R,M,L){this.control.show(R,M,L);this.lHa=void 0;this.Jqb=M}hide(){this.control.hide();
this.Jqb=this.lHa=void 0}Cki(R){var M;if(M=this.lHa)M=this.lHa,M=M.text===R.text&&M.start===R.start&&M.length===R.length&&M.WA===R.WA&&M.JPd===R.JPd;return M}Wmi(R){return!this.Jqb||this.Jqb.start!==R.start||this.Jqb.length!==R.length||3===this.Jqb.kind}}Object(t.a)(E,"FormulaAssistanceValuePreview",null,[369,3]);var H=a(50),F=a(37);class N extends k.a{constructor(R){super();this.$=R;this.Fb()}static ka(R){R.da.Ga(497,new N(R))}create(){let R=this.$.da.za(496);R&&this.qb(R);const M=H.GetServiceTaskFactory.Ta(this.$.da,
413,414,this.ib),L=H.GetServiceTaskFactory.Ta(this.$.da,448,449,this.ib),U=H.GetServiceTaskFactory.Ta(this.$.da,19,153,this.ib);F.TaskExtensions.Aa(F.TaskExtensions.Xd([M,L,U],this.la),()=>{R=this.$.da.za(496);R||(R=new E(this.$,M.result,L.result),this.$.da.Ga(496,R));this.qb(R)},this.la,3)}}Object(t.a)(N,"FormulaAssistanceValuePreviewFactory",k.a,[]);a.d(D,"a",function(){return J});const J=()=>{e.a.Fa(R=>{N.ka(R)})}},1189:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(184);const f={average:0,
max:0,median:0,P75:0,P95:0},e={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},k={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},l={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,
argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},v={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},n={count:0,countAboveThresholds:void 0,
failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},w={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0};var r=a(58),u=a(109),x=a(28),z=a(1);class B{constructor(N){this.dpf=N;this.g_=Object.assign({},n);this.K5b=[];this.njc=-1;(this.cpf=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
N&&(this.g_.countAboveThresholds={},N.forEach(J=>this.g_.countAboveThresholds[J]=0))}URa(){this.njc=x.a.Wa.je.m}Jha(N){-1!==this.njc&&(N?(this.$lb(x.a.Wa.je.m-this.njc),this.njc=-1):this.g_.failedCount++)}Zyh(){this.g_.excludingFirstAction=B.pRe(this.K5b);this.K5b.push(this.g_.firstAction);this.g_.includingFirstAction=B.pRe(this.K5b)}$lb(N){this.g_.count?1E3>this.g_.count&&this.K5b.push(N):this.g_.firstAction=N;this.cpf&&this.dpf&&this.dpf.forEach(J=>{N>J&&this.g_.countAboveThresholds[J]++});this.g_.count++}static pRe(N){const J=
Object.assign({},f);0<N.length&&(u.i(N),J.median=N[Math.floor(.5*N.length)],J.P75=N[Math.floor(.75*N.length)],J.P95=N[Math.floor(.95*N.length)],J.max=N[N.length-1],J.average=u.g(N,R=>R)/N.length);return J}}Object(t.a)(B,"PerformanceMeasurement",null,[]);var y=a(22),A=a(41),K=a(21),G=a(99),T;(function(N){N[N.function=3]="function";N[N.namedRange=100]="namedRange";N[N.tableHeader=101]="tableHeader";N[N.letVariable=102]="letVariable";N[N.richEntity=103]="richEntity";N[N.lambda=104]="lambda";N[N.customFunction=
105]="customFunction";N[N.table=106]="table";N[N.tableSpecialStructRef=107]="tableSpecialStructRef";N[N.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(T||(T={}));Object(t.b)("CompletionItemKind",T);var W=a(36);const P={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200]};class E{constructor(N){this.$=N;this.NH=null;this.AAb=-1;this.Mhc=null;this.Nhc=0;this.l9=Object.assign({},l);this.BM=Object.assign({},m);this.LX=Object.assign({},
e);this.Gnb=Object.assign({},k);this.eda=Object.assign({},w);this.Hnb={};this.t2a=Object.assign(Object.assign({},v),{isReactDialog:W.a.xnd()});this.Jf=(J,R)=>{null!=this.NH&&(1==Math.abs(this.AAb-this.$.ea.Le)&&(J=this.$.xa.oa.sheetId,R.Cpb&&R.Bk.equals(this.NH.Bk)&&this.Mhc===J&&this.NH.Nob!==R.Nob&&this.Nhc++),1<=Math.abs(this.AAb-this.$.ea.Le)&&(this.NH=null,this.AAb=-1,this.Mhc=null))};this.Dc=()=>{this.nsj();this.L8&&this.xsj();this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging())};
this.L8=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.a$a=new G.a;N.ik(this.Dc);this.L8&&K.g(this.$).Qi.jm(this.Jf)}dispose(){this.$&&this.L8&&K.g(this.$).Qi.Al(this.Jf)}gO(N){N.forEach(J=>{this.a$a.lb(J)||this.a$a.ia(J,new B(P[J]));this.a$a.na(J).URa()})}RP(N,J=!0){N.forEach(R=>{this.a$a.lb(R)&&this.a$a.na(R).Jha(J)})}hXf(N){let J="Undefined";switch(N){case 1:J="Collapsed";break;case 0:J="Expanded";break;case 2:J="Hidden"}this.l9.argumentAssistanceCardInitialMode=
J}bIa(N){window.requestAnimationFrame(()=>{this.RP([N])})}D8e(N){N.forEach(J=>{J=T[J.kind];this.Deg(J);this.Hnb[J].shownCounter++})}C8e(N){N=T[N];this.Deg(N);this.Hnb[N].committedCounter++}getJsonForLogging(){return"{"+this.DT("SessionDetails",this.eda)+","+this.DT("ArgumentAssistanceUsage",this.l9)+","+this.DT("FormulaSuggestionsUsage",this.BM)+","+this.DT("FunctionDialogUsage",this.t2a)+","+this.DT("AutocompleteCardInteraction",this.LX)+","+this.DT("AutocompleteRenderOptimization",this.Gnb)+","+
this.DT("AutocompleteUsageByKind",this.Hnb)+","+this.XVh()+"}"}xsj(){this.BM.smartSuggestionKeptCounter=this.BM.smartSuggestionCommittedCounter-this.Nhc}nsj(){this.eda.argumentAssistanceFlight=this.e3a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.eda.autoCompleteUIFlight=this.e3a("Microsoft.Office.Excel.","AutoCompleteNewUI");this.eda.smartFormulaBarAutoCompleteFlight=this.e3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.eda.smartFormulaBarAutoCompletePluginFlight=
this.e3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.eda.formulaAssistanceRedesignFlight=this.e3a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.eda.NewInsertFunctionDialogFlight=this.e3a("Microsoft.Office.Excel.","NewInsertFunctionDialog")}XVh(){const N=new d.a;for(let J of this.a$a)J.value.Zyh(),N.add(`"${J.key}":${r.a.Ac(J.value.g_)}`);return`"PerfMeasurements": {${N.toArray().join(",")}}`}e3a(N,J){return y.a.contains(this.$.ya.FlightHolder.FlightId,J,!0)?
z.EwaSettings.getBooleanFeatureGate(N+J,!1)?"T":"C":"None"}DT(N,J){return`"${N.toString()}":${A.c(J)}`}Deg(N){this.Hnb[N]||(this.Hnb[N]={shownCounter:0,committedCounter:0})}}Object(t.a)(E,"FormulaAssistanceTelemetryManager",null,[381]);class H extends b.a{constructor(N){super();this.$=N;this.Fb()}static ka(N){N.da.Ga(492,new H(N))}create(){var N;this.qb(null!==(N=this.$.da.za(491))&&void 0!==N?N:this.$.da.Ga(491,new E(this.$)))}}Object(t.a)(H,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(D,
"a",function(){return F});const F=()=>{c.a.Fa(N=>{H.ka(N)})}},1208:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(275),d=a(91),f=a(39),e=a(262),k=a(543),l=a(4),m=a(84),v=a(412),n=a(713),w=a(8),r=a(30),u=a(19),x=a(60),z=a(5),B=a(784),y=a(1040),A=a(834),K=a(14),G=a(36);class T{constructor(Mb,Oa,Aa,Ba,ob,xb,Va,bb){this.$=Oa;this.Sa=Aa;this.kl=Ba;this.selectedRanges=ob;this.grid=xb;this.wy=bb;this.U3=Va;this.iga=e.a.all(ob,ra=>ra.isRow);this.lra=e.a.all(ob,ra=>ra.Ze);this.CCb=e.a.all(ob,ra=>!ra.isRow&&
!ra.Ze);Oa=xb.Db.dfd(ob);this.pqb=!!Oa;this.FQf=!!Oa&&Oa.hasActiveFilter;this.menuSection=Aa.Bc();Mb.pc.push(this.menuSection);this.Baa=this.iga||this.lra?this.menuSection:Aa.Bc();this.Ysa=this.iga||this.lra?this.menuSection:Aa.Bc()}Ead(){this.xEh();this.aEh();const Mb=this.wy.q6a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Sa.pb(Mb?149:148))}DEh(){let Mb=0;this.pqb?this.U3.om(942362098)?Mb=this.wy.om(this.kl,942362098,this.selectedRanges,this.grid)?161:169:this.FQf&&(Mb=this.wy.om(this.kl,
-1113896058,this.selectedRanges,this.grid)?177:181):this.U3.om(-1113896058)&&(Mb=this.iga?this.wy.om(this.kl,-1113896058,this.selectedRanges,this.grid)?49:116:this.wy.om(this.kl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Mb&&this.Baa.buttons.push(this.Sa.pb(Mb))}CEh(){let Mb;!this.pqb&&this.U3.om(-1113896058)&&(Mb=this.iga?this.wy.om(this.kl,-1113896058,this.selectedRanges,this.grid)?295:296:this.wy.om(this.kl,-1113896058,this.selectedRanges,this.grid)?297:298,this.Baa.buttons.push(this.Sa.pb(Mb)))}yEh(){let Mb=
0;this.pqb?this.U3.om(622604322)&&(Mb=this.grid.rtl?this.wy.om(this.kl,622604322,this.selectedRanges,this.grid)?191:192:this.wy.om(this.kl,622604322,this.selectedRanges,this.grid)?162:170):this.U3.om(1415868706)&&(Mb=this.lra?this.wy.om(this.kl,1415868706,this.selectedRanges,this.grid)?50:117:this.wy.om(this.kl,1415868706,this.selectedRanges,this.grid)?178:182);0!==Mb&&this.Baa.buttons.push(this.Sa.pb(Mb))}wEh(){this.U3.om(1035996630)&&(this.wy.om(this.kl,1035996630,this.selectedRanges,this.grid)?
(this.Baa.buttons.push(this.Sa.pb(this.grid.rtl?187:165)),this.Baa.buttons.push(this.Sa.pb(166))):(this.Baa.buttons.push(this.Sa.pb(this.grid.rtl?188:173)),this.Baa.buttons.push(this.Sa.pb(174))))}xEh(){const {GridContextMenu:Mb}=a(1208);let Oa=null;this.CCb&&(Oa=this.Sa.Su("ContextMenu.InsertCells",null,K.a.instance.ga(350),1896159024),Oa.menu.pc.push(this.Baa));Mb.zEh(this.Baa,this.Sa,this.$);this.DEh();l.AFrameworkApplication.zF("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");
G.a.Vmd()&&this.CEh();this.yEh();this.wEh();Oa&&0<this.Baa.buttons.length&&this.menuSection.buttons.push(Oa)}cEh(){let Mb=0;this.pqb?this.U3.om(1405456548)?Mb=this.wy.om(this.kl,1405456548,this.selectedRanges,this.grid)?163:171:this.FQf&&(Mb=this.wy.om(this.kl,1554436520,this.selectedRanges,this.grid)?179:183):this.U3.om(1554436520)&&(Mb=this.iga?this.wy.om(this.kl,1554436520,this.selectedRanges,this.grid)?51:118:this.wy.om(this.kl,1554436520,this.selectedRanges,this.grid)?179:183);0!==Mb&&this.Ysa.buttons.push(this.Sa.pb(Mb))}bEh(){let Mb=
0;this.pqb?this.U3.om(284490184)&&(Mb=this.wy.om(this.kl,284490184,this.selectedRanges,this.grid)?164:172):this.U3.om(674605324)&&(Mb=this.lra?this.wy.om(this.kl,674605324,this.selectedRanges,this.grid)?52:119:this.wy.om(this.kl,674605324,this.selectedRanges,this.grid)?180:184);0!==Mb&&this.Ysa.buttons.push(this.Sa.pb(Mb))}$Dh(){this.U3.om(1035996630)&&(this.wy.om(this.kl,1035996630,this.selectedRanges,this.grid)?(this.Ysa.buttons.push(this.Sa.pb(this.grid.rtl?189:167)),this.Ysa.buttons.push(this.Sa.pb(168))):
(this.Ysa.buttons.push(this.Sa.pb(this.grid.rtl?190:175)),this.Ysa.buttons.push(this.Sa.pb(176))))}aEh(){let Mb=null;this.CCb&&(Mb=this.Sa.Su("ContextMenu.DeleteCells",null,K.a.instance.ga(414),-1554384558),Mb.menu.pc.push(this.Ysa));this.cEh();this.bEh();this.$Dh();Mb&&0<this.Ysa.buttons.length&&this.menuSection.buttons.push(Mb)}}Object(t.a)(T,"CellsContextMenuGenerator",null,[]);class W{constructor(Mb){this.ranges=null;this.ranges=Mb}}Object(t.a)(W,"MacroRecorderRangeHyperlinkRemovedPayload",null,
[116]);var P=a(520),E=a(24),H=a(102),F=a(77),N=a(75),J=a(42),R=a(170),M=a(62),L=a(600),U=a(145),X=a(37),da=a(452),fa=a(552),S=a(1),ka=a(181),V=a(21),wa=a(369),ma=a(33),ab=a(50),ba=a(239),Ca=a(22),Na=a(29),za=a(1066),la=a(902),aa=a(131),sa=a(510),ea=a(368),Z=a(247),ua=a(162),ya=a(153),ha=a(340),Da=a(90),nb=a(31),qa=a(281),pa=a(280),Ja=a(132),$a=a(767),rb=a(768),Pa=a(111),eb=a(41),Ob=a(55),tb;(function(Mb){Mb[Mb.none=0]="none";Mb[Mb.once=1]="once";Mb[Mb.twice=2]="twice"})(tb||(tb={}));Object(t.b)("ToggleState",
tb);class cc{constructor(Mb,Oa,Aa,Ba){this.WUc=this.Kdb=this.Mdb=0;this.$=Mb;this.gridView=V.g(this.$);this.namedSheetViewPublic=Oa;this.ug=Aa;this.instantaneousSupportInformationManager=Ba;this.ILa=$a.a.Skd()}bgh(){var Mb=this.yU();Mb={["CommandValueId"]:eb.c(Mb)};const Oa=new Da.a(-2058042992,2,this.$.Mc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Lb(Oa,Mb)}rgh(){const Mb=new Da.a(644342024,2,this.$.Mc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Lb(Mb)}ggh(){const Mb=this.gridView.ha.sa.activeCell,Oa=this.$.da.za(66).Jg,Aa=this.$.da.za(66).Mtb(Mb);return Oa||Aa?this.igh(Oa,Aa,Mb):this.hgh(Mb)}igh(Mb,Oa,Aa){if(this.JVg(Mb,Oa,Aa))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Ob.Task.Ua(!1);if(null!=
Mb&&Mb.hasAutoFilter||null!=Oa&&Oa.wZa.every(Ba=>0!=Ba.length))return this.Mdb=tb.none,this.UUc();this.Mdb=tb.once;return this.r5b(tb.once)}hgh(Mb){var Oa=J.v(this.gridView.ha.sa.Wc,this.$);Oa=this.gridView.$.xa.getItemByName(Oa.SheetName);const Aa=J.D(Oa.W_);if(this.IVg(Aa,Mb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Ob.Task.Ua(!1);if(Oa.hasAutoFilter){if(Aa&&Aa.contains(this.gridView.ha.sa.activeCell))return this.Mdb=
tb.none,this.UUc();this.Mdb=tb.twice;return this.r5b(tb.twice)}this.Mdb=tb.once;return this.r5b(tb.once)}r5b(Mb){const Oa=J.v(this.gridView.ha.sa.Wc,this.$);if(!Oa)return Ob.Task.Ua(!1);this.Kdb||(this.Kdb=Date.now());const Aa=new Da.a(368460465,2,this.$.Mc,19,null),Ba=this.$.pa.va.Qb(),ob=()=>new za.a(Oa),xb=Va=>{qa.a(Va)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
Mb===tb.twice?this.r5b(tb.once):this.UUc())};return S.EwaSettings.fc()?ea.a(this.$.userOperationManager,(Va,bb,ra)=>Z.A(this.$.pa.va,Oa,pa.b(Va,xb),bb,ra,null,Ba),Va=>new R.a(516,0,Va,64,ob),Aa):ea.a(this.$.userOperationManager,(Va,bb,ra)=>Z.A(this.$.pa.va,Oa,pa.b(Va,xb),bb,ra,null,Ba),Va=>new sa.a(516,0,Va,void 0,ob),Aa)}JVg(Mb,Oa,Aa){return null!=Mb&&ua.d(Mb)&&Aa.top===Mb.usedRange.top||null!=Oa&&Oa.qaa&&Aa.top===Oa.top?(this.ppc(this.$,225),!0):null!=Mb&&ua.g(Mb)&&Aa.top===Mb.usedRange.bottom?
(this.ppc(this.$,226),!0):!1}IVg(Mb,Oa){if(Mb&&Mb.contains(Oa)&&Oa.top===Mb.top||!Mb&&this.NUg(Oa.top,Oa.left))return this.ppc(this.$,227),!0;Mb=new E.Range(Oa.top,Oa.left,Oa.top+1,Oa.left+1,!1,!1);return this.gridView.Db.qwa(Mb)?(this.ppc(this.$,228),!0):!1}ppc(Mb,Oa){Oa=nb.a.Yc(1,1,756,Oa,0,147079615,"ContextMenuFilterByCellValueError");S.EwaSettings.xz()?new ha.a(Mb,Oa):(Mb=new ya.ErrorDialog(Mb,Oa),Mb.initialize(),Mb.xf())}UUc(){this.WUc=Date.now();const Mb=this.CZh();if(!Mb)return c.ULS.sendTraceTag(527500296,
0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Ob.Task.Ua(!1);const Oa=this.yU(),Aa={FirstRow:0};Aa.FirstColumn=Oa.Column;Aa.SheetName=Oa.SheetName;Ja.b(this.$).Cd(aa.a.Tsf,this.nm(),void 0,!0);const Ba=this.G1c(Oa,Aa),ob=Va=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Mdb,["ApplyFilterTime"]:this.WUc?Date.now()-this.WUc:-1,["ToggleAndApplyFilterTime"]:this.Kdb?
Date.now()-this.Kdb:-1,["FilterByValueType"]:Oa.AutoFilterType})}`);this.Kdb&&(this.Kdb=0);if($a.a.Hvc(Va)){const bb=$a.a.t9b(Va);this.ILa?$a.a.DPa(rb.a.filterByCellValue,bb.MessageIdName,Pa.a.Ara,!0,$a.a.isSessionEndingError(bb.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${bb.MessageIdName}`)}qa.a(Va)?(Va=nb.a.zc(Va.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Va}`)):
(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Ja.b(this.$).Cd(aa.a.uwf,this.nm(),void 0,!0),Va={},Va.FirstRow=this.hNh(),Va.FirstColumn=Oa.Column,-1!==Va.FirstRow&&(Va=J.C(Va),this.sL(Va)))},xb=new R.a(208,0,(Va,bb,ra)=>M.a(this.$.pa.va,Ba,Mb,pa.b(Va,ob),bb,ra,null,null),6,()=>new la.a(Mb,Ba));this.namedSheetViewPublic?this.namedSheetViewPublic.aAa().continueWith(Va=>{Va.result&&this.$.userOperationManager.Ub(xb,null)}):this.$.userOperationManager.Ub(xb,
null);return Ob.Task.Ua(!0)}sL(Mb){G.a.Yaa(this.$)&&X.TaskExtensions.Aa(ab.GetServiceTaskFactory.Ta(this.$.da,430,431,1),Oa=>{Oa.result.b7(Mb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)}nm(){return{["Location"]:"contextMenu"}}yU(){var Mb=0,Oa=this.gridView.ha.sa.activeCell;var Aa=this.$.da.za(66).Jg;const Ba=this.$.da.za(66).Mtb(Oa);if(Aa){var ob="Table";Mb=Aa.objectId}else Ba?(ob="Table",
Mb=Ba.id):ob="Sheet";Aa=Oa.left;Oa={};Oa.AutoFilterType=ob;Oa.Column=Aa;Oa.Id=Mb;ob={};this.$.Wj(ob);ob.FirstRow=0;ob.FirstColumn=Oa.Column;Mb=this.$.ea.isNamedObjectViewMode;Oa.NamedObjectView=Mb;Oa.SheetName=Mb?ob.NamedObjectName:ob.SheetName;Oa.ItemListOptions=null;return Oa}NUg(Mb,Oa){Mb=E.Range.Tc(Mb,Oa);return this.gridView.Ea.t9(Mb,this.$.oa.name)&&(Mb=this.gridView.Ea.CJa(Mb))&&Mb.autoFilterMenu?!0:!1}CZh(){var Mb=null;const Oa=this.gridView.Xb(this.gridView.ha.sa.activeCell);if(!Oa)return null;
const Aa=Oa.cell.Vwc;let Ba;({category:Ba}=this.instantaneousSupportInformationManager.PAa(Aa,!1));if(1===Oa.Cy.type)if(3===Ba){if(!Oa.cell.zNa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${Ba}. NumFmt is null. `),null;Mb=(Oa.cell.zNa.Start+Oa.cell.zNa.End).trim()}else if(!Ba&&(Ca.a.I_a(Oa.Cy.value,"E")||Ca.a.I_a(Oa.originalText,"E"))){Mb=this.ug.kTe(Oa.Cy.value,Aa,1,Number.POSITIVE_INFINITY,Oa.cell.oha);if(!Mb.success)return c.ULS.sendTraceTag(527500289,
0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${Ba}. Failed to acquire formatted value`),null;Mb=Mb.Px}Mb||(Mb=Oa.originalText);return Na.a.vZc(Mb)?["[Blanks]"]:["i"+Mb.trim()]}hNh(){const Mb=this.gridView.ha.sa.activeCell;var Oa=this.$.da.za(66).Jg;const Aa=this.$.da.za(66).Mtb(Mb);if(Oa)return Oa.usedRange.top;if(null!=Aa)return Aa.top;Oa=this.$.xa.getItemByName(this.$.oa.sheetName);return(Oa=J.D(Oa.W_))&&Oa.contains(Mb)?Oa.top:-1}G1c(Mb,Oa){const Aa={};Aa.Location=Oa;Aa.FieldId=
Mb.Id.toString();Aa.DataSourceIndex=-1;Aa.FilterType=Mb.AutoFilterType;Aa.AnchorType=0;Aa.ChartId=null;Aa.AnchorValue1=-1;Aa.AnchorValue2=-1;Aa.Property=Mb.RichProperty;return Aa}}Object(t.a)(cc,"GridContextMenuFilter",null,[]);a.d(D,"GridContextMenu",function(){return Ib});class Ib extends n.a{constructor(Mb,Oa,Aa,Ba){super(Mb,"PopulateGridContextMenu",1247109494,-2064931494,Ib.k0h,!0,!1,Ib.uIb,Oa,Aa,!0,Ba);this.Egc=this.expandCollapse=this.refresh=this.xY=this.qva=this.Zza=!1;this.JCe=!0;this.grid=
V.g(Mb);this.pjc=!0;if(this.eec=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const ob=ab.GetServiceTaskFactory.Ta(this.$.da,309,310,3),xb=ab.GetServiceTaskFactory.create(this.$.da,18,this.la,3);X.TaskExtensions.Aa(X.TaskExtensions.Xd([ob,xb],this.la),()=>{this.$.da.Za(268,Va=>{this.T3a=new cc(Mb,ob.result,xb.result,Va)})},this.la,3)}}get Fw(){return"PopulateGridContextMenu"}get CB(){return z.a.LKf}dispose(){super.dispose();this.grid=null}Qc(Mb,Oa){Mb=
!this.Cod(Mb,Oa);if(!Mb)switch(Oa){case -1977666927:Mb=null==this.T3a||this.Fvj();break;case 1549396389:Mb=null==this.T3a||!this.uei();break;case 2045563128:case 1803952894:Mb=null==this.T3a||!this.$.isEditMode&&!this.vei()}return Mb}Cod(Mb,Oa){const Aa=this.grid.ha.sa.selectedRanges;return(new U.a(this.$.xa)).om(Mb,Oa,Aa,this.grid)}executeCommand(Mb,Oa,Aa){const Ba=Oa.command;Mb=null;switch(Ba){case -1396319072:if(Oa=this.grid.Xb(null))b.a.instance.iYc(!0),d.EventHandlerManager.instance.P$c(),Ib.LTi(Oa);
break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,Oa);break;case 324156914:Mb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Aa);break;case -1977666927:Mb=this.T3a.bgh();break;case 1549396389:Mb=this.T3a.rgh();break;case 1803952894:Mb=this.T3a.ggh();break;default:Mb=ka.a(Ba)}return Mb||X.TaskExtensions.kaa()}Ec(Mb,Oa,Aa){Mb=!1;switch(Oa.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Mb=
!0;break;case 1441131127:Mb=!!Aa}return Mb}fY(Mb=!1){let Oa=!1,Aa=!1,Ba=0;S.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ba=f.a.Sd());const ob=this.Sa.pq(this.menuId);var xb=this.grid.ha.sa;const Va=xb.xg,bb=Va&&xb.Wc.Ze,ra=Va&&xb.Wc.isRow;xb=xb.selectedRanges;const Qa=e.a.all(xb,ib=>ib.Ze),qb=e.a.all(xb,ib=>ib.isRow),Wa=J.O(xb),ta=J.P(xb);this.yef(bb,ra)?(Oa=!0,this.gFh(ob)):this.$.isEditMode?wa.a(this.$)?this.hFh(ob,bb,ra):(this.dEh(ob,!(ra||bb||
!this.Egc)),this.AEh(ob,xb,Mb),this.UDh(ob),this.pEh(ob,Qa,qb,Wa,ta),this.yUe(ob,Va,bb,ra),this.zFh(ob),this.dUe(ob,bb,ra),this.XEh(ob,Va,bb,ra,xb),this.gEh(ob),this.eEh(ob,xb),this.IEh(ob),this.uFh(ob,Va),S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.uEh(ob)):(Aa=!0,wa.a(this.$)?this.tUe(ob):this.PFh(ob,Va,bb,ra,xb));S.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Mb=f.a.Sd()-Ba,c.ULS.sendTraceTag(537167046,
0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Mb}, isPivotMenu: ${Oa}, isViewMenu: ${Aa}, firstTimeEntry: ${this.JCe}`));this.JCe=!1;return ob}rJa(Mb){const Oa=[];if(wa.a(this.$))return Oa;if(3===Mb){Mb=this.grid.ha.sa;const Ba=Mb.xg,ob=Ba&&Mb.Wc.Ze,xb=Ba&&Mb.Wc.isRow;let Va=!1;var Aa=!1;let bb=!1;this.$.isMobileMode&&(Aa=Mb.selectedRanges,Va=J.O(Aa),Aa=J.P(Aa));if(Ba){const ra=V.e(this.grid);ra&&ra.range.contains(Mb.Wc)&&this.UU(ra)&&(bb=!0)}this.$.isEditMode?this.yef(ob,xb)?Oa.push(...[A.a.JFf,
A.a.LFf]):ob||xb?(Oa.push(A.a.clipboard),xb?Oa.push(A.a.Ohj):ob&&Oa.push(A.a.fZg)):(Oa.push(...[A.a.edit,A.a.clipboard]),bb?Oa.push(A.a.hyperlink):Oa.push(A.a.color),Ba&&Oa.push(A.a.kMg)):(Oa.push(A.a.copy),bb&&Oa.push(A.a.openHyperlink),!xb||this.$.isMobileMode&&Aa?!ob||this.$.isMobileMode&&Va||Oa.push(A.a.GVj):Oa.push(A.a.HVj));Oa.push(A.a.b0h)}else 2===Mb&&Oa.push(A.a.Uve);return Oa}yef(Mb,Oa){return(this.Zza||this.qva||this.xY||this.refresh||this.expandCollapse)&&!(Mb||Oa)}showGridContextMenu(Mb){this.expandCollapse=
this.refresh=this.xY=this.qva=this.Zza=!1;var Oa=this.$,Aa=da.a(Oa).GJa(),Ba=this.grid.ha.sa;const ob=Ba.xg;var xb=ob&&Ba.Wc.Ze;Ba=ob&&Ba.Wc.isRow;if(Aa&&!xb&&!Ba){xb=fa.a(Oa);if(null===xb||void 0===xb?0:xb.APd)this.Zza=xb=H.f(Oa.pg),this.qva=!xb;xb=Oa.jc;this.xY=Aa.supportsBIExplore&&!!B.a(Oa)&&xb.O1(32768);xb.allowInteractivity&&(Oa=this.grid.Xb(null),(null===Oa||void 0===Oa?0:Oa.cell)&&(Oa.cell.YXc||Oa.cell.s1f)&&(this.expandCollapse=!0),xb.allowManualDataRefresh&&(this.refresh=!0))}Oa=null;Aa=
1;xb=Object(m.a)(k.a,Mb.eventArgs);Mb=Object(m.a)(y.a,Mb.creationParams);Ba=this.lKh();Mb?(Oa=Mb.clientPoint,Aa=Mb.inputMethod):xb&&1!==xb.tb?(Oa=new Sys.UI.Point(xb.clientPoint.x,xb.clientPoint.y),Aa=xb.tb):Ba&&(Oa=new Sys.UI.Point(Ba.x+(this.$.isChromeRtl?0:Ba.width),Ba.y+Ba.height));F.a.Eb=Aa;this.Egc=3===Aa;Mb=r.a.xsb;this.xp(Oa,!xb||xb.Ca.target.className!==Mb,Aa)}removeHyperlinksFromRange(Mb,Oa){if(!S.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.oq(Mb,!0)){var Aa=J.r(Mb,this.$),Ba=this.$.pa.va.Qb();this.$.userOperationManager.Ub(new R.a(125,0,(ob,xb,Va)=>{this.$.sy();return M.b(this.$.pa.va,Aa,"","",!0,!1,127,ob,xb,Va,null,Ba)},void 0,()=>new W(Aa)),Oa);this.grid.Cf.UG(!1)}}lKh(){var Mb=this.grid.Xb(null);if((null===Mb||void 0===Mb?0:Mb.cell.Ck)&&this.Idf(Mb))return this.grid.getCellBounds(Mb.cell);Mb=this.grid.ha.sa.activeCell;return(Mb=this.b8b(new E.Range(Mb.top,Mb.left,w.a.mh,Mb.left,!1,!1),2,!0)||this.b8b(new E.Range(1,Mb.left,
Mb.top,Mb.left,!1,!1),2,!1)||this.b8b(new E.Range(Mb.top,Mb.right,Mb.top,w.a.Ch,!1,!1),1,!0)||this.b8b(new E.Range(Mb.top,1,Mb.top,Mb.right,!1,!1),1,!1)||null)&&Mb.Ck?this.grid.getCellBounds(Mb):Sys.UI.DomElement.getBounds(this.grid.kva.lc)}Idf(Mb){var Oa=this.grid.rtl,Aa=this.$.isChromeRtl;Mb=Mb.cell;var Ba=V.g(this.$).SJ(Mb);return Ba?(Ba=Ba.topLeft,Oa=Ba.x+=Oa===Aa?Mb.offsetWidth:0,Aa=Ba.y+=Mb.offsetHeight,this.grid.view.visibleArea.contains(new x.a(Oa,Aa,0,0))):!1}b8b(Mb,Oa,Aa){Mb=this.grid.kk("GridContextMenu.FindFirstCellInViewportArea",
Mb,Oa,Aa);try{for(Mb.$$rst();Mb.$$mn();){const Ba=Mb.$$cu();if(Ba&&this.Idf(Ba))return Ba.cell}}finally{Mb&&Mb.dispose()}return null}gFh(Mb){const Oa=this.Sa,Aa=Oa.Bc();this.refresh&&Aa.buttons.push(Oa.pb(100));this.xY&&Aa.buttons.push(Oa.pb(99));this.Zza?Aa.buttons.push(Oa.pb(59)):this.qva&&Aa.buttons.push(Oa.pb(58));if(this.expandCollapse){let Ba;Ba=Oa.Su("ContextMenu.PivotExpandCollapse",null,K.a.instance.ga(1161),589118293);const ob=Oa.Bc();ob.buttons.push(Oa.pb(243));ob.buttons.push(Oa.pb(244));
ob.buttons.push(Oa.pb(245));ob.buttons.push(Oa.pb(246));Ba.menu.pc.push(ob);Ba&&0<ob.buttons.length&&Aa.buttons.push(Ba)}Mb.pc.push(Aa)}yUe(Mb,Oa,Aa,Ba){if(Oa&&!Aa&&!Ba){Oa=this.Sa.Bc();this.eec&&!this.$.jK&&this.Jad(Oa);this.Qad(Oa);this.DFh(Oa);if(S.EwaSettings.ma(479)&&V.g(this.$).ha.sa.AH()&&V.g(this.$).ha.sa.w4)switch(S.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Oa.buttons.push(this.Sa.pb(237));break;case 2:Oa.buttons.push(this.Sa.pb(238));
break;default:Oa.buttons.push(this.Sa.pb(236))}Mb.pc.push(Oa)}}Qad(Mb){if(!S.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.jc.allowSorting)if(!this.$.isMobileMode||(new U.a(this.$.xa)).Wd(2048)){var Oa=this.Sa.Bc();Oa.buttons.push(this.Sa.pb(223));Oa.buttons.push(this.Sa.pb(224));S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1)&&(Oa.buttons.push(this.Sa.pb(292)),Oa.buttons.push(this.Sa.pb(293)),Oa.buttons.push(this.Sa.pb(294)));this.$.isMobileMode||
Oa.buttons.push(this.Sa.pb(225));var Aa=this.Sa.Su("ContextMenu.sort",null,K.a.instance.ga(229),-864298118);Aa.menu.pc.push(Oa);Mb.buttons.push(Aa)}}UDh(Mb){l.AFrameworkApplication.zF("XLS-CreateSampleTable-Treatment;XLS-CreateSampleTable-Control");if(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTable",!1)){var Oa=this.Sa.Bc();Oa.buttons.push(this.Sa.pb(299));var Aa=this.Sa.Su("ContextMenu.createSampleTable",null,K.a.instance.ga(1961),-605127244);Aa.menu.pc.push(Oa);Oa=
this.Sa.Bc();Oa.buttons.push(Aa);Mb.pc.push(Oa)}}Jad(Mb){const Oa=this.Sa.Su("ContextMenu.filter",null,K.a.instance.ga(1964),2045563128),Aa=this.Sa.Bc();var Ba=this.KOh();const ob=this.Sa.pb(234);ob.label=Ba;Aa.buttons.push(ob);Aa.buttons.push(this.Sa.pb(235));Ba=this.Sa.Bc();Ba.buttons.push(this.Sa.pb(233));Oa.menu.pc.push(Aa);Oa.menu.pc.push(Ba);Mb.buttons.push(Oa)}DFh(Mb){if(V.g(this.$).ha.sa.AH()){const Oa=this.Sa.Bc();Oa.buttons.push(this.Sa.pb(232));S.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&
(Oa.buttons.push(this.Sa.pb(285)),Oa.buttons.push(this.Sa.pb(286)));const Aa=this.Sa.Su("ContextMenu.table",null,K.a.instance.ga(1963),-697806646);Aa.menu.pc.push(Oa);Mb.buttons.push(Aa)}}oUe(Mb,Oa,Aa,Ba,ob){if(Oa){const Va=J.K(ob);var xb=V.e(this.grid);if(xb&&!Aa&&!Ba){Aa=new U.a(this.$.xa);if(xb.range.contains(Va)&&this.UU(xb)){(Oa=!xb.yLa&&!Aa.ii)&&this.$.isEditMode&&Mb.buttons.push(this.Sa.pb(45));xb.paa&&Mb.buttons.push(this.Sa.pb(53));Oa&&this.$.isEditMode&&Mb.buttons.push(this.Sa.pb(47));return}!xb.yLa&&
this.$.isEditMode&&(xb=Aa.Wd(128),Mb.buttons.push(this.Sa.pb(xb?46:121)))}}this.D3i(ob)&&Mb.buttons.push(this.Sa.pb(48));(xb=this.$.xa.oa)&&xb.Fd&&(xb=xb.Fd.mv||xb.Fd.KH,!Oa||this.$.jK||!S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||xb||(Oa=J.K(ob),this.C3i(Oa)?Mb.buttons.push(this.Sa.pb(276)):Oa.Ze||Oa.isRow||Mb.buttons.push(this.Sa.pb(275))))}D3i(Mb){for(const Oa of Mb){Mb=this.grid.getRangeInformation(Oa);
for(let Aa=0;Aa<Mb.length;Aa++)if(Object(v.a)(P.HyperlinkRange,Mb[Aa])){const Ba=this.grid.Xb(Mb[Aa]);if(Ba&&this.UU(Ba)&&!Ba.yLa)return!0}}return!1}C3i(Mb){if(V.g(this.$).ha.sa.AH()){const Oa=V.g(this.$).Db.Xj(Mb);if(Oa&&Oa.usedRange.equals(Mb))return!0}return!1}dUe(Mb,Oa,Aa){var Ba,ob;if(1===V.g(this.$).ha.Ke&&!Oa&&!Aa){Oa=wa.a(this.$);Aa=this.Sa;var xb=Aa.Bc(),Va=this.$.da.za(65);(null===(Ba=null===Va||void 0===Va?void 0:Va.Km)||void 0===Ba?0:Ba.gF)&&!Oa&&xb.buttons.push(Aa.pb(227));Va&&Va.isCommentOperationEnabled(3)&&
xb.buttons.push(Aa.pb(221));(null===(ob=null===Va||void 0===Va?void 0:Va.Km)||void 0===ob?0:ob.jhd)&&!Oa&&xb.buttons.push(Aa.pb(228));(null===Va||void 0===Va?0:Va.hasCommentAtActiveCell)?Va.wC.isResolved||xb.buttons.push(Aa.pb(159)):Va&&Va.hasCommentAtActiveCell||(Va&&Va.Km&&Va.Km.gF?Oa||(xb.buttons.push(Aa.pb(229)),xb.buttons.push(Aa.pb(230))):(xb.buttons.push(Aa.pb(160)),Oa||xb.buttons.push(Aa.pb(226))));Mb.pc.push(xb)}}zFh(Mb){if(S.EwaSettings.ma(134)){const Oa=this.Sa,Aa=Oa.Bc();Aa.buttons.push(Oa.pb(250));
Mb.pc.push(Aa)}}AEh(Mb,Oa,Aa){if(!Aa){Aa=this.$.Ka.nH();var Ba=new U.a(this.$.xa),ob=new L.a(Aa,Oa,this.grid);(new T(Mb,this.$,this.Sa,Aa,Oa,this.grid,ob,Ba)).Ead()}}pEh(Mb,Oa,Aa,Ba,ob){const xb=(new U.a(this.$.xa)).Wd(8),Va=this.Sa,bb=Va.Bc();Oa&&bb.buttons.push(Va.pb(xb?152:153));Aa&&bb.buttons.push(Va.pb(xb?150:151));Oa&&(Ba||bb.buttons.push(Va.pb(xb?109:155)),bb.buttons.push(Va.pb(xb?111:157)));Aa&&(ob||bb.buttons.push(Va.pb(xb?108:154)),bb.buttons.push(Va.pb(xb?110:156)));Mb.pc.push(bb)}dEh(Mb,
Oa){const Aa=this.Sa,Ba=Aa.Bc();Mb.pc.push(Ba);Oa&&Ba.buttons.push(Aa.pb(102));Ba.buttons.push(Aa.pb(42));Ba.buttons.push(Aa.pb(43));Oa=this.dFh(Aa);Mb.pc.push(Oa)}dFh(Mb){const Oa=Mb.Bc();Oa.title=K.a.instance.ga(1141);Oa.m3f=!1;Oa.l3f=!1;Oa.G8f=!1;let Aa=5;const Ba=G.a.$pd(this.$);Ba&&(Aa=6);Mb=Mb.FC("PasteOptionsGallery",Aa,"Size24by24",Oa.title);Oa.buttons.push(Mb);Mb.Lt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1142,void 0,"Paste_24",1,u.a.Srh);Mb.Lt("ContextMenu.PasteValues",
-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1143,void 0,"PasteValues_24",1,u.a.Xrh);Mb.Lt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1144,void 0,"PasteFormulas_24",1,u.a.Urh);Mb.Lt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1145,void 0,"PasteTranspose_24",1,u.a.Wrh);Mb.Lt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"PasteFormatting_24",1,u.a.Trh);Ba&&Mb.Lt("ContextMenu.PasteLink",
42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteLink_24",1,u.a.Vrh);return Oa}PFh(Mb,Oa,Aa,Ba,ob){var xb;const Va=this.Sa;var bb=Va.Bc();bb.buttons.push(Va.pb(43));Mb.pc.push(bb);this.eec&&!this.$.jK&&(bb=this.Sa.Bc(),this.Jad(bb),Mb.pc.push(bb));S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.jc.isMobileMode&&this.$.ea.jc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(bb=this.Sa.Bc(),this.Qad(bb),Mb.pc.push(bb),c.ULS.sendTraceTag(537167045,
0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));bb=this.$.da.za(65);if(null===(xb=null===bb||void 0===bb?void 0:bb.Km)||void 0===xb?0:xb.gF)xb=this.Sa.Bc(),xb.buttons.push(Va.pb(229)),Mb.pc.push(xb);xb=this.Sa.Bc();this.oUe(xb,Oa,Aa,Ba,ob);Mb.pc.push(xb);l.AFrameworkApplication.isMobileMode&&!N.a(this.$.ya,30)&&(Oa=Va.Bc(),Oa.buttons.push(Va.pb(272)),Mb.pc.push(Oa))}XEh(Mb,Oa,Aa,Ba,ob){const xb=
this.Sa.Bc();this.YEh(xb);this.oUe(xb,Oa,Aa,Ba,ob);0<xb.buttons.length&&Mb.pc.push(xb)}YEh(Mb){Mb.buttons.push(this.Sa.pb(135))}uEh(Mb){const Oa=this.Sa.Bc();Oa.buttons.push(this.Sa.pb(185));Mb.pc.push(Oa)}uFh(Mb,Oa){S.EwaSettings.ma(480)&&Oa&&(Oa=this.Sa.Bc(),Oa.buttons.push(this.Sa.pb(262)),Mb.pc.push(Oa))}IEh(Mb){var Oa=this.grid.ha.sa.selectedRanges;if(Oa&&Oa.length){var Aa=!1;for(var Ba=0;Ba<Oa.length;Ba++)if(this.grid.Db.wwa(Oa[Ba])){Aa=!0;break}if(Aa){Aa=!1;if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6411410_RemoveConvertToTextForRichValueRange"))for(Ba=
0;Ba<Oa.length;Ba++){var ob=this.grid.Db.VSh(Oa[Ba]);if(null!=ob&&null!=ob[0]){for(var xb=0;xb<ob.length;xb++)if(this.grid.Db.wwa(ob[xb])){Aa=!0;break}if(Aa)break}}xb=this.Sa;Ba=xb.Bc();ob=xb.Bc();var Va=1===Oa.length&&(Oa[0].isSingle||this.grid.Db.y6a(Oa[0])),bb=!1,ra=!1,Qa=!1,qb=!1;for(let Wa=0;Wa<Oa.length&&!(bb&&Qa&&ra&&qb);Wa++)!bb&&this.grid.Db.$ii(Oa[Wa])&&(bb=!0),!Qa&&this.grid.Db.zdf(Oa[Wa],!1)&&(Qa=!0),!ra&&this.grid.Db.qod(Oa[Wa])&&(ra=!0),!qb&&this.grid.Db.xei(Oa[Wa])&&(qb=!0);S.EwaSettings.ma(104)&&
Va&&!this.grid.Db.Fdc(Oa[0])&&(qb?Ba.buttons.push(xb.pb(217)):Ba.buttons.push(xb.pb(216)));qb=bb;qb=!(new U.a(this.$.xa)).ii&&qb;Qa&&!Aa&&(S.EwaSettings.ma(130)&&H.l(this.$.pg)&&(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?ob.buttons.push(xb.pb(220)):ob.buttons.push(xb.pb(qb?220:271))),ra&&ob.buttons.push(xb.pb(qb?218:269)),Va&&(this.grid.Db.qod(Oa[0])||this.grid.Db.Fdc(Oa[0]))&&
ob.buttons.push(xb.pb(qb?219:270))),ob.buttons.push(xb.pb(qb?215:268)));0<ob.buttons.length&&(Oa=xb.Su(bb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,K.a.instance.ga(1775),798637440),Oa.menu.pc.push(ob),Ba.buttons.push(Oa));0<Ba.buttons.length&&Mb.pc.push(Ba)}}}eEh(Mb,Oa){this.grid.Db.Kbf(Oa)&&(Oa=this.Sa.Bc(),this.grid.ha.sa.aba()?(Oa.buttons.push(this.Sa.pb(241)),Oa.buttons.push(this.Sa.pb(239))):Oa.buttons.push(this.Sa.pb(240)),Mb.pc.push(Oa))}UU(Mb){return Mb.cell.hasHyperlink}tUe(Mb){this.iFh(Mb);
var Oa=this.Sa.Bc();this.Qad(Oa);Mb.pc.push(Oa);this.eec&&(Oa=this.Sa.Bc(),this.Jad(Oa),Mb.pc.push(Oa))}hFh(Mb,Oa,Aa){this.tUe(Mb);this.dUe(Mb,Oa,Aa)}iFh(Mb){if(this.grid.ha.sa.xg&&!this.grid.hb.Ti){var Oa=this.Sa,Aa=Oa.Bc();ma.a(this.$).dQd()?Aa.buttons.push(Oa.pb(265)):Aa.buttons.push(Oa.pb(264));Mb.pc.push(Aa)}}static LTi(Mb){const Oa=Mb.yJa(Ib.Aid);Oa&&Oa.skd&Ib.Aid&&Mb.invoke(Ib.Aid,null)}static zEh(Mb,Oa,Aa){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(Aa=
Aa.da.za(254),!Aa){c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(Aa=Aa.da.za(254,!0),!Aa)return;Aa.Tmd()&&Aa.yif()&&Mb.buttons.push(Oa.pb(212));Aa.Tmd()&&Aa.yhc()&&Mb.buttons.push(Oa.pb(213))}Fvj(){const Mb=this.$.da.za(66).Jg,Oa=this.grid.ha.sa.activeCell;return null!=Mb&&!Mb.hasActiveFilter||ba.c(this.$,Oa)||!this.wei(Oa)}wei(Mb){const Oa=Mb.left;var Aa=this.zac();if(null!=Aa&&null!=Aa.S7b&&Aa.S7b.includes(Oa-
1))return!0;Aa=this.rac();return null!=Aa&&J.D(Aa).contains(Mb)&&null!=Aa.FilteredColumns&&Aa.FilteredColumns.includes(Oa-1)?!0:!1}uei(){var Mb=this.$.da.za(66).Jg;const Oa=this.zac();if(null!=Mb)return Mb.hasAutoFilter&&Mb.hasActiveFilter;if(null!=Oa)return null!=Oa.S7b&&0<Oa.S7b.length;Mb=this.rac();return null!=Mb&&null!=Mb.FilteredColumns&&0<Mb.FilteredColumns.length}vei(){var Mb=this.$.da.za(66).Jg;const Oa=this.zac();if(null!=Mb&&Mb.hasAutoFilter||null!=Oa&&Oa.wZa.every(Aa=>0!=Aa.length))return!0;
Mb=J.D(this.rac());return null!=Mb&&Mb.contains(this.grid.ha.sa.activeCell)?!0:!1}zac(){const Mb=this.$.da.za(66);Mb.Fm(this.grid.ha.sa.activeCell);return Mb.Mtb(this.grid.ha.sa.activeCell)}rac(){return this.$.xa.getItemByName(this.$.oa.sheetName).W_}KOh(){var Mb=this.grid.ha.sa.activeCell,Oa=0,Aa=!1,Ba=this.$.da.za(66),ob=this.zac();Ba=Ba.Jg;null!=Ba?(Oa=Ba.usedRange.top,Aa=!0):null!=ob?(Oa=ob.top,Aa=!0):(ob=this.rac(),null!=ob&&J.D(ob).contains(Mb)&&(Oa=ob.FirstRow+1,Aa=!0));return Aa?(Mb=Mb.left,
Oa=E.Range.Tc(Oa,Mb),Oa=this.grid.Xb(Oa),Aa="",null!=Oa&&(Aa=Oa.text),this.sPg(Aa,Mb)):K.a.instance.ga(222)}sPg(Mb,Oa){return null==Mb||Ca.a.kh(Mb.trim())?String.format(K.a.instance.mb(157),E.Range.uP(Oa)):Mb.length>Ib.w_d?String.format(K.a.instance.mb(155),Mb.substring(0,Ib.w_d)):String.format(K.a.instance.mb(156),Mb)}}Ib.uIb="GridContextMenuRootName";Ib.k0h=z.a.uAe;Ib.Aid=192;Ib.w_d=26;Object(t.a)(Ib,"GridContextMenu",n.a,[])},1209:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(86),d=a(1084),f=a(8),
e=a(770);class k{}k.x6f="suggested_cells_list_box";Object(t.a)(k,"CssElementIds",null,[]);var l=a(5),m=a(1085);class v{constructor(X,da){this.vkg=X;this.ukg=da}get zra(){return this.vkg}get RVc(){return this.ukg}}Object(t.a)(v,"CellAutoCompleteItem",null,[544]);var n=a(4),w=a(84),r=a(906),u=a(379),x=a(42),z=a(1),B=a(22),y=a(21);class A extends r.a{constructor(X,da,fa){super(X,da);this.APb=null;this.thc=0;this.h0=this.m7a=null;this.o5=(S,ka)=>{if(S=this.cellAutoCompleteControl.items)if(1===S.length&&
this.cellAutoCompleteControl.e0a.length<S[0].zra.length&&this.cellAutoCompleteControl.uva&&B.a.jL(S[0].zra,this.cellAutoCompleteControl.e0a)&&(ka.newValue=S[0].zra),this.Ya&&z.EwaSettings.ma(135)){let V=-1;1<S.length?V=this.cellAutoCompleteControl.wac(this.Ya.text,!0):1===S.length&&(this.cellAutoCompleteControl.uva||this.cellAutoCompleteControl.mcc)&&(V=0);if(0<=V&&S.length>V&&S[V].RVc){const wa=x.C(S[V].RVc);wa&&y.g(this.$).Db.wwa(wa)&&(ka.Faf=!0,ka.Qve=S[V].RVc)}}};this.qEb=()=>{this.cellAutoCompleteControl.uva=
!1};this.Ya.KXa(this.o5);if(this.Dxb=z.EwaSettings.fl())this.APb=fa;this.h0=this.pe.Vd(this.Ya.textBox.domElement);this.h0.ka("mousedown",this.qEb)}get Sxb(){return!1}get iK(){return this.cellAutoCompleteControl.qe}set iK(X){this.cellAutoCompleteControl.qe=X}get N4a(){return!1}get key(){return u.a.OYc}get cellAutoCompleteControl(){if(this.Dxb)return this.APb;const {CellAutoCompleteControl:X}=a(1209);return this.APb||(this.APb=Object(w.a)(X,this.$.da.za(1)))}dispose(){this.Ya.qHb(this.o5);super.dispose()}wT(X){X&&
!this.cellAutoCompleteControl.qe||super.wT(X)}Sh(X,da){this.cellAutoCompleteControl.Ya=this.Ya;this.thc=X.keyCode;if(this.Ya.$a){const fa=this.Ya.text;B.a.equals(this.m7a,fa,!1)||(this.m7a=fa)}else this.m7a=null;if(237279923===da)return this.cellAutoCompleteControl.qe=!1;z.EwaSettings.ma(135)&&17===this.thc&&this.cellAutoCompleteControl.uva&&(this.cellAutoCompleteControl.mcc=!0);return super.Sh(X,da)}Jxd(){var X;if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||
!n.AFrameworkApplication.Mg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.uva=!1,this.Ya.$a){const da=!B.a.equals(this.m7a,this.Ya.text,!0),fa=this.Ya.Sld;fa||!da&&229!==this.thc?fa&&(this.cellAutoCompleteControl.qe&&(this.cellAutoCompleteControl.qe=!1),null===(X=this.cellAutoCompleteControl.IMa)||void 0===X?void 0:X.cancel()):this.cellAutoCompleteControl.YKg(this.thc)}else this.m7a=null}Lh(){}Jf(){this.iK=!1;this.cellAutoCompleteControl.set_visible(!1);this.m7a=null;this.cellAutoCompleteControl.uva=
!1;this.cellAutoCompleteControl.mcc=!1;this.cellAutoCompleteControl.IMa&&this.cellAutoCompleteControl.IMa.cancel()}pEd(X,da){return this.cellAutoCompleteControl.Sh(X,da)}}Object(t.a)(A,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var K=a(29);r=a(1086);var G=a(12),T=a(11),W=a(116);class P extends r.a{constructor(X,da,fa){super(X,da);this.xqa=this.cellAutoCompleteControl=null;if(this.Dxb=z.EwaSettings.fl())this.cellAutoCompleteControl=fa;this.ir=[]}get Ej(){return this.xqa}set Ej(X){this.DAa(this.Ej);
this.xqa=X;const da=this.DAa(this.Ej);this.de=X?da.innerText:null;this.itc(X)}get qe(){return super.qe}set qe(X){super.qe=X;X||(this.Ej=null)}get CSa(){return null}get FFa(){return this.Dxb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}dispose(){super.dispose();this.xqa=null}Lxc(X){this.S6(!1);let da;da=`<table class='${this.qba}' aria-live='polite'><tbody>`;for(let S=0,ka=this.ir.length;S<ka;S++){var fa=K.a.Dg(X[this.ir[S]].zra);fa=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.IZ,P.PYc,l.a.moe,fa,K.a.r6c(fa));da+=fa}this.fg.innerHTML=da+"</tbody></table>";this.pn=G.DOMElementExtensions.Kj(this.domElement,this.qba);this.S6(!0);this.hra()}DIa(X,da){if(X&&X.length){var fa=[];if(da)for(let S=0,ka=X.length;S<ka;S++)B.a.jL(X[S].zra,da)&&fa.push(S);this.ir=fa;this.Lxc(X)}else this.qe=!1,this.xqa=null}wxa(){}BSg(X,da,fa){let S=Math.min(X,Math.max(200,fa));da&&X<fa&&(S+=W.a.qu);G.DOMElementExtensions.Gv(this.fg,S);da&&(S-=W.a.qu);return S}hra(){super.hra();var X=G.DOMElementExtensions.Kj(this.get_element(),
this.qba),da=this.ir.length>this.UH,fa=y.g(this.$);if(fa=fa.Xb(fa.ha.sa.activeCell))for(X=this.BSg(X.offsetWidth,da,fa.width),da=this.fg.getElementsByClassName(P.PYc),fa=0;fa<da.length;fa++)da[fa].style.maxWidth=T.HelperMethods.qc(X);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(X){if(X=super.onItemClick(X)){const da=y.g(this.$);da.Fo(!1);da.focus()}return X}}P.PYc=e.a.lrh;Object(t.a)(P,"CellAutoCompleteListBox",
r.a,[]);var E=a(24),H=a(64),F=a(113),N=a(172),J=a(45),R=a(34),M=a(250);r=a(19);a.d(D,"CellAutoCompleteControl",function(){return U});const L=`<div id='${k.x6f}' class='${e.a.G7c} ${r.a.Wo}' ></div>`;class U extends d.a{constructor(X,da){super(X);this.iCa=null;this.NYc=[];this.k3d=null;this.mcc=this.uva=!1;this.U9d=this.fq=null;this.eIe=()=>{this.VX.DIa(this.items,this.iCa);this.raiseEvent("ACLBUpdated",new m.a(this.items.length));this.show()};this.tableManager=da;this.domElement.className=e.a.eLe;
this.domElement.innerHTML=L;G.DOMElementExtensions.setVisible(this.domElement,!1);M.d(this.style,this.$.isChromeRtl);this.icf=z.EwaSettings.fl();this.Pve=$get(k.x6f,this.domElement);this.VX=new P(this.$,this.Pve,this);this.cSa(!0);this.$.domElement.appendChild(this.domElement);this.wnb(X,F.a(X));this.wnb(X,y.g(X).Wb);this.icf||this.$.da.Ga(1,this);this.Bei=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}QXb(X){this.addHandler("ACLBUpdated",X)}Wqc(X){this.removeHandler("ACLBUpdated",
X)}J1(X){this.addHandler("ACLBSelectionChanged",X)}Hca(X){this.removeHandler("ACLBSelectionChanged",X)}JEg(X){this.addHandler("ACLBMatchedItem",X)}Laj(X){this.removeHandler("ACLBMatchedItem",X)}get Pt(){return this.VX}get e0a(){return this.iCa}get de(){return this.VX.de}get items(){return this.fq}get IMa(){return this.U9d}get activeCell(){return y.g(this.$).ha.sa.activeCell}get dataValidationControl(){return this.k3d||(this.k3d=this.$.da.za(14))}L5f(X){for(let da=0;da<X.length;da++){const fa=X.charCodeAt(da);
if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?B.a.isLetter(fa):B.a.dnd(fa))return!0}return!1}iwa(){return!this.items}dispose(){if(this.$){this.cSa(!1);const X=y.g(this.$);X&&X.view.Oq(this.Glc)}b.a.rc([this.VX,this.IMa]);b.a.rc(this.NYc);this.NYc=this.Pve=this.VX=this.Ya=null;super.dispose()}Sh(X,da){let fa=!1;if(this.cwj())switch(da){case -798660877:if(1===this.items.length&&this.de)break;this.Pt.rB(1);this.raiseEvent("ACLBSelectionChanged",
new m.a(this.items.length,this.wac(this.de),this.de));fa=this.Py(!1);break;case 137938150:if(1===this.items.length&&this.de)break;this.Pt.rB(-1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.wac(this.de),this.de));fa=this.Py(!1);break;case 2091832999:this.Pt.rB(this.UH-1);fa=this.Py(!1);break;case 742457698:this.Pt.rB(-(this.UH-1));fa=this.Py(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.qe=!1;fa=!0;break;case 267796030:this.Py(!0);break;default:fa=
super.Sh(X,da)}return fa}show(){this.items&&this.items.length&&(this.VX.Ej=this.de?this.Pt.pn.rows[this.wac(this.de)]:null,this.qe=0<this.VX.ir.length,this.WAa(!0),this.VX.wxa())}YKg(X){const da=!!this.Ya&&!H.f(this.$.oa);this.mcc=this.uva=!1;this.Ya&&!this.Ya.$a?this.set_visible(!1):da&&!this.Lah(this.activeCell)&&this.Jzj(X)}Lah(X){return!!this.dataValidationControl&&this.dataValidationControl.t5c(X)}Py(X){if(!this.Ya||!this.qe)return!1;const da=this.iCa;if(this.de){var fa=G.DOMElementExtensions.GY(G.DOMElementExtensions.Kj(this.VX.Ej,
P.PYc),l.a.moe,"");const S=fa.substring(da.length,fa.length);X?this.Ya.text=fa:this.Ya.insertTextAt(S,da.length,this.Ya.text.length)}fa=y.g(this.$);fa.lj&&(fa=fa.Wb,fa.text=this.Ya.text,fa.setCaretPosition(this.Ya.textBox.caretPosition));X?this.qe=!1:this.Ya.textBox.selectRange(da.length,this.Ya.text.length);return!0}wac(X,da=!1){if(!this.VX.pn)return-1;const fa=this.VX.pn.children[0],S=fa.children.length;let ka;for(let V=0;V<S;++V)if(ka=fa.children[V],B.a.equals(ka.innerText.trim(),X,da))return V;
return-1}Pzg(X,da,fa,S,ka,V,wa){const ma=fa.originalText.replace(U.Xqf,String.fromCharCode(32)),ab=new E.Range(X.top-1,X.left,X.bottom-1,X.right,!1,!1),ba=wa?wa.Fm(fa.range):null;(!fa.GH||fa.range.left===X.left)&&1<ma.length&&!S.lb(ma.toUpperCase())&&B.a.jL(ma,da)&&!B.a.equals(ma,da,!0)&&!U.bSe(da)&&this.L5f(ma)&&(!ka&&!ba||!ka&&ba.equals(wa.Fm(ab))||ka&&fa.range.Ed(V)&&fa.range.top!==V.top)&&(X=fa.formulaBarText,B.a.equals(X,fa.text,!1)||!X)&&(X={},X.FirstRow=fa.range.top-1,X.FirstColumn=fa.range.left-
1,fa=new v(ma,X),S.add(ma.toUpperCase(),fa))}Jzj(X){this.fq=this.sXh();this.IMa&&this.IMa.cancel();0<this.Ya.text.length&&0!==X?this.items&&((1<this.items.length||this.qe)&&this.rhh(),8!==X&&127!==X&&46!==X&&(1===this.items.length?this.bjd(!1):this.VX.Ej&&this.Py(!1))):this.qe=!1}rhh(){this.qe?this.eIe():this.U9d=N.AsyncMethodContext.hr(this.eIe,500,J.a.LUg,this.IMa)}bjd(X){c.ULS.shipAssertTag(537167966,0,!this.iwa()&&1===this.items.length,"Invalid Items");let da=this.items[0].zra,fa=this.Ya.text,
S=da.substring(fa.length,da.length);if(X&&!S.length)this.Ya.text=da;else if(!X&&0<S.length)this.Ya.appendText(S),this.Ya.textBox.selectRange(fa.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new m.a(this.items.length,0,da));this.uva=!0}sXh(){this.fq=null;const X=new R.a(!1);var da=this.activeCell;this.iCa=this.Ya.text.replace(U.Xqf,String.fromCharCode(32));const fa=this.tableManager.Fm(da),S=da.Ed(fa);if(U.bSe(this.iCa)||!this.L5f(this.iCa))return this.items;const ka=new E.Range(1,
da.left,da.top-1,da.left,!1,!1);var V=new E.Range(da.top+1,da.left,f.a.mh,da.left,!1,!1);let wa;const ma=y.g(this.$);V=ma.kk("CellAutoCompleteControl.GetSuggestedCells",V);try{const ab=ma.kk("CellAutoCompleteControl.GetSuggestedCells2",ka);try{for(const ba of[ab,V])for(;ba.$$mn();)wa=ba.$$cu(),this.Pzg(da,this.iCa,wa,X,S,fa,this.tableManager)}finally{ab&&ab.dispose()}}finally{V&&V.dispose()}this.fq=Array(X.values.length);for(da=0;da<this.items.length;da++)this.items[da]=X.values[da];this.items.sort((ab,
ba)=>ab.zra.localeCompare(ba.zra));return this.items}wnb(X,da){X&&da&&this.NYc.push(new A(X,da,this.icf?this:void 0))}cwj(){return this.Bei?this.e0a&&!this.iwa()&&this.qe?this.get_visible():!1:this.e0a&&!this.iwa()&&this.get_visible()&&this.qe}static get Xqf(){return U.zae||(U.zae=new RegExp(String.fromCharCode(160),"g"))}static bSe(X){X=0<X.length?X.charCodeAt(0):-1;return 35===X||61===X||43===X||45===X||64===X}}U.zae=null;Object(t.a)(U,"CellAutoCompleteControl",d.a,[403,404,405,3])},1216:function(t,
D,a){t=a(0);var c=a(563),b=a(557),d=a(554),f=a(995);class e{j8g(G,T){if(G&&!(1>G.length)&&T){var W=Object.assign(new d.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.G5g(G,W.ControlList);T.push(W)}}G5g(G,T){const W=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(T,W);T=Object.assign(new d.a,{Title:"",ControlList:[]});
Array.add(W.Menu.MenuSectionList,T);this.P7g(G,T.ControlList)}P7g(G,T){for(let W=0;W<G.length;W++){const P=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",W),Command:"336231556",DisplayName:G[W].userName,LabelText:G[W].userName,ImageBackColor:G[W].color,PersonaId:G[W].email,IsAnonymous:G[W].isAnonymous});Array.add(T,P)}}}Object(t.a)(e,"PresenceContextMenuSectionBuilder",null,[424]);var k=a(83),l=a(4),m=a(175),v=a(555),n=a(107),w=a(133),r=a(86),u=a(82),x=a(106),z=a(25);class B{constructor(G,
T,W,P){this.m1d=this.E0=this.Ni=this.VD=this.x7=null;this.iVb=G;this.svg=P;this.iVb.cLa&&(this.Ni=new n.a(3,2,5E3,Object(k.a)(this,this.bMg,"authenticationCheckTask"),2),l.AFrameworkApplication.Ji.Hg(this.Ni),this.Fg(T,W));this.iVb.hmb(()=>{this.atf()});this.iVb.IXa(()=>{this.btf()})}get businessBar(){return this.E0||(this.E0=u.a.instance.uh("CommonUI.IBusinessBar"))}get Gte(){return this.m1d||(this.m1d=u.a.instance.uh("CommonUI.IBusinessBarEntryFactory"))}Fg(G,T){const W=l.AFrameworkApplication.wb;
W.Je(z.a.authenticationLost,x.a.frame,G,96);W.Je(z.a.zre,x.a.frame,T,96);W.Ob(z.a.vve,x.a.frame,m.ActionManager.n5c);W.Ob(z.a.wve,x.a.frame,m.ActionManager.n5c);W.Ob(z.a.srd,x.a.frame,m.ActionManager.n5c)}atf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.wb.processAction(z.a.authenticationLost,2)}btf(){this.sHj();l.AFrameworkApplication.wb.processAction(z.a.zre,2)}bMg(){this.iVb.authenticationCheck()}sHj(){this.VD&&(this.VD.hide(),this.VD.dispose(),this.VD=
null);this.x7&&this.businessBar&&(l.AFrameworkApplication.Mg||this.businessBar.removeEntry(this.x7),this.x7.dispose(),this.x7=null)}showDialog(G){r.a.Ia(this.VD);this.VD=new w.StandardDialog;this.svg||(this.VD.it=!1,this.VD.Sb=0);this.VD.sc(1,CommonUIStrings.l_SignIn);this.VD.mW(CommonUIStrings.l_DefaultDialogTitle,G,Object(k.a)(this,this.gw,"dialogHandler"))}gw(G){1===G?(v.a.P5(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.wb.processAction(z.a.srd,
2)):(this.qQd(),l.AFrameworkApplication.wb.processAction(z.a.wve,2))}qQd(){this.businessBar&&this.Gte&&(this.x7=this.Gte.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.x7.closeable=!0,this.x7.addButton(CommonUIStrings.l_SignIn,B.wRg,""),this.x7.O9=Object(k.a)(this,this.zRg,"businessBarEntryCloseHandler"),this.businessBar.hE(this.x7,!1))}zRg(){this.Oeh();l.AFrameworkApplication.wb.processAction(z.a.vve,2)}Oeh(){this.Ni&&(l.AFrameworkApplication.Ji.Hp(this.Ni),
this.Ni=null)}dispose(){this.Ni=this.VD=this.x7=null}static wRg(){v.a.P5();l.AFrameworkApplication.wb.processAction(z.a.srd,2)}}Object(t.a)(B,"SignOutResponseUI",null,[3]);var y=a(246);class A{get name(){return"Common.App.UI"}ai(G){G.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").uc()}init(){}dispose(){r.a.Ia(A.j1);A.j1=null}static main(){y.a.instance.Ii(new A)}}A.j1=null;Object(t.a)(A,"CommonAppUIPackage",null,[4,5]);a.d(D,"a",
function(){return K});const K=()=>{Type.registerNamespace("CAUI");A.main()}},1217:function(t,D,a){t=a(0);var c=a(220),b=a(1209),d=a(50),f=a(37),e=a(1),k=a(695);class l extends c.a{constructor(x){super();this.$=x;this.Fb()}create(){const x=this.$.da,z=d.GetServiceTaskFactory.create(x,134,this.la,this.ib),B=d.GetServiceTaskFactory.Ta(x,213,214,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([z,B],this.la),()=>{if(e.EwaSettings.fl())this.qb(Object(k.c)(this.$.da,1,()=>{const y=new b.CellAutoCompleteControl(this.$,
z.result);B.result.ka(y);return y}));else{let y=x.za(1);y||(y=new b.CellAutoCompleteControl(this.$,z.result),B.result.ka(y));this.qb(y)}},this.la,3)}static ka(x){x.da.Ga(151,new l(x))}}Object(t.a)(l,"CellAutoCompleteControlFactory",c.a,[]);var m=a(15),v=a(14);class n{constructor(x,z){this.TYa=null;this.Wzf=(B,y)=>{1<y.length&&(B=v.a.instance.ga(858),this.ariaLiveNotifier.aLf(B,y.length))};this.Xzf=(B,y)=>{m.ULS.shipAssertTag(537167961,0,0<=y.selectedIndex&&0<=y.length&&y.selectedIndex<y.length,"Invalid ListEventArgs: SelectedIndex/Length");
m.ULS.shipAssertTag(537167960,0,!!y.ZF,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.H4i(y.ZF,y.selectedIndex+1,y.length)};this.Yzf=(B,y)=>{this.ariaLiveNotifier.YOa(y.ZF)};this.ariaLiveNotifier=x;e.EwaSettings.fl()||z.Ga(213,this)}dispose(){this.EWd();this.TYa=null}ka(x){x&&(this.TYa=x,x.QXb(this.Wzf),x.J1(this.Xzf),x.JEg(this.Yzf))}EWd(){this.TYa&&(this.TYa.Wqc(this.Wzf),this.TYa.Hca(this.Xzf),this.TYa.Laj(this.Yzf))}}Object(t.a)(n,"CellAutoCompleteReadoutHandler",null,
[406,3]);class w extends c.a{constructor(x){super();this.$=x;this.Fb()}create(){const x=this.$.da;f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ta(x,211,212,this.ib),z=>{if(e.EwaSettings.fl())this.qb(Object(k.c)(x,213,()=>new n(z.result,x)));else{const B=x.za(213)||new n(z.result,x);this.qb(B)}},this.la,3)}static ka(x){x.da.Ga(214,new w(x))}}Object(t.a)(w,"CellAutoCompleteReadoutHandlerFactory",c.a,[]);var r=a(10);a.d(D,"a",function(){return u});const u=()=>{r.a.Fa(l.ka);r.a.Fa(w.ka)}},1218:function(t,
D,a){var c=a(10);t=a(0);var b=a(232),d=a(220),f=a(50),e=a(37),k=a(1),l=a(15),m=a(86),v=a(4),n=a(78),w=a(8),r=a(24),u=a(64),x=a(42),z=a(145),B=a(47),y=a(45),A=a(12),K=a(14),G=a(21),T=a(27),W=a(19),P=a(54);class E extends n.a{constructor(M,L,U,X){super();this.isMac=T.a.isMac;this.$=M;this.ariaLiveNotifier=X;this.Fp=U.Y2b(M,null,L,W.a.dsh,P.a.gf(9),K.a.instance.ga(1733),"PulloutPointerDown")}get mz(){return this.Fp.mz}get buttonWidth(){return this.Fp.buttonWidth}dispose(){this.Fp.dispose();this.$=null;
super.dispose()}domElement(M){return this.Fp.domElement(M)}getButton(M){return this.Fp.getButton(M,!1)}ENb(M,L){this.Fp.ENb(M,L,!1)}Yza(M,L){const U=G.g(this.$),X=U.hb.jj(M);this.Fp.ENb(L?K.a.instance.ga(1733):K.a.instance.ga(1734),X);L=this.isMac?L?K.a.instance.ga(1737):K.a.instance.ga(1738):L?K.a.instance.ga(1735):K.a.instance.ga(1736);var da=U.lg(M,X);M=U.Lf(X).tn;if(da&&0<=da.x&&0<=da.y){const fa=da.bottomRight.x+this.mz;da=da.topLeft.y-this.mz-this.buttonWidth;if(da<M.topLeft.y+this.mz){if(U.hb.GSa){this.hide();
return}da=M.topLeft.y+this.mz}this.xp(fa,da,U.rtl,X);this.ariaLiveNotifier.YOa(L)}else this.hide()}xp(M,L,U,X){this.Fp.xp(M,L,U,X,!1)}hide(){this.Fp.hide()}}Object(t.a)(E,"PulloutLaunchButton",n.a,[]);var H=a(36),F=a(22);class N extends n.a{constructor(M,L,U,X,da){super();this.FWa=this.eMc=this.ntc=this.KEa=this.vR=this.wO=null;this.Pce=0;this.jBb=this.lec=this.QCc=!1;this.zg=()=>{this.Mva&&(this.gridView?1===this.gridView.ha.Ke?(this.gridView.ha.sa.activeCell.equals(this.KEa)||this.$M||this.Sx(),
this.rnb.Qq()):this.Sx():l.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.Lh=()=>{this.Sx()};this.Zc=()=>{this.kW()};this.Dc=()=>{this.Sx()};this.dd=()=>{this.showCallout()};this.Sxa=()=>{if(this.Qg.Pk&&this.Qg.Pk.length)if(this.pXc)this.Qg.osi||(this.QCc=this.Qg.Pk[0].BlockingDataForExpand),this.Qg.XMh&&l.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.Pce=this.Qg.l3c&&this.Qg.JTe<this.Qg.l3c.left-1?this.Qg.l3c.left-
1-this.Qg.JTe:-1,this.showCallout();else if(this.gridView.ha.sa.xg){var fa=this.gridView.ha.sa.activeCell;if(fa&&this.vR){var S=this.tableManager.Fm(fa);this.SJc=!!S;const ka=this.gridView.ha.sa.Wc;S=this.$M&&this.vR.Ed(S);const V=this.Zfd&&!this.$M&&ka.equals(this.selectedRange);S||V?(l.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.J7b=!0,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.$M&&this.tableManager.Sia(fa)?l.ULS.shipAssertTag(537154139,
0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.$M?this.Vh.Yza(this.vR,this.$M):this.Vh.Yza(ka,this.$M):this.Vh.Yza(this.vR,this.$M),this.Wrc())):l.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.Wi=()=>{this.T5a()&&this.Vh.hide();1===this.gridView.ha.Ke&&this.kW()};this.YQ=()=>{const fa=
this.gridView.ha.Ke;this.gridView.ha.sa.activeCell&&1===fa&&this.kW()};this.mt=()=>{if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.$M){if(this.vR&&this.KEa){var fa=this.tableManager.Fm(this.KEa);fa&&1<fa.bottom-fa.top&&(--fa.bottom,this.gridView.p4(fa)&&this.rnb.Qq())}}else this.gridView.ha.sa.xg&&this.gridView.p4(this.gridView.ha.sa.Wc)&&this.rnb.Qq();else this.vR&&this.KEa&&this.$M&&(fa=this.tableManager.Fm(this.KEa))&&1<fa.bottom-
fa.top&&(--fa.bottom,this.gridView.p4(fa)&&this.rnb.Qq())};this.kW=()=>{if(this.$&&this.gridView){if(this.J7b&&this.$M){const fa=this.gridView.ha.sa.activeCell;this.vR=this.KRe();const S=!!this.ntc&&this.ntc.contains(fa);if(this.vR&&(fa.equals(this.KEa)||S)){this.Vh.Yza(this.vR,this.$M);return}}this.J7b=!1;(this.vR=this.KRe())&&this.Nka&&this.gridView&&this.gridView.Ea.Qr(this.Nka)?(this.pXc=!1,this.JY()):(this.Qg.kYc(),this.Qg.X_b());this.J7b||this.Vh.hide()}};this.$=M;this.tableManager=U;this.contextMenuManager=
X;this.Vh=new E(M,this.dd,L,da);this.Qg=L.T1c(M,U);this.J7b=this.pXc=!1;this.Zfd=k.EwaSettings.ma(135);this.SJc=!0;this.aJc=!1;this.gridView=G.g(this.$);this.gridView.Wb.Mk(this.Lh);this.gridView.Nu(this.YQ);this.$.el(this.Zc);this.$.ik(this.Dc);this.$.GA(this.Wi);this.gridView.view.Ns(this.mt);this.gridView.ha.cT(this.zg);this.rnb=B.a.instance.create(this.kW,250,y.a.$0i);l.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Qg.IXb(this.Sxa);H.a.Qxb()&&(this.lec=!0);this.kW();M.da.Ga(261,
this)}get lc(){return this.Vh.domElement(1)}get Nka(){return this.eMc}get selectedRange(){return this.FWa}get $M(){return this.SJc}get Dld(){return this.aJc}get RIf(){return this.Pce}get DAb(){const M=this.Vh.domElement(this.Uda);return M?A.DOMElementExtensions.isVisible(M):!1}get Mva(){return this.$.isEditMode&&k.EwaSettings.ma(135)?!(new z.a(this.$.xa)).ii:!1}get mHg(){return this.QCc}get Uda(){return this.Nka?this.gridView.hb.jj(this.wO):1}dispose(){this.gridView&&(this.gridView.ha.qR(this.zg),
this.gridView.view.Oq(this.mt),this.gridView.Wb&&this.gridView.Wb.Gk(this.Lh));if(this.$){const M=this.$;M.Cl(this.Zc);M.Bl(this.Dc);M.AD(this.Wi);G.g(M).qy(this.YQ)}this.Qg&&this.Qg.Oqc(this.Sxa);m.a.Ia(this.Vh);this.Qg=this.$=this.gridView=this.rnb=this.Vh=null;super.dispose()}Sx(){this.Vh.hide()}Nca(){this.Vh?this.Vh.getButton(this.Uda).Zab():l.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}tfj(){this.vR=null}lIf(){this.Vh&&this.Vh.hide()}zZh(){if(!this.Zfd||
1!==this.selectedRange.width)return null;const M=this.selectedRange.clone();for(;this.gridView.p4(M);){M.left+=1;M.right+=1;if(!this.gridView.Lf(this.gridView.hb.jj(M)).lh.Fe(M))break;if(!this.gridView.Ea.Qr(M))continue;const L=this.gridView.kk("PulloutManager.GetValidatedRangeToFill",M,2);try{if(N.GUj(L))return M}finally{L&&L.dispose()}}return null}Wrc(){this.Qg.abb()}showCallout(){this.Mva&&(this.Qg.A5a?(this.Vh.getButton(this.Uda).tFb(),k.EwaSettings.fl()?e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ta(this.$.da,
8,9,0),M=>{this.Q1f(M.result)},this.$.la,3):this.Q1f(this.contextMenuManager)):(this.pXc=!0,this.JY()))}Q1f(M){M.Mbd("tableFieldList").Y_(null,this.Vh.domElement(this.Uda),this.Qg,null,!0);this.Wrc()}KRe(){if(!this.Mva||!this.gridView||this.gridView.ha.Oa.$b||!this.gridView.ha.sa.xg)return null;var M=this.gridView.ha.sa.activeCell,L=G.g(this.$).hb.jj(M);if(!M)return null;this.KEa=M.clone();var U=this.tableManager.Fm(M);this.SJc=!!U;if(this.$M){this.Vh.ENb(K.a.instance.ga(1733),L);this.wO=N.reg(U);
if(!this.wO)return null;M=!1;L=({NX:M}=this.tableManager.hBe(U,this.gridView)).returnValue||M;this.QCc=M;if(L)return this.ntc=new r.Range(U.top,U.left,U.bottom,U.right,!1,!1),this.eMc=new r.Range(this.wO.top,this.wO.right+1,this.wO.top,this.wO.right+1,!1,!1),this.wO}else if(this.Zfd){this.Vh.ENb(K.a.instance.ga(1734),L);this.FWa=this.gridView.ha.sa.Wc.clone();U=G.g(this.$).Db.wwa(this.selectedRange);(L=this.selectedRange.isSingle&&G.g(this.$).Db.nbf(this.selectedRange))&&!this.jBb&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&
F.a.equals(v.AFrameworkApplication.uiCulture,"en-us",!0)&&(v.AFrameworkApplication.zF("XLS-DateSuggestion-Treatment;XLS-DateSuggestion-Control"),this.jBb=!0);this.wO=N.reg(this.selectedRange);if(!(this.lec&&L||U)||!this.wO||!this.selectedRange)return null;this.lec&&(this.aJc=L&&!U);if(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.Sia(this.selectedRange))return null;this.eMc=this.zZh();if((k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.p4(this.selectedRange):this.gridView.p4(this.wO))&&this.Nka)return this.ntc=this.wO,l.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.Nka?this.Nka.toString():"null"}, RightColumnHeader, ${this.wO?this.wO.toString():"null"}, ActiveCell, ${M?M.toString():"null"}`),this.wO}return null}JY(){this.$M?this.Qg.JY(x.v(this.Nka,this.$),!1,!0):this.lec&&this.aJc?this.Qg.$Xi():k.EwaSettings.ma(135)&&this.Qg.JY(x.v(this.selectedRange,this.$),!0,!1)}T5a(){return this.$.ea.isNamedObjectViewMode&&
u.f(this.$.oa)}static GUj(M){for(;M.$$mn();)if(M.$$cu().text||M.$$cu().GH||M.$$cu().Ei||M.Jn.F5e)return!1;return!0}static reg(M){return M.right===w.a.Ch?null:new r.Range(M.top,M.right,M.top,M.right,!1,!1)}}Object(t.a)(N,"PulloutManager",n.a,[382,3]);class J extends d.a{constructor(M){super();this.$=M;this.Fb()}create(){c.a.Fa(M=>{const L=f.GetServiceTaskFactory.Ta(M.da,12,477,this.ib),U=f.GetServiceTaskFactory.Ta(M.da,66,134,this.ib),X=f.GetServiceTaskFactory.Ta(M.da,211,212,this.ib);let da=b.a.Ua(null);
const fa=!k.EwaSettings.fl();fa&&(da=f.GetServiceTaskFactory.Ta(M.da,8,9,this.ib));e.TaskExtensions.Aa(e.TaskExtensions.Xd([L,U,da,X],M.la),()=>{fa?this.qb(this.$.da.za(261)||new N(this.$,L.result,U.result,da.result,X.result)):this.qb(this.$.da.za(261)||new N(this.$,L.result,U.result,null,X.result))},M.la)})}static ka(M){M.da.Ga(262,new J(M))}}Object(t.a)(J,"PulloutManagerFactory",d.a,[]);a.d(D,"a",function(){return R});const R=()=>{c.a.Fa(M=>{M.ma(135)&&J.ka(M)})}},1228:function(t,D,a){t=a(0);var c=
a(184);class b{rGj(r,u){r.set_visible(!1);u.set_visible(!0)}}Object(t.a)(b,"DefaultTabSwitchBehaviour",null,[349]);class d{}d.eHj="TabsContainer";d.OGj="TabTitlesContainer";d.MGj="TabTitle";d.NGj="TabTitleText";d.GTd="TabTitleActive";Object(t.a)(d,"MultitabControlStyles",null,[]);var f=a(83),e=a(44),k=a(85),l=a(88),m=a(56);class v{constructor(r,u,x){this.fk=r;this.Cp=u;this.yEc=x;this.Rea=document.createElement("a");m.a.tuc(this.Rea,this.Cp);Sys.UI.DomElement.addCssClass(this.Rea,d.NGj);Sys.UI.DomElement.addCssClass(this.fk,
d.MGj);this.fk.appendChild(this.Rea);this.Rea.tabIndex=0;this.Jzc();e.a.addHandler(this.fk,"click",this.yEc);e.a.addHandler(this.fk,"keyup",Object(f.a)(this,this.u9a,"onTitleKeyUp"))}get lc(){return this.fk}get title(){return this.Cp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.fk,d.GTd)}set isActive(r){this.setActive(r)}dispose(){e.a.removeHandler(this.fk,"keyup",Object(f.a)(this,this.u9a,"onTitleKeyUp"));e.a.removeHandler(this.fk,"click",this.yEc);this.fk=this.Rea=null}setActive(r){r?
Sys.UI.DomElement.addCssClass(this.fk,d.GTd):Sys.UI.DomElement.removeCssClass(this.fk,d.GTd);this.Rea&&this.Rea.setAttribute(l.a.oga,r)}u9a(r){r.keyCode!==k.a.Zh&&r.keyCode!==k.a.boa||this.yEc(r)}Jzc(){this.fk.setAttribute(l.a.Kd,l.a.Qs);this.Rea.setAttribute(l.a.Nt,this.Cp);this.Rea.setAttribute(l.a.Kd,l.a.jnb)}}Object(t.a)(v,"TabTitleControl",null,[3]);var n=a(39);a.d(D,"a",function(){return w});class w{constructor(r,u=null,x=null){this.Skb=this.$kb=null;this.A0=-1;this.fk=r;this.Efa=u||new c.a;
this.swg=x||new b;this.mEa=new c.a;r=0;for(let z of this.Efa)this.Spd(this.A0)||(this.A0=r),u=r++,this.mEa.add(new v(document.createElement("li"),z.title,this.s5g(u)))}get Nxc(){return this.Efa.count}get activeTab(){return this.A0}set activeTab(r){this.T6f(r)}get lc(){return this.fk}get visible(){return n.a.isVisible(this.fk)}set visible(r){this.fk.style.visibility=r?"visible":"hidden"}bQf(){this.$kb=document.createElement("ul");this.$kb.className=d.OGj;this.Skb=document.createElement("div");this.Skb.className=
d.eHj;for(let r=0;r<this.Nxc;++r){const u=this.Efa.na(r),x=this.mEa.na(r);u.set_visible(!1);x.isActive=!1;const z=document.createElement("div");u.render(z);this.Skb.appendChild(z);this.$kb.appendChild(x.lc)}this.lc.appendChild(this.$kb);this.lc.appendChild(this.Skb);this.Spd(this.A0)&&(this.mEa.na(this.A0).isActive=!0,this.Efa.na(this.A0).set_visible(!0))}dispose(){for(let r=0;r<this.Nxc;++r)this.Efa.na(r).dispose(),this.mEa.na(r).dispose();this.mEa=this.Efa=this.fk=this.Skb=this.$kb=null}setFocus(){this.Efa.na(this.A0).setFocus()}Spd(r){return 0<=
r&&r<this.Nxc}T6f(r){this.A0!==r&&this.Spd(r)&&(this.swg.rGj(this.Efa.na(this.A0),this.Efa.na(r)),this.mEa.na(this.A0).isActive=!1,this.mEa.na(r).isActive=!0,this.A0=r,this.setFocus())}s5g(r){return()=>{this.T6f(r)}}}Object(t.a)(w,"MultitabControl",null,[322,3])},1240:function(t,D,a){var c=a(10);t=a(0);var b=a(7),d=a(220),f=a(50),e=a(37);class k{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(t.a)(k,"FormulaAssistanceUIContext",null,[]);var l=a(195);class m extends d.a{constructor(n){super();
this.akj="formulaAssistance";this.$=n;this.Fb()}create(){let n=this.$.da.za(448);if(n)this.qb(n);else{var w=f.GetServiceTaskFactory.Ta(this.$.da,283,284,this.ib);e.TaskExtensions.Aa(w,()=>{e.TaskExtensions.Aa(l.c(w.result.$n.loadScript(this.akj)),()=>{n=this.$.da.za(448);if(!n){const r=Object(b.a)(new k,{isFeedbackAllowed:this.$.isFeedbackEnabled});n=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(r));this.$.Hwe(()=>{const u={};u.isFeedbackAllowed=this.$.isFeedbackEnabled;
n.updateContext(u)})}this.qb(n)},this.$.la,3)},this.$.la,3)}}static ka(n){n.da.Ga(449,new m(n))}}Object(t.a)(m,"FormulaAssistanceUIControlFactory",d.a,[]);a.d(D,"a",function(){return v});const v=()=>{c.a.Fa(n=>{m.ka(n)})}},1241:function(t,D,a){var c=a(10);t=a(0);var b=a(220),d=a(50),f=a(37),e=a(21),k=a(15),l=a(30),m=a(211),v=a(24),n=a(64),w=a(1),r=a(1082),u=a(11);class x{constructor(y,A){this.wMa=1;this.Rfa=[];this.active=!1;this.Bw=()=>{const K=this.gridView.rfd();if(!(0>=K||K===this.wMa||this.gridView.Xp)){var G=
!1,T=[],W=[];for(var P=this.Rfa.length-1;0<=P;P--){var E=this.Rfa[P];if(this.qfd(E)>K||E.bottom<K)T.push(E),this.Rfa.splice(P,1),G=!0}for(P=this.tableManager.rangeList.length-1;0<=P;P--){E=this.tableManager.rangeList[P];var H=this.qfd(E);H<=K&&E.bottom>=K&&!(H<=this.wMa&&E.bottom>=this.wMa)&&E.qaa&&(W.push(E),G=!0)}if(G){E=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.gridView.Cnc:[this.gridView.ZX];for(let N of E)for(let J of N)for(let R of J){P=
R.Sn;H=r.a(R.G3);for(var F=T.length-1;0<=F;F--)E=T[F],this.Cyc(E,!1,H,P)&&T.splice(F,1);for(F=W.length-1;0<=F;F--)E=W[F],this.Cyc(E,!0,H,P)&&this.Rfa.push(E);G&&R.tNd(H)}}else k.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.wMa=K}};this.dxf=(K,G)=>{G.isRow||G.XTc(this.lKa)};this.exf=(K,G)=>{G.isRow||(this.tableManager.rangeList.length||this.deactivate(),G.vId(this.lKa))};this.lKa=(K,G)=>{if(this.Wd())this.activate();else if(K=
this.active,this.deactivate(),!K){k.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(G=G.du)&&this.d4f(G.Sn[0],G.Sn[G.Sn.length-1],G.G3,G.Sn)};this.Qzf=(K,G)=>{!this.gridView.Xp&&(this.Wd()?this.activate():(K=this.active,this.deactivate(),K||k.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),G=G.du)&&(K=r.a(G.G3),this.d4f(G.Sn[0],G.Sn[G.Sn.length-
1],K,G.Sn)&&G.tNd(K))};this.re=()=>{this.gridView.hb.D3?this.deactivate():this.activate()};this.tableManager=y;this.gridView=A;this.$=A.$;y.Gme(this.Qzf);A.sEg(this.dxf);A.tEg(this.exf);this.$.xa.Pf(this.re);this.$.yb.Pf(this.re);this.fqe(K=>{K.XTc(this.lKa)});this.Wd()&&(this.activate(),this.Bw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.GPf(this.Qzf),this.gridView.Aaj(this.dxf),this.gridView.Baj(this.exf),this.$.xa.Ag(this.re),this.$.yb.Ag(this.re),
this.fqe(y=>{y.vId(this.lKa)}));this.gridView=this.tableManager=this.Rfa=null}Cyc(y,A,K,G){if(!n.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.hb.GSa)return!0;if(!K.length)return!1;var T=G.length;if(G[T-1]<y.left)return!1;var W=u.HelperMethods.qx(new m.a(G),0,T,y.left,u.HelperMethods.iD);if(0>W)return!1;const P=y.J8f,E=!!y.wZa&&0<y.wZa.length,H=!!y.menuModel&&0<y.menuModel.length;for(let N=W,J=0,R=Math.min(P.length+W,T);N<R;N++,J++)if(T=K[N],!w.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||
T){W=null;var F=T.getElementsByClassName(l.a.q8c);F&&(W=F[0]);if(W&&W.innerText){if(F=T.getElementsByClassName(l.a.Pne))for(let M=F.length-1;0<=M;M--)T.removeChild(F[M]);F=G[N];A?(W.innerText=P[J],T.classList.add(l.a.VOe),E&&y.wZa[J]&&(W=document.createElement("div"),W.innerHTML=y.wZa[J],H&&y.menuModel[J]&&this.aBg(y,J,F),T.appendChild(W.firstChild))):(T.classList.remove(l.a.VOe),W.textContent=v.Range.uP(F),this.shh(F))}}y.MRa=A;return!0}aBg(y,A,K){this.$.da.Za(8,G=>{G.R7b.JLi(y,A,K)})}shh(y){this.$.da.Za(8,
A=>{A.R7b.KLi(y)})}d4f(y,A,K,G){let T=!1;const W=this.$Yh(y,A);for(let P=this.Rfa.length-1;0<=P;P--){const E=this.Rfa[P];A>=E.left&&y<=E.right&&(this.Cyc(E,!1,K,G),this.Rfa.splice(P,1),T=!0)}for(let P=0,E=W.length;P<E;P++)this.Cyc(W[P],!0,K,G)&&(this.Rfa.push(W[P]),T=!0);return T}activate(){this.Wd()&&!this.active&&(this.gridView.view.Ns(this.Bw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Oq(this.Bw),this.active=!1)}Wd(){return n.b(this.$.oa)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.hb.wL&&0<this.tableManager.rangeList.length}fqe(y){const A=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.gridView.Cnc:[this.gridView.ZX];for(let K of A)for(let G of K)for(let T of G)y(T)}$Yh(y,A){const K=[];if(!this.active)return K;this.wMa=this.gridView.rfd();for(let G=this.tableManager.rangeList.length-1;0<=G;G--){const T=this.tableManager.rangeList[G];T.bottom>=this.wMa&&this.qfd(T)<=this.wMa&&T.left>=y&&T.right<=A&&T.qaa&&
K.push(T)}return K}qfd(y){const A=this.gridView.Db.Xj(y);return A&&this.tableManager.Dcf(y,A.usedRange.topLeft)?y.top+1:y.top}}Object(t.a)(x,"HeaderSnappingFeature",null,[3]);class z extends b.a{constructor(y){super();this.$=y;this.Fb()}create(){const y=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ib);f.TaskExtensions.Aa(f.TaskExtensions.Xd([y],this.la),()=>{this.qb(this.$.da.za(68)||new x(y.result,e.g(this.$)))},this.la,11)}static ka(y){y.da.Ga(67,new z(y))}}Object(t.a)(z,"HeaderSnappingFactory",
b.a,[]);a.d(D,"a",function(){return B});const B=()=>{c.a.Fa(z.ka)}},1266:function(t,D,a){var c=a(10);t=a(0);var b=a(15),d=a(871),f=a(27),e=a(193),k=a(220),l=a(224),m=a(1),v=a(51),n=a(55),w=a(195),r=a(36);class u{constructor(){this._list={}}addHandler(A,K){var G;this._list[A]=[...(null!==(G=this._list[A])&&void 0!==G?G:[]),K]}removeHandler(A,K){const G=this._list[A];void 0!==G&&(K=G.indexOf(K),0<=K&&(this._list[A]=[...G.slice(0,K),...G.slice(K+1)]))}getHandler(A){const K=this._list[A];return K&&0!==
K.length?(G,T)=>{for(const W of K)W(G,T)}:null}static OHb(){Sys.EventHandlerList.prototype.addHandler=u.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=u.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=u.prototype.removeHandler}}Object(t.a)(u,"EventHandlerListOptimized",null,[]);class x{constructor(){this._list={}}addHandler(A,K){this.invalidate(A);void 0===this._list[A]?this._list[A]=[K]:this._list[A].push(K)}invalidate(A){void 0!==this.nA&&this.nA.delete(A)}removeHandler(A,
K){const G=this._list[A];void 0!==G&&0!==G.length&&(K=G.indexOf(K),0<=K&&(this.invalidate(A),G.splice(K,1)))}getHandler(A){void 0===this.nA&&(this.nA=new Map);var K=this.nA.get(A);return void 0===K?(K=this.makeHandler(A),this.nA.set(A,K),K):K}makeHandler(A){A=this._list[A];if(!A||0===A.length)return null;const K=[...A];return(G,T)=>{for(let W=0;W<K.length;++W)K[W](G,T)}}static OHb(){Sys.EventHandlerList.prototype.addHandler=x.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=x.prototype.getHandler;
Sys.EventHandlerList.prototype.removeHandler=x.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=x.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=x.prototype.invalidate}}Object(t.a)(x,"EventHandlerListMemoized",null,[]);class z{constructor(A){this.a=A;this.preventDefault=z.fEf.preventDefault;this.stopPropagation=z.fEf.stopPropagation;const K=this.type=A.type.toLowerCase();this.rawEvent=A;this.altKey=A.altKey;"undefined"!==typeof A.button&&(this.button="undefined"!==
typeof A.which?A.button:4===A.button?Sys.UI.MouseButton.middleButton:2===A.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===K?this.charCode=A.charCode||A.keyCode:this.keyCode=A.keyCode&&46===A.keyCode?127:A.keyCode;this.clientX=A.clientX;this.clientY=A.clientY;this.ctrlKey=A.ctrlKey;this.target=A.target?A.target:A.srcElement;this.screenX=A.screenX;this.screenY=A.screenY;this.shiftKey=A.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;
if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const A=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-A.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const A=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||
0)+this.clientY-A.y}}}static OHb(){Sys.UI.DomEvent=z;z.registerClass("Sys.UI.DomEvent",void 0,void 0)}}z.addHandler=Sys.UI.DomEvent.addHandler;z.addHandlers=Sys.UI.DomEvent.addHandlers;z.removeHandler=Sys.UI.DomEvent.removeHandler;z.clearHandlers=Sys.UI.DomEvent.clearHandlers;z._removeHandler=Sys.UI.DomEvent._removeHandler;z._clearHandlers=Sys.UI.DomEvent._clearHandlers;z._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;z.fEf=Sys.UI.DomEvent.prototype;z.registerClass=function(A,K,G){this.prototype.constructor=
this;this.__typeName=A;this.__class=!0;K&&(this.__baseType=K,this.__basePrototypePending=!0);Sys.__upperCaseTypes[A.toUpperCase()]=this;if(G){this.__interfaces=[];for(let T=2,W=arguments.length;T<W;T++)this.__interfaces.push(arguments[T])}return this};Object(t.a)(z,"DomEventLazy",null,[392]);class B extends k.a{constructor(A){super();this.$2b=null;this.$=A;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");d.a.then(this.X7g(),A=>{this.qb(A)})}X7g(){if(this.$2b)return this.$2b;
const A=l.a.a0a(v.b(),e.a.none,"LoadResource","x10Scheduler loading");if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var K=String.prototype;if(void 0===K.startsWithOriginal||void 0===K.endsWithOriginal)if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const G=document.createElement("frame");document.body.appendChild(G);const T=G.contentWindow.String.prototype;document.body.removeChild(G);K.startsWithOriginal=
T.startsWith;K.endsWithOriginal=T.endsWith}else K.startsWithOriginal=function(G,T=0){return this.lastIndexOf(G,T)===T},K.endsWithOriginal=function(G){return-1!==this.indexOf(G,this.length-G.length)};K.startsWith=K.startsWithOriginal;K.endsWith=K.endsWithOriginal}m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&u.OHb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&x.OHb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",
!1)&&z.OHb();if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.lv)return K=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,K),A.setResult(K),this.$2b=A.task;this.$.da.Za(266,G=>{m.EwaSettings.isChangeGateEnabled("OfficeVSO:6600721_doGracefullyFallIfTryToLoadSchedulerWithoutCalc")&&!G.Tdc?(b.ULS.sendTraceTag(520901762,0,15,"PluginSchedulerFactory.createPluginSchedulerAsync: Calc is not initialized, pluginScheduler creation canceled"),A.rs()):
this.$.da.Za(283,T=>{const W=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();T=w.b(n.Task.Ua(T.$n));(m.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed")?Promise.all([excelOnlineCalc.x10.ensureGroupAttached(T,0),r.a.HLg(this.$)?excelOnlineCalc.x10.ensureGroupAttached(T,2):Promise.resolve(0)]).then(P=>P.some(E=>0<E)):excelOnlineCalc.x10.ensureAllPluginsAttached(T)).then(P=>{this.$.da.Ga(413,W);A.setResult(W);m.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",
0)&&this.$.da.Za(491,E=>{E.eda.anyPluginInitialized=P})})})});return this.$2b=A.task}static ka(A){A.da.Ga(414,new B(A))}}Object(t.a)(B,"PluginSchedulerFactory",k.a,[]);a.d(D,"a",function(){return y});const y=()=>{c.a.Fa(A=>{B.ka(A)})}},1429:function(t,D,a){a.r(D);var c=a(1073),b=a(0),d=a(690),f=a(15),e=a(176),k=a(62);const l=(wb,dc,Jc,Qc,fd,Wc,Rb,Sb,mc,ec)=>{ec=wb.Na(9,ec);ec.selectedRange=dc;ec.activeCell=Jc;ec.autoSumType=Qc;ec.topLeftCell=fd;return k.g(wb,"AutoSum",ec,Wc,Rb,Sb,mc,0)},m=(wb,dc,
Jc,Qc,fd,Wc)=>{if(dc){const Rb=wb.textBox;wb.$a||wb.startEdit(dc,!0);wb.eod=!0;wb.text=Jc;Rb.caretPosition=fd;fd<Wc&&(Qc&&wb.hAa(),Rb.selectRange(0,Wc+1),Rb.selectRange(fd,Wc))}};var v=a(77);class n{constructor(wb,dc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=wb;this.type=dc}E3a(){return this.sharedSheetRange}}Object(b.a)(n,"MacroRecorderAutoSumPayload",null,[116]);var w=a(42),r=a(510),u=a(368),x=a(170),z=a(50),B=a(37),y=a(153),A=a(340),K=a(31),G=a(1),T=a(181),W=a(280),P=a(21),
E=a(125),H=a(559),F=a(55);class N extends e.a{constructor(wb){super();this.etf=dc=>{const Jc=P.g(this.$);if(dc=dc.Result){let Qc=w.D(dc.NewSelection),fd=w.D(dc.NewActiveCell);if(Qc&&fd)if(!dc.Committed&&dc.AutoSumFormula){const Wc=Jc.Xb(fd);Wc&&(Jc.ha.updateSelection(Qc,fd,60),Qc=fd=w.D(dc.MarkedArea),Jc.IJ=2,m(Jc.dc,Wc,dc.AutoSumFormula,!!Qc,dc.FormulaMarkStart,dc.FormulaMarkEnd),Qc&&fd&&Jc.ha.updateSelection(Qc,fd,0),Jc.dc.eod=!1,B.TaskExtensions.Aa(z.GetServiceTaskFactory.create(this.$.da,153,
this.la,0),Rb=>{Rb.result.m1a(null)},this.la,3))}else Jc.ha.updateSelection(Qc,fd,60)}};this.$=wb}Qc(){return!1}executeCommand(wb,dc,Jc){wb=dc.command;switch(wb){case 1220954656:dc=this.nHe(0,dc);break;case -1537138325:dc=this.nHe(parseInt(Jc[v.a.Oc].toString(),10),dc);break;default:dc=T.a(wb)}return dc}Ec(wb,dc){if(wb=1===wb)switch(dc.command){case 1220954656:case -1537138325:break;default:wb=!1}return wb}Vc(){return!1}nHe(wb,dc){const Jc=P.g(this.$);Jc.Cf.UG(!1);if(!P.g(this.$).ha.sa.xg)return dc=
P.g(this.$).ha.sa.BK,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${wb} due to discontinuous selection. Number of selected ranges is ${dc}`),this.xya(),F.Task.Ua(!1);const Qc=Jc.sH();if(!Qc)return null;const fd=w.v(Jc.ha.sa.Wc,this.$),Wc=w.o(Jc.ha.sa.activeCell,this.$),Rb=w.o(Qc,this.$),Sb=this.$.pa.va.Qb(),mc=()=>new n(fd,wb);return this.$.oq(Jc.ha.sa.selectedRanges,!0)?G.EwaSettings.fc()?u.a(this.$.userOperationManager,(ec,Rc,Mc)=>l(this.$.pa.va,
fd,Wc,wb,Rb,W.b(ec,this.etf),Rc,Mc,wb,Sb),ec=>new x.a(502,0,ec,64,mc),dc):u.a(this.$.userOperationManager,(ec,Rc,Mc)=>l(this.$.pa.va,fd,Wc,wb,Rb,W.b(ec,this.etf),Rc,Mc,wb,Sb),ec=>new r.a(502,0,ec,void 0,mc),dc):F.Task.Ua(!1)}xya(){H.a(E.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var wb=K.a.Yc(1,1,756,2186,0,371863010,"DiscontinuousSelectionBlocking");G.EwaSettings.xz()?new A.a(this.$,wb):(wb=new y.ErrorDialog(this.$,wb),wb.initialize(),wb.xf())}}Object(b.a)(N,"AutoSumCommandHandler",
e.a,[188]);class J extends d.a{constructor(wb){super(wb)}Dd(){this.ld([new N(this.$)])}static ka(wb){d.a.Rd(96,new J(wb))}}Object(b.a)(J,"AutoSumCommandHandlerFactory",d.a,[]);var R=a(10),M=a(171),L=a(262),U=a(38),X=a(317),da=a(1074),fa=a(281),S=a(74);class ka extends U.a{constructor(wb,dc,Jc){super();this.CGi=(Qc,fd)=>{if(!fa.a(Qc)&&fd){const Wc=!!Qc&&!!Qc.RequestTelemetryData;P.g(this.$).Ci.Cka(fd.toString(),Qc.StateId,Wc?Qc.RequestTelemetryData.EcsOperationDuration:0,Wc?Qc.RequestTelemetryData.EcsRequestDuration:
0,Wc?Qc.RequestTelemetryData.WfeRequestDuration:0)}};this.$=wb;this.tableManager=dc;this.ug=Jc}vDg(wb){this.addHandler("ekcvc",wb)}L$i(wb){this.removeHandler("ekcvc",wb)}Qc(){return!1}executeCommand(wb,dc){wb=dc.command;switch(wb){case -730106152:dc=this.ggd(dc,3);break;case -1228228458:dc=this.ggd(dc,4);break;case -848953656:case 2045211913:if(this.Nji()){dc=F.Task.Ua(!0);break}dc=this.ggd(dc,1);break;default:dc=T.a(wb)}return dc}Ec(wb,dc){if(wb=1===wb)switch(dc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;
default:wb=!1}return wb}Vc(){return!1}ggd(wb,dc){var Jc=P.g(this.$);const Qc=Jc.ha.sa.selectedRanges,fd=wb.command,Wc=M.a.create().toString();if(!this.$.oq(Qc,!0)&&-730106152!==fd)return F.Task.Ua(!0);const Rb=w.r(Qc,this.$);this.Fzj(fd,Jc,Qc,Wc);G.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.h2i();const Sb=this.$.pa.va.Qb({MZ:!0,bZ:1});Jc=(ec,Rc,Mc)=>{this.$.sy();return k.d(this.$.pa.va,dc,Rb,!1,W.b(ec,this.CGi),Rc,Mc,Wc,Sb)};const mc=()=>new da.a(dc,
Rb);return G.EwaSettings.fc()?u.a(this.$.userOperationManager,Jc,ec=>new x.a(508,0,ec,67,mc),wb):u.a(this.$.userOperationManager,Jc,ec=>new r.a(508,0,ec,3,mc),wb)}Fzj(wb,dc,Jc,Qc){if(-848953656!==wb&&2045211913!==wb&&-730106152!==wb&&-1228228458!==wb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${wb}.`);else if(!L.a.any(Jc,Wc=>0<dc.getRangeInformation(Wc).length)){var fd=L.a.any(Jc,Wc=>this.tableManager.upd(Wc));if(-730106152!==wb&&-1228228458!==
wb||!fd)this.wDj(dc,wb,Qc,Jc),-730106152!==wb&&-1228228458!==wb||this.ug.nda(dc,-730106152,{}),-1228228458!==wb&&2045211913!==wb&&-848953656!==wb||this.ug.AXg(Jc,Qc),dc.Ci.a0(Qc,S.BasicTelemetryCalculator.uQ)}}wDj(wb,dc,Jc,Qc){let fd="";switch(dc){case -1228228458:fd="ClearAll";break;case 2045211913:case -848953656:fd="ClearContent";break;case -730106152:fd="ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${dc}.`)}dc=
Qc.length;Qc=w.b(Qc);wb.Ci.O6(15,Jc,fd+(", ranges to clear: "+dc+", cells to clear: "+Qc))}h2i(){this.raiseEvent("ekcvc",new X.a)}Nji(){if(P.g(this.$).qz){const wb=this.$.da.za(296);return!!wb&&wb.eU.mB}return!1}}Object(b.a)(ka,"ClearCommandHandler",U.a,[188,413]);class V extends d.a{constructor(wb){super(wb)}Dd(){const wb=z.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ib),dc=z.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ib);B.TaskExtensions.Aa(B.TaskExtensions.Xd([wb,dc],this.la),
()=>{const Jc=new ka(this.$,wb.result,dc.result);this.ld([Jc]);this.$.da.Ga(313,Jc)},this.la,3)}static ka(wb){d.a.Rd(101,new V(wb))}}Object(b.a)(V,"ClearCommandHandlerFactory",d.a,[]);var wa=a(1216),ma=a(1075),ab=a(1130),ba=a(1077),Ca=a(1078),Na=a(1141),za=a(86),la=a(220),aa=a(4),sa=a(106),ea=a(44),Z=a(11),ua=a(83),ya=a(144);class ha{}ha.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(ha,"FileUploadDialogHTML",null,[]);var Da=a(151),nb=a(25);class qa extends ya.a{constructor(wb){super(!1,!1,qa.zu);this.Jtd=!1;this.snf=!0;this.Cmf=0;this.Sb=1;this.sc(1,CommonUIStrings.l_Send);this.sc(0,CommonUIStrings.l_NoThanks);this.ag=ha.HTML;this.vmf=wb;this.Ae=qa.ZRg}nj(wb,dc,Jc,Qc=!1,fd=!0){this.Jtd=Qc;this.Qyj(dc);this.Cmf=wb;fd&&aa.AFrameworkApplication.UF(wb)}Qyj(wb){if(qa.zu)this.wAj(wb);else{var dc={};dc[qa.VRg]=wb;dc[qa.aSg]=CommonUIStrings.l_SendFileErrorReportMessage;dc[qa.bSg]=
CommonUIStrings.l_SendFileErrorReportTextCaption;dc[qa.CXc]="";dc[qa.YRg]=CommonUIStrings.l_UserReportLinkText;dc[qa.B_b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ua.a)(this,this.Nqi,"legacyDialogHandler"),dc);this.hW(qa.gSg)}}wAj(wb){wb={["id"]:this.Ae,["bodyControls"]:{["reportErrorCheckboxProps"]:this.Jtd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.snf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:aa.AFrameworkApplication.Rla,["target"]:"_blank"}}},["errorMessage"]:wb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ua.a)(this,this.hFd,"reactDialogHandler"),wb)}Z8a(){if(!qa.zu){var wb=document.getElementById(qa.dSg);wb&&(wb.className=qa.cSg,wb.appendChild(Da.createClusteredImage(32,32,qa.$Rg,null,!0,CommonUIStrings.l_DialogError)));
if(wb=document.getElementById(qa.eSg))wb.innerText=CommonUIStrings.l_PrivacyStatement,wb.href=aa.AFrameworkApplication.Rla,ea.a.addHandler(wb,"click",Object(ua.a)(this,this.UOi,"onPrivacyClickHandler"));this.snf||(wb=document.getElementById(qa.CXc))&&wb.parentNode&&wb.parentNode.removeChild(wb);this.Jtd||(wb=document.getElementById(qa.XRg))&&wb.parentNode&&wb.parentNode.removeChild(wb)}}tI(){qa.zu||(super.tI(),document.getElementById(this.ei("WACDialogPanel")).style.width=String.format("{0}px",400))}Nqi(wb,
dc){const Jc=dc[qa.CXc]||"";let Qc=!0;void 0!==dc[qa.B_b]&&null!==dc[qa.B_b]&&(Qc=dc[qa.B_b]);this.gw(wb,Jc,Qc)}hFd(wb,dc){this.gw(wb,dc.text||"",dc.reportErrorChecked)}gw(wb,dc,Jc){this.vmf&&(Jc&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Cmf),this.vmf(wb,dc,Jc))}UOi(wb){aa.AFrameworkApplication.wb.ae(nb.a.XFb,2,wb)}get RX(){return!1}static get zu(){return aa.AFrameworkApplication.ta.Pa.nv&&aa.AFrameworkApplication.ta.Pa.mki}}qa.VRg="WACDialogErrorMessage";qa.aSg=
"WACDialogErrorReportMessage";qa.bSg="WACDialogErrorTextPrompt";qa.CXc="WACDialogInput";qa.eSg="WACDialogPrivacyText";qa.dSg="WACDialogIconPanel";qa.$Rg="CancelRequest_32x32x32";qa.cSg="WACDialogIcon";qa.gSg="WACDialogTextPanel";qa.B_b="WACDialogSendFileCheckbox";qa.XRg="WACDialogSendFileCheckboxContainer";qa.YRg="WACDialogSendFileCheckboxText";qa.ZRg="FileUploadErrorDialog";Object(b.a)(qa,"FileUploadErrorDialog",ya.a,[]);class pa extends U.a{constructor(wb){super();this.CHf=0;this.cH=null;this.F9i=
dc=>{this.U$i(dc)};this.SYg=(dc,Jc)=>{if(1===dc&&this.cH.FileCollectionErrorStateId){dc=this.$.pa.va;var Qc=this.cH.MessageId,fd=this.cH.OriginalEcsServerId,Wc=this.cH.FileCollectionErrorStateId;const Rb=dc.Na(0);Rb.errorMessageId=Qc;Rb.ecsServerId=fd;Rb.fileCollectionErrorStateId=Wc;Rb.userComment=Jc;dc.UXc("CollectFile",Rb,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=wb}GDg(wb){this.addHandler("fileCollectionComplete",wb)}U$i(wb){this.removeHandler("fileCollectionComplete",
wb)}RYg(wb,dc,Jc){this.CHf=dc;this.cH=wb;this.GDg(Jc);aa.AFrameworkApplication.Rla=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;wb=new qa(this.SYg);aa.AFrameworkApplication.wb.Ob(nb.a.XFb,sa.a.frame,pa.U_i);wb.nj(0,"",null,!1,!1)}static U_i(wb,dc,Jc,Qc,fd){ea.a.Qt(fd);aa.AFrameworkApplication.Rla&&Z.HelperMethods.Ve(aa.AFrameworkApplication.Rla,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(pa,"FileCollectionOperation",U.a,[412,3]);class Ja extends la.a{constructor(wb){super();
this.YQb=null;this.$=wb;this.Fb()}get Xxh(){return this.YQb||(this.YQb=new pa(this.$))}create(){B.TaskExtensions.Aa(z.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ib),()=>{this.qb(this.Xxh)},this.la,3)}dispose(){za.a.Ia(this.YQb);this.YQb=null;super.dispose()}static ka(wb){wb.da.Ga(125,new Ja(wb))}}Object(b.a)(Ja,"FileCollectionCommandHandlerFactory",la.a,[]);var $a=a(1146),rb=a(1080),Pa=a(1240),eb=a(7),Ob=a(640);class tb{}Object(b.a)(tb,"FreezePanesCommandParameters",null,[]);var cc=a(8),
Ib=a(180),Mb=a(24),Oa=a(384),Aa=a(28),Ba=a(267),ob=a(269),xb=a(116);const Va=(wb,dc,Jc,Qc,fd,Wc,Rb=null)=>{Rb=wb.Na(9,Rb);Rb.freezeSettings=dc;return k.g(wb,"FreezeOrUnfreezePanes",Rb,Jc,Qc,fd,Wc,0)};class bb{constructor(wb){this.freezeOptions=null;this.freezeOptions=wb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(bb,"MacroRecorderSheetPaneFrozenPayload",null,[116]);var ra=a(43);class Qa{constructor(wb,dc){this.R8b=this.lEd=null;this.mwf=()=>{G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Yrc();if(this.R8b){const Jc=Ba.a(Aa.a.Wa.je,this.R8b);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Jc}`);this.R8b=null}this.XDf()};this.$=wb;this.gridView=P.g(wb);this.eD=dc.Bqb(this.$.domElement,500,null,null);this.ZJa=this.YJa=-1}Qc(wb,dc){let Jc=!1;switch(dc){case 1844679312:Jc=1!==wb&&!this.gridView.hb.D3}return Jc}executeCommand(wb,dc){wb=this.gridView.hb;const Jc=this.gridView.Hfd();
aa.AFrameworkApplication.ta.Pa.sw&&this.$.wZ&&(1844679312===dc.command||340334732===dc.command||-806625837===dc.command)&&Ob.ShyRibbon.pJ(1,2);switch(dc.command){case 1844679312:return this.setFreezePanes(dc,Jc,wb.Ti);case 340334732:return wb.k8b?F.Task.Ua(!1):this.Rpj(dc,Jc);case -806625837:return wb.GSa?F.Task.Ua(!1):this.Spj(dc,Jc)}return F.Task.Ua(!1)}Ec(wb,dc){wb=!1;switch(dc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:wb=!0}return wb}Vc(){return!1}setFreezePanes(wb,
dc,Jc){if(Jc)return this.Gtc(wb,!1,0,0,0,0,dc,null);var Qc=this.gridView.ha.sa;Jc=Qc.activeCell.clone();Qc=Qc.activeRange;Qc.Ze&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Jc.top}) and firstUnfreezeCell.Bottom (${Jc.bottom}) to equal topLeftRange.Top (${dc.top})`),Jc.top=Jc.bottom=dc.top);Qc.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Jc.left}) and firstUnfreezeCell.Right (${Jc.right}) to equal topLeftRange.Left (${dc.left})`),
Jc.left=Jc.right=dc.left);Jc.top===dc.top&&Jc.left===dc.left&&(Jc=Mb.Range.Tc(Jc.top+1,Jc.left));Qc=Jc.top-1;const fd=Jc.left-1,Wc=Qc-(dc.top-1),Rb=fd-(dc.left-1);return this.SUj(Jc,Wc,Rb)?this.Gtc(wb,!0,Qc,fd,Wc,Rb,dc,Jc):(this.$.pf(),this.XDf(),F.Task.Ua(!0))}Rpj(wb,dc){return this.Gtc(wb,!0,0,dc.left,0,1,dc,null)}Spj(wb,dc){return this.Gtc(wb,!0,dc.top,0,1,0,dc,null)}SUj(wb,dc,Jc){const Qc=this.gridView.lg(wb),fd=this.gridView.view.visibleArea;return!Qc||fd.topLeft.y>Qc.bottomRight.y||fd.topLeft.x>
Qc.bottomRight.x||fd.bottomRight.y<Qc.bottomRight.y||fd.bottomRight.x<Qc.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${wb}, rangeViewportArea=${Qc?Qc.toString():"null"}, visibleArea=${fd.toString()}`),wb=K.a.Yc(1,0,26,1488,0,2105967339,"FreezePaneSelectionNotInViewErr"),G.EwaSettings.xz()?new A.a(this.$,wb):(wb=new y.ErrorDialog(this.$,wb),wb.initialize(),wb.xf()),!1):0>=
dc&&0>=Jc?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),wb=P.g(this.$).rtl?1490:1489,dc=P.g(this.$).rtl?-2131054257:-1953454131,wb=K.a.Yc(1,0,26,wb,0,dc,"FreezePaneA1SelectedErr"),G.EwaSettings.xz()?new A.a(this.$,wb):(wb=new y.ErrorDialog(this.$,wb),wb.initialize(),wb.xf()),!1):!0}Gtc(wb,dc,Jc,Qc,fd,Wc,Rb,Sb){this.lEd=ra.a(this.$).Q8(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.aT(this.mwf);this.eD.TRa();
this.gridView.$Dj(dc?"":"UnsetFreezePane");this.isj(wb,dc,this.gridView.hb);const mc=Object(eb.a)(new tb,{SheetName:this.$.oa.name,Freeze:dc,FrozenRows:fd,FrozenColumns:Wc,FirstRow:Jc,FirstColumn:Qc});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${dc}, FrozenRows=${fd}, FrozenColumns=${Wc}, FirstRow=${Jc}, FirstColumn=${Qc} `);const ec=()=>new bb(mc);this.R8b=Aa.a.Wa.je;return u.a(this.$.userOperationManager,(Rc,Mc,bc)=>{if(G.EwaSettings.ma(60)){var ic=
window.performance;ic.clearMarks();ic.mark("FreezePanes request sent")}ic=this.gridView.Is;G.EwaSettings.isChangeGateEnabled("OfficeVSO:6661123_RequestContentOnFreezePaneOperation")&&ic?(ic=this.hlh(mc,ic,Rb,Sb),this.nLj(ic)):this.$.sy();return Va(this.$.pa.va,mc,Rc,Mc,bc,dc)},Rc=>new x.a(151,0,Rc,void 0,ec),wb)}hlh(wb,dc,Jc,Qc){f.ULS.shipAssertTag(537159580,1,!!dc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!wb.Freeze)return null;const fd=
ob.a();fd.State=1;fd.IsEstimated=!0;let Wc=!1,Rb=!1;const Sb=dc.AU(Mb.Range.Tc(Jc.top,Jc.left));let mc=wb.FrozenRows;var ec=wb.FrozenColumns;1!==wb.FrozenRows||wb.FrozenColumns?wb.FrozenRows||1!==wb.FrozenColumns?(ec=dc.AU(Mb.Range.Tc(wb.FirstRow+1,wb.FirstColumn+1)),dc=dc.AU(Mb.Range.Tc(Jc.top,Jc.left)),fd.Width=ec.tj-Sb.tj,fd.Height=ec.Dj-Sb.Dj,0<wb.FrozenRows&&(fd.AbsoluteTop=ec.Dj,Rb=!0),0<wb.FrozenColumns&&(fd.AbsoluteLeft=ec.tj,Wc=!0),mc=ec.YK-dc.YK,ec=ec.uJ-dc.uJ):(fd.Width=dc.ped(Ib.a.Tc(Jc.top,
Jc.left)),Qc=Mb.Range.Tc(Jc.top,Jc.left+1),fd.AbsoluteLeft=Sb.tj+fd.Width,Wc=!0):(fd.Height=dc.oed(Ib.a.Tc(Jc.top,Jc.left)),Qc=Mb.Range.Tc(Jc.top+1,Jc.left),fd.AbsoluteTop=Sb.Dj+fd.Height,Rb=!0);Rb&&(fd.FirstFrozenRow=Jc.top,fd.FirstScrollableRow=Qc.top);Wc&&(fd.FirstFrozenColumn=Jc.left,fd.FirstScrollableColumn=Qc.left);fd.VisibleRows=mc;fd.VisibleColumns=ec;return fd}nLj(wb){F.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.oa&&this.$.ea&&(this.$.ea.zW(cc.a.ze,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
Oa.b(this.$.oa,wb,-1,void 0,!0))})}isj(wb,dc,Jc){if(!G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(wb.command){case 1844679312:if(dc||-1===this.YJa&&-1===this.ZJa)this.YJa=Jc.mx-Jc.width+this.gridView.scrollLeft,this.ZJa=Jc.nx-Jc.height+this.gridView.scrollTop;break;case 340334732:if(dc||-1===this.YJa)this.YJa=Jc.mx-Jc.width+this.gridView.scrollLeft;break;case -806625837:if(dc||-1===this.ZJa)this.ZJa=Jc.nx-Jc.height+this.gridView.scrollTop}}Yrc(){const wb=
this.gridView.hb;0<wb.width?this.gridView.scrollLeft=xb.a.l_b(this.gridView.domElement,P.g(this.$).rtl,0):-1!==this.YJa&&(this.gridView.scrollLeft=this.YJa,this.YJa=-1);0<wb.height?this.gridView.scrollTop=0:-1!==this.ZJa&&(this.gridView.scrollTop=this.ZJa,this.ZJa=-1)}XDf(){this.eD.ZRa();za.a.Ia(this.lEd);this.lEd=null;this.gridView.NN(this.mwf)}}Object(b.a)(Qa,"FreezePanesCommandHandler",null,[188]);class qb extends d.a{constructor(wb){super(wb)}Dd(){B.TaskExtensions.Aa(z.GetServiceTaskFactory.Ta(this.$.da,
12,477,this.ib),wb=>{this.ld([new Qa(this.$,wb.result)])},this.$.la)}static ka(wb){wb.da.Ga(116,new qb(wb))}}Object(b.a)(qb,"FreezePanesCommandHandlerFactory",d.a,[]);var Wa=a(1158),ta=a(27),ib=a(557),Bb=a(554),Ub=a(29),Ta=a(989),mb=a(1081);a(308);var Qb=a(14),Lb=a(36);class Jb{constructor(wb,dc){this.$=wb;this.fontServiceManager=dc;this.menuId=this.rXc=this.PR=this.$ta=null;this.J$c=0;this.Ozi="+mn-lt";this.Uwi="+mj-lt";this.xJi=()=>{this.YXf()};this.ROi=Jc=>{this.Bef=!0;this.$.kz(Qc=>{Qc.GOa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Jc}`)};this.fei=!!String.fromCodePoint&&!ta.a.iu&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Bef=!1;this.Im=G.EwaSettings.Im();this.gridView=P.g(this.$);(this.Hm=Lb.a.Hm())&&this.fontServiceManager&&(this.fontServiceManager.Iec?this.YXf():this.fontServiceManager.xme(this.xJi))}get themesManager(){this.ix||(this.ix=this.$.da.za(422));return this.ix}YXf(){this.PR=this.fontServiceManager.Exc;this.$ta=
this.fontServiceManager.KBh;this.J$c=2}get Exc(){return this.PR}lUe(wb,dc,Jc,Qc=null){const fd=Object.assign(new ib.a,{Id:"FontDropdownMenu"});fd.MenuSectionList=[];if(this.Im&&this.themesManager){this.themesManager.v9c(Qc);if(null==this.themesManager.qL||this.themesManager.Apd)return fd;Qc=Object.assign(new Bb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Qb.a.instance.ga(1334),ControlList:this.eYh(wb,dc,Jc)});fd.MenuSectionList.push(Qc)}Qc=Object.assign(new Bb.a,{ControlsId:"FontsMenuSectionControl"});
if(this.Im||this.Hm)Qc.Title=Qb.a.instance.ga(1335);Qc.ControlList=this.JNh(wb,dc,Jc);fd.MenuSectionList.push(Qc);return fd}eYh(wb,dc,Jc){var Qc;const fd=[];var Wc=this.gridView.ha.Oa.$b;Wc=5===(null===(Qc=null===Wc||void 0===Wc?void 0:Wc.floatingObject)||void 0===Qc?void 0:Qc.type);let Rb,Sb;this.themesManager.qL?(Rb=this.themesManager.qL.mpf,Sb=this.themesManager.qL.Fnf):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Sb?(Qc=this.KDe(Sb,1,Wc,wb,dc,Jc),fd.push(Qc)):f.ULS.sendTraceTag(520710164,
1,15,"Major Theme Font is Null");null!=Rb?(wb=this.KDe(Rb,2,Wc,wb,dc,Jc),fd.push(wb)):f.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return fd}KDe(wb,dc,Jc,Qc,fd,Wc){var Rb=2===dc?this.Ozi:this.Uwi;Jc=Jc?Rb:Ub.a.ff(wb);Rb=Ub.a.ff(Z.HelperMethods.Cac(wb,dc));wb=Ub.a.ff(wb);return Object.assign(new Ta.a,{MenuItemId:2===dc?mb.b:mb.a,CommandValueId:Jc,LabelText:Rb,LabelCss:String.format("font-size:12pt;font-family:{0};",wb),Styles:Jb.Uub(wb),AriaLabel:Rb,Alt:Rb,Command:Qc.toString(),CommandPreviewId:fd.toString(),
CommandRevertId:Wc.toString()})}JNh(wb,dc,Jc){if(this.rXc)return this.rXc.W3c;const Qc=this.fei&&!this.Bef;let fd=!1;this.$ta||(this.v9e(),fd=!0);let Wc=this.kCe(wb,dc,Jc,this.$ta,Qc,fd);Wc.xvc&&!fd&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.v9e(),Wc=this.kCe(wb,dc,Jc,this.$ta,Qc,Wc.xvc));this.Hm&&!Wc.xvc&&(this.rXc=Wc);Qc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.ROi);return Wc.W3c}kCe(wb,
dc,Jc,Qc,fd,Wc){const Rb=[];let Sb;const mc=this.Hm&&!Wc;Sb=mc?"msofpNew":"msofp";for(let ic in Qc){var ec=ic,Rc=Qc[ic],Mc=Ub.a.ff(ec),bc=void 0;if(mc)if(bc=this.PR?this.PR[ec]:null)bc=Ub.a.ff(bc);else return f.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${ec}`),{xvc:!0,W3c:[]};else bc=Ub.a.ff(Z.HelperMethods.PR[ec]);ec=Ub.a.ff(ec);fd||(Rc=0);Mc=Object.assign(new Ta.a,{MenuItemId:Mc,CommandValueId:Mc,
LabelText:fd&&0<Rc?Ub.a.ff(String.fromCodePoint(Rc)):bc,LabelCss:String.format("font-size:12pt;font-family:{0};",fd&&0<Rc?Sb:ec),Styles:Jb.Uub(fd&&0<Rc?Sb:ec),AriaLabel:bc,Alt:bc,Command:wb.toString(),CommandPreviewId:dc.toString(),CommandRevertId:Jc.toString()});Rb.push(Mc)}return{xvc:Wc,W3c:Rb}}Iqj(wb){this.menuId=wb}Qgi(){return 2!==this.J$c&&3!==this.J$c?!1:!0}v9e(){this.$ta={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,
["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,
["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static Uub(wb){const dc={};dc["font-family"]=wb;dc["font-size"]="12pt";wb={};wb.optionText=dc;return wb}}
Object(b.a)(Jb,"FontDropdownHelper",null,[410]);var Ab=a(695);class pb extends la.a{constructor(wb){super();this.$=wb;this.Fb()}create(){G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,wb=>{this.qb(Object(Ab.c)(this.$.da,502,()=>new Jb(this.$,wb)))}):this.qb(Object(Ab.c)(this.$.da,502,()=>new Jb(this.$,null)))}static ka(wb){wb.da.Ga(503,new pb(wb))}}Object(b.a)(pb,"FontDropdownHelperFactory",la.a,[]);var va=a(1241),db=a(1083),Ya=a(1217),gb=
a(1180),Ka=a(1129),ub=a(1154),ac=a(1266),Ra=a(1218),na=a(1189);class lb{constructor(wb){this.$=wb}Qc(){return!1}executeCommand(wb,dc){wb=!1;dc=dc.command;switch(dc){case 1910465940:wb=!0}return wb?F.Task.Ua(!0):T.a(dc)}Ec(wb,dc){switch(dc.command){case 1910465940:return!0;default:return!1}}Vc(){return!1}}Object(b.a)(lb,"NameManagerCommandHandler",null,[188]);class jb extends d.a{constructor(wb){super(wb)}Dd(){this.ld([new lb(this.$)])}static ka(wb){d.a.Rd(493,new jb(wb))}}Object(b.a)(jb,"NameManagerCommandHandlerFactory",
d.a,[]);var Yb=a(1181),Gb=a(1169);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(c.a)();R.a.Fa(J.ka);R.a.Fa(V.ka);Object(wa.a)();Object(ma.a)();Object(ab.a)();Object(ba.a)();Object(Ca.a)();Object(Na.a)();R.a.Fa(Ja.ka);Object($a.a)();Object(rb.a)();Object(Pa.a)();(()=>{R.a.Fa(wb=>{qb.ka(wb)})})();Object(Wa.a)();Object(va.a)();Object(db.a)();Object(Ya.a)();Object(gb.a)();Object(Ka.a)();Object(ub.a)();Object(ac.a)();Object(Ra.a)();Object(Gb.a)();Object(na.a)();Object(Yb.a)();(()=>{R.a.Fa(wb=>{jb.ka(wb)})})();(()=>{R.a.Fa(wb=>{pb.ka(wb)})})()},
713:function(t,D,a){a.d(D,"a",function(){return J});t=a(0);var c=a(7),b=a(15),d=a(557),f=a(86),e=a(554),k=a(372),l=a(585),m=a(563),v=a(112),n=a(262),w=a(82),r=a(412),u=a(1387);D=a(78);var x=a(19),z=a(5),B=a(833),y=a(77),A=a(42),K=a(59),G=a(145),T=a(113),W=a(1),P=a(11),E=a(22),H=a(14),F=a(21),N=a(33);class J extends D.a{constructor(R,M,L,U,X,da,fa,S,ka,V,wa,ma){super();this.pjc=!1;this.lEc=this.bHc=this.contextMenuController=null;this.rmd=!1;this.ysc=this.urb=null;this.MC=()=>{this.contextMenuController?
this.contextMenuController.MC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Fag()};this.jb=R;this.Mof=X;this.iOc=V;this.fGf=da;this.populateOnlyOnce=fa;this.X3h=wa;this.QMf(ma)}get contextMenuRoot(){return this.ysc}get $(){return this.jb}get Sa(){return this.iOc}get menuId(){return this.$.Bb+this.Mof}get stb(){this.bHc||(this.bHc=T.a(this.$));return this.bHc}get Oob(){this.lEc||(this.lEc=
F.g(this.$).Wb);return this.lEc}Qc(R,M){R=!0;switch(M){case 1651433993:case 1675506831:case 966232027:R=this.Wd(4096)||this.Wd(2048);break;case 2045563128:R=this.Wd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:R=this.Wd(8192)}return!R}Vc(R,M,L){L.IsShadowMenuOpen||B.h(this.$,B.d);R=!1;M===this.Fw&&(L.IsShadowMenuOpen||B.h(this.$,B.a),M=Object(c.a)(new d.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.rCd(M,L.IsShadowMenuOpen),L.MenuItems=M,
L.IsShadowMenuOpen||B.h(this.$,B.c),R=!0);R&&this.pjc&&P.HelperMethods.m_b&&!L.IsShadowMenuOpen&&B.j(this.$);return R}rCd(R,M){(M=this.fY(M))?(this.K7e(M),R.MenuSectionList.push(...M.rE().MenuSectionList),this.DBg(R)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}fY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}Y_(R,M,L,U,X){R=Sys.UI.DomElement.getBounds(M);M=new Sys.UI.Point(R.x,R.y+R.height);this.$.isChromeRtl&&(M.x+=R.width);this.xp(M,X)}xp(R,M,L=0){M&&(R=N.a(this.$).Uia(R));M=!0;if(this.X3h){let U;3===L?(U=this.rJa(3))&&0<U.length?(M=!1,this.showFloatie(U,new Sys.UI.Bounds(R.x,R.y,0,0),L)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===L&&this.$.isEditMode&&
((U=this.rJa(2))&&0<U.length?U[0]!==J.uSe?(M=!1,this.BQd(U,new Sys.UI.Bounds(R.x,R.y,0,0),L)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}M&&this.showContextMenu(new Sys.UI.Bounds(R.x,R.y,0,0),L)}rJa(){return null}ked(R,
M=null){let L="";3===R?L="touch":2===R&&(L="mouse");return{["ContextMenuId"]:this.menuId,["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!K.a.tg&&K.a.tg.mK,["IsReactMLR"]:!!K.a.tg&&K.a.tg.WU,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:L,["FloatieGroups"]:JSON.stringify(M)}}showContextMenu(R,M=0){const L=this.ked(M);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(L)}`);this.contextMenuController?this.CB!==z.a.iFd&&
this.CB!==z.a.jFd||0===M?this.contextMenuController.AQd(this.CB,R,y.a.Eb):this.contextMenuController.AQd(this.CB,R,M):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(R,M,L){const U=this.ked(L,R);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(U)}`);this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.XMf(),this.contextMenuController.$vc(R,M,L)):(R=JSON.stringify(R),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${R}.`))}BQd(R,M,L){var U=this.ked(L,R);U=JSON.stringify(U);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${U}`);this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.XMf(),this.contextMenuController.zQd(R,M,L,this.CB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}QMf(R){this.contextMenuController=R}dispose(){this.$&&this.$.Ka.rab(this);this.jb=null;W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.Fag();this.ysc&&(f.a.Ia(this.ysc),this.ysc=null);super.dispose()}gEh(R){var M=this.$.da.za(204);
M&&(M=M.OEh(this.Mof))&&R.pc.push(M)}Wd(R){return(new G.a(this.$.xa)).Wd(R)}K7e(R){for(const M of R.pc)if(Object(r.a)(301,M)){R=M;R.title&&(R.title=J.zh(R.title));for(const L of R.buttons)Object(r.a)(279,L)?(R=L,R.label=J.zh(R.label),R.ER(J.zh(R.alt))):Object(r.a)(303,L)&&this.K7e(L.menu)}}Jof(R,M=!1){const L=[];for(const U of R)L.push(this.KT(U,M));return L}KT(R){const M=[];for(const L of R.MenuItems)switch(L.Type){case 3:M.push(this.i4g(L));break;case 2:M.push(this.T9g(L));break;case 1:M.push(this.H5g(L))}return Object(c.a)(new e.a,
{ControlList:M,Title:R.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Lad(R,M){M=[this.urb,R.RibbonCommand.toString(),M?this.jYe(M):this.jYe(R.Label),R.Disabled?R.Disabled.toString():"False"];let L=R.CommandData;L=E.a.hashCode(L).toString();M.push(L,R.Identifier.toString());M=M.join("_");R.IsChecked&&(M+="_Checked");return M}PEh(R){const M=[this.urb,E.a.hashCode(R.Title).toString()];for(const L of R.MenuItems)M.push(L.RibbonCommand.toString());
return M.join("_")}kUe(R){var M=R.Label;M=E.a.hashCode(M).toString();M=[this.urb,M];W.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&R.Id&&M.push(E.a.hashCode(R.Id).toString());M=M.join("_");R.IsChecked&&(M+="_Checked");return M}i4g(R){let M,L,U;({label:L,DKa:U,rr:M}=this.c9b(R,!1));const X=this.Lad(R,L);return Object(c.a)(new k.a,{Command:R.Disabled?(-251203935).toString():M.toString(),ExternalId:X,Id:X,Image16by16Class:U,LabelText:L||R.Label,MenuItemId:R.CommandData,
CommandValueId:R.CommandData})}T9g(R){let M,L,U;({label:L,DKa:U,rr:M}=this.c9b(R,R.IsChecked));const X=this.Lad(R,L);return Object(c.a)(new l.a,{Command:R.Disabled?(-251203935).toString():M.toString(),ExternalId:X,Id:X,Image16by16Class:U,LabelText:L||R.Label,MenuItemId:R.CommandData,CommandValueId:R.CommandData,IsChecked:R.IsChecked})}H5g(R){let M;var L;({label:M,DKa:L}=this.uUe(R));const U=Object(c.a)(new d.a,{MenuSectionList:[],UpdateDynamically:!0});U.MenuSectionList.push(...this.Jof(R.SubMenu.Sections,
!0));const X=this.kUe(R);R=M||R.Label;return Object(c.a)(new m.a,{ExternalId:X,Id:X,LabelText:R,PopulateOnlyOnce:!1,Menu:U,Image16by16Class:L,ImageIsVisible:!!L})}uUe(R){let M,L;({label:R,DKa:M,rr:L}=this.c9b(R,!0));return{label:R,DKa:M,rr:L}}c9b(R,M){let L;switch(R.Identifier){case 26:L=912804500;M=x.a.BOe;R=H.a.instance.ga(1943);break;case 3:L=-1902148570;M=M?x.a.z$:null;R=H.a.instance.ga(1903);break;case 4:L=-1902148570;M=M?x.a.z$:null;R=H.a.instance.ga(1904);break;case 5:L=-1902148570;M=M?x.a.z$:
null;R=null;break;case 1:L=-1677817820;M=x.a.U6b;R=H.a.instance.ga(235);break;case 2:L=-1649376918;M=R.IsChecked?x.a.Jta:null;R=H.a.instance.ga(2116);break;case 23:L=1701016594;M=R.IsChecked?x.a.Jta:null;R=H.a.instance.ga(2116);break;case 6:L=-87741481;M=null;R=H.a.instance.ga(2117);break;case 7:L=1948650742;M=x.a.pNe;R=H.a.instance.ga(1941);break;case 8:L=1933713114;M=x.a.oNe;R=H.a.instance.ga(1942);break;case 14:L=504133448;M=x.a.jIa;R=H.a.instance.ga(145);break;case 30:L=504133448;M=x.a.jIa;R=
H.a.instance.ga(149);break;case 32:L=504133448;M=x.a.jIa;R=H.a.instance.ga(151);break;case 34:L=504133448;M=x.a.jIa;R=H.a.instance.ga(153);break;case 27:L=1701016594;M=M?x.a.W6b:x.a.jIa;R=H.a.instance.ga(145);break;case 15:L=-798968736;M=x.a.kIa;R=H.a.instance.ga(147);break;case 31:L=-798968736;M=x.a.kIa;R=H.a.instance.ga(150);break;case 33:L=-798968736;M=x.a.kIa;R=H.a.instance.ga(152);break;case 35:L=-798968736;M=x.a.kIa;R=H.a.instance.ga(154);break;case 28:L=1701016594;M=M?x.a.X6b:x.a.kIa;R=H.a.instance.ga(147);
break;case 21:L=-2058042992;M=x.a.G1a;R=null;break;case 29:L=1701016594;M=x.a.G1a;R=null;break;case 9:L=1701016594;R=M=null;break;case 11:L=-1494291901;R=M=null;break;case 25:L=-1045020714;M=R.IsChecked?x.a.Jta:null;R=null;break;case 13:L=1701016594;M=R.IsChecked?x.a.Jta:null;R=H.a.instance.ga(156);break;case 16:L=1701016594;M=x.a.M6b;R=H.a.instance.ga(1076);break;case 17:L=1701016594;M=x.a.F1a;R=null;break;case 18:L=1701016594;M=x.a.E1a;R=null;break;case 19:L=1701016594;M=x.a.N6b;R=H.a.instance.ga(1081);
break;case 20:L=1701016594;M=x.a.N7c;R=H.a.instance.ga(1082);break;case 24:L=1675506831;R=M=null;break;case 22:L=R.RibbonCommand;M=R.IsChecked?x.a.z$:null;R=null;break;case 36:L=1461300262;M=null;R=H.a.instance.ga(155);break;case 38:L=R.RibbonCommand;M=x.a.Y6b;R=H.a.instance.ga(1814);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(R)}`),L=1461300262,R=M=null}return{label:R,DKa:M,rr:L}}jYe(R){return E.a.hashCode(R+P.HelperMethods.Anj).toString()}DBg(R){if(!this.$.ea.amIAlone){var M=
this.$.da.za(25);if((void 0!==M&&null!==M||!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!v.a.isEmpty(M.hBa)&&(M=M.OZh(),!n.a.kh(M))){var L=[];w.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").j8g(M,L);R.MenuSectionList.push(...L)}}}XMf(){this.rmd||(this.stb&&this.stb.OXb(this.MC),this.Oob&&this.Oob.OXb(this.MC),this.rmd=!!this.stb||!!this.Oob)}Fag(){this.stb&&this.stb.Vqc(this.MC);this.Oob&&this.Oob.Vqc(this.MC);this.rmd=!1}static vld(R,M){M=A.C(M);
R=F.g(R).Ea.CJa(M);return!(null===R||void 0===R||!R.Ck)}static Nbd(R,M,L){M=A.C(M);var U=F.g(R).Ea.CJa(M);M=F.g(R).getCellBounds(U);const X=U.nMg;U=U.mMg;let da=M.x+X.x;M=M.y+X.y;L&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(F.g(R).rtl||(da+=U),M-=U);return new Sys.UI.Point(da,M)}static Yvh(R){try{Object(u.a)(R.CommandValueId)}catch(M){}}static zh(R){const M=J.S0a.parseFromString(R,"text/html");return M?M.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),
R)}}J.S0a=new DOMParser;J.uSe="Unsupported";Object(t.a)(J,"ContextMenuBase",D.a,[188,313,3])},770:function(t,D,a){a.d(D,"a",function(){return c});t=a(0);class c{}c.eLe="ewa-ac";c.Alh="ewa-ac-param";c.YLe="ewa-function-help-link";c.G7c="ewa-lb";c.SLe="ewa-fb-refactor";c.listItem="list-item";c.PAb="list-item-selected";c.TAb="list-table-touch";c.SAb="list-table";c.lrh="ewa-suggested-cell-name";c.eZg="columnName-header";c.TMe="ewa-tt";c.Coh="ewa-function-link-container";c.ZLe="ewa-function-udf-name";
c.rtl="rtl";Object(t.a)(c,"CssClassNames",null,[])},803:function(t,D,a){a.r(D);t=a(0);var c=a(15),b=a(810),d=a(721),f=a(5),e=a(77),k=a(54),l=a(196),m=a(34),v=a(1),n=a(14);class w{constructor(M,L,U,X,da,fa,S,ka){this.Kkg=M;this.Lkg=L;this.Jkg=U;this.Ofa=X;this.ewg=da;this.ssg=fa;this.Bib=S;this.rrg=ka}get Nse(){return this.Kkg}get e_b(){return this.Lkg}get Mse(){return this.Jkg}get width(){return this.Ofa}get pFj(){return this.ewg}get VDi(){return this.ssg}get lineHeight(){return this.Bib}get jri(){return this.rrg}static gPg(){return new w("BorderStyleSolidLine",
1955,1,"1","",1,8,0)}static cPg(){return new w("BorderStyleDashedLine",1956,3,"1","5,3",1,8,0)}static dPg(){return new w("BorderStyleDottedLine",1957,4,"1","1,1",1,8,0)}static fPg(){return new w("BorderStyleMediumLine",1958,2,"2","",1,8,0)}static hPg(){return new w("BorderStyleThickLine",1959,5,"3","",1,8,0)}static ePg(){return new w("BorderStyleDoubleLine",1960,6,"1","",2,8,3)}}Object(t.a)(w,"BorderLineStyleProperties",null,[]);class r{constructor(){this.iconName=this.title=this.key=null}}Object(t.a)(r,
"BorderLineStyleProps",null,[]);class u{constructor(M){M.gNf()}getBorderLineStyleProps(){const M=a(803).BorderFormatManager.hZa,L=Array(Object.keys(M).length);let U=0;for(let fa in M){var X=fa,da=M[fa];L[U]=new r;L[U].key=X;X=da;L[U].title=n.a.instance.ga(X.e_b);L[U].iconName=X.Nse;U++}return L}}Object(t.a)(u,"BorderMenuController",null,[535]);var x=a(262),z=a(85),B=a(235),y=a(13),A=a(108),K=a(24),G=a(47),T=a(45),W=a(209),P=a(11),E=a(97),H=a(21),F=a(33),N=a(42);class J{constructor(M,L){this.OFb=this.ribbonCommandInfo=
this.cellFormat=this.Ir=this.ob=this.ha=null;this.cqc=!1;this.zHf=this.QKa=this.EDd=this.D6d=this.Dya=this.Nla=null;this.g_b=this.qta=this.GHf=0;this.borderStyle=this.iZa=this.borderColor=null;this.mB=!1;this.n0a=this.t$a=null;this.z_=()=>{if(!this.mB||H.g(this.$).qz)this.mB=!1,H.g(this.$).qz=!1,this.qta=0,H.g(this.$).Cf.Yl(f.a.kQ),1===this.$.Ka.nH()&&(H.g(this.$).HU(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?N.d(this.EDd):x.a.clone(this.EDd),this.GHf,this.$.oa?this.$.oa.sheetName:
null,null,this.zHf.clone(),null,null,0,E.a.mhh,!0),H.g(this.$).yRa(!0)),this.Fv(),this.BWd(),this.ek(),this.cqc=!1,this.Dya=this.Nla=null,this.Ir&&(this.Ir.cancel(),this.Ir.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=U=>{try{if(U=this.Ud(U),H.g(this.$).qz=!0,this.Nla={},this.Dya={},this.t$a=null,this.dob(this.g_b),2===U.tb){const X=H.g(this.$).ha.Vn(U.clientPoint,U.Cb,5,void 0,void 0,!1);X&&(this.n0a=this.QKa=X,this.a7i())}}catch(X){H.g(this.$).qz=
!1}return!0};this.Fh=U=>{try{U=this.Ud(U);const X=H.g(this.$).ha.Vn(U.clientPoint,U.Cb,5,void 0,void 0,!1),da=H.g(this.$).Ea.Qr(X);if(!this.OFb||da&&(da.eK!==this.OFb.eK||da.dK!==this.OFb.dK))if(this.mB=!0,this.OFb=da,X){let fa=new K.Range(this.QKa.top,this.QKa.left,this.QKa.top,this.QKa.left,!0,!1);fa.union(X);fa=H.g(this.$).ha.XTh(fa);this.k_b(X);this.CSf(this.t$a,fa);if(this.bottomRightCorner(fa.bottom,fa.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const S=new K.Range(fa.top,fa.left,fa.bottom+1,fa.right+1,!0,!1),ka=H.g(this.$).d$("DrawBorderBehavior.OnPointerMove",[S]);if(this.Nla&&this.Dya)for(;ka.$$mn();){const V=ka.$$cu(),wa=V.cell.getRange().toString();wa in this.Nla&&1!==this.qta||(this.Nla[wa]=V,this.Dya[wa]=V.cell.DM())}this.t$a=S;this.n0a=fa;H.g(this.$).HU([fa],0,this.$.oa.sheetName,null,fa.topLeft,null,null,0,E.a.jhh,!0);this.ug.nda(H.g(this.$),-1690267012,this.cellFormat,!0,null,[fa])}return!0}catch(X){return H.g(this.$).qz=!1}};
this.Kf=U=>{U=this.Ud(U);(U=H.g(this.$).ha.Vn(U.clientPoint,U.Cb,5,void 0,void 0,!1))?this.mB&&(this.k_b(U),this.QKa.union(U),3===this.qta?this.dob(0):this.dob(this.g_b),H.g(this.$).HU([this.QKa],0,this.$.oa.sheetName,null,null,null,null,0,E.a.khh,!0),this.ug.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.qta?this.dob(0):this.dob(this.g_b),H.g(this.$).HU([this.n0a],0,this.$.oa.sheetName,null,null,null,null,0,E.a.lhh,!0),this.ug.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));
this.mB=!1;this.BWd();this.Dya=this.Nla=null;return!0};this.onKeyDown=U=>{U=this.Ud(U);if(this.mB||[17,16,18,20].includes(U.Ca.keyCode))return!0;this.z_();return!1};this.onKeyUp=U=>{U=this.Ud(U);if(U.Ca.keyCode===z.a.uL&&this.mB)return this.mB=!1,this.CSf(this.t$a,this.n0a,!0),this.BWd(),!0;if(this.mB||U.Ca.keyCode===z.a.m7||U.Ca.keyCode===z.a.H_d||U.Ca.keyCode===z.a.G_d||[17,16,18,20,37,39,38,40,33,34,9,13].includes(U.Ca.keyCode)||U.Ca.keyCode===z.a.hjg||U.Ca.keyCode===z.a.djg||U.Ca.keyCode===z.a.$ig)return!0;
this.z_();return!1};this.XQ=(U,X)=>{H.g(this.$).qz&&!this.V6h.includes(X.Jd.command)&&(c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${X.Jd} `),this.z_())};this.$=M;this.ug=L}get V6h(){return this.D6d||(this.D6d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}Kyg(M){c.ULS.sendTraceTag(537159517,
0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=H.g(this.$).ha;this.ob=H.g(this.$).ob;this.ribbonCommandInfo=M;this.EDd=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?N.d(this.ha.sa.selectedRanges):x.a.clone(this.ha.sa.selectedRanges);this.GHf=this.ha.sa.Wr;this.zHf=this.ha.sa.activeCell.clone();this.ob&&this.ob.Ihd();this.tv();this.Bj()}dispose(){this.z_();this.OFb=this.ribbonCommandInfo=this.cellFormat=null}dob(M){var {BorderFormatManager:L}=
a(803);this.cellFormat={};const U={};this.borderColor=this.borderColor||L.b4c;var X=l.a.iH(this.borderColor,!1);U.Color=[X,X,X,X];v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.iZa&&(U.ThemeBorderColor=[this.iZa,this.iZa,this.iZa,this.iZa],U.ColorTypeOption=1);X=a(803).BorderFormatManager.hZa;this.borderStyle=this.borderStyle||L.borderStyleSolidLine;L=X[this.borderStyle].Mse;U.LineStyle=[L,L,L,L];this.cellFormat.BorderFormat=U;this.cellFormat.ValidMembers=128;this.cellFormat.Border=
M}tv(){for(const M of H.g(this.$).sn)B.a.instance.ra(y.a.pointerDown,M.domElement,this.onPointerDown);A.KeyInputManager.instance.ra(y.a.Mb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.ra(y.a.Gd,document.documentElement,this.onKeyUp)}a7i(){for(const M of H.g(this.$).sn)B.a.instance.ra(y.a.zj,M.domElement,this.Fh),B.a.instance.ra(y.a.Mf,M.domElement,this.Kf);B.a.instance.ra(y.a.Mf,document.documentElement,this.Kf);B.a.instance.ra(y.a.my,document.documentElement,this.Kf);this.cqc=
!0}Fv(){try{for(const M of H.g(this.$).sn)B.a.instance.Ba(y.a.pointerDown,M.domElement,this.onPointerDown);A.KeyInputManager.instance.Ba(y.a.Mb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.Ba(y.a.Gd,document.documentElement,this.onKeyUp)}catch(M){H.g(this.$).qz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${M}`)}}BWd(){if(this.cqc)try{this.cqc=!1;for(const M of H.g(this.$).sn)B.a.instance.Ba(y.a.zj,
M.domElement,this.Fh),B.a.instance.Ba(y.a.Mf,M.domElement,this.Kf);B.a.instance.Ba(y.a.Mf,document.documentElement,this.Kf);B.a.instance.Ba(y.a.my,document.documentElement,this.Kf)}catch(M){H.g(this.$).qz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${M}`)}}Bj(){this.$.xa.Pf(this.z_);H.g(this.$).Wb.Mk(this.z_);H.g(this.$).iC(this.z_);this.$.Ka.WEa(this.XQ)}ek(){this.$.xa.Ag(this.z_);H.g(this.$).Wb.Gk(this.z_);H.g(this.$).BD(this.z_);
this.$.Ka.dza(this.XQ)}CSf(M,L,U=!1){if(M&&this.Nla&&this.Dya)for(M=H.g(this.$).d$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[M]);M.$$mn();){var X=M.$$cu().cell.getRange();if(U||!L.contains(X)||1===this.qta){X=X.toString();const da=m.a.Cc(this.Nla,X);if(da){const fa=m.a.Cc(this.Dya,X);this.setBorders(da,fa);delete this.Nla[X];delete this.Dya[X]}}}}setBorders(M,L){var U=M.cell;const X=U.getRange();U.qab();X.right!==this.t$a.right&&(U=new K.Range(X.top,X.left-1,X.bottom,X.left-1,!0,!1),H.g(this.$).Ea.Qr(U).qPa(3));
X.bottom!==this.t$a.bottom&&(U=new K.Range(X.top-1,X.left,X.top-1,X.right,!0,!1),H.g(this.$).Ea.Qr(U).qPa(1));if(null===L||void 0===L?0:L.Borders.length){U={};let S=0;const ka=Array(4),V=Array(4);for(var da=0;4>da;da++)ka[da]=1,V[da]=0;for(var fa of L.Borders)L=fa.BorderPosition,ka[L]=fa.BorderLineStyle,da=new W.a(fa.Color.Red,fa.Color.Green,fa.Color.Blue),V[L]=da.UR(),S|=P.HelperMethods.O2a(fa.BorderPosition);U.LineStyle=ka;U.Color=V;fa={};fa.BorderFormat=U;fa.Border=S;this.ug.trj(M,fa,X)}}k_b(M){const L=
new K.Range(Math.max(1,M.top-1),Math.max(1,M.left-1),M.bottom+1,M.right+1,!1,!1);H.g(this.$).kK(L)||this.Ir&&this.Ir.zq||(this.Ir=G.a.instance.create(()=>{H.g(this.$).Sr(L,60,E.a.hhh)},40,T.a.ihh))}bottomRightCorner(M,L){return 1048576<=M||16384<=L?!0:!1}Ud(M){return F.a(this.$).Ud(M)}}Object(t.a)(J,"DrawBorderBehavior",null,[3]);a.d(D,"BorderFormatManager",function(){return R});class R{constructor(M,L,U){this.mPb=null;this.NF={};this.cQb=this.ix=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");
this.$=M;this.S2d=R.b4c;this.T2d=R.borderStyleSolidLine;this.ug=L;this.Sa=U;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.eU=new J(this.$,this.ug);this.cD=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get dHa(){return this.T2d}get x2(){return this.S2d}get Fsa(){return this.cQb}get themesManager(){this.ix||
(this.ix=this.$.da.za(422));return this.ix}E3e(M,L){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${L.command.toString()}`);const U={},X={};var da=l.a.iH(this.x2,!1);X.Color=[da,da,da,da];this.cD&&this.Fsa&&(X.ThemeBorderColor=[this.Fsa,this.Fsa,this.Fsa,this.Fsa],X.ColorTypeOption=1);M=-600086683===L.command?"OutsideBorders":M[e.a.Oc];X.LineStyle=m.a.Cc(R.LGf,M);X.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${M}`):
(da=R.hZa[this.dHa].Mse,X.LineStyle=[da,da,da,da],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.dHa}`));da=m.a.Yp(R.eOg,M,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${M}, the border color selected is ${this.x2}`);U.BorderFormat=X;4!==da&&8!==da||!this.$.oa.displayRtl||(da=4===da?8:4);U.ValidMembers=128;U.Border=da;this.ug.formatCells(-1690267012,
U,L);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${L.command.toString()}`);return!0}fgd(M,L,U){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${M.toString()} is being executed, the previous border color is ${this.x2}`);if(this.cD){if((L.SqmControlId||"").includes("ThemeColorPicker")){let X,da;({themeIndex:X,zAa:da}=this.themesManager.getThemeColor(L.Color)).returnValue?(this.cQb={},this.Fsa.ThemeColorIndex=X,this.Fsa.ThemeColorRow=da):this.cQb=
null}else this.cQb=null;this.eU.iZa=this.Fsa}this.S2d=-1803452024===M?R.b4c:L.Color;this.eU.borderColor=this.x2;this.vJe(U);this.$.pf();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${M.toString()} is being executed, the updated border color is ${this.x2}`);return!0}t2h(M){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const L=this.Sa.pq();var U=this.Sa.Bc();L.pc.push(U);const X=this.Sa.FC("StyleDashGallery",1,"Size120by20");U.buttons.push(X);U=R.hZa;
for(let da in U){const fa=da,S=U[da],ka=n.a.instance.ga(S.e_b);X.Lt(fa,-2118943501,"QueryBorderStyle",S.e_b,fa,fa,void 0,void 0,ka)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");M.MenuItems=L.rE();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}R0h(M,L){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.dHa}`);M=M[e.a.Oc];if(R.lni(M))this.T2d=M,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.dHa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${M}`),!0;this.eU.borderStyle=this.dHa;this.vJe(L);this.$.pf();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.dHa}`);return!0}jgd(M){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${M.command.toString()}`);this.ORc(M,64,this.x2,109,1);return!0}kgd(M){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${M.command.toString()}`);this.ORc(M,112,this.x2,110,2);return!0}S3e(M){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${M.command.toString()}`);this.ORc(M,112,"white",111,3);return!0}x2h(M){this.aqj(this.gOg,M,M.MenuItemId?M.MenuItemId:R.borderStyleSolidLine)}aqj(M,L,U){U in M?(M=M[U],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${U}`),
this.cqj(L,M)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${U}' in BorderLineStyleButtons dictionary`)}I2h(M,L){const U=M[e.a.Oc];return"DrawBorder"===U?this.jgd(L):"DrawBorderGrid"===U?this.kgd(L):"EraseBorder"===U?this.S3e(L):this.E3e(M,L)}gNf(){this.mPb||this.iPg()}bIh(){return new u(this)}get gOg(){this.gNf();return this.mPb}iPg(){this.mPb={};let M=0;const L=R.hZa;for(let U in L){const X=L[U],da=X.Nse;n.a.instance.ga(X.e_b);this.mPb[da]=da;this.jab(da,
()=>appChrome.buildBorderStyleIconNew(X.pFj,X.width,X.VDi,X.lineHeight,X.jri));M++}}jab(M,L){if(!(M in this.NF)){const U={};L=L();U[M]=L;appChrome.api.registerIconProvider(()=>U);this.NF[M]=!0}return M}cqj(M,L){M.MenuItemId&&(M[b.a.On]=M.MenuItemId===this.dHa,M[d.a.Icon]=L)}ORc(M,L,U,X,da){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.VVg(M,da)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.eU.z_()):(H.g(this.$).qz&&this.eU.z_(),k.a.current&&(X=String.format(f.a.Lsa,k.a.current.Rn(X)),H.g(this.$).Cf.Yl(X)),this.eU.g_b=L,this.eU.borderColor=U,H.g(this.$).qz=!0,this.eU.Kyg(M),this.eU.qta=da)}vJe(M){if(M)switch(this.eU.qta){case 2:this.kgd(M);break;default:this.jgd(M)}}VVg(M,L){return this.eU.qta===L&&-236759591!==M.command&&-2118943501!==M.command?!0:!1}static get hZa(){return R.f1d||(R.f1d={["BorderStyleSolidLine"]:w.gPg(),["BorderStyleDashedLine"]:w.cPg(),["BorderStyleDottedLine"]:w.dPg(),
["BorderStyleMediumLine"]:w.fPg(),["BorderStyleThickLine"]:w.hPg(),["BorderStyleDoubleLine"]:w.ePg()})}static get eOg(){return R.e1d||(R.e1d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get LGf(){return R.vce||
(R.vce={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:R.Lbh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static lni(M){return M?M in R.LGf||M in R.hZa:!1}}R.e1d=null;R.f1d=null;R.vce=null;R.b4c="black";R.borderStyleSolidLine="BorderStyleSolidLine";R.Lbh=[1,1,1,1];Object(t.a)(R,"BorderFormatManager",null,[414])},833:function(t,D,a){a.d(D,"i",function(){return"ContextMenuPerf.A"});a.d(D,"b",function(){return"ContextMenuPerf.B"});
a.d(D,"d",function(){return"ContextMenuPerf.C1"});a.d(D,"a",function(){return"ContextMenuPerf.C2"});a.d(D,"c",function(){return"ContextMenuPerf.D"});a.d(D,"e",function(){return m});a.d(D,"f",function(){return w});a.d(D,"g",function(){return r});a.d(D,"h",function(){return u});a.d(D,"j",function(){return x});var c=a(15),b=a(316),d=a(8),f=a(60),e=a(24),k=a(11),l=a(21);const m=(B,y)=>{var A=B.Xb(null);if((null===A||void 0===A?0:A.cell.Ck)&&v(A,B,y))return B.getCellBounds(A.cell);A=B.ha.sa.activeCell;
return(y=n(new e.Range(A.top,A.left,d.a.mh,A.left,!1,!1),2,!0,B,y)||n(new e.Range(1,A.left,A.top,A.left,!1,!1),2,!1,B,y)||n(new e.Range(A.top,A.right,A.top,d.a.Ch,!1,!1),1,!0,B,y)||n(new e.Range(A.top,1,A.top,A.right,!1,!1),1,!1,B,y)||null)&&y.Ck?B.getCellBounds(y):Sys.UI.DomElement.getBounds(B.kva.lc)},v=(B,y,A)=>{var K=y.rtl,G=A.isChromeRtl;B=B.cell;return(A=l.g(A).SJ(B))?(A=A.topLeft,K=A.x+=K===G?B.offsetWidth:0,G=A.y+=B.offsetHeight,y.view.visibleArea.contains(new f.a(K,G,0,0))):!1},n=(B,y,A,
K,G)=>{B=K.kk("ContextMenuHelper.FindFirstCellInViewportArea",B,y,A);try{for(B.$$rst();B.$$mn();){const T=B.$$cu();if(T&&v(T,K,G))return T.cell}}finally{B&&B.dispose()}return null},w=B=>B.Db.o4(B.ha.sa.activeCell),r=B=>{B=l.g(B).ha.sa;return B.xg&&(B.Wc.isRow||B.Wc.Ze)},u=(B,y)=>{k.HelperMethods.VWc&&window.performance.mark(y)},x=()=>{if(b.a.$nb){const B=z("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),y=z("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),A=z("EWAPopulation",
"ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${B}], PrepInfraWork=[${y}], EWAPopulation =[${A}]`)}},z=(B,y,A)=>{window.performance.measure(B,y,A);y=window.performance.getEntriesByName(B);y.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${B}] returned no measures.`);return y[y.length-1]?y[y.length-1].duration:-1}},834:function(t,D,a){a.d(D,"a",function(){return c});
t=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.kMg="AutoFill";c.Ohj="RowOperations";c.fZg="ColumnOperations";c.HVj="ViewModeRowOperations";c.GVj="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.duj="ShapeStyle";c.PAh="FloatingObjectClipboard";c.JFf="PivotTableCopyDelete";c.LFf="PivotTableFieldListActions";c.Uve="CellFloatie";c.$tj="ShapeFloatie";c.contextMenu="ContextMenu";c.b0h="GridContextMenu";c.jXi="PivotTableContextMenu";
c.QAh="FloatingObjectContextMenu";c.bVg="CellRTEFloatie";c.Q_f="ShapeRTEFloatie";Object(t.a)(c,"FloatieGroupIdentifiers",null,[])},835:function(t,D,a){a.d(D,"a",function(){return m});t=a(0);var c=a(86),b=a(221),d=a(13),f=a(235);D=a(234);var e=a(12),k=a(70),l=a(21);class m extends D.a{constructor(v,n,w){super(n);this.eic=this.JQ=!1;this.pn=this._selectedRowListBox=this.HMa=null;this.Dxf=r=>this.onItemClick(r);this.lzd=r=>{k.g(r.Ca);this.raiseEvent(m.Q3a);this.raiseEvent(m.SMd);return!0};this.onScroll=
r=>{k.g(r);this.NEd();this.raiseEvent(m.Q3a)};this.onBlur=r=>{k.g(r);this.NEd()};this.onPointerDown=()=>{this.NEd();this.raiseEvent(m.Q3a);this.raiseEvent(m.DOa);return!1};this.IDb=r=>{const u=r.Ca;if(u.button===Sys.UI.MouseButton.leftButton||u.button===Sys.UI.MouseButton.rightButton||u.type.includes("touch"))this.Ej=this.H9b(u),this.onPointerDown(r);this.raiseEvent(m.jqd);return!1};this.jb=v;this.OAb=w;this.lAa(!0)}S8(v){this.get_events().addHandler(m.Q3a,v)}Fca(v){this.get_events().removeHandler(m.Q3a,
v)}MXb(v){this.get_events().addHandler(m.Iid,v)}Tqc(v){this.get_events().removeHandler(m.Iid,v)}wmb(v){this.get_events().addHandler(m.SMd,v)}DHb(v){this.get_events().removeHandler(m.SMd,v)}umb(v){this.get_events().addHandler(m.DOa,v)}AHb(v){this.get_events().removeHandler(m.DOa,v)}yTc(v){this.get_events().addHandler(m.jqd,v)}XHd(v){this.get_events().removeHandler(m.jqd,v)}get Ej(){return this._selectedRowListBox}set Ej(v){this.DAa(this._selectedRowListBox);v?(this._selectedRowListBox=v,this.DAa(this._selectedRowListBox),
this.itc(v)):this._selectedRowListBox=null}get IZ(){return this.OAb.ListCellClass}get qba(){return this.OAb.ListTableClass}get UH(){return 8}get JBb(){return 5}get dic(){return 24}get cic(){return 35}get fg(){return this.domElement}get $(){return this.jb}dispose(){this.S6(!1);this.lAa(!1);c.a.rc([this.HMa]);this.HMa=null;super.dispose()}H9b(v){return e.DOMElementExtensions.ycd(v.target,"tr",!0)}rB(v){if(v){if(!this.Ej){var n=this.pn;if(!n||!n.rows.length)return;this.Ej=n.rows[0];0<v?v--:v++}n=this.Ej;
for(let w=0,r=Math.abs(v);w<r;w++)if(0>v){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Ej=n)}}cmb(v,n){e.DOMElementExtensions.toggleCssClass(v,this.OAb.ListTableClassInTouch,n)}S6(v){const n=this.pn;n&&(v&&!this.eic?(b.a.instance.ra(d.a.click,n,this.Dxf),b.a.instance.ra(d.a.nk,n,this.lzd),f.a.instance.ra(d.a.pointerDown,n,this.IDb),this.eic=!0):this.eic&&(b.a.instance.Ba(d.a.click,n,this.Dxf),b.a.instance.Ba(d.a.nk,n,this.lzd),f.a.instance.Ba(d.a.pointerDown,
n,this.IDb),this.eic=!1))}DAa(v){let n=null;v&&(n=e.DOMElementExtensions.Kj(v,this.OAb.ListCellClass))&&n.classList.toggle(this.OAb.ListCellSelectedClass);return n}lAa(v){this.fg&&(v&&!this.JQ?(this.HMa=this.pe.Vd(this.fg),this.HMa.ka("scroll",this.onScroll),this.HMa.ka("blur",this.onBlur),f.a.instance.ra(d.a.pointerDown,this.domElement,this.onPointerDown),this.JQ=!0):this.JQ&&(c.a.Ia(this.HMa),this.HMa=null,f.a.instance.Ba(d.a.pointerDown,this.domElement,this.onPointerDown),this.JQ=!1))}onItemClick(v){return this.lzd(v)}itc(v){if(v){var n=
v.offsetTop,w=this.fg.scrollTop;n<w?this.vVf(!0):n+v.offsetHeight>w+this.fg.clientHeight&&this.vVf(!1)}}vVf(v){this.fg.scrollTop=v?this.Ej.offsetTop:this.Ej.offsetTop+this.Ej.offsetHeight-this.fg.clientHeight}NEd(){l.g(this.$).$a&&this.raiseEvent(m.Iid)}}m.Q3a="GotFocus";m.Iid="IgnoreBlur";m.SMd="SetCell";m.DOa="PointerDown";m.jqd="ItemPointerDown";Object(t.a)(m,"ListBox",D.a,[449,3])},903:function(t,D,a){a.d(D,"a",function(){return b});t=a(0);var c=a(22);class b{compare(d,f){return c.a.compare(d,
f,!0)}}Object(t.a)(b,"IgnoreCaseComparer",null,[314])},904:function(t,D,a){a.d(D,"a",function(){return f});t=a(0);var c=a(24),b=a(11),d=a(200);class f{constructor(e,k){this.Ea=e;this.Q1a=k}EJb(e,k,l){const m=k.Border;k=k.BorderFormat;let v=0,n=!1;if(0===m)e.cell.qab(),this.ZGb(e.cell.getRange());else{for(let w=0;3>=w;w++)f.nvj(e,l,w,m)&&(v|=b.HelperMethods.O2a(w),this.WWd(e.cell.getRange(),w,k),n=!0);b.HelperMethods.zQ(m,16)&&!d.c(e,0,l)&&(v|=2,this.WWd(e.cell.getRange(),0,k),n=!0);b.HelperMethods.zQ(m,
32)&&!d.c(e,2,l)&&(v|=4,this.WWd(e.cell.getRange(),2,k),n=!0);n&&(l=e.cell.cu.qf,b.HelperMethods.zQ(v,2)&&this.e1f(e,l,0)&&(v&=-3),b.HelperMethods.zQ(v,1)&&this.d1f(e,l,1)&&(v&=-2),b.HelperMethods.zQ(v,4)&&this.e1f(e,l,2)&&(v&=-5),b.HelperMethods.zQ(v,8)&&this.d1f(e,l,3)&&(v&=-9),e.cell.setBorders(k,v,!1))}}dQ(e,k){e=f.SUe(e,k);return e.yz?(e=this.Ea.Aia(e))&&e.length?e:null:null}ZGb(e){for(let l=0;3>=l;l++){var k=f.SUe(e,l);if(!k.yz)continue;k=this.Ea.Aia(k);if(!k||!k.length)continue;const m=f.g_e(l);
for(let v=0;v<k.length;v++)k[v].qPa(m)}}WWd(e,k,l){if(e=this.dQ(e,k)){var m=f.g_e(k),v=b.HelperMethods.O2a(m);for(let n=0;n<e.length;n++){const w=e[n];this.bei(w,m)&&f.setBorders(w,l,v,k,m)}}}bei(e,k){const l=e.cu.qf;var m=e.getRange();m=this.dQ(m,k);let v=!1,n=!1,w=!1,r=!1;m&&(v=f.N5a(m,!0),n=f.N5a(m,!1),r=f.nnd(m),w=1===m.length?!0:!1);switch(k){case 0:return f.sdi(e,l,r,n,w);case 1:return f.pdi(e,l,r,v,w);case 2:return f.qdi(e,l,r,v,w);case 3:return f.rdi(e,l,r,n,w)}return!1}e1f(e,k,l){if(!e.cell.rF)return!1;
const m=e.range,v=this.dQ(m,l),n=d.c(e,l,k);let w=!1;k=0===l?m.top<k.top:m.left<k.left;!f.Dyb(e.cell)&&v&&1!==v.length&&(w=(0===l?f.N5a(v,!0):f.N5a(v,!1))?!1:!0);return!n&&w||k?!0:!1}d1f(e,k,l){const m=e.cell,v=this.dQ(m.getRange(),l);e=d.c(e,l,k);k=!1;if(v){const w=f.N5a(v,!0);var n=f.N5a(v,!1);const r=w&&!n;n=n&&!w;1!==l||f.Azb(m)?3!==l||f.tyb(m)||f.uvj(m,v,n,r)&&(k=!0):f.tvj(m,v,w,n)&&(k=!0)}return!e&&k||f.Dyb(m)?!0:!1}static bPg(e,k,l){const m={};m.LineStyle=Array(4);m.LineStyle[l]=e.LineStyle[k];
m.Color=Array(4);m.Color[l]=e.Color[k];return m}static xaf(e,k,l,m,v){return b.HelperMethods.zQ(e,v)&&d.c(k,l,m)}static nvj(e,k,l,m){return f.xaf(m,e,l,k,b.HelperMethods.O2a(l))||f.xaf(m,e,l,k,64)||112===m}static setBorders(e,k,l,m,v){k=f.bPg(k,m,v);e.setBorders(k,l,!1)}static SUe(e,k){switch(k){case 0:return new c.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new c.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new c.Range(e.bottom+1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new c.Range(e.top,
e.right+1,e.bottom,e.right+1,!1,!1)}return e}static g_e(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static N5a(e,k){for(let l=0;l<e.length;l++){const m=e[l];if(m.rF)return k?f.tyb(m):f.Azb(m)}return!1}static Dyb(e){const k=e.cu.qf,l=e.getRange();return e.rF&&(l.top<k.top||l.bottom>k.bottom||l.left<k.left||l.right>k.right)?!0:!1}static nnd(e){for(let k=0;k<e.length;k++)if(f.Dyb(e[k]))return!0;return!1}static tvj(e,k,l,m){if(!e.rF){if(!l||f.nnd(k))return!0}else if(f.tyb(e)&&
(1===k.length&&f.oKg(e,k[0])||!l))return!0;return m}static uvj(e,k,l,m){if(!e.rF){if(!l||f.nnd(k))return!0}else if(f.Azb(e)&&(1===k.length&&f.pKg(e,k[0])||!l))return!0;return e.bka||m}static sdi(e,k,l,m,v){const n=e.getRange();return f.tyb(e)?f.Dyb(e)||v:k.top===n.top||!m||l}static pdi(e,k,l,m,v){const n=e.getRange();return f.tyb(e)?k.bottom===n.bottom&&v:m&&!l||k.bottom===n.bottom}static qdi(e,k,l,m,v){const n=e.getRange();return f.Azb(e)?f.Dyb(e)||v:k.left===n.left||!m||l}static rdi(e,k,l,m,v){const n=
e.getRange();return e.bka?!1:f.Azb(e)?k.right===n.right&&v:m&&!l||k.right===n.right}static tyb(e){return 0<e.getRange().right-e.getRange().left}static Azb(e){return 0<e.getRange().bottom-e.getRange().top}static pKg(e,k){e=e.getRange();k=k.getRange();return e.top===k.top&&e.bottom===k.bottom}static oKg(e,k){e=e.getRange();k=k.getRange();return e.left===k.left&&e.right===k.right}}Object(t.a)(f,"BorderModelAccessorHelper",null,[])},906:function(t,D,a){a.d(D,"a",function(){return e});t=a(0);var c=a(86);
D=a(93);var b=a(47),d=a(45),f=a(70);class e extends D.a{constructor(k,l){super(l.textBox.domElement);this.SVc=null;this.uFi=()=>{this.Jxd()};this.wvf=(m,v)=>{this.Jf(m,v)};this.Avf=(m,v)=>{this.Lh(m,v)};this.jb=k;this.LI=l;l.JX&&(l.JX.add(this),l.Mk(this.Avf),l.jm(this.wvf))}get $(){return this.jb}get Ya(){return this.LI}dispose(){const k=this.LI;if(null===k||void 0===k?0:k.JX)k.JX.remove(this),k.Gk(this.Avf),k.Al(this.wvf);c.a.Ia(this.SVc);this.LI=null;super.dispose()}Sh(k,l){switch(l){case -1470715894:case -1231471547:this.wT(!1);
break;default:if(this.pEd(k,l))return f.g(k),!0;e.Vii(l)||this.wT(!1)}return!1}wT(){c.a.Ia(this.SVc);this.SVc=b.a.instance.create(this.uFi,10,d.a.rri)}Lh(){this.wT(!1)}static Vii(k){switch(k){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(t.a)(e,"ListAutoCompleteBehavior",D.a,[482,3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/3e376973552548f467585c877306ad77/EwaDSEsNext.kpae.js.map